//$Id$
/**
 * IMPORTANT NOTE: This compressed javascript includes thirdparty javascripts
 * listed at docs.zoho.com/html/thirdparty.html
 * The original javascript sources are available in the above location.
 */
function ZDDialog(){}function ZDUtils(){}function ZDConstants(){this.openTarget="_blank",this.callback=!1,this.folderArray=[],this.urlInvoker,this.moveUpFolder=!1,this.nextPage=!1,this.totalFiles="",this.templates="false",this.nameSortArrow="",this.nameSortOrder="",this.timeSortArrow="",this.timeSortOrder="desc",this.folderId="folder",this.parentFolderId="1",this.fromIndex="0",this.endIndex="10",this.prevIndex="1",this.nextIndex="10",this.docsPerPage="10",this.topLevelFetch="0",this.bottomLevelFetch="50",this.startFrom="0",this.fetchLimit="50",this.isShareEnabled=!1,this.advSearchFile=!1,this.trashsort=!1,this.searchQuery="",this.jsonData="",this.includeJSandCSSFiles=!1,this.selectedLeftPanel="recentservicedocs",this.templateObj={},this.rename_openfile={id:"rename_openfile",label:zd_js_obj.rename,icon:"zdc-rename_css",attr:{title:zd_js_obj.rename}},this.trash_openfile={id:"trash_openfile",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive",attr:{title:zd_js_obj.deletedoc}},this.delete_openfile={id:"delete_openfile",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive",attr:{title:zd_js_obj.deletedoc}},this.restore_openfile={id:"restore_openfile",label:zd_js_obj.restore,icon:"zdc-restoreicon_css",attr:{title:zd_js_obj.restore}},this.viewer={id:"zd_viewer_perm",label:zd_js_obj.read_only,icon:"viewer",attr:{title:zd_js_obj.read_only}},this.collaborator={id:"zd_collaborator_perm",label:zd_js_obj.read_write,icon:"collaborator",attr:{title:zd_js_obj.read_write}},this.coowner={id:"zd_coowner_perm",label:zd_js_obj.coowner,icon:"co-owner",attr:{title:zd_js_obj.coowner}},this.comment_only={id:"zd_comment_perm",label:zd_js_obj.label_read_comment,icon:"viewer",attr:{title:zd_js_obj.label_read_comment}},this.SCR_WTH="",this.SCR_HT="",this.searchType="relevance",this.createFolder={id:"createfolder",label:zd_js_obj.create,icon:"zdc-foldericon_css"},this.renameFolder={id:"renamefolder",label:zd_js_obj.rename,icon:"zdc-rename_css"},this.deleteFolder={id:"deletefolder",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive"},this.viewer_details={id:"viewer_details",label:zd_js_obj.read_only,icon:"viewer",attr:{title:zd_js_obj.read_only}},this.collaborator_details={id:"collaborator_details",label:zd_js_obj.read_write,icon:"collaborator",attr:{title:zd_js_obj.read_write}},this.coowner_details={id:"coowner_details",label:zd_js_obj.coowner,icon:"co-owner",attr:{title:zd_js_obj.coowner}},this.comment_details={id:"comment_details",label:zd_js_obj.label_read_comment,icon:"viewer",attr:{title:zd_js_obj.label_read_comment}},this.trimmedEmails="",this.trimmedPerGroupIds="",this.trimmedOrgGroupIds="",this.groupNameList=[],this.groupNameAndIdList=[],this.docId,this.allShareJson={},this.isInternalMailId=!0,this.isCo_owner=!1,this.isFolderShare=!1,this.isVisibility=!1,this.updateShareStatus=!1,this.folderIds,this.resIds,this.autocomplete_selectValue="",this.G_fromAutoComplete=[],this.G_zdc_permissionType="2",this.defaultText="",this.templateCount=0}function ATTACHDIALOG(){this.urlInvoker,this.moveUpFolder=!1,this.nextPage=!1,this.totalFiles="",this.nameSortArrow="",this.timeSortArrow="",this.sortOrder="",this.orderBy="",this.folderId="folder",this.parentFolderId="1",this.fromIndex="0",this.endIndex="10",this.prevIndex="1",this.nextIndex="10",this.docsPerPage="10",this.topLevelFetch="0",this.bottomLevelFetch="50",this.asLink="false",this.startFrom="0",this.fetchLimit="50",this.jsonData="",this.selectedLeftPanel="recentservicedocs",this.SCR_WTH="",this.SCR_HT="",this.folderId="folder",this.folderpermission="",this.searchenabled=!1,this.defaultObj={servicename:"",attachCount:"5",handbckobj:"",sharedDocs:!0,search:!0,workspace:!0,positionObj:[],isDraggable:!0,isResize:!1,height:570,width:650,staticURL:location.protocol+"//css.zohostatic.com/personal/docs_v492/docscomponents"},this.attachObj={},this.docsURL="",this.gridObj={documentNameHeader:!0,lastModifiedTimeHeader:!0,checkboxIconSpace:!0,checkboxIcon:"normalcheckboxicon_css flleft",hoverclass:"data-hover",documentIcon:!0,documentName:!0,authorName:!1,lastModifiedTime:!0}}function ADDDOCDIALOG(){this.urlInvoker,this.filename="",this.fileext="",this.folderid="-1",this.workspaceid="-1",this.wsfolderid="-1",this.issharedws=!1,this.SCR_WTH="",this.SCR_HT="",this.parentId=[],this.permission=[],this.folderlevel=[],this.rootvalue="",this.theme="lightgrey",this.docsURL="",this.defaultObj={servicename:"",filename:"",handbckobj:"",positionObj:[150,150],isDraggable:!0,isResize:!1,callback:""},this.adddocObj={},this.foldertree=[]}ZDDialog.showCommonDialog=function(title,isbgfreeze,dialogdiv,buttonObj,positionObj,width,isdraggable,height,isresize,minWidth,minHeight,zIndex){zIndex=zIndex?zIndex:1e4;ZD("#"+dialogdiv).dialog({autoOpen:!0,zIndex:zIndex,title:title,modal:isbgfreeze,resizable:isresize,closeText:"closeIcon",buttons:buttonObj,position:positionObj,width:width,minWidth:minWidth,minHeight:minHeight,draggable:isdraggable,height:height,drag:function(){if("sharedialogdiv"==dialogdiv){if(ZD("#zd_sharetextarea").is(":visible")){var elemTopPos=ZD("#zd_sharetextarea").offset().top,elemLeftPos=ZD("#zd_sharetextarea").offset().left;ZD(".zdc_shareautocompletedialog.ui-autocomplete").css({top:elemTopPos+45,left:elemLeftPos})}if(ZD("#zdc_visible_default_hidediv").is(":visible")){var elem=ZD("#zdc_visible_changelink"),elemPosition=ZD(elem).offset(),leftPosition=elemPosition.left-100,topPosition=elemPosition.top+30;ZD("#zdc_visible_default_hidediv").css({top:topPosition,left:leftPosition})}}},open:function(){ZD("#"+dialogdiv).parent().addClass("docsdialog").prev();if("undefined"!=typeof G_OF_OBJ&&!ZD("#docsdialoguidialogzindex").length&&"zohosheet"===G_OF_OBJ.urlInvoker){var uiDialogElem=ZD(this).closest(".ui-dialog"),zIndex=parseInt(uiDialogElem.css("z-index"))+5,style=document.createElement("style");style.type="text/css",style.id="docsdialoguidialogzindex";var cssString=".docsdialog.ui-dialog{z-index:";cssString+=zIndex+" !important;}",style.innerHTML=cssString,document.getElementsByTagName("head")[0].appendChild(style)}},resize:function(event,ui){ZDDialog.resizeDialog(event,ui,dialogdiv)}});return ZD("#"+dialogdiv).bind("dialogclose",function(){return ZDDialog.closePopUp(dialogdiv),ZD(document).trigger("dialogbeforeclose"),!1}),!1},ZDDialog.resizeDialog=function(ev,ui,dialogdiv){if("attachopenfiledialogdiv"==dialogdiv){var resize_height=ui.size.height-92;ZD("#showopenservicefilespace").css("height",resize_height),ZD("#showopenservicefilespace").openfiledatagrid("resize")}else if("sharedialogdiv"==dialogdiv){ZD("#zd_initial_sharetextarea").is(":visible")&&ZD("#zd_initial_sharetextarea").trigger("focus");var resize_height=ui.size.height-279;ZD("#sharedialogdiv").css("overflow","hidden"),ZD(".privateshare-list").css("height",resize_height),ZD("#zd_top_menu").is(":visible")&&ZD(".privateshare-list").css("height",resize_height-93)}else if("attachfiledialogdiv"==dialogdiv){var resize_height=ui.size.height-225;ZD("div#showattachfilespace").css("height",resize_height),ZD("div#showattachfilespace").attachfiledatagrid("resize")}else if("adddocdialogdiv"==dialogdiv){var resize_height=ui.size.height-255;ZD("div#tree_container").css("height",resize_height).parent().css("height",resize_height+40)}},ZDDialog.openAlert=function(title,message,icon,buttonObj,posobj,width,isdraggable){ZD("#frameDiv").remove(),(void 0==posobj||""==posobj)&&(posobj=[200,350]),width=350;var openAlertDiv=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(openAlertDiv).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:title,modal:!1,resizable:!1,closeText:"",buttons:buttonObj,position:posobj,width:width,draggable:isdraggable,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<span class="flleft icon_divider"></span><p>'+message+"</p>").removeAttr("style"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),!1}),ZD("#frameDiv").addClass("custommargin_lightgrey"),!1},ZDDialog.createNewFolderDialog=function(title,isbgfreeze,buttonObj,posobj,width,height){ZD("#createnewfolderdiv").remove();var folderDiv=ZD('<div id="createnewfolderdiv" style="display:none;"></div>');ZD(folderDiv).appendTo("body");ZD("#createnewfolderdiv").dialog({autoOpen:!0,zIndex:10008,title:title,modal:isbgfreeze,resizable:!1,closeText:"closeIcon",buttons:buttonObj,position:posobj,width:width,draggable:!0,height:height,open:function(){ZD("#createnewfolderdiv").parent().addClass("docsdialog")}});ZD("#createnewfolderdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("createnewfolderdiv"),!1})},ZDDialog.showValidatePasswordDialog=function(title,isbgfreeze,buttonObj,posobj,width,height){ZD("#passworddialogdiv").remove();var pwdDiv=ZD('<div id="passworddialogdiv" style="display:none;"></div>');ZD(pwdDiv).appendTo("body");ZD("#passworddialogdiv").dialog({autoOpen:!0,zIndex:10008,title:title,modal:isbgfreeze,resizable:!1,closeText:"closeIcon",buttons:buttonObj,position:posobj,width:width,draggable:!0,height:height,open:function(){ZD(".ui-dialog-titlebar-close").hide()},closeOnEscape:!1,open:function(){ZD("#passworddialogdiv").parent().addClass("docsdialog")}});ZD("#passworddialogdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("passworddialogdiv"),!1})},ZDDialog.showDialogForSendingMail=function(title,isbgfreeze,buttonObj,posobj,width,height){ZD("#securesharedialogdiv").remove();var pwdDiv=ZD('<div id="securesharedialogdiv" style="display:none;"></div>');ZD(pwdDiv).appendTo("body");ZD("#securesharedialogdiv").dialog({autoOpen:!0,zIndex:100008,title:title,modal:!1,resizable:!1,closeText:"closeIcon",buttons:buttonObj,position:posobj,width:width,draggable:!0,height:height,open:function(){ZD("#securesharedialogdiv").parent().addClass("docsdialog")}});ZD("#securesharedialogdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("securesharedialogdiv"),!1})},ZDDialog.closePopUp=function(dialogdiv,action){ZD("#"+dialogdiv).unbind("dialogclose"),"attachopenfiledialogdiv"==dialogdiv?(ZD("#zd_leftmenu,#zd_rightmenu").unbind().remove(),ZD("#recentservicedocs").addClass("selectedView"),ZD("#serviceDialogLeftPanel,#showopenservicefilespace,div#selectboxdiv,div#searchdivforservicefiles,#servicefilepagination,table.toolbar").undelegate(),ZD("#attachopenfiledialogdiv").unbind("dialogclose"),ZD("div#showopenservicefilespace").openfiledatagrid("destroy"),ZD("#attachopenfiledialogdiv").dialog("destroy"),ZD("#attachopenfiledialogdiv").filedialog("destroy").remove(),ZD("#createnewfolderdiv,#frameDiv").dialog("destroy").remove()):"passworddialogdiv"==dialogdiv?ZD("#passworddialogdiv").dialog("destroy").remove():"securesharedialogdiv"==dialogdiv?(ZD("#securesharedialogdiv").dialog("destroy").remove(),public_PwdExpiryDate="",ZD_G_CurrentVisibility=""):"linkdocsdialogdiv"==dialogdiv?(ZD("#recentservicedocs").addClass("selectedView"),ZD("div#showopenservicefilespace").linkdocsdatagrid("destroy"),ZD("#linkdocsdialogdiv").dialog("destroy"),ZD("#linkdocsdialogdiv").linkdocsdialog("destroy").remove()):"attachfiledialogdiv"==dialogdiv?(ZD("#attachfiledialogdiv").unbind("dialogclose"),ZD("#zd_leftmenu,#zd_rightmenu,#homeButton").unbind().remove(),ZD("#serviceDialogLeftPanel,#showattachfilespace,div#selectboxdiv,div#servicefilepagination").undelegate(),ZD("div#showattachfilespace").attachfiledatagrid("destroy").remove(),ZD("div#attachfiledialogdiv").attachfiledialog("destroy").remove(),ZD("#attachfiledialogdiv").dialog("destroy").remove()):"zdattachcontainer"==dialogdiv?(ZD("#zd_leftmenu,#zd_rightmenu,#homeButton").unbind().remove(),ZD("#serviceDialogLeftPanel,#showattachfilespace,div#selectboxdiv,div#servicefilepagination").undelegate(),ZD("div#showattachfilespace").attachfiledatagrid("destroy").remove(),ZD("#zdattachcontainer").attachfiledialog("destroy").remove()):"adddocdialogdiv"==dialogdiv?(ZD("#adddocdialogdiv").unbind("dialogclose"),ZD("#expand_view,#folder_container").undelegate(),ZD("#"+dialogdiv).dialog("destroy").remove()):"frameDiv"==dialogdiv||"createnewfolderdiv"==dialogdiv||"sharedialogdiv"==dialogdiv||"uploadConfirmDiv"==dialogdiv?("sharedialogdiv"==dialogdiv&&(ZD(".zdc_shareautocompletedialog.ui-autocomplete").remove(),ZD("#zd_leftmenu,#visibilityoptions_top").unbind(),ZD("#zd_leftmenu,#visibilityoptions_top").remove(),ZD("#sharedialogdiv").undelegate(),ZD("#zdc_visible_default_hidediv").undelegate(),ZD("body").undelegate("#sharedialogdiv, #zdc_visible_default_hidediv, .ui-widget-overlay","click"),ZD("#zd_sharetextarea").autocomplete("destroy"),ZD("#zd_sharetextarea,#share_via_link_edit").unbind(),ZD("#frameDiv").dialog("destroy").remove(),G_COMP_OBJ.isReqFromDocs&&ZDUtils.deSelectDocs(),G_OF_OBJ.autocomplete_selectValue="",G_OF_OBJ.trimmedPerGroupIds="",G_OF_OBJ.trimmedOrgGroupIds="",G_OF_OBJ.trimmedEmails="",G_OF_OBJ.G_fromAutoComplete=[],G_OF_OBJ.isCo_owner=!1),"passwordvalidation"!=action&&ZD("#zdc_visible_default_hidediv").remove(),ZD("#"+dialogdiv).dialog("destroy").remove()):"sharecollabupgradediv"==dialogdiv?ZD("#"+dialogdiv).dialog("destroy").remove():"mycollaboratorslistdiv"==dialogdiv?ZD("#"+dialogdiv).dialog("destroy").remove():"dialogdiv"==dialogdiv?ZD("#"+dialogdiv).html("").removeAttr("style").dialog("destroy"):"statusdialogdiv"==dialogdiv?ZD("#"+dialogdiv).dialog("destroy").remove():"customfieldsdialogdiv"===dialogdiv?(ZD("#"+dialogdiv).dialog("destroy").remove(),ZD("#"+dialogdiv).remove()):"sharefileaslinkcontainer"===dialogdiv&&(ZD("#"+dialogdiv).dialog("destroy").remove(),ZD("#"+dialogdiv).remove())},ZDDialog.showExternalUsersList=function(title,buttonObj,posobj,permissionType,list,isCoownerAllowed){ZD("#frameDiv").remove(),(void 0==posobj||""==posobj)&&(posobj=[200,350]),width=450;var openAlertDiv=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(openAlertDiv).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:title,modal:!1,resizable:!1,closeText:"",buttons:buttonObj,position:posobj,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return"invalidList"==list?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_users_listed_invalid+':</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"):3==permissionType&&"externalList"==list&&0==isCoownerAllowed?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_coowner_permission_not_allowed+'</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_continue_remove_users_share_again+"</div></div></div>").removeAttr("style"):ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_list_contains_people_not_part_organization+':</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_are_you_sure_you_want_to_share+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.showNonZohoUserList=function(title,buttonObj,posobj){ZD("#frameDiv").remove(),(void 0==posobj||""==posobj)&&(posobj=[200,350]),width=450;var tParty,openAlertDiv=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');tParty="NONE"==zd_third_party||""==zd_third_party||"undefined"==zd_third_party||void 0==zd_third_party?"zoho":zd_third_party.toLowerCase(),ZD(openAlertDiv).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:title,modal:!1,resizable:!1,closeText:"",buttons:buttonObj,position:posobj,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<div  style="display: block;"><div><div>'+ZDUtils.replaceParams(zd_js_obj.label_users_groups_listed_invalid,new Array(tParty))+':</div><div class="zdc-external-list"></div></div></div>').removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.showInactiveUserList=function(title,buttonObj,posobj){ZD("#frameDiv").remove(),(void 0==posobj||""==posobj)&&(posobj=[200,350]),width=450;var openAlertDiv=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(openAlertDiv).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:title,modal:!1,resizable:!1,closeText:"",buttons:buttonObj,position:posobj,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_users_listed_are_inactive+'</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.sharePolicyFailList=function(title,buttonObj,posobj,type,sendMailAction){ZD("#frameDiv").remove(),(void 0==posobj||""==posobj)&&(posobj=[200,350]),width=450;var openAlertDiv=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(openAlertDiv).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:title,modal:!1,resizable:!1,closeText:"",buttons:buttonObj,position:posobj,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return"ext_fail"==type?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>Your organization policy does not allow you to share with below users:</div><div class="zdc-external-list"></div><div>To continue sharing, please contact your administrator.</div></div></div>').removeAttr("style"):"accept_fail"==type&&ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>Organization policy of below user(s) does not allow you to share with them :</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),"undefined"==typeof sendMailAction&&(ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton()),!1}),!1},ZDDialog.showStatusDialog=function(title,isbgfreeze,posobj,width,height){var statusDiv=ZD('<div id="statusdialogdiv" style="display:none;"></div>');if(ZD(statusDiv).appendTo("body"),(""===posobj||void 0===posobj)&&(posobj=[SCR_WTH-SCR_WTH/1.6,SCR_HT-SCR_HT/1.6]),ZDdialog=ZD("#statusdialogdiv").dialog({autoOpen:!0,title:title,modal:isbgfreeze,resizable:!1,closeText:"",buttons:"",position:posobj,width:width,draggable:!0,height:height,open:function(){ZD(".ui-dialog-titlebar-close").hide()}}),!ZD("#statusdialogdiv").parent(".dialog-inner-container").length){var commonContainer=ZD('<div class="ui-corner-all dialog-inner-container" style="display:block;"></div>');commonContainer.insertBefore(ZD("#statusdialogdiv")).append(ZD("#statusdialogdiv"))}if(ZD(".sshow_layoutcontainer").length){var isinPreview=parseInt(ZD(".sshow_layoutcontainer").css("z-index"));ZD("#statusdialogdiv").closest(".ui-dialog").css("z-index",isinPreview+5)}ZD("#statusdialogdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("statusdialogdiv"),!1})},ZDDialog.showPreviewImg=function(documentname,docId,url){ZDDialog.showCommonDialog(documentname,!0,"dialogdiv","","",SCR_WTH/1.35,!0,SCR_HT/1.5);var temp_data='<div align="center"  style="padding:10px;"><img src="'+url+'" style="max-height:'+SCR_HT/1.5+'px" /></div>';ZD("#dialogdiv").html(temp_data)},ZDUtils.SIZE_CALC_WITH_BYTES=1024,ZDUtils.getHeight=function(){var h;return self.innerHeight?h=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?h=document.documentElement.clientHeight:document.body&&(h=document.body.clientHeight),h},ZDUtils.getWidth=function(){var w;return self.innerHeight?w=self.innerWidth:document.documentElement&&document.documentElement.clientHeight?w=document.documentElement.clientWidth:document.body&&(w=document.body.clientWidth),w},ZDUtils.isEmailId=function(str){if(!str)return!1;str=str.trim();var objRegExp=/^[a-zA-Z0-9]([\w\-\.\+]*)@([\w\-\.]*)(\.[a-zA-Z]{2,6}(\.[a-zA-Z]{2}){0,2})$/i;return objRegExp.test(str)},ZDUtils.substringName=function(name,length){var tempName=name;return tempName.length>length&&(tempName=tempName.substring(0,length),tempName+=".."),tempName},ZDUtils.escapeSpecialCharacters=function(name){name+="";var tempVar1=name.replace(/"/g,"&quot;"),tempVar2=tempVar1.replace(/'/g,"&apos;"),tempVar3=tempVar2.replace(/</g,"&lt;"),tempVar4=tempVar3.replace(/>/g,"&gt;");return tempVar4},ZDUtils.hasSpecialChar=function(value,action){var iChars="!@#$%^&*()+=-[]\\';,/{}|\":<>?";"docrename"==action?iChars="<>*%#&?\\',\"()":"emailidchk"==action&&(iChars="!#$%^&*()+=-[]\\';/{}|\":<>?");for(var specialCharCheck=1,i=0;i<value.length;i++)-1!=iChars.indexOf(value.charAt(i))&&(specialCharCheck+=1);return specialCharCheck>1?(FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.special_characters_validaton),!0):!1},ZDUtils.hasWhiteSpaceChar=function(value,action){return""===value?("renamefolder"==action?FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.folder_name_empty_validation):FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.document_name_empty_validation),!0):!1},ZDUtils.showAlertBox=function(message,action){"rename"==action?FILEDIALOG.statusmsg("failure_status boldText",message):"folder"==action?FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.folder_name_empty_validation):ZDDialog.openAlert(zd_js_obj.alert,message,!0)},ZDUtils.LoadingMsg=function(message){var msg=zd_js_obj.loading;""!=message&&void 0!=message&&(msg=message),ZD("#msgdiv").remove(),ZD("#openloadingmsg").append('<span  id="msgdiv" class="zdcomp_loading">'+msg+"</span>")},ZDUtils.hideLoadingMsg=function(){ZD("#openloadingmsg").children().remove()},ZDUtils.openFileLoadingMsg=function(message){var msg="Loading...";""!=message&&void 0!=message&&(msg=message);var height=ZD("#showopenservicefilespace").height()/2.2,width=ZD("#showopenservicefilespace").width()/2.2;ZD("#openfileloadingdiv").css({"margin-left":width,"margin-top":height,display:"block"}).find("span").html(msg)},ZDUtils.hideOpenFileLoadingMsg=function(){ZD("#openfileloadingdiv").hide()},ZDUtils.showLoading=function(divId,message){var msg=zd_js_obj.loading;void 0!=message&&""!=message&&(msg=message);var msgDivId=divId+"_msg";ZD("#"+msgDivId).remove(),ZD("#"+divId).append('<span  id="'+msgDivId+'" class="zdcomp_loading">'+msg+"</span>")},ZDUtils.hideLoading=function(divId){ZD("#"+divId).hide()},ZDUtils.getI18N=function(contextPath){ZDUtils.getUserRelatedDetails("",contextPath)},ZDUtils.split=function(val){return val.split(/,\s*/)},ZDUtils.extractLast=function(term){var string_type=term.toString();return ZD.trim(ZDUtils.split(string_type).pop())},ZDUtils.startsWithRegEx=function(str,prefix){var label=str.label,contactName=label.substring(0,label.indexOf("(")-1).trim();if((void 0==contactName||""==contactName)&&(contactName=label),contactName=contactName.toLowerCase(),prefix=prefix.toLowerCase(),contactName.substring(0,prefix.length)==prefix)return str;var lastName=ZDUtils.getLastNameOfContact(contactName);if(lastName=lastName.toLowerCase(),lastName.substring(0,prefix.length)==prefix)return str;var emailId=label.substring(label.indexOf("(")+1,label.length);return emailId=emailId.toLowerCase(),void 0==emailId||""==emailId?"":emailId.substring(0,prefix.length)==prefix?str:void 0},ZDUtils.getLastNameOfContact=function(contactName){var lastName=contactName.substring(contactName.lastIndexOf(" ")+1,contactName.length);return lastName},ZDUtils.getUserRelatedDetails=function(callbck,customURL){var url="/docs/zduserdetails.do";if(""!=customURL&&void 0!=customURL){var lastChar=customURL.charAt(customURL.length-1);"/"!=lastChar&&(customURL+="/"),url=customURL+"docs/zduserdetails.do"}var params="_t="+ZD.now()+"&"+(G_COMP_OBJ.isReqFromDocs?"service=docs":"");ZD.ajax({url:url,type:"GET",data:params,dataType:"html",success:function(data){if(ZD("#zd_user_details").remove(),ZD("body").append(data),zdcsrfPair=ZD("#zd_user_details").attr("csrfparamName")+"="+ZD("#zd_user_details").attr("csrftoken"),isCommonErrorPageEnabled&&("WRITER"==zd_serviceName||"SHEET"==zd_serviceName||"SHOW"==zd_serviceName||"DOCS"==zd_serviceName)&&!currentBrowserDetails.IS_SUPPORTED_BROWSER){var errorMsg=ZD("#browser-error-msg").html();if(null!=errorMsg)if(ZD(document).znotifier)ZD(document).znotifier({type:"warning",iconclass:"ui-components-icon ui-state-warning-icon",position:"north",content:errorMsg,autohide:!1});else{var errorDiv='<div id="browserErrorMsg" style="width: auto; text-align: center; margin: 0 auto; -webkit-border-bottom-right-radius: 7px; -webkit-border-bottom-left-radius: 7px; -moz-border-radius-bottomright: 7px; -moz-border-radius-bottomleft: 7px; border-bottom-right-radius: 7px; border-bottom-left-radius: 7px; -moz-box-shadow: 0px 0px 4px #d8d8d8; box-shadow: 0px 0px 4px #d8d8d8; -webkit-box-shadow: 0px 0px 4px #d8d8d8; box-shadow: 0px 0px 4px #d8d8d8; position: fixed; top: 0; z-index: 9999; left: 40%; margin-left: -25%; background: #fff; border-color: #d1d6ed; color: #000; padding: 10px; font-size: 12px; border-left: 1px solid #d1d6ed; border-right: 1px solid #d1d6ed; overflow: hidden; text-align: center; border-bottom-right-radius: 7px;">'+errorMsg+'<span style="padding-left: 5px; padding-right: 5px;">|</span><a href="javascript:void(0)" style="cursor: pointer; text-decoration: underline;" onclick="ZD(\'#browserErrorMsg\').hide();">'+zd_js_obj.label_close+"</a></div>";ZD("body").append(errorDiv)}}"undefined"==typeof ZD_G_ContactSearchEnabled&&(window.ZD_G_ContactSearchEnabled=!0),ZDUtils.getPlanType("",customURL),void 0!=callbck&&""!=callbck&&"function"==typeof callbck&&callbck()}})},ZDUtils.triggerUploadList=function(obj){var serviceName=ZD("#zd_user_details").attr("serviceName"),fileList=obj.files,fileName=fileList[0].fileName,fileSize=fileList[0].fileSize,totalFilesCount=0;(""==fileName||void 0==fileName)&&(fileName=fileList[0].name),(""==fileSize||void 0==fileSize)&&(fileSize=fileList[0].size);var fileExt=fileName.split(".")[fileName.split(".").length-1],totalFilesCount=0;if(fileSize>SIZE_CALC_WITH_BYTES*SIZE_CALC_WITH_BYTES)return alert("Upload files greater than 10MB"),ZDDialog.closePopUp("uploadConfirmDiv"),!1;if("WRITER"==serviceName){if("doc"!=fileExt.toLowerCase()&&"docx"!=fileExt.toLowerCase()&&"odt"!=fileExt.toLowerCase()&&"rtf"!=fileExt.toLowerCase())return alert("Only this files doc,docx,odt,rtf are allowed"),ZDDialog.closePopUp("uploadConfirmDiv"),totalFilesCount-=1,!1;ZDUtils.uploadProgress(obj)}else if("SHEET"==serviceName){if("xls"!=fileExt.toLowerCase()&&"xlsx"!=fileExt.toLowerCase()&&"sxc"!=fileExt.toLowerCase()&&"ods"!=fileExt.toLowerCase()&&"csv"!=fileExt.toLowerCase()&&"tsv"!=fileExt.toLowerCase())return alert("Only this files xls,xlsx,sxc,ods,csv,tsv are allowed"),ZDDialog.closePopUp("uploadConfirmDiv"),totalFilesCount-=1,!1;ZDUtils.uploadProgress(obj)}else if("SHOW"==serviceName){if("pptx"!=fileExt.toLowerCase()&&"ppsx"!=fileExt.toLowerCase()&&"ppt"!=fileExt.toLowerCase()&&"pps"!=fileExt.toLowerCase()&&"odp"!=fileExt.toLowerCase()&&"sxi"!=fileExt.toLowerCase())return alert("Only this files pptx,ppsx,ppt,pps,odp,sxi are allowed"),ZDDialog.closePopUp("uploadConfirmDiv"),totalFilesCount-=1,!1;ZDUtils.uploadProgress(obj)}},ZDUtils.uploadProgress=function(obj){var formId=ZDUtils.updateFileNameSelected(obj),uploadFileTdElement=ZD("#uploadfilediv"),targId="target"+(new Date).getTime(),formElem=(ZDUtils.createIframe(targId),ZDUtils.createForm(formId,targId)),cloneFileElem=(ZD(obj).parent(),ZD(obj).clone());ZD(cloneFileElem).unbind(),formElem.append(obj),uploadFileTdElement.append(formElem)},ZDUtils.updateFileNameSelected=function(currentFileElement){var originalfilename=ZD(currentFileElement).attr("value"),finalfilename=ZDUtils.getFileName(originalfilename);-1!=finalfilename.toLowerCase().indexOf(".zip")&&(finalfilename=finalfilename.substring(0,finalfilename.length-4)+".zip");var formId=(new Date).getTime();return ZDUtils.showFileList(finalfilename,formId,!1,!1),formId},ZDUtils.showFileList=function(tempFileName){return ZD(".fileinfo").text("Selected File"),ZD("#upload_detailview").text(tempFileName),ZD(".file_size_info").addClass("hidediv"),!1},ZDUtils.createIframe=function(frameName){var iframe=ZD('<iframe  name="'+frameName+'">').attr({height:"0",width:"0",id:frameName}).css("display","none");return ZD(iframe).appendTo("body"),iframe},ZDUtils.createForm=function(formId,targId){var formElem=ZD("<form></form>");return formElem.attr({id:"form-"+formId,target:targId,name:"form-"+formId,method:"POST",encType:"multipart/form-data",encoding:"multipart/form-data"}),formElem.css({margin:0,display:"none"}),formElem},ZDUtils.getFileName=function(path){var lastPathDelimiter,fileAndPath=path;lastPathDelimiter=fileAndPath.lastIndexOf(isWin||chrome7||isSafari?"\\":"/");var fileNameOnly=fileAndPath.substring(lastPathDelimiter+1);return fileNameOnly},ZDUtils.deSelectDocs=function(){var selectedDocs=ZD("div.selecteddoc");selectedDocs.each(function(){ZD(this).closest("div.dataDiv").removeClass("select"),ZD(this).attr("class","unselecteddoc"),ZD(this).children().attr("class","normalcheckboxicon_css")}),ZD("#selectAllCheckBox").hasClass("selectcheckboxicon_css")&&ZD("#selectAllCheckBox").attr({"class":"normalcheckboxicon_css",name:"allDocsUnSelected"})},ZDUtils.deSelectDoc=function(docId){ZD("div[id="+docId+"]").removeClass("select").find("div.selecteddoc").attr("class","unselecteddoc").children().attr("class","normalcheckboxicon_css")},ZDUtils.replaceParams=function(msg,args){if("undefined"!=args&&args.length>0)for(i=0;i<args.length;i++)msg=ZDUtils.replace(msg,"{"+i+"}",args[i]);return msg},ZDUtils.replace=function(msg,text,replaceBy){var strLength=msg.length,txtLength=text.length;if(0===strLength||0===txtLength)return msg;var i=msg.indexOf(text);if(!i&&text!=msg.substring(0,txtLength))return msg;if(-1==i)return msg;var newstr=msg.substring(0,i)+replaceBy;return strLength>i+txtLength&&(newstr+=ZDUtils.replace(msg.substring(i+txtLength,strLength),text,replaceBy)),newstr},ZDUtils.statusmsg=function(classname,statusmsg,containerdiv){ZD("#docs_statusmsg_div").length&&ZD("#docs_statusmsg_div").remove();var docs_statusmsg_div='<div style="width:100%;position:absolute;padding-top:5px;" id="docs_statusmsg_div"><div align="center"><span id="statusmsgdiv" class=""></span></div></div>';ZD("#"+containerdiv).prepend(docs_statusmsg_div),ZD("span#statusmsgdiv").attr("class",classname).html(statusmsg).parent().css("display","block"),setTimeout(function(){ZD("#docs_statusmsg_div").remove()},4e3)},ZDUtils.getMyContacts=function(author_coowner,customURL){var params;params="method=getContacts&_t="+ZD.now()+"&"+zdcsrfPair;var url=serviceUrl+"/docs/docsrequest.do";void 0!=customURL&&""!=customURL&&(url=customURL+"docs/docsrequest.do"),ZD.ajax({url:url,data:params,dataType:"json",type:"POST",success:function(response){docs_myContacts=response.contact_list}})},ZDUtils.getPersonalContacts=function(customURL){var params;params="method=getPersonalContacts&_t="+ZD.now()+"&"+zdcsrfPair;var url=serviceUrl+"/docs/docsrequest.do";void 0!=customURL&&""!=customURL&&(url=customURL+"docs/docsrequest.do"),ZD.ajax({url:url,data:params,dataType:"json",type:"POST",success:function(response){docs_myContacts=response.contact_list}})},ZDUtils.getPlanType=function(sendAsyncRequest,customURL){var asyncReq="undefined"==typeof sendAsyncRequest||""===sendAsyncRequest?!0:sendAsyncRequest;if(void 0!=customURL&&""!=customURL)var url=customURL+"docs/docsrequest.do?method=getPlanType";else var url=serviceUrl+"/docs/docsrequest.do?method=getPlanType";return ZD.ajax({async:asyncReq,url:url,dataType:"json",type:"GET",success:function(resp){zdcomp_userType=resp.response.result.PlanType.MESSAGE,("WRITER"==zd_serviceName||"SHEET"==zd_serviceName||"SHOW"==zd_serviceName||"DOCS"==zd_serviceName)&&("FREE_PLAN_TYPE"!=zdcomp_userType&&""!=zdcomp_userType&&void 0!=zdcomp_userType&&"undefined"!=typeof zdcomp_userType?"undefined"!=typeof ZD_G_ContactSearchEnabled&&ZD_G_ContactSearchEnabled||ZDUtils.getMyContacts("",customURL):"undefined"!=typeof ZD_G_ContactSearchEnabled&&ZD_G_ContactSearchEnabled||ZDUtils.getPersonalContacts(customURL))},error:function(){zdcomp_userType=""}}),!1},ZDUtils.getSelectedDocuments=function(){var grid="";"explorer"===G_SwitchTab?grid="#explorergrid":"workspace"===G_SwitchTab?grid="#wsdocsgrid":"group"===G_SwitchTab?grid="#showgroupdocspace":"tag"===G_SwitchTab?grid="#taggrid":"search"===G_SwitchTab&&(grid="#searchgrid");var selectedDocs=ZD("div.selectcheckboxicon_css",grid);return selectedDocs},ZDUtils.getOwnedSelectedDocs=function(){var selectedDocs=ZDUtils.getSelectedDocuments(),tmpElementArray=[];return selectedDocs.each(function(index){var tmpObj={},dataDiv=ZD(this).closest("div.dataDiv"),folderDiv=ZD(this).closest("div.folderDiv"),scope=dataDiv.data("scope");if(0===scope){var docId=dataDiv.attr("id"),permission=dataDiv.data("permission"),file_name=dataDiv.data("fileName"),encFile_name=dataDiv.data("encFileName"),encAttrFile_name=dataDiv.data("encAttrFileName"),encUrlFile_name=dataDiv.data("encUrlFileName"),service=dataDiv.data("serviceType"),filetype=dataDiv.data("fileType"),fileext=dataDiv.data("fileExt"),authorId=dataDiv.data("authorId"),className=dataDiv.data("classIconName"),encSharedDocId=dataDiv.data("encSharedDocId"),isDocAuthor=dataDiv.data("is_doc_author"),parentId=dataDiv.data("parentId"),fileId=dataDiv.attr("fileId");authorName=dataDiv.data("authorName"),isLocked=dataDiv.data("isLocked"),lockedBy=dataDiv.data("lockedBy"),tmpObj.isFolder=folderDiv.length?!0:!1,tmpObj.isDocAuthor=isDocAuthor,tmpObj.authorId=authorId,tmpObj.encSharedDocId=encSharedDocId,tmpObj.docId=docId,tmpObj.scope=scope,tmpObj.permission=permission,tmpObj.fileId=fileId,tmpObj.file_name=file_name,tmpObj.encFile_name=encFile_name,tmpObj.encAttrFile_name=encAttrFile_name,tmpObj.encUrlFile_name=encUrlFile_name,tmpObj.service=service,tmpObj.filetype=filetype,tmpObj.fileext=fileext,tmpObj.classname=className,tmpObj.authorName=authorName,tmpObj.parentId=parentId,tmpObj.isLocked=isLocked,tmpObj.lockedBy=lockedBy,tmpElementArray[index]=tmpObj,parseInt(tmpObj.scope)>0&&(sharedDocExist=!0)}else 1===scope&&(dataDiv.removeClass("select"),ZD(this).attr("class","normalcheckboxicon_css"))}),tmpElementArray},ZDUtils.getSelectedDocumentIds=function(){var selDocList=ZDUtils.getOwnedSelectedDocs();if(!selDocList.length)return alert("Document Visibility can be set for owned documents only."),!1;for(var selDocIds="",i=0;i<selDocList.length;i++)selDocIds+=selDocList[i].docId+",";return selDocIds},ZDUtils.insertDynamicButton=function(loadingText,index,containerId,isLoadingButton,actionToInvoke){var share_progress='<button style="margin-right:5px;"   class="ui-button ui-widget ui-state-default ui-corner-all  zd_dynamicbutton"><span class="ui-button-text">'+loadingText+"</span></button>";if(ZD("#"+containerId+" button:nth-child("+index+")").remove(),1==index?ZD("#"+containerId).prepend(share_progress):ZD("#"+containerId).append(share_progress),isLoadingButton){var loadingIconSpan='<span class="ui-button-icon-primary ui-icon ui-icon-loader"></span>';ZD(".zd_dynamicbutton").addClass("ui-button-disabled ui-state-disabled ui-status-icon ui-button-text-icon-primary").prepend(loadingIconSpan)}else ZD(".zd_dynamicbutton").addClass("ui-button-text-only");""!=actionToInvoke&&void 0!=actionToInvoke&&ZD(".zd_dynamicbutton").unbind().bind("click",function(){return actionToInvoke(),!1})},ZDUtils.loadComponentsStaticFiles=function(docsUrl,service,givenCallBackFunction){var regexToMatchIE=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/),callBackFunctionToLoadStaticFiles=(regexToMatchIE?parseInt(regexToMatchIE[1]):void 0,function(cssFilePath,jsFilePath){var headTag=document.getElementsByTagName("head")[0];if(!jQuery("#css_linkdocscomponents").length){var linkTag=document.createElement("link");linkTag.href=cssFilePath,linkTag.rel="stylesheet",linkTag.type="text/css",linkTag.id="css_linkdocscomponents",headTag.appendChild(linkTag)}if(!jQuery("#js_linkdocscomponents").length){var scriptTag=document.createElement("script");scriptTag.src=jsFilePath,scriptTag.type="text/javascript",scriptTag.id="js_linkdocscomponents",headTag.appendChild(scriptTag)}}),url=docsUrl+"/docs/docsrequest.do?method=loadComponentsStaticFiles",params="service="+service.toUpperCase()+"&_t="+(new Date).getTime();jQuery.ajax({url:url,type:"GET",dataType:"json",data:params,xhrFields:{withCredentials:!0},success:function(data){if("undefined"==typeof givenCallBackFunction){var cssStaticFilePath=data.cssfilepath,jsStaticFilePath=data.jsfilepath;callBackFunctionToLoadStaticFiles(cssStaticFilePath,jsStaticFilePath)}else givenCallBackFunction(data)}})},ZDUtils.loadZDCStaticFilesForEditors=function(service,jsFileToLoad,cssFileToLoad,givenCallBackFunction){var url=location.protocol+"//"+location.hostname+"/docs/docsrequest.do?method=loadComponentsStaticFiles",params="service="+service+"&_t="+(new Date).getTime();void 0!==jsFileToLoad&&(params+="&jsfilename="+jsFileToLoad),void 0!==cssFileToLoad&&(params+="&cssfileName="+cssFileToLoad),jQuery.ajax({url:url,type:"GET",dataType:"json",data:params,success:function(data){var cssStaticFilePath=data.cssfilepath,jsStaticFilePath=data.jsfilepath,jsFileName=(data.staticversiontoload,data.jsfilename),cssFileName=data.cssfilename;if("undefined"!=typeof givenCallBackFunction)givenCallBackFunction(data);else{var callBackFunctionToLoadStaticFiles=function(cssFilePath,jsFilePath){var headTag=document.getElementsByTagName("head")[0];if(!jQuery("#"+cssFileName).length){var linkTag=document.createElement("link");linkTag.href=cssFilePath,linkTag.rel="stylesheet",linkTag.type="text/css",linkTag.id=cssFileName,headTag.appendChild(linkTag)}if(!jQuery("#"+jsFileName).length){var scriptTag=document.createElement("script");scriptTag.src=jsFilePath,scriptTag.type="text/javascript",scriptTag.id=jsFileName,headTag.appendChild(scriptTag)}};callBackFunctionToLoadStaticFiles(cssStaticFilePath,jsStaticFilePath)}}})},ZDUtils.matchFullNameForCommentMentions=function(str,prefix){var contactName=str.name;return contactName=contactName.toLowerCase(),prefix=prefix.toLowerCase(),contactName.substring(0,prefix.length)===prefix?str:""},G_COMP_CONSTANTS=function(){this.isReqFromDocs=!1,this.serviceType=""};var G_COMP_OBJ=new G_COMP_CONSTANTS,zd_isIE="";!function(){var match=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/);zd_isIE=match?parseInt(match[1]):void 0}();var G_OF_OBJ,G_FormDataArray=[],G_FileDataArray=[],G_UploadIndexCounter=0,docs_myContacts=[],user_emailContacts=[],ZD=jQuery,zd_js_obj="",zdcsrfPair,isWin=-1!=navigator.appVersion.indexOf("Win")?!0:!1,isSafari=navigator.userAgent.toLowerCase().indexOf("safari")>-1,userAgent=navigator.userAgent.toLowerCase(),us=userAgent.substring(userAgent.indexOf("chrome/")+7),chrome7=parseInt(us.substring(us,us.indexOf(".")))>=7?!0:!1,zdcomp_userType,ZD_G_CurrentVisibility="private",public_PwdExpiryDate="",G_OF_OBJ;ATTACHDIALOG.initMenu=function(menuType){("left"==menuType||"both"==menuType)&&(ZD("#leftmenu,#visibilityoptions_top").zmenu().bind("menubeforeshow",function(e,ui){var result=ZDMenu.createLeftMenu(e,ui);return result}),ZD("#leftmenu,#visibilityoptions_top").bind("menuitemclicked",function(e,ui){return ZDMenu.leftMenuItemActions(e,ui),!0})),("right"==menuType||"both"==menuType)&&(ZD("#rightmenu").zmenu().live("menubeforeshow",function(e,ui){var result=ZDMenu.createContextMenu(e,ui);return result}),ZD("#rightmenu").live("menuitemclicked",function(e,ui){return ZDMenu.contextMenuItemActions(e,ui),!0}))},ATTACHDIALOG.attachDocsFiles=function(){var divs=ZD("div.selectbox","#selectboxdiv");if(0==divs.length)return ATTACHDIALOG.statusmsg(zd_js_obj.select_the_documents),void ZDUtils.hideLoadingMsg();var selectedDocs=ATTACHDIALOG.getSelectedDocs();if(selectedDocs.length>G_OF_OBJ.attachObj.attachCount)return ATTACHDIALOG.statusmsg(ZDUtils.replaceParams(zd_js_obj.validation_for_attachfile,new Array(G_OF_OBJ.attachObj.attachCount+""))),void ZDUtils.hideLoadingMsg();for(var tmpElementObj={},tmpElementArray=[],i=0,j=selectedDocs.length;j>i;i++){var tmpObj={},docId=selectedDocs[i].docId,docName=selectedDocs[i].docName,service=selectedDocs[i].service;service="zw"==service?"writer":"zohoshow"==service?"show":"zohosheet"==service?"sheet":"upload";var isDocumentSharedToMe=selectedDocs[i].isDocumentSharedToMe,encryptedId=selectedDocs[i].encryptedId;"undefined"==encryptedId&&(encryptedId=""),tmpObj.docId=docId,tmpObj.docName=docName,tmpObj.service=service,tmpObj.isDocumentSharedToMe=isDocumentSharedToMe,tmpObj.encryptedId=encryptedId,tmpElementArray[i]=tmpObj}tmpElementObj.docObj=tmpElementArray,tmpElementObj.handbckobj=G_OF_OBJ.attachObj.handbckobj,("salesInbox"==G_OF_OBJ.urlInvoker||"zpulse"==G_OF_OBJ.urlInvoker||"zmail"==G_OF_OBJ.urlInvoker||"zcrm"==G_OF_OBJ.urlInvoker||"discussion"==G_OF_OBJ.urlInvoker||"zcreator"==G_OF_OBJ.urlInvoker||"zprojects"==G_OF_OBJ.urlInvoker||"zwiki"==G_OF_OBJ.urlInvoker)&&attachDocsIntegCallBackFn(tmpElementObj),ZDDialog.closePopUp("attachfiledialogdiv")},ATTACHDIALOG.attachFiles=function(){var divs=ZD("div.selectbox","#selectboxdiv"),docIds="",docNames="",serviceTypes="",documentId="",documentName="",service="",sharedDocIds="",sharedDocNames="",sharedService="",encryptedId="",params="",isSharedDocument=!1,isNormalFile=!1,isSharedFile=!1;if(0==divs.length){var butObj={},temp_left=parseInt(ZD("#attachfiledialogdiv").parent().css("left"))+160,temp_top=parseInt(ZD("#attachfiledialogdiv").parent().css("top"))+180,positionObj=[temp_left,temp_top],draggable=G_OF_OBJ.attachObj.isDraggable;return butObj[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv")},void ZDDialog.openAlert(zd_js_obj.alert,zd_js_obj.select_the_documents,!0,butObj,positionObj,"",draggable)}var selectedDocs=ATTACHDIALOG.getSelectedDocs();if(selectedDocs.length>G_OF_OBJ.attachObj.attachCount){var butObj={},temp_left=parseInt(ZD("#attachfiledialogdiv").parent().css("left"))+160,temp_top=parseInt(ZD("#attachfiledialogdiv").parent().css("top"))+180,positionObj=[temp_left,temp_top],draggable=G_OF_OBJ.attachObj.isDraggable;return butObj[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv")},void ZDDialog.openAlert(zd_js_obj.alert,ZDUtils.replaceParams(zd_js_obj.validation_for_attachfile,new Array(G_OF_OBJ.attachObj.attachCount+"")),!0,butObj,positionObj,"",draggable)}for(var i=0,j=selectedDocs.length;j>i;i++)documentId=selectedDocs[i].docId,documentName=selectedDocs[i].docName,service=selectedDocs[i].service,isSharedDocument=selectedDocs[i].isDocumentSharedToMe,encryptedId=selectedDocs[i].encryptedId,"true"==isSharedDocument?(isSharedFile=!0,"zw"==service?(sharedDocIds=sharedDocIds+documentId+",",sharedService+="writer,"):"zohoshow"==service?(sharedDocIds=sharedDocIds+documentId+",",sharedService+="show,"):"zohosheet"==service?(sharedDocIds=sharedDocIds+documentId+",",sharedService+="sheet,"):(sharedDocIds=sharedDocIds+encryptedId+",",sharedService+="upload,"),sharedDocNames=sharedDocNames+encodeURIComponent(documentName)+","):(isNormalFile=!0,serviceTypes+="zw"==service?"writer,":"zohoshow"==service?"show,":"zohosheet"==service?"sheet,":"upload,",docIds=docIds+documentId+",",docNames=docNames+encodeURIComponent(documentName)+",");isNormalFile&&(docIds=docIds.substring(0,docIds.length-1),docNames=docNames.substring(0,docNames.length-1),serviceTypes=serviceTypes.substring(0,serviceTypes.length-1),params+="docIds="+docIds+"&docNames="+docNames+"&service="+serviceTypes),isNormalFile&&isSharedFile&&(params+="&"),isSharedFile&&(sharedDocIds=sharedDocIds.substring(0,sharedDocIds.length-1),sharedDocNames=sharedDocNames.substring(0,sharedDocNames.length-1),sharedService=sharedService.substring(0,sharedService.length-1),params+="sharedDocIds="+sharedDocIds+"&sharedDocNames="+sharedDocNames+"&sharedService="+sharedService),"discussion"==G_OF_OBJ.urlInvoker&&attachDocsIntegCallBackFn(params),ZDDialog.closePopUp("attachfiledialogdiv")},ATTACHDIALOG.getSelectedDocs=function(){var selectedDocs=ZD("div.selectbox","div#selectboxdiv"),tmpElementArray=[],doc_index=0;return selectedDocs.each(function(){if(!ZD(this).closest("div").hasClass("selectionblur")){var tmpObj={},dataDiv=ZD(this).closest("div"),docId=dataDiv.attr("docId"),docName=dataDiv.attr("docName"),service=dataDiv.attr("service"),docType=dataDiv.attr("fileType"),isDocumentSharedToMe=dataDiv.attr("isDocumentSharedToMe"),encryptedId=dataDiv.attr("encryptedId");tmpObj.docId=docId,tmpObj.docName=docName,tmpObj.docType=docType,tmpObj.service=service,tmpObj.docURL=G_OF_OBJ.docsURL+"/file/"+tmpObj.docId,tmpObj.isDocumentSharedToMe=isDocumentSharedToMe,tmpObj.encryptedId=encryptedId,tmpElementArray[doc_index]=tmpObj,doc_index++}}),tmpElementArray},ATTACHDIALOG.checkSelectedFiles=function(doc_id){var selectedDocs=ZD("div.selectbox","div#selectboxdiv"),docStatus=!1;return selectedDocs.each(function(){var dataDiv=ZD(this).closest("div"),permission=dataDiv.attr("permission"),scope=dataDiv.attr("scope");1==scope&&3!==permission&&(permission=""!==G_OF_OBJ.folderpermission?Number(G_OF_OBJ.folderpermission):2),"undefined"==permission||3==permission||0==permission||G_OF_OBJ.asLink!==!0||ZD("#selectedfile_"+dataDiv.attr("docId")).hasClass("selectionblur")||ZD("#selectedfile_"+dataDiv.attr("docId")).addClass("selectionblur"),doc_id===dataDiv.attr("docId")&&(docStatus=!0)}),docStatus},ATTACHDIALOG.getDocAsLink=function(){var selectedFileObj=ATTACHDIALOG.getSelectedDocs(),sharedLinkObj="",userPlanType="";sharedLinkObj=1===selectedFileObj.length&&"zw"===selectedFileObj[0].service?{recipentsofemail:{permission:"ro rw rc co",expirydate:!1,password:!1},everyoneinorg:{permission:"ro rw rc",expirydate:!1,password:!1},everyoneininternet:{expirydate:!0,permission:!1,password:!1},extshare:{permission:"ro rw rc",expirydate:!0,password:!0}}:{recipentsofemail:{permission:"ro rw co",expirydate:!1,password:!1},everyoneinorg:{permission:"ro rw",expirydate:!1,password:!1},everyoneininternet:{expirydate:!0,permission:!1,password:!1},extshare:{permission:"ro rw",expirydate:!0,password:!0}},0===PC_USER_PLAN_TYPE?userPlanType="FREE":1===PC_USER_PLAN_TYPE?userPlanType="STANDARD":2===PC_USER_PLAN_TYPE&&(userPlanType="PREMIUM");var fileObj={attachObj:selectedFileObj,shareLinkObj:sharedLinkObj,ZD_USER_PLAN_TYPE:userPlanType,isOrgEnable:zd_isorguser};return fileObj},ATTACHDIALOG.asLink=function(){G_OF_OBJ.asLink=!0,G_OF_OBJ.searchenabled===!0?ATTACHDIALOG.disableNonSharable():ZD("div#showattachfilespace").attachfiledatagrid("constructDocumentRows")},ATTACHDIALOG.asAttachment=function(){G_OF_OBJ.asLink=!1,G_OF_OBJ.searchenabled===!0?ATTACHDIALOG.disableNonSharable():(ZD("div#showattachfilespace").attachfiledatagrid("constructDocumentRows"),ZD("#selectboxdiv").find("div").removeClass("selectionblur"))},ATTACHDIALOG.getSelectedDocsForOpenFileDialog=function(){var selectedDocs=ZD("div#attachFileDataDiv table.zd_select"),tmpElementArray=[];return selectedDocs.each(function(index){var tmpObj={},targDiv=ZD(this).closest("div"),docId=targDiv.attr("id"),fileId=targDiv.data("fileId"),service=targDiv.data("service"),docName=targDiv.data("docName"),cssName=targDiv.data("cssName"),isDocumentSharedToMe=targDiv.data("isDocumentSharedToMe"),isTemplates=targDiv.data("isTemplates"),encryptedId=targDiv.data("encryptedId");tmpObj.docId=docId,tmpObj.fileId=fileId,tmpObj.file_name=docName,tmpObj.service=service,tmpObj.classname=cssName,tmpObj.isDocumentSharedToMe=isDocumentSharedToMe,tmpObj.encryptedId=encryptedId,tmpObj.isTemplates=isTemplates,tmpElementArray[index]=tmpObj}),tmpElementArray},ATTACHDIALOG.statusmsg=function(statusmsg){ZD("span#zd_statusmsgdiv").html(statusmsg).parent().css("display","block"),ZD("div.attach_message").css("margin-top","0px"),setTimeout(function(){ZD("span#zd_statusmsgdiv").html("").parent().css("display","none")},4e3)},ATTACHDIALOG.reset=function(){G_OF_OBJ.fromIndex="0",G_OF_OBJ.endIndex="10",G_OF_OBJ.prevIndex="1",G_OF_OBJ.nextIndex="10",G_OF_OBJ.startFrom="0",G_OF_OBJ.gridObj.authorName=!1},ATTACHDIALOG.selectRow=function(docId){ZD("#"+docId).find("td.checkboxtd").children().removeClass("normalcheckboxicon_css").addClass("selectcheckboxicon_css"),ZD("#"+docId).children("table.data-hover").addClass("zd_select")},ATTACHDIALOG.deselectRow=function(docId){ZD("#"+docId).find("td.checkboxtd").children().removeClass("selectcheckboxicon_css").addClass("normalcheckboxicon_css"),ZD("#"+docId).children("table.data-hover").removeClass("zd_select"),ZD("#selectedfile_"+docId).length&&ZD("#selectedfile_"+docId).remove()},ATTACHDIALOG.showSelectedDocsToAttach=function(element){var currentObj=ZD(element).closest("div.documentDataDiv"),docId=currentObj.attr("id");if(ZD(element).find(".checkboxtd").children().hasClass("selectcheckboxicon_css"))return void ATTACHDIALOG.deselectRow(docId);ATTACHDIALOG.selectRow(docId);var service=currentObj.attr("serviceType");void 0===service&&(service=ZD("#"+docId).data("service"));var isDocumentSharedToMe=currentObj.attr("isDocumentSharedToMe"),encryptedId=currentObj.attr("encryptedId"),docName=currentObj.data("encAttrFileName");void 0===docName&&(docName=ZD("#"+docId).data("encfilename"));var permission=currentObj.data("permission"),fileType=ZD("#"+docId).data("fileType"),displayDocName=ZDUtils.substringName(docName,"10"),selectedElement='<div class="selectbox flleft" style="overflow:hidden;" id="selectedfile_'+docId+'" fileType="'+fileType+'" permission="'+permission+'"  docId="'+docId+'" docName="'+docName+'" service="'+service+'" isDocumentSharedToMe="'+isDocumentSharedToMe+'" encryptedId="'+encryptedId+'"><span class="flleft" title="'+docName+'" alt="'+docName+'">'+displayDocName+'</span><span action="delete" id="'+docId+'_delete" class="closeBtn_css flleft cursor cls" alt="'+zd_js_obj.remove+'" title="'+zd_js_obj.remove+'"></span></div>';if(ZD("#selectboxdiv").append(selectedElement),G_OF_OBJ.asLink===!0&&currentObj.hasClass("opacityshare")){var statusMsg="You can share only the files you own or co-own via link. Please add as attachment.";void 0!=zd_js_obj.label_alert_while_click_shared&&(statusMsg=zd_js_obj.label_alert_while_click_shared),ATTACHDIALOG.statusmsg(statusMsg),ZD("#selectedfile_"+docId).addClass("selectionblur")}},ATTACHDIALOG.selectOrdeselectRow=function(docId,elem){var docDiv=ZD(elem).closest(".documentDataDiv"),isSelected=(currentObj.attr("id"),docDiv.children("table.data-hover").hasClass("zd_select"));return isSelected?(docDiv.find("td.checkboxtd").children().removeClass("selectcheckboxicon_css").addClass("normalcheckboxicon_css"),docDiv.children("table.data-hover").removeClass("zd_select")):(docDiv.find("td.checkboxtd").children().removeClass("normalcheckboxicon_css").addClass("selectcheckboxicon_css"),docDiv.children("table.data-hover").addClass("zd_select")),!1},ATTACHDIALOG.clearSelectedRows=function(){var selectedTables=ZD("#attachFileDataDiv").find("div.documentDataDiv").children("table.zd_select");ZD(selectedTables).each(function(i,item){ZD(item).removeClass("zd_select"),ZD(item).find("td.checkboxtd").children().toggleClass("normalcheckboxicon_css selectcheckboxicon_css")})},ATTACHDIALOG.getSharedDocs=function(start,field,action){ATTACHDIALOG.LoadingMsg(zd_js_obj.loading),G_OF_OBJ.selectedLeftPanel="shareddocs",null==start&&(start=0),null==field&&(field="time"),null==action&&(action="desc");var url=G_OF_OBJ.docsURL+"/docs/viewsearchresults.do?method=attachFileSharedDocs&start="+start+"&field="+field+"&action="+action+"&_t="+(new Date).getTime(),items=ZD("#showattachfilespace").children();ZD(items).each(function(i,item){ZD(item).empty().remove()}),ZD.ajax({url:url,xhrFields:{withCredentials:!0},type:"POST",datatype:"html",success:function(data){ZD("#showattachfilespace").html(data),ATTACHDIALOG.hideLoadingMsg(),ATTACHDIALOG.updateSelectedDocs()}})},ATTACHDIALOG.clearText=function(){"Searchfiles"==ZD("#searchFileName").value&&(ZD("#searchFileName").value="")},ATTACHDIALOG.LoadingMsg=function(message){var msg=zd_js_obj.loading;""!=message&&void 0!=message&&(msg=message),ZD("#msgdiv").remove(),ZD("#openloadingmsg").append('<span  id="msgdiv" style="padding:3px 5px;background-color:#848484;color:#FFF;font-size:11px;font-weight:bold;text-align:center;right:3px;position:absolute;">'+msg+"</span>")},ATTACHDIALOG.hideLoadingMsg=function(){ZD("#openloadingmsg").children().remove()},ATTACHDIALOG.getDocAsList=function(elem,id){var elemId;""!=elem&&void 0!=elem?elemId=ZD(elem).attr("id"):""!=id&&void 0!==id&&(elemId=id),ZD("#actionMenuOpenFile").css("display","block"),("desktopservicedocs"===elemId||"sharedservicedocs"===elemId)&&(G_OF_OBJ.folderId="folder"),"workspacelist"===elemId&&(G_OF_OBJ.folderId="wshome",G_OF_OBJ.wsId="wshome"),""!=elemId&&void 0!=elemId&&(ATTACHDIALOG.changeAllToNormalView(elemId),G_OF_OBJ.selectedLeftPanel=elemId),ATTACHDIALOG.resetAll();var gridOptions=G_OF_OBJ.gridObj;ZD("#sharedservicedocs").hasClass("selectedView")&&(gridOptions.authorName=!0),ZD("div#showattachfilespace").attachfiledatagrid("populateDataPanel",gridOptions)},ATTACHDIALOG.getSortDocAsList=function(elem,id){var elemId;""!=elem&&void 0!=elem?elemId=ZD(elem).attr("id"):""!=id&&void 0!==id&&(elemId=id),ZD("#actionMenuOpenFile").css("display","block"),""!=elemId&&void 0!=elemId&&(ATTACHDIALOG.changeAllToNormalView(elemId),G_OF_OBJ.selectedLeftPanel=elemId),ATTACHDIALOG.resetAll();var gridOptions=G_OF_OBJ.gridObj;"sharedservicedocs"==elemId&&(gridOptions.authorName=!0),ZD("div#showattachfilespace").attachfiledatagrid("populateDataPanel",gridOptions)},ATTACHDIALOG.resetAll=function(){ATTACHDIALOG.reset();var items=ZD("#showattachfilespace").children();ZD(items).each(function(i,item){ZD(item).empty().remove()}),ZD("#showattachfilespace").attachfiledatagrid("resetOptions"),ZD("#servicefilepagination").css("display","none")},ATTACHDIALOG.changeAllToNormalView=function(id){ZD("#serviceDialogLeftPanel").find("td.selectedView").toggleClass("selectedView normalView"),""!=id&&void 0!=id&&ZD("#"+id).addClass("selectedView").removeClass("normalView")},ATTACHDIALOG.setSortOrder=function(obj){var sortId=ZD(obj).attr("id");G_OF_OBJ.nameSortArrow=ZD(obj).children().attr("class"),G_OF_OBJ.timeSortArrow=ZD(obj).children("img").attr("class"),"nameHeader"==sortId?(G_OF_OBJ.timeSortArrow="",G_OF_OBJ.sortOrder="",G_OF_OBJ.orderBy="name",G_OF_OBJ.sortOrder=ZD(obj).children().hasClass("DownArrow")?"asc":"desc"):"dateModifiedHeader"==sortId&&(G_OF_OBJ.nameSortArrow="",G_OF_OBJ.sortOrder="",G_OF_OBJ.orderBy="date",G_OF_OBJ.sortOrder=ZD(obj).children().hasClass("DownArrow")?"asc":"desc")},ATTACHDIALOG.setClassAfterSorting=function(obj){var sortId=ZD(obj).attr("id");"nameHeader"==sortId?(ZD("#dateModifiedHeader").children("img:first").removeClass().addClass("DownArrowH"),ZD("#"+sortId).children("img:first").removeClass().addClass("UpArrow"==G_OF_OBJ.nameSortArrow?"DownArrow":"UpArrow")):"dateModifiedHeader"==sortId&&(ZD("#nameHeader").children("img:first").removeClass().addClass("DownArrowH"),ZD("#"+sortId).children("img:first").removeClass().addClass("UpArrow"==G_OF_OBJ.timeSortArrow?"DownArrow":"UpArrow"))},ATTACHDIALOG.getUserDocsPlan=function(docsURL){var url=docsURL+"/docs/zduserdetails.do",fileObj={};return ZD.ajax({url:url,type:"GET",dataType:"html",async:!1,cache:!1,xhrFields:{withCredentials:!0},success:function(data){ZD("#zd_user_details").remove(),ZD("body").append(data),ZD(data).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),zdcsrfPair=ZD("#zd_user_details").attr("csrfparamName")+"="+ZD("#zd_user_details").attr("csrftoken"),0===PC_USER_PLAN_TYPE?userPlanType="FREE":1===PC_USER_PLAN_TYPE?userPlanType="STANDARD":2===PC_USER_PLAN_TYPE&&(userPlanType="PREMIUM"),fileObj={ZD_USER_PLAN_TYPE:userPlanType,isOrgEnable:zd_isorguser}}}),fileObj},ATTACHDIALOG.getI18N=function(callbck,docsURL){var url=docsURL+"/docs/zduserdetails.do";ZD.ajax({url:url,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(data){ZD("#zd_user_details").remove(),ZD("body").append(data),ZD(data).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),zdcsrfPair=ZD("#zd_user_details").attr("csrfparamName")+"="+ZD("#zd_user_details").attr("csrftoken"),void 0!=callbck&&""!=callbck&&callbck()}})},ATTACHDIALOG.checkWorkspaceStatus=function(callbck,docsURL){var url=docsURL+"/docs/attachfilerequest.do?method=checkWorkspaceStatus";ZD.ajax({url:url,type:"GET",xhrFields:{withCredentials:!0},dataType:"json",success:function(data){void 0!=callbck&&""!=callbck&&callbck(data.status)}})},ATTACHDIALOG.showAttachFileDialog=function(obj,isWorkspaceEnable){var docsURL=obj.docsURL;if(void 0==zd_js_obj||""==zd_js_obj){G_OF_OBJ=new ATTACHDIALOG;var callbck=function(){ATTACHDIALOG.showAttachFileDialog(obj,isWorkspaceEnable)};return ATTACHDIALOG.getI18N(callbck,docsURL),!1}if(void 0===isWorkspaceEnable||""===isWorkspaceEnable){var callbckFunc=function(wsStatus){ATTACHDIALOG.showAttachFileDialog(obj,wsStatus)};return ATTACHDIALOG.checkWorkspaceStatus(callbckFunc,docsURL),!1}if(!ZD("#attachfiledialogdiv").length||1==obj.isnewui&&"zmail"==G_OF_OBJ.urlInvoker){"undefined"==typeof G_OF_OBJ&&(G_OF_OBJ=new ATTACHDIALOG),G_OF_OBJ.docsURL=docsURL,"undefined"!=typeof ZOHO_CN&&"true"===ZOHO_CN&&(G_OF_OBJ.defaultObj.staticURL=location.protocol+"//css.zohostatic.com.cn/personal/docs_v481/docscomponents"),G_OF_OBJ.attachObj=ZD.extend({},G_OF_OBJ.defaultObj,obj),G_OF_OBJ.urlInvoker=G_OF_OBJ.attachObj.servicename,G_OF_OBJ.attachObj.staticURL=location.protocol+"//"+css_lable+"."+compStaticServer+"/personal/docs_"+staticVersionToLoad,G_OF_OBJ.spacerImagePath=G_OF_OBJ.attachObj.staticURL+"/images/spacer.gif",ZD("body").append('<div id="attachfiledialogdiv" style="display:none;">'),ZD("body").append('<ul id="zd_leftmenu" style="display:none;"></ul>'),ZD("body").append('<ul id="zd_rightmenu" style="display:none;"></ul>');var buttonObj={};"zmail"==G_OF_OBJ.urlInvoker&&1==obj.isnewui?(ZD("#"+obj.container_id).append('<div id="zdattachcontainer">'),$("#zdattachcontainer").addClass("docsdialog")):("discussion"==G_OF_OBJ.urlInvoker?buttonObj[zd_js_obj.label_attach]=function(){ATTACHDIALOG.attachFiles()}:("zpulse"==G_OF_OBJ.urlInvoker||"zmail"==G_OF_OBJ.urlInvoker||"zcrm"==G_OF_OBJ.urlInvoker||"zcreator"==G_OF_OBJ.urlInvoker||"zprojects"==G_OF_OBJ.urlInvoker||"zwiki"==G_OF_OBJ.urlInvoker||"salesInbox"==G_OF_OBJ.urlInvoker)&&(buttonObj[zd_js_obj.label_attach]=function(){ATTACHDIALOG.attachDocsFiles()}),buttonObj[zd_js_obj.cancel]=function(){ZDDialog.closePopUp("attachfiledialogdiv")});var positionObj=G_OF_OBJ.attachObj.positionObj,isDraggable=G_OF_OBJ.attachObj.isDraggable,isResize=G_OF_OBJ.attachObj.isResize,dialog_height=G_OF_OBJ.attachObj.height,dialog_width=G_OF_OBJ.attachObj.width,searchEnable=!0,workspaceEnable="undefined"!=typeof isWorkspaceEnable?isWorkspaceEnable:G_OF_OBJ.attachObj.workspace,sharedDocsEnable=G_OF_OBJ.attachObj.sharedDocs,minHeight=400;zd_isIE&&"zcrm"==G_OF_OBJ.urlInvoker&&(minHeight=600),G_OF_OBJ.attachObj.search||(searchEnable=!1),"zmail"==G_OF_OBJ.urlInvoker?dialog_height-=64:("zcrm"==G_OF_OBJ.urlInvoker||"salesInbox"==G_OF_OBJ.urlInvoker)&&(dialog_height-=24);var zdRebrandClassName="undefined"!=typeof zd_third_party&&"FUJI"===zd_third_party?"fujidocs":"undefined"!=typeof zd_third_party&&"BAIHUI"===zd_third_party?"baihuidocs":"";"zmail"==G_OF_OBJ.urlInvoker&&1==obj.isnewui?(ZD("div#zdattachcontainer").addClass(zdRebrandClassName).attachfiledialog({recentDocs:{name:zd_js_obj.label_recent_docs,title:zd_js_obj.label_recent_docs},desktopDocs:{name:zd_js_obj.my_folders,title:zd_js_obj.my_folders},myDocs:{name:zd_js_obj.label_my_docs,title:zd_js_obj.label_my_docs},mySheets:{name:zd_js_obj.label_my_spreadsheets,title:zd_js_obj.label_my_spreadsheets},myPresentations:{name:zd_js_obj.label_my_presentations,title:zd_js_obj.label_my_presentations},myPictures:{name:zd_js_obj.label_my_pictures,title:zd_js_obj.label_my_pictures},sharedDocs:{show:sharedDocsEnable,name:zd_js_obj.shared_with_me,title:zd_js_obj.shared_with_me},workspace:{show:workspaceEnable,name:zd_js_obj.label_workspaces,title:zd_js_obj.label_workspaces},trashedDocs:{show:!1},upOneLevel:!0,advSearchBox:searchEnable}),$("#selectboxdiv").css("height",50),G_OF_OBJ.asLink=!1):(ZDDialog.showCommonDialog(zd_js_obj.label_attach_from_zoho_docs,!0,"attachfiledialogdiv",buttonObj,positionObj,dialog_width,isDraggable,dialog_height,isResize,450,minHeight),("zpulse"==G_OF_OBJ.urlInvoker||"zmail"==G_OF_OBJ.urlInvoker||"zcrm"==G_OF_OBJ.urlInvoker||"discussion"==G_OF_OBJ.urlInvoker||"zcreator"==G_OF_OBJ.urlInvoker||"zprojects"==G_OF_OBJ.urlInvoker||"zwiki"==G_OF_OBJ.urlInvoker||"salesInbox"==G_OF_OBJ.urlInvoker)&&ZD("div#attachfiledialogdiv").addClass(zdRebrandClassName).attachfiledialog({recentDocs:{name:zd_js_obj.label_recent_docs,title:zd_js_obj.label_recent_docs},desktopDocs:{name:zd_js_obj.my_folders,title:zd_js_obj.my_folders},myDocs:{name:zd_js_obj.label_my_docs,title:zd_js_obj.label_my_docs},mySheets:{name:zd_js_obj.label_my_spreadsheets,title:zd_js_obj.label_my_spreadsheets},myPresentations:{name:zd_js_obj.label_my_presentations,title:zd_js_obj.label_my_presentations},myPictures:{name:zd_js_obj.label_my_pictures,title:zd_js_obj.label_my_pictures},sharedDocs:{show:sharedDocsEnable,name:zd_js_obj.shared_with_me,title:zd_js_obj.shared_with_me},workspace:{show:workspaceEnable,name:zd_js_obj.label_workspaces,title:zd_js_obj.label_workspaces},trashedDocs:{show:!1},upOneLevel:!0,advSearchBox:searchEnable})),"zprojects"==G_OF_OBJ.urlInvoker&&ZD("div#attachfiledialogdiv").parent().css({"box-shadow":"0 0 8px #B0B0B0","-moz-box-shadow":"0 0 8px #B0B0B0","-webkit-box-shadow":"0 0 8px #B0B0B0","z-index":"999999999"}),ZD("div#showattachfilespace").attachfiledatagrid()}},ATTACHDIALOG.clearSelectedFiles=function(){for(var selObj=ATTACHDIALOG.getSelectedDocsForOpenFileDialog(),i=0,j=selObj.length;j>i;i++){var docId=selObj[i].docId;ATTACHDIALOG.selectOrdeselectRow(docId)}},ATTACHDIALOG.split=function(val){return val.split(/,\s*/)},ATTACHDIALOG.extractLast=function(term){return ATTACHDIALOG.split(term).pop()},ATTACHDIALOG.startsWithRegEx=function(str,prefix){var email=str.label,regex1="^"+prefix.toLowerCase();if(email.toLowerCase().match(regex1)==prefix.toLowerCase())return str;var fullname=str.fullname;return fullname.toLowerCase().match(regex1)==prefix.toLowerCase()?str:""},ATTACHDIALOG.showHideShareMsg=function(elem){var isAvail=ZD(elem).hasClass("editmsg_add");isAvail?(ZD(elem).text("Discard Message"),ZD(elem).removeClass("editmsg_add"),ZD("#shareMsgDiv").removeClass("hidediv").children("textarea").focus()):(ZD(elem).text("Add Message"),ZD(elem).addClass("editmsg_add"),ZD("#shareMsgDiv").addClass("hidediv").children("textarea").val(""))},ATTACHDIALOG.showHideMsg=function(elem){var isChecked=ZD(elem).attr("checked");isChecked?(ZD(".docsdialog .checkbox_add").text("Add Message"),ZD("#shareMsgDiv").removeClass("hidediv").children("textarea").focus()):(ZD(".docsdialog .checkbox_add").text(""),ZD("#shareMsgDiv").addClass("hidediv").children("textarea").val(""))},ATTACHDIALOG.searchMouseOver=function(field,selfield,id,action){field!=selfield&&("asc"==action?ZD("#"+id).attr("class","UpArrow"):ZD("#"+id).attr("class","DownArrow"))},ATTACHDIALOG.searchMouseOut=function(field,selfield,id){field!=selfield&&ZD("#"+id).attr("class","")},ATTACHDIALOG.searchFile=function(searchquery){var searchquery=ZD("#searchFileName").val();return"*"===ZD.trim(searchquery)||""===ZD.trim(searchquery)?(ATTACHDIALOG.statusmsg(zd_js_obj.enter_valid_text_search),void ZDUtils.hideLoadingMsg()):(ATTACHDIALOG.changeAllToNormalView(),G_OF_OBJ.selectedLeftPanel="search",void ATTACHDIALOG.getSearchResults(searchquery,0))},ATTACHDIALOG.searchSorting=function(field,action){var searchquery=ZD("#searchFileName").val();null==field&&(field="time"),null==action&&(action="desc"),ATTACHDIALOG.getSearchResults(searchquery,0,field,action)},ATTACHDIALOG.getSearchResults=function(searchquery,start,field,action){ZDUtils.LoadingMsg(zd_js_obj.loading),null==start&&(start=0),null==field&&(field="time"),null==action&&(action="desc");var items=ZD("#showopenservicefilespace").children();ZD(items).each(function(i,item){ZD(item).empty().remove()});var items=ZD("#showattachfilespace").children();ZD(items).each(function(i,item){ZD(item).empty().remove()});var url=G_OF_OBJ.docsURL+"/docs/viewsearchresults.do?method=attachFileSearch&start="+start+"&field="+field+"&action="+action+"&searchquery="+encodeURIComponent(searchquery)+"&category="+G_OF_OBJ.urlInvoker+"&_t="+(new Date).getTime();ZD.ajax({url:url,xhrFields:{withCredentials:!0},datatype:"html",success:function(data){ZD("#showattachfilespace").html(data),ZD("#attachFileDataDiv strong").first().empty(),ZD("#attachFileDataDiv").css("height","302px"),ZDUtils.hideLoadingMsg(),ATTACHDIALOG.updateSelectedDocs()}})},ATTACHDIALOG.constructSearchResults=function(searchResponse,searchContainer){for(var documentContainerDiv='<div id="attachFileDataDiv" class="zd_scroll" style="padding-bottom:5px;vertical-align:top;border:0px solid #000000;height:320px;"><table class="docs-tabledata" width="100%" cellpadding="0" cellspacing="0" border="0" align="center">',searchDocumentCount=searchResponse.documentListContainer.length,searchDocumentsList=searchResponse.documentListContainer,i=0;searchDocumentCount>i;i++){var searchedDoc=searchDocumentsList[i],encAttrDocId=searchedDoc.encAttrDocId,encAttrDocName=searchedDoc.encAttrDocName,encDocName=searchedDoc.encDocName,encUrlDocName=searchedDoc.encUrlDocName,encAttrService=searchedDoc.encAttrService,encAttrAuthorId=searchedDoc.encAttrAuthorId,encAttrFileType=searchedDoc.encAttrFileType,enclastEdited=searchedDoc.enclastEdited,encAttrFileExtn=searchedDoc.encAttrFileExtn,encAttrEncryptedIds=searchedDoc.encAttrEncryptedIds,encAttrClassName=searchedDoc.encAttrClassName,isDocSharedToMe=(searchedDoc.isAuthor,searchedDoc.isDocumentSharedToMe),indexType=searchedDoc.indexType,encAuthorName=(searchedDoc.shareicon,searchedDoc.sharetitle,searchedDoc.encAuthorName);G_OF_OBJ.asLink===!0&&ATTACHDIALOG.getPermission(encAttrDocId),documentContainerDiv+='<tr><td nowrap="nowrap"><div class="documentDataDiv docs-tablediv " id="'+encAttrDocId+'" fileName="'+encAttrDocName+'" data-fileName="'+encAttrDocName+'" data-encFileName="'+encDocName+'" data-encUrlFileName="'+encUrlDocName+'"  data-serviceType="'+encAttrService+'" data-authorId="'+encAttrAuthorId+'" data-author="'+encAuthorName+'" data-indexType="'+indexType+'" data-fileType="'+encAttrFileType+'" data-authorName="'+encAuthorName+'" data-service ="'+encAttrService+'" data-fileExt="'+encAttrFileExtn+'"    data-encryptedId="'+encAttrEncryptedIds+'" isDocumentSharedToMe="'+isDocSharedToMe+'">',documentContainerDiv+=ZD("#selectedfile_"+encAttrDocId).length?'<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="data-hover zd_select"><tr><td colspan="4" nowrap="nowrap" width="100%"><table width="100%" cellpadding="0" border="0" class="docs-tablerow"><tr><td width="20" height="20" class="docscursor checkboxtd" elem="checkbox"><img src="'+G_OF_OBJ.spacerImagePath+'" class="selectcheckboxicon_css flleft"/></td><td nowrap="nowrap" width="20" elem="documenticon" ><div class="'+encAttrClassName+'"/></td><td nowrap="nowrap" align="left" elem="documenticon"><span title="'+encAttrDocName+'" class="docscursor">'+encDocName+'</span></td><td width="50" nowrap="nowrap" align="center"><span>&nbsp;</span></td><td width="110" nowrap="nowrap"><span>&nbsp;'+encAuthorName+'</span></td><td width="100" nowrap="nowrap"><span class="pad-lft">'+enclastEdited+"</span></td></tr></table></td></tr></table></div>":'<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="data-hover"><tr><td colspan="4" nowrap="nowrap" width="100%"><table width="100%" cellpadding="0" border="0" class="docs-tablerow"><tr><td width="20" height="20" class="docscursor checkboxtd" elem="checkbox"><img src="'+G_OF_OBJ.spacerImagePath+'" class="normalcheckboxicon_css flleft"/></td><td nowrap="nowrap" width="20" elem="documenticon" ><div class="'+encAttrClassName+'"/></td><td nowrap="nowrap" align="left" elem="documenticon"><span title="'+encAttrDocName+'" class="docscursor">'+encDocName+'</span></td><td width="50" nowrap="nowrap" align="center"><span>&nbsp;</span></td><td width="110" nowrap="nowrap"><span>&nbsp;'+encAuthorName+'</span></td><td width="100" nowrap="nowrap"><span class="pad-lft">'+enclastEdited+"</span></td></tr></table></td></tr></table></div>"}documentContainerDiv+="</td></tr></table></div>",searchContainer.append(documentContainerDiv);var field=searchResponse.field,changeSortingAction=searchResponse.changeaction,sortingClassNameOfTime=searchResponse.timeclassname,sortAction=searchResponse.action,searchquery=searchResponse.searchquery,prevPage=searchResponse.prevPage,nextPage=searchResponse.nextPage,prevButtonClass=searchResponse.prevButtonClass,nextButtonClass=searchResponse.nextButtonClass,start=searchResponse.start,end=searchResponse.end,totalCount=searchResponse.totalCount;end>totalCount&&(end=totalCount),ZD("#servicefilepagination").html('<table cellpadding="0" cellspacing="0" border="0"><tr><td id=searchpagestatusid" class="pagecount">'+start+" - "+end+" "+zd_js_obj.of+" "+totalCount+'</td><td><div id="searchprevbuttonid" >&nbsp;</div></td><td><div id="searchnextbuttonid" >&nbsp;</div></td></tr></table>'),ZD("#attachFileDataDiv").data({prevButtonClass:prevButtonClass,nextButtonClass:nextButtonClass,start:start,end:end,totalCount:totalCount,field:field,changeSortingAction:changeSortingAction,sortingClassNameOfTime:sortingClassNameOfTime,sortAction:sortAction,searchquery:searchquery,prevPage:prevPage,nextPage:nextPage,noOfResults:10}),ZD("#searchprevbuttonid").addClass(prevButtonClass),ZD("#searchnextbuttonid").addClass(nextButtonClass),ZD("#servicefilepagination").show(),ZD("#attachFileHeader").delegate("td.searchauthorsort","mouseover mouseout",function(event){"mouseover"==event.type?ATTACHDIALOG.searchMouseOver("author",field,"searchauthorsortgif",changeSortingAction):ATTACHDIALOG.searchMouseOut("author",field,"searchauthorsortgif")}),ZD("#attachFileHeader").delegate("td.searchtimesort","mouseover mouseout",function(event){"mouseover"==event.type?ATTACHDIALOG.searchMouseOver("time",field,"searchtimesortgif",changeSortingAction):ATTACHDIALOG.searchMouseOut("time",field,"searchtimesortgif")}),ZD("#attachFileHeader").delegate("td.searchauthorsort","click",function(){ATTACHDIALOG.searchSorting("author",changeSortingAction)}),ZD("#attachFileHeader").delegate("td.searchtimesort","click",function(){ATTACHDIALOG.searchSorting("time",changeSortingAction)}),ZD("#ActionsPathDiv").undelegate(),ZD("#ActionsPathDiv").delegate("div#searchprevbuttonid","click",function(){ZD(this).hasClass("zd_prev")&&ATTACHDIALOG.getSearchResults(searchquery,prevPage,field,sortAction)}),ZD("#ActionsPathDiv").delegate("div#searchnextbuttonid","click",function(){ZD(this).hasClass("zd_next")&&ATTACHDIALOG.getSearchResults(searchquery,nextPage,field,sortAction)})},ATTACHDIALOG.updateSelectedDocs=function(){for(var divs=ATTACHDIALOG.getSelectedDocs(),i=0,j=divs.length;j>i;i++){var docId=divs[i].docId;ATTACHDIALOG.selectRow(docId)}},ATTACHDIALOG.getPermission=function(docId){ZD("#selectedfile_"+docId).length&&(ZD("#"+docId).find("td.checkboxtd").children().removeClass("normalcheckboxicon_css").addClass("selectcheckboxicon_css"),ZD("#"+docId).children("table.data-hover").addClass("zd_select"));var url=G_OF_OBJ.docsURL+"/docs/docsrequest.do?method=getShareDetailsPermission",params="docId="+docId+"&_t="+ZD.now();ZD.ajax({url:url,data:params,dataType:"text",type:"GET",success:function(resp){return"success"===resp.trim()?resp.trim():void 0},error:function(){ZD("#"+docId).addClass("opacityshare"),ZD("#"+docId).find(".data-hover").hasClass("zd_select")&&ZD("#selectedfile_"+docId).addClass("selectionblur")}})},ATTACHDIALOG.disableNonSharable=function(){ZD(".documentDataDiv").each(function(){G_OF_OBJ.asLink===!0?ATTACHDIALOG.getPermission(ZD(this).attr("id")):ZD(this).hasClass("opacityshare")&&(ZD(this).removeClass("opacityshare"),ZD(this).find(".data-hover").hasClass("zd_select")&&ZD("#selectedfile_"+ZD(this).attr("id")).removeClass("selectionblur"))})},ATTACHDIALOG.showStatusMsg=function(message){ZD("#msg_content").html(message),ZD("#status_msg").fadeIn(400),setTimeout(function(){ZD("#status_msg").fadeOut(400),ZD("#msg_content").html("")},4e3)},ATTACHDIALOG.setSharingTypeForSelectedUser=function(callBackFunction,attachObj){var buttonObj={};ZD("#sharefileaslinkcontainer").remove();var dialogDiv='<div id="sharefileaslinkcontainer" style="display:none;"></div>';ZD("body").append(dialogDiv),buttonObj.Share=function(){return ATTACHDIALOG.getAPIDetails(attachObj,callBackFunction),ZD("#sharefileaslinkcontainer").dialog("destroy").remove(),ZD("#sharefileaslinkcontainer").remove(),!1},buttonObj.Cancel=function(){return ZD("#sharefileaslinkcontainer").dialog("destroy").remove(),ZD("#sharefileaslinkcontainer").remove(),!1},ZDDialog.showCommonDialog("Share File",!0,"sharefileaslinkcontainer",buttonObj,"","550",!0,"auto",!1);var shareOptions='<div id="multi_visiblity_container"><p style="font-size: 15px;">Choose how you want the share the selected files:</p><ul id="visibilityoptions_top" class="zd_visiblity_list_container"><li class="zdl-menu zdl-brdtp" id="zd_private_visible" visible_type="private"><span class="zdl-icon"><span class="ui-icon zdc-specific"></span></span><span class="zdl-text">Recipients of this email </span><span class="zdl-shortcut">Recipients must have a Zoho account.</span><span class="ui-zmenu-item-placeholder"></span></li><li class="zdl-menu zd-everyone-org" id="zd_anyone_link_visible" visible_type="anyone_link"><span class="zdl-icon"><span class="ui-icon zdc-anyoneshare"></span></span><span class="zdl-text">'+orgLabel+'</span><span class="zdl-shortcut">Members within Organization who have the link can access.</span><span class="ui-zmenu-item-placeholder"></span></li><li class="zdl-menu zdl-brdtp" id="zd_nosignin_visible" visible_type="everyone_internet"><span class="zdl-icon"><span class="ui-icon zdc-anyoneinternet"></span></span><span class="zdl-text">Everone In Internet</span><span class="zdl-shortcut">Anyone who has the link can access. No sign-in required.</span><span class="ui-zmenu-item-placeholder"></span></li><li class="zdl-menu zdl-brdtp" id="zd_secure_share" visible_type="secureshare"><span class="zdl-icon"><span class="ui-icon zdc-specific"></span></span><span class="zdl-text">Share file(s) with password protection to external contacts.</span><span class="zdl-shortcut">Anyone who has the link and its password can access.</span><span class="ui-zmenu-item-placeholder"></span></li></ul></div>';return ZD("#sharefileaslinkcontainer").html(shareOptions),ATTACHDIALOG.bindEventHandlers(),ZD("#visibilityoptions_top").find("li:first").trigger("click"),!1},ATTACHDIALOG.getAPIDetails=function(attachObj,callBackFunction){for(var apiUrl="",apiParams="",expiryDateInfo="",pwd="",selectedDocList="",selectedShareOption=ZD("#visibilityoptions_top").find("li.zdl-selection").attr("id"),permission=ZD("#"+selectedShareOption).find(".zd-selectdiv-sib").attr("permission"),i=0;i<attachObj.length;i++)selectedDocList+=attachObj[i].docId+",";if("zd_private_visible"===selectedShareOption)apiUrl=G_OF_OBJ.docsURL+"/api/v2/files/share",apiParams=zdcsrfPair,apiParams+="&type=private&resids="+selectedDocList+"&emailids=&pergroupIds=&orggroupIds=&message=&notify=false&permission="+permission+"&ischangepermission=false";else if("zd_anyone_link_visible"===selectedShareOption){var isFindAndAccess=!1;apiUrl=G_OF_OBJ.docsURL+"/api/v2/files/share",isFindAndAccess=!0,apiParams="type=orgshare&resids="+selectedDocList+"&permission="+permission+"&updatepermission=false&alloweveryoneaccess="+isFindAndAccess+"&"+zdcsrfPair}else"zd_nosignin_visible"===selectedShareOption?(apiUrl=G_OF_OBJ.docsURL+"/api/v2/files/share",expiryDateInfo=ZD("#"+selectedShareOption).find("#zdpublic_datepicker").val(),apiParams="type=linkshare&resids="+selectedDocList+"&permission=1&expiry_date="+expiryDateInfo.trim()+"&"+zdcsrfPair):"zd_secure_share"===selectedShareOption&&(apiUrl=G_OF_OBJ.docsURL+"/api/v2/files/share",expiryDateInfo=ZD("#"+selectedShareOption).find("#zdsecureshare_datepicker").val(),pwd=ZD("#"+selectedShareOption).find("#zd-secureshare-pwd").val(),apiParams="type=userpwdlink&sendpasswordinmail=false&resids="+selectedDocList+"&permission="+permission+"&expiry_date="+expiryDateInfo.trim()+"&password="+pwd+"&isCommonLink=true&emailids=&"+zdcsrfPair);return callBackFunction({apiurl:apiUrl,apiparams:apiParams})},ATTACHDIALOG.bindEventHandlers=function(){ZD("#visibilityoptions_top").undelegate().delegate("li","click",function(event){var targElem=ZD(event.target),targElemId=targElem.closest("li").attr("id");if(ZD("#visibilityoptions_top").find("li").removeClass("zdl-selection").css("height",""),ZD("#"+targElemId).addClass("zdl-selection"),"zd_private_visible"===targElemId){if(0===ZD("#"+targElemId).find(".visibility_permission_container").length){var collaboratorsOnlyInterface='<div style="margin-top:18px;float: left;padding-left: 50px;" class="visibility_permission_container"><div id="zdperm_visibility_text" style="line-height:25px;float:left;">Set Permission:<select class="zd-private-select" style="display:none;border:1px solid #DADADA;background:#fff;padding:5px;outline:none;"><option permission="1">Read Only</option><option permission="2">Read/Write</option><option permission="3">Co-Owner</option></select></div></div>';ZD("#"+targElemId).append(collaboratorsOnlyInterface)}ATTACHDIALOG.customizeSelectElement(ZD(".zd-private-select"))}else if("zd_anyone_link_visible"===targElemId){if(0===ZD("#"+targElemId).find(".visibility_permission_container").length){var orgPublishInterface='<div style="margin-top: 10px;float: left;padding-left: 50px;" class="visibility_permission_container"><div id="zdperm_visibility_text" style="line-height:25px;float:left;">Whoever accesses can:<select class="zd-org_share" style="display:none;border:1px solid #DADADA;background:#fff;padding:5px;outline:none;"><option permission="1">Read Only</option><option permission="2">Read/Write</option></select></div></div>';ZD("#"+targElemId).append(orgPublishInterface)}ATTACHDIALOG.customizeSelectElement(ZD(".zd-org_share"))}else if("zd_nosignin_visible"===targElemId){if(0===ZD("#"+targElemId).find(".zd-everyone-internet").length){var everyoneInInterface='<div class="zd-everyone-internet zdc-extwrd visibility_permission_container" style="margin-top:10px;float:left;padding-left: 50px;display:block;"><div style="margin-bottom:5px;"><span class="zdpublic_setexpirylabel"><input style="margin:0 5px 0 0;" type="checkbox" id="set_expir_date_public_web"><label for="set_expir_date_public_web"><span>Set expiry date</span></label></span><p style="display:none;" class="datepicker_public">Expires on :<input type="text" id="zdpublic_datepicker" readonly="true/"></p></div></div>';ZD("#"+targElemId).append(everyoneInInterface),ZD("#zdpublic_datepicker").datepicker({minDate:1}),ZD("#set_expir_date_public_web").click(function(){var targElem=ZD(this);targElem.is(":checked")?(ZD(".datepicker_public").css("display","block"),ZD("#zdpublic_datepicker").datepicker("show")):(ZD(".datepicker_public").css("display","none"),ZD("#zdpublic_datepicker").datepicker("hide"))})}}else if("zd_secure_share"===targElemId){if(0===ZD("#"+targElemId).find(".zd-secureshare-container").length){var secureShareInterface='<div class="zd-secureshare-container visibility_permission_container" style="margin-top:10px;float:left;padding-left: 50px;display:block;"><div id="zdperm_visibility_text" style="line-height:25px;float:left;">Set Permission:<select class="zd-secure-share-selectelem" style="display:none;border:1px solid #DADADA;background:#fff;padding:5px;outline:none;"><option permission="1">Read Only</option><option permission="2">Read/Write</option></select></div><div style="float:left;margin-bottom:10px;" class="zd-setpassword-container"><span>Set Password:</span><input id="zd-secureshare-pwd" style="outline:none;width:200px;height: 18px;margin-left: 9px;" type="password" value=""></input></div><div style="float:left;margin: 0px 0px 10px 30px;" id="zd-send-password-email"><input id="zd-ecs-sendpass" type="checkbox" name="check" value="" class="zd-checkbox"><label for="zd-ecs-sendpass" class="zd-checkbox-clone"> Send password through email </label></div><div style="float:left;width:100%;margin-left:30px;"><div><span class="zdsecureshare_setexpirylabel"><input style="margin:0 5px 0 0;" type="checkbox" id="set_expiry_date_secureshare"><label for="set_expiry_date_secureshare"><span>Set expiry date</span></label></span><p style="display:none;" class="zd-securesharedatepicker_container">Expires on :<input type="text" id="zdsecureshare_datepicker" readonly="true/"></p></div></div></div>';ZD("#"+targElemId).append(secureShareInterface),ZD("#zdsecureshare_datepicker").datepicker({minDate:1}),ZD("#set_expiry_date_secureshare").click(function(){var targElem=ZD(this);targElem.is(":checked")?(ZD(".zd-securesharedatepicker_container").css("display","block"),ZD("#zdsecureshare_datepicker").datepicker("show")):(ZD(".zd-securesharedatepicker_container").css("display","none"),ZD("#zdsecureshare_datepicker").datepicker("hide"))})}ATTACHDIALOG.customizeSelectElement(ZD(".zd-secure-share-selectelem"))}var detailsDiv=ZD(".zd_visiblity_list_container").find(".visibility_permission_container");detailsDiv.css("display","none"),ZD("#"+targElemId).find(".visibility_permission_container").css("display","block")})},ATTACHDIALOG.customizeSelectElement=function(selectElementObj){selectElementObj.each(function(){var $this=ZD(this),numberOfOptions=ZD(this).children("option").length,selectElemContainer=selectElementObj.closest("li");ZD(".zd-selectsib-ulcontainer").remove();var $styledSelect="";if(0===$this.closest(".zd-select-wrap").length){$this.wrap('<div class="zd-select-wrap"></div>');var $containerDiv=selectElemContainer.find(".zd-select-wrap");$containerDiv.append('<div class="zd-selectdiv-sib"></div>'),selectElemContainer.find("div.zd-selectdiv-sib").attr("permission",1).text($this.children("option").eq(0).text())}$styledSelect=selectElemContainer.find("div.zd-selectdiv-sib");for(var $list=ZD("<ul />",{"class":"zd-selectsib-ulcontainer"}).appendTo("body"),i=0;numberOfOptions>i;i++)ZD("<li />",{text:$this.children("option").eq(i).text(),permission:$this.children("option").eq(i).attr("permission"),rel:$this.children("option").eq(i).val()}).appendTo($list);var $listItems=$list.children("li");$styledSelect.click(function(e){var $styledSelectPos=(selectElemContainer.find(".zd-selectdiv-sib").offset(),$styledSelect.offset());e.stopPropagation(),$list.css({position:"absolute",top:$styledSelectPos.top+23,left:$styledSelectPos.left,"z-index":1e7}),ZD("div.zd-selectdiv-sib.active").each(function(){ZD(this).removeClass("active"),ZD("ul.zd-selectsib-ulcontainer").hide()}),ZD(this).toggleClass("active"),ZD("ul.zd-selectsib-ulcontainer").toggle()}),$listItems.click(function(e){e.stopPropagation(),$styledSelect.text(ZD(this).text()).removeClass("active"),$styledSelect.attr("permission",ZD(this).attr("permission")),$list.hide()}),ZD(document).click(function(){$styledSelect.removeClass("active"),$list.hide()})})},function(ZD){ZD.widget("ui.attachfiledialog",{options:{recentDocs:{show:!0,name:"recentDocs",id:"recentservicedocs",action:"getDocumentsByType",iconClass:"recentdocs-icon",title:"recentDocs"},desktopDocs:{show:!0,name:"My Folders",id:"desktopservicedocs",action:"getDocumentsForFolder",fid:"folder",iconClass:"zdc-foldericon_css",title:"My Folders"},myDocs:{show:!0,name:"My Docs",id:"mydocs",action:"getDocumentsByType",fid:"folder",iconClass:"mydocs_icon",title:"My Docs"},mySheets:{show:!0,name:"My Sheets",id:"mysheets",action:"getDocumentsByType",fid:"folder",iconClass:"myspreadsheet_icon",title:"My Sheets"},myPresentations:{show:!0,name:"My Presentations",id:"mypresentations",action:"getDocumentsByType",fid:"folder",iconClass:"mypresentation_icon",title:"My Presentations"},myPictures:{show:!0,name:"My Pictures",id:"mypictures",action:"getDocumentsByType",fid:"folder",iconClass:"mypic_icon",title:"My Pictures"},sharedDocs:{show:!0,name:"Shared Docs",id:"sharedservicedocs",action:"getShareddocs",iconClass:"shareTome",title:"Shared Docs"},workspace:{show:!0,name:"Workspaces",id:"workspacelist",action:"getWorkspaces",iconClass:"zdc-ws",title:"Workspaces"},trashedDocs:{show:!0,name:"Trash",id:"trashservicedocs",action:"getTrashedDocuments",iconClass:"trash-icon",fid:"trash"},actionsButton:{showAction:!1,action:!0,id:"actionMenuOpenFile",iconClass:"action-css",value:"Actions"},homeButton:!0,upOneLevel:!1,selectedView:"recentservicedocs",lookIn:!1,advSearchBox:!1},_create:function(){this._constructFileDialog(),this._constructLeftPanel(),this._constructRightPanel(),this._initDelegate();var temp_height=G_OF_OBJ.attachObj.height-220;ZD("#showattachfilespace").css({height:temp_height})},_constructFileDialog:function(){this.mainPanel=ZD('<div id="mainPanelforservicefiles" style="overflow:hidden;width:100%;margin: 12px 0px;">'),this.leftPanel=ZD('<div class="ui-left-panel flleft" style="width:145px;" >'),this.rightPanel=ZD('<div class="ui-rht-datadiv">'),this.selectedFilesRow=ZD('<div id="showSelectedBoxDiv" class="showdiv" style="margin-bottom:2px;"><table cellpadding="0" width="100%"  cellspacing="0"><tr><td width="107" align="center" class="selectfiles"><strong>'+zd_js_obj.selected_files_list+'</strong></td><td><div id="selectboxdiv" class="selectblock zd_scroll"></div></td></tr></table></div>'),this.element.append(this.mainPanel),this.mainPanel.append(this.leftPanel),this.mainPanel.append(this.rightPanel),this.mainPanel.append(this.selectedFilesRow)},_constructLeftPanel:function(){var leftSidePanel=ZD('<table id="serviceDialogLeftPanel" width="100%"  cellpadding="0" cellspacing="0" align="center" class="mailLeftPanel"></table>');if(this.options.advSearchBox){var searchDiv='<tr><td><div id="attachfilesearchdiv" style="padding-bottom:0px;margin-top:0px;"><div class="searchdiv ui-corner-all docscursor flright"><input type="submit" class="searchIcon flleft docscursor smallText" value=""><input type="text" id="searchFileName" class="searchtext flleft" value=""><input type="hidden" value="search_all_search" name="'+zd_js_obj.label_search_all+'" id="search_type_attachfile" class=""></div><div style="height:15px;border-bottom:1px solid #efefef;margin-bottom:13px;clear:both;"></div></div></td></tr>';ZD(leftSidePanel).append(searchDiv)}else ZD(leftSidePanel).append('<tr><td><div class="ui-left-heading">'+zd_js_obj.label_favorites+"</div></td></tr>");for(var key in this.options){var obj=this.options[key];obj&&obj.show&&ZD(leftSidePanel).append('<tr><td  class="normalView docscursor" id="'+obj.id+'" action="'+obj.action+'" ><span class="'+obj.iconClass+' flleft margright"></span><span class="flleft" style="line-height:15px;white-space:nowrap;overflow:hidden;" title="'+obj.title+'" alt="'+obj.title+'">'+obj.name+"</span></td></tr>")}this.leftPanel.append(leftSidePanel),ZD("#"+this.options.selectedView).removeClass("normalView").addClass("selectedView")},_constructRightPanel:function(){this.rightPaneltopContainer=ZD("<div>"),this.rightPanel.append(this.rightPaneltopContainer),this._constructActionsRow(),this._constructStatusMessageRow(),this.rightPanelDataContainer=ZD('<div id="showattachfilespace" style="background:#fff;margin: 0px 0px 0px 12px;"></div>'),this.rightPanel.append(this.rightPanelDataContainer)},_constructActionsRow:function(){var actionsTable='<div id="ActionsPathDiv" class="toolbar-menu" style="padding: 0px 0px 12px 0px; height: 21px;"><table width="100%" cellpadding="0" cellspacing="0" border="0" align="center"><tr><td>';this.options.homeButton&&(actionsTable+='<span title="'+zd_js_obj.docs_home+'" class="sort-menu lightbluetxt flleft margright " id="homeButton"><span class="home flleft docscursor"></span></span>'),this.options.upOneLevel&&(actionsTable+='<span title="'+zd_js_obj.up_one_level+'" class="sort-menu lightbluetxt flleft margright non-hover" id="moveUpFolder"><span class="back-folder-inactive flleft"></span></span>'),this.options.lookIn&&(actionsTable+='<span class="flright boldText" style="padding-top:5px;color:#676565;">View</span>'),actionsTable+='</td><td align="right"><div id="servicefilepagination"  style="float:right; z-index:1000;padding-right:2px;display:none;"></div></td>',actionsTable+='<td><div id="openloadingmsg"></div></td></tr></table></div>',this.rightPaneltopContainer.append(actionsTable)},_constructStatusMessageRow:function(){this.rightPaneltopContainer.append('<div class="hidediv attach_message" style="display:none;"><span id="zd_statusmsgdiv"></span></div>')},_initDelegate:function(){G_OF_OBJ.SCR_WTH=ZDUtils.getWidth(),G_OF_OBJ.SCR_HT=ZDUtils.getHeight(),ZD("#serviceDialogLeftPanel").delegate("td.docscursor","click",function(){G_OF_OBJ.folderpermission="",G_OF_OBJ.searchenabled=!1,ATTACHDIALOG.getDocAsList(this)}),ZD("#showattachfilespace").delegate("div.folderDataDiv","click",function(e){var targElem=ZD(e.target);if("renameinputform"==targElem.attr("id"))return!1;ATTACHDIALOG.reset();var folderId=ZD(this).attr("folderId");void 0==folderId&&(folderId=-1),void 0!==ZD(this).attr("permission")&&(G_OF_OBJ.folderpermission=ZD(this).attr("permission"));var pntFolderId=ZD(this).attr("pntFolderId"),wsId=ZD(this).attr("wsid");ZD("#servicefilepagination").show(),ZD("#showattachfilespace").css("display","block"),G_OF_OBJ.parentFolderId=pntFolderId,G_OF_OBJ.folderId=folderId,G_OF_OBJ.wsId=wsId,ATTACHDIALOG.getDocAsList()}),ZD("#showattachfilespace").delegate("table.data-hover","click",function(e){var targElem=ZD(e.target);(targElem.hasClass("selectcheckboxicon_css")||targElem.hasClass("normalcheckboxicon_css")||targElem.is("td")||targElem.is("span"))&&ATTACHDIALOG.showSelectedDocsToAttach(this)}),ZD("div#selectboxdiv").delegate("span.closeBtn_css","click",function(){var docId=ZD(this).parent().attr("docId");ATTACHDIALOG.deselectRow(docId)}),ZD("div#servicefilepagination").delegate("div#prevbuttonid,div#nextbuttonid","click",function(){var elemId=ZD(this).attr("id");"prevbuttonid"==elemId?action="previousPage":"nextbuttonid"==elemId&&(action="nextPage"),ZD("#showattachfilespace").attachfiledatagrid(action)}),ZD("#showattachfilespace").delegate("td#nameHeader,td#dateModifiedHeader","click",function(){(ZD(this).find("img#_sortname").length||ZD(this).find("img#_sortdate").length)&&(ZD("div#servicefilepagination").hide(),ATTACHDIALOG.setSortOrder(this),ATTACHDIALOG.resetAll(),ZD("#desktopservicedocs").hasClass("selectedView")?G_OF_OBJ.folderId="0"==G_OF_OBJ.parentFolderId||"1"==G_OF_OBJ.parentFolderId?"folder":G_OF_OBJ.parentFolderId:ZD("#workspacelist").hasClass("selectedView")&&(G_OF_OBJ.folderId="0"==G_OF_OBJ.parentFolderId||"1"==G_OF_OBJ.parentFolderId?"folder":G_OF_OBJ.parentFolderId),ATTACHDIALOG.getSortDocAsList("",G_OF_OBJ.selectedLeftPanel),ATTACHDIALOG.setClassAfterSorting(this))}),ZD("#homeButton").bind("click",function(){G_OF_OBJ.folderpermission="",G_OF_OBJ.searchenabled=!1;var element="";ATTACHDIALOG.getDocAsList(element,"recentservicedocs")}),ZD("div#attachfilesearchdiv").delegate("input#searchFileName","focusin focusout keypress",function(e){if("focusin"==e.type)ZD("input#searchFileName").val(""),ZD("input#search_type_attachfile").addClass("searchquery");else if("focusout"==e.type)""==ZD("input#searchFileName").val()&&(ZD("input#searchFileName").val(ZD("input#search_type_attachfile").attr("name")),ZD("input#search_type_attachfile").removeClass("searchquery"));else if("keypress"==e.type&&"13"==e.keyCode){G_OF_OBJ.searchenabled=!0,G_OF_OBJ.folderpermission="";var searchquery=ZD("input#searchFileName").val();ATTACHDIALOG.searchFile(searchquery)}}),ZD("div#attachfilesearchdiv").delegate("input.searchIcon","click",function(){var searchquery=ZD("input#searchFileName").val(),searchclass=ZD("input#search_type_attachfile").attr("class");return""==searchquery||null==searchquery||"searchquery"!=searchclass?(ATTACHDIALOG.statusmsg("failure_status boldText","Enter valid text to search"),void ZD("input#searchFileName").val(ZD("input#search_type_attachfile").attr("name"))):(G_OF_OBJ.folderpermission="",G_OF_OBj.searchenabled=!0,void ATTACHDIALOG.searchFile(searchquery))}),ZD("#moveUpFolder").delegate(".back-folder","click",function(){G_OF_OBJ.folderpermission="",ZD("#desktopservicedocs").hasClass("selectedView")?(ATTACHDIALOG.changeAllToNormalView("desktopservicedocs"),G_OF_OBJ.moveUpFolder=!0,G_OF_OBJ.folderId="0"==G_OF_OBJ.parentFolderId||"1"==G_OF_OBJ.parentFolderId?"folder":G_OF_OBJ.parentFolderId,ATTACHDIALOG.getDocAsList()):ZD("#sharedservicedocs").hasClass("selectedView")?(ATTACHDIALOG.changeAllToNormalView("sharedservicedocs"),G_OF_OBJ.moveUpFolder=!0,G_OF_OBJ.folderId="0"===G_OF_OBJ.parentFolderId||"1"===G_OF_OBJ.parentFolderId?"folder":G_OF_OBJ.parentFolderId,ATTACHDIALOG.getDocAsList()):ZD("#workspacelist").hasClass("selectedView")&&(ATTACHDIALOG.changeAllToNormalView("workspacelist"),G_OF_OBJ.moveUpFolder=!0,G_OF_OBJ.parentFolderId==G_OF_OBJ.wsId||"-1"==G_OF_OBJ.parentFolderId?(G_OF_OBJ.folderId="wshome",G_OF_OBJ.wsId="wshome"):G_OF_OBJ.folderId=G_OF_OBJ.parentFolderId,ATTACHDIALOG.getDocAsList())})},destroy:function(){ZD.Widget.prototype.destroy.apply(this,arguments),this.element.unbind("."+this.widgetName);var initdiv=this.element,items=ZD(initdiv).children();ZD(items).each(function(i,item){ZD(item).undelegate(),ZD(item).empty().remove()})}}),ZD.extend(ZD.ui.filedialog,{version:"1.8"})}(jQuery),function(ZD){ZD.widget("ui.attachfiledatagrid",{defaults:{documentNameHeader:!0,lastModifiedTimeHeader:!0,checkboxIconSpace:!0,checkboxIcon:"normalcheckboxicon_css flleft",hoverclass:"data-hover",documentIcon:!0,documentName:!0,authorName:!1,lastModifiedTime:!0},_create:function(){this.options=ZD.extend({},this.defaults,this.options),this._constructHeader(),this.sendAjaxRequest(),this.resize()},resetOptions:function(){this.options.documentNameHeader=!0,this.options.lastModifiedTimeHeader=!0,this.options.documentIcon=!0,this.options.documentName=!0,this.options.authorName=!1,this.options.lastModifiedTime=!0},populateDataPanel:function(obj){this.options=ZD.extend(this.options,this.defaults);for(var name in obj)this.options[name]=obj[name];this.clearData(),this._constructHeader(),this.sendAjaxRequest(),this.resize()},clearData:function(){var attachdataDiv=this.element,items=ZD(attachdataDiv).children();ZD(items).each(function(i,item){ZD(item).empty().remove()})},_constructHeader:function(){var headerRow='<div id="docsHeaderTab"><table  id="table1" width="100%" cellpadding="0" cellspacing="0" border="0" class="docs-tableheader" align="center"><tr>';this.options.documentNameHeader&&(headerRow+='<td width="20">&nbsp;</td><td id="nameHeader" height="23" nowrap="nowrap" align="left" class="docscursor sortfield namesortTd pad-lft" sortfield="name">'+zd_js_obj.name+'<img id="_sortname" src="'+G_OF_OBJ.spacerImagePath+'" class="" style="margin-left:2px;"></td>'),this.options.authorName&&(headerRow+='<td width="20">&nbsp;</td><td id="authorHeader" width="110" nowrap="nowrap" align="left" class="docscursor sortfield authorsortTd pad-lft" sortfield="author"><span class="zd_divider">|</span>'+zd_js_obj.author+"</td>"),this.options.lastModifiedTimeHeader&&(headerRow+='<td id="dateModifiedHeader" width="130" nowrap="nowrap" class="docscursor sortfield datesortTd" sortfield="date"><span class="zd_divider">|</span>'+zd_js_obj.date_modified+'<img id="_sortdate" src="'+G_OF_OBJ.spacerImagePath+'" style="margin-left: 2px;" class="DownArrow"></td>'),headerRow+='</tr></table></div><div id="attachFileDataDiv" style="overflow:auto;vertical-align:top;border:0px solid #000000;">',this.element.append(headerRow)},sendAjaxRequest:function(){ATTACHDIALOG.LoadingMsg(zd_js_obj.loading);var url=this._constructURLParameters();ZD.ajax({url:url,xhrFields:{withCredentials:!0},type:"GET",dataType:"json",success:function(response,textStatus){return"success"==textStatus?(G_OF_OBJ.jsonData=response,ZD("div#showattachfilespace").attachfiledatagrid("constructDocumentRows"),ATTACHDIALOG.hideLoadingMsg(),ATTACHDIALOG.updateSelectedDocs(),(ZD("#recentservicedocs").hasClass("selectedView")||ZD("#workspacelist").hasClass("selectedView")&&"wshome"==G_OF_OBJ.wsId)&&(ZD("td#dateModifiedHeader").find("img").remove(),ZD("td#nameHeader").find("img").remove()),G_OF_OBJ.moveUpFolder=!1,!1):void 0}})},_constructURLParameters:function(){var action="",url="",docsView=ZD("#serviceDialogLeftPanel").find("td.selectedView").attr("id");return"workspacelist"!=docsView?(action="method="+ZD("#"+docsView).attr("action")+"&fromIndex="+G_OF_OBJ.startFrom+"&noOfDocuments="+G_OF_OBJ.fetchLimit,ZD("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft"),"recentservicedocs"!=docsView&&(action+="&sortorder="+G_OF_OBJ.sortOrder+"&orderby="+G_OF_OBJ.orderBy),"desktopservicedocs"==docsView&&(action+="&fid="+G_OF_OBJ.folderId,"folder"!=G_OF_OBJ.folderId&&ZD("#moveUpFolder").toggleClass("non-hover hover").children().toggleClass("back-folder-inactive back-folder docscursor")),"sharedservicedocs"===docsView&&("folder"===G_OF_OBJ.folderId&&(G_OF_OBJ.folderId="-1"),action+="&folderid="+G_OF_OBJ.folderId,"folder"!==G_OF_OBJ.folderId&&ZD("#moveUpFolder").toggleClass("non-hover hover").children().toggleClass("back-folder-inactive back-folder docscursor")),"trashservicedocs"==docsView&&(action+="&fid=trash"),G_OF_OBJ.moveUpFolder&&"folder"!=G_OF_OBJ.folderId&&(action+="&isParentFolderDocs=true"),"recentservicedocs"==docsView?action+="&type=myrecentdocs":"mydocs"==docsView?action+="&type=mydocs":"mypresentations"==docsView?action+="&type=mypresentations":"mysheets"==docsView?action+="&type=myspreadsheets":"mypictures"==docsView&&(action+="&type=mypictures")):(ZD("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft"),action="method="+ZD("#"+docsView).attr("action"),"wshome"!=G_OF_OBJ.folderId&&(action+="&fromIndex="+G_OF_OBJ.startFrom+"&noOfDocuments="+G_OF_OBJ.fetchLimit,action+="&sortorder="+G_OF_OBJ.sortOrder+"&orderby="+G_OF_OBJ.orderBy,action+="&fid="+G_OF_OBJ.folderId,action+="&wsid="+G_OF_OBJ.wsId,action+="&type=getwsdocs",G_OF_OBJ.moveUpFolder&&"wshome"!=G_OF_OBJ.folderId&&(action+="&isParentFolderDocs=true")),"wshome"!=G_OF_OBJ.folderId&&ZD("#moveUpFolder").toggleClass("non-hover hover").children().toggleClass("back-folder-inactive back-folder docscursor")),action+="&_t="+(new Date).getTime(),url=G_OF_OBJ.docsURL+"/docs/attachfilerequest.do?"+action},constructDocumentRows:function(){var resp_data="";this.containerDiv=ZD("div#attachFileDataDiv"),Math.abs(G_OF_OBJ.prevIndex)>1?this.containerDiv.empty():(this.containerDiv.empty(),this.containerDiv.find(".documentDataDiv").remove());var selectedView=ZD("#serviceDialogLeftPanel").find("td.selectedView").attr("id");if("desktopservicedocs"===selectedView||"sharedservicedocs"===selectedView){if(0==G_OF_OBJ.jsonData.FOLDER.length&&0==G_OF_OBJ.jsonData.DOC.length)return this.noDocuments=ZD("div#attachFileDataDiv"),G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,resp_data+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.label_no_items_are_present+"</div></td></tr></table>",ZD("td#dateModifiedHeader").find("img").remove(),ZD("td#nameHeader").find("img").remove(),void this.noDocuments.append(resp_data)}else if("workspacelist"==selectedView){if(void 0!=G_OF_OBJ.jsonData.WORKSPACE&&0==G_OF_OBJ.jsonData.WORKSPACE.length)return this.noDocuments=ZD("div#attachFileDataDiv"),G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,resp_data+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.no_workspace+"</div></td></tr></table>",void this.noDocuments.append(resp_data);if(void 0!=G_OF_OBJ.jsonData.DOC&&0==G_OF_OBJ.jsonData.DOC.length&&void 0!=G_OF_OBJ.jsonData.FOLDER&&0==G_OF_OBJ.jsonData.FOLDER.length)return this.noDocuments=ZD("div#attachFileDataDiv"),G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,resp_data+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.dashboard_msg_no_documents+"</div></td></tr></table>",ZD("td#dateModifiedHeader").find("img").remove(),ZD("td#nameHeader").find("img").remove(),void this.noDocuments.append(resp_data)}else if(0==G_OF_OBJ.jsonData.DOC.length)return this.noDocuments=ZD("div#attachFileDataDiv"),resp_data+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.dashboard_msg_no_documents+"</div></td></tr></table>",ZD("td#dateModifiedHeader").find("img").remove(),ZD("td#nameHeader").find("img").remove(),void this.noDocuments.append(resp_data);void 0!==G_OF_OBJ.jsonData.FOLDER&&G_OF_OBJ.jsonData.FOLDER.length>0&&1===Math.abs(G_OF_OBJ.prevIndex)&&("desktopservicedocs"===selectedView||"workspacelist"===selectedView||"sharedservicedocs"===selectedView)?this._constructFolderInfoRows():G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,void 0!=G_OF_OBJ.jsonData.WORKSPACE&&G_OF_OBJ.jsonData.WORKSPACE.length>0&&1==Math.abs(G_OF_OBJ.prevIndex)&&"workspacelist"==selectedView&&this._constructWSInfoRows(),void 0!=G_OF_OBJ.jsonData.DOC&&G_OF_OBJ.jsonData.DOC.length>0&&(G_OF_OBJ.totalFiles=ZD("#recentservicedocs").hasClass("selectedView")?G_OF_OBJ.jsonData.DOC.length:G_OF_OBJ.jsonData.TOTALDOCS[0].NOOFDOCS,this._constructPaginationData(),this._constructDocInfoRows()),"folder"==G_OF_OBJ.folderId&&ZD("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft")},_constructDocInfoRows:function(){var to="";to=G_OF_OBJ.endIndex>G_OF_OBJ.jsonData.DOC.length?G_OF_OBJ.jsonData.DOC.length:G_OF_OBJ.endIndex,this.containerDiv=ZD("div#attachFileDataDiv"),Math.abs(G_OF_OBJ.prevIndex)>1?this.containerDiv.empty():this.containerDiv.find(".documentDataDiv").remove();for(var i=(ZD("div.selectbox","div#selectboxdiv"),G_OF_OBJ.fromIndex);to>i;i++){var checkBoxIcon=this.options.checkboxIcon,checkSelectedStatus=ATTACHDIALOG.checkSelectedFiles(G_OF_OBJ.jsonData.DOC[i].DOCID);checkSelectedStatus&&(checkBoxIcon="flleft selectcheckboxicon_css");var dataDiv=ZD("<div>").addClass("documentDataDiv").attr({id:G_OF_OBJ.jsonData.DOC[i].DOCID,fileName:G_OF_OBJ.jsonData.DOC[i].DOCNAME,serviceType:G_OF_OBJ.jsonData.DOC[i].SERVICE_TYPE,isDocumentSharedToMe:!1}).data({serviceType:G_OF_OBJ.jsonData.DOC[i].SERVICE_TYPE,cssName:G_OF_OBJ.jsonData.DOC[i].CLASSNAME,encAttrFileName:G_OF_OBJ.jsonData.DOC[i].ENCATTR_DOCNAME,fileName:G_OF_OBJ.jsonData.DOC[i].DOCNAME,isDocumentSharedToMe:!1,isTemplates:!1,permission:G_OF_OBJ.jsonData.DOC[i].PERMISSION,scope:G_OF_OBJ.jsonData.DOC[i].SCOPE}),documentTable=ZD('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="'+this.options.hoverclass+'">'),documentTR=ZD("<tr>"),documentTD=ZD('<td colspan="4" nowrap="nowrap" width="100%">'),title=G_OF_OBJ.jsonData.DOC[i].ENCATTR_DOCNAME,docName=G_OF_OBJ.jsonData.DOC[i].ENC_DOCNAME;docName=ZDUtils.substringName(docName,"40");var displayRow='<table width="100%" border="0" cellpadding="0" class="docs-tablerow"><tr>';this.options.checkboxIconSpace&&(displayRow+='<td width="20" height="20" nowrap="nowrap" class="docscursor checkboxtd" elem="checkbox" ><img src="'+G_OF_OBJ.spacerImagePath+'" class="'+checkBoxIcon+'"/></td>'),this.options.documentIcon&&(displayRow+='<td width="20" nowrap="nowrap" elem="documenticon"><div class="'+G_OF_OBJ.jsonData.DOC[i].CLASSNAME+' flleft docscursor"></div></td>'),this.options.documentName&&(displayRow+='<td nowrap="nowrap" align="left" elem="documentname">&nbsp;<span id="fileNameSpan_'+G_OF_OBJ.jsonData.DOC[i].DOCID+'" docId="'+G_OF_OBJ.jsonData.DOC[i].DOCID+'" service="'+G_OF_OBJ.jsonData.DOC[i].SERVICE_TYPE+'" docName="'+title+'" title="'+title+'" class="docscursor">'+docName+"</span></td>"),this.options.authorName&&(displayRow+='<td width="110" class="zdtext-truncate" title="'+G_OF_OBJ.jsonData.DOC[i].ENCATTR_AUTHOR_NAME+'" nowrap="nowrap" align="left" elem="authorname">&nbsp;<a><span style="padding-left:10px;">'+G_OF_OBJ.jsonData.DOC[i].ENCATTR_AUTHOR_NAME+"</span></a></td>"),this.options.lastModifiedTime&&(displayRow+='<td width="100" nowrap="nowrap" align="left" elem="lastmodifiedtime">&nbsp;<a><span style="padding-left:10px;">'+G_OF_OBJ.jsonData.DOC[i].LAST_MODIFIEDTIME+"</span></a></td>"),displayRow+="</tr></table>",documentTD.append(displayRow),documentTR.append(documentTD),documentTable.append(documentTR),dataDiv.append(documentTable),this.containerDiv.append(dataDiv),1===G_OF_OBJ.jsonData.DOC[i].SCOPE&&3!==G_OF_OBJ.jsonData.DOC[i].PERMISSION&&(G_OF_OBJ.jsonData.DOC[i].PERMISSION=""!==G_OF_OBJ.folderpermission?Number(G_OF_OBJ.folderpermission):2),G_OF_OBJ.asLink===!0&&void 0!==G_OF_OBJ.jsonData.DOC[i].PERMISSION&&3!==G_OF_OBJ.jsonData.DOC[i].PERMISSION&&0!==G_OF_OBJ.jsonData.DOC[i].PERMISSION&&(ZD("#"+G_OF_OBJ.jsonData.DOC[i].DOCID).addClass("opacityshare"),ZD("#selectedfile_"+G_OF_OBJ.jsonData.DOC[i].DOCID).addClass("selectionblur"))}},_constructFolderInfoRows:function(){for(var selectedView=ZD("#serviceDialogLeftPanel").find("td.selectedView").attr("id"),i=0,j=G_OF_OBJ.jsonData.FOLDER.length;j>i;i++){"desktopservicedocs"==selectedView?(G_OF_OBJ.parentFolderId!=G_OF_OBJ.jsonData.FOLDER[i].PARENTFOLDERID&&(G_OF_OBJ.parentFolderId=G_OF_OBJ.jsonData.FOLDER[i].PARENTFOLDERID),("1"==G_OF_OBJ.parentFolderId||"0"==G_OF_OBJ.parentFolderId)&&(G_OF_OBJ.folderId="folder")):"sharedservicedocs"===selectedView?(G_OF_OBJ.parentFolderId!==G_OF_OBJ.jsonData.FOLDER[i].PARENTFOLDERID&&(G_OF_OBJ.parentFolderId=G_OF_OBJ.jsonData.FOLDER[i].PARENTFOLDERID),("1"===G_OF_OBJ.parentFolderId||"0"===G_OF_OBJ.parentFolderId)&&(G_OF_OBJ.folderId="folder")):"workspacelist"==selectedView&&(G_OF_OBJ.parentFolderId!=G_OF_OBJ.jsonData.FOLDER[i].PARENTFOLDERID&&(G_OF_OBJ.parentFolderId=G_OF_OBJ.jsonData.FOLDER[i].PARENTFOLDERID),("1"==G_OF_OBJ.parentFolderId||"0"==G_OF_OBJ.parentFolderId)&&(G_OF_OBJ.folderId="folder")),this.folderDataDiv=ZD("div#attachFileDataDiv");var folderDiv=ZD("<div>").addClass("folderDataDiv").attr({id:G_OF_OBJ.jsonData.FOLDER[i].FOLDERID,permission:G_OF_OBJ.jsonData.FOLDER[i].PERMISSION,folderId:G_OF_OBJ.jsonData.FOLDER[i].FOLDERID,pntFolderId:G_OF_OBJ.jsonData.FOLDER[i].PARENTFOLDERID,wsid:G_OF_OBJ.jsonData.FOLDER[i].WORKSPACEID}).data({folderName:G_OF_OBJ.jsonData.FOLDER[i].ENCATTR_FOLDERNAME}),folderTable=ZD('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="folderDiv">'),folderTR=ZD("<tr>"),folderTD=ZD("<td>"),fName=ZDUtils.substringName(G_OF_OBJ.jsonData.FOLDER[i].ENCATTR_FOLDERNAME,"40"),displayFolderRow='<table width="100%" border="0" cellpadding="0" class="docs-tablerow"><tr>';this.options.checkboxIconSpace&&(displayFolderRow+='<td width="20" height="20" nowrap="nowrap" class="checkboxtd" elem="checkbox" ><img src="'+G_OF_OBJ.spacerImagePath+'" class="'+this.options.checkboxIcon+'" style="opacity:0.3;"/></td>'),this.options.documentIcon&&(displayFolderRow+='<td style="width:20px;" nowrap="nowrap"><div class="zdc-foldericon_css">&nbsp;</div></td>'),this.options.documentName&&(displayFolderRow+='<td style="width:100%" class="docscursor" nowrap="nowrap" align="left" title="'+G_OF_OBJ.jsonData.FOLDER[i].ENCATTR_FOLDERNAME+'"><a style="padding-left:6px;">'+fName+"</a></td>"),this.options.authorName&&(displayFolderRow+='<td width="110" class="zdtext-truncate" title="'+G_OF_OBJ.jsonData.FOLDER[i].ENCATTR_AUTHOR_NAME+'" nowrap="nowrap" align="left" elem="authorname">&nbsp;<a><span style="padding-left:10px;">'+G_OF_OBJ.jsonData.FOLDER[i].ENCATTR_AUTHOR_NAME+'</span></a></td><td width="100" nowrap="nowrap" ></td>'),displayFolderRow+="</tr></table>",folderTD.append(displayFolderRow),folderTR.append(folderTD),folderTable.append(folderTR),folderDiv.append(folderTable),this.folderDataDiv.append(folderDiv)}},_constructWSInfoRows:function(){for(var i=0,j=G_OF_OBJ.jsonData.WORKSPACE.length;j>i;i++){this.wsDataDiv=ZD("div#attachFileDataDiv");var wsDiv=ZD("<div>").addClass("folderDataDiv").attr({id:G_OF_OBJ.jsonData.WORKSPAwswsID,wsid:G_OF_OBJ.jsonData.WORKSPACE[i].wsID,pntFolderId:G_OF_OBJ.jsonData.WORKSPACE[i].PARENTFOLDERID}).data({wsName:G_OF_OBJ.jsonData.WORKSPACE[i].wsName}),wsTable=ZD('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="workspaceDiv">'),wsTR=ZD("<tr>"),wsTD=ZD("<td>"),wsName=ZDUtils.substringName(G_OF_OBJ.jsonData.WORKSPACE[i].wsName,"40"),displayWSRow='<table width="100%" border="0" cellpadding="0" class="docs-tablerow"><tr>';this.options.checkboxIconSpace&&(displayWSRow+='<td style="width:20px" height="20"></td>'),this.options.documentIcon&&(displayWSRow+="userws"==G_OF_OBJ.jsonData.WORKSPACE[i].type?'<td style="width:20px;" nowrap="nowrap"><div class="zdc-ws">&nbsp;</div></td>':'<td style="width:20px;" nowrap="nowrap"><div class="zdc-sharedws">&nbsp;</div></td>'),this.options.documentName&&(displayWSRow+='<td style="width:100%" class="docscursor" nowrap="nowrap" align="left" title="'+G_OF_OBJ.jsonData.WORKSPACE[i].wsName+'"><a style="padding-left:6px;">'+wsName+"</a></td>"),displayWSRow+="</tr></table>",wsTD.append(displayWSRow),wsTR.append(wsTD),wsTable.append(wsTR),wsDiv.append(wsTable),this.wsDataDiv.append(wsDiv)}},_constructPaginationData:function(){var data_pagination="";G_OF_OBJ.totalFiles>0&&(data_pagination='<table cellspacing="0" cellpadding="0" border="0" ><tr><td nowrap="nowrap" id="pagestatusid" class="pagecount smallText"></td><td><div id="prevbuttonid"  class="prevActive">&nbsp;</div></td><td><div id="nextbuttonid"  class="nextActive">&nbsp;</div></td></tr></table>',ZD("#servicefilepagination").html(data_pagination),G_OF_OBJ.nextIndex>=G_OF_OBJ.totalFiles&&(G_OF_OBJ.nextIndex=G_OF_OBJ.totalFiles,ZD("#prevbuttonid").removeClass().addClass("prevActive"),ZD("#nextbuttonid").removeClass().addClass("nextDis")),1==G_OF_OBJ.prevIndex&&ZD("#prevbuttonid").removeClass().addClass("preDis"),ZD("#pagestatusid").text(G_OF_OBJ.prevIndex+" - "+G_OF_OBJ.nextIndex+" "+zd_js_obj.of+" "+G_OF_OBJ.totalFiles),ZD("#servicefilepagination").show())},previousPage:function(){ZD("#prevbuttonid","#servicefilepagination").hasClass("preDis")||(G_OF_OBJ.nextIndex=Math.abs(G_OF_OBJ.prevIndex)-Math.abs(1),G_OF_OBJ.prevIndex=Math.abs(G_OF_OBJ.nextIndex)-(Math.abs(G_OF_OBJ.docsPerPage)-Math.abs(1)),G_OF_OBJ.prevIndex<G_OF_OBJ.topLevelFetch?(G_OF_OBJ.topLevelFetch=Math.abs(G_OF_OBJ.prevIndex),G_OF_OBJ.bottomLevelFetch=Math.abs(G_OF_OBJ.topLevelFetch)+Math.abs(G_OF_OBJ.fetchLimit)-Math.abs(1),G_OF_OBJ.endIndex="10",G_OF_OBJ.fromIndex="0",G_OF_OBJ.startFrom=G_OF_OBJ.topLevelFetch,ZD("div#showattachfilespace").attachfiledatagrid("sendAjaxRequest")):G_OF_OBJ.prevIndex<=G_OF_OBJ.bottomLevelFetch&&(G_OF_OBJ.fromIndex=Math.abs(G_OF_OBJ.fromIndex)-Math.abs(10),G_OF_OBJ.endIndex=Math.abs(G_OF_OBJ.endIndex)-Math.abs(10),ZD("div#showattachfilespace").attachfiledatagrid("constructDocumentRows")),ATTACHDIALOG.hideLoadingMsg())},nextPage:function(){return ZD("#nextbuttonid","#servicefilepagination").hasClass("nextDis")?!1:(G_OF_OBJ.prevIndex=Math.abs(G_OF_OBJ.nextIndex)+Math.abs(1),G_OF_OBJ.nextIndex=Math.abs(G_OF_OBJ.nextIndex)+Math.abs(G_OF_OBJ.docsPerPage),G_OF_OBJ.nextIndex<=G_OF_OBJ.bottomLevelFetch?(G_OF_OBJ.fromIndex=Math.abs(G_OF_OBJ.endIndex),G_OF_OBJ.endIndex=Math.abs(G_OF_OBJ.endIndex)+Math.abs(G_OF_OBJ.docsPerPage),ZD("div#showattachfilespace").attachfiledatagrid("constructDocumentRows")):(G_OF_OBJ.fromIndex="0",G_OF_OBJ.endIndex="10",G_OF_OBJ.topLevelFetch=Math.abs(G_OF_OBJ.bottomLevelFetch)+Math.abs(1),G_OF_OBJ.bottomLevelFetch=Math.abs(G_OF_OBJ.bottomLevelFetch)+Math.abs(G_OF_OBJ.fetchLimit),G_OF_OBJ.startFrom=G_OF_OBJ.topLevelFetch,ZD("div#showattachfilespace").attachfiledatagrid("sendAjaxRequest")),void ATTACHDIALOG.hideLoadingMsg())},resize:function(){ZD("#attachFileDataDiv").css({height:this.element.height()-30})},destroy:function(){ZD.Widget.prototype.destroy.apply(this,arguments),this.element.unbind("."+this.widgetName);var initdiv=this.element,items=ZD(initdiv).children();ZD(items).each(function(i,item){ZD(item).undelegate(),ZD(item).empty().remove()})}}),ZD.extend(ZD.ui.attachfiledatagrid,{version:"1.8"})}(jQuery);var G_ADDDOCS_OBJ;ADDDOCDIALOG.showAddDocDialog=function(obj,isWorkspaceEnable){var docsURL=obj.docsURL;if(void 0==zd_js_obj||""==zd_js_obj){G_ADDDOCS_OBJ=new ADDDOCDIALOG;var callbck=function(){ADDDOCDIALOG.showAddDocDialog(obj)};return ATTACHDIALOG.getI18N(callbck,docsURL),!1}if(zd_isIE&&(isWorkspaceEnable=!1),void 0===isWorkspaceEnable||""===isWorkspaceEnable){var callbckFunc=function(wsStatus){ADDDOCDIALOG.showAddDocDialog(obj,wsStatus)};return ADDDOCDIALOG.checkWorkspaceStatus(callbckFunc,docsURL),!1}if(!ZD("#adddocdialogdiv").length){void 0==G_ADDDOCS_OBJ&&(G_ADDDOCS_OBJ=new ADDDOCDIALOG),G_ADDDOCS_OBJ.docsURL=docsURL,G_ADDDOCS_OBJ.adddocObj=ZD.extend({},G_ADDDOCS_OBJ.defaultObj,obj),G_ADDDOCS_OBJ.urlInvoker=G_ADDDOCS_OBJ.adddocObj.servicename,G_ADDDOCS_OBJ.filename=G_ADDDOCS_OBJ.adddocObj.filename;{var positionObj=G_ADDDOCS_OBJ.adddocObj.positionObj,isDraggable=G_ADDDOCS_OBJ.adddocObj.isDraggable;G_ADDDOCS_OBJ.adddocObj.isResize}ZD("body").append('<div id="adddocdialogdiv" style="display:none;">');var buttonObj={};buttonObj[zd_js_obj.add]=function(){ADDDOCDIALOG.addDocToZDocs()},buttonObj[zd_js_obj.cancel]=function(){ZDDialog.closePopUp("adddocdialogdiv")},"zmail"===obj.servicename&&obj.isNewUI===!0?ADDDOCDIALOG.constructDialogMail(isWorkspaceEnable,ZD("#"+obj.containerDiv)):(ZDDialog.showCommonDialog(zd_js_obj.label_add_to_zoho_docs,!0,"adddocdialogdiv",buttonObj,positionObj,400,isDraggable,"auto",!1),ZD("#adddocdialogdiv").addClass("custommargin_lightgrey dottedborder"),ADDDOCDIALOG.constructDialogContent(isWorkspaceEnable))}},ADDDOCDIALOG.constructDialogMail=function(isWorkspaceEnable,containerDiv){ZD("#adddocdialogdiv").remove(),containerDiv.append('<div id="adddocdialogdiv"></div>'),ZD("#adddocdialogdiv").addClass("custommargin_lightgrey dottedborder docsdialog"),ZD(".docsdialog").css("width","100%"),ZD(".docsdialog").css("height","auto"),ZD("#adddocdialogdiv").css({width:"100%",height:"100%"}),"undefined"!=typeof isWorkspaceEnable&&0==isWorkspaceEnable?(ZD("#adddocdialogdiv").append('<div id="leftpanel_addtozd" style="width:15%;"><div id="personal_folder" class="docscursor selectedView" onclick=\'ADDDOCDIALOG.sendAjaxReqForMail(this);\'><span class="zdc-foldericon_css flleft margright"> </span><span>'+zd_js_obj.label_personal_folder+'</span></div><div id="shared_folder" class="docscursor normalView" onclick=\'ADDDOCDIALOG.sendAjaxReqForMail(this);\' style="margin-top:2px;"><span class="shareTome flleft margright"></span><span>Shared Folders</span></div></div>'),ZD("#adddocdialogdiv").append('<div style="width:81%;" id="rightpanel_addtozd"></div>')):(ZD("#adddocdialogdiv").append('<div id="leftpanel_addtozd" style="width:15%;"><div id="personal_folder" class="docscursor selectedView" onclick=\'ADDDOCDIALOG.sendAjaxReqForMail(this);\'><span class="zdc-foldericon_css  flleft margright"> </span><span>'+zd_js_obj.label_personal_folder+'</span></div><div id="shared_folder" class="docscursor normalView" onclick=\'ADDDOCDIALOG.sendAjaxReqForMail(this);\' style="margin-top:2px;"><span class="shareTome flleft margright"></span><span>Shared Folders</span></div><div id="ws_folder" class="docscursor normalView" onclick=\'ADDDOCDIALOG.sendAjaxReqForMail(this);\'><span class="zdc-ws flleft margright"></span><span>'+zd_js_obj.label_workspaces+"</span></div></div>"),ZD("#adddocdialogdiv").append('<div style="width:81%;" id="rightpanel_addtozd"></div>')),ZD("#rightpanel_addtozd").append('<div id="path_display"><span title="Home" class="sort-menu lightbluetxt flleft margright " id="homeButton" onclick=\'ADDDOCDIALOG.sendAjaxReqForMail();\'><span class="home flleft docscursor"></span></span><span title="Up one level" class="sort-menu lightbluetxt flleft margright non-hover" id="moveUpFolder" onclick=\'ADDDOCDIALOG.moveUpFolder();\'><span class="flleft back-folder-inactive"></span></span></div>'),ZD("#rightpanel_addtozd").append('<div id="folder_header"><button type="button" id="createFileBtn" style="width:45px;" class="docscursor" onclick=\'ADDDOCDIALOG.createNewFolderDiv();\'><span class="flleft createfolder" style="margin-left: 6px;"></span></button></div>'),ZD("#rightpanel_addtozd").append('<div id="folder_container"></div>'),ADDDOCDIALOG.sendAjaxReqForMail(),ZD(".docsdialog").find(".createfolder").css({"background-position":"-115px -492px",width:"18px"}),ZD("#adddocdialogdiv").append('<div id="bottompanel_addtozd" >'+zd_js_obj.label_saveas+' <input type="text" name="filenamecontainer" id="filenamecontainer"></div>'),ZD("#filenamecontainer").val(G_ADDDOCS_OBJ.filename),ZD("#filenamecontainer").focusin(function(){ZD(this).css("background-color","#F0F0F0"),ADDDOCDIALOG.editFileName()}),ZD("#filenamecontainer").focusout(function(){ZD(this).css("background-color","#FFFFFF"),ADDDOCDIALOG.setFileName()}),""!=G_ADDDOCS_OBJ.adddocObj.callback&&G_ADDDOCS_OBJ.adddocObj.callback()},ADDDOCDIALOG.editFileName=function(){var filename=ZD("#filenamecontainer").val(),ext="",filesplit="",filewithoutext="";filename.indexOf(".")>=0&&(filesplit=filename.split(".")),ext=filesplit[filesplit.length-1],G_ADDDOCS_OBJ.fileext=ext;for(var i=0;i<filesplit.length-1;i++)filewithoutext+=filesplit[i];ZD("#filenamecontainer").val(""),ZD("#filenamecontainer").val(filewithoutext)},ADDDOCDIALOG.setFileName=function(){var filename=ZD("#filenamecontainer").val(),completefilename="";""!=filename?(completefilename=filename+"."+G_ADDDOCS_OBJ.fileext,ZD("#filenamecontainer").val(completefilename),G_ADDDOCS_OBJ.filename=ZD("#filenamecontainer").val()):ZD("#filenamecontainer").val(G_ADDDOCS_OBJ.filename)},ADDDOCDIALOG.sendAjaxReqForMail=function(elem){var elemId=$(elem).attr("id");if(G_ADDDOCS_OBJ.issharedws=!1,G_ADDDOCS_OBJ.foldertree=[],!ZD("#"+elemId).hasClass("selectedView")){ZD("#personal_folder").removeClass("selectedView").addClass("normalView"),ZD("#shared_folder").removeClass("selectedView").addClass("normalView"),ZD("#ws_folder").removeClass("selectedView").addClass("normalView");var url="",params="";void 0===elem&&(elemId="personal_folder"),G_ADDDOCS_OBJ.parentId=[],G_ADDDOCS_OBJ.foldertree=[],ZD("#"+elemId).removeClass("normalView").addClass("selectedView"),ZD("#folderparent").empty(),ZD("#moveUpFolder").children("span").removeClass("back-folder").addClass("back-folder-inactive"),G_ADDDOCS_OBJ.rootvalue=elemId,"personal_folder"==elemId?(ZD("#createFileBtn").css("display","block"),url=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",params="type=foldertree&folderid=-1&"+zdcsrfPair+"&crossdomain=true"):"shared_folder"===elemId?(ZD("#createFileBtn").css("display","none"),url=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",params="type=sharedfoldertree&folderid=-1&"+zdcsrfPair+"&crossdomain=true"):"ws_folder"===elemId&&(ZD("#createFileBtn").css("display","none"),url=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/workspaces",params=zdcsrfPair+"&crossdomain=true"),ZD.ajax({url:url,data:params,type:"GET",xhrFields:{withCredentials:!0},dataType:"json",success:function(response,textStatus){return"success"==textStatus?(ADDDOCDIALOG.constructList(elemId,response),ZDUtils.hideLoadingMsg(),!1):void 0}})}},ADDDOCDIALOG.constructList=function(elem,data){var jsArray=data;ZD("#folder_container").append('<table id="folderList"></table>'),ZD("#folderList").empty(),"personal_folder"===elem?ZD.each(jsArray.folders,function(i,v){ZD("#folderList").append('<tr><td width=30px><div class="zdc-foldericon_css docscursor folderdocs"> </div></td><td class="docscursor" id="'+v.res_id+'" onclick=\'ADDDOCDIALOG.constructSubList(this,"'+v.parent_folder_id+"\");'>"+v.enc_res_name+"</td></tr>"),ZD("#"+v.res_id).data("zd_folderobj",v)}):"shared_folder"===elem?ZD.each(jsArray,function(i,v){1!==v.PERMISSION&&(ZD("#folderList").append('<tr><td width=30px><div class="zdc-foldericon_css docscursor folderdocs"> </div></td><td class="docscursor" id="'+v.FOLDERID+'" onclick=\'ADDDOCDIALOG.constructSubList(this,"'+v.PARENTFOLDERID+"\");'>"+v.ENC_FOLDERNAME+"</td></tr>"),ZD("#"+v.FOLDERID).data("zd_folderobj",v))}):"ws_folder"===elem&&(void 0===jsArray.workspaces?ZD.each(jsArray.folders,function(i,v){void 0!==v.res_id&&(ZD("#folderList").append('<tr><td width=30px><div class="zdc-foldericon_css docscursor folderdocs"> </div></td><td class="docscursor" id="'+v.res_id+'" onclick=\'ADDDOCDIALOG.constructSubList(this,"'+v.parent_folder_id+"\");'>"+v.enc_res_name+"</td></tr>"),ZD("#"+v.res_id).data("zd_folderobj",v))}):ZD.each(jsArray.workspaces,function(i,v){void 0!==v.res_id&&(ZD("#folderList").append('<tr><td width=30px><div class="zdc-ws docscursor folderdocs"> </div></td><td class="docscursor" id="'+v.res_id+"\" onclick='ADDDOCDIALOG.constructSubList(this,1);'>"+v.enc_res_name+"</td></tr>"),ZD("#"+v.res_id).data("zd_folderobj",v))})),""==ZD("#folderList").html()&&ZD("#folderList").append('<center style=" padding-left: 200px;padding-top: 150px;">---- '+zd_js_obj.label_no_items_are_present+" ----</center>")},ADDDOCDIALOG.constructSubList=function(elem,parId){var elemId=$(elem).attr("id");ZD("#moveUpFolder").children("span").removeClass("back-folder-inactive").addClass("back-folder"),G_ADDDOCS_OBJ.parentId.push(parId);var zd_folderdata=ZD("#"+elemId).data("zd_folderobj");G_ADDDOCS_OBJ.foldertree.push(zd_folderdata),"ws_folder"===G_ADDDOCS_OBJ.rootvalue&&void 0!==G_ADDDOCS_OBJ.foldertree[0].type&&"shared"===G_ADDDOCS_OBJ.foldertree[0].type&&(G_ADDDOCS_OBJ.issharedws=!0);var url="",params="";"personal_folder"===G_ADDDOCS_OBJ.rootvalue?(url=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",params="type=foldertree&folderid="+elemId+"&"+zdcsrfPair+"&crossdomain=true"):"shared_folder"===G_ADDDOCS_OBJ.rootvalue?(G_ADDDOCS_OBJ.permission.push(zd_folderdata.PERMISSION),G_ADDDOCS_OBJ.folderlevel.push(zd_folderdata.FOLDER_LEVEL),url=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",params="type=sharedfoldertree&permission="+zd_folderdata.PERMISSION+"&parentfolderlevel="+zd_folderdata.FOLDER_LEVEL+"&folderid="+elemId+"&"+zdcsrfPair+"&crossdomain=true"):"ws_folder"===G_ADDDOCS_OBJ.rootvalue&&(url=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",params="type=wsfoldertree&folderid="+elemId+"&"+zdcsrfPair+"&crossdomain=true"),ZD.ajax({url:url,data:params,type:"GET",xhrFields:{withCredentials:!0},dataType:"json",success:function(response,textStatus){return"success"==textStatus?(ADDDOCDIALOG.constructList(G_ADDDOCS_OBJ.rootvalue,response),ZDUtils.hideLoadingMsg(),!1):void 0}})},ADDDOCDIALOG.createNewFolderDiv=function(){ZD("#newFolderCreator").remove(),ZD("body").append('<div id="newFolderCreator" class="ui-draggable docsdialog"><div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-draggable ui-dialog-buttons docsdialog" tabindex="-1" style="outline: 0px; z-index: 10004; height: auto; width: 400px; top: 41px; left: 483px; display: block;" role="dialog" aria-labelledby="ui-id-3"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span id="ui-id-3" class="ui-dialog-title">New Folder</span><a href="#" class="ui-dialog-titlebar-close ui-corner-all" id="closeImg" role="button"><span class="ui-icon ui-icon-closethick">close</span></a></div><div id="dialogviewdiv" class="ui-dialog-content ui-widget-content" scrolltop="0" scrollleft="0" style="width: auto; min-height: 0px; height: auto;"><div style="width:auto;padding-top:35px"><div id="folderlabel" style="margin-top: -25px;">Please Enter Folder Name</div><input type="text" id="createfolderinput"  style="width: 95%;margin-top: 12px;"></div></div> <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><div class="ui-dialog-buttonset"><button type="button" class="ui-widget ui-corner-all ui-button-text-only ui-zbutton-priority ui-button ui-state-default" id="createFolderBtn" role="button" aria-disabled="false"><span class="ui-button-text">Create</span></button><button type="button" class="ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-secondary" id="closeBtn" role="button" aria-disabled="false"><span class="ui-button-text">Cancel</span></button></div></div></div></div>'),ZD("#createfolderinput").focus(),ZD("#newFolderCreator").draggable(),ZD("#createFolderBtn").click(function(){var folder_name=encodeURIComponent(ZD("#createfolderinput").val());if(folder_name.length>=100)alert(zd_js_obj.folder_validation_max_100_characters),ZD("#createfolderinput").val(""),ZD("#createfolderinput").focus();else if(""!=folder_name){var url=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/create",params="name="+folder_name+"&parentfolderid=-1&"+zdcsrfPair+"&crossdomain=true";ZD.ajax({url:url,type:"POST",data:params,xhrFields:{withCredentials:!0},success:function(response,textStatus){return"success"==textStatus?(ADDDOCDIALOG.showFolderCreationStatus(response),ZDUtils.hideLoadingMsg(),!1):void 0}}),ZD("#newFolderCreator").remove()}}),ZD("#closeImg").click(function(){ZD("#newFolderCreator").remove()}),ZD("#closeBtn").click(function(){ZD("#newFolderCreator").remove()})},ADDDOCDIALOG.showFolderCreationStatus=function(data){ZD.parseJSON(data);"FOLDER_CREATED_SUCCESSFULLY"===data.message?ADDDOCDIALOG.sendAjaxReqForMail():"ALREADY_NAME_EXISTS"===data.response.result.message?(alert(zd_js_obj.label_create_foldername_already_exists),ADDDOCDIALOG.createNewFolderDiv()):(alert(zd_js_obj.label_unable_to_create_folder_error),ADDDOCDIALOG.sendAjaxReqForMail())},ADDDOCDIALOG.moveUpFolder=function(){var url="",params="",index=G_ADDDOCS_OBJ.parentId.length-1;ZD("#moveUpFolder").children("span").hasClass("back-folder")&&(G_ADDDOCS_OBJ.foldertree.pop(),"personal_folder"===G_ADDDOCS_OBJ.rootvalue?0===index?(ADDDOCDIALOG.sendAjaxReqForMail(),ZD("#moveUpFolder").children("span").removeClass("back-folder").addClass("back-folder-inactive")):(url=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",params="type=foldertree&folderid="+G_ADDDOCS_OBJ.parentId[index]+"&"+zdcsrfPair+"&crossdomain=true",G_ADDDOCS_OBJ.parentId.pop()):"shared_folder"===G_ADDDOCS_OBJ.rootvalue?(0===index?(url=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",params="type=sharedfoldertree&folderid=-1&"+zdcsrfPair+"&crossdomain=true",ZD("#moveUpFolder").children("span").removeClass("back-folder").addClass("back-folder-inactive"),G_ADDDOCS_OBJ.parentId.pop()):(url=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",params="type=sharedfoldertree&permission="+G_ADDDOCS_OBJ.permission[index]+"&parentfolderlevel="+G_ADDDOCS_OBJ.folderlevel[index]+"&folderid="+G_ADDDOCS_OBJ.parentId[index]+"&"+zdcsrfPair+"&crossdomain=true",G_ADDDOCS_OBJ.parentId.pop()),G_ADDDOCS_OBJ.permission.pop(),G_ADDDOCS_OBJ.folderlevel.pop()):"ws_folder"===G_ADDDOCS_OBJ.rootvalue&&(0===index?(url=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/workspaces",params=zdcsrfPair+"&crossdomain=true",ZD("#moveUpFolder").children("span").removeClass("back-folder").addClass("back-folder-inactive"),G_ADDDOCS_OBJ.parentId.pop(),G_ADDDOCS_OBJ.issharedws=!1):(url=G_ADDDOCS_OBJ.docsURL+"/api/v2/files/tree",params="type=wsfoldertree&folderid="+G_ADDDOCS_OBJ.parentId[index]+"&"+zdcsrfPair+"&crossdomain=true",G_ADDDOCS_OBJ.parentId.pop())),""!==url&&ZD.ajax({url:url,data:params,type:"GET",xhrFields:{withCredentials:!0},dataType:"json",success:function(response,textStatus){return"success"==textStatus?(ADDDOCDIALOG.constructList(G_ADDDOCS_OBJ.rootvalue,response),ZDUtils.hideLoadingMsg(),!1):void 0}}))},ADDDOCDIALOG.addToZDocsNewUI=function(){{var len=G_ADDDOCS_OBJ.foldertree.length;G_ADDDOCS_OBJ.filename}if(0!==len){var zd_resData=G_ADDDOCS_OBJ.foldertree[len-1];"personal_folder"===G_ADDDOCS_OBJ.rootvalue?G_ADDDOCS_OBJ.folderid=zd_resData.res_id:"shared_folder"===G_ADDDOCS_OBJ.rootvalue?G_ADDDOCS_OBJ.folderid=zd_resData.FOLDERID:"ws_folder"===G_ADDDOCS_OBJ.rootvalue&&(G_ADDDOCS_OBJ.workspaceid=G_ADDDOCS_OBJ.foldertree[0].res_id,G_ADDDOCS_OBJ.folderid=zd_resData.res_id,G_ADDDOCS_OBJ.issharedws=G_ADDDOCS_OBJ.issharedws)}var obj={fname:G_ADDDOCS_OBJ.filename,folderid:G_ADDDOCS_OBJ.folderid,workspaceid:G_ADDDOCS_OBJ.workspaceid,issharedws:G_ADDDOCS_OBJ.issharedws};return obj.handbckobj=G_ADDDOCS_OBJ.adddocObj.handbckobj,ZDDialog.closePopUp("adddocdialogdiv"),obj},ADDDOCDIALOG.constructDialogContent=function(isWorkspaceEnable){ZD("#adddocdialogdiv").append('<table class="add-to-docs" width="100%" border="0" cellspacing="0" cellpadding="5"><tbody>'),ZD("#adddocdialogdiv > table").append('<tr id="status_msg" style="display:none;"><td colspan="3"><div class="status-message" id="msg_content"></div></td></tr>'),ZD("#adddocdialogdiv > table").append('<tr><td width="50" align="right"><span  style="margin-left:0px;">'+zd_js_obj.label_add_as+'</span></td><td><input class="inputtext txtinput flleft" id="add_doc_name" type="text" name="docname" style="height:25px;" value="'+G_ADDDOCS_OBJ.filename+'"></td><td width="30" align="right" id="expand_view"><button type="button" class="open-tree"></button></td></tr>'),ZD("#adddocdialogdiv > table").append('<tr id="selected_folder"><td align="right"><span>'+zd_js_obj.label_where+'</span></td><td><div class="add-to-my-folder"><span style="width:17px;height:16px;" class="zdc-add-to-docs-folder flleft margright"></span>'+zd_js_obj.my_folders+"</div></td></tr>"),ZD("#adddocdialogdiv > table").append("undefined"!=typeof isWorkspaceEnable&&0==isWorkspaceEnable?'<tr id="folder_container" style="display:none;"><td colspan="3" valign="top"><div style="border:1px solid #CBD3E2;height:260px;width:100%;"><div style="border-bottom:1px solid #CBD3E2;height:22px;padding:6px;width:auto;background:#f8f8f8;"><select class="toolbarselect flleft margright lookin-select" id="selectOption" style="height:22px;width:300px;"><optgroup label="'+zd_js_obj.label_select_view+'"><option id="opt_folder" value="opt_folder" class="pad-lft">'+zd_js_obj.label_personal_folder+'</option><option id="opt_sharedfolder" value="opt_sharedfolder" class="pad=lft">Shared Folders</option></optgroup></select></div><div id="openloadingmsg"></div><div id="tree_container" style="height: 222px;overflow: auto;"></div></div></td></tr>':'<tr id="folder_container" style="display:none;"><td colspan="3" valign="top"><div style="border:1px solid #CBD3E2;height:260px;width:100%;"><div style="border-bottom:1px solid #CBD3E2;height:22px;padding:6px;width:auto;background:#f8f8f8;"><select class="toolbarselect flleft margright lookin-select" id="selectOption" style="height:22px;width:300px;"><optgroup label="'+zd_js_obj.label_select_view+'"><option id="opt_folder" value="opt_folder" class="pad-lft">'+zd_js_obj.label_personal_folder+'</option><option id="opt_sharedfolder" value="opt_sharedfolder" class="pad=lft">Shared Folders</option><option id="opt_ws" value="opt_ws" class="pad-lft">'+zd_js_obj.label_workspaces+'</option></optgroup></select></div><div id="openloadingmsg"></div><div id="tree_container" style="height: 222px;overflow: auto;"></div></div></td></tr>'),ADDDOCDIALOG.initDelegate()},ADDDOCDIALOG.initDelegate=function(){ZD("#expand_view").delegate("button","click",function(){ADDDOCDIALOG.expandFolderView(this)}),ZD("#folder_container").delegate("select","change",function(){var selectedVal=ZD(this).val();"opt_ws"===selectedVal||"opt_sharedfolder"===selectedVal?ADDDOCDIALOG.constructTree(selectedVal,""):zd_isIE||ADDDOCDIALOG.sendAjaxRequest(selectedVal)})},ADDDOCDIALOG.expandFolderView=function(cElem){if(ZD(cElem).hasClass("open-tree")){{ZD("#adddocdialogdiv").height()}ZD("#selected_folder").hide(),ZD("#folder_container").show(),ZD(cElem).removeClass("open-tree").addClass("open-tree-selected"),ADDDOCDIALOG.sendAjaxRequest("opt_folder")}else{ZD("#selected_folder").show(),ZD("#folder_container").hide();{ZD("#adddocdialogdiv").height(),ZD("#adddocdialogdiv").height()}ZD(cElem).removeClass("open-tree-selected").addClass("open-tree")}document.getElementById("selectOption").selectedIndex=0},ADDDOCDIALOG.constructURL=function(elem){var url=G_ADDDOCS_OBJ.docsURL+"/docs/adddocrequest.do?method=";return"opt_folder"==elem?url+="getFolderTree":"opt_sharedfolder"===elem&&(url+="getSharedFolderTree&folderid="+G_ADDDOCS_OBJ.folderid),url+="&_t="+(new Date).getTime()},ADDDOCDIALOG.checkWorkspaceStatus=function(callbck,docsURL){var url=docsURL+"/docs/adddocrequest.do?method=checkWorkspaceStatus";ZD.ajax({url:url,type:"GET",xhrFields:{withCredentials:!0},dataType:"json",success:function(data){void 0!=callbck&&""!=callbck&&callbck(data.status)}})},ADDDOCDIALOG.constructTree=function(elem,data){var containerDiv=ZD("div#tree_container");containerDiv.html(""),containerDiv.append(data);var treeElem="";"opt_folder"===elem?treeElem=ZD("#addtozddiv"):"opt_sharedfolder"===elem?(containerDiv.append('<form id="moveForm" name="moveForm">'),ZD("form#moveForm").append('<div id="addtozddiv">'),treeElem=ZD("#addtozddiv")):"opt_ws"==elem&&(containerDiv.append('<form id="moveForm" name="moveForm">'),ZD("form#moveForm").append('<div id="treecondivws">'),treeElem=ZD("#treecondivws")),"opt_folder"==elem?(treeElem.jstree({core:{animation:0,initially_open:["node0"]},themes:{theme:"classic",url:G_ADDDOCS_OBJ.docsURL+"/docs/css/"+G_ADDDOCS_OBJ.theme+"/docs.tree.css"},plugins:["themes","html_data"]}),ZD("#collapse").remove()):"opt_sharedfolder"===elem?(treeElem.jstree({core:{animation:0,initially_open:["node0"]},themes:{theme:"classic",url:G_ADDDOCS_OBJ.docsURL+"/docs/css/"+G_ADDDOCS_OBJ.theme+"/docs.tree.css"},html_data:{ajax:{url:G_ADDDOCS_OBJ.docsURL+"/docs/adddocrequest.do?method=getSharedFolderTree",f_node:{},data:function(n){if(this.f_node=n,-1!==n){var id=ZD(n).attr("id"),date=new Date;id=id.replace("nodes","");var params="folderid="+id+"&_t="+date.getTime();return params}var date=new Date,params="folderid=-1&_t="+date.getTime();return params},dataType:"html",success:function(d){return d=d.replace(/^\s*|\s(?=\s)|\s*$/g,""),0===d.length?(d=null,d='<li class="graytxt smallText italicText">'+zd_js_obj.no_folder+"</li>"):"No Folders"===d&&(d='<div class="graytxt" style="padding:50px 0 0;text-align:center;">'+zd_js_obj.label_no_shared_folder+"</div>"),d}}},plugins:["themes","html_data"]}),ZD("#collapse").remove()):"opt_ws"==elem&&treeElem.jstree({core:{animation:0,initially_open:["rootnode-1"]},themes:{theme:"classic",url:G_ADDDOCS_OBJ.docsURL+"/docs/css/"+G_ADDDOCS_OBJ.theme+"/docs.tree.css"},ui:{select_limit:"1",initially_select:"",selected_parent_close:!1,select_prev_on_delete:!1},html_data:{ajax:{url:G_ADDDOCS_OBJ.docsURL+"/docs/adddocrequest.do?method=getWorkSpaceFolderTree&_t="+ZD.now(),f_node:{},data:function(n){if(this.f_node=n,-1!=n){var id=ZD(n).attr("id");return id=id.replace("node",""),"folderid="+id}return"folderid=-1"},dataType:"html",success:function(val){return val=val.replace(/^\s*|\s(?=\s)|\s*$/g,""),0==val.length?(val=null,val='<li class="graytxt smallText italicText">'+zd_js_obj.no_folder+"</li>"):"nofolder"===val?val='<li class="graytxt smallText italicText">'+zd_js_obj.no_folder+"</li>":"noworkspace"==val&&(val='<div class="graytxt" style="padding:50px 0 0;text-align:center;">'+zd_js_obj.no_workspace+"</div>"),val}}},plugins:["themes","html_data"]}),G_ADDDOCS_OBJ.folderid="-1",G_ADDDOCS_OBJ.workspaceid="-1",G_ADDDOCS_OBJ.wsfolderid="-1",G_ADDDOCS_OBJ.issharedws=!1},ADDDOCDIALOG.sendAjaxRequest=function(elem){ZDUtils.LoadingMsg(zd_js_obj.loading);var url=ADDDOCDIALOG.constructURL(elem);ZD.ajax({url:url,type:"GET",xhrFields:{withCredentials:!0},dataType:"html",success:function(response,textStatus){return"success"==textStatus?(ADDDOCDIALOG.constructTree(elem,response),ZDUtils.hideLoadingMsg(),!1):void 0}})},ADDDOCDIALOG.showStatusMsg=function(message){ZD("#msg_content").html(message),ZD("#status_msg").fadeIn(400),setTimeout(function(){ZD("#status_msg").fadeOut(400),ZD("#msg_content").html("")},4e3)},ADDDOCDIALOG.hasSpecialChar=function(value){for(var iChars="<>*%#&?\\',\"",specialCharCheck=1,i=0;i<value.length;i++)-1!=ZD.inArray(value.charAt(i),iChars)&&(specialCharCheck+=1);return specialCharCheck>1?!0:!1},ADDDOCDIALOG.hasWhiteSpaceChar=function(value){return""==value||void 0==value?!0:!1},ADDDOCDIALOG.validateFileName=function(docname){return void 0!=docname&&ZD.trim(docname).length<=0?(ADDDOCDIALOG.showStatusMsg(zd_js_obj.document_name_empty_validation),!1):ZD.trim(docname).length>100?(ADDDOCDIALOG.showStatusMsg(zd_js_obj.document_validation_max_100_characters),!1):ADDDOCDIALOG.hasSpecialChar(docname)?(ADDDOCDIALOG.showStatusMsg(zd_js_obj.special_characters_validaton),!1):!0},ADDDOCDIALOG.addDocToZDocs=function(){var docName=ZD("#add_doc_name").val();if(!ADDDOCDIALOG.validateFileName(docName))return!1;if(G_ADDDOCS_OBJ.filename=docName,ZD("#expand_view > button").hasClass("open-tree"))G_ADDDOCS_OBJ.folderid="folder";else{var selectedObj=ZD("input[name='destFolderId']:checked"),optSelected=ZD("#selectOption option:selected").val();if(void 0==selectedObj||0==selectedObj.length){var message=zd_js_obj.label_add_to_zd_notselect_folder;return"opt_ws"==optSelected&&(message=zd_js_obj.label_add_to_zd_notselect_ws),ADDDOCDIALOG.showStatusMsg(message),!1}var selectedId=selectedObj.val()+"";if("opt_ws"===ZD("#selectOption option:selected").val()){G_ADDDOCS_OBJ.workspaceid=selectedObj.attr("wsid"),G_ADDDOCS_OBJ.folderid=selectedObj.val();var isSharedws=selectedObj.parent().attr("sharedworkspacefolder");void 0!=isSharedws&&"true"==isSharedws&&(G_ADDDOCS_OBJ.issharedws=!0)}else G_ADDDOCS_OBJ.folderid=selectedId,"0"==selectedId&&(G_ADDDOCS_OBJ.folderid="folder")}var obj={fname:G_ADDDOCS_OBJ.filename,folderid:G_ADDDOCS_OBJ.folderid,workspaceid:G_ADDDOCS_OBJ.workspaceid,issharedws:G_ADDDOCS_OBJ.issharedws};obj.handbckobj=G_ADDDOCS_OBJ.adddocObj.handbckobj,addToZDCallBck(obj),ZDDialog.closePopUp("adddocdialogdiv")},function($){$.widget("ui.DocsFileUploader",{defaults:{service:"zdocs",container_id:"",fileLimit:3,maxFileSize:100,fileSizeInByte:1024,docs_url:"",udserver_url:"",permaLink:"",doc_conversion:!1,ie_url:"",folderId:"-1",workSpaceId:"",libraryId:"",callback:"",ieParams:"",udserver_upload:!0,zsoid:"",progresscallbck:"",UploadStatusObj:{},uploadto:"",handback:"",fileType:"",params:{isUploadStatus:!1,totalFilesCount:1,sharedType:""}},_create:function(){this.options=$.extend({},this.defaults,this.options),this.options.permaLink=this.options.docs_url;var param="?";for(var key in this.options.params)param=param+key+"="+this.options.params[key]+"&";param=""!=this.options.workSpaceId&&"-1"!=this.options.folderId?param+"doc_conversion="+this.options.doc_conversion+"&folderId="+this.options.folderId+"&isWSsubFolder=true&workSpaceUpload=true&workSpaceId="+this.options.workSpaceId:""!=this.options.libraryId&&"zdocs"===this.options.service?param+"workSpaceId="+this.options.libraryId+"&isWSsubFolder=false&folderId=-1&workSpaceUpload=true&libraryId="+this.options.libraryId:""!=this.options.workSpaceId&&"-1"===this.options.folderId?param+"doc_conversion="+this.options.doc_conversion+"&workSpaceUpload=true&folderId="+this.options.workSpaceId:param+"doc_conversion="+this.options.doc_conversion+"&folderId="+this.options.folderId,this.options.ie_url=this.options.docs_url,"zdocs"===this.options.service||"zwriter"===this.options.service?this.options.docs_url=this.options.docs_url+"/dndupload.do"+param:"cms"===this.options.service?this.options.docs_url=this.options.docs_url+"/ws/wsdndupload.do?zsoid="+this.options.zsoid+"&updateDoc=false&workSpaceId="+this.options.workSpaceId+"&folderId=-1&zsoidservice="+this.options.service:"zcrm"===this.options.service&&(this.options.url=this.options.url+param),this.options.ieParams=param,this._buttonInit()},_buttonInit:function(){var self=this;if(void 0==zd_js_obj||""==zd_js_obj){var callbck=function(){self._buttonInit()};return self.getI18N(callbck,self.options.docs_url),!1}if(this.options.isComp)""===this.options.fileType||"all"===this.options.fileType?$("#linkdocsdialogdiv").append('<input type="file" id="zd_UploadButton" name="multiupload_file" value="" style="visibility:hidden;" multiple>'):"images"===this.options.fileType&&$("#linkdocsdialogdiv").append('<input type="file" accept="image/*" id="zd_UploadButton" name="multiupload_file" value="" style="visibility:hidden;" multiple>'),$(this.element).click(function(){$("#zd_UploadButton").click()});else{$(this.element).append('<input type="file" id="zd_UploadButton" name="multiupload_file" value="" style="opacity:0;position:absolute;left:-2000px;" multiple>');var width=$(this.element).width();$("#zd_UploadButton").css("width",width),$(this.element).hover(function(){$("#zd_UploadButton").css("left","0px")},function(){$("#zd_UploadButton").css("left","-2000px")})}var self=this;$("#zd_UploadButton").bind("change",function(){""===self.options.container_id&&""===self.options.callback&&$("body").append('<table id="zd_contain"></table>');var url=self.options.docs_url,appVersion=navigator.appVersion.split(";"),verNumber=appVersion[1],IEversion=10;if(void 0!==verNumber&&(IEversion=parseInt(verNumber.replace("MSIE ",""))),"Microsoft Internet Explorer"===navigator.appName&&(self.options.udserver_upload=!1),"Microsoft Internet Explorer"===navigator.appName&&9>=IEversion){{$("#zd_UploadButton").attr("value")}curFileElement=$("#zd_UploadButton");var formId=(new Date).getTime(),targId="target"+(new Date).getTime(),pntElem=$("#zd_UploadButton").parent(),cloneFileElem=$("#zd_UploadButton").clone();pntElem.append(cloneFileElem);var $div=$("<div />").appendTo("body");$div.attr("id","uploadfilediv"),$div.attr("height","1%");var formElem=$("<form></form>");formElem.attr({id:"form-"+formId,target:targId,name:"form-"+formId,method:"POST",encType:"multipart/form-data",encoding:"multipart/form-data"}),formElem.css({margin:0,display:"none"}),formElem.append(curFileElement);var iframe=$('<iframe name="'+targId+'">').attr({height:"0",width:"0",id:targId}).css("display","none");$("body").append(iframe),$($div).append(formElem);var tmpuploadFileDiv=$("#uploadfilediv"),tmpUploadForms=tmpuploadFileDiv.children("form"),refElem={};refElem.uid="docsUploadWidget",refElem.callbck=self.options.callback;var uploadUrl=self.options.ie_url+"/uploadsingle.do"+self.options.ieParams+"&refFileElementId=docsUploadWidget"+self.options.callback;$(tmpUploadForms[0]).attr("action",uploadUrl),tmpUploadForms[0].submit()}else{var fileList=this.files,fileCount=fileList.length;fileCount>self.options.fileLimit&&(fileCount=self.options.fileLimit),fileCount>100&&(fileCount=100);for(var i=0;fileCount>i;i++)self.docUpload(fileList[i],fileList[i].size,fileList[i].name,url,i)}})},getI18N:function(callbck,docsURL){var url="https://"+docsURL+"/docs/zduserdetails.do";$.ajax({url:url,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(data){$("#zd_user_details").remove(),$("body").append(data),void 0!=callbck&&""!=callbck&&callbck()}})},updateProgress:function(obj,event,invoker,upload_id){var self=this;if(event.lengthComputable){var percentage=Math.round(100*event.loaded/event.total);if(obj.currentProgress!=percentage){obj.currentProgress=percentage,self.fileUploadProgressUpdated(upload_id,obj.fileName,obj.fileSize,obj.currentProgress,invoker);var elapsed=(new Date).getTime(),diffTime=elapsed-obj.currentStart;if(diffTime>3e3){{event.loaded-obj.startData}obj.startData=event.loaded,obj.currentStart=elapsed,obj.currentStart=elapsed}}}},fileUploadProgressUpdated:function(upload_id,fileName,fileSize,newProgress){var self=this,zdocs_progress=newProgress/100*100;"function"==typeof self.options.progresscallbck&&self.options.progresscallbck(zdocs_progress,fileName,fileSize,upload_id)},cancelUpload:function(upload_id){var self=this;self.options.UploadStatusObj[upload_id].abort()},docUpload:function(fileObj,fileSize,file_Name,url,index){var self=this;"cms"===self.options.service&&(url=self.options.permaLink+"/ws/corswsdndupload.do?zsoid="+self.options.zsoid+"&updateDoc=false&workSpaceId="+self.options.workSpaceId+"&folderId="+self.options.folderId+"&zsoidservice="+self.options.service);var docsize=fileSize/(self.options.fileSizeInByte*self.options.fileSizeInByte);if(docsize>self.options.maxFileSize)return alert(ZDUtils.replaceParams(zd_js_obj.file_chooser_file_size_is_greater_than_limit,[file_Name,self.options.maxFileSize,"MB"])),!1;var req=new XMLHttpRequest,upload=req.upload;upload.fileIndex=index,upload.fileName=file_Name,upload.fileSize=docsize,upload.downloadStartTime=(new Date).getTime(),upload.currentStart=upload.downloadStartTime,upload.currentProgress=0,upload.startData=0;var upload_id=index+"_new_"+$.now();if(upload.upload_id=upload_id,upload.addEventListener("progress",function(event){"zcrm"===self.options.service?self.updateProgress(upload,event,"CR",upload_id):"cms"===self.options.service&&self.updateProgress(upload,event,"cms",upload_id)},!1),req.fileName=file_Name,req.withCredentials=!0,"withCredentials"in req){if(self.options.udserver_upload){req.open("POST",zd_udserverurl+"/postservlet",!0),req.setRequestHeader("Connection","Keep-Alive"),req.setRequestHeader("Content-type","application/x-www-form-urlencoded"),req.setRequestHeader("x-service",zd_udservicekey),"zcrm"===self.options.service?(req.setRequestHeader("invoker","CR"),req.setRequestHeader("x-uploadto",self.options.uploadto)):"cms"===self.options.service?req.setRequestHeader("invoker","cms"):(req.setRequestHeader("invoker","Upload"),req.setRequestHeader("x-uploadTo","myfolders")),req.setRequestHeader("x-streammode","1"),req.setRequestHeader("upload-id",index+"_new_"+$.now()),req.setRequestHeader("x-content_type",fileObj.type),req.setRequestHeader("x-filename",encodeURIComponent(fileObj.name)),req.setRequestHeader("x-doc_conversion",!1),req.setRequestHeader("x-folderId",self.options.folderId),""!==self.options.workSpaceId&&void 0!==self.options.workSpaceId&&req.setRequestHeader("x-wsId",self.options.workSpaceId),""!==self.options.zsoid&&void 0!==self.options.zsoid&&req.setRequestHeader("x-zsoid",self.options.zsoid),req.setRequestHeader("charset","utf-8"),req.setRequestHeader("Content-Length",fileObj.size);var sendTo="";"zwriter"===self.options.service?sendTo="WR":"zsheet"===self.options.service?sendTo="ST":"zshow"===self.options.service?sendTo="SW":"zbooks"===self.options.service?sendTo="ZB":"zmail"===self.options.service?sendTo="VO":"zcrm"===self.options.service?sendTo="CR":"zplanner"===self.options.service?sendTo="PL":"cms"===self.options.service&&(sendTo="ZS"),req.setRequestHeader("x-notifyto",sendTo),req.send(fileObj)}else{var formdata=new FormData;formdata.append("multiupload_file",fileObj),req.open("POST",url,!0),req.onreadystatechange=function(){if(4===this.readyState&&this.status>=200&&this.status<400){var response=this.response;$("body").append(response);var docsFileURl=self.options.permaLink+"/file/"+$("#successdndmessagediv").attr("docId");$(self.element).text(zd_js_obj.file_chooser_label_upload_to_docs);var linkElem="<a href="+docsFileURl+' name="filelink" id="filelink">'+this.fileName+"</a>";if($("#theImg").remove(),$(self.element).unbind("click"),$(self.element).bind("click",function(){$("#zd_UploadButton").click()}),$("#result").css("display","block"),""!=self.options.container_id&&""===self.options.callback)$("#"+self.options.container_id).append(linkElem);else if(""!=self.options.callback&&"function"==typeof self.options.callback){var temp="";temp=""!=self.options.handback?$("#successdndmessagediv").attr("docId")+self.options.handback:$("#successdndmessagediv").attr("docId"),self.options.callback(temp)}else $("#zd_contain").append("<tr><td>"+linkElem+"</td></tr>");$("#successdndmessagediv").remove()}},req.send(formdata)}$(self.element).unbind("click"),$(self.element).text(zd_js_obj.file_chooser_label_uploading),$("#theImg").remove()}},_destroy:function(){$.widget.prototype.destroy.call(this)}})}(jQuery),"undefined"!=typeof Collaboration&&(Collaboration.prototype.constructor.handleCrossProductMessage=function(_super){return function(){if("UDSERVER_UPLOAD"===arguments[1].action){var arg1=arguments[1];jQuery(":data(DocsFileUploader)").each(function(){var widgetInstance=$(this).data("DocsFileUploader");widgetInstance.options.isComp&&($(widgetInstance.element).unbind("click"),$(widgetInstance.element).bind("click",function(){$("#zd_UploadButton").click()}));var callBackFunction=widgetInstance.options.callback;callBackFunction(arg1.resourceId)})}else if("CREATE_THUMBNAIL"==arguments[1].action){var arg1=arguments[1];jQuery(":data(DocsFileUploader)").each(function(){var widgetInstance=$(this).data("DocsFileUploader");if(widgetInstance.options.isComp){var url=widgetInstance.options.permaLink+"/api/v2/files/properties?action=jsonobject&crossdomain=true&resourceid="+arg1.resourceId+"&"+zdcsrfPair;void 0!==G_LD_OBJ&&(url+="&accessService="+G_LD_OBJ.urlInvoker+"&zsoid="+G_LD_OBJ.zsoid),ZD.ajax({url:url,datatype:"json",xhrFields:{withCredentials:!0},success:function(data){ZD("#"+data.res_id).html(""),ZD("#"+data.res_id).append('<div style="width:75px;height:75px;"><img src="'+data.preview_url+'" style="height:75px;width:75px;" onerror="LINKDOCS.imgLoadingError(\''+data.no_preview_class+'\',this);"></div><div style="height:18px"><p style="font-size:small;margin-top:0px;height:18px;width:81px;overflow:hidden;margin-left:-3px;white-space: nowrap;" title="'+data.enc_res_name+'">'+data.enc_res_name+"</p></div>")}})}})}return _super.apply(this,arguments)}}(Collaboration.prototype.constructor.handleCrossProductMessage));