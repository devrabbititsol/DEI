function EventHandler(){}function Body(){var e=new Element;return{getStart:function(){return 0},getEnd:function(){return 0},setStart:e.setStart,setEnd:e.setEnd,type:NODE_TYPE.BODY,attr:e.attr,find:e.find,nextSibling:e.nextSibling,previousSibling:e.previousSibling,parentNode:e.parentNode,firstChild:e.firstChild,lastChild:e.lastChild,select:e.select,getFormat:function(){return this.attr},insert:function(){},children:e.children,remove:function(){}}}function Section(e,t,i,o,r,n,a,l,s,d){var c=new Element;return{getStart:c.getStart,getEnd:c.getEnd,setStart:c.setStart,setEnd:c.setEnd,secId:i,type:NODE_TYPE.SECTION,subType:e,attr:c.attr,nextSibling:c.nextSibling,previousSibling:c.previousSibling,parentNode:c.parentNode,firstChild:function(){var e=editor.doc.findNextIndexOf(UNICODE.PARA+"|"+UNICODE.TABLE,this.getStart());if(editor.doc.getCharAt(e)==UNICODE.PARA){var i=editor.doc.createElement(NODE_TYPE.PARAGRAPH,{});i.setStart(e);var o=editor.doc.findNextIndexOf(CONT_REGEXP.PARAEND,i.getStart()+1);return o<0&&(o=e+t.length),i.setEnd(o),i}var r=editor.doc.createElement(NODE_TYPE.TABLE,{});r.setStart(e);var n=TableUtil.getTableEnd(this.getStart()+1);return r.setEnd(n),r},lastChild:c.lastChild,select:c.select,content:t?t:"",insert:function(e){var i=editor.doc.getDocumentLength(),p={st:this.subType,sid:this.secId,parentId:o,cType:r,type:this.type,userName:n,time:a,userId:l,color:s,activity:d};if(e){var u;for(u in e)p[u]=e[u]}var f=c.getStyleOp(p),g=c.getStyleOp({type:"paragraph"}),m=c.getStyleOp({type:"text"});t=UNICODE.SPACE+t;var h=[{r:i},f.as_start,{is:UNICODE.SECTION_START},f.as_end,m.as_start,{is:t},m.as_end,g.as_start,{is:UNICODE.PARA},g.as_end];c.isInserted=!0,this.setStart(i),this.setEnd(i+2+t.length),Op.processMsg(h),Op.fillCursorPos(i+5,i+5)},children:c.children,remove:function(){if(!EventHandler.textDragStart){var e=editor.doc.getContent(this.getStart(),this.getEnd()),t=[{r:this.getStart()},{ds:e}];if("endnote"==this.subType||"footnote"==this.subType){var i=editor.doc.getSelection().getTargetRange().start;if(this.getStart()<=i&&i<this.getEnd()){var o=NoteViewCollection.getNoteViews(this.secId)[0],r=1,n=NoteViewCollection.getNextNoteView(o)||NoteViewCollection.getPreviousNoteView(o);r=null==n?o.node.rangeIndex-1:n.node.start<o.node.start?n.node.start+1-3:n.node.start+1-3-e.length,Op.fillCursorPos(r,r)}}Op.processMsg(t)}},resolve:function(){this.attr({resolve:1})},reOpen:function(){this.attr({resolve:0})}}}function Paragraph(e){var t=new Element;return{getStart:t.getStart,setStart:t.setStart,getEnd:t.getEnd,setEnd:t.setEnd,type:NODE_TYPE.PARAGRAPH,dtNode:e?e:null,text:t.text,attr:t.attr,nextSibling:t.nextSibling,previousSibling:function(){if(this.dtNode){var e,t,i=null;if(e=this.dtNode.prev){if(t=e.type,"para"==t)t=NODE_TYPE.PARAGRAPH,i=editor.doc.createElement(NODE_TYPE.PARAGRAPH,e);else if("table"==t){var o={};o.dtNode=e,i=editor.doc.createElement(NODE_TYPE.TABLE,o)}else i=editor.doc.createElement(t);return i.setStart(e.getIndex()),i.setEnd(e.getEndIndex()+1),i}}},parentNode:function(){if(this.dtNode){var e,t,i=null,o={};if(e=this.dtNode.parent)return t=e.type,"section"==t?i=editor.doc.createElement(NODE_TYPE.BODY):"cell"==t?(o.dtNode=e,i=editor.doc.createElement(NODE_TYPE.CELL,o)):i=editor.doc.createElement(t),i.setStart(e.getIndex()),i.setEnd(e.getEndIndex()+1),i}},firstChild:function(){var e,t=this.getStart(),i=editor.doc.getCharAt(t),o=editor.doc.getRawFormatAt(t);if(o&&o.type==NODE_TYPE.IMAGE)e=editor.doc.createElement(NODE_TYPE.IMAGE,o);else{if(o&&o.type==NODE_TYPE.BOOKMARK&&i==UNICODE.RANGE_START){var r=DocUtil.getRangeEnd(t),n=editor.doc.createElement(NODE_TYPE.BOOKMARK,o);return n.setStart(t),n.setEnd(r+1),n}e=editor.doc.createElement(NODE_TYPE.TEXT,o)}return e.setStart(t),e.setEnd(t+1),e},lastChild:function(){var e=this.getEnd()-1;e-=1;var t,i=(editor.doc.getCharAt(e),editor.doc.getRawFormatAt(e));return t=i&&i.type==NODE_TYPE.IMAGE?editor.doc.createElement(NODE_TYPE.IMAGE,i):editor.doc.createElement(NODE_TYPE.TEXT,i),t.setStart(e),t.setEnd(e+1),t},select:t.select,insert:function(){var e=this.getStart(),t=[{r:e},{is:"\n"}];this.setEnd(e+1);var i=Utils.randomString();if(arguments[0]){var o=arguments[0];o.type||(o.type=this.type);var r=DocUtil.getKeys(o);t=[{r:e},{as:{start:o,id:i}},{is:"\n"},{as:{end:r,id:i}}]}else{var o=DocUtil.getParaStyle(e),r=DocUtil.getKeys(o);t=[{r:e},{as:{start:o,id:i}},{is:"\n"},{as:{end:r,id:i}}]}Op.processMsg(t)},children:t.children,remove:function(){}}}function Iframe(){var e=new Element;return{getStart:e.getStart,setStart:e.setStart,getEnd:e.getEnd,setEnd:e.setEnd,type:NODE_TYPE.WIDGET,text:e.text,attr:e.attr,nextSibling:e.nextSibling,select:e.select,children:e.children,insert:function(){var t,i,o,r,n,a,l,s,d=[];if(r=this.getStart()?this.getStart():editor.doc.getSelection().getStart(),i=editor.doc.getParents(NODE_TYPE.PARAGRAPH,r),i&&(t=i.getEnd()-1),o=editor.doc.getRawFormatAt(t),o[ATTR_PARAGRAPH.PS_TS]&&(o[ATTR_PARAGRAPH.PS_TS]=editor.doc.getSelection().textFormat,o[ATTR_PARAGRAPH.PS_TS].hasOwnProperty(TCConstants.TC)&&(o[ATTR_PARAGRAPH.PS_TS]=DocUtil.copyStyle(o[ATTR_PARAGRAPH.PS_TS]),delete o[ATTR_PARAGRAPH.PS_TS][TCConstants.TC])),n=DocUtil.getKeys(o),a=DocUtil.copyStyle(o),arguments[0]){l=arguments[0],l.type=this.type,s=DocUtil.getKeys(l);var c=Utils.randomString(),p=Utils.randomString(),u=Utils.randomString();d.push({r:r},{as:{start:a,id:p}},{is:UNICODE.PARA},{as:{end:n,id:p}},{as:{start:l,id:c}},{is:UNICODE.IFRAME},{as:{end:s,id:c}},{as:{start:a,id:u}},{is:UNICODE.PARA},{as:{end:n,id:u}})}Op.processMsg(d),e.isInserted(!1),this.setStart(r+2),this.setEnd(r+3)},remove:function(){var e=[{r:this.getStart()},{ds:UNICODE.IFRAME}];Op.processMsg(e)}}}function Element(){var e=-1,t=-1,i={};this.getStart=function(){return e},this.getEnd=function(){return t},this.setStart=function(t){e=t},this.setEnd=function(e){t=e},this.isInserted=function(){return e!=-1},this.remove=function(){editor.doc.getSelection().deleteContents(this.getStart(),this.getEnd())},this.firstChild=function(){var e=editor.doc.findNextIndexOf(UNICODE.PARA+"|"+UNICODE.TABLE,this.getStart());if(editor.doc.getCharAt(e)==UNICODE.PARA){var t=editor.doc.createElement(NODE_TYPE.PARAGRAPH,{});t.setStart(e);var i=editor.doc.findNextIndexOf(CONT_REGEXP.PARAEND,e+1);return t.setEnd(i),t}var o=editor.doc.createElement(NODE_TYPE.TABLE,{});o.setStart(e);var r=TableUtil.getTableEnd(this.getStart()+1);return o.setEnd(r),o},this.lastChild=function(){},this.children=function(){},this.insertBefore=function(){},this.insertAfter=function(){},this.appendChild=function(){},this.previousSibling=function(){editor.doc.previousSibling(this)},this.find=function(e){return new Iterator(this.getStart(),this.getEnd(),e)},this.select=function(){var e,t=editor.doc.getSelection(),i=this.getStart(),o=this.getEnd();EventHandler.isOnlyCtrlKeyPressed?(t.isCtrlSelection=!0,t.reArrangeRanges(i,o)):(e=editor.doc.createRange(i,o),t.removeAllRanges().addRange(e))},this.text=function(e){if(this.type==NODE_TYPE.PARAGRAPH){var t=editor.doc.findNextIndexOf(CONT_REGEXP.PARAEND,this.getStart())+1;t<0&&(t=editor.doc.getSectionEnd(this.getStart()));var i=editor.doc.getContent(this.getStart(),t);return e||(i=i.replace(REGEX.docUnicodes,"")),i}},this.nextSibling=function(){var e=editor.doc.findNextIndexOf(UNICODE.PARA+"|"+UNICODE.TABLE,this.getStart()+1),t=editor.doc.getSectionEnd(this.getStart());if(e<0||e>t)return null;if(editor.doc.getCharAt(e)==UNICODE.PARA){var i=editor.doc.createElement(NODE_TYPE.PARAGRAPH,{});i.setStart(e);var o=editor.doc.findNextIndexOf(CONT_REGEXP.PARAEND,e+1);return i.setEnd(o),i}var r=editor.doc.createElement(NODE_TYPE.TABLE,{});r.setStart(e);var n=TableUtil.getTableEnd(this.getStart()+1);return r.setEnd(n),r},this.parentNode=function(){editor.doc.parentNode(this)},this.getStyleOp=function(e){var t=Utils.randomString();return{as_start:{as:{start:e,id:t}},as_end:{as:{end:DocUtil.getKeys(e),id:t}}}},this.apply=null,this.attr=function(){if(0==arguments.length){if(this.type==NODE_TYPE.PARAGRAPH)var e=DocUtil.copyStyle(editor.doc.getRawFormatAt(this.getEnd()-1));else var e=DocUtil.copyStyle(editor.doc.getRawFormatAt(this.getStart()));for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t]);return e}var o=arguments[0],r={},n=[];if("string"==typeof o){if(this.type==NODE_TYPE.BODY)var e=editor.doc[this.type+"Format"];else if(this.type==NODE_TYPE.PARAGRAPH)var e=DocUtil.getParaFormat(this.getEnd()-1);else var e=editor.doc.getRawFormatAt(this.getStart());return"*"==o?DocUtil.copyStyle(e):("object"==typeof e&&(e=DocUtil.copyStyle(e)),e?e[o]:null)}if("object"!=typeof o)throw Image.ERROR_MSG_1;for(var t in o)o.hasOwnProperty(t)&&(i[t]=o[t],r[t]=o[t]);this.type&&(r.type=this.type);var a=DocUtil.getKeys(r),l=Utils.randomString();if(this.type!=NODE_TYPE.TEXT)n=this.type==NODE_TYPE.BODY?[{r:this.getStart()},{as:{start:r,id:l}},{r:0},{as:{end:a,id:l}}]:this.type==NODE_TYPE.PARAGRAPH?[{r:this.getEnd()-1},{as:{start:r,id:l}},{r:1},{as:{end:a,id:l}}]:[{r:this.getStart()},{as:{start:r,id:l}},{r:1},{as:{end:a,id:l}}];else{var s=this.getStart(),d=this.getEnd(),n=[];n.push({r:s}),n.push({as:{start:r,id:l}}),n.push({r:d-s}),n.push({as:{end:a,id:l}})}Op.processMsg(n)},this.css=this.attr}function Text(e){var t=new Element;return{setStart:t.setStart,setEnd:t.setEnd,getStart:t.getStart,getEnd:t.getEnd,type:NODE_TYPE.TEXT,attr:t.attr,nodeValue:e?e:"",nextSibling:t.nextSibling,previousSibling:t.previousSibling,parentNode:t.parentNode,firstChild:t.firstChild,lastChild:t.lastChild,select:t.select,insert:function(){jQuery.isEmptyObject(editor.doc.paintFormat)||(editor.doc.paintFormat={},editor.jeditorPane.find("div.zw-page").css("cursor",""));var e=this.getStart(),t=e+this.nodeValue.length,i=[{r:e},{is:this.nodeValue}],o=Utils.randomString();if(arguments[0]){var r=arguments[0];r.type||(r.type=this.type);var n=DocUtil.getKeys(r);i=[{r:e},{as:{start:r,id:o}},{is:this.nodeValue},{as:{end:n,id:o}}]}this.setStart(e),this.setEnd(t),Op.processMsg(i)},remove:t.remove,children:t.children}}function BR(e,t){var i=new Element;return{getStart:i.getStart,setStart:i.setStart,getEnd:i.getEnd,setEnd:i.setEnd,type:NODE_TYPE.BR,nodeValue:e&&e.c?e.c:UNICODE.BR,attr:i.attr,nextSibling:i.nextSibling,previousSibling:i.previousSibling,parentNode:i.parentNode,firstChild:i.firstChild,lastChild:i.lastChild,select:function(){},insert:function(){var e=this.getStart(),t={};t[ATTR_COMMON.TYPE]=this.type;var i=Utils.randomString(),o=DocUtil.getKeys(t),r=[{r:e},{as:{start:t,id:i}},{is:this.nodeValue},{as:{end:o,id:i}}],n=e+this.nodeValue.length;this.setEnd(n),Op.processMsg(r)},children:i.children,remove:function(){}}}function HR(e,t){var i=new Element;return{getStart:i.getStart,setStart:i.setStart,getEnd:i.getEnd,setEnd:i.setEnd,type:NODE_TYPE.HR,nodeValue:e&&e.c?e.c:"",attr:i.attr,nextSibling:i.nextSibling,previousSibling:i.previousSibling,parentNode:i.parentNode,firstChild:i.firstChild,lastChild:i.lastChild,select:function(){var e=DocUtil.getDOMSourceIndex(this.getStart(),UNICODE.HR),t=DomUtil.getElementAt("hr",e,editor.clientActiveSection);Resize.setTargetImg(t),Resize.setResizeDiv()},insert:function(){var e=this.getStart(),t={type:this.type},o=editor.doc.getParents(NODE_TYPE.PARAGRAPH,e),r=e;o&&(r=o.getEnd()-1);var n=DocUtil.copyStyle(editor.doc.getRawFormatAt(r));n[ATTR_PARAGRAPH.PS_TS]&&(n[ATTR_PARAGRAPH.PS_TS]=editor.doc.getSelection().textFormat,n[ATTR_PARAGRAPH.PS_TS].hasOwnProperty(TCConstants.TC)&&(n[ATTR_PARAGRAPH.PS_TS]=DocUtil.copyStyle(n[ATTR_PARAGRAPH.PS_TS]),delete n[ATTR_PARAGRAPH.PS_TS][TCConstants.TC]));var a=DocUtil.getKeys(n),l=Utils.randomString(),s=Utils.randomString(),d=[{r:e},{as:{start:n,id:s}},{is:"\n"},{as:{end:a,id:s}},{as:{start:t,id:l}},{is:this.nodeValue},{as:{end:["type"],id:l}}];if(arguments&&arguments.length>0){l=Utils.randomString(),s=Utils.randomString(),t=arguments[0],t.type=this.type,this.isPageBreak&&(t[ATTR_TEXT.CLS]="pgbrk",t[ATTR_TEXT.BID]="pgbrk"),this.isColumnBreak&&(t[ATTR_TEXT.CLS]="colbrk",t[ATTR_TEXT.BID]="colbrk");var c=DocUtil.getKeys(t);d=[{r:e},{as:{start:n,id:s}},{is:"\n"},{as:{end:a,id:s}},{as:{start:t,id:l}},{is:this.nodeValue},{as:{end:c,id:l}}]}var p=e+this.nodeValue.length;Op.processMsg(d),this.setEnd(p),i.isInserted(!0)},children:i.children,remove:function(){}}}function ZWImage(){var e=new Element;return{getStart:e.getStart,getEnd:e.getEnd,setStart:e.setStart,setEnd:e.setEnd,type:NODE_TYPE.IMAGE,attr:e.attr,nextSibling:e.nextSibling,previousSibling:e.previousSibling,parentNode:e.parentNode,firstChild:e.firstChild,lastChild:e.lastChild,select:function(){var e=DocUtil.getDOMSourceIndex(this.getStart(),UNICODE.IMAGE),t=DomUtil.getElementAt("img",e,editor.clientActiveSection);J(t).trigger("click")},insert:function(){var t,i=this.getStart()?this.getStart():editor.doc.getSelection().getStart(),o=[{r:i},{is:UNICODE.IMAGE}],r=Utils.randomString();if(arguments.length>0){t=arguments[0],t.type=this.type;var n=DocUtil.getKeys(t);o=[{r:i},{as:{start:t,id:r}},{is:UNICODE.IMAGE},{as:{end:n,id:r}}]}Op.processMsg(o),e.isInserted(!1),this.setStart(i),this.setEnd(i+1)},children:e.children,remove:function(){var e=[{r:this.getStart()},{ds:UNICODE.IMAGE}];Op.processMsg(e)}}}function Iterator(e,t,i){this.type=i,this.endIdx=t,this.startIdx=e,this.setType=function(e){this.type=e},this.getType=function(){return this.type},this.setEnd=function(e){this.endIdx=e},this.setStart=function(e){this.startIdx=e},this.hasNext=function(){return this.startIdx<this.endIdx},this.getNextItem=function(){for(var e=this.getType(),t=null,i=this.startIdx;!t&&i<=this.endIdx;){var o=new RegExp(UNICODE.TABLE+"|"+UNICODE.TABLEEND+"|"+UNICODE.ROW+"|"+UNICODE.CELL+"|"+UNICODE.PARA+"|"+UNICODE.SECTION_START,"g"),r=editor.doc.getCharAt(i);switch(!0){case e==NODE_TYPE.TEXT&&!o.test(r):var n=editor.doc.findNextIndexOf(CONT_REGEXP.PARAEND,i);n<0&&(n=editor.doc.getDocumentLength());var r=editor.doc.getContent(i,n);t=editor.doc.createElement(NODE_TYPE.TEXT,r),t.setStart(i),t.setEnd(n-1);break;case e==NODE_TYPE.PARAGRAPH&&r==UNICODE.PARA:t=editor.doc.createElement(NODE_TYPE.PARAGRAPH,r),t.setStart(i);var a=editor.doc.findNextIndexOf(UNICODE.TABLE+"|"+UNICODE.PARA+"|"+UNICODE.CELL+"|"+UNICODE.ROW+"|"+UNICODE.TABLEEND+"|"+UNICODE.SECTION_START,i+1);a<0&&(a=editor.doc.getDocumentLength()),t.setEnd(a);break;case e.indexOf(NODE_TYPE.CELL)&&r==UNICODE.CELL:t=editor.doc.createElement(NODE_TYPE.CELL),t.setStart(i);var l=editor.doc.findNextIndexOf(UNICODE.CELL+"|"+UNICODE.ROW+"|"+UNICODE.TABLEEND,i+1);t.setEnd(l);break;case e==NODE_TYPE.SECTION&&r==UNICODE.SECTION_START:var s=editor.doc.getRawFormatAt(i),d=s.st,c=s.sid,p=editor.doc.findNextIndexOf(CONT_REGEXP.SECTIONEND,i+1);p<0&&(p=editor.doc.getDocumentLength());var u=editor.doc.getContent(i,p);switch(d){case NODE_TYPE.BOOKMARK:nodeName=NODE_TYPE.BOOKMARK;break;case NODE_TYPE.FOOTNOTE:nodeName=NODE_TYPE.FOOTNOTE;break;case NODE_TYPE.ENDNOTE:nodeName=NODE_TYPE.ENDNOTE;break;case NODE_TYPE.COMMENT:nodeName=NODE_TYPE.COMMENT;break;case NODE_TYPE.HEADER_PRIMARY:nodeName=NODE_TYPE.HEADER_PRIMARY;break;case NODE_TYPE.FOOTER_PRIMARY:nodeName=NODE_TYPE.FOOTER_PRIMARY}t=editor.doc.createElement(nodeName,c),t.setStart(i),t.setEnd(p),t.setContent(u),i=p-1}i++}return t?this.setStart(t.getEnd()+1):this.setStart(this.endIdx+1),t}}function LinkItem(e,t,i,o,r){var n=new Element;return{getStart:n.getStart,setStart:n.setStart,getEnd:n.getEnd,setEnd:n.setEnd,type:NODE_TYPE.LINK,attr:n.attr,nextSibling:n.nextSibling,previousSibling:n.previousSibling,parentNode:n.parentNode,firstChild:n.firstChild,lastChild:n.lastChild,select:n.select,insert:function(e,t){sel=editor.doc.getSelection();var i=this.getStart()||sel.getStart();i=0==i?1:i;var o=this.getEnd()||sel.getEnd();editor.doc.getSelection().isCollapsed()||editor.doc.getCharAt(o-1)!=UNICODE.PARA||(o-=1);var r=Utils.randomString();linkstyle=arguments[0],linkstyle.id=r;var n={},a={char:UNICODE.RANGE_START,style:linkstyle};n[ATTR_COMMON.ID]=r,n[ATTR_COMMON.TYPE]=NODE_TYPE.LINK;var l={char:UNICODE.RANGE_END,style:n};if(n={},n[ATTR_TEXT.CLS]="link",n[ATTR_LINK.LINK_URL]=linkstyle[ATTR_LINK.LINK_URL],n[ATTR_LINK.LINK_TYPE]=linkstyle[ATTR_LINK.LINK_TYPE],n[ATTR_LINK.LINK_TARGET]=linkstyle[ATTR_LINK.LINK_TARGET],n[ATTR_LINK.LINK_TOOLTIP]=linkstyle[ATTR_LINK.LINK_TOOLTIP],n[ATTR_COMMON.TYPE]=NODE_TYPE.TEXT,arguments[0].text){var s=[];for(var d in n)s.push(d);var c=editor.doc.createElement(NODE_TYPE.TEXT,arguments[0].text),p=Utils.mergeObjs([editor.doc.getSelection().getTextFormat(),n]);return delete p[ATTR_TEXT.TS_FGC],c.css=p,editor.doc.getSelection().surroundAndInsert(a,l,c),void delete arguments[0].text}var u=editor.doc.createElement(NODE_TYPE.TEXT);u.setStart(i),u.setEnd(o),n[ATTR_TEXT.TS_FGC]="",u.attr(n),sel.surroundTextWith(a,l,t)},children:n.children,remove:function(){var e=this.getStart(),t=this.getEnd(),i=editor.doc.createElement(NODE_TYPE.TEXT);i.setStart(e+1),i.setEnd(t-1);var o={};o[ATTR_TEXT.CLS]="unlink",o[ATTR_TEXT.TS_FGC]="",o[ATTR_TEXT.TS_TD]="",o[ATTR_LINK.LINK_TYPE]="",i.attr(o);var r=editor.doc.getContent(e,e+1),n=editor.doc.getContent(t-1,t);msg=[{r:e},{ds:r},{r:t-e-2},{ds:n}],Op.processMsg(msg)}}}function Table(e,t,i,o,r){var n=new Element,a=function(e){var t={};return t[ATTR_COMMON.TYPE]=NODE_TYPE.CELL,t},l=function(e){e&&e[ATTR_PARAGRAPH.PS_HD]&&parseInt(e[ATTR_PARAGRAPH.PS_HD])>=0&&(e[ATTR_PARAGRAPH.PS_TS]={},delete e[ATTR_PARAGRAPH.PS_HD]),e.ls_data||(delete e[ATTR_PARAGRAPH.PS_ML],delete e[ATTR_PARAGRAPH.PS_MR],delete e[ATTR_PARAGRAPH.PS_TI]),delete e[ATTR_PARAGRAPH.PS_CODE]};return{getStart:n.getStart,setStart:n.setStart,getEnd:n.getEnd,setEnd:n.setEnd,type:NODE_TYPE.TABLE,dtNode:r?r:null,attr:n.attr,rows:e?e:2,cols:t?t:2,tableVals:o?o:void 0,cellAttrs:i?i:void 0,nextSibling:function(){var e,t,i={},o=null;if(this.dtNode&&(e=this.dtNode.next))return t=e.type,"para"==t?o=editor.doc.createElement(NODE_TYPE.PARAGRAPH,e):"table"==t?(i.dtNode=e,o=editor.doc.createElement(NODE_TYPE.TABLE,i)):o=editor.doc.createElement(t),o.setStart(e.getIndex()),o.setEnd(e.getEndIndex()+1),o},previousSibling:function(){var e,t,i={},o=null;if(this.dtNode&&(e=this.dtNode.prev))return t=e.type,"para"==t?o=editor.doc.createElement(NODE_TYPE.PARAGRAPH,e):"table"==t?(i.dtNode=e,o=editor.doc.createElement(NODE_TYPE.TABLE,i)):o=editor.doc.createElement(t),o.setStart(e.getIndex()),o.setEnd(e.getEndIndex()+1),o},parentNode:function(){var e,t,i=null;if(this.dtNode&&(e=this.dtNode.parent))return t=e.type,i="section"==t?editor.doc.createElement(NODE_TYPE.BODY):"cell"==t?editor.doc.createElement(NODE_TYPE.CELL,e):editor.doc.createElement(t),i.setStart(e.getIndex()),i.setEnd(e.getEndIndex()+1),i},children:function(){var e,t,i,o,r=[],n={};if(this.dtNode)for(children=this.dtNode.children,i=0,o=children.length;i<o;i++)t=children[i],n.dtNode=t,e=editor.doc.createElement(NODE_TYPE.ROW,n),e.setStart(t.getIndex()),e.setEnd(t.getEndIndex()+1),r.push(e);return r},firstChild:function(){var e,t,i={};if(this.dtNode)return t=this.dtNode.children[0],i.dtNode=t,e=editor.doc.createElement(NODE_TYPE.ROW,i),e.setStart(t.getIndex()),e.setEnd(t.getEndIndex()+1),e},lastChild:function(){var e,t,i={};if(this.dtNode)return t=this.dtNode.children[this.dtNode.children.length-1],i.dtNode=t,e=editor.doc.createElement(NODE_TYPE.ROW,i),e.setStart(t.getIndex()),e.setEnd(t.getEndIndex()+1),e},nodeCountBefore:function(e){for(var t=e.getStart()-1,i=0,o=0;editor.doc.getCharAt(t)!=UNICODE.TABLE;)o=TableUtil.getRowStart(t),t=o-1,i++;return i},insertBefore:function(e,t,i,o){var r=editor.doc.createElement(NODE_TYPE.ROW);r.setStart(e.getStart()),r.insert(t,i,o)},appendChild:function(e,t,i){var o=editor.doc.createElement(NODE_TYPE.ROW);o.setStart(this.getEnd()-1),o.insert(e,t,i)},insert:function(){var e,t,i=UNICODE.TABLE,o=this.getStart(),r=[],s=editor.doc.getParents(NODE_TYPE.PARAGRAPH,o);s&&(paraIdx=s.getEnd()-1);var d=editor.doc.getRawFormatAt(paraIdx);d.hasOwnProperty(TCConstants.TC)&&delete d[TCConstants.TC],d[ATTR_PARAGRAPH.PS_TS]&&(d[ATTR_PARAGRAPH.PS_TS]=editor.doc.getSelection().textFormat,d[ATTR_PARAGRAPH.PS_TS].hasOwnProperty(TCConstants.TC)&&(d[ATTR_PARAGRAPH.PS_TS]=DocUtil.copyStyle(d[ATTR_PARAGRAPH.PS_TS]),delete d[ATTR_PARAGRAPH.PS_TS][TCConstants.TC]));var c=DocUtil.getKeys(d),p=editor.doc.getSelection().parents(NODE_TYPE.CELL);if(p){var u=DocTreeManager.getTreeNodeAtIndex(p.getStart()),f=u.width;t=Conversions.toGlobalValue(f+UNITS.PIXELS),e=Conversions.toGlobalValue(f/this.cols+UNITS.PIXELS)}else{var g=ViewManager.getColumnWidth()/Conversions.globalUnitInPx;e=(g/this.cols).toFixed(3)+Conversions.globalUnit,t=g.toFixed(3)+Conversions.globalUnit}if(this.cellAttrs){t=0;for(var m=0,h=this.cellAttrs.length;m<h;m++)t+=this.cellAttrs[m][ATTR_CELL.TDS_WID];t=Conversions.toGlobalValue(t+UNITS.PIXELS)}for(var T,E=[],m=0;m<this.cols;m++)T=this.cellAttrs?{wt:Conversions.toGlobalValue(this.cellAttrs[m][ATTR_CELL.TDS_WID]+UNITS.PIXELS)}:{wt:e},E.push(T);var R={};R[ATTR_ROW.TRS_HT]="auto",R[ATTR_COMMON.TYPE]=NODE_TYPE.ROW;var S=DocUtil.getKeys(R),O=UNICODE.TABLE,v=DocUtil.copyStyle(d),b=Utils.randomString(),A=Utils.randomString(),y={};y[ATTR_TABLE.TBLS_THEME]={},y[ATTR_TABLE.TBLS_THEME][ATTR_TABLE.TBLS_THEME_OBJECT]={tblPr:{cell:{borders:{"border-top":{type:"solid",width:"1px",color:"rgb(0,0,0)"},"border-left":{type:"solid",width:"1px",color:"rgb(0,0,0)"},"border-bottom":{type:"solid",width:"1px",color:"rgb(0,0,0)"},"border-right":{type:"solid",width:"1px",color:"rgb(0,0,0)"}}}}},y[ATTR_TABLE.TBLS_THEME][ATTR_TABLE.TBLS_THEMENAME]="theme1",y.type=this.type,y[ATTR_TABLE.TBLS_WID]=t,y[ATTR_TABLE.TBLS_COLS]=E,y[ATTR_TABLE.TBLS_VER]="4.0",d[ATTR_PARAGRAPH.PS_DIR]==PARA_DIR.RTL&&(y[ATTR_TABLE.TBLS_DIR]=PARA_DIR.RTL),Utils.addId(y,"tb-",4);var D=DocUtil.getKeys(y);r.push({r:o},{as:{start:v,id:b}},{is:UNICODE.PARA},{as:{end:c,id:b}},{as:{start:y,id:A}},{is:O},{as:{end:D,id:A}}),v=DocUtil.copyStyle(d),v[ATTR_PARAGRAPH.PS_DIR]=d[ATTR_PARAGRAPH.PS_DIR]?d[ATTR_PARAGRAPH.PS_DIR]:PARA_DIR.LTR,l(v),c=DocUtil.getKeys(v);for(var C=0;C<this.rows;C++){var R={},I=Utils.randomString();R[ATTR_ROW.TRS_HT]="auto",R[ATTR_COMMON.TYPE]=NODE_TYPE.ROW,Utils.addId(R,"rw-",4),i+=UNICODE.ROW,O=UNICODE.ROW,r.push({as:{start:R,id:I}},{is:O},{as:{end:S,id:I}});var P=v,_=void 0;if(this.tableVals&&this.tableVals[C]){var N=this.tableVals[C].paraFormat;_=this.tableVals[C].cellValuesOpsArr,l(N),P=N}for(var L=(DocUtil.getKeys(P),0);L<this.cols;L++){var w=a(e),M=Utils.randomString();Utils.addId(w,"cl-",4);var U=DocUtil.getKeys(w);if(this.cellAttrs&&(w[ATTR_CELL.TDS_WID]=Conversions.toGlobalValue(this.cellAttrs[L][ATTR_CELL.TDS_WID]+UNITS.PIXELS)),i+=UNICODE.CELL+UNICODE.PARA,O=UNICODE.CELL,r.push({as:{start:w,id:M}},{is:O},{as:{end:U,id:M}}),_&&_[L])for(var x=_[L],F=_[L].length,k=0;k<F;k++){var B=x[k];if(r.push(B),"is"==DocUtil.getKeys(B)[0]){var J=B.is;i+=J}}var H=DocUtil.copyStyle(P);O=UNICODE.PARA;var b=Utils.randomString();r.push({as:{start:H,id:b}},{is:O},{as:{end:DocUtil.getKeys(H),id:b}})}}var G=n.getStyleOp({type:"tableend"});r.push(G.as_start,{is:UNICODE.TABLEEND},G.as_end),i+=UNICODE.TABLEEND+UNICODE.PARA,this.text=i;editor.doc.getTrackChangeDetails();Op.processMsg(r),this.setEnd(this.getStart()+this.text.length)},remove:n.remove,select:n.select}}function Row(e,t,i){var o=new Element;return{getStart:o.getStart,setStart:o.setStart,getEnd:o.getEnd,setEnd:o.setEnd,type:NODE_TYPE.ROW,dtNode:i?i:null,cols:e?e:2,action:t,attr:o.attr,nextSibling:function(){if(this.dtNode){var e,t=null,i={};if(e=this.dtNode.next)return i.dtNode=e,t=editor.doc.createElement(NODE_TYPE.ROW,i),t.setStart(e.getIndex()),t.setEnd(e.getEndIndex()+1),t}},firstChild:function(){var e,t=null;if(this.dtNode&&(e=this.dtNode.children[0]))return t=editor.doc.createElement(NODE_TYPE.CELL,e),t.setStart(e.getIndex()),t.setEnd(e.getEndIndex()+1),t},lastChild:function(){var e,t=null;if(this.dtNode&&(e=this.dtNode.children[this.dtNode.children.length-1]))return t=editor.doc.createElement(NODE_TYPE.CELL,e),t.setStart(e.getIndex()),t.setEnd(e.getEndIndex()+1),t},previousSibling:function(){if(this.dtNode){var e,t=null,i={};if(e=this.dtNode.prev)return i.dtNode=e,t=editor.doc.createElement(NODE_TYPE.ROW,i),t.setStart(e.getIndex()),t.setEnd(e.getEndIndex()+1),t}},insertAfter:function(e,t,i,o){var r=t.getEnd();e.setStart(r),e.insert(i,o)},insertBefore:function(e,t,i,o){e.setStart(t.getStart()),e.insert(i,o)},appendChild:function(e,t){e.setStart(this.getEnd()),e.insert(t)},insert:function(e,t,i){Utils.addId(e,"rw-",4);var o,r=Utils.randomString(),n=t.length,a=[{r:this.getStart()},{as:{start:e,id:r}},{is:UNICODE.ROW},{as:{end:DocUtil.getKeys(e),id:r}}];for(o=0;o<n;o++){var l=Utils.randomString(),s=Utils.randomString(),d=t[o];Utils.addId(d,"cl-",4),a.push({as:{start:d,id:l}}),a.push({is:UNICODE.CELL}),a.push({as:{end:DocUtil.getKeys(d),id:l}});var c=DocUtil.copyStyle(i[o]);a.push({as:{start:c,id:s}}),a.push({is:UNICODE.PARA}),a.push({as:{end:DocUtil.getKeys(c),id:s}})}Op.processMsg(a)},nodeCountBefore:function(e){for(var t=e.getStart()-1,i=0;editor.doc.getCharAt(t)!=UNICODE.ROW;){var o=TableUtil.getCellStart(t);t=o-1,i++}return i},parentNode:function(){var e=editor.doc.getParents(NODE_TYPE.TABLE,this.getStart());return e},children:function(){var e,t,i,o,r=[];if(this.dtNode)for(e=this.dtNode.children,i=0,o=e.length;i<o;i++)t=e[i],elem=editor.doc.createElement(NODE_TYPE.CELL,t),elem.setStart(t.getIndex()),elem.setEnd(t.getEndIndex()+1),r.push(elem);return r},remove:o.remove}}function Cell(e){var t=new Element;return{getStart:t.getStart,setStart:t.setStart,getEnd:t.getEnd,setEnd:t.setEnd,type:NODE_TYPE.CELL,dtNode:e?e:null,attr:t.attr,nextSibling:function(){var e,t=null;return this.dtNode&&(e=this.dtNode.next,e&&(t=editor.doc.createElement(NODE_TYPE.CELL,e),t.setStart(e.getIndex()),t.setEnd(e.getEndIndex()+1))),t},firstChild:function(){var e,t,i=null,o={};if(this.dtNode&&(e=this.dtNode.children[0]))return t=e.type,"para"==t?i=editor.doc.createElement(NODE_TYPE.PARAGRAPH,e):"table"==t?(o.dtNode=e,i=editor.doc.createElement(NODE_TYPE.TABLE,o)):i=editor.doc.createElement(t),i.setStart(e.getIndex()),i.setEnd(e.getEndIndex()+1),i},lastChild:function(){var e,t,i=null,o={};if(this.dtNode&&(e=this.dtNode.children[this.dtNode.children.length-1]))return t=e.type,"para"==t?i=editor.doc.createElement(NODE_TYPE.PARAGRAPH,e):"table"==t?(o.dtNode=e,i=editor.doc.createElement(NODE_TYPE.TABLE,o)):i=editor.doc.createElement(t),i.setStart(e.getIndex()),i.setEnd(e.getEndIndex()+1),i},previousSibling:function(){var e,t=null;return this.dtNode&&(e=this.dtNode.prev,e&&(t=editor.doc.createElement(NODE_TYPE.CELL,e),t.setStart(e.getIndex()),t.setEnd(e.getEndIndex()+1))),t},insert:function(e,t){var i,o=this.getStart(),r=UNICODE.CELL;t=t||DocUtil.copyStyle(editor.doc.getRawFormatAt(o-1));var n=DocUtil.getKeys(t),a={};a[ATTR_COMMON.TYPE]=NODE_TYPE.CELL,t&&t[ATTR_PARAGRAPH.PS_HD]&&parseInt(t[ATTR_PARAGRAPH.PS_HD])>=0&&(t[ATTR_PARAGRAPH.PS_TS]={},delete t[ATTR_PARAGRAPH.PS_HD]),arguments[0]&&(a=arguments[0]),Utils.addId(a,"cl-",4);var l=DocUtil.getKeys(a),s=Utils.randomString(),d=Utils.randomString();i=[{r:o},{as:{start:a,id:s}},{is:r},{as:{end:l,id:s}},{as:{start:t,id:d}},{is:UNICODE.PARA},{as:{end:n,id:d}}];var c=editor.doc.getTrackChangeDetails();c.setStopProcessingTC(!0),Op.processMsg(i),c.setStopProcessingTC(!1)},children:function(){var e,t,i,o,r,n,a=[],l={};if(this.dtNode)for(o=this.dtNode.children,e=0,t=o.length;e<t;e++)i=o[e],n=i.type,l={},"para"==n?(n=NODE_TYPE.PARAGRAPH,r=editor.doc.createElement(n,i)):"table"==n?(l.dtNode=i,r=editor.doc.createElement(n,l)):r=editor.doc.createElement(n,i),r.setStart(i.getIndex()),r.setEnd(i.getEndIndex()+1),a.push(r);return a},parentNode:function(){var e,t=null,i={};if(this.dtNode)return e=this.dtNode.parent,i.dtNode=e,t=editor.doc.createElement(NODE_TYPE.ROW,i),t.setStart(e.getIndex()),t.setEnd(e.getEndIndex()+1),t},select:t.select,remove:t.remove,getInnerTableIndexes:function(){for(var e=[],t=editor.doc.findNextIndexOf(UNICODE.TABLE,this.getStart());t!=-1&&t<this.getEnd();)e.push(t),t=editor.doc.findNextIndexOf(UNICODE.TABLE,t+1);return e}}}function bookmarkElement(e,t,i){var o=new Element;return t||(t=Utils.randomString()),{getStart:o.getStart,getEnd:o.getEnd,setStart:o.setStart,setEnd:o.setEnd,type:e,id:t,name:i,attr:o.attr,nextSibling:o.nextSibling,previousSibling:o.previousSibling,parentNode:o.parentNode,firstChild:o.firstChild,lastChild:o.lastChild,select:o.select,insert:function(){var e=editor.doc.createElement(NODE_TYPE.TEXT),t=editor.doc.getSelection(),o=t.getTargetRange(),r=o.start,n=o.end;t.isCollapsed()||editor.doc.getCharAt(n-1)!=UNICODE.PARA||(n-=1),e.setStart(r),e.setEnd(n);var a={};a[ATTR_COMMON.TYPE]="text",e.attr(a),a={},a[ATTR_COMMON.TYPE]=NODE_TYPE.BOOKMARK,a[ATTR_COMMON.ID]=this.id,a[ATTR_COMMON.NAME]=i,t.surroundTextWith({char:UNICODE.RANGE_START,style:a},{char:UNICODE.RANGE_END,style:a})},children:o.children,remove:function(){var e,t=this.getStart(),i=this.getEnd(),o=editor.doc.getContent(t,t+1),r=editor.doc.getContent(i-1,i);e=[{r:t},{ds:o},{r:i-t-2},{ds:r}],Op.processMsg(e)}}}function autofieldElement(e,t){var i=new Element;return t||(t=Utils.randomString()),{getStart:i.getStart,getEnd:i.getEnd,setStart:i.setStart,setEnd:i.setEnd,type:e,id:t,name:name,attr:i.attr,nextSibling:i.nextSibling,previousSibling:i.previousSibling,parentNode:i.parentNode,firstChild:i.firstChild,lastChild:i.lastChild,select:i.select,children:i.children,updateAllFileds:function(e,t){var i,o,r=0;for(i=this.getAllFields(e)||[],r=0,o=i.length;r<o;r++){if("autoformula"==e)t=DocUtil.copyStyle(editor.doc.getRawFormatAt(i[r].getStart()));else if("autodate"==e){var n=DocUtil.copyStyle(editor.doc.getRawFormatAt(i[r].getStart()));n.val=t?t.val:(new Date).getTime(),n[ATTR_AUTOFIELD.ISAUTO]=0,i[r].attr(n);continue}i[r].attr(t)}},getAllFields:function(e){var t,i,o,r,n,a=[];for(t=this.getStart(),i=this.getEnd();t<i&&(t=editor.doc.findNextIndexOf(UNICODE.RANGE_START,t),!(t<0))&&(o=editor.doc.getRawFormatAt(t)||{},!(n<0));)n=DocUtil.getRangeEnd(t),o.ftype==e&&(r=editor.doc.createElement(NODE_TYPE.AUTOFIELD,{}),r.setStart(t),r.setEnd(n+1),a.push(r)),t=n;return a}}}function FloatElement(e,t,i,o,r,n,a,l,s){var d=new Element;if(!t){var c=Utils.randomString();t="zw"+c}return{getStart:d.getStart,getEnd:d.getEnd,setStart:d.setStart,setEnd:d.setEnd,type:e,sectionId:t,section:null,setContent:function(t){this.section=editor.doc.createSection(e,t,this.sectionId,i,o,r,n,a,l,s)},attr:d.attr,nextSibling:d.nextSibling,previousSibling:d.previousSibling,parentNode:d.parentNode,firstChild:function(){var e=editor.doc.findNextIndexOf(UNICODE.PARA+"|"+UNICODE.TABLE,this.section.getStart());if(editor.doc.getCharAt(e)==UNICODE.PARA){var t=editor.doc.createElement(NODE_TYPE.PARAGRAPH,{});t.setStart(e);var i=editor.doc.findNextIndexOf(UNICODE.PARA+"|"+UNICODE.TABLE+"|"+UNICODE.SECTION_START,t.getStart()+1);return i<0&&(i=editor.doc.getSectionEnd(e)),t.setEnd(i),t}var o=editor.doc.createElement(NODE_TYPE.TABLE,{});o.setStart(e);var r=TableUtil.getTableEnd(this.section.getStart());return o.setEnd(r),o},lastChild:d.lastChild,select:d.select,insert:function(t){if(e==NODE_TYPE.FOOTNOTE||e==NODE_TYPE.ENDNOTE){var i=editor.doc.createElement(NODE_TYPE.TEXT,"#"),o=editor.doc.getSelection().getStart(),r=DocUtil.getTextStyle(o),n=r[ATTR_TEXT.TS_SIZE];if(!n){var a=editor.doc.getParaStyles();n=a.h0[ATTR_TEXT.TS_SIZE]}var l={};l[ATTR_COMMON.TYPE]="text",l[ATTR_TEXT.CLS]=e,l[ATTR_TEXT.TS_SIZE]=n,l[ATTR_COMMON.ID]=this.sectionId,i.css=l;var s={char:UNICODE.RANGE_START,style:{type:e,id:this.sectionId}},c={char:UNICODE.RANGE_END,style:{type:e,id:this.sectionId}};editor.doc.getSelection().surroundAndInsert(s,c,i)}else{var p=editor.doc.getSelection().getStart(),u=editor.doc.getSelection().getEnd(),f={sid:this.sectionId};d.isInserted=!0,this.setStart(p),this.setEnd(u),this.attr(f)}this.section.insert(t)},modify:function(e){if(this.type==NODE_TYPE.FOOTNOTE||this.type==NODE_TYPE.ENDNOTE){var t=this.getStart(),i=this.getEnd(),o=this.section.getStart()-i,r=editor.doc.getContent(t+1,i-1).length,n=d.getStyleOp({type:e}),a=d.getStyleOp({type:e}),l=d.getStyleOp({cls:e,type:"text"}),s=d.getStyleOp({st:e,type:"section"});msg=[{r:t},n.as_start,{r:1},n.as_end,l.as_start,{r:r},l.as_end,a.as_start,{r:1},a.as_end,{r:o},s.as_start,{r:1},s.as_end],Op.processMsg(msg)}},children:d.children,remove:function(){var e;this.section.secId;this.section.remove();var t=this.getStart(),i=this.getEnd();if("endnote"==this.type||"footnote"==this.type){var o=editor.doc.createElement(NODE_TYPE.TEXT);o.setStart(this.getStart()+1),o.setEnd(this.getEnd()-1),o.remove(),editor.doc.getTrackChangeDetails().setProcessingContentDeletion(!0)}var r=editor.doc.getContent(t,t+1),n=editor.doc.getContent(i-1,i);e=[{r:t},{ds:r},{r:i-t-2},{ds:n}],Op.processMsg(e),"endnote"!=this.type&&"footnote"!=this.type||editor.doc.getTrackChangeDetails().setProcessingContentDeletion(!1)}}}function placeholderElement(e,t){var i=new Element;return t||(t=Utils.randomString()),{getStart:i.getStart,getEnd:i.getEnd,setStart:i.setStart,setEnd:i.setEnd,type:e,id:t,name:name,attr:i.attr,nextSibling:i.nextSibling,previousSibling:i.previousSibling,parentNode:i.parentNode,firstChild:i.firstChild,lastChild:i.lastChild,select:i.select,children:i.children}}function Op(){}function loadDocument(e){var t={};t.content=e,t.info=editor.doc.getDocInfo(),editor.loadDocument(t)}function applyOps(e){var t,i,o=eval,r=console;for(var n in e)r.log("OP:::",t=o(e[n].op)),i=DocOpBuilder.build(t),editor.doc.snapShotManager&&editor.doc.snapShotManager.setSkipSnapShot(!0),i.applyTo(),editor.doc.snapShotManager&&editor.doc.snapShotManager.setSkipSnapShot(!1)}function MsgQueue(){var e=new Array(2);return{add:function(t){var i=DocOpBuilder.clone(t),o=t.docOpId,r=[];if(!i)return void Utils.log("Empty Edits",i);if(e[1]){i=DocOpBuilder.compose(e[1],i),i=DocOpBuilder.concise(i);try{r=e[1].docOpIds?e[1].docOpIds:[],r.push(o),i.docOpIds=r}catch(e){}}else i.docOpIds=[o];e[1]=i},getAckPendingEdit:function(){return e[0]},getPendingToPushEdit:function(){return e[1]},isAckPending:function(){return!!e[0]},ackReceived:function(){e[0]=void 0,ZWCollaboration.mutationResendCount=0},msgQueueInitialize:function(t){for(i=0;i<2;i++)void 0===t[i]?e[i]=void 0:e[i]=DocOpBuilder.build(JSON.parse(t[i]))},msgQueueSwap:function(){void 0===e[0]&&void 0!==e[1]&&(this.shift(),ZWOffline.docObject=ZWOffline.constructDocObject(),ZWOffline.updateDocFromEditorToDB(ZWOffline.RID,ZWOffline.docObject))},shift:function(){var t=e[1];return e[0]=t,e[1]=void 0,e[0]},xform:function(t){if(t.isLock)return this.xformLock(t);var i=t;i=DocOpBuilder.concise(i);for(var o=0;o<e.length;o++)if(e[o]){var r=DocOpBuilder.xform(e[o],i);e[o]=r.first,i=r.second,i=DocOpBuilder.concise(i)}return DocOpBuilder.concise(i)},xformLock:function(t){var i,o,r=e.length;for(o=0;o<r;o++)try{e[o]&&(i=DocOpBuilder.xform(t,e[o]),e[o]=DocOpBuilder.concise(i.second),t=DocOpBuilder.concise(i.first))}catch(e){throw e}return t},isEmpty:function(){return!e[0]&&!e[1]},empty:function(){e[0]=e[1]=void 0},toString:function(){return"["+(e[0]?e[0].toString():"null")+"],["+(e[1]?e[1].toString():"null")+"]"}}}function Replace(){}function Nav(){}function Indentation(){}function Debugger(){}function WebUtil(){}function Scale(e){this.id=e.id||"scale"+(Math.random().toString(36).substr(2)+Date.now()),this.unit=e.unit||RULER_UNITS.INCH,this.type=e.type||SCALE_TYPE.REGULAR,this.orientation=e.orientation||ORIENTATION.HORIZONTAL,this.unitProps=e.unitProps||UNIT_PROPS,this.width=e.width||"100%",this.height=e.height||"100%",this.zoomFactor=e.zoomFactor||1,this.maxWidth=e.maxWidth,this.maxHeight=e.maxHeight,this.viewProps=e.viewProps||{},this.view=new ScaleView(this)}function ScaleView(e){this.scale=e,this.scaleContainer=document.createElement("div"),this.scaleContainer.id=this.scale.id,this.updateWidth(),this.updateHeight(),this.styleTag=document.createElement("style"),this.styleTag.type="text/css",this.contructScale(),this.scale.viewProps.parent&&this.attach()}function RulerCustomObject(e){this.id=e.id||"",this.width=e.width||"100%",this.height=e.height||"100%",this.classStr=e.classStr||"",this.createContent(),e.parent&&this.attachTo(e.parent)}function RulerElement(e){this.id=e.id||"element"+(Math.random().toString(36).substr(2)+Date.now()),this.ruler=e.rulerInstance,this.orientation=e.orientation||ORIENTATION.HORIZONTAL,this.priority=e.priority||1,this.align=e.align||ALIGN.FRONT,this.zoomFactor=e.zoomFactor||1,this.shouldHandleEvent=e.shouldHandleEvent||!1,this.eventProps=e.eventProps||{},this.isDraggable=e.isDraggable||!1,this.hideOutOfDragRect=e.hideOutOfDragRect||!1,this.dragRect=e.dragRect||{},this.actualValue=e.actualValue,this.resizableOption=e.resizableOption||RESIZABLE_TYPE.NONE,this.resizeMarginRatio=e.resizeMarginRatio||0,this.updateOnMouseMove=e.updateOnMouseMove||!1,this.title=e.title||"",this.computationFactor=e.computationFactor||PROCESSING_TYPE.REGULAR,this.setWidth(e.width),this.setHeight(e.height);var t=this.orientation===ORIENTATION.HORIZONTAL?this.width:this.height;this.setMinSize(e.minSize||t),this.setMaxSize(e.maxSize||t),this.setOffset(e.offset),this.viewProps=e.viewProps||{},this.view=new RulerElementView(this)}function TableResizeElement(e){RulerElement.call(this,e),this.view.getWidth=function(){return this.element.widthInPx},this.view.getHeight=function(){return this.element.heightInPx},this.view.getOffset=function(){var e=this.element.offset.top,t=this.element.offset.left,i=RulerUtil.getDeltaRelativeToAlignment(this.element.sizeInPx,this.element.align);return this.element.orientation==ORIENTATION.HORIZONTAL?(t*=this.element.zoomFactor,t-=i.start):(e*=this.element.zoomFactor,e-=i.start),{left:t,top:e}}}function TabPointElement(e){RulerElement.call(this,e),this.view.getWidth=function(){return this.element.widthInPx},this.view.getHeight=function(){return this.element.heightInPx},this.view.getOffset=function(){var e=this.element.offset.top,t=this.element.offset.left,i=RulerUtil.getDeltaRelativeToAlignment(this.element.sizeInPx,this.element.align);return this.element.orientation==ORIENTATION.HORIZONTAL?(t*=this.element.zoomFactor,t-=i.start):(e*=this.element.zoomFactor,e-=i.start),{left:t,top:e}}}function IndentElement(e){RulerElement.call(this,e),this.view.getWidth=function(){return this.element.widthInPx},this.view.getHeight=function(){return this.element.heightInPx},this.view.getOffset=function(){var e=this.element.offset.top,t=this.element.offset.left,i=RulerUtil.getDeltaRelativeToAlignment(this.element.sizeInPx,this.element.align);return this.element.orientation==ORIENTATION.HORIZONTAL?(t*=this.element.zoomFactor,t-=i.start):(e*=this.element.zoomFactor,e-=i.start),{left:t,top:e}}}function RulerElementView(e){this.element=e,this.elementNode=document.createElement("div"),this.elementNode.style.position="absolute",this.elementNode.id=this.element.id}function RulerEvtHandler(e){this.ruler=e,this.eventNode=document.createElement("div"),this.lineNode=document.createElement("div"),this.eventNode.className="ui-event-div unselectable ",this.lineNode.className="ui-line-div",this.ruler.container.appendChild(this.eventNode),this.ruler.container.appendChild(this.lineNode),this.ruler.viewProps.context&&this.eventNode.setAttribute("context",this.ruler.viewProps.context),this.mouseDownHandler=this.mouseDownHandler.bind(this),this.mouseUpHandler=this.mouseUpHandler.bind(this),this.mouseMoveHandler=this.mouseMoveHandler.bind(this),this.mouseOutHandler=this.mouseOutHandler.bind(this),this.bindEvents()}function Ruler(e){this.id=e.id||"ruler"+(Math.random().toString(36).substr(2)+Date.now()),this.unit=e.unit||RULER_UNITS.INCH,this.direction=e.direction||DIRECTION.LEFT_TO_RIGHT,this.orientation=e.orientation||ORIENTATION.HORIZONTAL,this.setWidth(e.width),this.setHeight(e.height),this.setZoomFactor(e.zoomFactor),this.viewProps=e.viewProps||{},this.view=new RulerView(this),this.updateRect(),this.setInteractable(e.isInteractable),this.elements={}}function RulerView(e){this.ruler=e,this.ruler.container=document.createElement("div"),this.ruler.container.id=this.ruler.id,this.ruler.container.className=this.ruler.viewProps.classStr||"",this.updateWidth(),this.updateHeight(),this.ruler.viewProps.parent&&this.attach()}function ZWRuler(e){Ruler.call(this,e),this.setRoundingFactor(),this.layoutProps={},this.computedMargins={},this.computedColProps={columnArea:[],columnSpace:[]},this.affectedElements={},this.setRulerLayoutProps(e.layoutProps),this.createScales()}function BookmarkDialog(){}function CollabPanelHandler(){}function DocRoll(){}function Imagelibrary(){this.newattr={}}function InsertSpl(){}function PageLayoutPanel(){this.PaperSize="Letter",this.attr={},this.newattr={},this.pgLayoutJson={a4:{inches:'(8.27" X 11.69")',mm:"(209.9 mm X 297 mm )"},letter:{inches:'(8.5" X 11")',mm:"(215.9 mm X 279.4 mm )"},legal:{inches:'(8.5" X 14")',mm:"(215.9 mm X 355.6 mm )"},executive:{inches:'(7.25" X 10.5")',mm:"(184.15 mm X 266.7 mm )"},envelope:{inches:'(4.13" X 9.5")',mm:"(104.9 mm X 241.3 mm )"},tabloid:{inches:'(11" X 17")',mm:"(279.4 mm X 431.8 mm )"},statement:{inches:'(5.5" X 8.5")',mm:"(139.7 mm X 215.9 mm )"},folio:{inches:'(8" X 13")',mm:"(203.2 mm X 330.2 mm )"},a3:{inches:'(11.69" X 16.54")',mm:"(296.9 mm X 420.1 mm )"},a5:{inches:'(5.83" X 8.27")',mm:"(148 mm X 210 mm )"},b4:{inches:'(10.12" X 14.33")',mm:"(257 mm X  363.9 mm )"},b5:{inches:'(7.17" X 10.12")',mm:"(182.1 mm X  257 mm )"}},this.marginsJson={normal:{top:{inches:"1.00in",mm:"25.4mm"},left:{inches:"1.00in",mm:"25.4mm"},bottom:{inches:"1.00in",mm:"25.4mm"},right:{inches:"1.00in",mm:"25.4mm"}},narrow:{top:{inches:"0.50in",mm:"12.7mm"},left:{inches:"0.50in",mm:"12.7mm"},bottom:{inches:"0.50in",mm:"12.7mm"},right:{inches:"0.50in",mm:"12.7mm"}},wide:{top:{inches:"1.00in",mm:"25.4mm"},left:{inches:"2.28in",mm:"57.9mm"},bottom:{inches:"1.00in",mm:"25.4mm"},right:{inches:"2.28in",mm:"57.9mm"}},moderate:{top:{inches:"1.00in",mm:"25.4mm"},left:{inches:"0.75in",mm:"19.0mm"},bottom:{inches:"1.00in",mm:"25.4mm"},right:{inches:"0.75in",mm:"19.0mm"}},custom:{top:{inches:"1.50in",mm:"38.1mm"},left:{inches:"1.00in",mm:"25.4mm"},bottom:{inches:"1.00in",mm:"25.4mm"},right:{inches:"1.00in",mm:"25.4mm"}}};var e=["SHAREDREAD","SHAREDREADCOMMENT","ANYONELINK_SHAREDREADCOMMENT"];U.contains(e,editor.doc.getRole())||PubSub.subscribe("Document/margin/changed",this.updatePanel)}function ReplaceDialog(){}function Settings(){}function ShowInfo(){}function ParagraphPanel(){}function TableMenu(){}function ColumnDlg(){this.attr={},this.newattr={}}function GoToDialogue(){}function carousel(){}!function(e){"use strict";var t=Array.prototype.forEach,i=Array.prototype.push,o=(Array.prototype.slice,{NONE:0,DOWN:1,UP:2});PubSub.subscribe("ZWRange/ClearSelection",function(e,t){var i=e.collaborator?"":".cursor";J("#z-cursor-start-"+e.SID+i).add("#z-cursor-end-"+e.SID+i).remove();for(var o=(t||editor.jeditorPane[0]).getElementsByClassName("overlay"),r=o.length-1;r>=0;r--){var n=J(o[r]),a=n.data().range;a&&a.SID===e.SID&&a.id==e.id&&n.remove()}});var r=editor.doc,n=new ZWLogger,a=function(e,t,i){e=e||1,t=t||e,ZRange.call(this,Math.min(e,t),Math.max(e,t)),this.id="RNG_"+("x"+Math.random()).replace(/\D/g,""),this._={focus:1,isContentPaneSelected:!1,isFooterActvied:void 0,isHeaderActived:void 0,isMultipleTablesSelected:!1,isPartialTableSelected:!1,isPartialTableSelectedFromBottom:!1,isPartialTableSelectedFromTop:!1,isSelectionWithinTable:!1,scrollDirection:o.NONE,SID:i||editor.uuid,selectedCells:[],type:a.TYPE.SELECTION,isColumnSelection:!1,isRowSelection:!1,isSelectionRedrawing:!1};var r={},n=this;Object.defineProperties(this._,{userData:{get:function(){return J.isEmptyObject(r)&&extend(r,X(n.SID)||{})||r},set:function(){r={}}}})};a.prototype=Object.create(ZRange.prototype),a.prototype.constructor=a,Object.defineProperties(a.prototype,{collaborator:{get:function(){return this.SID!==editor.uuid}},collapsed:{get:function(){return this.start===this.end}},color:{get:function(){return this.type===a.TYPE.COMMENT?"#1477FF":this.type===a.TYPE.SPELLCHECK?"transparent":this.collaborator&&this._.userData.color||""}},endChar:{get:function(){return r.getCharAt(this.end)}},length:{get:function(){return this.end-this.start}},SID:{get:function(){return this._.SID},set:function(e){e!==this._.SID&&(this._.userData={},this._.SID=e)}},startChar:{get:function(){return r.getCharAt(this.start)}},stringify:{get:function(){return JSON.stringify(r.getContent(this.start,this.end))}},type:{get:function(){return this._.type},set:function(e){this._.type=e}},ZUID:{get:function(){return this._.userData.zuid},set:function(e){this._.userData.zuid=e}}}),a.prototype.addSubscriber=function(){return this.collapsed||PubSub.subscribe(["paraview/create","cellview/create"],this.drawSelection,{context:this}),this},a.prototype.cloneRange=function(e){return r.createRange(this.start,this.end,e||this.SID)},a.prototype.createOp=function(e){var t={type:"cursor",zuid:e||editor.zuid},i=Utils.randomString();return[{r:this.start},{as:{start:t,id:i}},{r:this.length},{as:{end:DocUtil.getKeys(t),id:i}}]},a.prototype.drawSelection=function(e){if(this.collapsed||this.collaborator||!editor.isEditable())return this.removeSubscriber();var t=this.getCells(),i=e.getIndex(),o=e.getEndIndex();if("para"===e.type)if(t.length)for(var n,a,l,s=0,d=t.length;s<d;s++)a=t[s].getIndex(),l=t[s].getEndIndex(),n=r.createRange(a,l),r.createRange(i,o).isIntersectWithRange(n)&&_(this,i,o);else{if(!this.isIntersectWithRange(r.createRange(i,o))||this.end===i)return this;_(this,i,o)}else if("cell"===e.type){var c,p;if(!t.length){if(!this.isIntersectWithRange(r.createRange(i,o)))return this;if(c=ViewManager.getViews(e)||[],p=c[0],!p)return this;B(this,p)}for(var n,a,l,s=0,d=t.length;s<d;s++)if(a=t[s].getIndex(),l=t[s].getEndIndex(),n=r.createRange(a,l),i==a&&o==l){c=ViewManager.getViews(e)||[];for(var u=0,f=c.length;u<f;u++)p=c[u],p&&B(this,p)}}return this},a.prototype.getCells=function(){var e=[],t=z(this.start);if(!t)return e;var i=z(this.end);if(!i)return e;var o=t.getMatrixPosition(),r=i.getMatrixPosition(),n=Math.min(o[0],r[0]),a=Math.max(o[0],r[0]),l=Math.min(o[1],r[1]),s=Math.max(o[1],r[1]),d=t.parent.parent,c=Y(this.start);return 0===n&&0===l&&a===d.children.length-1&&s===c.children.length-1?(U.each(d.children,function(t){e=U.union(e,t.children)}),e):V(d,{top:n,left:l,bottom:a,right:s,cells:[]})},a.prototype.getContent=function(){return r.getContent(this.start,this.end)},a.prototype.getEndPortionData=function(e){return r.getPortionData(this.end,e||editor.getPageID())},a.prototype.getEndPortionNode=function(e){var t=this.getEndPortionData(e);return t&&t.node||void 0},a.prototype.getNodes=function(e){var t=[],i=r.getSelection(this.SID);if(i.isTableSelected())return U.each(i.getSelectedCells(),function(i){for(var o=i.children(),n=0,a=o.length;n<a;n++){var l=o[n];if(e==NODE_TYPE.TEXT){var s=l.getEnd(),d=r.getNodesInSelection(e,l.getStart(),s);t=t.concat(d)}else e==NODE_TYPE.PARAGRAPH&&t.push(l)}}),t;var o=this.start,n=this.end;if(this.isMultipleTablesSelected()){var a=o,l=n,s=this.getSelectedDocCells(),d=[];return U.each(s[0],function(i){for(var o=i.children(),n=0,l=o.length;n<l;n++){var s=o[n];if(e==NODE_TYPE.TEXT){var d=s.getEnd(),c=r.getNodesInSelection(e,s.getStart(),d);t=t.concat(c)}else e==NODE_TYPE.PARAGRAPH&&t.push(s)}i.getEnd()>a&&(a=i.getEnd())}),U.each(s[1],function(t){for(var i=t.children(),o=0,n=i.length;o<n;o++){var a=i[o];if(e==NODE_TYPE.TEXT){var s=a.getEnd(),c=r.getNodesInSelection(e,a.getStart(),s);d=d.concat(c)}else e==NODE_TYPE.PARAGRAPH&&d.push(a)}t.getStart()<l&&(l=t.getStart())}),t=t.concat(r.getNodesInSelection(e,a+1,l-3)),t=t.concat(d)}if(this.isPartialTableSelected()){var a=o,l=n;if(U.each(this.getSelectedDocCells(),function(i){for(var o=i.children(),n=0,s=o.length;n<s;n++){var d=o[n];if(e==NODE_TYPE.TEXT){var c=d.getEnd(),p=r.getNodesInSelection(e,d.getStart(),c);t=t.concat(p)}else e==NODE_TYPE.PARAGRAPH&&t.push(d)}i.getStart()<l&&(l=i.getStart()),i.getEnd()>a&&(a=i.getEnd())}),o<l&&l<n){var c=r.getNodesInSelection(e,o,l-3);t=c.concat(t)}else t=t.concat(r.getNodesInSelection(e,a+1,n));return t}return r.getNodesInSelection(e,o,n)},a.prototype.getSelectedOps=function(){var e=this.start<this.end?this.getContent():"";if(!e||0===e.length)return{};var t=0,i=e.length,o=t,n="",a=[],l={r:this.start};a.push(l);for(var s,d,c=DocUtil.getTextStyle(this.start),p=t,u=Utils.randomString();p<i;p++)if(d=r.getRawFormatAt(this.start+p)){if(n){l={as:{start:n,id:u}},a.push(l),a.push({is:e.substring(o,p)});var f=DocUtil.getKeys(n);a.push({as:{end:f,id:u}}),u=Utils.randomString()}else if(s=e.substring(o,p),s.length)if(J.isEmptyObject(c))a.push({is:s});else{l={as:{start:c,id:u}},a.push(l),a.push({is:s});var f=DocUtil.getKeys(c);a.push({as:{end:f,id:u}}),u=Utils.randomString(),c={}}o=p,n=W(p+this.start,a)}if(s=e.substring(o,i),!s.length)return a;if(n){l={as:{start:n,id:u}},a.push(l),a.push({is:e.substring(o,p)});var f=DocUtil.getKeys(n);a.push({as:{end:f,id:u}}),u=Utils.randomString()}else if(0==o){l={as:{start:c,id:u}},a.push(l),a.push({is:s});var f=DocUtil.getKeys(c);a.push({as:{end:f,id:u}}),c={}}else a.push({is:s});return a},a.prototype.getStartPortionData=function(e){return r.getPortionData(this.start,e||editor.getPageID())},a.prototype.getStartPortionNode=function(e){var t=this.getStartPortionData(e);return t&&t.node||void 0},a.prototype.isIntersectWithRange=function(e){return this.start<=e.end&&this.end>=e.start},a.prototype.isMultipleTablesSelected=function(){return this._.isMultipleTablesSelected},a.prototype.isPartialTableSelected=function(){return this._.isPartialTableSelected},a.prototype.isSameRange=function(e){return e&&e.SID===this.SID&&e.start===this.start&&e.end===this.end},a.prototype.isTableSelected=function(){return this._.isSelectionWithinTable||this._.isPartialTableSelected||this._.isPartialTableSelectedFromTop||this._.isPartialTableSelectedFromBottom||this._.isMultipleTablesSelected},a.prototype.offset=function(){return{start:this.start,end:this.end}},a.prototype.remove=function(){var e=r.getSelection(this.SID);return!this.collaborator&&e.isTextDrag?this:(this.removeSubscriber(),y(this),this.collapsed&&(this._.isHeaderActived?(oe(this,"header/changed",50),this._.isHeaderActived=!1):this._.isFooterActvied&&(oe(this,"footer/changed",50),this._.isFooterActvied=!1)),this)},a.prototype.removeSubscriber=function(){return PubSub.unsubscribe(["paraview/create","cellview/create"],this.drawSelection,{context:this}),this};var l;a.prototype.select=function(){if(!A(this))return this;var e,t=ViewManager.getColumnAtIndex(this.end);if(null!=t?(e=t.content.page,editor.currentColumnIndex=ViewManager.getColumnIndex(t)):(e=ViewManager.getPageWithId(editor.getPageID())||ViewManager.pages.first,editor.currentColumnIndex=0),e){var i=e.pageNumber;!this.collaborator&&this._.focus&&(editor.currentPageIndex=i-1),e.isPageRendered||(editor.visiblePageNumbers.push(i),e.forceToRender()),e.content&&e.content.el&&(e.content.el.style.display="block")}var o=this;if(this.collapsed){var n=r.getDomCursorNode(this.SID,this.ZUID,"start")||J(CurUtil.createCursor("start",this.SID));if(!n||!n[0])return this;this.collaborator&&n.removeClass("otherUserCursorStart").removeClass("otherUserCursorEnd").addClass("otherUserCollapsedCursor"),de(this,n),clearTimeout(l),this.collaborator||(l=setTimeout(function(){!editor.isEditable()||EventHandler.isMenuOpened||EventHandler.isDialogOpened||InsertShape.selectedShape()||J(r.getDomCursorNode(o.SID,o.ZUID,"start")).addClass("blink")},500))}else!this.collaborator&&setTimeout(function(){J(r.getDomCursorNode(o.SID,o.ZUID,"start")).css("visibility","hidden")},300),ce(this);return oe(this,this.collapsed?"Cursor/Collapsed":"Cursor/Selected"),this},a.prototype.selectCells=function(e){return B(this,e)},a.prototype.getSelectedDocCells=function(){return C(this._.selectedCells)},a.prototype.setEnd=function(e){return e=e>0?e:1,this.end=e,this.end<this.start&&(this.end=this.start,this.start=e),this},a.prototype.setFocus=function(e){return this._.focus=e?1:0,this},a.prototype.setStart=function(e){return e=e>0?e:1,this.start=e,this.end||(this.end=e),this},a.prototype.toCursorOp=function(){return{si:this.start,ei:this.end}},a.prototype.toDocOpBuilder=function(){var e=new DocOpBuilder,t=new DocOp,i={type:"cursor"},o=Utils.randomString();return t.skipChars(this.start),e.docOps.push(t),t=new DocOp,t.changeStyles([],i,o),e.docOps.push(t),t=new DocOp,t.skipChars(this.length),e.docOps.push(t),t=new DocOp,t.changeStyles(Object.keys(i),[],o),e.docOps.push(t),e},a.prototype.toString=function(){var e=this.getContent(),t=RegExp(UNICODE.PARA+"|"+UNICODE.TAB+"|"+UNICODE.BR+"|"+UNICODE.SECTION_START+"|"+UNICODE.TABLE+"|"+UNICODE.TABLEEND+"|"+UNICODE.ROW+"|"+UNICODE.CELL,"g");return e=e.replace(t,"")},a.prototype.visitAllNodesInRange=function(e){for(var t,i=this,o=i.start,n=(i.end,r.getSelection()),a=DocTreeManager.getTreeNodeAtIndex(o),l=a,s=[];v(l,i);)if(t=l,(n.isTableSelected()||i.isTableSelected())&&l.type===NODE_TYPE.CELL){if(m(l,i,s,e),l=l.next,!l){var d=t.parent;d&&d.next?(f(s,d,e),l=d.next):(f(s,d.parent,e),l=d.parent.next)}}else{if(!(l.type!==NODE_TYPE.CELL&&l.type!==NODE_TYPE.ROW&&l.type!==NODE_TYPE.TABLE||n.isTableSelected()||i.isTableSelected()||h(l,i)))break;if("para"===l.type){if(O(l,i,s,e),l=l.next,!l){if("section"==t.parent.type)break;var c=t.parent;c&&c.next?(f(s,c,e),l=c.next):c.parent&&c.parent.next?(f(s,c.parent,e),l=c.parent.next):(f(s,c.parent.parent,e),l=c.parent.parent.next)}}else l.type==NODE_TYPE.ROW?(E(l,i,s,e),l=l.next,l||(f(s,t.parent,e),l=t.parent&&t.parent.next)):l.type===NODE_TYPE.TABLE?(T(l,i,s,e),l=l.next):l.type===NODE_TYPE.TOC?(g(l,i,s,e),l=l.next):(p(e,l),u(e,l),l=l.next)}if(s.length)for(var R;s.length;)R=s.pop(),u(e,R);return this},a.enableLogger=function(e){n.enable(e)},a.disableLogger=function(){n.disable()},Object.defineProperties(a.TYPE={},{SELECTION:defineWithValue(1),COMMENT:defineWithValue(2),SPELLCHECK:defineWithValue(3),FIND:defineWithValue(4),HISTORY_HIGHLIGHT:defineWithValue(5)}),e.ZWRange=a;var s,d,c,p=function(e,t){t&&e&&"function"==typeof e.nodeStartHandler&&e.nodeStartHandler.call(null,t)},u=function(e,t){t&&e&&"function"==typeof e.nodeEndHandler&&e.nodeEndHandler.call(null,t)},f=function(e,t,i){if(t&&e.length&&e.slice(-1)&&e.slice(-1)[0]===t){var o=e.pop();u(i,o)}},g=function(e,t,i,o){if(e){p(o,e);for(var r,n=e.children||{},a=0,l=n.length;a<l;a++)r=n[a],O(r,t,i,o);u(o,e)}},m=function(e,t,i,o){if(e&&e&&S(e,t)){for(var r,n=e.children||{},a=0;a<n.length;a++)r=n[a],v(r,t)&&("para"==r.type?O(r,t,i,o):r.type===NODE_TYPE.TABLE?T(r,t,i,o):r.type===NODE_TYPE.TOC?g(r,t,i,o):(p(o,r),u(o,r)));f(i,e,o)}},h=function(e,t){return!(!e||e.type!=NODE_TYPE.TABLE)&&(e.getIndex()>=t.start&&e.getEndIndex()<=t.end)},T=function(e,t,i,o){if(e){for(var r,n=e.children||{},a=0,l=n.length;a<l;a++)r=n[a],E(r,t,i,o);f(i,e,o)}},E=function(e,t,i,o){if(e){for(var r,n=e.children||{},a=0,l=n.length;a<l;a++)r=n[a],m(r,t,i,o);f(i,e,o)}},R=function(e,t){return!!e&&e.getEndIndex()+1<=t.end},S=function(e,t){if(!e||e.type!==NODE_TYPE.CELL)return!1;for(var i,o=t.getSelectedDocCells(),r=0,n=o.length;r<n;r++)if(i=o[r],Array.isArray(i)){for(var a,l=0;l<i.length;l++)if(a=i[l],a.dtNode===e)return!0}else if(i.dtNode===e)return!0;return!(e.parent.parent.parent.type!==NODE_TYPE.CELL||!S(e.parent.parent.parent,t))||!!h(e.parent.parent,t)},O=function(e,t,i,o){if(e){var n,a,l,s=r.getSelection(),d=e.children,s=r.getSelection();e.parent.type===NODE_TYPE.CELL&&(s.isTableSelected()||t.isTableSelected()||h(e.parent.parent.parent,t))&&(l=e.parent,a=l.parent,n=a.parent,S(l,t)&&(U.contains(i,n)||(p(o,n),i.push(n)),U.contains(i,a)||(p(o,a),i.push(a)),U.contains(i,l)||(p(o,l),i.push(l)))),R(e,t)&&(p(o,e),i.push(e));for(var c,u,g=0,m=d.length;g<m;g++)c=d[g],v(c,t)&&(c.getIndex()<t.start&&c.getEndIndex()>=t.end?(u=new DTNode.types[NODE_TYPE.RUN](Math.abs(t.start-e.getIndex()),Math.abs(t.end-e.getIndex()),e),p(o,u)):c.getIndex()<t.start?(u=new DTNode.types[NODE_TYPE.RUN](Math.abs(t.start-e.getIndex()),Math.abs(c.getEndIndex()-e.getIndex()+1),e),p(o,u)):c.getEndIndex()>=t.end?(u=new DTNode.types[NODE_TYPE.RUN](Math.abs(c.getIndex()-e.getIndex()),Math.abs(t.end-e.getIndex()),e),p(o,u)):p(o,c));f(i,e,o)}},v=function(e,t){if(!e)return!1;var i=t.start,o=t.end,r=e.getIndex(),n=e.getEndIndex();return r<o&&i<=n},b=function(e,t){if(!e)return!1;var i=t.start,o=t.end,r=e.start,n=e.end;return r<o&&i<=n},A=function(e){if(e.start){var t;if(!(t=DocTreeManager.lineAtIndex(e.start)))return Utils.log("!!CAN'T SELECT!! There is no line for start"+e.start),n.warn("@addRange: There is no line for start",e.start),!1;if(!e.collapsed&&e.end&&!(t=DocTreeManager.lineAtIndex(e.end)))return Utils.log("!!CAN'T SELECT!! There is no line for end"+e.end),n.warn("@addRange: There is no line for end",e.end),!1}return!0},y=function(e){PubSub.publish("ZWRange/ClearSelection",e),e._.isContentPaneSelected=e._.isMultipleTablesSelected=e._.isPartialTableSelected=e._.isPartialTableSelectedFromBottom=e._.isPartialTableSelectedFromTop=e._.isSelectionWithinTable=!1,e._.selectedCells=[];var t=r.getSelection(e.SID);t.setIsTableSelected(!1),t.setSelectedCells([]),t.setStartCell(null),t.setEndCell(null),t.setSelectedTable(null)},D=function(e,t){if(e&&t){var i=e.parentNode,o=t.parentNode;J(e).remove(),J(t).remove(),i&&i.normalize(),i!=o&&o&&o.normalize()}},C=function(e){var t,i=[];return U.each(e,function(e){U.isArray(e)?i.push(C(e)):(t=r.createElement(NODE_TYPE.CELL,e),t.setStart(e.getIndex()),t.setEnd(e.getEndIndex()+1),i.push(t))}),i},I=function(e,t,i){if(t&&t.el&&t.el.parentNode){var o=t.width;o<0?(t.left+=o,o=Math.abs(o)):0===o&&r.getContent(t.start,t.end)===UNICODE.BR&&(o=10),i||PubSub.publish("ZWRange/ClearSelection",e,t.el);var n=j(e,t.start),a=0,l=t.style[ATTR_COMMON.BORDERS]&&t.style[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_LEFT]&&parseFloat(t.style[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_LEFT][ATTR_BORDERS.SPACE])||0,s=t.left+l,d=t.height+parseFloat(J(t.el).css("padding-top")||0)+parseFloat(J(t.el).css("padding-bottom")||0);J(n).appendTo(t.el).css({width:o,height:d,top:a,left:s})}},P=function(e,t,i,o,r){var n=j(e,o,r);J(n).appendTo(t).css({width:i.width,height:i.height,top:i.top||0,left:i.left||0})},_=function(e,o,n){o=o||e.start,n=n||e.end;var a=DocTreeManager.getNodesToDrawSelection(o,n)||[],l=a.length;if(l){var s,d;editor.getPageID();if(e._.isMultipleTablesSelected){for(e._.selectedCells=[[],[]],d=0;d<l&&(s=a[d],"row"==s.type);d++)i.apply(e._.selectedCells[0],s.children);for(d=l-1;d>=0&&(s=a[d],"row"==s.type);d--)i.apply(e._.selectedCells[1],s.children)}else if(e._.isPartialTableSelectedFromTop)for(d=0;d<l&&(s=a[d],"row"==s.type);d++)i.apply(e._.selectedCells,s.children);else if(e._.isPartialTableSelectedFromBottom)for(d=0;d<l;d++)s=a[d],"row"==s.type&&i.apply(e._.selectedCells,s.children);var c=DocTreeManager.lineAtIndex(n);if(c){c.prev&&q(n)&&n--;var p,u,f,g,m,h=!1,T=r.getSelection(e.SID),E=DocTreeManager.getLeftAtIndex(o),R=DocTreeManager.getLeftAtIndex(n),S=!1,O=!1,A=DocTreeManager.isEndNoteOrFootNoteSection(o,n),y=!1,D=o,C=n;if(A){var P,_=DocTreeManager.doc.getSection(o);"endnote"===_.name?P=NoteViewCollection.getEndNoteViewsBetween(o,n):"footnote"===_.name&&(P=NoteViewCollection.getFootNoteViewsBetween(o,n));editor.doc.createRange(o);y=v(P[0].node,editor.doc.createRange(o));var x;if(!y&&P.length>1){var F=a.length,x=a[0];a[0]=a[F-1],a[F-1]=x}}t.call(a,function(i,o){if("line"===i.type){c=i,c.left=c.left||0;var r=Q(c),n=parseFloat(c.style[ATTR_COMMON.BORDERS]&&c.style[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_LEFT]&&c.style[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_LEFT][ATTR_BORDERS.SPACE]||0);u=[],f={},S=!1,p=h=!1,m=c.parent.getParaStyles(),O=m&&m[ATTR_PARAGRAPH.PS_DIR]===PARA_DIR.RTL||!1;var a={line:c,startIndex:D,endIndex:C,startIdxLeft:E,endIdxLeft:R,isEOPWidthToBeAdded:r,dirRTL:O,paddingLeft:n,aRNG:e};if(T.isListItemSelection&&(c=DocTreeManager.getLines(i.parent.getIndex())[0]),c.start<=D&&C<=c.end)p=H(D,C),C!=c.parent.getEndIndex()+1&&(r=!1),p?w(e,c,D,C):(c.width=R-(c.left=E),O||(c.left-=n));else if(c.start<=D){g=U.clone(c);var s;A?b(c,e)&&(!y&&P.length>1?s=L(a):(s=N(a),h=!0)):(s=N(a),h=!0),s&&(S=s.isFirstBlockRTL,r=s.isEOPWidthToBeAdded)}else if(C<=c.end){var s;A?b(c,e)&&(!y&&P.length>1?(s=N(a),h=!0):s=L(a)):s=L(a),s&&(S=s.isFirstBlockRTL,r=s.isEOPWidthToBeAdded)}o<l-1&&(c.width=3==c.align&!c.lastLineInPara?c.width+c.remainingWidth+3:c.width,r&&(O&&(c.left-=CONST_VIEW.EOP_WIDTH),c.width+=CONST_VIEW.EOP_WIDTH,r=!1)),o>0&&o<l-1&&(c.width-=c.style.pr),r&&(O&&(c.left-=CONST_VIEW.EOP_WIDTH),c.width+=CONST_VIEW.EOP_WIDTH,r=!1),p||I(e,c,p),(O||S)&&h&&!T.isListItemSelection&&M(e,g)}else"row"===i.type&&t.call(i.children,function(i){t.call(ViewManager.getViews(i)||[],function(t){B(e,t)})})})}}},N=function(e){var t=e.line,i=e.startIndex,o=(e.endIndex,e.startIdxLeft),r=(e.endIdxLeft,e.isEOPWidthToBeAdded),n=e.dirRTL,a=e.paddingLeft,l=e.aRNG,s=H(i,t.end),d=DocTreeManager.getBlocksBetween(i,t.end),c=d&&d[0],p=c&&c.isRTL;return s?w(l,t,i,t.end):p?(r&&(t.left+=CONST_VIEW.EOP_WIDTH,t.width-=CONST_VIEW.EOP_WIDTH,r=!1),k(l,d,t,s)):n?(t.width-=o-t.left,t.left=o,r&&(t.left+=CONST_VIEW.EOP_WIDTH,t.width-=CONST_VIEW.EOP_WIDTH)):(t.width-=o-t.left-a,r&&(t.width+=CONST_VIEW.EOP_WIDTH,r=!1),t.left=o-a),{isFirstBlockRTL:p,isEOPWidthToBeAdded:r}},L=function(e){var t=e.line,i=(e.startIndex,e.endIndex),o=(e.startIdxLeft,e.endIdxLeft),r=e.isEOPWidthToBeAdded,n=e.dirRTL,a=e.paddingLeft,l=e.aRNG,s=H(t.start,i),d=DocTreeManager.getBlocksBetween(t.start,i),c=d&&d[0],p=c&&c.isRTL;return s?w(l,t,t.start,i):p?k(l,d,t,s):n?t.width=o-t.left:(t.width=o-t.left-a,i!=t.parent.getEndIndex()+1&&(r=!1)),{isFirstBlockRTL:p,isEOPWidthToBeAdded:r}},w=function(e,t,i,o){for(var r,n,a,l,s=t.parent,d=(s.getIndex(),!0),c=DocTreeManager.getBlocksBetween(i,o),p=[],u=[],f=c[0].isRTL,g=0,m=0,n=a=l=!1;m<c.length;m++)if(r=c[m],r.isRTL?(n=!0,p.push(r)):r.isNeutralChars?(l=c[m-1]&&c[m-1].isRTL&&r.isNeutralChars||!1,l?(n=!0,p.push(r)):(a=!0,u.push(r))):r.isNeutralChars||r.isRTL||(a=!0,u.push(r)),n&&a){f&&0==g?(k(e,p,t,d),g=1,p=[]):f||0!=g||(k(e,u,t,d),g=1,u=[]),p.length&&(F(e,p,t),p=[]),u.length&&(F(e,u,t),u=[]),n=a=f=!1}p.length&&(x(e,p,t),p=[]),u.length&&(x(e,u,t),u=[])},M=function(e,t){var i=J(t.el).find(".EOP").width()||0,o=t.parent.getParaStyles(),r=o&&o[ATTR_PARAGRAPH.PS_DIR]===PARA_DIR.RTL||!1;t.left=(r?t.left:t.width)-i,t.width=i,I(e,t,!0)},x=function(e,t,i){var o=i.parent&&i.parent.getIndex(),r=DocTreeManager.getLeftAtIndex(o+t[0].start),n=o+lastElementOf(t).end,a=n;a===i.end&&a--,e.end<a&&(a=e.end);var l=DocTreeManager.getLeftAtIndex(a);i.width=r-(i.left=l),I(e,i,!0)},F=function(e,t,i){var o=i.parent&&i.parent.getIndex(),r=DocTreeManager.getLeftAtIndex(o+t[0].start+1),n=o+lastElementOf(t).end,a=n;a===i.end&&a--,e.end<a&&(a=e.end);var l=DocTreeManager.getLeftAtIndex(a);i.width=r-(i.left=l),I(e,i,!0)},k=function(e,t,i,o){var r=i.parent&&i.parent.getIndex(),n=i.parent&&i.parent.getEndIndex(),a=r+t[0].start,l=a,s=r+lastElementOf(t).end,d=s;d!==i.end||!o&&d==n||d--,e.start>=a&&(l=e.start),e.end<d&&(d=e.end);var c=DocTreeManager.getLeftAtIndex(l),p=DocTreeManager.getLeftAtIndex(o?d-1:d);i.width=c-(i.left=p),o&&I(e,i,o)},B=function(e,t){var i=t.el;if(i&&i.parentNode){var o=t.node,r=t.getHeight()||i.offsetHeight,n=o.width+(o.cellPadding.left||0)+(o.cellPadding.right||0)||i.offsetWidth;if(!e._.isContentPaneSelected){var a=DocTreeManager.getNode(i);i=ViewManager.getViews(a)[0].el}PubSub.publish("ZWRange/ClearSelection",e,i);var l=J(i).find("div.zw-cell-container:first")[0]||void 0;return l&&P(e,l,{width:n||l.offsetWidth,height:r||l.offsetHeight},o.getIndex(),t.column?t.column.id:t.page.id),e}},H=function(e,t){for(var i,o,r,n,a=!1,l=DocTreeManager.getBlocksBetween(e,t),s=0,o=r=n=!1;s<l.length;s++){if(i=l[s],i.isRTL)o=!0;else if(i.isNeutralChars)if(0==s){var d=DocTreeManager.blockAtIndex(e-1);d&&d.isRTL?o=!0:r=!0}else n=l[s-1]&&l[s-1].isRTL&&i.isNeutralChars||!1,n?o=!0:r=!0;else i.isNeutralChars||i.isRTL||(r=!0);if(o&&r){a=!0;break}}return a},G=function(e,t){for(var i=e.length-1,o=t.length-1;i>=0&&o>=0&&e[i].id===t[o].id;)i--,o--;return e[i+1]},z=function(e){var t=editor.doc.getCharAt(e);return(t===UNICODE.CELL||t===UNICODE.ROW)&&e--,DocTreeManager.doc.getParents(NODE_TYPE.CELL,e)},V=function(e,t){for(var i,o,r,a,l,s=U.extend({},t),d=[],c=t.top;c<=t.bottom;c++)if(o=e.children[c])for(i=t.left;i<=t.right;i++)(r=o.children[i])&&(r[ATTR_CELL.TDS_MRG]&&(a=r.getRootMergeCell(),l=a.getMatrixPosition(),s.top=Math.min(s.top,l[0]),s.left=Math.min(s.left,l[1]),s.bottom=Math.max(s.bottom,l[0]+(a.rspan||1)-1),s.right=Math.max(s.right,l[1]+(a.cspan||1)-1)),d.push(r));return n.info([t.top,t.left],[t.bottom,t.right],[s.top,s.left],[s.bottom,s.right]),U.isEqual(s,t)?d:V(e,s)},Y=function(e){var t=editor.doc.getCharAt(e);return t===UNICODE.ROW&&e--,DocTreeManager.doc.getParents(NODE_TYPE.ROW,e)},W=function(e,t,i){var o={};o.type="text",o[ATTR_TEXT.TS_FW]="normal",o[ATTR_TEXT.TS_FS]="none",o[ATTR_TEXT.TS_TD]="none",o[ATTR_TEXT.TS_SIZE]="none",o[ATTR_TEXT.TS_FF]="none",o[ATTR_TEXT.TS_BGC]="none",o[ATTR_TEXT.TS_FGC]="none",o[ATTR_TEXT.TS_VA]="none",o[ATTR_TEXT.TS_FV]="none",o[ATTR_TEXT.TS_CS]="none";var n={};n.type="paragraph",n[ATTR_PARAGRAPH.PS_AL]="left",n[ATTR_PARAGRAPH.PS_DIR]="ltr",n[ATTR_PARAGRAPH.PS_HD]="",n[ATTR_PARAGRAPH.PS_ML]="",n[ATTR_PARAGRAPH.PS_LS]="",n[ATTR_PARAGRAPH.PS_TYPE]="list",n[ATTR_PARAGRAPH.PS_TS]="",n[ATTR_PARAGRAPH.LS_DATA]="",n[ATTR_PARAGRAPH.PS_SA]="",n[ATTR_PARAGRAPH.PS_SB]="",n[ATTR_PARAGRAPH.PS_BGC]="";var a,l,s={};if(!t||!t.styles)return l=r.getRawFormatAt(e),l?DocUtil.copyStyle(l):null;var d=t.styles.begin.type,c=!1;t.styles.begin[ATTR_TEXT.TS_NULL]&&(t.styles.begin=o,t.styles.begin[ATTR_TEXT.TS_NULL]=!0,c=!0),t.styles.begin[ATTR_PARAGRAPH.PS_NULL]&&(t.styles.begin=n,t.styles.begin[ATTR_PARAGRAPH.PS_NULL]=!0,c=!0),s.type=d;for(a in t.styles.begin){var p;if(a!=ATTR_TEXT.TS_NULL&&a!=ATTR_PARAGRAPH.PS_NULL&&"type"!=a){if("body"==d)p=r.getDefaultStyle(a);else{if(l=r.getRawFormatAt(e),l&&(p=l[a]),a==ATTR_PARAGRAPH.PS_TS){p||(p={});var u=t.styles.begin[ATTR_PARAGRAPH.PS_TS];for(var f in u)p[f]=p[f]?p[f]:""}p||(p="")}c&&(o[a]||n[a])&&delete t.styles.begin[a],p&&(s[a]=p)}}return s},j=function(e,t,i){var o="_"+e.id+"_"+t+"_"+(i&&i.substring("page_".length)||""),r={"background-color":e.color};return e.type===a.TYPE.SPELLCHECK?(r["border-bottom"]="2px dotted red",r.opacity=1):e.type===a.TYPE.HISTORY_HIGHLIGHT?r["background-color"]="transparent":(r["border-bottom"]="",r.opacity=""),J('<div class="overlay'+(e.collaborator?" collaborator "+e.SID:"")+(e.type==a.TYPE.FIND?" zw-find":"")+'" id="'+o+'"/>').addClass(e.class).css(r).data("range",e)[0]},Z=function(e,t){var i,o;for(o=0;o<t.length;o++)if(t[o].parent.parent.id==e.id){i=t[o];break}return i},X=function(e){return"comment"===e?{color:"#F88017",zuid:editor.uuid}:r.getUserData(e)},K=function(e){if(e._.focus&&!e.collaborator&&e.getStartPortionNode()&&e.getEndPortionNode()&&!EventHandler.isOnlyCtrlKeyPressed){var t=PUtil.offsetTop(e.getStartPortionNode())*editor.zoomFactor,i=PUtil.offsetTop(e.getEndPortionNode())*editor.zoomFactor,r=editor.editorPaneContainer[0].scrollTop,n=editor.editorPaneContainer.height()-J("#bottombar").height(),a=n+r,l=0;t<r&&(i<r||e._.scrollDirection==o.DOWN)?l=t-r:i>a&&(t>a||e._.scrollDirection==o.UP)&&(l=i-a+30),l&&(editor.editorPaneContainer[0].scrollTop+=l)}},$=function(e,t){var i,o=e[0];for(i=0;i<t.length;i++)if(t[i].id==o.id)return!0;return!1},q=function(e){var t=DocTreeManager.lineAtIndex(e);return!!t&&t.parent.getIndex()+t.start===e},Q=function(e){return e&&!Math.abs(e.end-e.parent.getEndIndex())},ee=function(e,t){var i,o=t[0];for(i=0;i<e.length;i++)if(e[i].id==o.id)return!0;return!1},te=function(e,t){if(e.startChar==UNICODE.TABLE&&e.setStart(e.start+1+1+1+1),e.endChar!==UNICODE.ROW&&e.endChar!==UNICODE.TABLEEND){var i;if(t)i=DocTreeManager.endIndexOfElement(J(e.getEndPortionNode()).parents("tr:last")[0]);else{var o=r.getParents(NODE_TYPE.ROW,e.end);i=o.getEnd()}e.setEnd(i)}e._.isPartialTableSelected=!0,e._.isPartialTableSelectedFromBottom=!0},ie=function(e,t){var i;if(t)i=DocTreeManager.indexOfElement(J(e.getStartPortionNode()).parents("tr:last")[0]);else{var o=r.getParents(NODE_TYPE.ROW,e.start);i=o.getStart()}e.setStart(i+1+1),e._.isPartialTableSelected=!0,e._.isPartialTableSelectedFromTop=!0},oe=function(e,t,i){if(!e.collaborator)return i?setTimeout(function(){PubSub.publish.call(null,t)},i):void PubSub.publish.call(null,t)},re=function(e,t,i){e._.isContentPaneSelected=e._.isMultipleTablesSelected=e._.isPartialTableSelected=e._.isPartialTableSelectedFromBottom=e._.isPartialTableSelectedFromTop=e._.isSelectionWithinTable=!1,e._.selectedCells=[];var o=e.start,n=e.end,a=J(t);e._.isContentPaneSelected=!!a.parents(".zw-contentpane:first")[0];var l=DocTreeManager.getParents(NODE_TYPE.CELL,e.start),s=DocTreeManager.getParents(NODE_TYPE.CELL,e.endChar===UNICODE.CELL||e.endChar===UNICODE.ROW?e.end-1:e.end),d=l&&l.parent.parent,c=s&&s.parent.parent;if(d&&!c)ie(e,!0);else if(!d&&c)te(e,!0);else if(d&&c){var p=DocTreeManager.getParentCells(l),u=DocTreeManager.getParentCells(s);if(l.id===s.id)(e._.isRowSelection||e._.isColumnSelection||e._.isCellSelection)&&(U.each(e.getCells(),function(t){U.each(ViewManager.getViews(t),function(t){e.selectCells(t)})}),e._.isSelectionWithinTable=!0,e._.isRowSelection=e._.isColumnSelection=e._.isCellSelection=!1);else if($(p,u))te(e);else if(ee(p,u))ie(e);else{var f=G(DocTreeManager.getParentTables(e.start),DocTreeManager.getParentTables(e.end));if(f)l=Z(f,p),s=Z(f,u),e.setStart(l.getIndex()+1),e.setEnd(s.getEndIndex()+1),e._.isSelectionWithinTable=!0;else{var g=r.getSelection(e.SID),m=g.parents(NODE_TYPE.ROW,"start");e.setStart(m.getStart()+2);var h=g.parents(NODE_TYPE.ROW,"end");e.setEnd(h.getEnd()),e._.isMultipleTablesSelected=!0}}}if(o!==e.start){var T=e.getStartPortionNode();T&&r.setCursorPortionNode(e.SID,"start",T)}if(n!==e.end){var E=r.getPortionData(e.end-1,editor.getPageID()),R=E&&E.node;R&&r.setCursorPortionNode(e.SID,"end",R)}K(e),ne(e),e._.isHeaderActived?(oe(e,"header/changed",50),fe(e)):e._.isFooterActvied&&(oe(e,"footer/changed",50),fe(e)),D(t,i),e._.isRowSelection=e._.isColumnSelection=!1},ne=function(e){var t=r.getSelection(e.SID);return t.getSelectedCells().length>0&&(t.isCtrlSelection||t.setSelectedCells([]),t.setIsTableSelected(!1)),e._.isSelectionWithinTable?void ae(e):void _(e)},ae=function(e){var i=r.getSelection(e.SID);e._.selectedCells=[],t.call(e.getCells(),function(i){e._.selectedCells.push(i),t.call(ViewManager.getViews(i)||[],function(t){B(e,t)})});var o=e.getSelectedDocCells(),n=o[0],a=o[o.length-1];i.setIsTableSelected(!0),i.setSelectedCells(o),i.setStartCell(n),i.setEndCell(a),i.setSelectedTable(n.parentNode().parentNode()),ue(e,ViewManager.getViews(n.dtNode)[0].el,ViewManager.getViews(a.dtNode)[0].el)},le=function(e){var t=(r.getSelection(e.SID),r.createRange(e.start,e.start,e.SID)),i=J(CurUtil.createCursor("start",e.SID)).removeClass("otherUserCollapsedCursor").addClass("otherUserCursorStart");de(t,i);var o=DocTreeManager.lineAtIndex(e.start);return i.css({height:o.height,top:-2,left:function(e,t){return parseFloat(t)-2}}),t=r.createRange(e.end,e.end,e.SID),i=J(CurUtil.createCursor("end",e.SID)).removeClass("otherUserCollapsedCursor").addClass("otherUserCursorEnd"),de(t,i),o=DocTreeManager.lineAtIndex(e.end),i.css({height:o.height,top:-2,left:function(e,t){return parseFloat(t)-2}}),e},se=0,de=function(e,t){var i,o,a=e.SID,l=e.ZUID,p=editor.getPageID(),u=e.end;try{if(i=1!==u&&!e.collaborator&&EventHandler.mouseDown_coord.isLineEnd&&e.endChar!==UNICODE.PARA&&e.endChar!==UNICODE.BR&&q(u)&&u--?r.getPortionData(u,p):e.getEndPortionData(p),!i||!(o=i.node))return}catch(t){n.error(t),e.collaborator||(EventHandler.mouseDown_coord.isLineEnd=!1),Utils.log("_"+ZWCollaboration.SHOW_CARET_GETPORTION_ERROR+"_SHOW_CARET_GETPORTION_ERROR_ start: "+e.start+", SID: "+a+", ZUID: "+l+"\nException: "+t.stack);var f=new Error(ZWCollaboration.SHOW_CARET_GETPORTION_ERROR);throw f.stack=t.stack,editor.lastError=f,f}var g=0,m=i.line;e.end===u?g+=DocTreeManager.getLeftAtIndex(u):g=m.right,r.setDomCursor(a,"start",o,e.end,l),r.setDomCursor(a,"end",o,e.end,l,!0);var h,T=J(o),E=o.className,R=E.indexOf("zeroSize")!=-1,S=E.indexOf("zw-br-portion")!==-1,O=E.indexOf("EOP")!==-1;R&&(h="zeroSize",E.indexOf("aligntop")!=-1&&(h+=" aligntop"),T.removeClass(h)),S&&T.removeClass("zw-br-portion"),O&&T.addClass("zw-portion").removeClass("EOP"),!e.collaborator&&!EventHandler.mouseDown_coord.isLineEnd||O||(r.setCursorPortionNode(a,"start",o),r.setCursorPortionNode(a,"end",o));var v={height:(o.getBoundingClientRect().height||15*editor.zoomFactor)/editor.zoomFactor,top:(T.position().top||0)/editor.zoomFactor,left:g,visibility:"visible"};if(h&&R&&T.addClass(h),S&&T.addClass("zw-br-portion"),O&&T.addClass("EOP").removeClass("zw-portion"),T.closestParent(".zw-line-div").append(t.css(v)[0]),n.log(e,T),!e.collaborator){var b=editor.editorPaneContainer[0].scrollTop;CurUtil.scrollTop!=b&&(editor.editorOffset=editor.jeditorPane.offset(),CurUtil.scrollTop=b),ue(e,t[0]),EventHandler.mouseDown_coord.isLineEnd=!1,editor.jMultiByteSpan.css({top:CurUtil.offset.start.top}),c=c||p,p&&c!==p&&(c=p,oe(e,"Cursor/PageChanged"));var A=m&&m.parent||void 0;if(A){var y=A.getIndex(),D=y+m.start;if(d=d||y,y&&d!==y){d=y,oe(e,"Cursor/ParaChanged");var C=DocTreeManager.doc.getSection(y);se!==C&&(se=C,oe(e,"Cursor/SectionChanged"))}s=s||D,D&&s!==D&&(s=D,oe(e,"Cursor/LineChanged"))}}},ce=function(e){if(e.collaborator)return le(e);var t,i,a,l,s,d,c,p,u,f,g,m,h,T,E,R=e.SID,S=e.ZUID,O=editor.getPageID(),v=!1;r.setDomCursorIdx(R,"start",e.start),r.setDomCursorIdx(R,"end",e.end);try{(t=e.getStartPortionData())&&(a=t.cursorPos,f=t.node),r.getCharAt(e.end-1)==UNICODE.PARA?(v=!0,i=r.getPortionData(e.end-1,O),g=i&&i.node,g&&(g=g.nextSibling?g.nextSibling:g)):(i=e.getEndPortionData())&&(l=i.cursorPos,g=i.node)}catch(t){throw n.error(t),e.collaborator||(EventHandler.mouseDown_coord.isLineEnd=!1),Utils.log("_"+ZWCollaboration.SHOW_CARET_GETPORTION_ERROR+"_SHOW_CARET_GETPORTION_ERROR_ start: "+e.start+", end: "+e.end+", SID: "+R+", ZUID: "+S+"\nException: "+t.stack),d=new Error(ZWCollaboration.SHOW_CARET_GETPORTION_ERROR),d.stack=t.stack,editor.lastError=d,d}m=J(f),h=J(g),fe(e),p=document.createElement("span"),u=document.createElement("span"),J(p).attr({class:"selection-portion"}).html("&#65279;"),J(u).attr({class:"selection-portion"}).html("&#65279;");try{f==g?(c=DomUtil.placeNode(f.firstChild,a,p),c=DomUtil.placeNode(c,l-a,u)):f&&g&&(f.firstChild?DomUtil.placeNode(f.firstChild,a,p):f.appendChild(p),v?h.after(u):(T=m.parents(".zw-line-content:first"),E=h.parents(".zw-line-content:first"),0==l&&T[0]!=E[0]&&T.parents(".zw-paragraph:first")[0]==E.parents(".zw-paragraph:first")[0]?E.find("span.zw-portion,span.EOP").last().after(u):g.firstChild?DomUtil.placeNode(g.firstChild,l,u):g.appendChild(u)))}catch(t){throw n.error(t),e.collaborator||(EventHandler.mouseDown_coord.isLineEnd=!1),Utils.log("_"+ZWCollaboration.SHOW_CARET_PLACENODE_ERROR+"_SHOW_CARET_PLACENODE_ERROR_ StartPortionData-CursorPos: "+a+", EndPortionData-CursorPos: "+l+", isEOPSelected: "+v+"\nException: "+t.stack),d=new Error(ZWCollaboration.SHOW_CARET_PLACENODE_ERROR),d.stack=t.stack,editor.lastError=d,d}e.collaborator||(ue(e,p,u),EventHandler.mouseDown_coord.isLineEnd&&(EventHandler.mouseDown_coord.isLineEnd=!1,r.setCursorPortionNode(R,"start",EventHandler.mouseDown_coord.portion)));try{J(p).add(u).removeAttr("class"),pe(e);var b=r.getSelection(e.SID);b._.PREV_RANGE&&!e.isSameRange(b._.PREV_RANGE)&&(e._.scrollDirection=e.start==b._.PREV_RANGE.start?o.UP:o.NONE,e._.scrollDirection=e.end==b._.PREV_RANGE.end?o.DOWN:e._.scrollDirection),re(e,p,u)}catch(t){throw n.error(t),Utils.log(Utils.getMouseLogs()),Utils.log("_"+ZWCollaboration.SHOW_CARET_SELECTION_ERROR+"_SHOW_CARET_SELECTION_ERROR_ start: "+e.start+", end: "+e.end+", SID: "+R+", ZUID: "+S+"\nException: "+t.stack),d=new Error(ZWCollaboration.SHOW_CARET_SELECTION_ERROR),d.stack=t.stack,editor.lastError=d,d}n.log(e),editor.togglePages(),s=r.getDomCursorNode(R,S,"start"),s.css({top:0,left:CurUtil.offset.start.left,visibility:"hidden"});var A=editor.editorPaneContainer[0].scrollTop;editor.jMultiByteSpan.css({top:A/editor.zoomFactor}),CurUtil.scrollTop!=A&&(editor.editorOffset=editor.jeditorPane.offset(),CurUtil.scrollTop=A)},pe=function(e){if(!e.collaborator&&editor.clientActiveSection){var t=J(editor.clientActiveSection);t.hasClass("header_primary")?e._.isHeaderActived=!0:t.hasClass("footer_primary")&&(e._.isFooterActvied=!0)}},ue=function(e,t,i){if(!e.collaborator){var o;if(t&&t.parentNode){var n=r.getDomCursorNode(e.SID,e.ZUID,"start");if(t==n[0]){var a=editor.editorPaneContainer.scrollTop()/editor.zoomFactor,l=editor.editorPaneContainer.scrollLeft()/editor.zoomFactor,s=DocTreeManager.lineAtIndex(e.start,editor.getPageID()),d=e.start;EventHandler.mouseDown_coord.isLineEnd&&s.prev&&(s=s.prev,d--);var c=DocTreeManager.getLeftAtIndex(d,editor.getPageID()),p=J(s&&s.el).offset()||{top:0,left:0};CurUtil.offset.start.top=CurUtil.offset.end.top=parseFloat(a+p.top/editor.zoomFactor-editor.editorPaneContainerOffset.top/editor.zoomFactor)-parseFloat(editor.editorPaneContainer.css("padding-top")||0),CurUtil.offset.start.left=CurUtil.offset.end.left=parseFloat(l+p.left+c-editor.editorPaneContainerOffset.left)}else o=PUtil.offset(t),CurUtil.offset.start.top=o.top,CurUtil.offset.start.left=o.left,CurUtil.offset.start.rects=t.getBoundingClientRect()}if(i&&i.parentNode)if("td"==i.nodeName.toLowerCase()){o=PUtil.offset(i),CurUtil.offset.end.top=o.top,CurUtil.offset.end.left=o.left+i.offsetWidth;var u={top:0,left:0,bottom:0,right:0,height:0,width:0},f=i.getBoundingClientRect();u.top=f.top,u.bottom=f.bottom,u.left=u.right=f.right,u.height=u.bottom-u.top,CurUtil.offset.end.rects=u}else o=PUtil.offset(i),CurUtil.offset.end.top=o.top,CurUtil.offset.end.left=o.left,CurUtil.offset.end.rects=i.getBoundingClientRect()}},fe=function(e){e.SID,e.ZUID;r.setDomCursor(e.SID,"start",e.getStartPortionNode(),e.start,e.ZUID),r.setDomCursor(e.SID,"end",e.getEndPortionNode(),e.end,e.ZUID,!0)}}(window),function(e){"use strict";for(var t=Array.prototype.forEach,i=Array.prototype.indexOf,o=Array.prototype.push,r=Array.prototype.slice,n=Array.prototype.splice,a=" "+UNICODE.BR,l=[UNICODE.TABLE,UNICODE.TABLEEND,UNICODE.ROW,UNICODE.CELL,UNICODE.SECTION_START,UNICODE.SECTION_END,UNICODE.RANGE_START,UNICODE.RANGE_END,UNICODE.TOCEND,UNICODE.TOCSTART,UNICODE.IMAGE,UNICODE.HR],s=UNICODE.PARA+UNICODE.IMAGE+UNICODE.TAB,d='`~!@#$%^&*()-_+=|{}[];:"“”/?.,„<«»>¿¡',c={cs:"normal",bgc:"none",fgc:"#000000",ff:"normal",fv:"normal",fs:"normal",size:11,type:"text",hd:0,fw:"normal"},p={},u={},f=0,g=a.length;f<g;f++)p[a[f]]=1;for(var f=0,g=l.length;f<g;f++)p[l[f]]=1,u[l[f]]=1;for(var m=s+d,f=0,g=s.length+d.length;f<g;f++)p[m[f]]=1;var h=editor.doc,T=new ZWLogger,E=function(e){e&&(this.SID=e);var t,i=this,o={};Object.defineProperties(o,{start:{get:function(){var e=t.getStartPortionData().line;return(e&&e.el&&e.el.getBoundingClientRect().left||0)+DocTreeManager.getLeftAtIndex(t.start)*editor.zoomFactor}},end:{get:function(){var e=t.getEndPortionData().line;return(e&&e.el&&e.el.getBoundingClientRect().left||0)+DocTreeManager.getLeftAtIndex(t.end)*editor.zoomFactor}}}),this._={isTableSelectionInProgress:!1,startCell:null,endCell:null,selectedCells:[],preCurrTd:null,selectedTable:null,isTableSelected:!1,OFFSET:o,LAST_MODIFIED_POSITION:E.MODIFIED_POSITION_START,PREV_RANGE:void 0,LAST_RANGE:void 0,SELECTION_TYPE:0,TARGET_RANGE:void 0,IS_LIST_ITEM_SELECTION:!1,IS_MULTIPLE_SELECTION:!1,IS_ROW_SELECTION:!1,IS_CELL_SELECTION:!1,LIST_LEVEL:void 0,LIST_ID:void 0,IS_CTRL_SELECTION:!1,IS_TEXT_DRAG_STARTED:!1};var r={},i=this;Object.defineProperties(this._,{userData:{get:function(){return J.isEmptyObject(r)&&extend(r,h.getUserData(i.SID)||{})||r}}}),PubSub.subscribe(["Document/AfterInit","Selection/updateClientLeft"],function(){t=i.getLastRange()})};E.prototype={constructor:E,each:function(){if(this.length){var e=Array.prototype.slice.call(arguments);if(e.length){var t=this,e=Array.prototype.concat.call([t],e);U.each.apply(t,e)}}},length:0,sortRanges:function(){return Array.prototype.sort.call(this,function(e,t){return e.start-t.start})},splice:n,toArray:function(){return r.call(this)}},Object.defineProperties(E.prototype,{collaborator:{get:function(){return this.SID!==editor.uuid}},isCellSelection:{get:function(){return this._.IS_CELL_SELECTION},set:function(e){this._.IS_CELL_SELECTION=!!e}},isCtrlSelection:{get:function(){return this._.IS_CTRL_SELECTION},set:function(e){this._.IS_CTRL_SELECTION=!!e}},isMultipleSelection:{get:function(){return this._.IS_MULTIPLE_SELECTION},set:function(e){this._.IS_MULTIPLE_SELECTION=!!e}},isListItemSelection:{get:function(){return this._.IS_LIST_ITEM_SELECTION},set:function(e){this._.IS_LIST_ITEM_SELECTION=!!e}},isRowSelection:{get:function(){return this._.IS_ROW_SELECTION},set:function(e){this._.IS_ROW_SELECTION=!!e}},isTextDrag:{get:function(){return this._.IS_TEXT_DRAG_STARTED},set:function(e){this._.IS_TEXT_DRAG_STARTED=!!e}},selectedListID:{get:function(){return this._.LIST_ID}},selectedListLevel:{get:function(){return this._.LIST_LEVEL}},selectionType:{get:function(){return this._.SELECTION_TYPE},set:function(e){return this._.SELECTION_TYPE=e,this}},ZUID:{get:function(){return this._.userData.zuid}}});var R;E.prototype.addRange=function(e){if(!e)return this;this.showCaret(e),CurUtil.initCursor(this),clearTimeout(R),Y(this,"Document/CursorPositionChanged",this.SID);var t=this._.LAST_RANGE;return this.collaborator||0==h.collabUsers.length||"SHAREDREAD"==h.getRole()||this.isCollapsed()&&this.getLastRange().start==t.start&&this.getLastRange().end==t.end||(R=setTimeout(function(){ZWCollaboration.sendCursorMutation()},1e3)),this},E.prototype.addRanges=function(e,i){if(!e||0==e.length)return this;var o=i?this.showCaret:this.addRange,r=this;return t.call(e,function(e){o.call(r,e)}),this},E.prototype.applyFormat=function(e){var i,o,r=this.getLastRange(),n=r.start,a=r.end;if(this.isTableSelected())O(this.getSelectedCells(),e);else if(r.isMultipleTablesSelected()){i=n,o=a;var l=r.getSelectedDocCells();O(l[0],e,function(e){e.getEnd()>i&&(i=e.getEnd())}),O(l[1],e,function(e){e.getStart()<o&&(o=e.getStart())}),v(i+1,o-3,e)}else r.isPartialTableSelected()?(i=n,o=a,O(r.getSelectedDocCells(),e,function(e){e.getStart()<o&&(o=e.getStart()),e.getEnd()>i&&(i=e.getEnd())}),n<o&&o<a?v(n,o-3,e):v(i+1,a,e)):this.isListItemSelection?List.updateLevelStyles(this._.LIST_ID,this._.LIST_LEVEL,e):t.call(this,function(t){v(t.start,t.end,e)});return this},E.prototype.applyOnSelection=function(e){for(var t,i,o,n=0,a=this.length;n<a;n++){t=this.getRangeAt(n),i=t.start,o=t.end,h.getContent(i,o)!=UNICODE.HR&&(i=this.getCorrectedCursorPosition(i),o=this.getCorrectedCursorPosition(o),t.setStart(i),t.setEnd(o));var l=h.getCharAt(o);if(this.isEOPOnlySelected()&&(l==UNICODE.TABLE||l==UNICODE.HR||l==UNICODE.TOCSTART))return this.collapse(!0),this;var s=r.call(arguments,1);if(this.isTableSelected())S(this.getSelectedCells(),e,s);else if(t.isMultipleTablesSelected()){var d=i,c=o,p=t.getSelectedDocCells();S(p[0],e,s),S(p[1],e,s),d=p[0][0].parentNode().parentNode().getEnd(),c=p[1][0].parentNode().parentNode().getStart();var u=[];u.push(d),u.push(c),s=u.concat(s),e.apply(this,s)}else if(t.isPartialTableSelected()){var d=i,c=o,p=t.getSelectedDocCells();S(p,e,s);var f=p[0],g=f.getStart();g>i?c=f.parentNode().parentNode().getStart():d=f.parentNode().parentNode().getEnd();var u=[];u.push(d),u.push(c),s=u.concat(s),e.apply(this,s)}else{var u=[];u.push(i),u.push(o),s=u.concat(s),e.apply(this,s)}}return this},E.prototype.collapse=function(e){var t,i,o,r,n;return this.isMultipleSelection?r=n=this.getTargetRange():(r=this.getFirstRange(),n=this.getLastRange()),e?(i=r.start,o=1):(i=n.end,o=-1),i+=h.getCharAt(i)==UNICODE.SECTION_START?o:0,t=h.createRange(i),this.removeAllRanges().addRange(t)},E.prototype.collapseToEnd=function(){return this.collapse(!1)},E.prototype.collapseToStart=function(){return this.collapse(!0)},E.prototype.createCursorOp=function(e,t,i){return h.createRange(e,t).createOp(i)},E.prototype.deleteChar=function(e){if(this.collaborator)return this;for(var t,i,o,r=0,n=this.length;r<n;r++)if(o=this.getRangeAt(r),t=o.start,i=o.end,this.isCollapsed()){if(e==KEYS.BACKSPACE){if(t==h.getSectionStart(t))return this;if(L(this,t)){t=o.start-1;var a=h.getRawFormatAt(t),l=h.getRawFormatAt(t+1),s=!1;if(a&&("list"!=a.ps_type||"list"==l.ps_type||"text"!=l.type&&"paragraph"!=l.type||i-t!=1||(s=!0)),h.getCharAt(t)==UNICODE.PARA){var d=h.getParents(NODE_TYPE.PARAGRAPH,t);if(d&&d.getEnd()-d.getStart()>1&&(h.getTrackChangeDetails().canCarryParaStyle()||TCHandler.isListData(h.getRawFormatAt(t)))||s){var c=DocUtil.copyStyle(h.getRawFormatAt(t));c[ATTR_PARAGRAPH.PS_NULL]=!0,c[ATTR_TEXT.TS_NULL]=!0;var d=this.parents(NODE_TYPE.PARAGRAPH),p=DocUtil.getKeys(c),u=Utils.randomString(),f=[{r:d.getEnd()-1},{as:{start:c,id:u}},{r:1},{as:{end:p,id:u}}];Op.processMsg(f)}}this.deleteContents(t,i)}}else if(w(this,t)){if(i=o.end+1,h.getCharAt(t)==UNICODE.PARA){var d=h.getParents(NODE_TYPE.PARAGRAPH,t);if(d&&d.getEnd()-d.getStart()>1){var c=DocUtil.copyStyle(h.getRawFormatAt(t));c[ATTR_PARAGRAPH.PS_NULL]=!0,c[ATTR_TEXT.TS_NULL]=!0;var g=h.findNextIndexOf(UNICODE.PARA,t+1);if(g>0&&(h.getTrackChangeDetails().canCarryParaStyle()||TCHandler.isListData(c))){var u=Utils.randomString(),p=DocUtil.getKeys(c),f=[{r:g},{as:{start:c,id:u}},{r:1},{as:{end:p,id:u}}];Op.processMsg(f)}}}this.deleteContents(t,i)}}else if(e==KEYS.DELETE)if(i==h.getSectionEnd(o.start)){o.setEnd(i-1);var c={};c[ATTR_COMMON.TYPE]=NODE_TYPE.PARAGRAPH,c[ATTR_PARAGRAPH.PS_NULL]=!0;var u=Utils.randomString(),p=DocUtil.getKeys(c),f=[{r:o.end},{as:{start:c,id:u}},{r:1},{as:{end:p,id:u}}];Op.processMsg(f),this.deleteSelectedContents()}else this.deleteSelectedContents(o,r<n-1);else{var m=editor.doc.getCharAt(o.end),T=editor.doc.getCharAt(o.start-1);m&&m===UNICODE.SPACE&&T&&T===UNICODE.SPACE&&o.setEnd(o.end+1),this.deleteSelectedContents(o,!0)}return this},E.prototype.deleteContents=function(e,t){if(!e||!t||this.collaborator)return this;var i="",o=0,r=h.getCharAt(e),n=h.getCharAt(t),a=h.getSectionStart(e)+1,l=h.getSectionEnd(e);Utils.isTrailSurrogateChar(r)&&e>a&&Utils.isLeadSurrogateChar(h.getCharAt(e-1))&&(e-=1),Utils.isTrailSurrogateChar(n)&&(t+=1);var s=h.getTrackChangeDetails(),d=s.canHandleTC();if(s.setProcessingContentDeletion(!0),t==l){if(e==a){this.paraFormat={type:NODE_TYPE.PARAGRAPH};var c=h.createElement(NODE_TYPE.PARAGRAPH);c.setStart(a),c.setEnd(a+1),c.insert();var p=this.getFirstRange();p.setStart(a+1);var u=[{r:e},{ds:h.getContent(e,t)}];if(Op.processMsg(u),/zw-contentpane/.test(editor.clientActiveSection&&editor.clientActiveSection.id||""))for(var f=h.findNextIndexOf(UNICODE.SECTION_START,e);f!=-1;){var g=h.getSectionEnd(f),m=h.getRawFormatAt(f),T=m[ATTR_SECTION.ST];U.contains([CONST.HEADER_EVEN,CONST.HEADER_PRIMARY,CONST.FOOTER_EVEN,CONST.FOOTER_PRIMARY,CONST.HEADER_FIRST,CONST.FOOTER_FIRST],parseInt(T||-1))||(u=[{r:f},{ds:h.getContent(f,g)}],Op.processMsg(u)),f=h.findNextIndexOf(UNICODE.SECTION_START,g)}return s.setProcessingContentDeletion(!1),this}e++;var p=this.getFirstRange();p.setStart(a+1),p.select()}var E,R,S=e,O=!1,v=function(){if(i.length>0){var e=[{r:o-i.length},{ds:i}];Op.processMsg(e),i=""}};for(o=e;o<t;o++){var b=h.getCharAt(o);switch(UNICODE.TOCSTART==b&&v(),!d||o!==E&&o!==R||(v(),s.setStopProcessingTC(!1),E=R=void 0),b){case UNICODE.TOCSTART:var A=h.findNextIndexOf(UNICODE.TOCEND,e);Toc.deleteTOC(),o=A;break;case UNICODE.TOCEND:var y=h.findPreviousIndexOf(UNICODE.TOCSTART,e);y>0&&y>=e?i+=b:O=!0;break;case UNICODE.TABLE:var D=TableUtil.getTableEnd(o+1);D>0&&D<=t?i+=b:O=!0;break;case UNICODE.ROW:var C=TableUtil.getRowEnd(o+1);C>0&&C<=t?i+=b:O=!0;break;case UNICODE.CELL:var I=TableUtil.getCellEnd(o+1);I>0&&I<=t?i+=b:O=!0;break;case UNICODE.TABLEEND:var P=TableUtil.getTableStart(o);P>0&&P>=S?i+=b:O=!0;break;case UNICODE.RANGE_START:var _=DocUtil.getRangeEnd(o),m=h.getRawFormatAt(o);_<t?(m&&m.type==NODE_TYPE.BOOKMARK&&m.id&&m.id.indexOf("toc_")==-1&&(delete editor.bookmarks[m.id],Y(this,"Bookmarkbutton/update")),i+=b):O=!0;break;case UNICODE.RANGE_END:var N=DocUtil.getRangeStart(o);if(N>=S){i+=b;var m=h.getRawFormatAt(o);if(m){var L=m.type;if(L==NODE_TYPE.ENDNOTE||L==NODE_TYPE.FOOTNOTE){var w=h.getFloatElement(L,m.id);w.section.remove()}}}else O=!0;break;case UNICODE.PARA:var m=h.getRawFormatAt(o);if(0!=o){var M=h.getCharAt(o-1),x=i[i.length-1];if(M==UNICODE.TABLEEND&&x!=UNICODE.TABLEEND){var F=h.findNextIndexOf(CONT_REGEXP.PARAEND,o);if(F>t)break}else if(h.getCharAt(o+1)===UNICODE.TOCEND){var y=h.findPreviousIndexOf(UNICODE.TOCSTART,e);if(y>0&&y>=e){O=!0;break}}}default:var m=h.getRawFormatAt(o);if(m){var T=m[ATTR_SECTION.ST];if(U.contains([CONST.HEADER_EVEN,CONST.HEADER_PRIMARY,CONST.FOOTER_EVEN,CONST.FOOTER_PRIMARY,CONST.HEADER_FIRST,CONST.FOOTER_FIRST],parseInt(T||-1))){Utils.log("_"+ZWCollaboration.SHOW_SELECTION_ERROR+"_SHOW_SELECTION_ERROR start: "+e+", end: "+t+", SID: "+this.SID+", ZUID: "+this.ZUID+"\nException: Trying to delete a Header / Footer section character format @"+o+" is "+m);var k=new Error(ZWCollaboration.SHOW_SELECTION_ERROR);throw editor.lastError=k,k}m.shapeData&&PubSub.publish("ZWSelection/ShapeDeleted",m)}i+=b}O&&(v(),O=!1)}if(i.length>0){var u=[{r:o-i.length},{ds:i}];Op.processMsg(u),i="",o!==E&&o!==R||s.setStopProcessingTC(!1)}if(s.setProcessingContentDeletion(!1),e>0&&a<e){var B=DocUtil.getTextStyle(e),J=h.getCharAt(e);B&&J!=UNICODE.PARA&&(this.tempCursorFormat=B)}return this},E.prototype.deleteSelectedContents=function(e,t){e=e||this.getLastRange();var i=e.start,o=e.end;h.getContent(i,o)!=UNICODE.HR&&(i=this.getCorrectedCursorPosition(i),o=this.getCorrectedCursorPosition(o),e.setStart(i),e.setEnd(o));var r=h.getCharAt(o);if(this.isEOPOnlySelected()&&(r==UNICODE.TABLE||r==UNICODE.HR||r==UNICODE.TOCSTART))return this.collapse(!0),this;var n=e.getNodes(NODE_TYPE.PARAGRAPH);if(n&&n.length>1&&n[0].getStart()!==i&&n[0].getEnd()-1!==i){var a=n[0].getEnd();this.deleteContents(i,a-1),i=a}if(this.isTableSelected())D(this,this.getSelectedCells()),this.removeTableSelection();else if(e.isMultipleTablesSelected()){var l=i,s=o,d=e.getSelectedDocCells();D(this,d[0],function(e){e.getEnd()>l&&(l=e.getEnd())}),D(this,d[1],function(e){e.getStart()<s&&(s=e.getStart())});this.deleteContents(l+1,s-3)}else if(e.isPartialTableSelected()){var l=i,s=o;D(this,e.getSelectedDocCells(),function(e){e.getStart()<s&&(s=e.getStart()),e.getEnd()>l&&(l=e.getEnd())}),i<s&&s<o?this.deleteContents(i,s-3):this.deleteContents(l+1,o),e.remove()}else this.deleteContents(i,o);return t?this:this.collapse(!0)},E.prototype.find=function(e,t,i){return i=i||"start","previous"==e?this.findPrevious(t,i):this.findNext(t,i)},E.prototype.findNext=function(e,t,i,o,r){if(i)o=i.getEnd();else if(!o){var n=this.getLastRange();o=n.start,"end"==t&&(o=n.end)}h.getCharAt(o)==UNICODE.SECTION_START&&(o-=1);for(var a,l,s,d=h.getSectionEnd(o),c=new RegExp(UNICODE.TABLE+"|"+UNICODE.TABLEEND+"|"+UNICODE.ROW+"|"+UNICODE.CELL+"|"+UNICODE.PARA+"|"+UNICODE.SECTION_START+"|"+UNICODE.RANGE_START+"|"+UNICODE.RANGE_END+"|"+UNICODE.BR+"|"+UNICODE.HR+"|"+UNICODE.TOCSTART+"|"+UNICODE.TOCEND,"g");!a&&o<d;){switch(l=h.getCharAt(o),s=h.getRawFormatAt(o),!0){case e.indexOf(NODE_TYPE.TEXT)>-1&&!c.test(l):a=h.createElement(NODE_TYPE.TEXT,l),a.setStart(o),a.setEnd(o+1);break;case e.indexOf(NODE_TYPE.BR)>-1&&l==UNICODE.BR:a=h.createElement(NODE_TYPE.BR,l),a.setStart(o),a.setEnd(o+1);break;case e.indexOf(NODE_TYPE.PARAGRAPH)>-1&&"\n"==l:a=h.createElement(NODE_TYPE.PARAGRAPH,l),a.setStart(o),a.setEnd(o+1);break;case l==UNICODE.HR&&e.indexOf(NODE_TYPE.HR)>-1:a=h.createElement(NODE_TYPE.HR),a.setStart(o),a.setEnd(o+1);break;case e.indexOf(NODE_TYPE.IMAGE)>-1&&l==UNICODE.IMAGE:a=h.createElement(NODE_TYPE.IMAGE),a.setStart(o),a.setEnd(o+1);break;case e.indexOf(NODE_TYPE.IFRAME)>-1&&l==UNICODE.IFRAME:a=h.createElement(NODE_TYPE.IFRAME),a.setStart(o),a.setEnd(o+1);break;case e.indexOf(NODE_TYPE.SECTION)>-1&&l==UNICODE.SECTION_START:var p=h.findNextIndexOf(CONT_REGEXP.SECTIONEND,o+1);p<0&&(p=d);var u=h.getContent(o,p);a=h.createElement(s[ATTR_SECTION.ST],s.sid),a.setStart(o),a.setEnd(p),a.setContent(u),o=p-1;break;case e.indexOf(UNICODE.RANGE_START)>-1&&l==UNICODE.RANGE_START&&r==s.type:a=h.getElementAt(o)}o++}return a},E.prototype.findPrevious=function(e,t,i,o,r){if(i)o=i.getStart();else if(!o){var n=this.getLastRange();o=n.start,"end"==t&&(o=n.end)}for(var a,l,s,d=new RegExp(UNICODE.TABLE+"|"+UNICODE.TABLEEND+"|"+UNICODE.ROW+"|"+UNICODE.CELL+"|"+UNICODE.PARA+"|"+UNICODE.SECTION_START+"|"+UNICODE.RANGE_START+"|"+UNICODE.RANGE_END+"|"+UNICODE.BR+"|"+UNICODE.HR+"|"+UNICODE.TOCSTART+"|"+UNICODE.TOCEND,"g");!a&&o>0;)switch(o--,l=h.getCharAt(o),s=h.getRawFormatAt(o),!0){case e.indexOf(NODE_TYPE.TEXT)>-1&&!d.test(l):a=h.createElement(NODE_TYPE.TEXT,l),a.setStart(o),a.setEnd(o+1);break;case e.indexOf(NODE_TYPE.BR)>-1&&l==UNICODE.BR:a=h.createElement(NODE_TYPE.BR,l),a.setStart(o),a.setEnd(o+1);break;case e.indexOf(NODE_TYPE.PARAGRAPH)>-1&&"\n"==l:a=h.createElement(NODE_TYPE.PARAGRAPH,l),a.setStart(o),a.setEnd(o+1);break;case e.indexOf(NODE_TYPE.CELL)>-1&&l==UNICODE.CELL:a=h.createElement(NODE_TYPE.CELL),a.setStart(o);var c=h.findNextIndexOf(CONT_REGEXP.CELLEND,o+1);a.setEnd(c);break;case e.indexOf(NODE_TYPE.ROW)>-1&&l==UNICODE.ROW:a=h.createElement(NODE_TYPE.ROW),a.setStart(o);var p=h.findNextIndexOf(CONT_REGEXP.ROWEND,o+1);a.setEnd(p);break;case l==UNICODE.HR&&e.indexOf(NODE_TYPE.HR)>-1:a=h.createElement(NODE_TYPE.HR),a.setStart(o),a.setEnd(o+1);break;case e.indexOf(NODE_TYPE.IMAGE)>-1&&l==UNICODE.IMAGE:a=h.createElement(NODE_TYPE.IMAGE),a.setStart(o),a.setEnd(o+1);break;case e.indexOf(NODE_TYPE.IFRAME)>-1&&l==UNICODE.IFRAME:a=h.createElement(NODE_TYPE.IFRAME),a.setStart(o),a.setEnd(o+1);break;case e.indexOf(NODE_TYPE.SECTION)>-1&&l==UNICODE.SECTION_START:var u=h.findNextIndexOf(CONT_REGEXP.SECTIONEND,o+1);u<0&&(u=h.getSectionEnd(o));var f=h.getContent(o,u);a=h.createElement(s[ATTR_SECTION.ST],s.sid),a.setStart(o),a.setEnd(u),a.setContent(f),o=u-1;break;case e.indexOf(UNICODE.RANGE_START)>-1&&l==UNICODE.RANGE_START&&r==s.type:a=h.getElementAt(o)}return a},E.prototype.getAllHeadings=function(e){for(var t,i,o=[],r=h.createRange(1,h.getSectionEnd(1)),n=r.getNodes(NODE_TYPE.PARAGRAPH),a=0,l=n.length;a<l;a++)i=n[a],t=i&&parseInt(i.attr(ATTR_PARAGRAPH.PS_HD)||0),!t||parseInt(t)>9||e&&t!=parseInt(e)||o.push(i);return T.log("@getAllHeadings",o),o},E.prototype.getAllRangeOffsets=function(){var e=[];return t.call(this,function(t){e.push(t.offset())}),e},E.prototype.getAllRangesWithCursorFormat=function(){var e,i=this.getLastRange(),o=h.getSectionStart(i.start),r=h.getSectionEnd(i.start),n=[],a=[];if(k(this)){var l=this.parents(NODE_TYPE.PARAGRAPH)||{},s=l.dtNode&&l.dtNode.paraProperties.level,d=h.createRange(l.getStart(),l.getEnd()),c=d.getNodes(NODE_TYPE.TEXT)[0];e=h.getComputedFormatAt(c?c.getStart():l.getEnd()-1,NODE_TYPE.TEXT,s),n=I(this,e,s)}else{e=this.getComputedTextFormat()||{},DocUtil.constructRenderingFormat(e);var p,u,f,g,m=[];for(p=o+1;p<r;p++)u=DocTreeManager.getTreeNodeAtIndex(p),h.getCharAt(p)!=UNICODE.TABLEEND&&u&&"para"===u.type?(g=h.getRawFormatAt(p))&&(f=u.paraProperties&&u.paraProperties.paraFormat&&parseInt(u.paraProperties.paraFormat[ATTR_PARAGRAPH.PS_HD]||0)||0,(g=P(p,f))&&(b(e,g)?!m.length&&m.push(p):m.length&&g.type==NODE_TYPE.TEXT&&(m.push(p),n.push(m),m=[]))):m.length&&(m.push(p),n.push(m),m=[]);m.length&&(m.push(r),n.push(m))}return t.call(n,function(e){a.push(h.createRange(e[0],e[1]).setFocus(!1))}),T.log("getAllRangesWithCursorFormat",a),a},E.prototype.getAllSelectedOps=function(){var e=[];return t.call(this,function(t){e.push(t.getSelectedOps())}),e},E.prototype.getClientLeft=function(e){return e=e&&e===E.MODIFIED_POSITION_END&&E.MODIFIED_POSITION_END||this.getLastModifiedPosition(),this._.OFFSET[e]},E.prototype.getComputedTextFormat=function(){return this.computedTextFormat},E.prototype.getCorrectedCursorPosition=function(e){if(this._.IS_CELL_SELECTION)return e;var t=h.getCharAt(e);if(0==e?e++:t||e!=h.getDocumentLength()||(e-=1,t=h.getCharAt(e)),e>=1&&(t==UNICODE.TABLE||t==UNICODE.SECTION_START||t==UNICODE.ROW||t==UNICODE.CELL||t==UNICODE.HR||t==UNICODE.TOCSTART||t==UNICODE.TOCEND||t==UNICODE.TABLEEND)){var i=h.getCharAt(e-1);if(i==UNICODE.PARA)return e-=1;for(var o=h.getSectionEnd(e),r=e;r<o;r++){var n=h.getRawFormatAt(r);if(n&&("text"==n.type||"image"==n.type||"br"==n.type||"paragraph"==n.type))return r}}return e},E.prototype.getCursorOp=function(){var e=[];if(this.isListItemSelection){var i=h.createRange(this.getFirstRange().start);e.push(i.toCursorOp())}else t.call(this,function(t){e.push(t.toCursorOp())});if(this.length<1){Utils.log("_"+ZWCollaboration.CURSOR_IDX_ERROR+"_CURSOR_IDX_ERROR_ Selection length is 0 for ZUID: "+this.ZUID+", SID: "+this.SID);var o=new Error(ZWCollaboration.CURSOR_IDX_ERROR);throw editor.lastError=o,o}return JSON.stringify(e)},E.prototype.getEnd=function(){var e=this.getTargetRange();return e&&e.end||1},E.prototype.getStartCell=function(){return this._.startCell},E.prototype.getEndCell=function(){return this._.endCell},E.prototype.getSelectedCells=function(){return this._.selectedCells},E.prototype.getSelectedTable=function(){return this._.selectedTable},E.prototype.getSelectedText=function(){return Utils.removeUnWantedUnicodes(this.getLastRange().getContent())},E.prototype.getSelectedColumns=function(){var e,t,i,o,r,n,a,l=[];for(o=0,a=this._.selectedCells.length;o<a;o++)for(e=this._.selectedCells[o],t=e.parentNode().nodeCountBefore(e),i=e.attr(ATTR_CELL.TDS_CSPAN),i=i?i:1,n=0;n<i;n++)l.contains(t+n)||l.push(t+n);for(o=0;o<l.length-1;o++)for(r=o+1;r<l.length;r++)l[o]>l[r]&&(temp=l[o],l[o]=l[r],l[r]=temp);return l},E.prototype.getSelectedRows=function(){var e,t,i,o,r,n,a,l,s,d=[];for(n=0,s=this._.selectedCells.length;n<s;n++)for(t=this._.selectedCells[n],i=t.parentNode(),o=i.parentNode(),e=o.nodeCountBefore(i),r=t.attr(ATTR_CELL.TDS_RSPAN),r=r?r:1,l=0;l<r;l++)d.contains(e+l)||d.push(e+l);for(n=0;n<d.length-1;n++)for(a=n+1;a<d.length;a++)d[n]>d[a]&&(temp=d[n],d[n]=d[a],d[a]=temp);return d},E.prototype.getFirstRange=function(){return this.getRangeAt(0)},E.prototype.getLastModifiedPosition=function(){return this._.LAST_MODIFIED_POSITION},E.prototype.getLastRange=function(){return this.getRangeAt(this.length-1)},E.prototype.getNextWord=function(){var e,t=this.getLastRange(),i=t.start;e=H(i)?DocUtil.getRangeEnd(i)+1:_(i);var o=h.createElement(NODE_TYPE.TEXT);return o.setStart(i),o.setEnd(e),o},E.prototype.getNextWordEnd=function(){var e=this.getLastRange(),t=e.end,i=_(t);return i===t&&h.getCharAt(t)!=UNICODE.SECTION_START&&(i=_(t+1)),this.setLastModifiedPosition(E.MODIFIED_POSITION_END),i},E.prototype.getNextWordStart=function(){var e=this.getLastRange(),t=e.start,i=_(t);return i>e.end&&this.setLastModifiedPosition(E.MODIFIED_POSITION_END),i},E.prototype.getNodesInSection=function(e,t){var i,o;if(e){var r=h.getSection(e,e);if(!r)return[];i=r.getStart()+2,o=r.getEnd()}else i=0,o=h.getSectionEnd(0);var n=h.getNodesInSelection(t,i,o);return n},E.prototype.getTextPortionsInSelection=function(){var e,t,i,o=this.getNodesInSelection(NODE_TYPE.TEXT),r=0,n=0,a=o.length,l=[];for(r=0;r<a;r++)if(e=o[r],t=e.attr("*"),0==r||t&&t.type==NODE_TYPE.TEXT){for(i=h.createElement(NODE_TYPE.TEXT),i.setStart(e.getStart()),n=e.getStart()+1;n<e.getEnd();n++)h.getRawFormatAt(n)&&(i.setEnd(n),i.nodeValue=h.getContent(i.getStart(),i.getEnd()),l.push(i),i=h.createElement(NODE_TYPE.TEXT),i.setStart(n));i&&(i.setEnd(e.getEnd()),i.nodeValue=h.getContent(i.getStart(),i.getEnd()),l.push(i))}else l.push(e);return l},E.prototype.getNodesInSelection=function(e){var i=r.call(arguments);if(i.length>2)return h.createRange(i[1],i[2]).getNodes(e);var o=[];return t.call(this,function(t){o=o.concat(t.getNodes(e))}),o},E.prototype.getParaFormat=function(){return this.paraFormat},E.prototype.getPreviousWord=function(e){var t,i=this.getLastRange(),o=i.start;t=G(o-1)?DocUtil.getRangeStart(o-1):N(o,e);var r=h.createElement(NODE_TYPE.TEXT);return r.setStart(t),r.setEnd(o),r},E.prototype.getPreviousWordWithoutSplChar=function(){return this.getPreviousWord(!0)},E.prototype.getPrevWordEnd=function(){var e=this.getLastRange(),t=e.end,i=N(t);return i<e.start&&this.setLastModifiedPosition(E.MODIFIED_POSITION_START),i},E.prototype.getPrevWordStart=function(){var e=this.getLastRange(),t=e.start;if(t&&h.getCharAt(t-1)==UNICODE.SECTION_START)return t;var i=N(t);return i===t&&(i=_(t-1)),this.setLastModifiedPosition(E.MODIFIED_POSITION_START),i},E.prototype.getRangeAt=function(e){return e<0||e>=this.length?null:this[e]},E.prototype.getStart=function(){var e=this.getTargetRange();return e&&e.start||1},E.prototype.getTargetRange=function(){if(this.isListItemSelection)return this.getFirstRange();var e=this.length;if(1===e||!this._.TARGET_RANGE)return this.getLastRange();for(var t,i=0,o=e;i<o;)t=i+o>>>1,this[t].start<this._.TARGET_RANGE.start?i=t+1:o=t;return i-=o>0&&i===o?1:0,this.getRangeAt(i)},E.prototype.getTextFormat=function(){return this.textFormat},E.prototype.getTextFormatWithCls=function(){var e,t=this.getLastRange(),i=t.start,o=this.parents(NODE_TYPE.SECTION).getEnd();if(o==i)i-=1;else if(i>0){var r=h.getCharAt(i-1),n=h.getCharAt(i);this.isCollapsed()?r!=UNICODE.SECTION_START&&r!=UNICODE.PARA&&r!=UNICODE.CELL&&r!=UNICODE.TOCSTART&&(i-=1):n===UNICODE.RANGE_START&&(i+=1)}return e=DocUtil.getTextStyle(i),e?(delete e[ATTR_TEXT.TS_SP],delete e[ATTR_TEXT.TS_GR]):e={type:NODE_TYPE.TEXT},e},E.prototype.getWord=function(){function e(e){if(e<=1)return 1;if(l&&!r)return e;for(e--,e>0&&z(h.getCharAt(e))&&e--;e>0&&!M(h.getCharAt(e))&&!F(h.getCharAt(e));)e--;return e+1}function t(e){if(r)return e;for(var t=h.getSectionEnd(e);e<t&&!M(h.getCharAt(e))&&(e++,!F(h.getCharAt(e))););return e}var i,o,r,n=this.getLastRange(),a=n.start,l=!0;i=h.getCharAt(a),a>0&&(o=h.getCharAt(a-1)),r=M(i),o&&(l=M(o));var s=h.createElement(NODE_TYPE.TEXT);return s.setStart(e(a)),s.setEnd(t(a)),s},E.prototype.hasDOMParent=function(e,t){var i,o=this.getLastRange(),r=t&&t==E.MODIFIED_POSITION_END?o.getEndPortionNode():o.getStartPortionNode();return!r||!(i=DomUtil.getClassForNodeType(e))||!!J(r).closestParent(i)[0]},E.prototype.hasIntersectRange=function(e){for(var t=0,i=this.length;t<i;t++)if(this.getRangeAt(t).isIntersectWithRange(e))return t;return-1},E.prototype.hasRange=function(e){for(var t=0,i=this.length;t<i;t++)if(this.getRangeAt(t).isSameRange(e))return!0;return!1},E.prototype.insert=function(e,t){var i=this.getLastRange(),o=i.start,r=i.end;this.isCollapsed()||(0==o&&r-o==1?i.setStart(r):(this.isTableSelected()||r>o)&&(this.length>1&&(i=this.getTargetRange()),this.deleteSelectedContents(i,!0),h.getTrackChangeDetails().canHandleTC()&&Op.sendMsg())),o=i.start,e.setStart(o);var n=e.type;if(0!=o&&n==NODE_TYPE.PARAGRAPH||n==NODE_TYPE.HR||n==NODE_TYPE.BR||n==NODE_TYPE.IMAGE||t&&t.st==NODE_TYPE.TAB)this.textFormat=this.getTextFormat();else if(n==NODE_TYPE.TEXT&&0!=o){var a=h.getCharAt(o-1);if(J.isEmptyObject(t)){if(DocUtil.isBoundaryChar(a)){var l=h.getRawFormatAt(o-1);if(t=l?l[ATTR_PARAGRAPH.PS_TS]:null,!t){var s=h.getRawFormatAt(o);t=s&&s.type==NODE_TYPE.TEXT&&s.st!=NODE_TYPE.TAB?DocUtil.copyStyle(s):this.getTextFormat()}}}else if(!DocUtil.isBoundaryChar(a)){var d=DocUtil.getTextStyle(e.getStart()-1);Utils.compareJSON(t,d)&&(t=void 0)}this.textFormat={}}return e.insert(t),this},E.prototype.isCollapsed=function(){for(var e=0,t=this.length;e<t;e++)if(!this.getRangeAt(e).collapsed)return!1;return!0},E.prototype.isEOPOnlySelected=function(){var e=this.getFirstRange(),t=e.start,i=e.end;return i-t==1&&h.getContent(t,i)==UNICODE.PARA},E.prototype.isInLockRange=function(){var e=!1,t=this.getLastRange();return e=Lock.isIdxInLockArea(t.start,this.ZUID),this.isCollapsed()||e||(e=Lock.isIdxInLockArea(t.end)),e},E.prototype.isTableSelected=function(){return!!this._.isTableSelected},E.prototype.isTableSelectionInProgress=function(){return!!this._.isTableSelectionInProgress},E.prototype.isUnlockAllowed=function(){var e,t=!1,i=this.getLastRange();if(e=Lock.getLockRanges(i.start),t=e.length>0,!t){var o=Lock.getLockRanges(i.start,i.end);t=o.length>0}return t},E.prototype.mapAllSelectionsToBulletin=function(){if(this.length<2)return void(this.isCollapsed&&PubSub.publish("QuickSeek/hideBarWithID","Selection"));var e={buttonBGColor:"#94a1de",buttonBRColor:"#0a42e2",id:"Selection",overlayToBeAnimated:".overlay",ranges:[]};return U.each(this.toIntervals(),function(t){e.ranges.push({start:t[0],end:t[1]})}),PubSub.publish("QuickSeek/showBarWithObj",e),this},E.prototype.mergeCells=function(){for(var e=!1,t=0,i=this.getLastRange().getCells(),o=i[0].getMatrixPosition(),r=i[i.length-1].getMatrixPosition(),n=i.length,a=(h.getTrackChangeDetails(),1);a<=n;a++){var l=i[a-1];if(1==a){var s=h.getElementAt(l.getIndex()),d=TableUtil.getCellWidth(s);d.indexOf(UNITS.PERCENTAGE)!==-1&&(e=!0);var c={};c[ATTR_CELL.TDS_RSPAN]=r[0]-o[0]+1,c[ATTR_CELL.TDS_CSPAN]=r[1]-o[1]+1,c[ATTR_CELL.TDS_MRG]="fc",s.attr(c),Op.fillCursorPos(s.getStart()+1,s.getStart()+1),t=TableUtil.getCellEnd(s.getStart()+1)}else{var c={};s=h.getElementAt(l.getIndex()),s.attr(ATTR_CELL.TDS_MRG)&&(c[ATTR_CELL.TDS_MRG]=""),s.attr(ATTR_CELL.TDS_RSPAN)&&(c[ATTR_CELL.TDS_RSPAN]=""),s.attr(ATTR_CELL.TDS_CSPAN)&&(c[ATTR_CELL.TDS_CSPAN]=""),l.getMatrixPosition()[1]==o[1]?c[ATTR_CELL.TDS_MRG]="vmp":c[ATTR_CELL.TDS_MRG]="hmp";var p=0;p+=e?UNITS.PERCENTAGE:Conversions.globalUnit,s.attr(c);var u=s.getStart(),f=TableUtil.getCellEnd(s.getStart()+1);if(f-u>2){var g=h.createRange(u+1,f),m=g.getSelectedOps();m[0]={r:t},Op.processMsg(m)}this.deleteContents(s.getStart(),s.getEnd()-1)}}for(var a,T,E=editor.doc.getSelection().getSelectedRows(),R=0,S=editor.doc.getParents(NODE_TYPE.TABLE,editor.doc.getSelection().getStart()),O=S.children()[E[0]],v=O.children(),a=0;a<E.length;a++)R+=parseFloat(Conversions.toGlobalValue(S.children()[E[a]].dtNode.height+"px"));for(T=0;T<v.length;T++)v[T].attr({ht:R+Conversions.globalUnit});this.removeTableSelection()},E.prototype.mouseDown=function(e,t){if(delete this._.isTableSelectionInProgress,this._.isTableSelected=!!this._.selectedCells.length,t||"mousedown"==e.type&&editor.browserInfo.is_mac&&e.ctrlKey&&(this.isTableSelected()||editor.browserInfo.is_safari)||t&&editor.browserInfo.is_mac)return!1;var i=editor.browserInfo.is_ie?e.srcElement:e.target,o=J(i).is(NODE_NAME.TD)?i:J(i).closestParent(NODE_NAME.TD)[0];o&&(this._.isTableSelectionInProgress=!0,this.setStartCell(o),this.setSelectedTable(J(this.getStartCell()).closestParent(NODE_NAME.TABLE)[0]),this.setEndCell(null))},E.prototype.mouseMove=function(e){if(this.isTableSelectionInProgress()&&(this.collaborator||!TableResize.isInProgress())){var t=document.elementFromPoint(e.clientX,e.clientY);Utils.nodeNameEquals(t,NODE_NAME.TD)||(t=J(t).closestParent(NODE_NAME.TD).get(0));var i=J(this.getStartCell()).closestParent(NODE_NAME.TABLE)[0],o=J(t).parents(NODE_NAME.TABLE);if(i==o[0])this.setEndCell(t);else for(var r=1;o[r];){if(i==o[r]){t=J(t).parents(NODE_NAME.TD)[r-1],this.setEndCell(t);break}r++}var n=J(t);return t==this.getStartCell()||n.closestParent(NODE_NAME.TABLE)[0]!=J(this.getStartCell()).closestParent(NODE_NAME.TABLE)[0]?(J(this.getSelectedTable()).find("td.selectedCell").removeClass("selectedCell").end().removeClass("unselectable_table"),delete this._.isTableSelected,!0):void(this.isTableSelectionInProgress()&&n.is(NODE_NAME.TD)&&this._.preCurrTd!=t&&(this.isTableSelected()||J(this.getStartCell()).parents(NODE_NAME.TABLE).addClass("unselectable_table"),this._.isTableSelected=!0,this.selectCells(),this._.preCurrTd=t))}},E.prototype.moveTo=function(e,t){var i=h.createRange(t?e.getStart():e.getEnd());return this.addRange(i)},E.prototype.parents=function(e,t){if(!this.length||!this.hasDOMParent(e,t))return null;var i=this.getLastRange(),o=t&&t==E.MODIFIED_POSITION_END?i.end:i.start;return h.getParents(e,o)},E.prototype.removeAllRanges=function(){return t.call(this,function(e){e.remove()}),this._.PREV_RANGE&&this._.PREV_RANGE.remove(),this.length=0,this},E.prototype.removeFirstRange=function(){return this.removeRange(this.getFirstRange())},E.prototype.removeLastRange=function(){return this.removeRange(this.getLastRange())},E.prototype.removeRange=function(e){if(!e||J.isEmptyObject(e))return this;e.remove();var t=i.call(this,e);return t<0?this:(n.apply(this,[t,1]),this)},E.prototype.removeRangeAt=function(e){return this.removeRange(this.getRangeAt(e))},E.prototype.removeSelectedCellsBGImage=function(){return J(".zw-table").removeClass("unselectable_table"),editor.jeditorPane.find("td.selectedCell").removeClass("selectedCell"),this},E.prototype.removeTableSelection=function(){return this.removeSelectedCellsBGImage(),this.setStartCell(null),this.setEndCell(null),delete this._.preCurrTd,this._.isTableSelected=!1,this._.isTableSelectionInProgress=!1,this.setSelectedCells([]),this.collapse(!0)},E.prototype.resetTableSelection=function(){return this.isTableSelected()||J(this.getSelectedTable()).removeClass("unselectable_table"),this._.isTableSelectionInProgress=!1,!1},E.prototype.replace=function(e,t,i){var o=e.getStart(),r=t.nodeValue,n=0,a=[];a.push({r:o});var l=0,s=!1;if(e.nodeValue.length==t.nodeValue.length&&(s=!0,l=e.nodeValue.length),s){for(var d,c=0;c<l;c++){var p=h.getRawFormatAt(o+c);if(p){if(d){var u=DocUtil.getKeys(d);a.push({as:{start:DocUtil.copyStyle(d)}}),a.push({is:r.substring(n,c)}),a.push({as:{end:u}})}else a.push({is:r.substring(n,c)});d=p,n=c}}if(n<c&&(p="",d&&(p=d),p&&a.push({as:{start:DocUtil.copyStyle(p)}}),a.push({is:r.substring(n,c)}),p)){var f=["type"];a.push({as:{end:f}})}}else{var p=h.getRawFormatAt(o);if(p){"section"==p.type&&(p={type:"text"});var u=DocUtil.getKeys(p);a.push({as:{start:DocUtil.copyStyle(p)}}),a.push({is:r}),a.push({as:{end:u}})}else a.push({is:r})}h.getTrackChangeDetails().canHandleTC()&&Op.sendMsg();var g=h.getContent(e.getStart(),e.getEnd());return Op.processMsg([{r:e.getStart()},{ds:g}]),h.getTrackChangeDetails().canHandleTC()&&Op.sendMsg(),Op.processMsg(a),this},E.prototype.resetLastModifiedPosition=function(){return this._.LAST_MODIFIED_POSITION=E.MODIFIED_POSITION_START,this},E.prototype.showCaret=function(e){if(!e)return this;T.trace();for(var t,i=DocTreeManager.doc.sections,r=0;"content"!==i[r].name;)r++;t=i[r];var n=t.getEndIndex();e.end>n&&e.start<=n&&(e.end=n);var a=e.collapsed,l=this.getCorrectedCursorPosition(e.start),s=e.end;return s=a?l:s,e.SID=this.SID,e.addSubscriber(),o.call(this,e),e.setStart(l),e.setEnd(s),e.select(),T.log("SLen",this.length,"RNG",e),this._.LAST_RANGE=this._.PREV_RANGE,this._.PREV_RANGE=e.cloneRange(),this},E.prototype.select=function(){var e=this.toArray();return e.length?this.removeAllRanges().addRanges(e):this},E.prototype.selectAll=function(){PubSub.publish("QuickSeek/hideBarWithID","Selection"),this.isTableSelected()&&this.removeTableSelection();var e=this.getLastRange(),t=h.getSectionStart(e.start),i=h.getSectionEnd(t+1);return t++,e=h.createRange(t,i),e.setFocus(!1),this.removeAllRanges().addRange(e),this.setLastModifiedPosition(E.MODIFIED_POSITION_END)},E.prototype.reArrangeRanges=function(e,t){var i=this.getLastRange();i.setStart(e).setEnd(t);var o=this.toArray();return o=U.unique(o),EventHandler.getUniqueRanges(o),this.removeAllRanges().addRanges(o).mapAllSelectionsToBulletin()},E.prototype.selectAllCells=function(){var e=this.getTargetRange().getStartPortionNode();if(!(this._.selectedTable=J(e).closestParent(NODE_NAME.TABLE)[0]))return this;var t=DocTreeManager.getNode(this.getSelectedTable()),i=t.firstChild().firstChild().getIndex()+1,o=t.lastChild().lastChild().getEndIndex()+1;if(EventHandler.isOnlyCtrlKeyPressed)return this.isCtrlSelection=!0,this.reArrangeRanges(i,o);var r=h.createRange(i,o);return this.removeAllRanges().addRange(r),!this.collaborator&&EditorUtil.focusMultiByteSpan(),this},E.prototype.selectAllListItems=function(e){var t,i=e||this.getLastRange().start,o=DocTreeManager.getParents(NODE_TYPE.PARAGRAPH,i);if(!o||!o.paraProperties||!(t=o.paraProperties.listData))return this;var r=this.setSelectionType(SEL_MOUSE),n=1,a=0,l=DocTreeManager.doc.getSection(i),s=l.lists[t.id]||[],d=t.listType==LIST_TYPE.LOWER_ROMAN||t.listType==LIST_TYPE.UPPER_ROMAN&&!o.paraProperties.isHeadingList;T.log("@selectAllListItems :: list paras",s);var c,p;return U.each(s,function(e){if(T.log("@selectAllListItems",e),e.paraProperties.listData.listLevel===t.listLevel){n&&(r.removeAllRanges(),r._.IS_LIST_ITEM_SELECTION=!0,r._.LIST_LEVEL=t.listLevel,r._.LIST_ID=t.id),T.log("@selectAllListItems :: list level matched",e),i=e.getEndIndex();var o=e.getIndex(),l=h.createRange(i,i+UNICODE.PARA.length);l.setFocus(!1),n?(r.addRange(l),n=0):r.showCaret(l),c=c||l._.isHeaderActived,p=p||l._.isFooterActvied;var s=Math.max(e.paraProperties.listData.listNumOriginalWidth,e.paraProperties.listData.listCharSize.width),u=-1*(d?e.paraProperties.listData.listCharSize.width:0),f=h.getRawFormatAt(i),g=f.dir||"ltr";if("ltr"===g)(f.al&&0!=f.al||d)&&(u+=DocTreeManager.getLeftAtIndex(o)-s),d&&(u-=t.listRight-s),J(".overlay").eq(a++).css({left:u,width:s});else{var m=0;J(".overlay").eq(a++).css({right:m,width:s})}}}),c?Y(this,"header/changed"):p&&Y(this,"footer/changed"),Y(this,"ZWSelection/ListItemSelected"),this.setCursorFormat()},E.prototype.selectAllTextWithCursorFormat=function(){var e=this.getAllRangesWithCursorFormat();return e&&e.length&&(this._.IS_MULTIPLE_SELECTION=!0,this._.TARGET_RANGE=this.getLastRange().cloneRange(),this.removeAllRanges().addRanges(e),this.getTargetRange().select()),Utils.addToStatistics("SIMILAR_TEXT_FORMATTING"),this.mapAllSelectionsToBulletin()},E.prototype.selectCell=function(e){if(!e)return this;var t=DocTreeManager.getNode(e),i=this.getLastRange();return t&&(i.setStart(t.getIndex()+1),i.setEnd(t.getEndIndex()+1),i._.isCellSelection=!0,this._.IS_CELL_SELECTION=!0),this},E.prototype.selectCells=function(){var e=C(this.getStartCell(),this.getEndCell());e.left+=2,e.right-=2,e.bottom-=2,e.top+=2,this.isCtrlSelection||this.setSelectedCells([]);for(var t,i,o,r=DocTreeManager.getNode(this.getSelectedTable()),n=ViewManager.getViewElements(r,editor.getPageID()),a=0,l=n.length;a<l;a++)for(t=J(n[a]).find("td.zw-td"),i=0,o=t.length;i<o;i++){var s=t.eq(i),d=C(s[0]);if(A(e,d)||A(d,e)){if(s.closestParent(NODE_NAME.TABLE)[0]!=J(this.getStartCell()).closestParent(NODE_NAME.TABLE)[0])return;this._.selectedCells.push(DocUtil.getDocElement(s[0])),s.addClass("selectedCell")}else s.removeClass("selectedCell")}return this},E.prototype.selectColumn=function(e){if(!e)return this;var t=J(e).parent().children().index(e),i=DocTreeManager.getNode(J(e).closestParent("table.zw-table")),o=(i.firstChild().children[t].getIndex(),i.lastChild().children[t].getEndIndex()),r=this.getLastRange();return r.setEnd(i&&1==i.children.length?o+1:o),r._.isColumnSelection=!0,r.setFocus(!1),TableResize.setColSelection(!1),this},E.prototype.selectWord=function(){var e=this.getLastRange(),t=e.start;if(h.getCharAt(t)==UNICODE.PARA)return e=h.createRange(t,t+1),this.removeAllRanges().addRange(e);var i=!1,o=e.end;if(t){var r=h.getCharAt(t-1);r==UNICODE.RANGE_START&&(e.setStart(t-1),i=!0)}var n=h.getCharAt(o);if(n==UNICODE.RANGE_END&&(i||e.setStart(t),e.setEnd(o+1),i=!0),i)this.removeAllRanges().addRange(e);else{var a=this.getWord();a.select()}return this},E.prototype.selectRow=function(e){if(e&&e.parentNode){var t=DocTreeManager.getNode(e),i=this.getLastRange();return i.setStart(t.firstChild().getIndex()),i.setEnd(t.lastChild().getEndIndex()+1),i._.isRowSelection=!0,this._.IS_ROW_SELECTION=!0,Utils.addToStatistics("Cell Selection"),this}},E.prototype.setComputedTextFormat=function(){if(this.isListItemSelection){var e=editor.doc.getListObj(this._.LIST_ID),t=this._.LIST_LEVEL;return e["level"+t].paraFormat||(e["level"+t].paraFormat={}),this.computedTextFormat=Utils.mergeObjs([this.textFormat,this.paraFormat.textFormat,DocUtil.copyStyle(e["level"+t].paraFormat.textFormat)||{}]),this}var i=Utils.mergeObjs([this.paraFormat.textFormat,this.textFormat]);return i.hasOwnProperty(ATTR_TEXT.CHAR_STY)&&(i=Utils.mergeObjs([TextStyleObject[i[ATTR_TEXT.CHAR_STY]],i])),this.computedTextFormat=i,this},E.prototype.setCursorFormat=function(){var e,t=this.getLastRange(),i=t.start,o=i;if(this.textFormat=this.paraFormat={},J.isEmptyObject(this.tempCursorFormat)){var r=this.parents(NODE_TYPE.SECTION).getEnd();if(r==o)o-=1;else if(o>0){var n=h.getCharAt(o-1),a=h.getCharAt(o);if(this.isCollapsed()){var l=this.parents(NODE_TYPE.PARAGRAPH),s=h.contStr.substr(l.getStart(),l.getEnd()-l.getStart());s=s.replace(new RegExp(UNICODE.RANGE_START+"|"+UNICODE.RANGE_END,"g"),""),1!=s.length&&n!=UNICODE.PARA&&n!=UNICODE.CELL&&n!=UNICODE.TOCSTART&&n!=UNICODE.SECTION_START&&(o-=1)}else a===UNICODE.RANGE_START&&(o+=1)}if(e=DocUtil.getTextStyle(o)){var d=e[ATTR_COMMON.CLS];if(d)if(d.indexOf("link")!=-1){var c=h.getParents(NODE_TYPE.LINK,i);c||(delete e[ATTR_COMMON.CLS],delete e[ATTR_LINK.LINK_TYPE],delete e[ATTR_LINK.LINK_URL],delete e[ATTR_LINK.LINK_TOOLTIP],delete e[ATTR_LINK.LINK_TARGET])}else if(d.indexOf("comment")!=-1){var p=h.getParents(NODE_TYPE.COMMENT,i);p||delete e[ATTR_COMMON.CLS]}delete e[ATTR_TEXT.TS_SP],delete e[ATTR_TEXT.TS_GR]}else e={type:NODE_TYPE.TEXT};this.textFormat=e}else this.textFormat=DocUtil.copyStyle(this.tempCursorFormat),this.tempCursorFormat={};var u=h.findNextIndexOf(CONT_REGEXP.PARASTART,i);return u<0&&(u=1),e=DocUtil.getParaFormat(u),this.paraFormat=e,this.setComputedTextFormat()},E.prototype.setLastModifiedPosition=function(e){return e!==E.MODIFIED_POSITION_START&&e!==E.MODIFIED_POSITION_END?this:(this._.LAST_MODIFIED_POSITION=e,this)},E.prototype.setSelectionType=function(e){return this.selectionType=e,this},E.prototype.setStartCell=function(e){return this._.startCell=e,this},E.prototype.setEndCell=function(e){return this._.endCell=e,this},E.prototype.setSelectedCells=function(e){return(this.isCtrlSelection||EventHandler.isOnlyCtrlKeyPressed)&&e.length?(this._.selectedCells=this._.selectedCells.concat(e),U.uniq(this._.selectedCells)):this._.selectedCells=e,this},E.prototype.setSelectedTable=function(e){return this._.selectedTable=e,this},E.prototype.setIsTableSelected=function(e){return this._.isTableSelected=e,this},E.prototype.surroundAndInsert=function(e,t,i){var o=this.getLastRange(),r=o.start,n=o.end;if(this.isCollapsed()||h.getCharAt(n-1)!=UNICODE.PARA||(n-=1),e.style||t.style){var a=DocUtil.getKeys(e.style),l=DocUtil.getKeys(t.style),s=Utils.randomString(),d=Utils.randomString(),c=[{r:r},{as:{start:e.style,id:s}},{is:e.char},{as:{end:a,id:s}}];if(i.css){var p=Utils.randomString();c.push({as:{start:i.css,id:p}}),c.push({is:i.nodeValue});var u=i.css,f=DocUtil.getKeys(u);c.push({as:{end:f,id:p}})}else c.push({is:i.nodeValue});c.push({as:{start:t.style,id:d}}),c.push({is:t.char}),c.push({as:{end:l,id:d}})}else{var c=[{r:r},{is:e.char}];if(i.css){var p=Utils.randomString();c.push({as:{start:i.css,id:p}}),c.push({is:i.value});var u=i.css,f=DocUtil.getKeys(u);c.push({as:{end:f,id:p}})}else c.push({is:i.value});c.push({is:t.char})}return Op.processMsg(c),this},E.prototype.surroundTextWith=function(e,t,i){var o=isNaN(i)?this.getTargetRange():this.getRangeAt(i);if(!o)return this;var r,n=o.start,a=o.end;if(h.getCharAt(n)==UNICODE.HR&&a-n==1&&(this.collapse(!0),a=n),this.isCollapsed()||h.getCharAt(a-1)!=UNICODE.PARA||(a-=1),e.style||t.style){var l=DocUtil.getKeys(e.style),s=DocUtil.getKeys(t.style),d=Utils.randomString(),c=Utils.randomString();r=[{r:n},{as:{start:e.style,id:d}},{is:e.char},{as:{end:l,id:d}},{r:a-n},{as:{start:t.style,id:c}},{is:t.char},{as:{end:s,id:c}}]}else r=[{r:n},{is:e.char},{r:a-n},{is:t.char}];return Op.processMsg(r),this},E.prototype.toIntervals=function(){var e=[];return this.each(function(t){e.push([t.start,t.end])}),e},E.prototype.toString=function(){var e="";return t.call(this,function(t){e+=t.toString()}),e},E.prototype.updateCursorFormat=function(e,t){switch(e){case"RemoveFormat":this.textFormat={type:NODE_TYPE.TEXT},this.textFormat[ATTR_TEXT.TS_NULL]=!0;break;default:var i=this.getComputedTextFormat(),o=DocUtil.formatGenerator.getTextFormat(i,e,t);this.textFormat=Utils.mergeObjs([this.textFormat,o])}return this},E.prototype.visitAllNodes=function(e){var i=[];return t.call(this,function(t){i=i.concat(t.visitAllNodesInRange(e))}),i},E.MODIFIED_POSITION_START="start",E.MODIFIED_POSITION_END="end",E.showCollabCursors=function(){J("#hideCollabCursors").remove()},E.isCollabCursorShown=function(){return!document.getElementById("hideCollabCursors")},E.hideCollabCursors=function(){var e=document.getElementById("hideCollabCursors");e||(e=document.createElement(NODE_NAME.STYLE),e.id="hideCollabCursors",e.type="text/css",document.head.appendChild(e)),J(e).text(".otherUserCollapsedCursor,.otherUserCursorStart,.otherUserCursorEnd,.overlay.collaborator{display:none !important;}")},E.enableLogger=function(e){T.enable(e)},E.disableLogger=function(){T.disable()},e.ZWSelection=E;var S=function(e,t,i){for(var o,r=0,n=e.length;r<n;r++)o=e[r],t.apply(this,[o.getStart()+1,o.getEnd()-1].concat(i))},O=function(e,t,i){U.each(e,function(e){i&&i(e);var o=TableUtil.getCellEnd(e.getStart()+1);o>0&&v(e.getStart()+1,o,t)})},v=function(e,t,i){var o=h.createElement(NODE_TYPE.TEXT,"");o.setStart(e),o.setEnd(t),o.attr(i)},b=function(e,t){var i=Object.getOwnPropertyNames(e),o=Object.getOwnPropertyNames(t),r=i.concat(o).removeDuplicates(),n={},a={};extend(n,e),extend(a,t),n=y(n,r),a=y(a,r);for(var l,s=0,d=r.length;s<d;s++)if(l=r[s],n[l]!==a[l])return!1;return!0},A=function(e,t){return(e.left<=t.left&&t.left<e.right||e.left<t.right-2&&t.right-2<=e.right)&&(e.top<=t.top&&t.top<e.bottom||e.top<t.bottom-2&&t.bottom-2<=e.bottom)},y=function(e,t){if(!e||!t)return e;delete e[ATTR_LINK.LINK_URL],delete e[ATTR_TEXT.CLS],delete e[ATTR_TEXT.TS_SP],delete e[ATTR_TEXT.TS_GR],delete e[TCConstants.TC];for(var i,o=0,r=t.length;o<r;o++){if(!e.hasOwnProperty(i=t[o])&&c.hasOwnProperty(i))e[i]=c[i];else if("fgc"==i||"bgc"==i){var n=e[i];0===n.indexOf("rgb")&&(e[i]=zoho.color.rgbToHex(n))}else"none"==e[i]&&(e[i]="normal");e[i]&&(e[i]=e[i].toString())}return e},D=function(e,t,i){U.each(t,function(t){i&&i(t);var o=TableUtil.getCellEnd(t.getStart()+1);o>0&&e.deleteContents(t.getStart()+1,o-1)})},C=function(e,t){var i={},o=J(e).offset();if(i.left=o.left,i.top=o.top,i.right=o.left+e.offsetWidth,i.bottom=o.top+e.offsetHeight,t){var r=J(t).offset(),n=r.left,a=r.top,l=r.left+t.offsetWidth,s=r.top+t.offsetHeight;i.left=n<i.left?n:i.left,i.top=a<i.top?a:i.top,i.right=l>i.right?l:i.right,i.bottom=s>i.bottom?s:i.bottom}return i},I=function(e,t,i){for(var o,r,n,a,l,s,d=e.getAllHeadings(i),c=0,p=d.length,u=[];c<p;c++)l=d[c],o=l.getStart(),r=l.getEnd(),n=h.createRange(o,r),a=n.getNodes(NODE_TYPE.TEXT)[0],s=h.getComputedFormatAt(a?a.getStart():r-1,NODE_TYPE.TEXT,i),b(t,s)&&u.push([o,r]);return u},P=function(e,t){return h.getComputedFormatAt(e,NODE_TYPE.TEXT,t)},_=function(e){var t=h.getSectionEnd(e);if(V(h.getCharAt(e)))return e+1;for(;e<t&&B(h.getCharAt(e));)e++;for(;e<t&&z(h.getCharAt(e));)e++;for(;e<t&&!M(h.getCharAt(e))&&(e++,!F(h.getCharAt(e))););return e},N=function(e,t){if(e<=1)return 1;if(e--,V(h.getCharAt(e),t))return e;for(;e>0&&B(h.getCharAt(e));)e--;for(;e>0&&z(h.getCharAt(e));)e--;for(;e>0&&!M(h.getCharAt(e),t)&&(e--,!F(h.getCharAt(e))););return e+1},L=function(e,t){var i=h.getCharAt(t-1),o=h.getRawFormatAt(t-1),r=h.getCharAt(t-1),n=!0,a=e.parents(NODE_TYPE.PARAGRAPH);if(t==a.getStart()){var l=a.attr(ATTR_PARAGRAPH.PS_DIR)||"ltr",s=a.attr(ATTR_PARAGRAPH.PS_AL),d=a.attr(ATTR_PARAGRAPH.PS_TYPE),c=parseFloat(a.attr(ATTR_PARAGRAPH.PS_ML)),p=a.attr(ATTR_PARAGRAPH.EN_PB),u=parseFloat(a.attr(ATTR_PARAGRAPH.PS_TI));if(l==PARA_DIR.RTL&&(0==s?s=2:2==s&&(s=0)),s&&(0!=s&&l==PARA_DIR.LTR||2!=s&&l==PARA_DIR.RTL)&&3!=s){var f={};f[ATTR_PARAGRAPH.PS_AL]=s-1+"",a.attr(f),n=!1}else if(p&&o[ATTR_PARAGRAPH.EN_PB])n=!1;else if("list"==d&&a.attr(ATTR_PARAGRAPH.LS_DATA)){var g=a.attr(ATTR_PARAGRAPH.LS_DATA);g.l=-1,List.updateListData(g,a,"outdent",!0),n=!1}else if(u&&0!=u){var m={};m[ATTR_PARAGRAPH.PS_TI]="0",a.attr(m),n=!1}else if(c>0&&!a.dtNode.isCode()){var T=(e.parents(NODE_TYPE.BODY),w_usersettings[ATTR_BODY.DS_UN]),E={};E[ATTR_PARAGRAPH.PS_ML]="0"+T,a.attr(E),n=!1}else if(r==UNICODE.HR){var R=e.findPrevious(NODE_TYPE.HR);R.select();var S=e.getFirstRange();S.setStart(R.getStart()),S.setEnd(R.getEnd()),n=!1}else r&&r!=UNICODE.CELL&&r!=UNICODE.TABLEEND&&r!=UNICODE.TABLE&&r!=UNICODE.SECTION_START&&r!=UNICODE.TOCSTART&&r!=UNICODE.TOCEND||(n=!1)}else if(i==UNICODE.IMAGE){if("digisign-field"==o[ATTR_COMMON.ST])return!0;var O=e.findPrevious(NODE_TYPE.IMAGE),S=e.getFirstRange();if(S.setStart(O.getStart()),S.setEnd(O.getEnd()),o.hasOwnProperty(ATTR_IMAGE.I_SHAPEDATA)){var v=o.shapeData.nvOProps.nvDProps.id;InsertShape.select.shape(v),InsertShape.openToolbar(J.ShapeData.getShapeData(v).dropcapData)}else O.select();n=!1}else{if(i==UNICODE.SECTION_START)return!1;if(i==UNICODE.RANGE_END){if(o.type==NODE_TYPE.COMMENT){var S=h.createRange(t-1,t-1);e.removeAllRanges().addRange(S)}else if(o.type===NODE_TYPE.BOOKMARK){if(o.id.indexOf("toc_")!=-1){var S=h.createRange(t-1,t-1);return e.removeAllRanges().addRange(S),!1}}else if(o.type==NODE_TYPE.LINK){var S=e.getFirstRange();S.setStart(DocUtil.getRangeStart(t-1)),Utils.removeAllLinks(),e.collapse(!1)}else{var S=h.createRange(DocUtil.getRangeStart(t-1),t);e.removeAllRanges().addRange(S)}n=!1}else if(i==UNICODE.RANGE_START){if(o.type==NODE_TYPE.COMMENT){var S=h.createRange(t-1,t-1);e.removeAllRanges().addRange(S)}else if(o.type===NODE_TYPE.BOOKMARK){if(o.id.indexOf("toc_")!=-1){var S=h.createRange(t-1,t-1);return e.removeAllRanges().addRange(S),!1}}else{var S=h.createRange(t-1,DocUtil.getRangeEnd(t-1)+1);e.removeAllRanges().addRange(S)}n=!1}}return n},w=function(e,t){var i=h.getCharAt(t),o=h.getRawFormatAt(t),r=h.getCharAt(t+1);if(i==UNICODE.TABLEEND||i==UNICODE.TABLE||i==UNICODE.CELL||i==UNICODE.ROW||i==UNICODE.TOCSTART||i==UNICODE.TOCEND)return!1;if(i==UNICODE.PARA&&r==UNICODE.IFRAME){var n=e.getFirstRange(),a=e.findNext(NODE_TYPE.IFRAME);return n.setStart(a.getStart()),n.setEnd(a.getEnd()+1),!1}if(i==UNICODE.PARA&&r==UNICODE.HR){var l=e.findNext(NODE_TYPE.HR);l.select();var n=e.getFirstRange();return n.setStart(l.getStart()),n.setEnd(l.getEnd()),!1}if(i==UNICODE.IMAGE){if("digisign-field"==o[ATTR_COMMON.ST])return!0;var a=e.findNext(NODE_TYPE.IMAGE),n=e.getFirstRange();if(n.setStart(a.getStart()),n.setEnd(a.getEnd()),o.hasOwnProperty(ATTR_IMAGE.I_SHAPEDATA)){var s=o.shapeData.nvOProps.nvDProps.id;J("#"+s).closestParent(".inner_shape").children(".shapeAnchor").css("display","inline"),ShapeEditor.selectShape(s)}else a.select();return!1}if(i==UNICODE.SECTION_START)return!1;if(i==UNICODE.RANGE_START){if(o.type==NODE_TYPE.COMMENT){var n=h.createRange(t+1,t+1);e.removeAllRanges().addRange(n)}else if(o.type===NODE_TYPE.BOOKMARK){if(o.id.indexOf("toc_")!=-1){var n=h.createRange(t+1,t+1);return e.removeAllRanges().addRange(n),!1}}else{var n=h.createRange(t,DocUtil.getRangeEnd(t)+1);e.removeAllRanges().addRange(n)}return!1}if(i==UNICODE.RANGE_END){if(o.type===NODE_TYPE.COMMENT){var n=h.createRange(t+1,t+1);e.removeAllRanges().addRange(n)}else if(o.type===NODE_TYPE.BOOKMARK){if(o.id.indexOf("toc_")!=-1){var n=h.createRange(t+1,t+1);return e.removeAllRanges().addRange(n),!1}}else{var n=h.createRange(DocUtil.getRangeStart(t),t+1);e.removeAllRanges().addRange(n)}return!1}return!!(i!=UNICODE.PARA||r&&r!=UNICODE.SECTION_START&&r!=UNICODE.CELL&&r!=UNICODE.TABLE&&r!=UNICODE.TABLEEND&&r!=UNICODE.ROW&&r!=UNICODE.TOCSTART&&r!=UNICODE.TOCEND)},M=function(e,t){var i=p[e]||0;return i&&t&&(i=!(d.indexOf(e)>=0)),i},x=new RegExp(WORD_BREAK_CHAR,"gm"),F=function(e){return x.lastIndex=0,x.test(e)},k=function(e){var t=e.parents(NODE_TYPE.PARAGRAPH)||{};return t.dtNode&&t.dtNode.isHeading();},B=function(e){return u[e]||0},H=function(e){return h.getCharAt(e)===UNICODE.RANGE_START},G=function(e){return h.getCharAt(e)===UNICODE.RANGE_END},z=function(e){return a.indexOf(e)>=0},V=function(e,t){var i=t?s:m;return i.indexOf(e)>=0},Y=function(e){if(!e.collaborator){var t=r.call(arguments);t.splice(0,1),PubSub.publish.apply(null,t)}}}(window),EventHandler.logger=new ZWLogger,EventHandler.clickEvt={clkCount:0,pos:{X:0,Y:0},timeout:!1},EventHandler.mouseDown_coord={},EventHandler.mouseLogs=[],EventHandler.isTableColSelection=!1,EventHandler.mouseUpDone=!0,EventHandler.isDialogFocused=!1,EventHandler.plainTextPaste=!1,EventHandler.getIndex=function(e,t,i,o){t||(t=editor.browserInfo.is_ie?e.srcElement:e.target,t instanceof jQuery&&(t=t[0]));var r=Utils.getCorrectedCoord(e),n=r.x,a=r.y;i&&(n=i,a=o,t="zw-contentpane selectableSection"==editor.clientActiveSection.className?Utils.getClosestChild(editor.editorPaneContainer[0],"span.zw-portion",n,a):Utils.getClosestChild(editor.clientActiveSection,"span.zw-portion",n,a));var l=t.id,s=!1,d=J(t),c=e.type;"contextmenu"===c&&(c="mousedown"),l&&l.indexOf("z-cursor-")!=-1&&(t=Utils.getClosestChild(editor.clientActiveSection,"span.zw-portion,span.EOP",n,a),d=J(t)),t.className==CONST.FIELD_TEXT_NODE&&(d=d.parents("span.zw-portion"),t=d[0]),"mousedown"==c&&(EventHandler.isTableColSelection=!1);var p=editor.doc.getSelection(),u=editor.contentpaneOffset.left-10,f="mouseup"==c&&EventHandler.isTableColSelection&&d.closestParent(".zw-td").length;if("mouseup"==c&&(EventHandler.mouseDown_coord.x==n&&EventHandler.mouseDown_coord.y==a||n<u||f)){var g=t?t.className:"";if("object"!=typeof g&&g.indexOf("placeholder")!=-1&&EventHandler.mouseDown_coord.x==n&&EventHandler.mouseDown_coord.y==a)return DocUtil.getFloatElementRange("placeholder",EventHandler.mouseDown_coord.idx+1).end;if(EventHandler.textDragStart){J(editor.clientActiveSection).removeClass("unselectable").addClass("selectableSection");var m=editor.doc.getDomCursorNode(editor.uuid,editor.zuid,"start");m&&m.css("border-left-style",""),EventHandler.moveText()}if(EventHandler.mouseDown_coord.idx){var h=editor.doc.getRawFormatAt(EventHandler.mouseDown_coord.idx-1);editor.doc.getRawFormatAt(EventHandler.mouseDown_coord.idx);if(h&&("bookmark"==h.type||"link"==h.type||"comment"==h.type||"endnote"==h.cls||"footnote"==h.cls)&&t&&"image"!=t.nodeName.toLowerCase()){var T=editor.doc.getCharAt(EventHandler.mouseDown_coord.idx-1),E=editor.doc.getCharAt(EventHandler.mouseDown_coord.idx);T&&T==UNICODE.RANGE_START?EventHandler.mouseDown_coord.idx-=1:E&&E==UNICODE.RANGE_END&&(EventHandler.mouseDown_coord.idx+=1)}}var R=p.getLastRange();p.isListItemSelection||EventHandler.isOnlyCtrlKeyPressed||(EventHandler.logger.log("@getIndex , reachedhere :: ",R.start),R&&R.setStart(EventHandler.mouseDown_coord.idx),EventHandler.logger.log("@getIndex , reachedhere after :: ",R.start));var S=parseFloat(d.parents("div.zw-paragraph").css("margin-left")||0);if(S<0&&(u+=S),n<u){if(R&&R.setEnd(EventHandler.mouseDown_coord.idx),EventHandler.isOnlyCtrlKeyPressed?p.showCaret(R):p.removeAllRanges().addRange(R),t=Utils.getClosestSpan(editor.clientActiveSection,n,a),d=J(t),EventHandler.mouseDown_coord.x==n&&EventHandler.mouseDown_coord.y==a){var O=editor.doc.getCursorPortionNode(editor.uuid,EventHandler.isOnlyCtrlKeyPressed?"end":"start"),v=J(O).closestParent("tr")[0];return v?p.selectRow(v).getEnd():Nav.moveToLineEnd(!0)}var b=CurUtil.getCursorLineOffset(t,!!d.parents(".zw-tr").length),A=CurUtil.getCursorPortionOffset(t);return b+A}return EventHandler.isTableColSelection?p.selectColumn(d.closest(".zw-td")[0]).getEnd():TableResize.isCellSelectionInProgress()?(TableResize.setIsCellSelectionInProgress(!1),p.selectCell(TableResize.getCellSelectionTD()).getEnd()):EventHandler.mouseDown_coord.idx}if("mousedown"==c||"dragover"==c||"mousemove"==c||"mouseup"==c){var y=t.parentNode;if(y){var D=y.id;if(D&&("imgResizeGrid"==D||"wmstoolbar"===D)||"imgResizeGrid"==l|"wmstoolbar"===l)return p.getStart()}var C=ViewManager.getElements("page"),I=C[editor.currentPageIndex];"mousedown"==c&&(EventHandler.mouseDown_coord.x=n,EventHandler.mouseDown_coord.y=a,EventHandler.mouseDown_coord.srcElem=t),EventHandler.setActivePageAndSection(d,n,a),"mousedown"==c&&(EventHandler.mouseDown_coord.activeSection=editor.clientActiveSection);var P=editor.clientActiveSection?editor.clientActiveSection.className:void 0;if(P&&P.indexOf("unselectableSection")!=-1){var _,N=editor.prevClientActiveSection||EventHandler.mouseDown_coord.activeSection,L=editor.doc.getSectionStart(p.getStart()),w=editor.doc.getSectionEnd(p.getStart()),M=N.className,U=editor.clientActiveSection.className;if(!EditorView.isPageView())return M.indexOf("zw-contentpane")!=-1||M.indexOf("zw-endnotepane")!=-1||M.indexOf("zw-footnotepane")!=-1?_=U.indexOf("header_primary")!=-1?L+1:w-1:M.indexOf("header_primary")!=-1?_=w-1:M.indexOf("footer_primary")!=-1&&(_=L+1),editor.currentPageIndex=editor.jeditorPane.children(".zw-page").index(I),editor.clientActiveSection=N,EventHandler.mouseDown_coord.idx=_,EventHandler.mouseDown_coord.isLineEnd=!1,_;editor.clientActiveSection=N;var x=C[editor.currentPageIndex];M.indexOf("zw-contentpane")!==-1?editor.clientActiveSection=Utils.getClosestChild(x,"div.zw-contentpane",n,a):M.indexOf("zw-footnotepane")!=-1||M.indexOf("zw-endnotepane")!=-1?editor.clientActiveSection=Utils.getClosestChild(x,"div.zw-footnotepane,div.zw-endnotepane",n,a):editor.clientActiveSection=Utils.getClosestChild(x,"div.header_primary,div.footer_primary",n,a),t=Utils.getClosestChild(editor.clientActiveSection,"span.zw-portion,span.EOP",n,a),d=J(t)}}var F=d.parents("div.zw-contentpane, div.header_primary, div.footer_primary, div.zw-footnotepane, div.zw-endnotepane")[0],k="mouseup"==c&&F&&F!=editor.clientActiveSection;if(F&&!k||(t=Utils.getClosestChild(editor.clientActiveSection,"span.zw-portion,span.EOP",n,a),d=J(t)),Utils.nodeNameEquals(t,"image")||J(t).hasClass("zw-ifr-div")){s=!0;var B=d.parents("span");if(!B[0])return EventHandler.mouseDown_coord.idx=DocTreeManager.getFloatImageIndex(J(d.parents("div")[0]).attr("pid"),J(d.parents("div")[0]).attr("fid")),EventHandler.mouseDown_coord.idx;t=B[0],d=B}else{if(Utils.nodeNameEquals(t,"path")||0!=d.closestParent("div.inner_shape").length){var H=d.closestParent(".zw-line-div"),b=CurUtil.getCursorLineOffset(H[0]),A=CurUtil.getCursorPortionOffset(H[0]);return EventHandler.mouseDown_coord.idx=b+A,EventHandler.mouseDown_coord.idx}if(DomUtil.isHRDiv(t)){var G=DocUtil.getDocElement(t);return EventHandler.mouseDown_coord.idx=G.getStart()-1,EventHandler.mouseDown_coord.idx}if(!Utils.nodeNameEquals(t,"span")||d.hasClass("zw-bullet")){var R=p.getLastRange();if("mouseup"==c||R.collapsed||p.isTableSelected()||R.isMultipleTablesSelected()||!d.hasClass("overlay")||p.isListItemSelection||EventHandler.isOnlyCtrlKeyPressed||1!=p.length||d.data("range").SID!=editor.uuid||"SHAREDREADCOMMENT"==editor.doc.getRole()||"ANYONELINK_SHAREDREADCOMMENT"==editor.doc.getRole())if(d.hasClass("zw-bullet"))if("mousedown"==c){var z=CurUtil.getCursorLineOffset(t);p.removeAllRanges().showCaret(editor.doc.createRange(z));var V=J("#editorpane").offset().left+editor.doc.bodyFormat.ml.convertor().pixels,O=p.getNodesInSelection(NODE_TYPE.PARAGRAPH)[0]||[],Y=O&&O.dtNode,W=Y&&ViewManager.getViews(Y)[0],j=editor.doc.getRawFormatAt(Y.getEndIndex()),Z=j&&j[ATTR_PARAGRAPH.PS_ML]||0,X=j&&j[ATTR_PARAGRAPH.PS_TI]||0,K=W&&W.column&&W.column.left||0;V+=K,Z=Z.convertor().pixels,X=X.convertor().pixels;var $=Z+X,q=DocTreeManager.lineAtIndex(p.getTargetRange().start),Q=q&&q.left,ee=Y.paraProperties.listData&&Math.max(Y.paraProperties.listData.listCharSize.width,Y.paraProperties.listData.listNumOriginalWidth),te=Y.paraProperties.listData&&Y.paraProperties.listData.listPaddingRight;V=V+$+ee+Q-te;var ie=Y&&Y.paraProperties.listData&&Y.paraProperties.listData.listType;ie!==LIST_TYPE.UPPER_ROMAN&&ie!==LIST_TYPE.LOWER_ROMAN||(V+=ee),e.screenX<=V&&(p.selectAllListItems(),Utils.addToStatistics("List Item Selection"))}else d=d.next("span.zw-portion,span.EOP"),t=d[0];else(d.hasClass("spell-error")||d.hasClass("ui-comment-indication-new")||d.hasClass("overlay")||d.hasClass("replace-overlay")||d.hasClass("lock-overlay")||d.hasClass("icon-tab"))&&(t=t.parentNode,d=J(t));else t=t.parentNode,J(editor.clientActiveSection).removeClass("selectableSection").addClass("unselectable"),p.isTextDrag=!0,EventHandler.textDragStart=!0,EventHandler.textDragRange=p.getLastRange(),EventHandler.textDragSt=p.getStart(),EventHandler.textDragEnd=p.getEnd();var oe=Utils.getBlockParent(t),re=J(oe);if(re.hasClass("zw-cell-container")&&0==re.children(".zw-paragraph:first").length&&(re=re.parents(".zw-td:first"),oe=re[0]),t=Utils.getClosestSpan(oe,n,a),d=J(t),t&&"td"==t.nodeName.toLowerCase()){var Y=DocTreeManager.getNode(t),ne=ViewManager.getViewElements(Y,J(ViewManager.getElements("page")[editor.currentPageIndex]).data("id")),ae=J();J(ne).each(function(){J(this).find(".zw-paragraph:first").length&&(ae=ae.add(this))});for(var le,se=ae.length,de=se,ce=d.offset().top;de>0;de--)if(le=ae.eq(de-1),1==de||le.offset().top<=ce){oe=Utils.getBlockParent(le[0]),t=Utils.getClosestChild(oe,"span.zw-portion",n,a),d=J(t);break}}n=Math.max(n,d.offset().left)}}var b=CurUtil.getCursorLineOffset(t),A=CurUtil.getCursorPortionOffset(t),pe={cursorOffset:b+A};if(!s){d.hasClass("zw-space")&&(d=d.parents("span.zw-portion"),t=d[0]);var ue=d.closest(".zw-line-div"),fe=ViewManager.getView(ue.parent()[0]).nodeLines,q=fe[ue.prevAll(".zw-line-div").length];pe.cursorOffset=DocTreeManager.doc.getIndexAtLeft((n-ue.offset().left)/editor.zoomFactor,q)}var ge=pe.cursorOffset;"mousedown"==c&&TableResize.getColSelection()&&(EventHandler.isTableColSelection=!0);var g=t?t.className:"";if(g&&"object"!=typeof g&&(g.indexOf("auto")!=-1||g.indexOf("mergeField")!=-1||g.indexOf(CONST.NEXTRECORD)!=-1||g.indexOf("placeholder")!=-1)){var r=Utils.getCorrectedCoord(e);if(g.indexOf("placeholder")!=-1){var me=DocUtil.getFloatElementRange("placeholder",ge);if("mousedown"==c)return EventHandler.mouseDown_coord.idx=me.start,me.start}else if(EventHandler.mouseDown_coord.x==n&&EventHandler.mouseDown_coord.y==a){ge=b+A-1;var R=p.getLastRange();R&&R.setStart(ge)}else ge=a>EventHandler.mouseDown_coord.y?DocUtil.getRangeEnd(b+A-1)+1:b+A-1}var he=editor.doc.getDocumentLength();if(ge>he)ge=editor.doc.getSectionStart(p.getStart())+1;else if(0==ge){var oe=Utils.getBlockParent(editor.clientActiveSection);t=Utils.getClosestChild(oe,"span.zw-portion",n,a),d=J(t),n=Math.max(n,d.offset().left),b=CurUtil.getCursorLineOffset(t),A=CurUtil.getCursorPortionOffset(t),ge=b+A+pe.cursorOffset}if("mousedown"==c){var j=q&&q.parent.getParaStyles(),Te=j&&j[ATTR_PARAGRAPH.PS_DIR]===PARA_DIR.RTL||!1,Ee=editor.jeditorPane.offset().left+PUtil.offsetLeft(t)*editor.zoomFactor+d.outerWidth()*editor.zoomFactor;n>Ee&&!Te&&(EventHandler.mouseDown_coord.isLineEnd=!0),EventHandler.mouseDown_coord.portion=t,EventHandler.mouseDown_coord.idx=ge,Utils.addMouseLogs(Utils.getMouseLogs())}else if("mouseup"==c){if(editor.doc.getCharAt(ge)==UNICODE.PARA){var Re=t.className.indexOf("EOP")!==-1?t:t.nextSibling,Se=Re&&Re.getBoundingClientRect()||0;(EventHandler.mouseDown_coord.idx<=ge&&Se.right-Se.width/2<=n||EventHandler.mouseDown_coord.isLineEnd)&&!i&&(ge+=1)}EventHandler.mouseDown_coord.isLineEnd=!1}return ge},EventHandler.btnCopy=function(){CopyUtil.triggerCopyEvent()},EventHandler.btnCut=function(){CopyUtil.triggerCutEvent()},EventHandler.btnPaste=function(e){EventHandler.btnPasteOption=e,PasteUtil.preparePasteDiv(e),document.execCommand("paste",!1,null)},EventHandler.onCopy=function(){editor.doc.execCmd("copy")},EventHandler.onCut=function(){editor.doc.execCmd("cut")},EventHandler.handleShortCuts=function(e,t){var i=e.metaKey,o=e.ctrlKey,r=e.altKey,n=e.shiftKey,t=String.fromCharCode(t).toLowerCase(),a=!1,l=editor.doc.getSelection();if(!r&&n&&(o||i))switch(t){case"v":n&&!editor.browserInfo.is_ie&&(EventHandler.plainTextPaste=!0,PasteUtil.preparePasteDiv())}else if(!i&&!o||r){if(!r&&n&&!o&&!i)if(t==KEYS.INSERT)PasteUtil.destinationFormat=PasteUtil.sourceFormat=PasteUtil.textOnly=!1,PasteUtil.textFormatContent=PasteUtil.sourceFormatContent=PasteUtil.destinationFormatContent="",Toolbar.handleClick(e,"paste");else if(113==e.which){l.isCollapsed()&&l.getWord().select();var s=l.getNodesInSelection(NODE_TYPE.TEXT,l.getStart(),l.getEnd())[0].nodeValue.trim(),d=s.charCodeAt(0),c=s.charCodeAt(1);d<90&&c<90?editor.doc.execCmd("changecase","lower"):d>90&&c>90?editor.doc.execCmd("capitalizeword"):editor.doc.execCmd("changecase","upper")}}else switch(t){case"x":l.isCollapsed()||l.isListItemSelection?Utils.stopEvent(e):EventHandler.onCut(),a=!1;break;case"o":FileOpen.fileOpenDialog(),a=!0;break;case"c":l.isCollapsed()||l.isListItemSelection?(Utils.stopEvent(e),a=!1):EventHandler.onCopy();break;case"v":EventHandler.plainTextPaste=!1,PasteUtil.preparePasteDiv();break;case"s":"REMOTE"!=editor.getEditorType()&&(Utils.stopEvent(e),a=!1);break;case"f":Replace.openFindMenu(),a=!0;break;case"k":l.isListItemSelection?(Utils.stopEvent(e),a=!1):(LinkDialog.openLinkPopup(),a=!0);break;default:a=!1}return a},EventHandler.handleClickEvents=function(e){var t=function(){var e=EventHandler.clickEvt.timeout;e&&clearTimeout(EventHandler.clickEvt.timeout),EventHandler.clickEvt.timeout=0};t();var i=EventHandler.clickEvt.pos;!i||i.X==e.clientX&&i.Y==e.clientY||(EventHandler.clickEvt.clkCount=0);var o=EventHandler.clickEvt.clkCount;if(EventHandler.clickEvt.clkCount=o?o+1:1,EventHandler.clickEvt.pos={X:e.clientX,Y:e.clientY},EventHandler.clickEvt.clkCount>1){var r=editor.browserInfo.is_ie?e.srcElement:e.target,n=r.parentNode;if(n){var a=n.id;if(a&&"imgResizeGrid"==a||"imgResizeGrid"==r.id)return}}2==EventHandler.clickEvt.clkCount?EventHandler.handleDoubleClickEvent(e):3==EventHandler.clickEvt.clkCount&&(EventHandler.handleTripleClickEvent(e),editor.doc.getSelection().setLastModifiedPosition("end"),Utils.stopEvent(e)),EventHandler.clickEvt.timeout=setTimeout(function(){t(),EventHandler.clickEvt.clkCount=0},500)},EventHandler.handleTripleClickEvent=function(e){if(!e.altKey){EventHandler.isBehind=!0,"zw-contentpane selectableSection"!=editor.clientActiveSection.className&&J(".header_content:first, .footer_content:first").find("div.zw-float-behind").css("z-index",10).addClass("zw-float-behind-active");var t=Utils.getCorrectedCoord(e),i=t.x,o=(t.y,editor.doc.getSelection()),r=o.parents(NODE_TYPE.PARAGRAPH),n=editor.contentpaneOffset.left-5,a=editor.browserInfo.is_ie?e.srcElement:e.target;J(a).closestParent("div.zw-paragraph").find("div.zw-float-behind").css("z-index",10).addClass("zw-float-behind-active");var l=editor.doc.getCursorPortionNode(editor.uuid,"start"),s=J(l).closestParent("td")[0],d=J(l).closestParent("tr")[0];if("s-resize"==J(s).css("cursor")&&TableResize.setColSelection(!0),o.isListItemSelection)return o.selectAllListItems();if(i>editor.editorOffset.left&&i<n)return o.selectAll();var c;if(TableResize.isCellSelectionInProgress()||d&&t.x>editor.editorOffset.left&&t.x<n||TableResize.getColSelection())o.selectAllCells(),TableResize.setIsCellSelectionInProgress(!1);else if(r){var p=r.getStart(),u=r.getEnd();EventHandler.isOnlyCtrlKeyPressed?(o.isCtrlSelection=!0,o.reArrangeRanges(p,u)):(c=editor.doc.createRange(r.getStart(),r.getEnd()),o.removeAllRanges().setSelectionType(SEL_MOUSE).addRange(c))}}},EventHandler.handleDoubleClickEvent=function(e){var t=EventHandler.mouseDown_coord.srcElem;if(t){var i=editor.doc.getSelection();if("SHAREDREADCOMMENT"==editor.doc.getRole()||"ANYONELINK_SHAREDREADCOMMENT"==editor.doc.getRole()||editor.doc.paintFormat_dblClick)return i.setSelectionType(SEL_MOUSE).selectWord(),void i.setLastModifiedPosition("end");var o=t.parentNode;if(o){var r=o.id;if(r&&"imgResizeGrid"==r||"imgResizeGrid"==t.id)return}var n=J(t);n.hasClass("ui-hf-dbl-clk")&&(n=n.parent(),t=n[0]),n.hasClass("overlay")&&(t=editor.browserInfo.is_ie?e.srcElement:e.target,n=J(t));var a=Utils.getCorrectedCoord(e),l=a.x,s=a.y;if(t!=editor.doc.getDomCursorNode(editor.uuid,editor.zuid,"start")[0]){var d=(t.id,t.className,editor.contentpaneOffset.left-5);if(a.x>editor.editorOffset.left&&a.x<d){var c=editor.doc.getCursorPortionNode(editor.uuid,"start"),p=J(c).closestParent("tr")[0];if(p)return i.selectAllCells();var u=i.parents(NODE_TYPE.PARAGRAPH),f=u.getStart(),g=u.getEnd();if(EventHandler.isOnlyCtrlKeyPressed)i.isCtrlSelection=!0,i.reArrangeRanges(f,g);else{var m=editor.doc.createRange(f,g);i.removeAllRanges().setSelectionType(SEL_MOUSE).addRange(m)}return}EventHandler.setActivePageAndSection(n,l,s)}var h,T=editor.clientActiveSection.className,E=!1;if(T&&T.indexOf("unselectableSection")==-1){var R=n.parents("div.zw-column").find("div.zw-paragraph:visible").last();if(R[0]||(R=n.parent().find("div.zw-column").find("div.zw-paragraph:visible").last()),!n.parents().hasClass("zw-table")&&R[0]){var S=Utils.getCorrectedCoord(e),O=R.offset().top+R.height()*editor.zoomFactor,v=i.parents(NODE_TYPE.PARAGRAPH);if(T&&T.indexOf("zw-contentpane")!=-1&&S.y>O)return void EventHandler.addNewParas(S,v,R);if(v.getEnd()-v.getStart()==1)return void EventHandler.insertTabInEmptyPara(S,v)}var c=editor.doc.getCursorPortionNode(editor.uuid,"start"),b=J(c).closestParent("td")[0];if(b)for(var A,y,D=DocTreeManager.getNode(b),C=ViewManager.getViews(D),I=C.length,P=0;P<I;P++)A=C[P].el,y=J(A).css("cursor"),"ne-resize"==y?TableResize.setIsCellSelectionInProgress(!0):"s-resize"==y&&TableResize.setColSelection(!0);if(e.altKey&&i.parents(NODE_TYPE.TABLE)||TableResize.getColSelection())i.selectAllCells();else if(TableResize.isCellSelectionInProgress()){var f=ViewManager.getView(J(J(b).parent()).find("td:first")[0]).node.getIndex(),g=i.selectRow(J(b).parent()[0]).getEnd();EventHandler.isOnlyCtrlKeyPressed?(i.isCtrlSelection=!0,i.reArrangeRanges(f,g)):i.removeAllRanges().addRange(editor.doc.createRange(f,g))}else i.isListItemSelection?i.selectAllListItems():i.setSelectionType(SEL_MOUSE).selectWord();return void i.setLastModifiedPosition("end")}EditorUtil.isCursorInHeaderFooter()?(PanelUtil.openHeaderFooter(),editor.jeditorPane.find("div.header_primary,div.footer_primary").removeClass("unselectableSection").addClass("selectableSection"),h=EventHandler.getIndex(e,t),E=!0):(PanelUtil.closeHeaderFooter(!1),editor.jeditorPane.find("div.zw-contentpane").removeClass("unselectableSection").addClass("selectableSection"),editor.jeditorPane.find("div.zw-endnotepane").removeClass("unselectableSection").addClass("selectableSection"),editor.jeditorPane.find("div.zw-footnotepane").removeClass("unselectableSection").addClass("selectableSection"),h=EventHandler.getIndex(e),E=!0),ShapeEditor.clear(),editor.prevClientActiveSection=editor.clientActiveSection;var m=editor.doc.createRange(h);i.removeAllRanges().addRange(m),E&&EventHandler.toggleSection(),PubSub.publish("Document/SwitchSection")}},EventHandler.handleMouseEvents=function(e){var t=e.type,i=editor.browserInfo.is_ie?e.srcElement:e.target,o=!1,r=!1,n=!1,a=(i.id,i.className&&"string"==typeof i.className),l=J(i),s=i.nodeName.toLowerCase();if(editor.scrollOn=!1,EventHandler.isOnlyCtrlKeyPressed=!e.altKey&&!e.shiftKey&&(editor.browserInfo.is_mac?!e.ctrlKey&&e.metaKey:e.ctrlKey),!editor.isEditable())return!0;i.className==CONST.FIELD_TEXT_NODE&&(l=l.parents("span.zw-portion"),i=l[0],a=i.className?i.className.toLowerCase():""),editor.browserInfo.is_ie?e.button<2?o=!0:4==e.button?n=!0:r=!0:e.which<2?o=!0:2==e.which?n=!0:r=!0;var d=editor.doc.getSelection(),c=/^(tableProp|headeredit|footeredit)$/.test(i.id);if("mousemove"==t){EventHandler.textDragStart||editor.imgDrag||!d.isTableSelectionInProgress()||TableResize.isInProgress()||d.mouseMove(e);var p=editor.contentpaneOffset.left-10,u=parseFloat(l.parents("div.zw-paragraph").css("margin-left")||0);u<0&&(p+=u);var f=Utils.getCorrectedCoord(e);editor.editorOffset.left<f.x&&f.x<p&&TableVisualCueHandler&&!TableVisualCueHandler.isOpen()?editor.editorPaneContainer.css("cursor","ne-resize"):editor.editorPaneContainer.css("cursor",""),EventHandler.textDragStart&&EventHandler.moveCursor(e)}else if("mousedown"==t){if(editor.currentCommand=COMMAND.ANY,EventHandler.mouseDown=!0,WordComplete.removeSuggestion(),EventHandler.mutiByteTyping&&EditorUtil.flushContents(),EventHandler.handleClickEvents(e),EventHandler.clickEvt.clkCount>1)return;if(!TableResize.isColumnResize()&&!TableResize.isRowResize()&&!e.shiftKey&&EventHandler.clickEvt.clkCount<=1&&!c){var g=d.isListItemSelection;r||(d.isListItemSelection=!1);var m=EventHandler.getIndex(e);if(l.hasClass("overlay")&&d.length>1&&EventHandler.isOnlyCtrlKeyPressed){var h=d.hasIntersectRange(editor.doc.createRange(m));if(h!==-1)return}var T=d.getLastRange();if(EventHandler.logger.log("@mousedown :: sel.length --> ",d.length),g||!EventHandler.isOnlyCtrlKeyPressed||d.isCollapsed())g&&(EventHandler.isOnlyCtrlKeyPressed=!1),T&&T.setStart(m)&&T.setEnd(T.start),EventHandler.logger.log("non-ctrl sel @mousedown : start --> ",T.start),EventHandler.logger.log("@mousedown (after getIndex ):: sel.length --> ",d.length);else{var E=editor.doc.createRange(m);EventHandler.logger.log("ctrl-sel @mousedown ",E),E&&d.hasIntersectRange(E)==-1&&d.showCaret(E),EventHandler.logger.log("@mousedown :: sel.length --> ",d.length)}if(EventHandler.textDragStart||EventHandler.isOnlyCtrlKeyPressed||T.remove(),r){if(l.hasClass("embedobj-play-icon")||l.parent().hasClass("zw-float-behind-active"))return;d.isListItemSelection?d.selectAllListItems():d.setSelectionType(SEL_MOUSE).select(),PubSub.publish("Selection/updateClientLeft")}}var R=!1;d.isTableSelected()&&(R=!0,EventHandler.isOnlyCtrlKeyPressed||d.removeTableSelection()),("td"==s||l.parents("td").get(0))&&(R||"SHAREDREADCOMMENT"==editor.doc.getRole()||"ANYONELINK_SHAREDREADCOMMENT"==editor.doc.getRole()||TableResize.mouseDown(e),d.mouseDown(e,r)),PubSub.publish("Editor/MouseDown",m)}else if("mouseup"==t&&!EventHandler.isInline){if(EventHandler.mouseDown=!1,(!TableResize.isInProgress()||!TableResize.isColumnResize()&&!TableResize.isRowResize())&&EventHandler.clickEvt.clkCount<=1&&!c){EventHandler.logger.log("@mouseup :: sel.length --> ",d.length);var S=EventHandler.getIndex(e);if(l.hasClass("overlay")&&d.length>1&&EventHandler.isOnlyCtrlKeyPressed&&EventHandler.clickEvt.clkCount<=1){var h=d.hasIntersectRange(editor.doc.createRange(S));if(h!==-1&&S===EventHandler.mouseDown_coord.idx)return EventHandler.logger.log("@mouseup : intersectedRangeIndex -->",h),void d.removeRangeAt(h)}var O=d.getStart();if(!EventHandler.textDragStart){var v=d.isTableSelected()&&document.elementFromPoint(e.clientX,e.clientY)||void 0;EventHandler.logger.log("@mouseup : tableSelected --> "+!!v+" :: index --> ",O),O=v&&!d.isCellSelection&&EventHandler.getIndex(e,v)||S}if(!d.isListItemSelection){var T=d.getLastRange();e.shiftKey&&"start"==d.getLastModifiedPosition()?T.setStart(O)&&T.setEnd(T.end):T.setEnd(O),O>T.start?d.setLastModifiedPosition("end"):d.setLastModifiedPosition("start")}if(editor.prevClientActiveSection!=editor.clientActiveSection&&(EventHandler.toggleSection(),editor.prevClientActiveSection=editor.clientActiveSection),jQuery.isEmptyObject(editor.doc.paintFormat)){if(EventHandler.textDragStart&&!d.isListItemSelection)EventHandler.moveText();else{if(d.isListItemSelection)d.selectAllListItems();else if(d.length>1)if(EventHandler.isOnlyCtrlKeyPressed){var b=d.toArray();b=U.unique(b),!d.isTableSelected()&&EventHandler.getUniqueRanges(b),EventHandler.logger.log("@mouseup (ctrl -key pressed) ::  final selections :: ",b),d.isCtrlSelection=!0,d.removeAllRanges().addRanges(b).mapAllSelectionsToBulletin(),2==d.length&&Utils.addToStatistics("Control Selection")}else EventHandler.logger.log("@mouseup (non-ctrl key) ::  final selections :: ",T),d.removeAllRanges().setSelectionType(SEL_MOUSE).addRange(T);else EventHandler.logger.log("@mouseup ::  final selections :: ",d.toArray()),EventHandler.logger.log("@mouseup :: lastRange :: ",d.getLastRange().start,d.getLastRange().end),d.setSelectionType(SEL_MOUSE).select();editor.handleScroll()}PubSub.publish("Selection/updateClientLeft")}else EventHandler.applyStoredFormat()}if(d.resetTableSelection(),EventHandler.isBehind&&EventHandler.clickEvt.clkCount<=1&&!l.parent().hasClass("zw-float-behind-active")&&(J("div.zw-float-behind-active").removeClass("zw-float-behind-active").css("z-index",0),EventHandler.isBehind=!1),TableResize.isInProgress()&&(TableResize.isColumnResize()||TableResize.isRowResize())?(TableResize.mouseUp(e),TableResize.setIsProgress(!1)):TableResize.isInProgress()&&TableResize.setIsProgress(!1),d.isTableSelected()){d.removeSelectedCellsBGImage();var T=d.getLastRange();T&&T.setStart(d.getStartCell().getStart()+1)&&T.setEnd(d.getEndCell().getEnd())}PubSub.publish("Editor/MouseUp",O)}},EventHandler.getUniqueRanges=function(e){for(var t,i,o=0;o<e.length;o++){i=e[o];for(var r,n=0;n<e.length;n++)o!=n&&i.isIntersectWithRange(e[n])&&(r=e[n],t=editor.doc.createRange(Math.min(i.start,r.start),Math.max(i.end,r.end)),n>o?(e.splice(n,1),e.splice(o,1)):(e.splice(o,1),e.splice(n,1)),e.push(t))}},EventHandler.insertPara=function(){var e,t,i=editor.doc.getSelection(),o=i.isListItemSelection;o?(t=i.getFirstRange(),e=i.getNodesInSelection(NODE_TYPE.PARAGRAPH)[0]):(t=i.getLastRange(),e=i.parents(NODE_TYPE.PARAGRAPH));var r,n,a=e.getStart(),l=e.getEnd(),s=!1,d=!1,c=Utils.randomString();if(WordComplete.isSuggestionShown())WordComplete.insertSuggestion();else if("list"==e.attr(ATTR_PARAGRAPH.PS_TYPE)&&DocUtil.isEmpty(e))Command.exec("InsertChar",{cmd:"outdent",element:!0});else if(DocUtil.isEmpty(e)&&e.dtNode.isCode())editor.doc.execCmd("uncode");else{editor.lastOperation="Ins Para";var p=t.start,u=t.end;n=p,editor.doc.getCharAt(p)!=UNICODE.RANGE_START&&editor.doc.getCharAt(p)!=UNICODE.RANGE_END||(n=DocUtil.getTextStyleEnd(p),n>l&&(n=l-1,p=u=n,t=editor.doc.createRange(p),i.removeAllRanges().addRange(t)));var f=DocUtil.copyStyle(editor.doc.getRawFormatAt(p));f.hasOwnProperty(ATTR_TEXT.TS_AUTO_COREECT)&&(delete f[ATTR_TEXT.TS_AUTO_COREECT],editor.doc.setFormatAt(p,f));var g={},m={};if(f&&f[ATTR_PARAGRAPH.PS_HD]&&parseInt(f[ATTR_PARAGRAPH.PS_HD])>0&&105!=parseInt(f[ATTR_PARAGRAPH.PS_HD]))d=!0,g=DocUtil.copyStyle(f),m.type=NODE_TYPE.PARAGRAPH,m[ATTR_PARAGRAPH.PS_HD]=0,m[ATTR_TEXT.TS_NULL]=!0,m[ATTR_PARAGRAPH.PS_NULL]=!0,m[ATTR_PARAGRAPH.PS_TS]={};else if("list"===e.attr(ATTR_PARAGRAPH.PS_TYPE)){var g=DocUtil.copyStyle(editor.doc.getRawFormatAt(l-1));s=!0,r=DocUtil.copyStyle(i.textFormat),i.tempCursorFormat=r,editor.doc.getCharAt(u)===UNICODE.PARA&&g.ls_data&&g.ls_data.hasOwnProperty("state")&&(m.type=NODE_TYPE.PARAGRAPH,m[ATTR_PARAGRAPH.LS_DATA]=DocUtil.copyStyle(g[ATTR_PARAGRAPH.LS_DATA]),m[ATTR_PARAGRAPH.LS_DATA].state=0)}else g=DocUtil.copyStyle(editor.doc.getRawFormatAt(l-1)),g[ATTR_PARAGRAPH.PS_HD]&&0==parseInt(g[ATTR_PARAGRAPH.PS_HD])&&delete g[ATTR_PARAGRAPH.PS_HD],editor.doc.getCharAt(u)==UNICODE.PARA?(m=DocUtil.copyStyle(g),m[ATTR_PARAGRAPH.PS_TS]=i.textFormat):p==a&&(g[ATTR_PARAGRAPH.PS_TS]=i.textFormat);Utils.afterSpaceOperations("",!0),t=!o&&editor.doc.getSelection().getLastRange()||t,p=t.start,i.isCollapsed()||(0==p&&u-p==1?t.setStart(u):(i.isTableSelected()||u>p&&!o)&&i.deleteSelectedContents()),g.hasOwnProperty(TCConstants.TC)&&delete g[TCConstants.TC],m.hasOwnProperty(TCConstants.TC)&&delete m[TCConstants.TC],g.hasOwnProperty(ATTR_PARAGRAPH.PS_DROPCAP)&&(J.isEmptyObject(m)&&(m=DocUtil.copyStyle(g)),m[ATTR_PARAGRAPH.PS_DROPCAP]=""),m.hasOwnProperty(ATTR_PARAGRAPH.EN_BL)&&(m[ATTR_PARAGRAPH.EN_BL]=!1),m.hasOwnProperty(ATTR_PARAGRAPH.EN_WO)&&(m[ATTR_PARAGRAPH.EN_WO]=!1),m[ATTR_PARAGRAPH.PS_TS]&&m[ATTR_PARAGRAPH.PS_TS].hasOwnProperty(TCConstants.TC)&&delete m[ATTR_PARAGRAPH.PS_TS][TCConstants.TC],p=t.start;var h=[{r:o?a:p},{as:{start:g,id:c}},{is:UNICODE.PARA},{as:{end:DocUtil.getKeys(g),id:c}}];if(c=Utils.randomString(),J.isEmptyObject(m)||(h.push({r:l-1-p}),h=h.concat({as:{start:m,id:c}},{r:1},{as:{end:DocUtil.getKeys(m),id:c}})),g[ATTR_PARAGRAPH.PS_HD]&&parseInt(g[ATTR_PARAGRAPH.PS_HD])>0&&105!=parseInt(g[ATTR_PARAGRAPH.PS_HD])&&!i.isCollapsed()&&!d){var T=Utils.randomString(),E="toc_"+Utils.randomString(),R={};R[ATTR_COMMON.TYPE]=NODE_TYPE.BOOKMARK,R[ATTR_COMMON.ID]=E,R[ATTR_COMMON.NAME]=T;var S={};S[ATTR_COMMON.TYPE]=NODE_TYPE.BOOKMARK,S[ATTR_COMMON.ID]=E;var O=Utils.randomString(),v=Utils.randomString();h=h.concat({as:{start:R,id:O}},{is:UNICODE.RANGE_START},{as:{end:["type",ATTR_COMMON.ID,ATTR_COMMON.NAME],id:O}},{r:l-p-1},{as:{start:S,id:v}},{is:UNICODE.RANGE_END},{as:{end:["type",ATTR_COMMON.ID],id:v}})}Op.processMsg(h),Op.sendMsg();var b=t.start;b&&editor.doc.getCharAt(b)==UNICODE.BR&&editor.doc.getCharAt(b-1)==UNICODE.PARA&&(EventHandler.mouseDown_coord.isLineEnd=!0,EventHandler.mouseDown_coord.portion=J(editor.doc.getCursorPortionNode()).parents("div.zw-paragraph").find("span.zw-portion,span.EOP")[0],i.removeAllRanges().addRange(t)),Utils.scrollElementIntoView(editor.doc.getDomCursorNode(editor.uuid,editor.zuid,"start")[0])}},EventHandler.handleEnter=function(e){var t=(e.type,e.shiftKey),i=e.metaKey,o=(e.altKey,e.ctrlKey),r=(e.keyCode,!1);if(i||o)return!1;if(CropImage.isCropImageActive())return CropImage.removeCrop(),!1;var n=editor.doc.getSelection(),a=n.getLastRange(),l=n.parents(NODE_TYPE.PARAGRAPH),s=l.getStart(),d=l.getEnd(),c=n.isCollapsed(),p=a.end==d-1,u=editor.doc.getContent(s,d).replace("\n",""),f=new RegExp(/^(=table\([1-9][0-9]*[,][1-9][0-9]*\))$/),g=new RegExp(/^=rand\(([0-9]|[1-9][0-9]|[1][0-9][0-9]|200)\)$/),m=new RegExp(/^=rand\([0-9]*,([0-9]|[1-9][0-9]|[1][0-9][0-9]|)\)$/),h=new RegExp(/^=code\([a-z|A-Z]*\)$/),T=l.dtNode;if(c&&p&&T&&!T.isCode()&&(/^===$/.test(u)||/^---$/.test(u)||/^___$/.test(u)||/^\*\*\*$/.test(u))){n.deleteContents(l.getStart(),l.getEnd()-1);var E=T.prev?T.prev:null,R={};R[ATTR_COMMON.BORDERS]={},R[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM]={},u.indexOf("-")!=-1?(R[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM][ATTR_BORDERS.TYPE]="solid",R[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM][ATTR_BORDERS.WIDTH]="1px"):u.indexOf("_")!=-1?(R[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM][ATTR_BORDERS.TYPE]="solid",R[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM][ATTR_BORDERS.WIDTH]="2px"):u.indexOf("*")!=-1?(R[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM][ATTR_BORDERS.TYPE]="dotted",R[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM][ATTR_BORDERS.WIDTH]="3px"):(R[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM][ATTR_BORDERS.TYPE]="double",R[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM][ATTR_BORDERS.WIDTH]="3px"),R[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM][ATTR_BORDERS.COLOR]="rgb(0,0,0)",E&&"para"==E.type?(E=l.previousSibling(),editor.doc.execCmd("applyStyle",[E,R,"applyParaStyle"])):editor.doc.execCmd("applyStyle",[l,R,"applyParaStyle"])}else c&&p&&/^[+][-+]*[+]$/.test(u)?editor.doc.execCmd("insautotable",[l,u]):c&&p&&/^[+][\t+]*[+]$/.test(u)?editor.doc.execCmd("insautotable",[l,u,UNICODE.TAB]):c&&p&&f.test(u)?editor.doc.execCmd("insautotable",[l,u,"rand"]):c&&p&&(g.test(u)||m.test(u))?editor.doc.execCmd("ins_random_text",l):c&&p&&h.test(u)?editor.doc.execCmd("ins_random_code",l):t||o?o||Command.exec("InsertChar",{cmd:"insbr"}):(editor.doc.updateLastAction("inspara"),EventHandler.insertPara());return EditorUtil.focusMultiByteSpan(),r=!0},EventHandler.handleKeyDown=function(e){var t=e.type,i=e.keyCode,o=!1,r=e.metaKey,n=e.ctrlKey,a=e.altKey,l=e.shiftKey;editor.currentCommand=COMMAND.ANY,editor.currentKey=i;var s=!1,d=/[a-z(0-9){,1} ,\.]/i.test(i);editor.scrollOn=!1,i>=33&&i<=40&&(s=!0);var c=editor.doc.getSelection();if(l||n||r||a||s||c.resetLastModifiedPosition(),Widget.isTargetWidget()){var p=c.getLastRange();p&&p.setEnd(p.start+1)}var u=Resize.getTargetImg();if(u)if(DomUtil.isHRDiv(u)){var f=DocUtil.getDocElement(u);if(f){var p=c.getLastRange();p&&p.setStart(f.getStart())&&p.setEnd(f.getEnd())}}else{var p=c.getLastRange();p&&p.setEnd(p.start+1)}if(EventHandler.isDocumentMenuOpened){if(38==i||40==i)return Utils.stopEvent(e),!1;J("#documentmenu").hide(),EventHandler.isDocumentMenuOpened=!1}if(n||i!=KEYS.TAB)if(i==KEYS.ENTER)o=!a&&EventHandler.handleEnter(e);else if(i==KEYS.BACKSPACE){var t="prevchar";(editor.browserInfo.is_mac&&(r||a)||!editor.browserInfo.is_mac&&n&&!a)&&c.isCollapsed()&&(t="prevword"),editor.doc.execCmd("delete",t),Utils.stopEvent(e),o=!0}else if(i==KEYS.DELETE){var t="nextchar";(editor.browserInfo.is_mac&&(r||a)||!editor.browserInfo.is_mac&&n&&!a)&&c.isCollapsed()&&(t="nextword"),editor.doc.execCmd("delete",t),o=!0}else e.keyCode==KEYS.ESC?(EditorView.isFullView()&&EditorView.gotoFullView(),InsertShape.isDrawingMode&&(PubSub.publish("Gridlines/hide"),J("#inner_shape").css({width:"0",height:"0px"}),editor.jeditorPane.children(".zw-page").css("cursor","default"),J(editor.clientActiveSection).css({"-moz-user-select":"default"}),InsertShape.isDrawingMode=!1,InsertShape.isTextBox&&(J(".ui-textbox").removeClass("ui-state-highlight"),InsertShape.isTextBox=!1)),CropImage.isCropImageActive()&&CropImage.removeCrop(),o=!0):e.keyCode==KEYS.CAPS||e.keyCode==KEYS.INSERT?o=!0:i==KEYS.SPACE||(n||r||a||l)&&(l&&n&&r&&a&&"220"==i&&Debugger.enable(),i!=KEYS.CTRL&&i!=KEYS.ALT&&i!=KEYS.SHIFT&&(d=/[a-z(0-9){,1} ,\.]/i.test(i),o=EventHandler.handleShortCuts(e,i)));else!l&&WordComplete.isSuggestionShown()?WordComplete.insertSuggestion():(c.isListItemSelection?editor.doc.execCmd(l?"outdent":"indent"):TabKeyHandler.tabKeyHandling(l),l&&!c.isCollapsed()&&CurUtil.stopBlinking()),o=!0;return o},EventHandler.moveText=function(e){editor.lastOperation="Drag and Drop";var t=editor.doc.getSelection(),i=t.getLastRange();t.isTextDrag=!1,i.remove(),J(editor.clientActiveSection).removeClass("unselectable").addClass("selectableSection");var o=editor.doc.getDomCursorNode(editor.uuid,editor.zuid,"start");o&&o.css("border-left-style","");var r=i.start;if(e||(EventHandler.textDragSt=t.getCorrectedCursorPosition(EventHandler.textDragSt),EventHandler.textDragEnd=t.getCorrectedCursorPosition(EventHandler.textDragEnd)),EventHandler.textDragSt<=r&&r<=EventHandler.textDragEnd)EventHandler.textDragStart=!1,i&&i.setStart(i.end)&&t.removeAllRanges().addRange(i);else{var n=editor.doc.createRange(EventHandler.textDragSt,EventHandler.textDragEnd).getSelectedOps();if(!n.length)return EventHandler.textDragStart=!1,void t.removeAllRanges().addRange(i);if(i=editor.doc.createRange(EventHandler.textDragSt,EventHandler.textDragEnd),t.removeAllRanges().addRange(i),i.isPartialTableSelected()){var a=editor.doc.getParents(NODE_TYPE.TABLE,t.getStart()),l=editor.doc.getParents(NODE_TYPE.TABLE,t.getEnd()),s=a?TableUtil.getTableStart(t.getStart()):0,d=l?TableUtil.getTableEnd(t.getEnd()):0;if(t.deleteSelectedContents(),a&&s&&s<EventHandler.textDragSt&&EventHandler.textDragEnd>=a.getEnd()){n.shift();var c=DocUtil.copyStyle(t.parents(NODE_TYPE.TABLE,"start").attr()),p=DocUtil.getKeys(c),u=DocUtil.copyStyle(t.parents(NODE_TYPE.ROW,"start").attr()),f=DocUtil.getKeys(u),g=DocUtil.copyStyle(t.parents(NODE_TYPE.CELL,"start").attr()),m=DocUtil.getKeys(g),h=DocUtil.getParaStyle(r),T=DocUtil.getKeys(h),E=Utils.randomString(),R=Utils.randomString(),S=Utils.randomString(),O=Utils.randomString(),v=[{r:r},{as:{start:h,id:E}},{is:UNICODE.PARA},{as:{end:T,id:E}},{as:{start:c,id:R}},{is:UNICODE.TABLE},{as:{end:p,id:R}},{as:{start:u,id:S}},{is:UNICODE.ROW},{as:{end:f,id:S}},{as:{start:g,id:O}},{is:UNICODE.CELL},{as:{end:m,id:O}}];n=v.concat(n)}else if(l&&d&&d>EventHandler.textDragEnd){var h={type:"paragraph"},b=editor.doc.getParents(NODE_TYPE.PARAGRAPH,EventHandler.textDragEnd);b&&(h=DocUtil.copyStyle(b.attr("*")));var T=DocUtil.getKeys(h);n[0].r=r;var A=Utils.randomString();n.push({as:{start:h,id:A}},{is:UNICODE.PARA},{as:{end:T,id:A}},{is:UNICODE.TABLEEND})}}else{var y=editor.doc.getContent(EventHandler.textDragSt,EventHandler.textDragEnd);t.deleteSelectedContents(),n[0].r=r,Op.resetCursorPos();var D=r;D>EventHandler.textDragSt&&!TrackChangeDetails.isEnabled()&&(D-=y.length),Op.fillCursorPos(D,D+y.length)}EventHandler.textDragStart=!1,Op.processMsg(n),Op.sendMsg()}EventHandler.textDragRange&&EventHandler.textDragRange.remove()},EventHandler.moveCursor=function(e,t,i){var o=editor.doc.getDomCursorNode(editor.uuid,editor.zuid,"start");o&&o.css("border-left-style","dotted");var r;r="drag"==e.type?EventHandler.getIndex(e.originalEvent):EventHandler.getIndex(e,"",t,i);var n=editor.doc.getSelection();r=n.getCorrectedCursorPosition(r);var a=n.getLastRange();if(a&&a.setStart(r)&&a.setEnd(r),"mousemove"==e.type&&!(EventHandler.textDragSt<r&&r<EventHandler.textDragEnd)){var l=n.getWord(),s=l.getStart(),d=l.getEnd(),c=(s+d)/2;d-s>1&&r!=s&&(r=r<c?s:d)}a=editor.doc.createRange(r),n.removeAllRanges().addRange(a)},EventHandler.moveCursorToParaStart=function(e,t,i){var o=EventHandler.getIndex(e,"",t,i),r=editor.doc.getSelection();o=r.getCorrectedCursorPosition(o);var n=editor.doc.getParents(NODE_TYPE.PARAGRAPH,o);o=n.getStart();var a=editor.doc.createRange(o);r.removeAllRanges().addRange(a)},EventHandler.updatePageCount=function(e){J("#totalPage").text("of "+ViewManager.getPageCount())},PubSub.subscribe("page/removed",EventHandler.updatePageCount),PubSub.subscribe("page/created",EventHandler.updatePageCount),EventHandler.toggleSection=function(){editor.doc.clearLastAction();var e=DocTreeManager.doc.getSection(editor.doc.getSelection().getStart()),t=e.name;t.indexOf("header")!=-1||t.indexOf("footer")!=-1?(t="hdrfooter",editor.jeditorPane.find("div.zw-contentpane").removeClass("selectableSection").addClass("unselectableSection"),editor.jeditorPane.find("div.zw-endnotepane").removeClass("selectableSection").addClass("unselectableSection"),editor.jeditorPane.find("div.zw-footnotepane").removeClass("selectableSection").addClass("unselectableSection"),editor.jeditorPane.find("div.footer_primary").removeClass("unselectableSection").addClass("selectableSection ui-hf-border-blue"),editor.jeditorPane.find("div.header_primary").removeClass("unselectableSection").addClass("selectableSection ui-hf-border-blue")):(t.indexOf("content")!=-1?t="contentpane":t.indexOf("endnote")==-1&&t.indexOf("footnote")==-1||(t="notesectionpane"),editor.jeditorPane.find("div.footer_primary").removeClass("selectableSection ui-hf-border-blue").addClass("unselectableSection"),editor.jeditorPane.find("div.header_primary").removeClass("selectableSection ui-hf-border-blue").addClass("unselectableSection"),editor.jeditorPane.find("div.zw-contentpane").removeClass("unselectableSection").addClass("selectableSection"),editor.jeditorPane.find("div.zw-endnotepane").removeClass("unselectableSection").addClass("selectableSection"),editor.jeditorPane.find("div.zw-footnotepane").removeClass("unselectableSection").addClass("selectableSection")),PubSub.publish("Document/SectionChanged",t)},EventHandler.dropImage=function(e){for(var t,i=e.originalEvent?e.originalEvent.dataTransfer.files:e.dataTransfer.files,o=0;t=i[o++];)if(0!=t.size&&Utils.isImage(t)){PubSub.publish("DocOperation/BeforeDropImage");var r={imageByte:"",fileName:t.name};"REMOTE"==editor.getEditorType()?r.docId=editor.doc.getDocInfo().DOCUMENT_ID:r.rid=editor.doc.getDocInfo().RID,Utils.setCsrfParam(r);var n=new FileReader;n.onload=function(e){return function(e){var t=Utils.getUrl("uploadImageFile");r.imageByte=e.target.result;var i={onprogress:function(){},success:function(e){var t=editor.browserInfo.is_ie?e:jQuery.parseJSON(e),i=t.validation;if("success"==i){r={};var o=t.uploadedFileUrl,n=document.createElement("img");JImg=J(n),document.body.appendChild(n),n.src=editor.base_url+"/"+o,JImg.one("load",function(){JImg.unbind("load");var e=n.width,t=n.height,i=t,r=e,a={};a[ATTR_COMMON.TYPE]="image",a[ATTR_IMAGE.I_SRC]=o,a[ATTR_IMAGE.I_OP]="100%";var l=editor.doc.getPaperWidth();e>l&&(r=l,JImg.width(r),i=t/e*l),a[ATTR_IMAGE.I_HT]=i,a[ATTR_IMAGE.I_WID]=r,a[ATTR_IMAGE.I_ORGINALHT]=i,a[ATTR_IMAGE.I_ORGINALWID]=r,editor.doc.execCmd("insimg",a),JImg.remove(),PubSub.publish("DocOperation/AfterDropImage")}).each(function(){this.complete&&J(this).load()})}},fail:function(){PubSub.publish("DocOperation/AfterDropImage")}};J.ajaxUpload(t,r,i,"json")}}(t),n.readAsDataURL(t)}},EventHandler.handleCompositionStart=function(e){EventHandler.isDialogOpened||EventHandler.isMenuOpened||!editor.isEditable()||!J(document.activeElement).parent("span#zohoMultiByteSpan")[0]||InsertShape.selectedShape()||(editor.isCompositionEventStart=!0,EditorUtil.positioningMultiByteSpan(),EditorUtil.focusMultiByteSpan())},EventHandler.handleCompositionUpdate=function(e){if(InsertShape.selectedShape()){var t=J("#"+InsertShape.selectedShape().data.nvOProps.nvDProps.id).offset();return void J("#scaleSpan").css({top:t.top,left:t.left})}if(editor.isCompositionEventStart){EventHandler.multiByteTyping=!0;var i=String(e.newValue);if(i=i.replace(/\u200b/gi,""),!editor.browserInfo.is_firefox&&(i==UNICODE.MULTIBYTE_SPACE||" "==i))return EditorUtil.flushContents(),!1;EditorUtil.setHTML(e)}},EventHandler.handleCompositionEnd=function(e){if(!EventHandler.isDialogOpened&&!EventHandler.isMenuOpened&&editor.isEditable()&&J(document.activeElement).parent("span#zohoMultiByteSpan")[0]&&!InsertShape.selectedShape()){var t=J("#cursorSpan");if(e.data||editor.browserInfo.is_ie)return editor.lastCompositionData=e.data,EditorUtil.flushContents(e),EventHandler.multiByteTyping=!1,t.remove(),editor.isCompositionEventStart=!1,EditorUtil.updateMultiByteSpanLeft(),CurUtil.blinkCursor(),Utils.stopEvent(e),!1;if(!e.data){EventHandler.multiByteTyping=!1;var i=t.parent()[0];t.remove(),i&&i.normalize(),EditorUtil.updateMultiByteSpanLeft()}return!0}},EventHandler.handleTextInput=function(e){if(!EventHandler.isDialogOpened&&!EventHandler.isMenuOpened&&editor.isEditable()&&J(document.activeElement).parent("span#zohoMultiByteSpan")[0]){var t=e.data;if(e.detail&&(t=e.detail.data),editor.isEditable()&&t&&t!=editor.lastCompositionData){if(J(e.target).parents("span#zohoMultiByteSpan")[0])return EventHandler.multiByteTyping=!0,EditorUtil.flushContents(e),EditorUtil.focusMultiByteSpan(),EventHandler.multiByteTyping=!1,Utils.stopEvent(e),!1}else EditorUtil.focusMultiByteSpan(),Utils.stopEvent(e)}return editor.lastCompositionData=void 0,!1},EventHandler.insertNonbreakingSpace=function(e){var t=String.fromCharCode(160);editor.addChar(t)},EventHandler.setActivePageAndSection=function(e,t,i){var o=e[0],r=o.className,n=o.id,a=e.parents(".zw-page")[0],l=e.parents(".zw-column")[0];a||(a=Utils.getClosestChild(e[0],"div.zw-page",t,i),l=Utils.getClosestChild(a,"div.zw-column",t,i)),editor.currentPageIndex=editor.jeditorPane.children(".zw-page").index(a),editor.currentColumnIndex=J(a).find(".zw-column").index(l),editor.clientActiveSection=e.parents("div.zw-contentpane, div.header_primary, div.footer_primary,div.zw-footnotepane,div.zw-endnotepane")[0],e.hasClass("zw-page")?(a=o,editor.currentPageIndex=editor.jeditorPane.children(".zw-page").index(a),editor.clientActiveSection=Utils.getClosestChild(o,"div.zw-contentpane,div.header_primary,div.footer_primary,div.zw-footnotepane,div.zw-endnotepane",t,i)):!editor.clientActiveSection&&r&&/contentpane|header_primary|footer_primary|footnotepane|endnotepane/.test(r)?editor.clientActiveSection=o:(n&&"editorpane"==n||"ui-editor-outer-div"==n)&&(a=Utils.getClosestChild(o,".zw-page",t,i),editor.currentPageIndex=editor.jeditorPane.children(".zw-page").index(a),editor.clientActiveSection=Utils.getClosestChild(o,"div.zw-contentpane,div.header_primary,div.footer_primary,div.zw-footnotepane,div.zw-endnotepane",t,i))},EventHandler.addNewParas=function(e,t,i){for(var o=J(".zw-page").offset().left+editor.doc.bodyFormat.ml.convertor().pixels,r=e.y-(i.offset().top+i.height()*editor.zoomFactor),n=i.children(".zw-line-div:first").height()*editor.zoomFactor,a=parseInt(r/n)||1,l=editor.currentColumnIndex-1;l!=-1;)o+=ViewManager.getColumnSpacing(l),o+=ViewManager.getColumnWidth(l),l--;var s={type:"paragraph"},d=DocUtil.getKeys(s),o=J(".zw-page").offset().left/editor.zoomFactor+editor.doc.bodyFormat.ml.convertor().pixels,c=(e.x/editor.zoomFactor-o+"px").convertor(),p=c.inches;"mm"==Conversions.globalUnit&&(p=c.millimeters),s=DocUtil.copyStyle(t.attr("*"));for(var u=[{r:t.getEnd()-1}],f=0;f<a;f++)0!=f&&(s={type:"paragraph"}),u.push({as:{start:s}},{is:UNICODE.PARA},{as:{end:d}});u.push({as:{start:{type:NODE_TYPE.TEXT,st:NODE_TYPE.TAB}}},{is:UNICODE.TAB},{as:{end:["type","st"]}}),Op.processMsg(u);var g=[{id:"0",point:p+Conversions.globalUnit,align:"0",leader:"0"}],m={};m[ATTR_PARAGRAPH.PS_NULL]=!0,m[ATTR_TEXT.TS_NULL]=!0,m[ATTR_PARAGRAPH.PS_TPS]=g,t.attr(m);var h=t.getEnd()+a+1;Op.fillCursorPos(h,h),Op.sendMsg()},EventHandler.insertTabInEmptyPara=function(e,t){for(var i=J(".zw-page").offset().left/editor.zoomFactor+editor.doc.bodyFormat.ml.convertor().pixels,o=editor.currentColumnIndex-1;o!=-1;)i+=ViewManager.getColumnSpacing(o),i+=ViewManager.getColumnWidth(o),o--;var r=(e.x/editor.zoomFactor-i+"px").convertor(),n=r.inches;"mm"==Conversions.globalUnit&&(n=r.millimeters);var a=[];a.push({r:editor.doc.getSelection().getStart()},{as:{start:{type:NODE_TYPE.TEXT,st:NODE_TYPE.TAB}}},{is:UNICODE.TAB},{as:{end:["type","st"]}}),Op.processMsg(a);var l=[{id:"0",point:n+Conversions.globalUnit,align:"0",leader:"0"}],s={};s[ATTR_PARAGRAPH.PS_TPS]=l,t.attr(s),Op.sendMsg()},EventHandler.applyStoredFormat=function(){var e=editor.doc.getSelection(),t=e.getLastRange(),i=t.start,o=t.end,r=[],n=[],a=[];i==o?(r.push(e.getWord()),a.push(editor.doc.paintFormat.text),editor.doc.paintFormat.para&&(n.push(e.parents(NODE_TYPE.PARAGRAPH)),a.push(editor.doc.paintFormat.para))):(r=e.getNodesInSelection(NODE_TYPE.TEXT,i,o),a=(new Array).repeat(editor.doc.paintFormat.text,r.length),editor.doc.paintFormat.para&&(n=e.getNodesInSelection(NODE_TYPE.PARAGRAPH,i,o),a=a.concat((new Array).repeat(editor.doc.paintFormat.para,n.length)))),editor.doc.execCmd("applyStyle",[r.concat(n),a,"applyStoredFormat"])},EventHandler.setClientActiveSection=function(e){var t,i=e.name;if(i.indexOf("content")!==-1)t=editor.jeditorPane.children(".zw-page").eq(editor.currentPageIndex).find("div.zw-contentpane")[0];else if(i.indexOf("header")!==-1)EditorView.isPageView()||(editor.currentPageIndex=0),t=editor.jeditorPane.children(".zw-page").eq(editor.currentPageIndex).find("div.header_primary")[0];else if(i.indexOf("footer")!==-1)EditorView.isPageView()||(editor.currentPageIndex=editor.jeditorPane.children(".zw-page").length-1),t=editor.jeditorPane.children(".zw-page").eq(editor.currentPageIndex).find("div.footer_primary")[0];else if(i.indexOf("footnote")!==-1||i.indexOf("endnote")!==-1){var o=NoteViewCollection.getNoteViews(e.sid)[0];t=o.el}editor.clientActiveSection=editor.prevClientActiveSection=t},PubSub.subscribe("Document/ViewportChanged",function(e,t){try{var i=t.top,o=i+editor.editorPaneContainerHt,r=CurUtil.offset.start.top*editor.zoomFactor,n=editor.doc.getSelection().getLastRange(),a=n&&n.getStartPortionData().line,l=r+(a&&a.contentHeight||0);if(r>i&&l<o&&(e=ViewManager.getPageAtPageNumber(editor.currentPageIndex+1)),J("#totalPage").text(J.i18n("common","OF")+" "+ViewManager.getPageCount()),J("#bbar-pagenuminput").html(e.pageNumber),EditorView.isPageView()){var i=t.top,s=editor.editorPaneContainerOffset.top,d=editor.editorPaneContainer[0].scrollHeight,c=d/editor.editorPaneContainerHt,p=s+i/c,u=UIUtils.JscrollbarPageInfoFlag.find(".page-info-flag");u.text(J.i18n("common","PAGE")+" "+e.pageNumber),UIUtils.JscrollbarPageInfoFlag.css({left:document.body.offsetWidth-UIUtils.JscrollbarPageInfoFlag.width()-30,top:p-10}).show(),clearTimeout(EventHandler.scrollBarTimer),EventHandler.scrollBarTimer=void 0,EventHandler.scrollBarTimer=setTimeout(function(){UIUtils.JscrollbarPageInfoFlag.fadeOut("slow")},2e3)}}catch(e){}}),HiddenMarkers=function(){var e=function(){PubSub.subscribe("Document/Error",t),PubSub.subscribe("Document/readonlyview",t),PubSub.subscribe("Document/lineview/create",o),PubSub.subscribe("Document/lineview/update",o),PubSub.subscribe("hrview/create",i)},t=function(){PubSub.unsubscribe("Document/Error",t),PubSub.unsubscribe("Document/lineview/create",o),PubSub.unsubscribe("Document/lineview/update",o),PubSub.unsubscribe("hrview/create",i)},i=function(e){var t=ViewManager.getViews(e)[0];t.isPageBreakHr()&&J(t.el).addClass("icon-pagebreak").css({background:"none"}).show()},o=function(e,t){var i,o,r,n,a={},l=t.parent.getIndex();for(r=t.parent.getTabIndexes(),i=document.createElement("div"),i.className="icon-tab",n=0,o=r.length;n<o;n++)e&&e.el&&r[n]>=t.start&&r[n]<=t.end&&(a.left=DocTreeManager.getLeftAtIndex(r[n]+l)+editor.doc.getRawFormatAt(r[n]+l).width/2-6+"px",a.position="absolute",a.width="12px",a.display="inline-block",a.bottom=t.contentHeight/2+"px",J(i).css(a),e.el.appendChild(i.cloneNode(!0)))},r=function(i){"string"==typeof i&&(i="true"===i),editor.isEditable()&&i&&"SHAREDREADCOMMENT"!==editor.doc.getRole()?e():t()},n=function(){editor.doc.isHiddenMarkersEnabled=!editor.doc.isHiddenMarkersEnabled,r(editor.doc.isHiddenMarkersEnabled);var e=new DocOpBuilder,t={};e.operation="load",ViewManager.updateHeaderFooter(),ViewManager.updatePageSettings(),DocTreeManager.refreshTree();for(var i,o=[],n=editor.doc.getSelection(),a=0,l=n.length;a<l;a++)i=n.getRangeAt(a),t.start=i.start,t.end=i.end,o.push(t),t={};e.cursor=o,e.postApplyTo(),EditorUtil.focusMultiByteSpan(),editor.doc.isHiddenMarkersEnabled?(Utils.addToStatistics("Hidden_markers"),J("#fmt-lpnl-non-printing-char").zbutton("check"),J("#view-lpnl-pilcrow").zstatebutton("checked",!0)):(J("#fmt-lpnl-non-printing-char").zbutton("uncheck"),J("#view-lpnl-pilcrow").zstatebutton("checked",!1))},a=function(){return editor.doc.isHiddenMarkersEnabled},l=function(){PubSub.subscribe("Document/show_non_printing_char/changed",r)};return{init:l,toggleMarker:n,isEnabled:a}}(),Paragraph.TYPE_NORMAL=0,Paragraph.TYPE_LIST=1,Image.ERROR_MSG_1="Invalid arguments",ElementBuilder=function(){var e=Array.prototype.slice,t=function(t){function i(){}return i.prototype=t.prototype,function(){var o=e.call(arguments);return t.apply(new i,o)}},i=function(e){return e=e||{rows:2,cols:2,cellVals:void 0,dtNode:null},t(Table).call(null,e.rows,e.cols,e.cellAttrs,e.cellVals,e.dtNode)},o=function(e){return e=e||{cols:0,action:"",dtNode:null},t(Row).call(null,e.cols,e.dtNode,e.dtNode)},r=function(e){return t(bookmarkElement).call(null,NODE_TYPE.BOOKMARK,e.id,e.name)},n=function(e){return t(autofieldElement).call(null,NODE_TYPE.AUTOFIELD,e.id)},a=function(e){return t(placeholderElement).call(null,NODE_TYPE.PLACEHOLDER,e.id)},l=function(e){return t(FloatElement).call(null,NODE_TYPE.COMMENT,e.sectionId,e.parentId,e.cType,e.userName,e.time,e.userId,e.color,e.activity)},s=function(e){return function(i){return t(FloatElement).call(null,e,i)}},d={};d[NODE_TYPE.BODY]=t(Body),d[NODE_TYPE.PARAGRAPH]=t(Paragraph),d[NODE_TYPE.SECTION]=t(Section),d[NODE_TYPE.FOOTNOTE]=s(NODE_TYPE.FOOTNOTE),d[NODE_TYPE.ENDNOTE]=s(NODE_TYPE.ENDNOTE),d[NODE_TYPE.COMMENT]=l,d[NODE_TYPE.TABLE]=i,d[NODE_TYPE.ROW]=o,d[NODE_TYPE.CELL]=t(Cell);var c=function(){d[NODE_TYPE.TEXT]=t(Text),d[NODE_TYPE.BR]=t(BR),d[NODE_TYPE.IMAGE]=t(ZWImage),d[NODE_TYPE.IFRAME]=t(Iframe),d[NODE_TYPE.HR]=t(HR),d[NODE_TYPE.LINK]=t(LinkItem),d[NODE_TYPE.HEADER_PRIMARY]=s(NODE_TYPE.HEADER_PRIMARY),d[NODE_TYPE.FOOTER_PRIMARY]=s(NODE_TYPE.FOOTER_PRIMARY),d[NODE_TYPE.BOOKMARK]=r,d[NODE_TYPE.AUTOFIELD]=n,d[NODE_TYPE.PLACEHOLDER]=a},p=function(e,t){return d[e]||c(),d[e].call(null,t)};return{createElement:p}}(),function(){var e=function(){if(editor.doc.getSelection().isCollapsed()){var e=editor.doc.getDomCursorNode(editor.uuid,editor.zuid,"start");Utils.scrollElementIntoView(e[0])}EditorUtil.focusMultiByteSpan()},t=function(){PubSub.publish("Selection/updateClientLeft")},i=function(i,o,r){var n=editor.doc.getSelection(),a=n.getLastModifiedPosition();if(Utils.getCurrentTypingDirection(a)==PARA_DIR.RTL&&!r)return k.moveRight(i,o,!0);var l,s=n.getStart();if(n.isCollapsed()){var d=Nav.moveLeft();d.element&&n.removeAllRanges().setSelectionType(SEL_KEYBOARD).moveTo(d.element,d.position).mapAllSelectionsToBulletin()}else s==editor.doc.getSectionStart(s)&&(s+=1),l=editor.doc.createRange(s),n.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(l);return e(),t(),!1},o=function(i,o,r){var n=editor.doc.getSelection(),a=n.getLastModifiedPosition();if(Utils.getCurrentTypingDirection(a)==PARA_DIR.RTL&&!r)return k.moveToCurrentWordEnd(i,o,!0);var l=Nav.movePreviousWord();return l.element&&editor.doc.getSelection().removeAllRanges().setSelectionType(SEL_KEYBOARD).moveTo(l.element,l.position).mapAllSelectionsToBulletin(),e(),t(),!1},r=function(i,o,r){var n=editor.doc.getSelection(),a=n.getLastModifiedPosition();if(Utils.getCurrentTypingDirection(a)==PARA_DIR.RTL&&!r)return k.moveToLineEnd(i,o,!0);var l=Nav.moveToLineStart(),s=editor.doc.getElementAt(l);return s&&editor.doc.getSelection().removeAllRanges().setSelectionType(SEL_KEYBOARD).moveTo(s,!0).mapAllSelectionsToBulletin(),e(),t(),!1},n=function(e,i,o){var r,n=editor.doc,a=n.getSelection(),l=a.getStart(),s=a.getEnd(),d=n.getCharAt(s),c=!1,p=!1;if(r=a.getLastModifiedPosition(),Utils.getCurrentTypingDirection(r)==PARA_DIR.RTL&&!o)return k.selectRight(e,i,!0);if(a.isCollapsed()&&a.setLastModifiedPosition("start"),a.isTableSelected()&&(c=n.getCharAt(l-2)==UNICODE.ROW&&"start"==a.getLastModifiedPosition(),p=(d==UNICODE.CELL||d==UNICODE.ROW||d==UNICODE.TABLEEND)&&"end"==a.getLastModifiedPosition()),c)r=a.getLastModifiedPosition(),l=Nav.moveUp(!0);else if(p){var u=a.getEndCell(),f=u.previousSibling();if(f){s=f.getEnd()-1}else{var g=u.parentNode(),u=g.previousSibling().children()[0];s=u.getEnd()-1}}else{r=a.getLastModifiedPosition();var m=Nav.moveLeft(!0),h=m.element;if(h)if("start"==r){var T=m.position?h.getStart():h.getEnd();l=T<1?1:T}else s=m.position?h.getStart():h.getEnd(),n.getCharAt(s-1)==UNICODE.PARA&&(s-=1)}var E=editor.doc.createRange(l,s);return a.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(E).mapAllSelectionsToBulletin(),t(),!1},a=function(e,i,o){var r,n=editor.doc.getSelection(),a=n.getStart(),l=n.getEnd(),s=n.getLastModifiedPosition();if(Utils.getCurrentTypingDirection(s)==PARA_DIR.RTL&&!o)return k.selectToCurrentWordEnd(e,i,!0);if(n.isCollapsed()&&n.setLastModifiedPosition("start"),"end"===s)l=n.getPrevWordEnd();else if(a=n.getPrevWordStart(),r=editor.doc.getCharAt(a-1),r==UNICODE.RANGE_START){var d=editor.doc.getRawFormatAt(a-1);if(d&&d.type&&"link"===d.type){a--;var c=DocUtil.getRangeEnd(a);c>l&&(l=c)}}else if(r==UNICODE.RANGE_END){var d=editor.doc.getRawFormatAt(a-1);d&&d.type&&"link"===d.type&&(a=DocUtil.getRangeStart(a-1))}var p=editor.doc.createRange(a,l);return n.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(p).mapAllSelectionsToBulletin(),t(),!1},l=function(e,i,o){var r=editor.doc.getSelection(),n=r.getStart(),a=r.getEnd(),l=r.getLastModifiedPosition();if(Utils.getCurrentTypingDirection(l)==PARA_DIR.RTL&&!o)return k.selectToLineEnd(e,i,!0);r.isCollapsed()&&r.setLastModifiedPosition("start"),"start"==l?n=Nav.moveToLineStart(!0):(a=Nav.moveToLineStart(!0),a<n&&r.setLastModifiedPosition("start"));var s=editor.doc.createRange(n,a);return r.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(s).mapAllSelectionsToBulletin(),t(),!1},s=function(i,o,r){var n=editor.doc.getSelection(),a=n.getLastModifiedPosition();if(Utils.getCurrentTypingDirection(a)==PARA_DIR.RTL&&!r)return k.moveLeft(i,o,!0);var l,s,d=n.getEnd();if(!n.isCollapsed()){s=n.getCorrectedCursorPosition(d);var c=editor.doc.createRange(s);return n.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(c),!0}return l=Nav.moveRight(),l.element&&n.removeAllRanges().setSelectionType(SEL_KEYBOARD).moveTo(l.element,l.position).mapAllSelectionsToBulletin(),e(),t(),!1},d=function(i,o,r){var n=editor.doc.getSelection(),a=n.getLastModifiedPosition();if(Utils.getCurrentTypingDirection(a)==PARA_DIR.RTL&&!r)return k.moveToPrevWordStart(i,o,!0);var l=Nav.moveNextWord(),s=l.element,d=l.position;return s&&editor.doc.getSelection().removeAllRanges().setSelectionType(SEL_KEYBOARD).moveTo(s,d).mapAllSelectionsToBulletin(),e(),t(),!1},c=function(i,o,r){var n=editor.doc.getSelection(),a=n.getLastModifiedPosition();if(Utils.getCurrentTypingDirection(a)==PARA_DIR.RTL&&!r)return k.moveToLineStart(i,o,!0);var l=Nav.moveToLineEnd(),s=editor.doc.getElementAt(l),d=!0;return s.type==NODE_TYPE.PARAGRAPH&&(s=s.lastChild(),d=!1),s&&n.removeAllRanges().setSelectionType(SEL_KEYBOARD).moveTo(s,d).mapAllSelectionsToBulletin(),e(),t(),!1},p=function(e,i,o){var r,n,a=editor.doc,l=a.getSelection(),s=l.getStart(),d=l.getEnd();if(r=l.getLastModifiedPosition(),Utils.getCurrentTypingDirection(r)==PARA_DIR.RTL&&!o)return k.selectLeft(e,i,!0);if(a.getCharAt(n)==UNICODE.CELL){var c=a.getParents(NODE_TYPE.CELL,n+1);if(c){var p=TabKeyHandler.getNextVisibleCell(c);if(p)if(n=p.getStart(),"end"==r){d=n;var u=editor.doc.getSelection().getLastRange();u&&u.setEnd(d)}else{var u=editor.doc.getSelection().getLastRange();if(l.isCollapsed()){var f=editor.doc.findPreviousIndexOf(UNICODE.PARA,n);f>0&&(n=f),d=n,u&&u.setEnd(d)}u&&u.setStart(n),s=n}else{var g=c.attr();if(g&&(g[ATTR_CELL.TDS_MRG]||"fc"==g[ATTR_CELL.TDS_MRG])){var m=TableUtil.getTableEnd(n);if(m>0)if(n=m,"end"==r){d=n;var u=editor.doc.getSelection().getLastRange();u&&u.setEnd(d)}else{var u=editor.doc.getSelection().getLastRange();l.isCollapsed()&&(f=editor.doc.findPreviousIndexOf(UNICODE.PARA,n),f>0&&(n=f),d=n,u&&u.setEnd(d)),u&&u.setStart(n),s=n}}}}}if(l.isCollapsed()&&l.setLastModifiedPosition("end"),r=l.getLastModifiedPosition(),"end"==r&&a.getCharAt(d)==UNICODE.ROW)l.setIsTableSelected(!1),d=Nav.moveDown(!0);else if(!l.isTableSelected()||a.getCharAt(s-1)!=UNICODE.CELL&&a.getCharAt(s-2)!=UNICODE.ROW||"start"!=r){var h=Nav.moveRight(!0),T=h.element;if(T)if("start"==r)s=h.position?T.getStart():T.getEnd(),a.getCharAt(s)==UNICODE.PARA&&(s+=1);else if(d=h.position?T.getStart():T.getEnd(),a.getCharAt(d)==UNICODE.CELL||a.getCharAt(d)==UNICODE.ROW){var E=TableUtil.getCellStart(s);E>0&&(s=E+1)}}else{var R=l.getStartCell(),S=R.nextSibling();S&&(s=S.getStart()+1)}var u=editor.doc.createRange(s,d);return l.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(u).mapAllSelectionsToBulletin(),t(),!1},u=function(e,i,o){var r,n=editor.doc.getSelection(),a=n.getStart(),l=n.getEnd(),s=n.getLastModifiedPosition();if(Utils.getCurrentTypingDirection(s)==PARA_DIR.RTL&&!o)return k.selectToPrevWordStart(e,i,!0);if(n.isCollapsed()&&n.setLastModifiedPosition("end"),"start"===s)if(a=n.getNextWordStart(),r=editor.doc.getCharAt(a),r==UNICODE.RANGE_START){var d=editor.doc.getRawFormatAt(a);if(d&&d.type&&"link"===d.type){var c=DocUtil.getRangeEnd(a);l<c&&(l=c,n.setLastModifiedPosition("end"))}}else if(r==UNICODE.RANGE_END){var d=editor.doc.getRawFormatAt(a);if(d&&d.type&&"link"===d.type){var p=DocUtil.getRangeStart(a);p<l&&l<a&&(l=p)}}else r!=UNICODE.HR&&r!=UNICODE.TOCSTART&&r!=UNICODE.TOCEND||a++;else{if(l=n.getNextWordEnd(),l>=editor.doc.getSectionEnd(a))return!1;if(r=editor.doc.getCharAt(l),r==UNICODE.RANGE_START){var d=editor.doc.getRawFormatAt(l);d&&d.type&&"link"===d.type&&(l=DocUtil.getRangeEnd(l))}else if(r==UNICODE.RANGE_END){var d=editor.doc.getRawFormatAt(l);if(d&&d.type&&"link"===d.type){var p=DocUtil.getRangeStart(l);p<a&&(a=p)}}}var u=editor.doc.createRange(a,l);return n.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(u).mapAllSelectionsToBulletin(),t(),!1},f=function(e,i,o){var r=editor.doc.getSelection(),n=r.getStart(),a=r.getEnd(),l=r.getLastModifiedPosition();if(Utils.getCurrentTypingDirection(l)==PARA_DIR.RTL&&!o)return k.selectToLineStart(e,i,!0);"start"==l?(n=Nav.moveToLineEnd(!0),n>a&&editor.doc.getSelection().setLastModifiedPosition("end")):a=Nav.moveToLineEnd(!0);var s=editor.doc.createRange(n,a);return r.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(s).mapAllSelectionsToBulletin(),t(),!1},g=function(i){var o=editor.doc.getSelection();o.isCollapsed()||(o.collapseToEnd(),t());var r=Nav.moveDown(),n=editor.doc.getElementAt(r),a=!0;return n.type==NODE_TYPE.PARAGRAPH&&(n=n.lastChild(),a=!1),n&&editor.doc.getSelection().removeAllRanges().setSelectionType(SEL_KEYBOARD).moveTo(n,a).mapAllSelectionsToBulletin(),e(),!1},m=function(t){var i,o,r=Nav.moveToParaEnd(),n=editor.doc.getCharAt(r-1);return n!=UNICODE.CELL?(i=editor.doc.getElementAt(r-1),o=!1):(i=editor.doc.getElementAt(r),o=!0),i&&editor.doc.getSelection().removeAllRanges().setSelectionType(SEL_KEYBOARD).moveTo(i,o).mapAllSelectionsToBulletin(),e(),!1},h=function(t){var i=Nav.moveToEnd(),o=editor.doc.getElementAt(i),r=!1;return o&&editor.doc.getSelection().removeAllRanges().setSelectionType(SEL_KEYBOARD).moveTo(o,r).mapAllSelectionsToBulletin(),e(),!1},T=function(e){var t,i=editor.doc,o=i.getSelection(),r=o.getStart(),n=o.getEnd();if(o.isCollapsed()&&o.setLastModifiedPosition("end"),t=o.getLastModifiedPosition(),o.isTableSelected())o.setIsTableSelected(!1),n=Nav.moveDown(!0);else if("start"==t)r=Nav.moveDown(!0);else{var a=Nav.moveDown(!0);n=n<a?a:n}var l=editor.doc.createRange(r,n);return!o.hasRange(l)&&(o.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(l).mapAllSelectionsToBulletin(),!1)},E=function(e){var t,i=editor.doc.getSelection(),o=i.getStart(),r=i.getEnd();i.isCollapsed()&&i.setLastModifiedPosition("end"),t=i.getLastModifiedPosition(),"start"==t?(o=Nav.moveToParaEnd(!0),o>r&&i.setLastModifiedPosition("end")):r=Nav.moveToParaEnd(!0);var n=editor.doc.createRange(o,r);return i.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(n).mapAllSelectionsToBulletin(),!1},R=function(){var e=editor.doc.getSelection().parents(NODE_TYPE.ROW),t=editor.doc.getSelection();if(e){if(TableUtil.isVerticalMergedRow(e))return!1;TableActions.moveRowDown(e),t.isTextDrag=!0,t.isTextDrag=!1}else{var i=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.PARAGRAPH),o=i.length,r=editor.doc.getSelection().getStart(),n=editor.doc.getSelection().getEnd();r==i[0].getStart()&&n==i[o-1].getEnd()||(r=i[0].getStart(),n=i[o-1].getEnd());var a=editor.doc.getSectionEnd(r),l=editor.doc.findNextIndexOf(UNICODE.PARA,n);if(l>0&&l<a){if(l+1===a||l>a){var s=editor.doc.getParents(NODE_TYPE.PARAGRAPH,l);if(s.getEnd()-s.getStart()===1)return!1;var d=DocUtil.copyStyle(editor.doc.getRawFormatAt(a-1)),c=DocUtil.getKeys(d);Op.processMsg([{r:a-1},{as:{start:d}},{is:UNICODE.PARA},{as:{end:c}}]),Op.sendMsg()}else{var p=editor.doc.getCharAt(n),u=editor.doc.getCharAt(l+1);if(u==UNICODE.TABLE||u==UNICODE.TOCSTART||u==UNICODE.HR){n-=1;var d=DocUtil.copyStyle(editor.doc.getRawFormatAt(n)),c=DocUtil.getKeys(d);Op.processMsg([{r:l},{as:{start:d}},{is:UNICODE.PARA},{as:{end:c}}]),Op.sendMsg()}else if(p==UNICODE.TABLE||p==UNICODE.HR||p==UNICODE.TOCSTART||p==UNICODE.CELL){n-=1;var d=DocUtil.copyStyle(editor.doc.getRawFormatAt(n)),c=DocUtil.getKeys(d);l=editor.doc.findPreviousIndexOf(CONT_REGEXP.PARASTART,l),l&&(Op.processMsg([{r:l+1},{as:{start:d}},{is:UNICODE.PARA},{as:{end:c}}]),Op.sendMsg())}else if(p==UNICODE.TABLEEND||p==UNICODE.TOCEND){n-=1,l=n+1;var d=DocUtil.copyStyle(editor.doc.getRawFormatAt(n)),c=DocUtil.getKeys(d);Op.processMsg([{r:n+2},{as:{start:d}},{is:UNICODE.PARA},{as:{end:c}}]),Op.sendMsg()}}var f=editor.doc.getSelection().getLastRange();return f&&f.setStart(l+1),EventHandler.textDragStart=!0,t.isTextDrag=!0,EventHandler.textDragSt=r,EventHandler.textDragEnd=n,EventHandler.moveText(),!1}}},S=function(e){var t,i=editor.doc.getSelection(),o=i.getStart(),r=i.getEnd(),n=i.parents(NODE_TYPE.SECTION);i.isCollapsed()&&i.setLastModifiedPosition("end"),t=i.getLastModifiedPosition(),"start"==t?(o=n.getEnd()-1,o>r&&i.setLastModifiedPosition("end")):r=n.getEnd()-1;var a=editor.doc.createRange(o,r);return i.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(a).mapAllSelectionsToBulletin(),!1},O=function(i){var o=editor.doc.getSelection();o.isCollapsed()||(o.collapseToStart(),t());var r=Nav.moveUp(),n=editor.doc.getElementAt(r),a=!0;return n.type==NODE_TYPE.PARAGRAPH&&(n=n.lastChild(),a=!1),n&&editor.doc.getSelection().removeAllRanges().setSelectionType(SEL_KEYBOARD).moveTo(n,a).mapAllSelectionsToBulletin(),e(),!1},v=function(t){var i=!0,o=editor.doc.getElementAt(Nav.moveToParaStart());return o&&editor.doc.getSelection().removeAllRanges().setSelectionType(SEL_KEYBOARD).moveTo(o,i).mapAllSelectionsToBulletin(),e(),!1},b=function(t){var i=Nav.moveToStart(),o=editor.doc.getElementAt(i),r=!0;return o&&editor.doc.getSelection().removeAllRanges().setSelectionType(SEL_KEYBOARD).moveTo(o,r).mapAllSelectionsToBulletin(),e(),!1},A=function(t){var i=editor.doc.getSelection(),o=editor.doc.getCursorPortionNode(editor.uuid,"start"),r=J(o).closestParent(NODE_NAME.TABLE)[0];if(r){var n=DocTreeManager.getNode(r),a=n.firstChild().firstChild().getIndex()+1,l=editor.doc.createRange(a);return i.removeAllRanges().addRange(l).mapAllSelectionsToBulletin(),e(),!1}},y=function(t){var i=editor.doc.getSelection(),o=editor.doc.getCursorPortionNode(editor.uuid,"start"),r=J(o).closestParent(NODE_NAME.TABLE)[0];if(!r)return!1;var n=DocTreeManager.getNode(r),a=n.lastChild().lastChild().getEndIndex()+1,l=editor.doc.createRange(a);return i.removeAllRanges().addRange(l).mapAllSelectionsToBulletin(),e(),!1},D=function(e){var t,i=editor.doc.getSelection(),o=i.getStart(),r=i.getEnd();if(i.isCollapsed()&&i.setLastModifiedPosition("start"),t=i.getLastModifiedPosition(),"start"==t?o=Nav.moveUp(!0):r=Nav.moveUp(!0),i.hasRange(editor.doc.createRange(o,r)))return!1;var n=editor.doc.createRange(o,r);return i.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(n).mapAllSelectionsToBulletin(),!1},C=function(e){var t,i,o=editor.doc.getSelection(),r=o.getStart(),n=o.getEnd();o.isCollapsed()&&o.setLastModifiedPosition("start"),t=o.getLastModifiedPosition(),i=Nav.moveToParaStart(!0),i==editor.doc.getSectionStart(r)&&(i+=1),"start"==t?r=i:(n=i,n<r&&o.setLastModifiedPosition("start"));var a=editor.doc.createRange(r,n);return o.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(a).mapAllSelectionsToBulletin(),!1},I=function(){var e=editor.doc.getSelection().parents(NODE_TYPE.ROW);if(e){if(TableUtil.isVerticalMergedRow(e))return!1;TableActions.moveRowUp(e)}else{var t=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.PARAGRAPH),i=t.length,o=editor.doc.getSelection().getStart(),r=editor.doc.getSelection().getEnd(),n=editor.doc.getSectionStart(o);if(o==t[0].getStart()&&r==t[i-1].getEnd()||(o=t[0].getStart(),r=t[i-1].getEnd()),n+1===o)return!1;var a=editor.doc.findPreviousIndexOf(CONT_REGEXP.PARASTART,o-1);if(a){var l=editor.doc.getCharAt(a),s=editor.doc.getCharAt(r);if(l==UNICODE.ROW&&(a=editor.doc.findPreviousIndexOf(UNICODE.PARA,a)),a>0)if(l=editor.doc.getCharAt(a+1),l==UNICODE.TABLE||l==UNICODE.HR||l==UNICODE.TOCSTART){var d=DocUtil.copyStyle(editor.doc.getRawFormatAt(a)),c=DocUtil.getKeys(d);Op.processMsg([{r:a},{as:{start:d}},{is:UNICODE.PARA},{as:{end:c}}]),Op.sendMsg(),o+=1,r+=1}else if(s==UNICODE.CELL||s==UNICODE.TABLEEND||s==UNICODE.TOCEND){var d=DocUtil.copyStyle(editor.doc.getRawFormatAt(r-1)),c=DocUtil.getKeys(d);Op.processMsg([{r:r-1},{as:{start:d}},{is:UNICODE.PARA},{as:{end:c}}]),Op.sendMsg()}}if(a<0&&(a=editor.doc.getSectionStart(o)),a>=0){var p=editor.doc.getSelection().getLastRange();return p&&p.setStart(a+1),EventHandler.textDragStart=!0,EventHandler.textDragSt=o,EventHandler.textDragEnd=r,EventHandler.moveText(!0),!1}}},P=function(e){var t,i=editor.doc.getSelection(),o=i.getStart(),r=i.getEnd();i.isCollapsed()&&i.setLastModifiedPosition("start"),t=i.getLastModifiedPosition(),"start"==t?o=editor.doc.getSectionStart(o)+1:(r=editor.doc.getSectionStart(o)+1,r<o&&i.setLastModifiedPosition("start"));var n=editor.doc.createRange(o,r);i.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(n).mapAllSelectionsToBulletin()},_=function(i){var o=Nav.handlePageNavigation(KEYS.PAGEUP,!1),r=o.element,n=o.position;return r&&editor.doc.getSelection().removeAllRanges().setSelectionType(SEL_KEYBOARD).moveTo(r,n).mapAllSelectionsToBulletin(),e(),t(),!1},N=function(e){var i=Nav.handlePageNavigation(KEYS.PAGEUP,!0),o=editor.doc.getSelection();return o.hasRange(i)||o.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(i).mapAllSelectionsToBulletin(),t(),!1},L=function(i){var o=Nav.handlePageNavigation(KEYS.PAGEDOWN,!1),r=o.element,n=o.position;return r&&editor.doc.getSelection().removeAllRanges().setSelectionType(SEL_KEYBOARD).moveTo(r,n).mapAllSelectionsToBulletin(),e(),t(),!1},w=function(e){var i=Nav.handlePageNavigation(KEYS.PAGEDOWN,!0),o=editor.doc.getSelection();return o.hasRange(i)||o.removeAllRanges().setSelectionType(SEL_KEYBOARD).addRange(i).mapAllSelectionsToBulletin(),t(),!1},M=function(e){var t=editor.doc,i=t.getSelection(),o=i.getStart(),r=t.getParents(NODE_TYPE.PARAGRAPH,o);return o!==r.getStart()&&v(),!1},U=function(e){var t=editor.doc,i=t.getSelection(),o=i.getStart(),r=t.getParents(NODE_TYPE.PARAGRAPH,o);return o!==r.getStart()&&C(),!1},x=function(e){var t=editor.doc,i=t.getSelection(),o=i.getEnd(),r=t.getParents(NODE_TYPE.PARAGRAPH,o);return o!==r.getEnd()-1&&m(),!1},F=function(e){var t=editor.doc,i=t.getSelection(),o=i.getEnd(),r=t.getParents(NODE_TYPE.PARAGRAPH,o);return o!==r.getEnd()-1&&E(),!1},k={moveLeft:i,moveToPrevWordStart:o,moveToLineStart:r,selectLeft:n,selectToPrevWordStart:a,selectToLineStart:l,moveRight:s,moveToCurrentWordEnd:d,moveToLineEnd:c,selectRight:p,selectToCurrentWordEnd:u,selectToLineEnd:f,moveDown:g,moveToParaEnd:m,moveToDocumentEnd:h,selectDown:T,selectToParaEnd:E,selectToDocumentEnd:S,moveUp:O,moveToParaStart:v,moveToDocumentStart:b,selectUp:D,selectToParaStart:C,selectToDocumentStart:P,moveToPrevPage:_,selectToPrevPage:N,moveToNextPage:L,selectToNextPage:w,moveParaUp:I,moveParaDown:R,moveToCurrentParaStart:M,selectToCurrentParaStart:U,moveToCurrentParaEnd:x,selectToCurrentParaEnd:F,moveToTableStart:A,moveToTableEnd:y};this.NavUtil=k}(),DefaultAutoCorrects=function(){var e={},t=function(){if(jQuery.isEmptyObject(e)){var t,i;e.en={},e.en.days={},e.en.months={},e.gr={},e.gr.days={},e.gr.months={};var o=["m o n d a y","t u e s d a y","w e d n e s d a y","t h u r s d a y","f r i d a y","s a t u r d a y","s u n d a y"],r=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],n=[],a=[],l=["m o n t a g","d i e n s t a g","m i t t w o c h","d o n n e r s t a g","f r e i t a g","s a m s t a g","s o n n t a g"],s=["Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"],d=["j a n u a r","f e b r u a r","m ä r z","a p r i l","m a i","j u n i","j u l i","a u g u s t","s e p t e m b e r","o k t o b e r","n o v e m b e r","d e z e m b e r"],c=["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"];for(t=0,i=o.length;t<i;t++)e.en.days[o[t]]=r[t];for(t=0,i=n.length;t<i;t++)e.en.months[n[t]]=a[t];for(t=0,i=l.length;t<i;t++)e.gr.days[l[t]]=s[t];for(t=0,i=d.length;t<i;t++)e.gr.months[d[t]]=c[t]}return e};return{getDefaultAutoCorrects:t}}(),Op.msgBuffer=[],Op.Id=0,Op.cursor=[],Op.isListItemSelection=!1,Op.isCtrlSelection=!1,Op.processMsg=function(e){try{TCHandler.processMsg(e);var t=DocOpBuilder.build(e);editor.doc.getTrackChangeDetails().isNoMarkupON()&&(t=TcNoMarkupHandler.processMsg(t)),Op.msgBuffer.push(t)}catch(e){if("Error in TcBlock Deletion"==e){var i=new Error(ZWCollaboration.DELETE_TC_BLOCK_ERROR);throw editor.lastError=i,i}throw e}},Op.fillCursorPos=function(e,t){var i={};e>=0&&t>=0&&(i.start=e,i.end=t,Op.cursor.push(i))},Op.resetCursorPos=function(){Op.cursor=[]},Op.resetBuffer=function(){Utils.log("Reset Buffer"),Op.msgBuffer=[],Op.resetCursorPos(),editor.doc.getTrackChangeDetails().isNoMarkupON()&&TcNoMarkupHandler.resetBuffer()},Op.sendMsg=function(){var e=Op.msgBuffer,t=e.length;if(0!=t){var i,o={},r=new DocOpBuilder;if(Op.cursor.length<1){var n=editor.doc.getSelection();n.length>1&&!n.isListItemSelection&&!n.isMultipleSelection&&n.sortRanges();for(var a,l=[],s=0,d=n.length,c=0;s<d;s++)a=n.getRangeAt(s),l.push({r:a.start-c},{as:{start:{type:"cursor",uuid:editor.uuid}}},{r:a.end-a.start},{as:{end:["type","uuid"]}}),c=a.end;var p=DocOpBuilder.build(l);e.push(p)}try{for(var u=e[0],f=null,g=0;g<t;g++)if(f=e[g+1]){var m=DocOpBuilder.xform(u,f);if(jQuery.isEmptyObject(o)&&g==t-1){var h=m.second.getCursorPos();if(h.length>0){Op.cursor=h;continue}}u=DocOpBuilder.compose(u,m.second),u=DocOpBuilder.concise(u)}i=u}catch(e){Op.resetBuffer(),Utils.log("Exception in compose/concise: "+e.stack);var T="concise_error"===e||"compose_error"===e?ZWCollaboration.OP_PROCESSING_ERR:ZWCollaboration.OP_APPLYTO_ERROR,E=new Error(T);throw editor.lastError=E,E}try{var R,S=i.isLock;if((S||editor.lastOperation==COMMAND.CUSTOM_PASTE)&&editor.doc.snapShotManager.setSkipSnapShot(!0),!S&&editor.doc.locks)try{R=DocOpBuilder.xform(editor.doc.locks,i),i=DocOpBuilder.concise(R.second),editor.doc.locks=DocOpBuilder.concise(R.first)}catch(e){if(Utils.log("finalOperation: "+i.toString()),Utils.log("Exception: "+e.stack),"Error in xform lock"!=e){var E=new Error(ZWCollaboration.OP_LK_ERROR);throw editor.lastError=E,E}return PubSub.publish("DocOperation/LockError"),void Op.resetBuffer()}r=i,editor.doc.getTrackChangeDetails().isNoMarkupON()&&(r=TcNoMarkupHandler.processClientToServerOp()),Utils.recordAction(editor.lastOperation),Utils.log("FINAL OPS"+i.toString()+"  Operation is:::"+editor.lastOperation+" Op.msgBuffer.length :: "+Op.msgBuffer.length),i.applyTo(Op.createOpInfo()),(S||editor.lastOperation==COMMAND.CUSTOM_PASTE)&&editor.doc.snapShotManager.setSkipSnapShot(!1),Utils.log("Afetr Apply To"),i.docOpId=Op.Id++,Utils.log("DOC OP IDS Increment")}catch(e){throw Op.logApplyToError(e,i,r),editor.lastError}if(Op.resetBuffer(),editor.isOffline())try{ZWOffline.storeOfflineOps(i)}catch(e){Utils.log("Exception in ZWoffline storeOfflineOps: "+e)}else try{ZWCollaboration.addToQueue(r),Utils.log("OPS ADDED INTO QUEUE"),ZWCollaboration.sendPendingMutation()}catch(e){throw Op.resetBuffer(),Utils.log("Exception when sending pending mutations: "+e.stack),editor.lastError=new Error(ZWCollaboration.OP_APPLYTO_ERROR),editor.lastError}Op.resetBuffer()}},Op.logApplyToError=function(e,t,i){Op.resetBuffer(),Utils.log("Exception in Apply To in OP SEND MSG"),Utils.log("Final Operation: "+t.toString()),Utils.log("Final Operation -- op2send: "+i.toString()),Utils.log("Exception: "+e.stack);var o=e.message;o===ZWCollaboration.SET_CURSOR_ERROR||o===ZWCollaboration.SET_COLLAB_CURSOR_ERROR||o===ZWCollaboration.TC_NOMARKUP_OPS_PROCESSING_ERROR?editor.lastError=e:"error in document applyTo"==e?editor.lastError=new Error(ZWCollaboration.OP_IDX_IOB):"error in dom applyTo"===e?editor.lastError=new Error(ZWCollaboration.OP_APPLYTO_ERROR_DOM):"Error in TC"===e?editor.lastError=new Error(ZWCollaboration.OP_TC_ERROR):editor.lastError=new Error(ZWCollaboration.OP_APPLYTO_ERROR)},Op.postXform=function(e,t){if(t&&!EditorUtil.isCursorInHeaderFooter()){var i=DocOpBuilder.build(t),o=DocOpBuilder.xform(e,i);e=DocOpBuilder.compose(e,o.second)}try{var r,n=new DocOpBuilder;if(editor.doc.locks)try{r=DocOpBuilder.xform(editor.doc.locks,e),e=DocOpBuilder.concise(r.second),editor.doc.locks=DocOpBuilder.concise(r.first)}catch(e){if(Utils.log("Exception in xform lock: "+e.stack),"Error in xform lock"!=e){var a=new Error(ZWCollaboration.OP_LK_ERROR);throw editor.lastError=a,a}return PubSub.publish("DocOperation/LockError"),void Op.resetBuffer()}n=e,editor.doc.getTrackChangeDetails().isNoMarkupON()&&(n=TcNoMarkupHandler.processClientToServerOp()),e.applyTo(Op.createOpInfo()),e.docOpId=Op.Id++}catch(t){throw Utils.log("Exception in 'PASTE' applyTo"),Op.logApplyToError(t,e,n),editor.lastError}0!=editor.doc.collabUsers.length&&ZWCollaboration.transformAndApplyOthersCursor(e,editor.uuid),editor.isOffline()?ZWOffline.storeOfflineOps(e):(ZWCollaboration.addToQueue(n),ZWCollaboration.sendPendingMutation()),Op.resetBuffer()},Op.createOpInfo=function(){var e={cursor:{},operation:editor.lastOperation};return e.cursor[editor.uuid]=Op.cursor,e},Utils.preference=function(e,t,i,o,r){var n=editor.doc.createElement(NODE_TYPE.TEXT,e);n.setStart(i),n.setEnd(o-(r?0:1));var a=editor.doc.createElement(NODE_TYPE.TEXT,t);a.setStart(i),a.setEnd(parseInt(i)+t.length),editor.doc.execCmd("replace",[n,a,!0])},Utils.handleDashes=function(e,t,i,o){var r=/^[a-zA-Z0-9"“”']{1,}--[a-zA-Z0-9"“”'\s]{1,}$/,n=/^[a-zA-Z0-9]{1,} - [a-zA-Z0-9\s]{1,}$/,a=/^[a-zA-Z0-9"��']{1,} -- [a-zA-Z0-9"��'\s]{1,}$/,l="";t>5&&(l=editor.doc.getContent(t-5,i));var s=a.test(l);if(o["--"]&&1===o["--"].tobeEnabled&&(r.test(e)||s)){s&&(t-=5,e=l);var d=e.indexOf("--"),c=DocUtil.getTextStyle(d+t),p=editor.doc.getRawFormatAt(d+t)||{};if(p&&"OFF"==p[ATTR_TEXT.TS_AUTO_COREECT])return delete p[ATTR_TEXT.TS_AUTO_COREECT],delete c[ATTR_TEXT.TS_AUTO_COREECT],void editor.doc.setFormatAt(t,p);var u=o["--"].value||null,f=(e.substr(0,d)+u+e.substr(d+2),editor.doc.createElement(NODE_TYPE.TEXT,"--"));f.setStart(t+d),f.setEnd(t+d+2);var g=editor.doc.createElement(NODE_TYPE.TEXT,u);g.setStart(t+d),g.setEnd(t+d+2),editor.doc.execCmd("replace",[f,g,!0]);var m=DocUtil.copyStyle(DocUtil.getTextStyle(t+d));m[ATTR_TEXT.TS_AUTO_COREECT]="ON",editor.doc.setFormatAt(t+d,m),m=DocUtil.copyStyle(DocUtil.getTextStyle(t+d+1)),delete m[ATTR_TEXT.TS_AUTO_COREECT],editor.doc.setFormatAt(d+t+1,m),editor.doc.setFormatAt(d+t+1,m)}else if(o[" - "]&&1===o[" - "].tobeEnabled&&t>4&&(t-=4,e=editor.doc.getContent(t,i),n.test(e))){var u=o[" - "].value||null,d=e.indexOf("-"),c=DocUtil.getTextStyle(d+t),p=editor.doc.getRawFormatAt(d+t)||{};if(p&&"OFF"==p[ATTR_TEXT.TS_AUTO_COREECT])return delete p[ATTR_TEXT.TS_AUTO_COREECT],delete c[ATTR_TEXT.TS_AUTO_COREECT],void editor.doc.setFormatAt(t+d,p);var f=(e.substr(0,d)+u+e.substr(d+1),editor.doc.createElement(NODE_TYPE.TEXT," - "));f.setStart(t+d-1),f.setEnd(t+d+1);var g=editor.doc.createElement(NODE_TYPE.TEXT," "+u);g.setStart(t+d-1),g.setEnd(t+d);var h=DocUtil.copyStyle(c);h[ATTR_TEXT.TS_AUTO_COREECT]="ON",delete c[ATTR_TEXT.TS_AUTO_COREECT],editor.doc.execCmd("replace",[f,g,!0]),editor.doc.setFormatAt(d+t,DocUtil.copyStyle(h)),editor.doc.setFormatAt(d+t+1,DocUtil.copyStyle(c))}},Utils.autoCapitalizeI=function(e,t,i){var o=editor.doc.getBodyFormat(),r=o?o[ATTR_BODY.DS_SPLANG]:"";if("en-US"===r||"en-GB"===r||"en_ZA"===r||"en-AU"===r||"en-NZ"===r||"en-CA"===r){if(ZWCode.isCodePara())return;var n=editor.doc.createElement(NODE_TYPE.TEXT,e);n.setStart(t),n.setEnd(i);var a=editor.doc.getSelection().textFormat,l=editor.doc.getRawFormatAt(t)||{},s=/(^i'|^i,|^i $)/,d=/(^i;d $)/,c=e;if(s.test(e))c=e.charAt(0).toUpperCase()+e.slice(1);else{if(!d.test(e))return;c="I'd "}if(l&&"OFF"==l[ATTR_TEXT.TS_AUTO_COREECT])return delete l[ATTR_TEXT.TS_AUTO_COREECT],delete a[ATTR_TEXT.TS_AUTO_COREECT],void editor.doc.setFormatAt(t,l);var p=editor.doc.createElement(NODE_TYPE.TEXT,c);p.setStart(t),p.setEnd(t+c.length);var u=DocUtil.copyStyle(a);u[ATTR_TEXT.TS_AUTO_COREECT]="ON",delete a[ATTR_TEXT.TS_AUTO_COREECT],editor.doc.execCmd("replace",[n,p,!0]),editor.doc.setFormatAt(t,u)}},Utils.afterSpaceOperations=function(e,t){var i,o,r,n,a,l,s;updatePrevWord=function(){i=editor.doc.getSelection().getPreviousWordWithoutSplChar(),o=i.getStart(),r=i.getEnd(),n=editor.doc.getSelection().parents(NODE_TYPE.PARAGRAPH),a=n.getStart(),l=n.getEnd(),s=editor.doc.getContent(o,r)},updatePrevWord();var d=w_usersettings[ATTR_BODY.DS_AUTOCORRECTS]||"{}";try{d=jQuery.parseJSON(d)}catch(e){d={}}if(w_usersettings[ATTR_BODY.DS_PREF]&&1==w_usersettings[ATTR_BODY.DS_PREF]){var c=s.trim();if(d[c]&&1==d[c].tobeEnabled&&!CONST.DEFAULT_AUTO_CORRECTS.contains(c)){var p=d[c].value||null;p&&p!==c&&(Utils.preference(s,p,o,r,t),updatePrevWord())}else if(o>1){var u=editor.doc.getContent(o-1,r);if(d[u]&&1===d[u].tobeEnabled&&!CONST.DEFAULT_AUTO_CORRECTS.contains(c)){var p=d[u].value||null;p&&p!==u&&(s=u,Utils.preference(s,p,o-1,r+1,t),updatePrevWord())}}}if(w_usersettings[ATTR_BODY.DS_AUTOLINK]&&1==w_usersettings[ATTR_BODY.DS_AUTOLINK]&&s.length>5){var f=t?null:editor.doc.createElement(NODE_TYPE.TEXT,e);Utils.makeLink(s,f,t),updatePrevWord()}"1"==w_usersettings[ATTR_BODY.DS_AUTOCAPS]&&s.length>=1&&!/[A-Z]/.test(s.substring(0,1))&&Utils.firstLetterCaps(s,o,r),"1"==w_usersettings[ATTR_BODY.DS_AUTOLIST]&&!DocUtil.isList(n.attr("*"))&&s.length<=3&&l-a<=4&&Utils.makeList(s,n),1==w_usersettings[ATTR_BODY.DS_AUTOCORRECTCAPSLOCK]&&Utils.autoCorrectCapsLock(s,o,r),Utils.autoCapitalizeI(s,o,r),Utils.handleDashes(s,o,r,d)},Utils.autoCorrectCapsLock=function(e,t,i){var o=new RegExp(/^[A-Z]{2}[a-z]{1,}$/),r=o.test(e.trim()),n=editor.doc.getRawFormatAt(t+1),a=!(!n||"OFF"!=n[ATTR_TEXT.TS_AUTO_COREECT]);if(r&&!a&&!ZWCode.isCodePara()){n=DocUtil.getTextStyle(t);var l=editor.doc.createElement(NODE_TYPE.TEXT,e);l.setStart(t),l.setEnd(i);var s=e.substring(0,1).toUpperCase()+e.substring(1,e.length).toLowerCase(),d=editor.doc.createElement(NODE_TYPE.TEXT,s);d.setStart(t),d.setEnd(parseInt(t)+s.length);var c=DocUtil.copyStyle(n);c[ATTR_TEXT.TS_AUTO_COREECT]="ON",editor.doc.execCmd("replace",[l,d,!0]),editor.doc.setFormatAt(t+1,c),editor.doc.setFormatAt(t+2,n)}},Utils.firstLetterCaps=function(e,t,i){var o=RegExp(CONT_REGEXP.PARASTART);if(!o.test(e)&&!ZWCode.isCodePara()){var r=o.test(editor.doc.getCharAt(t-1));if(" "==editor.doc.getCharAt(t-1)&&"."==editor.doc.getCharAt(t-2)&&"."!=editor.doc.getCharAt(t-3)||r){var n=e.substring(0,1),a=n.toUpperCase(),l=editor.doc.createElement(NODE_TYPE.TEXT,n);l.setStart(t),l.setEnd(t+1);var s=editor.doc.createElement(NODE_TYPE.TEXT,a);s.setStart(t),s.setEnd(t+1),editor.doc.execCmd("replace",[l,s,!0])}}},Utils.showTop=function(){editor.editorPaneContainer.animate({scrollTop:"0px"},"slow");var e=editor.doc.getSelection();if(e&&(EditorUtil.focusMultiByteSpan(),e.isCollapsed())){var t=editor.doc.getParents(NODE_TYPE.PARAGRAPH,1);editor.doc.getSelection().removeAllRanges().moveTo(t,!0),editor.clientActiveSection=J("div.zw-contentpane")[0]}},Utils.showOpacity=function(e,t){J("#"+e).css({opacity:t})},Utils.getBlockParent=function(e){return e&&"p td div".indexOf(e.nodeName.toLowerCase())!=-1?e:J(e).parents("p,td,div")[0]},Utils.getClosestSpan=function(e,t,i){var o=e.nodeName.toLowerCase(),r=e,n=J(e);if("span"==o)return e;if("img"==o||3==e.nodeType)return J(e).parents("span.zw-portion")[0];if(n.hasClass("zw-paragraph")||n.hasClass("zw-td")||n.hasClass("zw-cell-container"))r=e;else{var a=e.className;if(a&&a.indexOf("zw-line")!=-1)return Utils.getClosestChild(e,"span",t,i);var l,r=Utils.getClosestChild(e,"div.zw-paragraph",t,i),s=J(r).parents("table")[0];s&&(l=Utils.getClosestChild(s,"td",t,i),r=l)}return Utils.getClosestChild(r,"span",t,i)},Utils.removeHiddenNodes=function(e){for(var t=[],i=e.length,o=0;o<i;o++)J(e[o]).is(":hidden")||t.push(e[o]);return t},Utils.getClosestChild=function(e,t,i,o,r){var n,a,l,s,d,c,p=J(e);if(a=e?e.className:"",!p.parents("div.zw-column:first")[0]&&!p.parents("div.header_primary")[0]&&!p.parents("div.footer_primary")[0]&&a.indexOf("header")!=-1&&a.indexOf("footer")!=-1&&t.indexOf("contentpane")==-1&&t.indexOf("header")==-1&&t.indexOf("footer")==-1){if(a.indexOf("contentpane")==-1&&a.indexOf("page")==-1){var u=ViewManager.getElements("page");c=J(Utils.binarySearch(u,Utils.nodeCompare,o))}else c=p;for(var f=c.find("div.zw-column"),g=0,m=f.length;g<m&&(l=f.eq(g),s=l.offset().left,d=l.width(),!(s<=i&&i<=s+d||s>i));g++);n=J(f[g]?f[g]:f.last()[0]),p=n}t=DomUtil.getTagWithClassName(t);var h=p.find(t+":visible"),T=h.length;if(t.indexOf("header_primary")==-1||EditorView.isPageView()||(h=Utils.removeHiddenNodes(h)),"span.zw-portion"==t&&0==T&&(h=p.find("span.EOP"),T=h.length),1==T)return h[0];var E=J(Utils.binarySearch(h,Utils.nodeCompare,o));if(0==E.length)return e;var R,S=E.parents("table.zw-table").not(r);S[0]&&S[0]!=r&&t.indexOf("span")!=-1&&(R=J(Utils.getClosestChild(S,"td",i,o,S)),Jpara=J(Utils.getClosestChild(R,"div-zw-paragraph",i,o,S)),E=J(Utils.getClosestChild(Jpara,t,i,o,S)));var O=E,v=E.offset(),b=v.left,A=E.height(),y=v.top,D=y+A,C=b<i,I=E[0].getBoundingClientRect(),P=I.right;if("span.zw-portion"==t&&(o=Math.round(I.top+.7*(I.bottom-I.top))),C)for(;E.length>0&&b<i&&P<i&&("span.zw-portion"==t||Math.round(y)<o&&o<=Math.round(D));){for(O=E,E=E.next(t);E.is(":hidden");)E=E.next(t);if(E[0]){I=E[0].getBoundingClientRect(),P=I.right;var A=E.height();v=E.offset(),b=v.left,y=v.top,D=y+A}}else for(;E.length>0&&b>i&&P>i&&("span.zw-portion"==t||Math.round(y)<o&&o<=Math.round(D));){for(O=E,E=E.prev(t);E.is(":hidden");)E=E.prev(t);if(E[0]){I=E[0].getBoundingClientRect(),P=I.right;var A=E.height();v=E.offset(),b=v.left,y=v.top,D=y+A}}return E.length>0&&E.offset().top<o&&E.offset().top+E.height()>o&&(O=E),O[0]},Utils.getCorrectedCoord=function(e){var t,i;return"number"==typeof e.pageX?(t=e.pageX,i=e.pageY):"number"==typeof e.clientX&&(t=e.clientX,i=e.clientY,document.body&&(document.body.scrollLeft||document.body.scrollTop)?(t+=document.body.scrollLeft,i+=document.body.scrollTop):document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&(t+=document.documentElement.scrollLeft,i+=document.documentElement.scrollTop)),{x:t,y:i}},Utils.nodeCompare=function(e,t){var i=J(e),o=i.height()*editor.zoomFactor,r="";0==o&&(r=i.html(),i.html("&#8203;"));var n=i.offset().top,a=n<=t&&t<o+n,l=a?0:n<t?-1:1;return o||i.html(r),l},Utils.containsOffsetY=function(e,t){var i=J(e),o=i.offset().top,r=i.height();return o<=t&&t<r+o},Utils.makeList=function(e,t){var i,o=/^1\.\s/,r=/^a\.\s/,n=/^A\.\s/,a=/^i\.\s/,l=/^I\.\s/,s=/^\*\s/;if(o.test(e))i=LIST_TYPE.DECIMAL;else if(r.test(e))i=LIST_TYPE.LOWER_ALPHA;else if(n.test(e))i=LIST_TYPE.UPPER_ALPHA;else if(a.test(e))i=LIST_TYPE.LOWER_ROMAN;else if(l.test(e))i=LIST_TYPE.UPPER_ROMAN;else{if(!s.test(e))return;i=LIST_TYPE.RECENT_UNORDER}var d=editor.doc.getRawFormatAt(t.getEnd()-1),c=!(!d||"ON"!=d[ATTR_TEXT.TS_AUTO_COREECT]);if(c)d[ATTR_TEXT.TS_AUTO_COREECT]="OFF",editor.doc.setFormatAt(t.getEnd(),d);else{var p=editor.doc.createElement(NODE_TYPE.TEXT);p.setStart(t.getStart()),p.setEnd(t.getEnd()-1);var u=editor.doc.createElement(NODE_TYPE.TEXT,"");u.setStart(t.getStart()+1),u.setEnd(t.getEnd());var f={};f[ATTR_PARAGRAPH.PS_TYPE]="list",f[ATTR_PARAGRAPH.LS_DATA]={t:i,l:0,id:editor.doc.getNewListId()};var g=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.PARAGRAPH);List.init(f,g),editor.doc.execCmd("replace",[p,u,!0]);var m=DocUtil.copyStyle(editor.doc.getRawFormatAt(t.getStart()));m[ATTR_TEXT.TS_AUTO_COREECT]="ON",editor.doc.setFormatAt(t.getStart(),m)}},Utils.makeLink=function(e,t,i){var o=/^http(s)?:\/\/.*\..*/i,r=/^www\..*\..*/i,n=e.trim(),a=n;if(o.test(n)||r.test(n)){r.test(n)&&(a=editor.scheme+"://"+n);var l={url:a,target:"_blank",type:LINK_TYPES.WEBURL},s=editor.doc.getSelection().getStart(),d=e.length,c=editor.doc.getSelection().getLastRange();c&&c.setStart(s-d)&&c.setEnd(s-(i?0:1)),editor.doc.execCmd("CreateLink",l),t&&Command.exec("InsertChar",{cmd:"insert",element:t})}},Utils.repSplChar=function(e){return e=e.replace(/[()<#?%&>\"\'\/]/gi,"-")},Utils.replaceText=function(e,t,i){if(0!=e.length)for(var o,r=editor.doc.getSelection(),n=editor.doc.getNodesInSelection(NODE_TYPE.TEXT,t,i),a=0;o=n[a++];){for(var l=o.nodeValue,s=o.getStart(),d=o.getEnd(),c="",p=0;p<e.length;p++){var u=e[p];s<=u&&u<=d&&(u-=s,c=l.substring(0,u)+l.charAt(u).toUpperCase()+l.substring(u+1,d),l=c)}if(c.length>0){var f=editor.doc.createElement(NODE_TYPE.TEXT,c);f.setStart(s),f.setEnd(d),r.replace(o,f,!0),Op.sendMsg()}}},Utils.getMouseLogs=function(){var e="",t=EventHandler.mouseDown_coord.srcElem,i="",o="",r="",n="",a="",l="";t&&(i=t.className,o=t.id);var s=EventHandler.mouseDown_coord.portion;s&&(r=s.id,n=s.className);var d=EventHandler.mouseDown_coord.srcElem.parentNode;return d&&(a=d.id,l=d.className),e+=EventHandler.mouseDown_coord.x+" : "+EventHandler.mouseDown_coord.y+" : "+i+" : "+o+" : "+l+" : "+a+" : "+n+" : "+r},Utils.addMouseLogs=function(e){var t=EventHandler.mouseLogs.length;t>100&&(EventHandler.mouseLogs=EventHandler.mouseLogs.slice(t/2,t)),e=editor.editorPaneContainer[0].scrollTop+" : "+e+"\n",EventHandler.mouseLogs.push(e)},Utils.renamedocument=function(e,t){var i={docName:e,sessionId:editor.uuid};Utils.setCsrfParam(i),Utils.updateCaptchaInfo(i,hipurl),J.ajax({type:"POST",url:Utils.getUrl("rename"),data:i,dataType:"json",global:!1,error:function(e){UIUtils.showMessage("error",J.i18n("rename","RENAME_FAILED_MSG"),"","normalfont",5e3),t()},success:function(e){var i=editor.doc.getDocInfo();e&&"SUCCESS"==e.RESPONSE?(Utils.setDocName(e),UIUtils.showMessage("info",J.i18n("rename","RENAME_SUCCESS_MSG"),"showclose","normalfont",5e3),hipurl=void 0,1==i.VERSION&&0==i.REVISION&&ZWCollaboration.sendMessage(null,ZWCollaboration.handleRenameSaveSuccess,ZWCollaboration.handleSendMutationError)):UIUtils.showMessage("error",J.i18n("rename","RENAME_FAILED_MSG"),"","normalfont",5e3),t()}})},Utils.setDocName=function(e){var t=editor.doc.getDocInfo();t.DOCUMENT_NAME=e.DOCUMENT_NAME,t.DOCUMENT_NAME_HTML=e.DOCUMENT_NAME_HTML,t.DOCUMENT_NAME_JS=e.DOCUMENT_NAME_JS},Utils.moveToBookmark=function(e,t){if(e){var i;if(i=t?DocUtil.getFloatElementIdx(null,e):DocUtil.getFloatElementIdx(e,null),i>0)if(editor.isEditable()){var o=DocTreeManager.lineAtIndex(i);if(!o)return;var r=editor.doc.getDomCursorNode(editor.uuid,editor.zuid,"start"),n=editor.doc.getSelection(),a=editor.doc.createRange(i);n.removeAllRanges().addRange(a),Utils.scrollElementIntoView(r[0],500,!0),CurUtil.scrollTop=editor.editorPaneContainer[0].scrollTop,editor.editorOffset=editor.jeditorPane.offset(),t||DomUtil.updateMarkingDiv(),CurUtil.blinkCursor()}else{var l=editor.doc.getPortionData(i),s=l.node;Utils.scrollElementIntoView(s.parentNode,500,!0)}else PubSub.publish("Document/Warning",WARNING_MSG.BOOKMARK_REMOVED)}},Utils.getUserMode=function(e,t,i,o){var r={};Utils.setCsrfParam(r),r.rid=editor.doc.getDocInfo().RID,"REMOTE"==editor.getEditorType()&&(r.rsid=RemoteEditor.rsid),J.ajax({type:"POST",dataType:"json",url:Utils.getUrl("getUserMode"),data:r,error:function(){},success:function(e){i&&i(e,o)}})},Utils.verifyDocument=function(){editor.doc.contStr=editor.documentContent.content,editor.doc.formats=editor.documentContent.styles;var e=[],t=[],i=[],o=[],r=[],n=[],a=editor.doc.getDocumentLength();a!=editor.doc.formats.length;for(var l=0;l<a;l++){var s=editor.doc.getCharAt(l),d=editor.doc.getRawFormatAt(l);if(s==UNICODE.RANGE_START){var c=d.type?d.type:"unknown";id=d.id,"bookmark"==c?(i.push(id),o.push(l)):"comment"==c?(r.push(id),n.push(l)):"link"==c&&(e.push(id),t.push(l))}else if(s==UNICODE.RANGE_END){var c=d.type?d.type:"unknown";if(id=d.id,"bookmark"==c){var p=i.indexOf(id);i.splice(p,1),o.splice(p,1)}else if("comment"==c){var p=r.indexOf(id);r.splice(p,1),n.splice(p,1)}else if("link"==c){var p=e.indexOf(id);e.splice(p,1),t.splice(p,1)}}else if(s==UNICODE.TABLE){TableUtil.getTableEnd()}else s==UNICODE.SECTION_START}},Utils.removeUnWantedUnicodes=function(e,t){var i="";for(var o in UNICODE)if("MULTIBYTE_SPACE"!=o&&"SPACE"!=o){if(i=UNICODE[o],t&&t.contains(i))continue;e=e.replace(new RegExp(i,"gi"),"")}return e=e.replace(/\u2028|\u2029/gi,"")},Utils.isNonVisibleKey=function(e,t){for(var i in NON_PRINTABLE_KEYS){var o=NON_PRINTABLE_KEYS[i];if(o==e&&t.contains(o))return!1;if(o==e)return!0}return!1},Utils.updateAutoField=function(e){var t=editor.doc.getParents(NODE_TYPE.AUTOFIELD,parseInt(e[0])+1);t&&editor.doc.execCmd(["updateAutoField",[t,e[1]]])},Utils.getChildNodes=function(e,t){for(var i,o=J(e).find(t),r=[],n=0;i=o[n++];)J(i).parents(e.nodeName.toLowerCase())[0]==e&&r.push(i);return r},Utils.handleCaptcha=function(e){var t=J("#captcha_image")[0];if(t)t.src=editor.getBaseURL()+"/showcaptcha?digest="+e,J("#captcha_input")[0].value="";else{var i=J("#captcha");Utils.getCaptchaHTML(e).appendTo(i),i.show()}},Utils.getCaptchaHTML=function(e){var t=J("<table>"),i=J("<tr>").attr("id","captchainfo");J("<td>").css({"font-weight":"bold"}).text("ImageText").appendTo(i),J("<td>").css({color:"red","font-weight":"bold"}).attr("id","captchamsg").attr("colspan","2").text("Enter the code as seen in the picture below").appendTo(i),i.appendTo(t);var o=J("<tr>"),r=J("<td>"),n=J("<td>");return J("<img>").attr("id","captcha_image").attr("src",editor.getBaseURL()+"/showcaptcha?digest="+e).appendTo(r),r.appendTo(o),J("<input>").attr("id","captcha_input").css({border:"1px solid","border-color":"#9EB9E0 #B7CEEE #B7CEEE #9EB9E0","border-radius":"2px",height:"19px",width:"115px"}).appendTo(n),n.appendTo(o),o.appendTo(t),t},Utils.updateCaptchaInfo=function(e,t){var i=(J("#captcha_image")[0],J("#captcha_input")[0]);i&&void 0!=typeof t&&(e[t]=i.value,t=void 0)},Utils.contextMenuSupportedBrowser=function(){var e=editor.browserInfo,t=e.browserVersion_short;return e.is_chrome&&t>=43||e.is_ie&&t>=10||e.is_edge&&t>=12||e.is_firefox&&t>=41||e.is_opera&&t>=30&&!e.is_safari},Utils.fetchDocName=function(e){var t={rid:editor.doc.getDocInfo().RID,sid:editor.uuid};e&&(t.renamed=!0),Utils.setCsrfParam(t),J.ajax({async:!1,type:"POST",url:Utils.getUrl("getdocname"),data:t,dataType:"json",global:!1,error:function(e){PubSub.publish("Document/RenameFailed")},success:function(e){e&&"SUCCESS"==e.RESPONSE?(Utils.setDocName(e),PubSub.publish("Document/Renamed")):"FAILED"==e.RESPONSE&&PubSub.publish("Document/RenameFailed")}})},Utils.convertSVGToImg=function(e){return e.find("image.zw-image").each(function(){var e=document.createElement("img");e.setAttribute("src",this.getAttribute("xlink:href"));var t=J(this).parent().parent(),i=J(this),o={};o.opacity=i.css("opacity"),o.width=this.width.animVal.value,o.height=this.height.animVal.value,o.margin=i.parent().css("margin"),o.align=i.css("align"),J(e).css(o),e.setAttribute("linkdata",this.getAttribute("linkdata")),t.parent().css("overflow","hidden"),J(e).addClass("zw-image"),J(this).parent().parent().parent().append(e);var r={};r.border=t.css("border"),r.top=t.parent().css("top"),r.left=t.parent().css("left"),r.margin=t.css("margin"),r.width=t.css("width"),r.height=t.css("height"),J(e).parent().css(r),J(this).parent().parent().remove()}),e},Utils.unescapeHTML=function(e){return J("<textarea />").html(e).val()},ZWCollaboration.msgQueue=new MsgQueue,Toc=function(e,t,i,o,r,n,a){var l=!1,s={},d={},c={styles:{h1:{fs:12,ml:"0in"},h2:{fs:11,ml:"0.17in"},h3:{fw:"normal",fs:10,ml:"0.33in"},h4:{fw:"normal",fs:10,ml:"0.49in"},h5:{fw:"normal",fs:10,ml:"0.65in"},h6:{fw:"normal",fs:11,ml:"0.81in"}},theme:"classic",leader:1},p={styles:{h1:{fw:"bold",tt:"uppercase",fs:12,ml:"0in"},h2:{tt:"uppercase",fs:11,ml:"0.17in"},h3:{fst:"italic",fs:11,ml:"0.33in"},h4:{fw:"normal",fs:9,ml:"0.49in"},h5:{fw:"normal",fs:9,ml:"0.65in"},h6:{fw:"normal",fs:9,ml:"0.81in"}},theme:"formal",leader:1},u={styles:{h1:{fw:"normal",fs:11},h2:{fw:"normal",fs:11},h3:{fst:"italic",fs:10,ml:"0.17in"},h4:{fw:"normal",fs:10,ml:"0.33in"},h5:{fw:"normal",fs:10,ml:"0.49in"},h6:{fw:"normal",fs:10,ml:"0.65in"}},theme:"modern",leader:1},f={styles:{h1:{fw:"normal",fs:"11"},h2:{fw:"normal",ml:"0.17in",fs:"11"},h3:{fs:11,ml:"0.33in"},h4:{fw:"normal",ml:"0.49in",fs:10},h5:{fw:"normal",ml:"0.65in",fs:10},h6:{fw:"normal",ml:"0.81in",fs:10}},theme:"simple",leader:0},g={styles:{h1:{fw:"normal",tt:"uppercase"},h2:{fw:"normal",tt:"uppercase"},h3:{fw:"normal",tt:"uppercase",fs:11},h4:{fw:"normal",tt:"uppercase",fs:"11"},h5:{fw:"normal",tt:"uppercase",fs:"11"},h6:{fw:"normal",tt:"uppercase",fs:"11"}},theme:"contemporary",leader:0},m=function(i){var o,r,o=i[ATTR_TOC.leader],n=i.styles,a=i[ATTR_TOC.theme];for(r in n)void 0!=n[r].fw&&(d[a][r].textFormat[t.TS_FW]=n[r].fw),void 0!=n[r].tt&&(d[a][r].textFormat[t.TS_TT]=n[r].tt),void 0!=n[r].fs&&(d[a][r].textFormat[t.TS_SIZE]=n[r].fs),void 0!=n[r].ml&&(d[a][r].paraFormat[e.PS_ML]=n[r].ml),void 0!=n[r].fst&&(d[a][r].textFormat[t.TS_FS]=n[r].fst),d[a][r].paraFormat[e.PS_TPS]=[{id:0,point:"0in",align:2,leader:o}]},h={classic:c,formal:p,contemporary:g,simple:f,modern:u};(function(){var e,t,i,o=0;for(e=["classic","contemporary","formal","modern","simple"],o=0,t=e.length;o<t;o++)for(i=e[o],d[i]={},j=1;j<=6;j++)d[i]["h"+j]={},d[i]["h"+j].textFormat={type:"text"},d[i]["h"+j].paraFormat={type:"paragraph"};for(key in h)m(h[key])})(),ATTR_BORDERS.TYPE,ATTR_BORDERS.WIDTH,ATTR_BORDERS.COLOR;d.contemporary.h1.paraFormat[r.BORDES]={"border-bottom":{val:1,sz:"1px",color:"#000000"}},d.contemporary.h1.paraFormat[e.PS_LS]=1,d.modern.h1.textFormat[t.TS_FGC]="rgb(0, 176, 240)",d.contemporary.h2.paraFormat[e.PS_SB]="12pt";var T=function(){var e=0;if(e=a.findNextIndexOf(o.TOCSTART,0),s={theme:"classic",level:3,leader:1,showNo:!0,al_right:!1},e<0){var t=a.getSelection().parents(n.PARAGRAPH);e=t.getStart(),l=!1}else{l=!0,e=e;var r=a.getRawFormatAt(e);void 0!==r.theme&&(s=i.copyStyle(r))}return e},E=function(d){var c="",p={},u=[],f=T();a.getTrackChangeDetails();if("object"==typeof d?(d[ATTR_TOC.theme]=void 0!=d[ATTR_TOC.theme]?d[ATTR_TOC.theme]:s[ATTR_TOC.theme],d[ATTR_TOC.level]=void 0!=d[ATTR_TOC.level]?d[ATTR_TOC.level]:s[ATTR_TOC.level],"simple"===d[ATTR_TOC.theme]||"contemporary"===d[ATTR_TOC.theme]?s[ATTR_TOC.leader]=0:s[ATTR_TOC.leader]=1,d[ATTR_TOC.leader]=void 0!=d[ATTR_TOC.leader]?d[ATTR_TOC.leader]:s[ATTR_TOC.leader],d[ATTR_TOC.showNo]=void 0!=d[ATTR_TOC.showNo]?d[ATTR_TOC.showNo]:s[ATTR_TOC.showNo],d[ATTR_TOC.showNo]||(d[ATTR_TOC.leader]=0),d[ATTR_TOC.al_right]=void 0!=d[ATTR_TOC.al_right]?d[ATTR_TOC.al_right]:s[ATTR_TOC.al_right]):void 0==d&&(d={}),1==f&&editor.jeditorPane.find("div.heading1,div.heading2,div.heading3,div.heading4,div.heading5,div.heading6").text().length>0){var g=(a.getSelection().getStart(),a.getSelection().parents(n.PARAGRAPH)),m={type:n.PARAGRAPH};g&&(m=i.copyStyle(g.attr()));var h=i.getKeys(m),E=Utils.randomString();Op.processMsg([{r:f},{as:{start:m,id:E}},{is:o.PARA},{as:{end:h,id:E}}]),Op.sendMsg(),f+=1}l&&(d[ATTR_TOC.theme]||(d[ATTR_TOC.theme]=s[ATTR_TOC.theme],d[ATTR_TOC.level]=s[ATTR_TOC.level],d[ATTR_TOC.leader]=s[ATTR_TOC.leader],d[ATTR_TOC.showNo]=s[ATTR_TOC.showNo],d[ATTR_TOC.al_right]=s[ATTR_TOC.al_right]),f=v(f),Op.sendMsg()),d[ATTR_TOC.theme]=d[ATTR_TOC.theme]?d[ATTR_TOC.theme]:"classic";for(var R,O=0,b=a.getSectionEnd(O)-1,A=!1,y=a.getCursorPortionNode(editor.uuid,"start"),D=J(y).parents("div.zw-paragraph").first(),C=J("div#toc"),I=(C[0]?C.outerWidth()+C.position().left:D[0]?parseInt(D.css("width"))+D.position().left:editor.doc.getPaperWidth(),TabHandler.paddingLeft,(editor.doc.getPaperWidth()-48)/96),P=a.getSelection().getNodesInSelection(n.PARAGRAPH,O,b),_=f,N=[],L=P.length,w=[],M=6,U=!1,x=2,F=0;F<L;F++){var g=P[F],R=g.attr(e.PS_HD);!R||0==R||0==g.text().trim()||R>d.level?R>d.level&&(U=!0,R>x&&(x=R)):(R=parseInt(R),M>R&&(M=R),w.push(g))}L=w.length;var k=0;for(F=0;F<L;F++){var g=w[F];if(R=g.attr(e.PS_HD),R=parseInt(R),!A){var p={type:n.PARAGRAPH};if(f&&(a.getCharAt(f-1)==o.CELL||a.getCharAt(f-1)==o.HR||a.getCharAt(f-1)==o.TABLE)){var E=Utils.randomString();Op.processMsg([{r:f},{as:{start:{type:n.PARAGRAPH},id:E}},{is:o.PARA},{as:{end:["type"],id:E}}]),_+=1}c=o.TOCSTART;var B={type:"toc",theme:d[ATTR_TOC.theme],level:d[ATTR_TOC.level],leader:d[ATTR_TOC.leader],al:0,showNo:d[ATTR_TOC.showNo],al_right:d[ATTR_TOC.al_right]},H=Utils.randomString();Op.processMsg([{r:f},{as:{start:B,id:H}},{is:c},{as:{end:i.getKeys(B),id:H}}]),_+=c.length;var G={};G[r.TYPE]=n.PARAGRAPH,G[e.PS_LS]=1.2,G[e.PS_SB]="12pt",G[e.PS_SA]="12pt";var z={};z[r.TYPE]=n.TEXT,z[t.TS_SIZE]=14,z[t.TS_FW]="bold",z[t.TS_FGC]="rgb(96,96,96)";var V=d[ATTR_TOC.theme],Y=J.i18n("writer.common.TABLEOFCONTENTS");"contemporary"==V?(z[t.TS_FGC]="rgb(102,171,255)",Y=Y.toUpperCase()):"modern"==V?z[t.TS_FGC]="rgb(102,171,255)":"simple"==V&&(Y=Y.toUpperCase());var W=Utils.randomString(),j=Utils.randomString();Op.processMsg([{r:f},{as:{start:z,id:W}},{is:Y},{as:{end:i.getKeys(z),id:W}},{as:{start:G,id:j}},{is:o.PARA},{as:{end:i.getKeys(G),id:j}}]),_+=Y.length+1}A=!0;i.copyStyle(p);switch(k=R-M,R){case 1:case 2:case 3:case 4:case 5:case 6:}var Z,X=g.text(),K=g.firstChild(),$=!1,q=g.getStart();if(K&&K.type==n.BOOKMARK&&K.id&&K.id.indexOf("toc_")!=-1)Z=K.attr("name"),$=!1;else{q<f&&(_+=2),Z=Utils.randomString(),id="toc_"+Utils.randomString(),startObj={},startObj[r.TYPE]=n.BOOKMARK,startObj[r.ID]=id,startObj[r.NAME]=Z,endObj={},endObj[r.TYPE]=n.BOOKMARK,endObj[r.ID]=id;var Q=Utils.randomString(),ee=Utils.randomString();g.getStart()!=f?Op.processMsg([{r:g.getStart()},{as:{start:startObj,id:Q}},{is:o.RANGE_START},{as:{end:["type",r.ID,r.NAME],id:Q}},{r:g.getEnd()-g.getStart()-1},{as:{start:endObj,id:ee}},{is:o.RANGE_END},{as:{end:["type",r.ID],id:ee}}]):N.push({as:{start:startObj,id:Q}},{is:o.RANGE_START},{as:{end:["type",r.ID,r.NAME],id:Q}},{r:g.getEnd()-g.getStart()-1},{as:{start:endObj,id:ee}},{is:o.RANGE_END},{as:{end:["type",r.ID],id:ee}})}var te="",ie=DocTreeManager.getTreeNodeAtIndex(g.getStart()).paraProperties;ie.listData&&(te=ie.listData.listNumberString,"&#x25CF;"===te?te="●":"&#x25CB;"===te?te="○":"&#x25A0;"===te&&(te="■"));var oe=X.substring(0,X.length-1),re={para:g,bookmark_name:Z,paraContent:X.substring(0,X.length-1),cursorIdx:f,pointPosition:I,attr:d,listNumber:te};u=S(re),Op.processMsg(u),_+=oe.length+7,te&&(_+=1,_+=te.length)}if(!A&&editor.isEditable())return void(U?PubSub.publish("Document/Warning",WARNING_MSG.LOWER_HEADING_FOUND,x):PubSub.publish("Document/Warning",WARNING_MSG.HEADING_NOT_FOUND));Op.processMsg([{r:f},{as:{start:{type:n.PARAGRAPH}}},{is:o.PARA},{as:{end:["type"]}}]),_+=1;var u=[];c=o.TOCEND,u.push({r:f},{is:c}),N.length&&(u=u.concat(N)),_+=1,Op.processMsg(u),Op.fillCursorPos(_,_),Op.sendMsg()},R=function(t){var o,r={},n=0,a=[],l=t.listNumber,s=t.paraFormat,d=t.bodyFormat,c=i.copyStyle(t.textFormat),p=0,u=0;for(c=Utils.mergeObjs([c,editor.doc.getParaStyles("h0").textFormat]),r=FontUtils.getCharSize(l,FontUtils.getFontString(c)).width,a=TabHandler.defaultListTabPoints,u=d[ATTR_BODY.DS_ML].convertor().pixels,r+=u,s&&s[e.PS_ML]&&(p=s[e.PS_ML].convertor().pixels),n=0,o=a.length;n<o&&!(a[n].value>r);n++);return a[n].value-u+p},S=function(t){para=t.para,pointPosition=t.pointPosition,cursorIdx=t.cursorIdx,paraContent=t.paraContent,theme_name=t.attr[ATTR_TOC.theme],attr=t.attr,bookmark_name=t.bookmark_name;var r,a=Utils.randomString(),l=Utils.randomString(),s=para.attr("*"),c=s[e.PS_HD],p=attr[ATTR_TOC.leader],u=i.copyStyle(d[theme_name]["h"+c].textFormat);u.cls="link",u.lnktype=2,u.url=bookmark_name;var f=i.copyStyle(d[theme_name]["h"+c].paraFormat);void 0!=p&&(f[e.PS_TPS][0].leader=p);var g=[{r:cursorIdx}];if(t.listNumber){var m={};m.listNumber=t.listNumber,m.textFormat=u,m.paraFormat=f,m.bodyFormat=editor.doc.getBodyFormat(),r=R(m);var h=f[e.PS_TPS][0];f[e.PS_TPS]=[],f[e.PS_TPS][0]={id:0,point:"0in",align:0,leader:0},f[e.PS_TPS][1]=h,f[e.PS_TPS][0].point=(r+"px").convertor().inches+"in",f[e.PS_TPS][1].point=pointPosition+"in",f[e.PS_TPS][1].id=1;var T=Utils.randomString();g.push({as:{start:u,id:T}}),g.push({is:t.listNumber}),g.push({as:{end:i.getKeys(u),id:T}}),T=Utils.randomString(),g.push({as:{start:{type:n.TEXT,st:n.TAB},id:T}}),g.push({is:o.TAB}),g.push({as:{end:["type","st"],id:T}})}else f[e.PS_TPS][0].point=pointPosition+"in";var E={};E.lnktype=u.lnktype,E.url=u.url,E.cls="autopno_toc link",E.type=n.TEXT;var S=Utils.randomString(),O=Utils.randomString(),v=Utils.randomString(),b=Utils.randomString(),A=Utils.randomString(),y=Utils.randomString(),D=Utils.randomString(),C=Utils.randomString(),I=[{as:{start:{id:l,lnktype:2,target:"_self",tooltip:"",type:"link",url:bookmark_name},id:S}},{is:o.RANGE_START},{as:{end:["type","id","lnktype","target","tooltip","url"],id:S}},{as:{start:u},id:v},{is:paraContent},{as:{end:i.getKeys(u),id:v}},{as:{start:{type:n.TEXT,st:n.TAB},id:b}},{is:o.TAB},{as:{end:["type","st"],id:b}},{as:{start:{type:"autofield",id:a,ftype:"autopno"},id:y}},{is:o.RANGE_START},{as:{end:["type","id","ftype"],id:y}},{as:{start:E,id:A}},{is:"#"},{as:{end:i.getKeys(E),id:A}},{as:{start:{type:"autofield",id:a,ftype:"autopno"},id:D}},{is:o.RANGE_END},{as:{end:["type","id","ftype"],id:D}},{as:{start:{id:l,type:"link"},id:O}},{is:o.RANGE_END},{as:{end:["type","id"],id:O}},{as:{start:f,id:C}},{is:o.PARA},{as:{end:i.getKeys(f),id:C}}];return g=g.concat(I)},O=function(){E(),TocDialog.isHeadingChanged=!1},v=function(e){var t=e,i=a.findNextIndexOf(o.TOCSTART,0);if(!(i<0)){var r=a.findNextIndexOf(o.TOCEND,i)+1,n=a.getContent(i,r),l=[];return l.push({r:i},{ds:n}),Op.processMsg(l),t}};return{generate:E,deleteTOC:v,regenerateTOC:O}}(ATTR_PARAGRAPH,ATTR_TEXT,DocUtil,UNICODE,ATTR_COMMON,NODE_TYPE,editor.doc);var SnapShotManager=function(){var e=[],t=[],i=[],o=!1,r=function(){var e="";for(var t in ATTR_TEXT)e+=(e?"|":"")+ATTR_TEXT[t];return new RegExp(e)}(),n=function(e,t){for(var i=l(e);e>=0;){for(;null==editor.doc.getRawFormatAt(e)&&e>0;)e--;if(i==l(e))break;e--}return e>=0?t?editor.doc.getRawFormatAt(e)&&editor.doc.getRawFormatAt(e)[t]:editor.doc.getRawFormatAt(e):null},a=function(e){var t=editor.doc.getBodyFormat()[e];return"undefined"!=typeof t||isNaN(e)||(t=editor.doc.getListObj(e)),"object"==typeof t&&(t=DocUtil.copyStyle(t)),"st"===e&&(t="listFormat"),t},l=function(){var e={};return e[UNICODE.HR]=NODE_TYPE.HR,e[UNICODE.TABLE]=NODE_TYPE.TABLE,e[UNICODE.ROW]=NODE_TYPE.ROW,e[UNICODE.CELL]=NODE_TYPE.CELL,e[UNICODE.TABLEEND]=NODE_TYPE.TABLEEND,e[UNICODE.BR]=NODE_TYPE.BR,e[UNICODE.PARA]=NODE_TYPE.PARAGRAPH,e[UNICODE.SECTION_START]=NODE_TYPE.HEADER,function(t){var i=editor.doc.getRawFormatAt(t);return i&&i.type||e[editor.doc.getCharAt(t)]||NODE_TYPE.TEXT}}(),s=function(e){for(var t,i=e.length,o=i-1;o>=0;o--)if(t){if(t.styles.begin.type!==e[o].styles.begin.type)break;DocUtil.mergeStyles(t.styles.begin,e[o].styles.begin)}else t=e[o];return t},d={};return d.getPrevious=function(){return e.pop()},d.getLastUndoOp=function(){return e[e.length-1]},d.getLastRedoOp=function(){return t[t.length-1]},d.clearRedo=function(){t.length=0},d.isRedoQueueEmpty=function(){var e=0==t.length;return e},d.isUndoQueueEmpty=function(){var t=0===e.length&&0===i.length;return t},d.getNext=function(){return t.pop()},d.clearUndo=function(){e.length=0},d.clearRedo=function(){t.length=0},d.resetTypedCharBuffer=function(){i=[]},d.resetSnapShotManager=function(){this.clearUndo(),this.clearRedo(),this.resetTypedCharBuffer()},d.getTypedCharBuffer=function(){return i},d.getUndo=function(){return e},d.getRedo=function(){return t},d.flushTypedCharOps=function(){i.length&&(e.push(i[0]),i=[])},d.setSkipSnapShot=function(e){o=e},d.isSnapShotAllowed=function(){return!o},d.takeSnapShot=function(i){if(i&&!o){var r,n=[],a=0,l=-1,d=[],c=[],p=[],u=i.getDocOps(),f=0,g=Utils.randomString();editor.currentCommand!==COMMAND.UNDO&&editor.currentCommand!==COMMAND.REDO&&(t.length=0);for(var m,h=u.length,T=0;T<h;T++){var E,R=u[T],S="";if(R.isRetain()){if(f+=R.retain_count,a+=R.retain_count,m=p.length){f=0;var O=c[m-1],v=a,b=s(p),A=DocUtil.getKeys(d[m-1]);if(b.styles.begin.type===NODE_TYPE.BODY){n.push({r:0}),n.push({as:{end:A,id:g}}),g=Utils.randomString();continue}for(var y=u[T-1],D=y.isAnnotationEnd()?O:O+1;D<=v;D++){var C=editor.doc.getRawFormatAt(D);if(C||D==v){var I=D-O;n.push({r:I}),n.push({as:{end:A,id:g}}),g=Utils.randomString(),C&&D!=v&&(r=this.takeFmtBackup(D,b),n.push({as:{start:r,id:g}}),A=DocUtil.getKeys(r)),O=D}}}}else if(R.isInsert()){f&&(E={r:f},n.push(E),f=0);var y=u[T-1];y&&y.isAnnotationStart()&&n.pop(),S=R.characters,E={ds:S},n.push(E)}else if(R.isDelete()){S=R.delete_characters;var O=0,v=S.length,P="";f&&(E={r:f},n.push(E),f=0);for(var _="",D=O;D<v;){var C=editor.doc.getRawFormatAt(a+D);if(P=C?DocUtil.copyStyle(C):C){if(_&&(n.push({is:_}),_=""),delete P[ATTR_TEXT.TS_AUTO_COREECT],delete P[ATTR_TEXT.TS_SP],delete P[ATTR_TEXT.TS_GR],delete P.fid,E={as:{start:P,id:g}},n.push(E),P[ATTR_COMMON.TYPE]===NODE_TYPE.TEXT){var N=DocUtil.getTextStyleEnd(a+D);N-=a,N<v?n.push({is:S.substring(D,N)}):n.push({is:S.substring(D,v)}),D=N}else n.push({is:S.substring(D,D+1)}),D++;var L=DocUtil.getKeys(P);n.push({as:{end:L,id:g}}),g=Utils.randomString()}else _+=S.substring(D,D+1),D++}_?n.push({is:_}):"",a+=S.length}else if(R.isAnnotation()){var y=(u[T+1],u[T-1]);if(R.isAnnotationStart()){l=a,c.push(l),p.push(R);var w=s(p),M=this.takeFmtBackup(l,w,!0);d.push(M);var U=M.type===NODE_TYPE.BODY;(f||0===f&&U)&&(E={r:f},n.push(E),f=0),E={as:{start:M,id:g}},n.push(E)}else R.styles.end&&(d.pop(),c.pop(),p.pop())}}var x=!n.length;x&&(n=i.getDocOps());editor.currentCommand==COMMAND.UNDO?t:e;return i=DocOpBuilder.build(n),void(i=DocOpBuilder.concise(i))}},d.pushOps=function(r){if(!o){var n=!r.length;n&&(r=(new DocOpBuilder).getDocOps());var a=editor.currentCommand==COMMAND.UNDO?t:e;builder=DocOpBuilder.build(r),builder=DocOpBuilder.concise(builder);var l=[],s=[];r=builder.toJson();for(var d,c=editor.doc.getSelection(),p=c.length,u=0;u<p;u++)d=c.getRangeAt(u),l[u]=d.start,s[u]=d.end,u<p-1||(editor.currentCommand!=COMMAND.TYPING||n?(this.flushTypedCharOps(),a.push({ops:r,isCtrlSelection:c.isCtrlSelection,isListItemSelection:c.isListItemSelection,cursorStartPos:l,cursorEndPos:s})):i.length?i[0].ops[1]&&i[0].ops[1].ds&&l[0]==i[0].ops[0].r+i[0].ops[1].ds.length?i[0].ops[1].ds=i[0].ops[1].ds+r[1].ds:(this.flushTypedCharOps(),i.push({ops:r,cursorStartPos:l,cursorEndPos:s})):i.push({ops:r,cursorStartPos:l,cursorEndPos:s}))}},d.takeFmtBackup=function(e,t,i){var o,l=DocUtil.copyStyle(t.styles.begin),s={},d=l.type,c=i?n(e):editor.doc.getRawFormatAt(e);c&&(c=DocUtil.copyStyle(c),c.st&&(s.st=c.st),s.type="body"===d?d:c.type);for(o in l){var p;if("type"!==o&&l.hasOwnProperty(o)){if("body"===d)p=a(o);else{if(o==ATTR_TEXT.TS_NULL||o==ATTR_PARAGRAPH.PS_NULL){s=Utils.mergeObjs([s,c]);continue}if(c)if(c.type===NODE_TYPE.PARAGRAPH)l.type===NODE_TYPE.TEXT&&r.test(o)?(p=DocUtil.copyStyle(c[ATTR_PARAGRAPH.PS_TS]||{}),p[o]=p[o],o=ATTR_PARAGRAPH.PS_TS):p=o==ATTR_PARAGRAPH.PS_TS?DocUtil.copyStyle(c[ATTR_PARAGRAPH.PS_TS]):c[o];else if(c.type===NODE_TYPE.TABLE)if(p=c[o],"cols"!=o||p)"ver"!=o||p||(p="4.0");else{var u=editor.doc.getElementAt(e);p=u.dtNode.cols}else p=c[o];if(o===TCConstants.TC){var f=l[TCConstants.TC],g=f[0],m=g[TCConstants.TASK],h=g[TCConstants.ACTION],T=g[TCConstants.ZUID];if(m&&m==TCConstants.REMOVE?delete g[TCConstants.TASK]:g[TCConstants.TASK]=TCConstants.REMOVE,c&&c[TCConstants.TC])for(var E=0,R=c[TCConstants.TC].length;E<R;E++){var S=c[TCConstants.TC][E];if(h===S[TCConstants.ACTION]&&T===S[TCConstants.ZUID]){g[TCConstants.TIME]=S[TCConstants.TIME];break}}p=[],p.push(g)}}"undefined"==typeof p&&(p=""),s[o]=p}}return delete s.fid,delete s[ATTR_TEXT.TS_AUTO_COREECT],delete s[ATTR_TEXT.TS_GR],s},d.takeDeletedContentBackup=function(e,t,i){for(var o="",r="",n=e,a=Utils.randomString();n<t;){var l,s=editor.doc.getRawFormatAt(n);if(s||n!=e||(l=DocUtil.getStyleIndex(n,NODE_TYPE.TEXT,"prev",!0),s=editor.doc.getRawFormatAt(l)),o=s?DocUtil.copyStyle(s):s){if(r&&(i.push({is:r}),r=""),delete o[ATTR_TEXT.TS_AUTO_COREECT],delete o[ATTR_TEXT.TS_SP],delete o[ATTR_TEXT.TS_GR],delete o.fid,i.push({as:{start:o,id:a}}),o[ATTR_COMMON.TYPE]===NODE_TYPE.TEXT){var d=DocUtil.getTextStyleEnd(n);d<t?i.push({is:editor.doc.getContent(n,d)}):i.push({is:editor.doc.getContent(n,t)}),n=d}else i.push({is:editor.doc.getContent(n,n+1)}),n++;var c=DocUtil.getKeys(o);i.push({as:{end:c,id:a}}),a=Utils.randomString()}else r+=editor.doc.getContent(n,n+1),n++}r?i.push({is:r}):""},d.transformCollaboratorsOp=function(i){var o,r,n,a,l,s,d,c=editor.doc.getSelection();U.each([e,t],function(e){o=DocOpBuilder.clone(i),U.each(U.range(e.length-1,-1,-1),function(t){r=e[t],n=DocOpBuilder.build(r.ops),a=DocOpBuilder.xform(o,n),l=DocOpBuilder.concise(a.second),r.ops=l.toJson(),o=DocOpBuilder.concise(a.first),U.each(r.cursorStartPos,function(e,t){s=DocOpBuilder.build(c.createCursorOp(r.cursorStartPos[t],r.cursorEndPos[t])),a=DocOpBuilder.xform(o,s),d=a.second.getCursorPos()[0],r.cursorStartPos[t]=d.start,r.cursorEndPos[t]=d.end})})})},d}(),TableResize=function(e,t,i,o,r){var n,a,l,s,d,c,p,u,f,g,m,h,T,E,R=!1,S=!1,O=!1,v=null,b=0,A=0,y=null,D=null,C={},I=!1,P=null,_=null,N=!1,L=20,w=!1,M=Z("tableResizeIconDiv"),U=Z("tableResizeGridDiv"),x=function(e){if((S||O)&&(editor.jMultiByteSpan.css({top:editor.editorPaneContainer.scrollTop()/editor.zoomFactor}),R=!0),R){PubSub.publish("Gridlines/show"),J("div#editorpane, table").children().css({"user-select":"none","-o-user-select":"none","-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none"});var t=editor.browserInfo.is_ie?e.srcElement:e.target;v=t;var o=J(t);!o.is("td")&&o.parents("td")[0]&&(v=o.parents("td")[0]);var r=J(v).parents("table");C.x=e.clientX,C.y=e.clientY,Jeditor=editor.jeditorPane,A=Jeditor.offset().left;var n=UIUtils.getEventWithZoomFactor(e);S?(J(document.createElement("div")).attr("id","colReLine").css({height:r.height(),position:"absolute",width:"2px","border-left":"1px solid #5fabf2","z-index":10,top:i.offsetTop(r[0]),left:n.clientX-A,"-moz-user-select":"none"}).appendTo(J("#editorpane")[0]),y=J("div#colReLine")):O?(J(document.createElement("div")).attr("id","rowReLine").css({height:"2px",position:"absolute",width:r.width(),"border-top":"1px solid #5fabf2","z-index":10,top:n.clientY-b,left:i.offsetLeft(r[0]),"-moz-user-select":"none"}).appendTo(J("#editorpane")[0]),D=J("div#rowReLine")):o.css("cursor","auto")}},F=function(i){if(N=!1,_=null,I=!1,P=null,!editor.isEditable())return!1;var o,r,n,a,l,s=i.target,d=i.clientX,c=i.clientY;if(o=J(s).is("td")?s:J(s).parents("td").get(0),r=J(o),l=J("#editorpane"),n=r.parents("table").get(0),a=J(n),b=editor.jeditorPane.offset().top,R){if(EditorUtil.focusMultiByteSpan(),S&&y){var p=d-A,u=v.nextSibling&&t.getDocElement(J(v.nextSibling));a=J(v.parentElement.parentElement.parentElement);var n=t.getDocElement(a),f=n&&n.attr().cols;if(u){var g=u&&TableUtil.findColIdx(u)-1,m=e.toPixels(f[g].wt);TableUtil.isTableWidthInPercentage(n.attr())&&(m=m/100*parseFloat(n.dtNode.actualWidth))}var h=t.getDocElement(J(v));if(h){var T=TableUtil.findColIdx(h)-1,E=e.toPixels(f[T].wt);TableUtil.isTableWidthInPercentage(n.attr())&&(E=E/100*parseFloat(n.dtNode.actualWidth))}var M=C.x-A;return w=!1,p>M+m-L?p=M+m-L:p<M-E+L&&(p=M-E+L),!v.previousSibling&&C.x>=a.offset().left&&C.x<=J(v.parentElement.parentElement.parentElement).offset().left+5&&(p=d-A,p>M+E-L&&(p=M+E-L),w=!0),void y.css("left",p/editor.zoomFactor)}O&&D&&D.css("top",(i.clientY-b)/editor.zoomFactor)}if(!R&&o&&r.is("td")&&0==J(s).parents(".unselectableSection").length){var U=r.offset(),x=parseFloat(window.getComputedStyle(o).width)*editor.zoomFactor,F=a.offset().top,k=(o.offsetTop+o.offsetHeight)*editor.zoomFactor;d>U.left+x-5&&d<U.left+x+10?(r.css("cursor","col-resize"),S=!0,O=!1):c>F+k-5&&c<F+k+20?(r.css("cursor","row-resize"),O=!0,S=!1):r.parents("tr.zw-tr")[0]==a.find("tr.zw-tr")[0]&&c>=(o.offsetTop+F)*editor.zoomFactor-10&&c<=(o.offsetTop+F)*editor.zoomFactor+3||(!o.previousSibling&&d>=a.offset().left&&d<=a.offset().left+5?(r.css("cursor","col-resize"),S=!0,O=!1):(I=!1,jQuery.isEmptyObject(editor.doc.paintFormat)?r.css("cursor","auto"):r.css("cursor","pointer"),y||D||(O=!1,S=!1),d>U.left&&d<U.left+20&&c>F+k-10&&(r.css("cursor","ne-resize"),N=!0,_=o)))}},k=function(i){PubSub.publish("Gridlines/hide");var o,r=J(v).parents("table").get(0);if(y){var n=y.offset().left;o=n-C.x,y.remove(),y=null;var a=t.getDocElement(v),l=a.parentNode(),r=l.parentNode();if(w){var s=TableUtil.calculateTableMarginLeft(r.dtNode).convertUnitTo(RULER_UNITS.PIXELS),d=e.toGlobalValue(s+o+RULER_UNITS.PIXELS),c=d;o=-o}var p=oe(TableUtil.findColIdx(t.getDocElement(v)),l.dtNode),u=B(p,r,o/editor.zoomFactor);c&&(u.styArr[0][ATTR_TABLE.TBLS_ML]=c),editor.doc.execCmd("applyStyle",[u.eleArr,u.styArr,J(v).next().length?"updateColumnWidth":"updateLastColumnWidth"]),PubSub.publish("Document/TableResized")}else D&&(o=i.clientY-C.y,D.remove(),D=null,H(o/editor.zoomFactor));v=null},B=function(t,i,o){var r,n,l,s=i.attr(),d=TableUtil.isTableWidthInPercentage(s),c=i.dtNode,p=t,u=TableUtil.getCols(i),f=u.length,g=[],m=[],h=[];if(d&&(l=c.actualWidth,n=l),g.push(i),p+1===f||w){var T;if(d){a=parseFloat(i.attr(ATTR_TABLE.TBLS_WID)),n=l+o;var T=a/l*n,E=T-a;if(T>100){var R=T-100;E-=R,T=100}T=T.toFixed(3)+UNITS.PERCENTAGE;var S=100+E;if(w)for(r=0;r<f;r++){var O=u[r].wt;r==p&&(O=parseFloat(O)+E+UNITS.PERCENTAGE),O=100*parseFloat(O)/S+UNITS.PERCENTAGE,h.push({wt:O})}else for(r=0;r<f;r++){var O=u[r].wt;r==f-1&&(O=parseFloat(O)+E+UNITS.PERCENTAGE),O=100*parseFloat(O)/S+UNITS.PERCENTAGE,h.push({wt:O})}}else if(T=e.toPixels(i.attr(ATTR_TABLE.TBLS_WID)),T+=o,T=e.toGlobalValue(T+UNITS.PIXELS),w)for(r=0;r<f;r++){var O=u[r].wt;r==p&&(O=e.toGlobalValue(e.toPixels(O)+o+UNITS.PIXELS)),h.push({wt:O})}else for(r=0;r<f;r++){var O=u[r].wt;r==f-1&&(O=e.toGlobalValue(e.toPixels(O)+o+UNITS.PIXELS)),h.push({wt:O})}m.push({ver:"4.0",wid:T,cols:h})}else{if(d){var E=100*o/l;for(r=0;r<f;r++){var O=u[r].wt;r==p?O=(parseFloat(O)+E).toFixed(3)+UNITS.PERCENTAGE:r==p+1&&(O=(parseFloat(O)-E).toFixed(3)+UNITS.PERCENTAGE),h.push({wt:O})}}else for(r=0;r<f;r++){var O=u[r].wt;r==p?O=e.toGlobalValue(e.toPixels(O)+o+UNITS.PIXELS):r==p+1&&(O=e.toGlobalValue(e.toPixels(O)-o+UNITS.PIXELS)),h.push({wt:O})}m.push({ver:"4.0",cols:h})}return{eleArr:g,styArr:m}},H=function(i){try{var n,a,l,s,d=J(v),c=d.parents("table").get(0),p=(t.getDocElement(c),d.offset()),u=o.getNode(c),f=r.getViewElements(u,editor.getPageID()),g=f.length,m=(p.top+v.offsetHeight)*editor.zoomFactor,h=[],T=[],E=[];for(l=0;l<g;l++){a=J(f[l]).children("tbody").children("tr.zw-tr").children("td.zw-td");var R=a.length;for(s=0;s<R;s++)E.push(a[s])}var S=E.length;for(n=0;n<S;n++){var O=E[n],b=J(O),A=b.offset(),y=A.top*editor.zoomFactor,D=O.offsetHeight,C=y+D*editor.zoomFactor;if(C>=m-5&&C<=m+5){var I=(D+i)/e.globalUnitInPx+e.globalUnit,P=t.getDocElement(O),_={};_[ATTR_CELL.TDS_HT]=I,h.push(P),T.push(_)}}editor.doc.execCmd("applyStyle",[h,T,"updateRowHeight"])}catch(e){Utils.log("_"+ZWCollaboration.ROW_RESIZE_HEIGHT+"\nException: "+e.stack);var N=new Error(ZWCollaboration.ROW_RESIZE_HEIGHT);throw editor.lastError=N,N}},G=function(){return S},z=function(e){S=e},V=function(){return O},Y=function(e){O=e},W=function(){return R},j=function(e){R=e},X=function(){return I},K=function(e){I=e},$=function(){return P},q=function(){return N},Q=function(e){N=e},ee=function(){return _},te=function(t){if(d=t,h=d&&J(r.getViewElements(d.dtNode,editor.getPageID()))){var i=h.offset().top,o=h.offset().left,n=i+h.height()*editor.zoomFactor,a=o+h.width()*editor.zoomFactor;if(n+=parseFloat(J(h).css("borderTopWidth"))+parseFloat(J(h).css("borderBottomWidth")),a+=parseFloat(J(h).css("borderLeftWidth"))+parseFloat(J(h).css("borderRightWidth")),U.hide(),M.css({border:"1px solid #4190f2","background-color":"#d7e9ff"}),M.show(),M.offset({top:n,left:a}),TableUtil.isInnerTable(d)){var l=r.getViewElements(d.parentNode().dtNode,editor.getPageID());parseInt(d.attr().wid)>parseInt(e.toGlobalValue(J(l).width()+UNITS.PIXELS))&&(U.show(),U.height(h.height()),U.width(h.width()),U.offset({top:h.offset().top,left:h.offset().left}))}}};M.mousedown(function(e){PubSub.publish("Gridlines/show");var t=Z("drawcontainer"),i=t.height()*editor.zoomFactor,o=t.width()*editor.zoomFactor;return T=TableUtil.getCols(d),E=T.length,n=h.height()*editor.zoomFactor,a=h.width()*editor.zoomFactor,l=h.offset().top,s=h.offset().left,c=s+a,p=e.clientX-c,tableRigthCornerY=l+n,diffY=e.clientY-tableRigthCornerY,u=0,f=parseFloat(n),g=0,m=parseFloat(a),u=0,f=parseInt(n),g=0,m=parseInt(a),U.show(),M.height(i),M.width(o),M.css({"border-color":"black","border-width":"0px","border-style":"solid","background-color":"transparent"}),M.offset({top:t.offset().top,left:t.offset().left}),U.height(n),U.width(a),U.offset({top:l,left:s}),TableResize.isTableResizeIsInProgress=!0,!1}),M.mousemove(function(e){if(TableResize.isTableResizeIsInProgress){var t=Z("editorpane"),i=h.parents(".zw-contentpane"),o=e.clientX,r=e.clientY,d=20,T=20;u=r-tableRigthCornerY-diffY,f=n+u,g=o-c-p,m=a+g,o>=t.width()*editor.zoomFactor+t.offset().left?(g=t.width()*editor.zoomFactor+t.offset().left-c-p,m=a+g):o<s+T*E&&(g=s+T*E-c-p,m=a+g),r>=i.height()+i.offset().top?(u=i.height()+i.offset().top-tableRigthCornerY-diffY,f=n+u):r<l+d*h.children()[1].children.length&&(u=l+d*h.children()[1].children.length-tableRigthCornerY-diffY,f=n+u),U.width(m),U.height(f),m/=editor.zoomFactor,f/=editor.zoomFactor}}),M.mouseup(function(i){PubSub.publish("Gridlines/hide");var o=0,c=0,p=8,f=8,h=[],R=[];TableResize.isTableResizeIsInProgress=!1,U.hide(),M.hide(),U.height(o),U.width(c),M.height(p),M.width(f),M.offset({top:l+n,left:s+a}),M.css({"border-color":"black","border-width":"1px","border-style":"solid"});var S;if(setTimeout(function(){M.show()},2e3),0!=g&&m)if(d.dtNode.isTableWidthInPercentage){var O=a,v=d.attr().wid,b=m*parseFloat(v)/O;S=b.toFixed(3)+UNITS.PERCENTAGE,h.push(d),R.push({ver:"4.0",wid:S})}else{var A;for(A=0;A<E;A++){var y=e.toGlobalValue(T[A].wt),D=parseFloat(y)/parseFloat(a)*100;T[A].wt=e.toGlobalValue(parseFloat(y)+parseFloat(g)/100*D)}S=e.toGlobalValue(m+UNITS.PIXELS),h.push(d),R.push({ver:"4.0",wid:S,cols:T}),g=0}if(0!=u){var C=r.getViews(d.dtNode);if(1==C.length){var A,I,P=d.children(),_=P.length;for(A=0;A<_;A++){var N=P[A];for(I=0;I<N.children().length;I++){var L=J(r.getViewElements(N.children()[I].dtNode,editor.getPageID())),w=L.height(),x=parseFloat(w)/parseFloat(n)*100,F=parseFloat(u)/100*x,k={};k[ATTR_CELL.TDS_HT]=e.toGlobalValue(parseFloat(w)+parseFloat(F)+UNITS.PIXELS),h.push(t.getDocElement(L)),R.push(k)}}u=0}}var A;for(A=0;A<E;A++)if(0==Object.keys(T[A]).length||isNaN(parseFloat(T[A].wt))){Utils.sendErrorDetails("TABLE_RESIZE_FAIL<ZWERROR>"+editor.doc.getDocInfo().VERSION+"."+editor.doc.getDocInfo().REVISION+"."+editor.doc.getDocInfo().RID+"<ZWERROR>\n Error Log Start \n buildLabel: "+buildLabel+"\n Error Log End \n <ZWERROR>#### TABLE_RESIZE_FAIL: \n\n AditionalInfo: tableResizeByVisualCue #####");break}0!=h.length&&0!=R.length&&editor.doc.execCmd("applyStyle",[h,R,"tableResize"]),Utils.addToStatistics("tableResize");var B=editor.doc.getSelection(),H=B.getStart(),G=B.getEnd(),z=editor.doc.createRange(H,G).setFocus(!1);return B.removeAllRanges().addRange(z),!1});var ie=function(e){for(var t=editor.doc.getParents(NODE_TYPE.ROW,editor.doc.getSelection().getStart()).dtNode,i=t.children,o=0;o<=e;){var r=i[o];"fc"==r.merge?(o+=r.cspan,e+=r.cspan-1):r.merge||o++}return e},oe=function(e,t){var i=0,o=t.children[e-1];return"fc"==o.merge?i=e-1+o.cspan:o.merge||(i=e),i-1},re=function(e){for(var t=editor.doc.getParents(NODE_TYPE.ROW,editor.doc.getSelection().getStart()).dtNode,i=t.children,o=0,r=-1;o<=e;o++){var n=i[o];n.merge&&"fc"!=n.merge||r++}return r};return{mouseUp:k,mouseDown:x,resizeColumnWidth:B,mouseMove:F,isColumnResize:G,setIsColumnResize:z,isRowResize:V,setIsRowResize:Y,isInProgress:W,setIsProgress:j,getColSelection:X,setColSelection:K,getColSelectionTD:$,getCellSelectionTD:ee,setIsCellSelectionInProgress:Q,isCellSelectionInProgress:q,updateTableResizeIcon:te,getResizedCellIdx:ie,getOriginalCellIdx:oe,getVisibleCellIdx:re}}(Conversions,DocUtil,PUtil,DocTreeManager,ViewManager),TableActions=function(e,t,i,o){var r=function(o,r,n,a){try{var l,s,d,c,p,u,f,g,m,h=o.parentNode(),T=h.parentNode(),E=T.children(),R=E.length,S=h.nodeCountBefore(o),O=t.getColumnWidthsInPercentage(T.getStart()),v=T.attr(ATTR_TABLE.TBLS_WID),b=0,A=[],y=!1,D=[],C=!1;v&&v.indexOf(UNITS.PERCENTAGE)!==-1?(y=!0,v=100):v=e.toPixels(v);var I=O[S];if(0===I)for(d=S-1;d>=0;d--)if(0!==O[d]){I=O[d];break}if(r)for(d=0;d<n;d++)O.push(I);else for(d=0;d<n;d++)O.splice(S,0,I);var P=O.length;for(d=0;d<P;d++)b+=O[d];for(d=0;d<P;d++)O[d]=Math.round(O[d]/b*100*100)/100,A.push(Math.round(O[d]/100*v*1e3)/1e3);var _=[],N={},L=A.length;if(y)for(d=0;d<L;d++)ele={wt:A[d]+UNITS.PERCENTAGE},_.push(ele);else for(d=0;d<L;d++)ele={wt:e.toGlobalValue(A[d]+UNITS.PIXELS)},_.push(ele);N[ATTR_TABLE.TBLS_COLS]=_,l=r?A[S+1]:A[S],l=y?l+UNITS.PERCENTAGE:e.toGlobalValue(l+UNITS.PIXELS);var w=(T.getStart(),0);for(p=0;p<R;p++){var M=E[p],U=M.children(),x=U.length;for(u=0;u<x;u++)if(u==S){var U=(editor.doc.createElement(NODE_TYPE.CELL),M.children()),F={},k=U[S];if(void 0==k)continue;var B=k.attr();"after"!=a||r||(B=U[S-1].attr());var J;r?(D.push({r:k.getEnd()-w}),w=k.getEnd()):(D.push({r:k.getStart()-w}),w=k.getStart());for(m in B)if("wid"!=m){var H=B[m];switch(m){case ATTR_CELL.TDS_CSPAN:B[ATTR_CELL.TDS_MRG]&&"fc"===B[ATTR_CELL.TDS_MRG]&&B[ATTR_CELL.TDS_RSPAN]&&B[ATTR_CELL.TDS_RSPAN]>1&&(F[m]=1);break;case ATTR_CELL.TDS_RSPAN:B[ATTR_CELL.TDS_MRG]&&"fc"===B[ATTR_CELL.TDS_MRG]&&B[ATTR_CELL.TDS_RSPAN]&&B[ATTR_CELL.TDS_RSPAN]>1&&(F[m]=H);break;case ATTR_CELL.TDS_MRG:if("hmp"==H){if(!r){for(s=k,c=S;s;){if("fc"==s.attr(ATTR_CELL.TDS_MRG)){var G={};colSpan=s.attr(ATTR_CELL.TDS_CSPAN),G[ATTR_COMMON.TYPE]="cell",G[ATTR_CELL.TDS_CSPAN]=colSpan+n,s.attr(G);break}if("vmp"==s.attr(ATTR_CELL.TDS_MRG))break;s=s.previousSibling(),c--}F[m]=H}}else"vmp"==H?F[m]=H:"fc"===H&&B[ATTR_CELL.TDS_RSPAN]&&B[ATTR_CELL.TDS_RSPAN]>1&&(F[m]=H);break;case ATTR_CELL.TDS_WID:break;case ATTR_COMMON.BORDERS:F[m]=H;var z=T.attr(ATTR_COMMON.BORDERS);if(!z)break;var V=z[ATTR_BORDERS.BORDER_LEFT],Y=z[ATTR_BORDERS.BORDER_RIGHT],W=H[ATTR_BORDERS.BORDER_LEFT],j=H[ATTR_BORDERS.BORDER_RIGHT];if("after"==a){if(1==S&&V&&W)Utils.compareJSON(W,V)&&delete F[m][ATTR_BORDERS.BORDER_LEFT];else if(r&&Y&&j&&Utils.compareJSON(j,Y)){var Z=i.copyStyle(H);delete Z[ATTR_BORDERS.BORDER_RIGHT],k.attr({borders:Z})}}else if(0==S&&V&&W){if(Utils.compareJSON(W,V)){var Z=i.copyStyle(H);delete Z[ATTR_BORDERS.BORDER_LEFT],k.attr({borders:Z}),C=!0}}else S==U.length-1&&Y&&j&&Utils.compareJSON(j,Y)&&delete F[m][ATTR_BORDERS.BORDER_RIGHT];break;default:F[m]=H}}for(J=i.copyStyle(k.firstChild().attr()),d=0;d<n;d++){var X=Utils.randomString(),K=Utils.randomString();Utils.addId(F,"cl-",4),D.push({as:{start:F,id:X}}),D.push({is:UNICODE.CELL}),D.push({as:{end:i.getKeys(F),id:X}}),D.push({as:{start:J,id:K}}),D.push({is:UNICODE.PARA}),D.push({as:{end:i.getKeys(J),id:K}})}g||(f=F,g=k)}}if(C&&Op.sendMsg(),r)if(f[ATTR_CELL.TDS_MRG])for(s=g;s;){if("fc"==s.attr(ATTR_CELL.TDS_MRG)){curPos=s.getStart()+1;break}s=s.previousSibling()}else curPos=g.getEnd()+1;else if(f[ATTR_CELL.TDS_MRG])for(s=g;s;){if("fc"==s.attr(ATTR_CELL.TDS_MRG)){curPos=s.getStart()+1;break}s=s.previousSibling()}else curPos=g.getStart()+1;Op.resetCursorPos(),Op.fillCursorPos(curPos,curPos),editor.doc.getSelection().removeTableSelection(),editor.doc.getTrackChangeDetails().setStopProcessingTC(!0),Op.processMsg(D),editor.doc.getTrackChangeDetails().setStopProcessingTC(!1),t.setTableAttr(T,N)}catch(e){Utils.log("_"+ZWCollaboration.TABLE_INSERT_COLUMN+"\nException: "+e.stack);var $=new Error(ZWCollaboration.TABLE_INSERT_COLUMN);throw editor.lastError=$,$}},n=function(){var e,t,i,o,n,a=[],l=[],s=!1,d=editor.doc.getSelection();l=d.getSelectedColumns(),i=1,e=d.parents(NODE_TYPE.CELL);var c,p=e.attr(ATTR_CELL.TDS_CSPAN);if(p)for(c=1;c<p;c++)e=e.nextSibling();i>1?(t=e.parentNode().parentNode(),a=t.children(),o=l[l.length-1],e=a[0].children()[o],n=e.nextSibling(),e=n?n:e,n||(s=!0)):(n=e.nextSibling(),e=n?n:e,n||(s=!0)),r(e,s,i,"after")},a=function(e){var t=editor.doc.getSelection(),e=e?e:t.parents(NODE_TYPE.CELL),i=t.getSelectedColumns().length;i=1,r(e,!1,i,"before")},l=function(e,o,r,n){try{var a,l,s,d,c,p,u,f,g,m,h,T,E=e.parentNode(),R=E.attr(ATTR_TABLE.TBLS_WID),S=e.children(),O=(t.getColumnWidthsInPx(E),S.length),v=[],b=[],A=e.attr(),y={},D={},C={},I=!1;for(R&&R.indexOf(UNITS.PERCENTAGE)!==-1&&(I=!0),a=0;a<O;a++){if(l=S[a],y=l.attr(),D={},C=l.firstChild().attr(),"after"==n){for(f in y)if(g=y[f],"wid"!=f)if("cspan"===f&&y[ATTR_CELL.TDS_RSPAN]&&y[ATTR_CELL.TDS_RSPAN]>1)y[ATTR_CELL.TDS_MRG]&&"fc"===y[ATTR_CELL.TDS_MRG]&&y[ATTR_CELL.TDS_CSPAN]&&y[ATTR_CELL.TDS_CSPAN]>1&&(D[f]=g);else if("rspan"===f);else if("merge"===f)if("fc"===g)if(D[f]="vmp",y[ATTR_CELL.TDS_RSPAN]&&y[ATTR_CELL.TDS_RSPAN]>1){var P=y[ATTR_CELL.TDS_RSPAN]+1;l.attr({rspan:P})}else D[f]="fc";else if("hmp"===g)D[f]=g;else if(o){for(h=1,T=l.nextSibling();T&&(m=T.attr(ATTR_CELL.TDS_MRG),m&&"hmp"===m);)T=T.nextSibling(),h++;h>1&&(D[ATTR_CELL.TDS_CSPAN]=h,D[ATTR_CELL.TDS_RSPAN]=1,D[ATTR_CELL.TDS_MRG]="fc")}else{for(s=e.previousSibling();s;){if(d=s.children()[a],c=d.attr(),p=c[ATTR_CELL.TDS_MRG],"fc"===p){var P=c[ATTR_CELL.TDS_RSPAN];d.attr({rspan:P+r});break}s=s.previousSibling()}D[f]=g}else if(f===ATTR_CELL.TDS_WID);else if(f===ATTR_COMMON.BORDERS){D[ATTR_COMMON.BORDERS]=g;var _=E.attr(ATTR_COMMON.BORDERS);if(_){var N=_[ATTR_BORDERS.BORDER_TOP],L=_[ATTR_BORDERS.BORDER_BOTTOM],w=g[ATTR_BORDERS.BORDER_TOP],M=g[ATTR_BORDERS.BORDER_BOTTOM];if(t.findRowIdx(l.parentNode())==E.children().length&&L&&M){if(Utils.compareJSON(M,L)){var U=i.copyStyle(g);delete U[ATTR_BORDERS.BORDER_BOTTOM],l.attr({borders:U})}}else 1==t.findRowIdx(l.parentNode())&&N&&w&&Utils.compareJSON(w,N)&&delete D[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_TOP]}}else D[f]=g}else for(f in y)if(g=y[f],"cspan"===f&&y[ATTR_CELL.TDS_RSPAN]&&y[ATTR_CELL.TDS_RSPAN]>1)y[ATTR_CELL.TDS_MRG]&&"fc"===y[ATTR_CELL.TDS_MRG]&&y[ATTR_CELL.TDS_CSPAN]&&y[ATTR_CELL.TDS_CSPAN]>1&&(D[f]=g);else{if("rspan"===f)continue;if("merge"===f){if(D[f]=g,"vmp"===g)for(var s=e.previousSibling();s;){if(d=s.children()[a],c=d.attr(),p=c[ATTR_CELL.TDS_MRG],"fc"===p){var P=c[ATTR_CELL.TDS_RSPAN];d.attr({rspan:P+r});break}s=s.previousSibling()}}else{if(f===ATTR_CELL.TDS_WID)continue;if(f===ATTR_COMMON.BORDERS){D[ATTR_COMMON.BORDERS]=g;var _=E.attr(ATTR_COMMON.BORDERS);if(_){var N=_[ATTR_BORDERS.BORDER_TOP],L=_[ATTR_BORDERS.BORDER_BOTTOM],w=g[ATTR_BORDERS.BORDER_TOP],M=g[ATTR_BORDERS.BORDER_BOTTOM];if(t.findRowIdx(l.parentNode())==E.children().length&&L&&M)Utils.compareJSON(M,L)&&delete D[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM];else if(1==t.findRowIdx(l.parentNode())&&N&&w&&Utils.compareJSON(w,N)){var U=i.copyStyle(g);delete U[ATTR_BORDERS.BORDER_TOP],l.attr({borders:U})}}}else D[f]=g}}v.push(D),b.push(C)}for(u=0;u<r;u++)o?E.appendChild(A,v,b):"before"==n?E.insertBefore(e,A,v,b):(e=e.nextSibling(),E.insertBefore(e,A,v,b));var x;if(o)x=e.getEnd()+2;else if(x=e.getStart()+2,m=S[0].attr(ATTR_CELL.TDS_MRG),"vmp"===m)for(s=e.previousSibling();s;){if(d=s.children()[0],c=d.attr(),p=c[ATTR_CELL.TDS_MRG],"fc"===p){x=s.getStart()+2;break}s=s.previousSibling()}Op.fillCursorPos(x,x)}catch(e){Utils.log("_"+ZWCollaboration.TABLE_INSERT_ROW+"\nException: "+e.stack);var F=new Error(ZWCollaboration.TABLE_INSERT_ROW);throw editor.lastError=F,F}},s=function(e){var t,i=editor.doc.getSelection(),e=e?e:i.parents(NODE_TYPE.CELL),o=e.parentNode(),r=[];r=i.getSelectedRows(),t=r.length,t=t?t:1,l(o,!1,t,"before"),i.removeTableSelection()},d=function(){var e,t,i=editor.doc.getSelection(),o=i.parents(NODE_TYPE.CELL),r=o.parentNode(),n=!1,a=[];e=a.length,e=e?e:1;var s=o.attr(ATTR_CELL.TDS_RSPAN);if(s>1){var d;for(d=1;d<s;d++)r=r.nextSibling()}t=r.nextSibling(),t||(n=!0),l(r,n,e,"after"),i.removeTableSelection()},c=function(){for(var e=editor.doc.getSelection(),t=e.getSelectedCells(),i=(t.length,0),o=[],r=t[i];r;){var n=r.parentNode();if(!Utils.arrayContains(o,n.getStart())){o.push(n.getStart());var a=n.previousSibling(),l=n.nextSibling();if(!a&&!l)return void editor.doc.execCmd("deltable");n&&p(n)}i+=1,r=t[i]}},p=function(e,i){var o,r,n=e.children(),a=n.length;for(o=0;o<a;o++){var l=n[o];jsonObj=l.attr();for(r in jsonObj){var s=jsonObj[r],d=e.nextSibling(),c=e.previousSibling();if("vmp"==s)for(;c;){var p=c.children()[o];if(p.attr(ATTR_CELL.TDS_MRG)&&"fc"==p.attr(ATTR_CELL.TDS_MRG)){p.attr({rspan:p.attr("rspan")-1});break}c=c.previousSibling()}else if("fc"==s){var u=l.attr("rspan")?l.attr("rspan"):1,f=l.attr("cspan")?l.attr("cspan"):1;if(u>1){var d=e.nextSibling(),g=d.children()[o];g.attr({merge:"fc",rspan:u-1,cspan:f})}}else if(r==ATTR_COMMON.BORDERS){var m=e.parentNode(),h=m&&m.attr()[ATTR_COMMON.BORDERS];if(h){var T=h[ATTR_BORDERS.BORDER_TOP],E=h[ATTR_BORDERS.BORDER_BOTTOM],R=s[ATTR_BORDERS.BORDER_TOP],S=s[ATTR_BORDERS.BORDER_BOTTOM];if(t.findRowIdx(e)==m.children().length&&E&&S){var O=c.children()[o].attr()[ATTR_COMMON.BORDERS]||{};Utils.compareJSON(S,E)?O[ATTR_BORDERS.BORDER_BOTTOM]=S:O[ATTR_BORDERS.BORDER_BOTTOM]=R,c.children()[o].attr({borders:O})}else if(1==t.findRowIdx(e)&&T&&R){var v=d.children()[o].attr()[ATTR_COMMON.BORDERS]||{};Utils.compareJSON(R,T)?v[ATTR_BORDERS.BORDER_TOP]=R:v[ATTR_BORDERS.BORDER_TOP]=S,d.children()[o].attr({borders:v})}}}}}var i=i?i:editor.doc.getSelection().parents(NODE_TYPE.CELL),m=i.parentNode().parentNode(),f=i.attr("cspan"),u=i.attr("rspan");if(u===t.getNumberOfRows(m))return void editor.doc.execCmd("deltable");if(f&&f===t.getNumberOfColumns(m)){var u=i.attr("rspan");if(u>1){var b,A=e;for(b=1;b<u;b++)A.nextSibling().remove(),A=A.nextSibling()}}e.remove()},u=function(){try{if(editor.doc.getSelection().getSelectedCells().length>0)return void c();var e=editor.doc.getSelection().parents(NODE_TYPE.CELL),i=e.parentNode(),o=i.previousSibling(),r=i.nextSibling(),n=t.getNumberOfRows(i.parentNode());if(!o&&!r||n==e.attr().rspan)return void editor.doc.execCmd("deltable");p(i,e);var a,o=i.previousSibling();if(o)para=o.firstChild().firstChild(),a=para.getEnd()-1;else{para=i.nextSibling().firstChild().firstChild();i.nextSibling().getStart()-i.getStart();a=para.getStart()-(i.nextSibling().getStart()-i.getStart())}Op.fillCursorPos(a,a)}catch(e){Utils.log("_"+ZWCollaboration.TABLE_DELETE_ROW+"\nException: "+e.stack);var l=new Error(ZWCollaboration.TABLE_DELETE_ROW);throw editor.lastError=l,l}},f=function(i,o){try{var r=o[0],n=o.length,a=i.dtNode,l=i.children(),s=l.length,d=l[0].children().length;if(n===d)return void editor.doc.execCmd("deltable");var c,p,u,f,g,m,h,T,E={},R=[],S=[],O=[],n=o.length,v=o[o.length-1],b=a.isTableWidthInPercentage,A=(i.attr(ATTR_TABLE.TBLS_WID),0);O=t.getColumnWidthsInPx(i);var y=t.getCols(i);y.splice(r,o.length);var D=y.length;if(b){for(u=0;u<D;u++)A+=parseFloat(y[u].wt);A=A.toFixed(3)+UNITS.PERCENTAGE}else{for(u=0;u<D;u++)A+=e.toPixels(y[u].wt);A=e.toGlobalValue(A+UNITS.PIXELS)}if(b){var u,C=[];for(u=0;u<D;u++)C.push({wt:100*parseFloat(y[u].wt)/parseFloat(A)+UNITS.PERCENTAGE});y=C}for(E={},E[ATTR_TABLE.TBLS_WID]=A,E[ATTR_TABLE.TBLS_COLS]=y,c=0;c<s;c++){var I=[];for(p=0;p<d;p++)I.push(!1);R.push(I)}for(c=0;c<s;c++){row=l[c],S=row.children();var P=!1;for(p=r;p<=v;p++){if(f=S[p],g=f.attr(ATTR_CELL.TDS_MRG),f.attr(ATTR_COMMON.BORDERS)){var i=row.parentNode(),_=i.attr()[ATTR_COMMON.BORDERS],N=f.attr(ATTR_COMMON.BORDERS);if(_){var L=_[ATTR_BORDERS.BORDER_LEFT],w=_[ATTR_BORDERS.BORDER_RIGHT],M=N&&N[ATTR_BORDERS.BORDER_LEFT],U=N&&N[ATTR_BORDERS.BORDER_RIGHT];if(0==p&&L&&M){var x=f.nextSibling().attr()[ATTR_COMMON.BORDERS]||{};Utils.compareJSON(M,L)?x[ATTR_BORDERS.BORDER_LEFT]=M:x[ATTR_BORDERS.BORDER_LEFT]=U,f.nextSibling().attr({borders:x})}else if(p==S.length-1&&w&&U){var F=f.previousSibling().attr()[ATTR_COMMON.BORDERS]||{};Utils.compareJSON(U,w)?F[ATTR_BORDERS.BORDER_RIGHT]=U:F[ATTR_BORDERS.BORDER_RIGHT]=M,f.previousSibling().attr({borders:F})}}}if(g){if("fc"===g)cspan=f.attr(ATTR_CELL.TDS_CSPAN),cspan=cspan?cspan:1,m=f.attr(ATTR_CELL.TDS_RSPAN),m=m?m:1,p+cspan-1<=v?f.remove():(h=S[v+1],h.attr({merge:"fc",cspan:cspan-(v-p+1),rspan:m}),R[c][v+1]=!0,f.remove());else if("vmp"===g){if(h=S[v+1]){var k=h.attr(ATTR_CELL.TDS_MRG);if("hmp"===k){var B=!1;for(u=p;u<=v;u++){var J=S[u],H=J.attr(ATTR_CELL.TDS_MRG);if("hmp"!==H){B=!0;break}}B||h.attr({merge:"vmp"})}}f.remove()}else if("hmp"===g){if(!P){var G=p-1;for(T=f.previousSibling();T;){if("fc"==T.attr(ATTR_CELL.TDS_MRG)){if(G>=r&&G<=v)break;for(var z=1,V=f.nextSibling();V&&"hmp"===V.attr(ATTR_CELL.TDS_MRG)&&z+p<=v;)V=V.nextSibling(),z++;cspan=T.attr(ATTR_CELL.TDS_CSPAN),T.attr({cspan:cspan-z}),R[c][G]=!0;break}if("vmp"==T.attr(ATTR_CELL.TDS_MRG))break;T=T.previousSibling(),G--}P=!0}f.remove()}}else f.remove()}}var Y=r-1;Y<0&&(Y=0),f=l[0].children()[Y];var W;if(f.attr(ATTR_CELL.TDS_MRG))for(T=f;T;){if("fc"==T.attr(ATTR_CELL.TDS_MRG)){W=T.getStart()+1;break}T=T.previousSibling()}else W=f.getStart()+1;Op.fillCursorPos(W,W),t.setTableAttr(i,E)}catch(e){Utils.log("_"+ZWCollaboration.TABLE_DELETE_COLUMN+"\nException: "+e.stack);var j=new Error(ZWCollaboration.TABLE_DELETE_COLUMN);throw editor.lastError=j,j}},g=function(){var e=editor.doc.getSelection(),t=e.getSelectedColumns();f(e.parents(NODE_TYPE.TABLE),t)},m=function(e){var t=e.parentNode(),i=t.nodeCountBefore(e),o=e.attr(ATTR_CELL.TDS_CSPAN);o=o?o:1;var r,n=[];for(r=0;r<o;r++)n.push(i+r);f(e.parentNode().parentNode(),n)},h=function(){var e;editor.doc.getTrackChangeDetails().setStopProcessingTC(!0),editor.doc.getSelection().getSelectedCells().length>0?g():(e=editor.doc.getSelection().parents(NODE_TYPE.CELL),m(e)),editor.doc.getTrackChangeDetails().setStopProcessingTC(!1)},T=function(){var i=editor.doc.getSelection().parents(NODE_TYPE.CELL),o=i.parentNode(),r=o.nodeCountBefore(i),n=o.parentNode();if("fc"==i.attr(ATTR_CELL.TDS_MRG)){var a=t.getCellWidth(i),l=!1,s=i.attr("rspan"),d=i.attr("cspan");s=s?s:1,d=d?d:1,a.indexOf(UNITS.PERCENTAGE)!==-1?(l=!0,a=parseFloat(a)):a=e.toPixels(a);var c,p=t.getColumnWidthsInPx(n),u=[],f=0,g=0,m=0;for(c=0;c<d;c++){var h=r+c;0!==p[h]?(u.push(p[h]),m+=p[h]):(u.push(0),f++)}if(f>0){var T=a-m;g=T/f,g=g.toFixed(3),g=l?g+UNITS.PERCENTAGE:e.toGlobalValue(g+UNITS.PIXELS)}for(var E=o,R=0,c=0;R<s;){var S=E.children();for(c=0;c<d;){var a,O=S[r+c];0!==u[c]?(a=u[c],a=l?a+UNITS.PERCENTAGE:e.toGlobalValue(a+UNITS.PIXELS)):a=g;var v={merge:"",wid:a};(O.attr(ATTR_CELL.TDS_CSPAN)||O.attr(ATTR_CELL.TDS_RSPAN))&&(v.cspan="",v.rspan=""),O.attr(v),c++}E=E.nextSibling(),R++}}},E=function(e,i){var r=editor.doc.getElementAt(e),n=o.getTreeNodeAtIndex(e),a=n.actualWidth,l={};l[ATTR_TABLE.TBLS_WID]=i+UNITS.PERCENTAGE;var s=t.getCols(r);n.isTableWidthInPercentage&&(a=parseFloat(editor.doc.getRawFormatAt(n.getIndex())[ATTR_TABLE.TBLS_WID]));var d,c=[],p=s.length;for(d=0;d<p;d++)if(n.isTableWidthInPercentage&&s[0].wt.indexOf("%")!=-1);else if(!n.isTableWidthInPercentage){var u=s[d].wt.convertor().pixels/a*i;ele={wt:u.toFixed(3)+UNITS.PERCENTAGE},c.push(ele),l[ATTR_TABLE.TBLS_COLS]=c}t.setTableAttr(r,l)},R=function(){try{var e=editor.doc.getSelection(),t=e.parents(NODE_TYPE.TABLE),i=t.getStart();E(i,100),e.removeTableSelection()}catch(e){Utils.log("_"+ZWCollaboration.TABLE_FIT_TO_WINDOW+"\nException: "+e.stack);var o=new Error(ZWCollaboration.TABLE_FIT_TO_WINDOW);throw editor.lastError=o,o}},S=function(i){var r,n=o.getTreeNodeAtIndex(i),a=o.getDOMnodeFromDTnode(n),l=a.offsetWidth,s=editor.doc.getRawFormatAt(n.getIndex()),d=editor.doc.getElementAt(i),c=t.getCols(d),p={};p[ATTR_TABLE.TBLS_WID]=e.toGlobalValue(l+UNITS.PIXELS);var u=[],f=c.length;if(t.isTableWidthInPercentage(s)){for(r=0;r<f;r++){var g=parseFloat(c[r].wt)*parseFloat(e.toGlobalValue(l+UNITS.PIXELS))/100,m={wt:g+e.globalUnit};u.push(m)}p[ATTR_TABLE.TBLS_COLS]=u,t.setTableAttr(d,p)}},O=function(){try{var e=editor.doc.getSelection(),t=e.parents(NODE_TYPE.TABLE),i=t.getStart();S(i),e.removeTableSelection()}catch(e){Utils.log("_"+ZWCollaboration.TABLE_FIXED_COLUMN_WIDTH+"\nException: "+e.stack);var o=new Error(ZWCollaboration.TABLE_FIXED_COLUMN_WIDTH);throw editor.lastError=o,o}},v=function(){for(var e=editor.doc.getSelection(),i=editor.doc.getParents(NODE_TYPE.TABLE,e.getStart()),o=ViewManager.getViews(i.dtNode),r=[],n=0;n<o.length;n++)for(var a=o[n],l=a.getRowsHeight(),s=0;s<l.length;s++)r.push(l[s]);for(var d=-1,n=0;n<r.length;n++){var c=(r[n].ht+"px").convertor().inches;c>d&&(d=c)}if(d!=-1)for(var p=t.getCellsFromTable(i),n=0;n<p.length;n++){var u=p[n];u.attr({ht:d+"in"})}},b=function(e,t){var i,o={},r={};switch(t){case"topleft":o[ATTR_CELL.TDS_VA]="top",o[ATTR_CELL.TDS_TXTAL]="left",r[ATTR_PARAGRAPH.PS_AL]="0";break;case"topcenter":o[ATTR_CELL.TDS_VA]="top",o[ATTR_CELL.TDS_TXTAL]="center",r[ATTR_PARAGRAPH.PS_AL]="1";break;case"topright":o[ATTR_CELL.TDS_VA]="top",o[ATTR_CELL.TDS_TXTAL]="right",r[ATTR_PARAGRAPH.PS_AL]="2";break;case"middleleft":o[ATTR_CELL.TDS_VA]="middle",o[ATTR_CELL.TDS_TXTAL]="left",r[ATTR_PARAGRAPH.PS_AL]="0";break;case"middlecenter":o[ATTR_CELL.TDS_VA]="middle",o[ATTR_CELL.TDS_TXTAL]="center",r[ATTR_PARAGRAPH.PS_AL]="1";break;case"middleright":o[ATTR_CELL.TDS_VA]="middle",o[ATTR_CELL.TDS_TXTAL]="right",r[ATTR_PARAGRAPH.PS_AL]="2";break;case"bottomleft":o[ATTR_CELL.TDS_VA]="bottom",o[ATTR_CELL.TDS_TXTAL]="left",r[ATTR_PARAGRAPH.PS_AL]="0";break;case"bottomcenter":o[ATTR_CELL.TDS_VA]="bottom",o[ATTR_CELL.TDS_TXTAL]="center",r[ATTR_PARAGRAPH.PS_AL]="1";break;case"bottomright":o[ATTR_CELL.TDS_VA]="bottom",o[ATTR_CELL.TDS_TXTAL]="right",r[ATTR_PARAGRAPH.PS_AL]="2"}e.attr(o);var n=editor.doc.getNodesInSelection(NODE_TYPE.PARAGRAPH,e.getStart(),e.getEnd()),a=n.length;for(i=0;i<a;i++)n[i].attr(r)},A=function(){try{var i,o=editor.doc.getSelection(),r=o.parents(NODE_TYPE.TABLE),n=r.attr(),a=t.getCols(r),l=a.length,s=[],d=0,c=0,p=[];if(s=o.getSelectedColumns(),0==s.length)for(i=0;i<l;i++)s.push(i);if(s.length<l&&o.isTableSelected())if(t.isTableWidthInPercentage(n))for(c=100,c=parseFloat(d/s.length)+UNITS.PERCENTAGE,i=0;i<l;i++){var u;s.contains(i)?p.push({wt:c}):p.push({wt:a[i].wt})}else{for(i=0;i<l;i++)s.contains(i)&&(d+=e.toPixels(a[i].wt));for(c=e.toGlobalValue(parseInt(d/s.length)+UNITS.PIXELS),i=0;i<l;i++){var u;s.contains(i)?p.push({wt:c}):p.push({wt:a[i].wt})}}else{var f=n[ATTR_TABLE.TBLS_WID];if(t.isTableWidthInPercentage(n)){f=100;var g=f/l;for(i=0;i<l;i++){var u={wt:g.toFixed(3)+UNITS.PERCENTAGE};p.push(u)}}else{var g=e.toGlobalValue((e.toPixels(f)/l).toFixed(3)+UNITS.PIXELS);for(i=0;i<l;i++){var u={wt:g};p.push(u)}}}var m={};m[ATTR_TABLE.TBLS_COLS]=p,t.setTableAttr(r,m),o.removeTableSelection()}catch(e){Utils.log("_"+ZWCollaboration.TABLE_DISTRIBUTE_COLUMNS+"\nException: "+e.stack);var h=new Error(ZWCollaboration.TABLE_DISTRIBUTE_COLUMNS);throw editor.lastError=h,h}},y=function(){var e=editor.doc.getSelection(),t=e[0].start,r=o.getParents(NODE_TYPE.CELL,t),n=r.getIndex()+UNICODE.CELL.length,a=r.getEndIndex(),l=editor.doc.getContent(n,a),s=l.length;if(s){for(var d=new DocOpBuilder,c=function(e,t,o){var r=[];r.push({r:e}),r.push({as:{start:t}}),r.push({is:o}),r.push({as:{end:i.getKeys(t)}}),d=DocOpBuilder.concise(DocOpBuilder.compose(d,DocOpBuilder.build(r)))},p=0,u=editor.doc.getRawFormatAt(n),f=1;f<s;f++){var g=editor.doc.getRawFormatAt(n+f);if(g){var m=l.substring(p,f);c(p,u,m),p=f,u=g}}var h=l.substring(p,s);h.length&&c(p,u,h);for(var T=[],E=[],R=o.getParents(NODE_TYPE.TABLE,t),S=R.children,O=S.length,f=0;f<O;f++)for(var v=S[f],b=v.children,A=b.length,y=0;y<A;y++){var r=b[y],D=r.getIndex()+UNICODE.CELL.length,C=r.getEndIndex();T.push([D,C]);var I=editor.doc.getRawFormatAt(D-1)||{};if(!I.merge||"fc"==I.merge){d=DocOpBuilder.clone(d);for(var P,_=d.docOps,N=_.length,L=0;L<N;L++){var w=_[L],M=_[L+1];if(M&&M.characters){var U=M.characters;U!=UNICODE.RANGE_START&&U!=UNICODE.IMAGE||(P=Utils.randomString())}if(w.isAnnotation()&&w.isAnnotationStart()){var x=w.styles.begin;x.id?x.id=P:x[ATTR_COMMON.FIELDINFO]&&(x[ATTR_COMMON.FIELDINFO]=P)}}d.docOps[0].skipChars(D),E.push(d)}}Op.tableComposeOps(E,T)}},D=function(e){if(t.isVerticalMergedRow(e))return!1;var i=e.nextSibling();return!!i&&(!t.isVerticalMergedRow(i)&&(I(e,i,!0),PubSub.publish("Document/TableStructureModified"),!1))},C=function(e){var i=e.previousSibling();return!!i&&(!t.isVerticalMergedRow(i)&&(I(e,i),PubSub.publish("Document/TableStructureModified"),!1))},I=function(e,t,i){var o=e.getStart(),r=e.getEnd(),n=editor.doc.createRange(o,r).getSelectedOps();EventHandler.textDragStart=!0,editor.doc.getSelection().deleteContents(o,r),EventHandler.textDragStart=!1,i?n[0].r=t.getEnd():n[0].r=t.getStart(),Op.processMsg(n);var a=n[0].r;if(t.getStart()<e.getStart())Op.fillCursorPos(a+2,a+2+(r-o-3));else{var l=e.getEnd()-e.getStart(),s=a-l;Op.fillCursorPos(s+2,s+2+(r-o-3))}return Op.sendMsg(),!1},P=function(e){var t=e.parentNode(),i=t.parentNode(),o=i.children(),r=(o.length,t.nodeCountBefore(e)),n=e.previousSibling();n&&N(n,!1,1,r,e)},_=function(e){var t=e.parentNode(),i=t.parentNode(),o=i.children(),r=(o.length,t.nodeCountBefore(e)),n=e.nextSibling();n&&N(n,!0,1,r,e)},N=function(e,o,r,n,a){try{var l,s,d,c,p,u,f,g=e.parentNode(),m=g.parentNode(),h=m.children(),T=h.length,E=g.nodeCountBefore(e),R=m.attr(ATTR_TABLE.TBLS_WID),S=[],O=[],v=t.getCols(m);O=v;var b=O[n];O.splice(n,1),O.splice(E,0,b);var A={};A[ATTR_TABLE.TBLS_COLS]=O,A[ATTR_TABLE.TBLS_WID]=R;var y=(m.getStart(),0);for(d=0;d<T;d++){var D=h[d],C=D.children(),I=C.length;for(c=0;c<I;c++)if(c==E){var C=(editor.doc.createElement(NODE_TYPE.CELL),D.children()),P={},_=C[E];if(void 0==_)continue;0==d&&(l=_);var N,L=C[n],w=L.attr();o?(S.push({r:_.getEnd()-y}),y=_.getEnd()):(S.push({r:_.getStart()-y}),y=_.getStart());for(f in w)if("wid"!=f){var M=w[f];switch(f){case ATTR_CELL.TDS_RSPAN:w[ATTR_CELL.TDS_MRG]&&"fc"===w[ATTR_CELL.TDS_MRG]&&w[ATTR_CELL.TDS_RSPAN]&&w[ATTR_CELL.TDS_RSPAN]>1&&(P[f]=M);break;case ATTR_CELL.TDS_MRG:"vmp"==M?P[f]=M:"fc"===M&&w[ATTR_CELL.TDS_RSPAN]&&w[ATTR_CELL.TDS_RSPAN]>1&&(P[f]=M);break;case ATTR_CELL.TDS_WID:break;default:P[f]=M}}for(N=i.copyStyle(L.firstChild().attr()),s=0;s<r;s++){var U=Utils.randomString(),x=Utils.randomString();Utils.addId(P,"cl-",4),S.push({as:{start:P,id:U}}),S.push({is:UNICODE.CELL}),S.push({as:{end:i.getKeys(P),id:U}});var F=C[n],k=editor.doc.createRange(F.getStart()+1,F.getEnd()-1),B=k.getSelectedOps();B.length&&(B=B.slice(1)),S=S.concat(B),S.push({as:{start:N,id:x}}),S.push({is:UNICODE.PARA}),S.push({as:{end:i.getKeys(N),id:x}})}u||(p=P,u=_)}}editor.doc.getSelection().removeTableSelection(),editor.doc.getTrackChangeDetails().setStopProcessingTC(!0),Op.processMsg(S),editor.doc.getTrackChangeDetails().setStopProcessingTC(!1),t.setTableAttr(m,A),TableActions.deleteColumn(a),Op.resetCursorPos(),Op.fillCursorPos(l.getStart()+1,_.getEnd()),Op.sendMsg()}catch(e){Utils.log("_"+ZWCollaboration.TABLE_INSERT_COLUMN+"\nException: "+e.stack);var J=new Error(ZWCollaboration.TABLE_INSERT_COLUMN);throw editor.lastError=J,J}},L=function(e){var t,i,o={rows:e[0],cols:e[1],cellVals:e[2]||void 0,cellAttrs:e[3]||void 0},r=editor.doc.createElement(NODE_TYPE.TABLE,o);r.setStart(editor.doc.getSelection().getStart()+1);var n=editor.doc.getSelection().parents(NODE_TYPE.CELL);if(n){var a=editor.doc.getCursorPortionNode(editor.uuid,"start");t=J(a).parents("td")}UIUtils.initComponent("subpanel-table"),editor.doc.getSelection().insert(r),i=r.getStart()+4,Op.fillCursorPos(i,i)};return{insertColumnAfter:n,insertColumnBefore:a,insertRowAfter:d,insertRowBefore:s,deleteRow:u,deleteColumn:h,unMergeCells:T,fitToWindow:R,fixedColumnWidth:O,setCellAlign:b,distributeColumns:A,delRow:p,duplicateToAllCells:y,moveRowDown:D,moveRowUp:C,distributeRows:v,insertTable:L,moveColumn:N,moveColumnRight:_,moveColumnLeft:P,moveRow:I}}(Conversions,TableUtil,DocUtil,DocTreeManager),TableSplit=function(e,t,i){var o=function(){var o,r,n,a,l,s,d=editor.doc.getSelection().parents(NODE_TYPE.CELL),c=d.parentNode(),p=c.parentNode(),u=p.children(),f=u.length,g=c.nodeCountBefore(d),m=t.findRowIdx(c)-1,h=(d.parentNode().parentNode().attr(),t.getCols(p)),T=h[g].wt,E=[],R={},S=!1;T.indexOf(UNITS.PERCENTAGE)!==-1?(S=!0,T=parseFloat(T),r=T/2,r+=UNITS.PERCENTAGE):(r=e.toPixels(T),r/=2,r=e.toGlobalValue(r+UNITS.PIXELS));var O=0,v=[],b=d.attr(),A=b.cspan,y=b.rspan;if(b.merge&&"fc"==b.merge){if(A&&A>1)if(A%2==0)if(2==A){var D={};D[ATTR_CELL.TDS_MRG]="fc",D[ATTR_CELL.TDS_CSPAN]=1,d.attr(D);var C=d.nextSibling();D[ATTR_CELL.TDS_MRG]="fc",D[ATTR_CELL.TDS_CSPAN]=1,D[ATTR_CELL.TDS_RSPAN]=y?y:1,C.attr(D)}else{var D={};D[ATTR_CELL.TDS_MRG]="fc",D[ATTR_CELL.TDS_CSPAN]=A/2,d.attr(D);var I=t.findColIdx(d),E=c.children(),C=E[I+A/2-1];D[ATTR_CELL.TDS_MRG]="fc",D[ATTR_CELL.TDS_CSPAN]=A/2,D[ATTR_CELL.TDS_RSPAN]=y?y:1,C.attr(D)}else var D={}}else if(!A||1==A){for(s=0;s<f;s++){l=u[s],E=l.children(),d=E[g];var P=Utils.randomString(),_=Utils.randomString();if(s!==m){o=d.attr(),Utils.addId(o,"cl-",4),o[ATTR_CELL.TDS_MRG]="hmp",n=i.copyStyle(d.firstChild().attr()),v.push({r:d.getEnd()-O}),v.push({as:{start:o,id:P}}),v.push({is:UNICODE.CELL}),v.push({as:{end:i.getKeys(o),id:P}}),v.push({as:{start:n,id:_}}),v.push({is:UNICODE.PARA}),v.push({as:{end:i.getKeys(n),id:_}}),a=d.attr(ATTR_CELL.TDS_MRG);var R={};if(a){if("fc"===a)R[ATTR_CELL.TDS_CSPAN]=parseInt(d.attr(ATTR_CELL.TDS_CSPAN))+1,d.attr(R);else if("hmp"===a)for(firstCell=d.previousSibling();firstCell;){var N=firstCell.attr(ATTR_CELL.TDS_MRG);if("fc"===N){R[ATTR_CELL.TDS_CSPAN]=parseInt(firstCell.attr(ATTR_CELL.TDS_CSPAN))+1,firstCell.attr(R);break}if("vmp"===N)break;firstCell=firstCell.previousSibling()}}else R[ATTR_CELL.TDS_MRG]="fc",R[ATTR_CELL.TDS_CSPAN]=2,R[ATTR_CELL.TDS_RSPAN]=1,d.attr(R)}else o=d.attr(),Utils.addId(o,"cl-",4),n=i.copyStyle(d.firstChild().attr()),v.push({r:d.getEnd()-O}),v.push({as:{start:o,id:P}}),v.push({is:UNICODE.CELL}),v.push({as:{end:i.getKeys(o),id:P}}),v.push({as:{start:n,id:_}}),v.push({is:UNICODE.PARA}),v.push({as:{end:i.getKeys(n),id:_}});O=d.getEnd()}Op.processMsg(v),h.splice(g,1,{wt:r},{wt:r});var L={};L[ATTR_TABLE.TBLS_COLS]=h,t.setTableAttr(p,L)}};return{splitCells:o}}(Conversions,TableUtil,DocUtil);Replace.searchFor="",Replace.casesensitive=!1,Replace.backwards=!1,Replace.replaceStr="",Replace.replaceCount=0,Replace.searchIn="",Replace.pos=-1,Replace.replaceOn=!1,Replace.drawLineQueue=Replace.resultArray=[],Replace.drawLineIntervalId=void 0,Replace.navigator=void 0,Replace.quickSeekInfo={buttonBGColor:"#FFF500",buttonBRColor:"#FFAD00",focusClass:"animated",id:"Replace",overlayToBeAnimated:".replace-overlay"},Replace.mapAllMatchesToBulletin=function(){var e=[];U.each(Replace.resultArray,function(t){e.push({start:t[0],end:t[1]})}),Replace.quickSeekInfo.ranges=e,PubSub.publish("QuickSeek/showBarWithObj",Replace.quickSeekInfo)},Replace.getRegExForSearchStr=function(e){var t,i,o=e.length,r="";for(t=0;t<o-1;t++)i=Utils.escapeSplChars(e.charAt(t)),"]"===i&&(i="\\]"),r+="["+i+"]["+UNICODE.RANGE_START+"-"+UNICODE.RANGE_END+"]{0,}";i=e.charAt(o-1),r+="]"===i?"[\\]]":"["+Utils.escapeSplChars(i)+"]";var n="g";Replace.casesensitive||(n+="i");var a=new RegExp(r,n);return a},Replace.search=function(){var e=0,t=editor.doc.contStr,i=Replace.searchFor,o=SpellCheck.isCorrectSpellingPopupOpened();o&&(i=J("#listInvalidWord").val());var r=i.length,n=!1;if(0==r)return n;if(Replace.casesensitive||(t=editor.doc.contStr.toLowerCase(),i=Replace.searchFor.toLowerCase()),o&&(i=J("#listInvalidWord").val(),t=editor.doc.contStr),Replace.backwards){Replace.pos>0&&(t=t.substring(0,Replace.pos));var a,l,s,d,c,p,u=Replace.getRegExForSearchStr(i);if(a=t.substring(0,Replace.pos),l=u.exec(a),!l&&(a=editor.doc.contStr,l=u.exec(a),!l))return-1;for(s=0,u.lastIndex=0,c=0,p=a.length+1;c+1<p;)d=parseInt((c+p)/2),u.lastIndex=d,l=u.exec(a),l?(c=d,u.lastIndex=d):(p=d,u.lastIndex=c);l=u.exec(a),e=l.index,l&&(r=l[0].length),e<0&&!Replace.replaceAllVal&&(t=editor.doc.contStr,e=t.lastIndexOf(i))}else{var u=Replace.getRegExForSearchStr(i);u.lastIndex=Replace.pos;var f=u.exec(t);f?(e=f.index,r=f[0].length):Replace.replaceAllVal||(u.lastIndex=0,f=u.exec(t),f&&(e=f.index,r=f[0].length))}var g=editor.doc.getSectionStart(Replace.pos),m=editor.doc.getSectionEnd(Replace.pos);if(e>=0&&g<e&&e<m){var h=e,T=h+r,E=editor.doc.createRange(h,T);E.type=ZWRange.TYPE.FIND,editor.doc.getSelection().removeAllRanges().setSelectionType(SEL_AUTO_GEN).addRange(E),editor.jeditorPane.find("div.overlay").addClass("animated"),Replace.pos=editor.doc.getSelection().getEnd(),Replace.replaceOn=!0,n=!0}else Replace.replaceOn=!1;return n},Replace.updateCurrentPosition=function(){if(Replace.navigator||(Replace.navigator=J(".js_fnavigator")),!(Replace.pos<0)){var e=Replace.getRegExForSearchStr(Replace.searchFor),t=editor.doc.getSectionStart(Replace.pos),i=editor.doc.getSectionEnd(Replace.pos),o=editor.doc.getContent(t,i),r=0,n=0,a=o.match(e);if(a&&(r=a.length),r){var o=editor.doc.getContent(1,editor.doc.getSelection().getStart()),a=o.match(e);a&&(n=a.length),n!==r&&n++}Replace.navigator.text(n+" of "+r),Replace.foundText=r>0}},Replace.drawLine=function(e,t){var i=DocTreeManager.getLeftAtIndex(e),o=DocTreeManager.getLeftAtIndex(t),r=DocTreeManager.lineAtIndex(e);if(r){for(var n=[],a=DocTreeManager.linesBetween(e,t),l=a.length,s=l>1,d=0;d<l;d++){r=a[d];var c=J(r.el),p=document.createElement("div");p.className="replace-overlay";var u={};s?0===d?(u.left=i,u.width=r.width-i):(u.left=0,u.width=r.width>=o?o:r.width):(u.left=i,u.width=o-i);var f=parseFloat(c.css("padding-top")||0)+"px";u.top=f,u.height=r.height-3,J(p).css(u).appendTo(c[0]),n.push(p)}return n}},Replace.searchString=function(e,t,i,o,r){if(e){var n=editor.doc.getContent(t,i);Replace.casesensitive||(n=n.toLowerCase(),e=e.toLowerCase());for(var a,l=Replace.getRegExForSearchStr(e),s=l.exec(n);s&&s.index>-1;)a=s.index,Replace.drawLineQueue.push([t+a,t+a+s[0].length]),l.lastIndex=a+s[0].length,s=l.exec(n);o||r?r&&(Replace.resultArray=Replace.resultArray.concat(Replace.drawLineQueue)):Replace.resultArray=U.clone(Replace.drawLineQueue),clearInterval(Replace.drawLineIntervalId),Replace.drawLineIntervalId=setInterval(function(){if(0===Replace.drawLineQueue.length)return clearInterval(Replace.drawLineIntervalId),void(o||Replace.mapAllMatchesToBulletin());var e=Replace.drawLineQueue.shift();Replace.drawLine(e[0],e[1])},10),Replace.updateCurrentPosition()}},Replace.find=function(e){PubSub.publish("QuickSeek/hideBarWithID","Selection"),e?Replace.pos=e:Replace.backwards?Replace.pos=editor.doc.getSelection().getStart():Replace.pos=editor.doc.getSelection().getEnd();var t=Replace.search();return t||(Replace.pos==editor.doc.getSelection().getEnd()?0==Replace.replaceCount&&PubSub.publish("Document/Warning",WARNING_MSG.REPLACE_NO_MATCHES_FOUND):(Replace.pos=0,t=Replace.search())),t},Replace.replace=function(){var e=SpellCheck.isCorrectSpellingPopupOpened();if(e){var t=J("#listsuggestions"),i=t.find("p.ui-insert-bookmark-normal"),o=t.find("p.ui-insert-bookmark-selected");Replace.replaceStr=o.length?o.html():i.html()}var r=Replace.replaceOn;if(r){r=!0;var n=editor.doc.getSelection().getEnd(),a=editor.doc.getSelection().getStart(),l=editor.doc.contStr;e&&(Replace.searchFor=J("#listInvalidWord").val());var s=(Replace.searchFor,l.substring(0,a)+Replace.replaceStr+l.substring(n));s==l&&Replace.searchFor!==Replace.replaceStr||(Replace.replaceOn=!1,Replace.replaceCount++,Replace.replaceText(a,n),Replace.searchIn=editor.doc.contStr,Replace.pos=editor.doc.getSelection().getEnd())}else 0==Replace.replaceCount?PubSub.publish("Document/Warning",WARNING_MSG.REPLACE_NO_MATCHES_FOUND):Replace.replaceCount>0&&(PubSub.publish("Document/Warning",WARNING_MSG.REPLACE_SEARCH_COMPLETED_MSG,Replace.replaceCount),Replace.pos=0,Replace.replaceCount=0,Replace.replaceOn=!1);return r},Replace.replaceAll=function(){Replace.replaceAllVal=!0,Replace.pos=0;var e,t,i=editor.doc,o=i.contStr,r=Replace.searchFor,n=r.length,a=0,l=i.getSectionStart(Replace.pos),s=i.getSectionEnd(Replace.pos),d=Replace.replaceStr,c=d.length,p=0;if(SpellCheck.isCorrectSpellingPopupOpened()){r=J("#listInvalidWord").val(),n=r.length;var u=J("#listsuggestions"),f=u.find("p.ui-insert-bookmark-normal"),g=u.find("p.ui-insert-bookmark-selected");Replace.replaceStr=g.length?g.html():f.html(),d=Replace.replaceStr,c=d.length}for(Replace.casesensitive||(o=o.toLowerCase(),r=r.toLowerCase());;){if(e=Replace.getRegExForSearchStr(r),e.lastIndex=a,t=e.exec(o),!t)break;if(a=t.index,a<l||a>s)break;var m=a,h=m+n,T=i.getContent(m,h),E=i.createElement(NODE_TYPE.TEXT,T);E.setStart(m),E.setEnd(h);var R=i.createElement(NODE_TYPE.TEXT,d);R.setStart(m),R.setEnd(m+c),editor.doc.getSelection().replace(E,R),editor.doc.getTrackChangeDetails().canHandleTC()&&(Op.sendMsg(),a+=c,o=i.contStr,Replace.casesensitive||(o=o.toLowerCase()),l=i.getSectionStart(0),s=i.getSectionEnd(0)),a+=n,p++}0==p?PubSub.publish("Document/Warning",WARNING_MSG.REPLACE_NO_MATCHES_FOUND):p>0&&(Op.sendMsg(),PubSub.publish("Document/Warning",WARNING_MSG.REPLACE_SEARCH_COMPLETED_MSG,p),Replace.pos=0,Replace.replaceCount=0,Replace.replaceOn=!1),Replace.replaceAllVal=!1},Replace.replaceText=function(e,t){var i=editor.doc.getContent(e,t),o=editor.doc.createElement(NODE_TYPE.TEXT,i);o.setStart(e),o.setEnd(t);var r=editor.doc.createElement(NODE_TYPE.TEXT,Replace.replaceStr);if(r.setStart(e),r.setEnd(e+Replace.replaceStr.length),editor.doc.execCmd("replace",[o,r,!0]),editor.doc.getTrackChangeDetails().canHandleTC()){var n=editor.doc.getSelection().getLastRange();n&&n.setStart(editor.doc.getSelection().getStart()+Replace.searchFor.length)&&n.setEnd(editor.doc.getSelection().getEnd()+Replace.searchFor.length)}Replace.find()},Replace.openFindMenu=function(e){Utils.addToStatistics("FindIn"),Replace.addSubscribers();var t=J("#findToolbar"),i={"margin-top":0};t.css(i),e&&t.find("#find_advanced_option").hide(),EventHandler.isDialogOpened=!0,t.show().find("input").select(),Replace.navigator=J(".js_fnavigator");var o=t.animate(100,function(){J(this).show().find("input").focus(),setTimeout(function(){CurUtil.stopBlinking()},100)}).find("input");Replace.findAllTexts(o),o.unbind("input").bind("input",function(){Replace.findAllTexts(o)}).unbind("keydown").bind("keydown",function(e){var t=e.keyCode,i=String.fromCharCode(t).toLowerCase();if(t===KEYS.ENTER||t===KEYS.F3||(e.metaKey||e.ctrlKey)&&"g"===i)return Replace.findTextInDocument||Replace.findAllTexts(void 0,!0),e.shiftKey?(Replace.backwards=!0,Replace.find(editor.doc.getSelection().getStart())):(Replace.backwards=!1,Replace.find()),Replace.updateCurrentPosition(),!1;if(t===KEYS.ESC)return Replace.closeFindMenu(),!1;var t=e.keyCode,i=String.fromCharCode(t).toLowerCase();return(!e.metaKey&&!e.ctrlKey||"f"!==i)&&void 0}).focus(function(){EventHandler.isDialogOpened=!0,CurUtil.stopBlinking()}).blur(function(){EventHandler.isDialogOpened=!1,CurUtil.blinkCursor()})},Replace.findAllTexts=function(e,t){editor.jeditorPane.find("div.replace-overlay,div.animated").remove(),e&&(Replace.searchFor=Utils.removeUnWantedUnicodes(e.val())),Replace.findTextInDocument=!1,0==Replace.searchFor.length&&Replace.drawLineIntervalId&&(clearInterval(Replace.drawLineIntervalId),Replace.drawLineIntervalId=void 0,PubSub.publish("QuickSeek/hideBarWithID","Replace")),Replace.searchFor.length>0||t?(Replace.drawLineQueue=[],Replace.drawLineIntervalId&&(clearInterval(Replace.drawLineIntervalId),Replace.drawLineIntervalId=void 0),Replace.findTextInDocument=!0,setTimeout(function(){Replace.searchString(Replace.searchFor,0,editor.doc.getDocumentLength()),Replace.find(editor.doc.getSelection().getStart()),Replace.updateCurrentPosition()},500)):(Replace.updateCurrentPosition(),PubSub.publish("QuickSeek/hideBarWithID","Replace"))},Replace.findPrevious=function(){J("#findToolbar").find("input").select(),Replace.backwards=!0,Replace.findTextInDocument||Replace.findAllTexts(void 0,!0),Replace.find(editor.doc.getSelection().getStart()),Replace.updateCurrentPosition()},Replace.findNext=function(){J("#findToolbar").find("input").select(),Replace.findTextInDocument||Replace.findAllTexts(void 0,!0),Replace.backwards=!1,Replace.find(editor.doc.getSelection().getEnd()),Replace.updateCurrentPosition()},Replace.closeFindMenu=function(){PubSub.publish("QuickSeek/hideBarWithID","Replace");var e=J("#findToolbar");e.hide(),Replace.unsubscribe(),Replace.resultArray=[],ReplaceDialog.handleClose(),EditorUtil.focusMultiByteSpan()},Replace.findTextInPara=function(e){if(Replace.searchFor&&!Replace.replaceAllVal){var t=e.getIndex(),i=e.getEndIndex();DocTreeManager.doc.docopBuilder&&"InsertChar"===DocTreeManager.doc.docopBuilder.operation||i++,Replace.searchString(Replace.searchFor,t,i,!0,!1)}},Replace.findTextInLine=function(e,t){if(Replace.searchFor&&!Replace.replaceAllVal){var i=t.parent.getIndex();Replace.searchString(Replace.searchFor,i+t.start,i+t.end,!1,!0)}},Replace.addSubscribers=function(){PubSub.subscribe("paraview/create",Replace.findTextInPara),PubSub.subscribe("Document/lineview/update",Replace.findTextInLine)},Replace.unsubscribe=function(){PubSub.unsubscribe("paraview/create",Replace.findTextInPara),PubSub.unsubscribe("Document/lineview/update",Replace.findTextInLine)},PasteUtil=function(){"use strict";var e=function(e){if(!e)return!1;var t=e.children;return!(!t||1!=t.length)&&Utils.nodeNameEquals(t[0],"img");},t=null,i=new RegExp(CONST.PASTE_DESTINATIONFORMAT+"|"+CONST.PASTE_SOURCEFORMAT+"|"+CONST.PASTE_TEXTONLYFORMAT),o=function(){var e=editor.doc.getSelection();t=e.getSelectedCells()},r=function(){return t||[]},n=function(e){for(var t=editor.doc.getSelection(),i=t.parents(NODE_TYPE.TABLE),o=i.children(),n=(o.count,t.parents(NODE_TYPE.CELL)),a={},l=0,s=0,d=J(e).children("table")[0],c=r(),p=0;p<o.length;p++)for(var u=o[p],f=u.children(),g=0;g<f.length;g++){var m=f[g];a[m.getStart()]=[p,g]}var h=a[n.getStart()],T={};if(d){var E=Utils.getChildNodes(d,"tr");if(c.length)for(var R=h[0],S=h[1],O=[],v=0,b=null,A=0;A<c.length;A++){var y=c[A];if(y.dtNode.isVisible&&O.indexOf(y.dtNode.id)==-1){var D=TableUtil.findRowIdx(y.parentNode())-1,C=TableUtil.findColIdx(y)-1,I=(D-R)%E.length,P=Utils.getChildNodes(E[I],"th,td"),_=(C-S)%P.length;w=v!=D?P[_]:b&&b.nextSibling?b.nextSibling:P[0],O.push(y.dtNode.id),w&&(PastePreProcess.processTD(w),T[D+"|"+C]=w.innerHTML),v=D,b=w}}else for(var u,p=h[0];u=o[p++];){var N=E[l];if(!N)break;l++;for(var L,f=u.children(),g=h[1];L=f[g++];){for(;L&&L.attr("merge")&&"fc"!=L.attr("merge");)L=f[g++];if(L){var w=Utils.getChildNodes(N,"th,td")[s];s++;var M=p-1+"|"+(g-1);w&&(PastePreProcess.processTD(w),T[M]=w.innerHTML)}}s=0}}else for(var A=0;A<c.length;A++){var y=c[A],U=TableUtil.findRowIdx(y.parentNode())-1+"|"+(TableUtil.findColIdx(y)-1);PastePreProcess.processTD(e),T[U]=e.innerHTML}var x=[],F=[],k=document.getElementById("pasteFrame"),B=k.contentWindow.document.getElementsByTagName("body")[0];for(var H in T){var G=H.substring(0,H.indexOf("|")),z=H.substring(H.indexOf("|")+"|".length),V=o[G],f=V.children(),Y=f[z];x.push([Y.getStart()+1,Y.getEnd()]),B.innerHTML=T[H];var W=PastePreProcess.getProcessedHTML(B),j=Paste.getOp(W,Y.getStart()+1),Z=DocOpBuilder.build(j);Z&&F.push(Z)}for(var X=[],A=F.length-1;A>-1;A--)X.push(F[A]);for(var K=X[0],A=0;A<X.length;A++){var $=X[A+1];$&&(K=DocOpBuilder.compose(K,$))}for(var q=[],A=x.length-1;A>-1;A--){var Q=[{r:x[A][0]},{ds:editor.doc.getContent(x[A][0],x[A][1])}];q.push(DocOpBuilder.build(Q))}for(var ee=q[0],te=0;te<q.length;te++){var $=q[te+1];$&&(ee=DocOpBuilder.compose(ee,$))}var ie=DocOpBuilder.xform(K,ee),oe=DocOpBuilder.compose(K,ie.second);Op.fillCursorPos(x[0][0],x[0][0]),Op.processMsg(JSON.parse(oe.toString()))},a=function(e){var t=!1,i=editor.doc.getSelection(),o=i.parents(NODE_TYPE.TABLE);if(o)for(var n,a=e.childNodes,l=0,s=0;n=a[s++];){if(0!=l||!Utils.nodeNameEquals(n,"table")){t=!1;break}l++,t=!0}return!(t||!o||!r().length)||t},l=function(e){return 1==e.childNodes.length&&Utils.nodeNameEquals(e.childNodes[0],"#text")},s=function(){var e=Z("_zohoPaste")[0],t=editor.browserInfo.is_ie?document.body.createTextRange():document.createRange();editor.browserInfo.is_ie?(t.moveToElementText(e),t.select()):(window.getSelection().removeAllRanges(),t.selectNodeContents(e),window.getSelection().addRange(t))},d=function(e){var t="";for(var i in UNICODE)"MULTIBYTE_SPACE"!=i&&"SPACE"!=i&&"MERGEFIELD_START"!=i&&"MERGEFIELD_END"!=i&&"PARA"!=i&&"TAB"!=i&&"HR"!=i&&(t=UNICODE[i],e=e.replace(new RegExp(t,"gi"),""));return e=e.replace(/\u2028|\u2029|\u200b|\u000d/gi,""),e=e.replace(/[\u00a0]/g," ")},c=function(e){var t=J(e).find("[data-doc-rid]")[0];return t&&t.getAttribute("data-doc-rid")==editor.doc.docInfo.RID},p=function(e){if(InsertShape.selectedShape())return void InsertShape.copy();if(!e){var t=editor.doc.getSelection();e="",U.each(t,function(t){e+=HTMLUtil.getHTML(t)}),t.length>1&&Utils.addToStatistics("copy_ON_MUL_SEL")}var i={htmlCont:e};PubSub.publish("DocOperation/AfterGettingSelectedHTML",i),g(i.htmlCont)},u=function(){return g(),s(),!1},f=function(e){var t=J(e).css("list-style-type");return t="none"!=t?List.getListType(t):Utils.nodeNameEquals(e,"ol")?LIST_TYPE.DECIMAL:LIST_TYPE.DISC},g=function(e){var t=Z("_zohoPaste"),i=editor.editorPaneContainer.scrollTop()/editor.zoomFactor;editor.doc.getPaperWidth();i<=0&&(i=20),t.css({top:i,left:"100px",width:"200px",height:"1px",backgroundColor:"transparent"}).show(),t[0].innerHTML=e||"",t[0].contentEditable=!0,t[0].focus()},m=function(){var e=Z("_zohoPaste");e.hide()},h=function(){var e=J("#pastemenu"),t=Paste.getPasteOpn();e.zmenu("hideAllMenuItems");var i=Paste.getListPasteInfo();i.isSameDoc&&i.nonListPaste?(e.zmenu("showMenuGroup","listFromWriter",!0),t==CONST.PASTE_ASNEWLIST?e.zmenu("check","pasteNewList"):t==CONST.PASTE_CONTINUELIST&&e.zmenu("check","continueList")):!i.isSameDoc&&i.isListPaste?(e.zmenu("showMenuGroup","listFromOutside",!0),t==CONST.PASTE_MERGELIST?e.zmenu("check","mergeList"):t==CONST.PASTE_DONT_MERGELIST&&e.zmenu("check","newList")):i.sameListPaste||(e.zmenu("showMenuGroup","normalPasteOptions",!0),t==CONST.PASTE_SOURCEFORMAT?e.zmenu("check","sourceFormat"):t==CONST.PASTE_DESTINATIONFORMAT?e.zmenu("check","destinationFormat"):e.zmenu("check","textOnly"))},T=function(e){var t=new FileReader;t.onload=function(e){var t=e.target.result,i=document.createElement("img"),o=document.getElementById("pasteFrame"),r=o.contentWindow.document.getElementsByTagName("body")[0];i.src=t,r.innerHTML=i.outerHTML,Paste.setPasteInfo(o.contentWindow.document.documentElement.outerHTML),editor.doc.execCmd("paste",[CONST.PASTE_SOURCEFORMAT,r.innerHTML,null])},t.readAsDataURL(e)},E=function(){var e=Paste.getListPasteInfo(),t=Paste.getPasteInfo(),i=document.createElement("div");return t.HTML&&(i.innerHTML=t.HTML),!i||!(t.isTablePaste||t.isImagePaste||t.isUnformattedTextPaste||e.sameListPaste)},R=function(e,t){J(e).find("img").removeAttr("onload onerror"),Op.processMsg(S(e,t));var i=editor.doc.getSelection();i.isCollapsed()||(i.deleteSelectedContents(),Op.sendMsg()),Op.sendMsg()},S=function(e,t){Paste.setPasteOpn(i.test(t)?t:CONST.PASTE_SOURCEFORMAT);var o=PastePreProcess.getProcessedHTML(e);return Paste.getOp(o,editor.doc.getSelection().getStart())};return{handleImagePaste:T,positionPasteDiv:g,getListType:f,updatePasteOptionsMenu:h,preparePasteDiv:u,copyToClipboard:p,removeDocUniCodes:d,isSameDocumentPaste:c,focusPasteDiv:s,hidePasteDiv:m,isUnformattedTextPaste:l,isTablePaste:a,shouldShowPasteToolbar:E,isImagePaste:e,handleTablePaste:n,setSelectedCells:o,insertCustomContent:R,getOpForCustomConent:S}}(),Nav.moveDown=function(e){try{var t=editor.doc.getSelection(),i=t.getLastRange(),o=e?t.getLastModifiedPosition():"end",r="start"==o?i.start:i.end,n=editor.doc.getCharAt(r),a=r;if(r&&editor.doc.getCharAt(r+1)==UNICODE.SECTION_START)return r;n==UNICODE.RANGE_START&&(a=DocUtil.getRangeEnd(r)+1);var l=DocTreeManager.lineAtIndex(r),s=t.getClientLeft(o)||CurUtil.offset.start.left;s||(s=CurUtil.getBounds(o).left);var d=Nav.getNextLine(l,s);if(d&&"content"!=DocTreeManager.doc.getSection(r).name&&(d=DocTreeManager.lineAtIndex(d.absStart,editor.getPageID())),!d||!d.el)return e?l.absEnd:r;var c=ViewManager.getPageAtIndex(d.absStart);c&&(c.isPageRendered||(editor.visiblePageNumbers.push(c.pageNumber),c.forceToRender()),c.content&&c.content.el&&(c.content.el.style.display="block"));for(var p=J(l.el).find(".zw-portion,.EOP").last()[0],u=J(d.el).find(".zw-portion,.EOP"),f=u.length,g=0;g<f;g++){var m=u[g].getBoundingClientRect();if(s<m.right){p=u[g];break}g+1==f&&(p=u[g])}var h=CurUtil.getCursorLineOffset(p)+CurUtil.getCursorPortionOffset(p),T={cursorOffset:DocTreeManager.doc.getIndexAtLeft((s-J(d.el).offset().left)/editor.zoomFactor,d)},E=T.cursorOffset;E&&editor.doc.getCharAt(E-1)==UNICODE.BR&&E--,r==E&&E++;var R=p.className;return DocUtil.isNonEditablePortion(R)?E=h-1:E&&editor.doc.getCharAt(E-1)==UNICODE.RANGE_START&&E--,e&&n==UNICODE.RANGE_START&&E<a&&(E=a),n==UNICODE.PARA&&editor.doc.getCharAt(r+1)==UNICODE.BR?(EventHandler.mouseDown_coord.isLineEnd=!0,EventHandler.mouseDown_coord.portion=J(d.el).find("span.zw-portion,span.EOP")[0]):T.cursorOffset==Utils.textLen(p)&&(EventHandler.mouseDown_coord.isLineEnd=!0,EventHandler.mouseDown_coord.portion=p),E}catch(e){Nav.sendErrorDetails(e)}},Nav.moveUp=function(e){try{var t=editor.doc.getSelection(),i=t.getLastRange(),o=e?t.getLastModifiedPosition():"start",r="start"==o?i.start:i.end,n=editor.doc.getCharAt(r>0?r-1:r),a=DocTreeManager.lineAtIndex(r,editor.getPageID()),l=t.getClientLeft(o)||CurUtil.offset.start.left;l||(l=CurUtil.getBounds(o).left);var s=t.findPrevious(NODE_TYPE.PARAGRAPH+"|"+NODE_TYPE.TEXT+"|"+NODE_TYPE.BR);if(r&&editor.doc.getCharAt(r-1)==UNICODE.SECTION_START)return r;if(r>=2&&editor.doc.getCharAt(r-2)==UNICODE.PARA&&editor.doc.getCharAt(r-1)==UNICODE.BR){var d=Nav.getPrevLine(a,l);return"content"!=DocTreeManager.doc.getSection(r).name&&(d=DocTreeManager.lineAtIndex(d.absStart,editor.getPageID())),EventHandler.mouseDown_coord.isLineEnd=!0,EventHandler.mouseDown_coord.portion=J(d.el).find("span.zw-portion,span.EOP")[0],r-1}if(s&&(s.type==NODE_TYPE.BR||s.type==NODE_TYPE.PARAGRAPH)){var c=t.findPrevious(NODE_TYPE.TEXT+"|"+NODE_TYPE.BR,"",s);if(c&&c.type==NODE_TYPE.BR)return s.getStart()}var p=r-1;n==UNICODE.RANGE_END&&(p=DocUtil.getRangeStart(r-1));var d=Nav.getPrevLine(a,l);if(d&&"content"!=DocTreeManager.doc.getSection(r).name&&(d=DocTreeManager.lineAtIndex(d.absStart,editor.getPageID())),!d||!d.el)return e?a.absStart:r;var u=ViewManager.getPageAtIndex(d.absStart);u&&(u.isPageRendered||(editor.visiblePageNumbers.push(u.pageNumber),u.forceToRender()),u.content&&u.content.el&&(u.content.el.style.display="block"));for(var f=a.el.firstChild,f=J(a.el).find(".zw-portion,span.EOP").first()[0],g=J(d.el).find(".zw-portion,span.EOP"),m=g.length,h=m-1;h>=0;h--){var T=g[h].getBoundingClientRect();if(T.left<=l+1){f=g[h];break}0==h&&(f=g[h])}var E=CurUtil.getCursorLineOffset(f)+CurUtil.getCursorPortionOffset(f),R={cursorOffset:DocTreeManager.doc.getIndexAtLeft((l-J(d.el).offset().left)/editor.zoomFactor,d)},S=R.cursorOffset,O=f.className;return S&&editor.doc.getCharAt(S-1)==UNICODE.BR&&S--,DocUtil.isNonEditablePortion(O)?S=DocUtil.getRangeEnd(E-1)+1:S&&editor.doc.getCharAt(S-1)==UNICODE.RANGE_START&&S--,e&&n==UNICODE.RANGE_END&&S>p&&(S=p),R.cursorOffset==Utils.textLen(f)&&(EventHandler.mouseDown_coord.isLineEnd=!0,EventHandler.mouseDown_coord.portion=f),S}catch(e){Nav.sendErrorDetails(e)}},Nav.moveLeft=function(e){var t={element:"",position:!0},i=editor.doc.getSelection(),o=i.getLastModifiedPosition(),r=i.getStart();if("end"==o&&(r=i.getEnd()),r&&editor.doc.getCharAt(r-1)==UNICODE.SECTION_START)return t;var n=editor.doc.getCharAt(r-1);if(i.isCollapsed()&&(n==UNICODE.CELL||n==UNICODE.TABLEEND)){var a=n==UNICODE.CELL?r-1:editor.doc.findPreviousIndexOf(UNICODE.CELL,r)+1;if(a>0){var l=editor.doc.getParents(NODE_TYPE.CELL,a),s=TabKeyHandler.getNextVisibleCell(l,!0);if(s&&s.getStart()!=l.getStart()){var d=i.getLastRange();d&&d.setStart(s.getEnd())}}}if(r>=2&&editor.doc.getCharAt(r-2)==UNICODE.PARA&&editor.doc.getCharAt(r-1)==UNICODE.BR){var c=DocTreeManager.lineAtIndex(o),p=Nav.getPrevLine(c);EventHandler.mouseDown_coord.isLineEnd=!0,EventHandler.mouseDown_coord.portion=J(p.el).find("span.zw-portion,span.EOP")[0]}if(r&&editor.doc.getCharAt(r-1)==UNICODE.RANGE_END){var u=editor.doc.getRawFormatAt(r-1);if(e&&(!u.id||u.id.indexOf("toc")==-1)||u&&DocUtil.isNonEditablePortion(u.type)){t.position=!1;var f=DocUtil.getRangeStart(r-1),g=editor.doc.createElement(NODE_TYPE.TEXT);return g.setStart(f),g.setEnd(f),t.element=g,t}}if(t.element=i.find("previous",NODE_TYPE.TEXT+"|"+NODE_TYPE.PARAGRAPH+"|"+NODE_TYPE.BR,o),!e&&t.element&&t.element.getStart()){var m=editor.doc.getRawFormatAt(t.element.getStart()-1);if(m&&(m.type==NODE_TYPE.TABLE||"bookmark"==m.type||"link"==m.type||"comment"==m.type||"endnote"==m.type||"footnote"==m.type))if(m.type==NODE_TYPE.TABLE)t.element=editor.doc.getElementAt(t.element.getStart()-2).lastChild(),t.position=!1;else{var h=editor.doc.getCharAt(t.element.getStart()-1);h==UNICODE.RANGE_START&&(t.element=editor.doc.getElementAt(t.element.getStart()-1))}}if(e){var m,T=editor.doc.getRawFormatAt(t.element.getStart()+1);if(T&&T.type==NODE_TYPE.ROW||editor.doc.getCharAt(t.element.getStart()+1)==UNICODE.TABLEEND){for(var E=DocTreeManager.lineAtIndex(t.element.getStart()),R=E.parent.parent,S=R.parent,O=S.parent,v=S.parent.children,b=0;b<v.length;b++)if(S.id===v[b].id){0==b?(t.element=editor.doc.getElementAt(O.prev.end-1).lastChild(),t.position=!1):(t.element=i.find("previous",NODE_TYPE.TABLE+"|"+NODE_TYPE.ROW,o),"start"==o&&(t.position=!1));break}}else(m=editor.doc.getRawFormatAt(t.element.getStart()-1))&&m.type==NODE_TYPE.TABLE&&(t.element=i.find("previous",NODE_TYPE.PARAGRAPH,o))}return t},Nav.moveRight=function(e){var t={element:"",position:!1},i=editor.doc.getSelection(),o=e?i.getLastModifiedPosition():"start";e&&"end"==o&&i.isCollapsed()&&(o="start");var r=i.getStart();"end"==o&&(r=i.getEnd());var n=DocTreeManager.lineAtIndex(r),a=n.parent;if(editor.doc.getCharAt(r)==UNICODE.PARA&&editor.doc.getCharAt(r+1)==UNICODE.BR){var l=Nav.getNextLine(n);l&&l.el&&(EventHandler.mouseDown_coord.isLineEnd=!0,EventHandler.mouseDown_coord.portion=J(l.el).find("span.zw-portion,span.EOP")[0])}else if(editor.doc.getCharAt(r)==UNICODE.PARA&&editor.doc.getCharAt(r+1)==UNICODE.SECTION_START&&"endnote"!==a.parent.name&&"footnote"!==a.parent.name)return t;if(r&&editor.doc.getCharAt(r)==UNICODE.RANGE_START){var s=editor.doc.getRawFormatAt(r);if(e&&(!s.id||s.id.indexOf("toc")==-1)||s&&DocUtil.isNonEditablePortion(s.type)){var d=DocUtil.getRangeEnd(r),c=editor.doc.createElement(NODE_TYPE.TEXT);return c.setStart(d+1),c.setEnd(d+1),t.element=c,(o="start")&&(t.position=!0),t}}return t.element=i.findNext(NODE_TYPE.TEXT+"|"+NODE_TYPE.PARAGRAPH+"|"+NODE_TYPE.BR,o),t.element?t.element.type!=NODE_TYPE.PARAGRAPH||e&&(editor.doc.getCharAt(t.element.getEnd())==UNICODE.CELL||editor.doc.getCharAt(t.element.getEnd())==UNICODE.ROW||editor.doc.getCharAt(t.element.getEnd())==UNICODE.TABLE)||(t.element=i.findNext(NODE_TYPE.TEXT+"|"+NODE_TYPE.PARAGRAPH+"|"+NODE_TYPE.BR,o,t.element),t.position=!0):(t.element=editor.doc.getElementAt(i.parents(NODE_TYPE.SECTION).getEnd()-1),t.position=!0),t},Nav.sendErrorDetails=function(e){var t=editor.doc.getSelection().getTargetRange();Utils.sendErrorDetails("NO_ERROR_MAIL<ZWERROR>"+editor.doc.getDocInfo().VERSION+"."+editor.doc.getDocInfo().REVISION+"<ZWERROR>KEYBOARD_NAVIGATION_FAILURE\nError Log Start \nException Stack: "+e.stack+"\nRange: "+JSON.stringify(t&&t.toCursorOp())+"\nCLIENT INFO: "+ZWCollaboration.clientInfo+"\nbuildLabel: "+buildLabel+"\nError Log End")},Nav.movePreviousWord=function(){var e={element:"",position:!0},t=editor.doc.getSelection(),i=t.getStart(),o=editor.doc.getSectionStart(i);if(i-1==o)return e;var r=t.findPrevious(NODE_TYPE.TEXT),n=editor.doc.getCharAt(i-1);return n==UNICODE.BR?Nav.moveLeft():(n!=UNICODE.RANGE_START&&n!=UNICODE.RANGE_END||!r?e.element=t.getPreviousWord(t.getLastModifiedPosition()):(e.element=r,e.position=!1),e)},Nav.moveNextWord=function(){var e={element:"",position:!1},t=editor.doc.getSelection(),i=t.getStart(),o=t.find("next",NODE_TYPE.TEXT),r=editor.doc.getCharAt(i),n=editor.doc.getRawFormatAt(i),a={};if(r==UNICODE.RANGE_END){var l=DocUtil.getRangeStart(i);a=editor.doc.getRawFormatAt(l)}var s=t.parents(NODE_TYPE.PARAGRAPH);if(r==UNICODE.BR)return Nav.moveRight();if((r==UNICODE.RANGE_START&&n.type==NODE_TYPE.LINK||r==UNICODE.RANGE_END&&a.type==NODE_TYPE.LINK)&&o)e.element=o,e.position=!0;else{e.element=t.getNextWord();var d=t.parents(NODE_TYPE.SECTION).getEnd();e.element&&(editor.doc.getCharAt(e.element.getEnd()-1)==UNICODE.HR||i==e.element.getEnd()?e.element=t.findNext(NODE_TYPE.PARAGRAPH,"",e.element):editor.doc.getCharAt(e.element.getEnd()-1)==UNICODE.PARA&&(e.element=t.findNext(NODE_TYPE.TEXT+"|"+NODE_TYPE.PARAGRAPH+"|"+NODE_TYPE.BR,"start",e.element),e.position=!0),e.element.getEnd()>d&&e.element.setEnd(d),e.element.getEnd()==s.getEnd()&&editor.doc.getCharAt(e.element.getEnd())==UNICODE.SECTION_START&&(e.position=!0))}return e},Nav.moveToParaStart=function(){var e=editor.doc.getSelection(),t=e.getLastModifiedPosition(),i="end"==t?e.getEnd():e.getStart(),o=editor.doc.getSectionStart(i);if(i==o+1)return i;var r=editor.doc.getCharAt(i-1);if(e.isCollapsed()&&(r==UNICODE.CELL||r==UNICODE.TABLEEND)){var n=r==UNICODE.CELL?i-1:editor.doc.findPreviousIndexOf(UNICODE.CELL,i)+1;if(n>0){var a=editor.doc.getParents(NODE_TYPE.CELL,n),l=TabKeyHandler.getNextVisibleCell(a,!0);if(l&&l.getStart()!=a.getStart()){var s=e.getLastRange();s&&s.setStart(l.getEnd()),e.removeAllRanges().addRange(s)}}}var d=e.parents(NODE_TYPE.PARAGRAPH,t),c=d.getStart();if(c==i&&(d=e.findPrevious(NODE_TYPE.PARAGRAPH,"",d)),d){c=d.getStart();var p=editor.doc.getSectionStart(i);c<p&&(c=p)}return c},Nav.moveToParaEnd=function(){var e=null,t=editor.doc.getSelection(),i=t.getLastModifiedPosition();e=t.parents(NODE_TYPE.PARAGRAPH,i);var o=e.getStart(),r="start"==i?t.getStart():t.getEnd(),n=editor.doc.getCharAt(r);if(editor.doc.getCharAt(r+1)==UNICODE.CELL){var a=editor.doc.getParents(NODE_TYPE.CELL,r+2);if(a){var l=TabKeyHandler.getNextVisibleCell(a);if(l)return o=editor.doc.findNextIndexOf(UNICODE.PARA,l.getStart());var s=a.attr();if(s&&(s[ATTR_CELL.TDS_MRG]||"fc"==s[ATTR_CELL.TDS_MRG])){var d=TableUtil.getTableEnd(r);if(d>0)return o=editor.doc.findNextIndexOf(UNICODE.PARA,d)}}}n==UNICODE.PARA&&(e=t.findNext(NODE_TYPE.PARAGRAPH,"",e)),e&&(o=editor.doc.findNextIndexOf(CONT_REGEXP.PARASTART,e.getStart()));var c=t.parents(NODE_TYPE.SECTION).getEnd()-1;return(o>c||o<0)&&(o=c),o},Nav.handlePageNavigation=function(e,t){var i=editor.doc.getSelection(),o=i.getLastRange(),r=CurUtil.offset.start.top;e!=KEYS.PAGEDOWN||o.collapsed||(r=CurUtil.offset.end.top);var n=editor.editorPaneContainerHt-parseFloat(editor.editorPaneContainer.css("padding-top")),a=r+n*(e==KEYS.PAGEDOWN?1:-1)+(e==KEYS.PAGEDOWN?200:-150),l=i.getLastModifiedPosition(),s=l===ZWSelection.MODIFIED_POSITION_START?o.start:o.end,d=ViewManager.getPageAtIndex(s);d=e==KEYS.PAGEUP?d&&d.prev:d&&d.next,d&&!d.isPageRendered&&(editor.visiblePageNumbers.push(d.pageNumber),d.forceToRender(),d.content&&d.content.el&&(d.content.el.style.display="block"));var c,p=J(editor.doc.getCursorPortionNode(editor.uuid,l)),u=p.parents("div.zw-contentpane:first, div.header_primary:first, div.footer_primar:first").first(),f=u.children("div.zw-paragraph:first")[0],g=u.children("div.zw-paragraph:last")[0];if(c=u.hasClass("zw-contentpane")?Utils.binarySearch(editor.jeditorPane.find("div.zw-contentpane").find("span.zw-portion,span.EOP"),PUtil.nodeCompare,a):PUtil.getElementAtOffset(u[0],a),c&&!J(c).is("div.zw-paragraph")){var m=J(c);c=m.parents("div.zw-paragraph:first")[0],!c&&m.parent().is("div.header_flag,div.footer_flag")&&(c=f),Math.abs(r-PUtil.offsetTop(m[0])<50)&&c!=f&&c!=g&&(c=e==KEYS.PAGEUP?m.prev("div.zw-paragraph")[0]||c:m.next("div.zw-paragraph")[0]||c)}if(t){o.collapsed&&i.setLastModifiedPosition(e==KEYS.PAGEUP?"start":"end");var h=o.start,T=o.end;return e==KEYS.PAGEUP?h=DocUtil.getDocElement(c).getStart():T=c==g?i.parents(NODE_TYPE.SECTION).getEnd()-1:DocUtil.getDocElement(c).getStart(),h=h<=0?1:h,editor.doc.createRange(h,T)}var E={element:"",position:!0};return c==g&&e==KEYS.PAGEDOWN?(E.element=editor.doc.getElementAt(i.parents(NODE_TYPE.SECTION).getEnd()-2),E.position=!1):c==f&&e==KEYS.PAGEUP?(E.element=DocUtil.getDocElement(c),E.position=!0):(E.element=DocUtil.getDocElement(c),E.position=e==KEYS.PAGEDOWN),E},Nav.moveToLineStart=function(e){var t=editor.doc.getSelection(),i=e?t.getLastModifiedPosition():"start",o=J(editor.doc.getCursorPortionNode(editor.uuid,i)).parents("div.zw-line-div").find("span.zw-portion")[0],r="start"==i?t.getStart():t.getEnd();if(!o)return r;var n=CurUtil.getCursorLineOffset(o)+CurUtil.getCursorPortionOffset(o),a=o.className,l=n;return DocUtil.isNonEditablePortion(a)&&editor.doc.getCharAt(n-1)==UNICODE.RANGE_END?l=DocUtil.getRangeStart(n-1):editor.doc.getCharAt(n)==UNICODE.RANGE_START&&(l=n),l},Nav.moveToLineEnd=function(e){var t=editor.doc.getSelection(),i=e?t.getLastModifiedPosition():"start";e&&"end"==i&&t.isCollapsed()&&(i="start");var o=J(editor.doc.getCursorPortionNode(editor.uuid,i)).parents("div.zw-line-div").find("span.zw-portion").last()[0],r="start"==i?t.getStart():t.getEnd();if(!o)return e?r+1:r;var n=CurUtil.getCursorLineOffset(o)+CurUtil.getCursorPortionOffset(o),a=o.className,l=n+Utils.textLen(o);EventHandler.mouseDown_coord.isLineEnd=!0,EventHandler.mouseDown_coord.portion=o,DocUtil.isNonEditablePortion(a)?(l=DocUtil.getRangeEnd(n+1)+1,EventHandler.mouseDown_coord.isLineEnd=!1,EventHandler.mouseDown_coord.portion=null):editor.doc.getCharAt(n)==UNICODE.RANGE_END&&(l=n+1);var s=t.parents(NODE_TYPE.SECTION).getEnd()-1;return l>s&&(l=s),l},Nav.moveToStart=function(){var e=editor.doc.getSectionStart(editor.doc.getSelection().getStart());return e>=0&&e++,e},Nav.moveToEnd=function(){return editor.doc.getSelection().parents(NODE_TYPE.SECTION).getEnd()-2},Nav.getFirstLineFromColumnAtIndex=function(e,t){var i=ViewManager.getPageAtIndex(e);if(!i.next)return null;var o=ViewManager.getColumnAtIndex(e),r=ViewManager.getColumnFromPageAtIndex(i.next,o.columnNumber-1),n=r&&r.views.first;if(n&&n.type===NODE_NAME.TABLE){var a="content"!=DocTreeManager.doc.getSection(e).name;return Nav.getFirstLineFromRow(r.views.first.views.first.node,t,r,a)}return r&&r.views.first.nodeLines[0]},Nav.getLastLineFromColumnAtIndex=function(e,t){var i=ViewManager.getPageAtIndex(e),o=ViewManager.getColumnAtIndex(e),r=ViewManager.getColumnFromPageAtIndex(i.prev,o.columnNumber-1),n=r&&r.views.last;if(n&&n.type===NODE_NAME.TABLE){var a="content"!=DocTreeManager.doc.getSection(e).name;return Nav.getLastLineFromRow(r.views.last.views.last.node,t,r,a)}return n&&n.type===NODE_NAME.HR?r&&lastElementOf(r.views.last.prev.nodeLines):r&&lastElementOf(r.views.last.nodeLines)},Nav.getFirstLineFromPara=function(e){for(;e&&"para"!=e.type;)e=e.next;var t=e&&ViewManager.getViews(e)[0];return t&&t.nodeLines[0]},Nav.getLastLineFromPara=function(e){for(;e&&"para"!=e.type;)e=e.prev;var t=e&&lastElementOf(ViewManager.getViews(e));return t&&lastElementOf(t.nodeLines)},Nav.getClosestTDViews=function(e,t,i,o){var r,n,a,l=0;if(r=ViewManager.getViews(e),i)for(var s=0,d=r.length;s<d;s++){var c=r[s];if(i.id==c.column.id){n=c.el,l=s,a=c;break}}else a=r[0];var p=[],u=Nav.findClosestCell(a,t),f=u&&ViewManager.getViews(u)[l].views;return p.push(f,l),p},Nav.getFirstLineFromRow=function(e,t,i,o){var r=Nav.getClosestTDViews(e,t,i,o),n=r[0].first,a=r[1],l=ViewManager.getViews(e).length;if(!n){for(;++a<l;)n=ViewManager.getViews(e)[a].views.first.views.first;return n&&n.nodeLines[0]||e.next&&Nav.getFirstLineFromRow(e.next,t,i,o)||Nav.getFirstLineFromPara(e.parent.next)}return"para"==n.type?n.nodeLines[0]:n.type==NODE_TYPE.TABLE?Nav.getFirstLineFromRow(n.views.first.node,t,i,o):void 0},Nav.getLastLineFromRow=function(e,t,i,o){var r=Nav.getClosestTDViews(e,t,i,o),n=r[0].last,a=r[1]||0;if(!n){for(;--a>=0;)n=ViewManager.getViews(e)[a].views.last.views.last;return n&&lastElementOf(n.nodeLines)||e.prev&&Nav.getLastLineFromRow(e.prev,t,i,o)||Nav.getLastLineFromPara(e.parent.prev)}return"para"==n.type?n&&lastElementOf(n.nodeLines):n.type==NODE_TYPE.TABLE?Nav.getLastLineFromRow(n.views.last.node,t,i,o):void 0},Nav.isEqualColumn=function(e,t){var i=ViewManager.getColumnAtIndex(e),o=ViewManager.getColumnAtIndex(t);return i&&o&&i.id===o.id},Nav.getNextLine=function(e,t){var i=e.next,o=e.absStart,r="content"!=DocTreeManager.doc.getSection(o).name;if(i)return Nav.isEqualColumn(o,i.absStart)||r||(i=Nav.getFirstLineFromColumnAtIndex(o,t)),i;var n=e.parent,a=n.next,l=new RegExp(UNICODE.TOCSTART+"|"+UNICODE.TOCEND);if((!a&&n.parent.type==NODE_TYPE.TOC||a&&a.parent.type===NODE_TYPE.TOC&&l.test(editor.doc.getCharAt(a.getIndex()+1)))&&(a=n.parent.next),a){if(a.type===NODE_TYPE.TOC&&(a=a.children[0]),/^(hr|para)$/.test(a.type))i=Nav.isEqualColumn(o,a.getIndex()+(a.type===NODE_TYPE.HR?1:0))||r?Nav.getFirstLineFromPara(a):Nav.getFirstLineFromColumnAtIndex(o,t);else if(a.type==NODE_NAME.TABLE){var s=a.children[0];if(Nav.isEqualColumn(o,s.getIndex()+2)||r){var d=ViewManager.getColumnAtIndex(s.getIndex()+2);i=Nav.getFirstLineFromRow(s,t,d,r)}else i=Nav.getFirstLineFromColumnAtIndex(o,t)}}else if(n.parent.type==NODE_TYPE.CELL){var s=n.parent.parent.next;if(s)if(Nav.isEqualColumn(o,s.getIndex()+2)||r){var d=ViewManager.getColumnAtIndex(s.getIndex()+2);i=Nav.getFirstLineFromRow(s,t,d,r)}else i=Nav.getFirstLineFromColumnAtIndex(o,t);else a=n.parent.parent.parent.next,i=Nav.isEqualColumn(o,a.getIndex())||r?Nav.getFirstLineFromPara(a):Nav.getFirstLineFromColumnAtIndex(o,t)}else if(n.parent.type===NODE_TYPE.SECTION&&("endnote"===n.parent.name||"footnote"===n.parent.name)){var c,p,u;c="endnote"===n.parent.name?NoteViewCollection.getNextEndNoteView(o):NoteViewCollection.getNextFootNoteView(o),c&&(p=c.node,u=p.children[0],i=Nav.getFirstLineFromPara(u))}return i},Nav.getPrevLine=function(e,t){var i=e.prev,o=e.absStart,r=ViewManager.getColumnAtIndex(o),n="content"!=DocTreeManager.doc.getSection(o).name;if(i)return Nav.isEqualColumn(o,i.absStart)||n||(i=Nav.getLastLineFromColumnAtIndex(o,t)),i;var a=e.parent,l=a.prev,s=new RegExp(UNICODE.TOCSTART+"|"+UNICODE.TOCEND);if((!l&&a.parent.type===NODE_TYPE.TOC||l&&l.parent.type===NODE_TYPE.TOC&&s.test(editor.doc.getCharAt(l.getIndex()+1)))&&(l=a.parent.prev),l){if(l.type===NODE_TYPE.TOC&&(l=lastElementOf(l.children)),/^(hr|para)$/.test(l.type))i=Nav.isEqualColumn(o,l.getEndIndex()-(l.type===NODE_TYPE.HR?1:0))||n?Nav.getLastLineFromPara(l):Nav.getLastLineFromColumnAtIndex(o,t);else if(l.type==NODE_NAME.TABLE){var d=lastElementOf(l.children),c=ViewManager.getViews(d),p=lastElementOf(c),u=p.column,r=ViewManager.getColumnAtIndex(o);i=u&&u.id!==r.id&&!n?Nav.getLastLineFromColumnAtIndex(o,t):Nav.getLastLineFromRow(d,t,u,n)}}else if(a.parent.type==NODE_TYPE.CELL){var d=a.parent.parent.prev;if(d){var c=ViewManager.getViews(d),p=lastElementOf(c),u=p.column,r=ViewManager.getColumnAtIndex(o);i=u&&u.id!==r.id&&!n?Nav.getLastLineFromColumnAtIndex(o,t):Nav.getLastLineFromRow(d,t,u,n)}else l=a.parent.parent.parent.prev,i=Nav.isEqualColumn(o,l.getEndIndex())||n?Nav.getLastLineFromPara(l):Nav.getLastLineFromColumnAtIndex(o,t)}else if(a.parent.type===NODE_TYPE.SECTION&&("endnote"===a.parent.name||"footnote"===a.parent.name)){var f,g,m;f="endnote"===a.parent.name?NoteViewCollection.getPreviousEndNoteView(o):NoteViewCollection.getPreviousFootNoteView(o),f&&(g=f.node,m=g.children[0],i=Nav.getLastLineFromPara(m))}return i},Nav.findClosestCell=function(e,t){var i,o=J("#editorpane").offset().left+editor.doc.bodyFormat.ml.convertor().pixels,r=e.column&&e.column.left||0,n=e.node.children,a=n.length,l=o+r;n&&(l+=n[0].left);for(var s=0;s<a;s++)if(i=n[s],l+=i.actualWidth,l>=t)return i;return i};var Note=function(){var e=function(e){if(e){var t=DocTreeManager.getMetaSection(e);if(t){var o=t.start+1;i(o)}}},t=function(e){if(e){var t=DocTreeManager.getMetaSection(e);if(t){var o=t.getRangeIndex()-1;i(o)}}},i=function(e){var t=editor.doc.getDomCursorNode(editor.uuid,editor.zuid,"start"),i=editor.doc.getSelection(),o=editor.doc.createRange(e);i.removeAllRanges().addRange(o),Utils.scrollElementIntoView(t[0],500,!0),CurUtil.scrollTop=editor.editorPaneContainer[0].scrollTop,editor.editorOffset=editor.jeditorPane.offset(),CurUtil.blinkCursor();var r=DocTreeManager.doc.getSection(i.getStart());EventHandler.setClientActiveSection(r),EventHandler.toggleSection()},o=function(e,t){var i=editor.doc.getBodyFormat()[e]||{};if(t=t||{},0==Object.keys(i).length||0!=Object.keys(t).length&&(i.fmt!=t.format||i.stnum!=t.startNumber)){var o=t.format||i.fmt||"num",r=t.startNumber||i.stnum||1,n="chicago"==o?PREDEFINED_NOTE_REFERENCE_SYMBOLS:[];noteInfo={fmt:o,refchars:n,stnum:r};var a={};a[e]=noteInfo;var l=editor.doc.createElement(NODE_TYPE.BODY);l.attr(a)}},r=function(e,t){t=t||{};var i=editor.doc.getSelection(),o=i.getEnd();if(i.length>1&&Utils.addToStatistics(e+"_ON_MUL_SEL"),!i.isCollapsed()&&editor.doc.getCharAt(o-1)==UNICODE.PARA){var r=i.getLastRange();r&&r.setEnd(o-1)}i.collapse(!1);var n=editor.doc.createElement(e);n.setContent(t.content||"");var a=null;t.referenceChar&&(a={refchar:t.referenceChar}),n.insert(a)},n=function(e,t,i){o(i);for(var r=0,n=e.length;r<n;r++)e[r].modify(i)},a=function(e,t){var i=[],o=[];"endnote"==e?i=DocTreeManager.getAllEndNotes():"footnote"==e&&(i=DocTreeManager.getAllFootNotes());for(var r=0,a=i.length;r<a;r++)o.push(editor.doc.getFloatElement(e,i[r].sid));n(o,e,t)},l=function(e,t){var i=editor.doc.getSelection(),o=DocTreeManager.getTreeNodeAtIndex(i.getStart()),r=editor.doc.getFloatElement(o.section.name,o.section.sid);r&&n([r],e,t)},s=function(e){var t=editor.doc.getSelection(),i=t.parents("section");i.attr({refchar:e.referenceChar})},d=function(){var e=editor.doc.getSelection(),t=e.parents("section");t.attr({refchar:null})},c=function(){var e=editor.doc.getSelection(),t=DocTreeManager.getTreeNodeAtIndex(e.getStart()),i=editor.doc.getFloatElement(t.section.name,t.section.sid);i.remove()};return{moveToSection:e,moveToNoteRange:t,insertNote:r,updateNoteProps:o,insertSymbol:s,removeSymbol:d,convertNote:l,convertAllNotes:a,removeNote:c}}();Command=function(){var e={},t=function(t,i){t in e||(e[t]=[]),e[t].push(i)},i=function(t){for(var i=Array.prototype.slice.call(arguments,1),o=0;o<e[t].length;o++)e[t][o].apply(editor.doc,i)};return{on:t,exec:i}}(),function(e){e.on("InsertChar",function(e){if(!editor.doc.getSelection().isInLockRange()){var t=e.cmd,i=e.element;if(editor.lastOperation="InsertChar",editor.currentCommand=COMMAND.ANY,"insert"==t){var o=editor.doc.getSelection();i.type==NODE_TYPE.TEXT&&o.isEOPOnlySelected()&&(o.collapse(!0),o.isListItemSelection&&(o.isListItemSelection=!1)),i.type==NODE_TYPE.TEXT&&o.isCollapsed()?editor.currentCommand=COMMAND.TYPING:editor.doc.snapShotManager.flushTypedCharOps(),editor.doc.updateLastAction("InsertChar",i.nodeValue),editor.doc.getSelection().insert(i,i.css);var r=i.getEnd();Op.fillCursorPos(r,r)}else if("insbr"==t){editor.doc.updateLastAction(t),editor.doc.snapShotManager.flushTypedCharOps();var n=editor.doc.createElement(NODE_TYPE.BR,UNICODE.BR);n.setStart(editor.doc.getSelection().getStart()),editor.doc.getSelection().insert(n),Op.fillCursorPos(n.getEnd(),n.getEnd())}else editor.doc.execCmd(t,i);Op.sendMsg(),editor.currentCommand=COMMAND.ANY,editor.doc.getSelection().isCollapsed()&&Utils.scrollElementIntoView(editor.doc.getDomCursorNode(editor.uuid,editor.zuid,"start")[0]),"insert"==t&&PubSub.publish("Document/CharInserted",i.nodeValue)}}),e.on("SmallCaps",function(e){if(!editor.doc.getSelection().isCollapsed()||(editor.doc.getSelection().getWord().select(),!editor.doc.getSelection().isCollapsed())){for(var t=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.TEXT),i=0;i<t.length;i++){var o=t[i],r=o.nodeValue.toLowerCase(),n=editor.doc.createElement(NODE_TYPE.TEXT,r);n.setStart(o.getStart()),n.setEnd(o.getEnd());var a={};a[ATTR_TEXT.TS_FV]="small-caps",o.attr(a),editor.doc.getSelection().replace(o,n,!0),Op.fillCursorPos(o.getStart(),o.getEnd())}Op.sendMsg()}}),e.on("increaseFontSize",function(){var e=editor.doc.getSelection();e.isCollapsed()&&(e.getWord().select(),e=editor.doc.getSelection()),DocUtil.increaseOrDecreaseFontSize(e,1)}),e.on("decreaseFontSize",function(){var e=editor.doc.getSelection();e.isCollapsed()&&(e.getWord().select(),e=editor.doc.getSelection()),DocUtil.increaseOrDecreaseFontSize(e,-1)}),e.on("CreateLink",function(e){var t,i,o,r,n,a,l,s,d=editor.doc,c=d.getSelection();c.length>1&&Utils.addToStatistics("CreateLink_ON_MUL_SEL");for(var p=0,u=c.length;p<u;p++){if(a=c.getRangeAt(p),l=a.start,s=a.end,i=c.getTargetRange(),!c.isCollapsed()){var f=d.getCharAt(s-1);f==UNICODE.PARA?s-=1:" "==f&&(s-=1,a.setEnd(s))}t={type:NODE_TYPE.LINK},t[ATTR_LINK.LINK_TYPE]=e.type,t[ATTR_LINK.LINK_URL]=e.url,t[ATTR_LINK.LINK_TARGET]=e.target,t[ATTR_LINK.LINK_TOOLTIP]=e.tip,e.text&&(c.deleteSelectedContents(),t.text=e.text),o=UNICODE.RANGE_START.length+(e.text?l+e.text.length:s)+UNICODE.RANGE_END.length,l==i.start&&s==i.end&&(n=o),r=d.createElement(NODE_TYPE.LINK,e),r.setStart(l),r.setEnd(s),r.insert(t,p)}Op.fillCursorPos(n,n)}),e.on("ModifyLink",function(e){var t=e.linkObj;if(t){var i=editor.doc.createElement(NODE_TYPE.TEXT);i.setStart(t.getStart()+1),i.setEnd(t.getEnd()-1);var o={};if(o[ATTR_LINK.LINK_TYPE]=e.type,o[ATTR_LINK.LINK_URL]=e.url,o[ATTR_LINK.LINK_TARGET]=e.target,o[ATTR_LINK.LINK_TOOLTIP]=e.tip,e.text){var r=editor.doc.createElement(NODE_TYPE.TEXT,e.text);r.attr(o),editor.doc.getSelection().replace(i,r)}else i.attr(o);o[ATTR_COMMON.ID]=e.id,o[ATTR_COMMON.TYPE]=NODE_TYPE.LINK,t.attr(o)}}),e.on("Unlink",function(e){if(e){var t,i,o=e.length;for(t=0;t<o;t++)i=e[t],i.remove()}}),e.on("bookmark",function(e){var t;e.insert();var i=editor.doc.getSelection();if(i.length>1){Utils.addToStatistics("bookmark_ON_MUL_SEL");var o=editor.doc.getSelection().getTargetRange();t=o?o.end+2:editor.doc.getSelection().getEnd()+2}else t=editor.doc.getSelection().getEnd()+2;Op.fillCursorPos(t,t)}),e.on("updateHeadingStyle",function(e){var t;"object"==typeof e&&(t=e[1],e=e[0]),QuickStyle.updateHeadingStyle(e,t)}),e.on("FormatBlock",function(e,t){DocUtil.applyHeadingForSelection(e,t)}),e.on("removeListing",function(){List.removeList()}),e.on("outdent",function(e){Indentation.init("outdent",e)}),e.on("indent",function(e){Indentation.init("indent",e)}),e.on("hlist",function(e){var t,i,o,r,n={};editor.doc.getHeadingListId();n[ATTR_PARAGRAPH.PS_TYPE]="list",n[ATTR_PARAGRAPH.LS_DATA]={id:0,l:0,t:LIST_TYPE.DECIMAL},t=editor.doc.getSelection().getAllHeadings(),o=[];for(var r=0;r<t.length;r+=1)i=t[r],parseInt(i.attr(ATTR_PARAGRAPH.PS_HD))&&"list"!=i.attr(ATTR_PARAGRAPH.PS_TYPE)&&o.push(i);t=o;var a=editor.doc.getSelection();if(a.isCollapsed()||a.isListItemSelection){var l=editor.doc.getSelection().parents(NODE_TYPE.PARAGRAPH);parseInt(l.attr(ATTR_PARAGRAPH.PS_HD))||DocUtil.applyHeadingForSelection(1),t.push(l)}for(var s={},d=0;d<t.length;d++)s[t[d].getStart()]=t[d];var c=[];for(var p in s)c.push(s[p]);List.init(n,c,["hlist",e])}),e.on("removeHeadingList",function(){var e,t,i,o,r={};r[ATTR_PARAGRAPH.PS_TYPE]="list";var n=editor.doc.getHeadingListId();r[ATTR_PARAGRAPH.LS_DATA]={id:0,l:-1},e=editor.doc.getSelection().getAllHeadings(),i=[];for(var o=0;o<e.length;o+=1){t=e[o];var a=t.attr(ATTR_PARAGRAPH.LS_DATA);"list"==t.attr(ATTR_PARAGRAPH.PS_TYPE)&&a&&a.id==n&&i.push(t)}List.init(r,i,["removeHeadingList"])}),e.on("orderedlist",function(){var e=editor.doc.getSelection(),t=e.getNodesInSelection(NODE_TYPE.PARAGRAPH);List.createNewList(LIST_TYPE.RECENT_ORDER,t)}),e.on("unorderedlist",function(){var e=editor.doc.getSelection(),t=e.getNodesInSelection(NODE_TYPE.PARAGRAPH);List.createNewList(LIST_TYPE.RECENT_UNORDER,t)}),e.on("checklist",function(){var e=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.PARAGRAPH);List.createNewList(LIST_TYPE.CHECKLIST,e)}),e.on("updateLevelNumbering",List.updateLevelNumbering),e.on("updateListPrefixAndSuffix",List.updateListPrefixAndSuffix),e.on("FormatPainter",function(){if(!editor.doc.paintFormat_dblClick){var e=editor.doc.getSelection(),t=e.getComputedTextFormat();delete t[ATTR_TEXT.CLS],delete t[ATTR_TEXT.TS_SP],delete t[ATTR_TEXT.TS_GR],t[ATTR_TEXT.TS_NULL]=!0,editor.doc.paintFormat.text=t;var i=e.parents(NODE_TYPE.PARAGRAPH),o=e.getTargetRange(),r=o.start,n=o.end;n!=r&&(i.getStart()!==r||n!==i.getEnd()&&n!==i.getEnd()-1)||(t=e.getParaFormat(),t[ATTR_TEXT.PS_NULL]=!0,editor.doc.paintFormat.para=t),editor.jeditorPane.children(".zw-page").css("cursor","pointer")}});var t=function(e){var t=editor.doc.createElement(NODE_TYPE.HR,{c:UNICODE.HR});t.setStart(editor.doc.getSelection().getStart()),e=e||{},e[ATTR_HR.HR_AL]="0",editor.doc.getSelection().insert(t,e)};e.on("inshr",function(e){var i=editor.doc.getSelection().getStart();t(e),Op.fillCursorPos(i+2,i+2)}),e.on("insblankpage",function(e){var i=editor.doc.getSelection().getStart(),o=editor.doc.getSectionEnd(i);t(e),i+1!=o&&t(e),Op.fillCursorPos(i+2,i+2)}),e.on("insquote",function(e){var t,i,o;t={char:e[0],style:editor.doc.getSelection().getTextFormat()},i={char:e[1],style:editor.doc.getSelection().getTextFormat()},editor.doc.getSelection().surroundTextWith(t,i),o=editor.doc.getSelection().getEnd()+2,Op.fillCursorPos(o,o)}),e.on("comment",function(e){}),e.on("resolve",function(e){}),e.on("reOpen",function(e){}),e.on("insertnote",function(e){if(Note.updateNoteProps(e.type,e.noteProps),Note.insertNote(e.type,e.noteData),e.options&&!e.options.focusElement){var t=editor.doc.getSelection().getEnd()+3;Op.fillCursorPos(t,t)}}),e.on("removenote",function(){Note.removeNote()}),e.on("changenotetype",function(e){Note.convertNote.apply(null,e)}),e.on("changeallnotetype",function(e){Note.convertAllNotes.apply(null,e)}),e.on("changenotestyle",function(e){Note.updateNoteProps.apply(null,e)}),e.on("insertnotesymbol",function(e){Note.insertSymbol(e)}),e.on("removenotesymbol",function(){Note.removeSymbol()}),e.on("regeneratetoc",Toc.regenerateTOC),e.on("inserttoc",function(e){var t={theme:e};Toc.generate(t)}),e.on("deletetoc",Toc.deleteTOC),e.on("insimg",function(e){var t=e,i=editor.doc.createElement(NODE_TYPE.IMAGE);t.shapeData&&(Utils.addToStatistics("insshape"),editor.statistics.insimg-=1),PubSub.publish("DocOperation/BeforeImgInsert"),i.setStart(editor.doc.getSelection().getStart()),editor.doc.getSelection().insert(i,t)}),e.on("insobj",function(e){var t;t=editor.doc.createElement(NODE_TYPE.IFRAME),t.type=ATTR_WIDGET.WIDGET,t.setStart(editor.doc.getSelection().getStart()),editor.doc.getSelection().insert(t,e),Op.fillCursorPos(t.getEnd(),t.getEnd())}),e.on("updateAutoField",function(e){var t=e[0];t.attr(e[1])}),e.on("autofield",function(e){var t,i,o,r,n,a,l;editor.doc.getSelection().isCollapsed()||editor.doc.getSelection().deleteSelectedContents(),t=e[0],"autopno"==t&&e[1]?o=e[1]:i=e[1],r=Utils.randomString(),n={type:NODE_TYPE.AUTOFIELD,id:r},a=DocUtil.copyStyle(n),n[ATTR_AUTOFIELD.FIELDTYPE]=t,n[ATTR_AUTOFIELD.ISAUTO]=e[3]?1:0,"autodate"==t?(l=e[1],n[ATTR_AUTOFIELD.DATEFMT]=e[2]):"autodocname"==t?l=editor.doc.getDocInfo().DOCUMENT_NAME_HTML:"autoauthor"==t?l=i?Utils.removeUnWantedUnicodes(i):editor.doc.getDocInfo().CREATOR:"autodocversion"==t?(l=editor.doc.getDocInfo().DOCS_VERSION,Utils.addToStatistics("autofield_docversion")):"versionnotes"==t?l=editor.doc.getDocInfo().DOCUMENT_NAME_HTML:"autoformula"==t&&(n[ATTR_AUTOFIELD.FORMULA]=i),n[ATTR_AUTOFIELD.VALUE]=l;var s={char:UNICODE.RANGE_START,style:n},d={char:UNICODE.RANGE_END,style:a},c={};c[ATTR_COMMON.TYPE]=NODE_TYPE.TEXT,c[ATTR_TEXT.CLS]=t,c[ATTR_COMMON.FIELDINFO]=r,"autodocname"!=t&&"autoauthor"!=t&&"autodate"!=t&&"autoformula"!=t&&"autodocversion"!=t&&"autoversionnotes"!=t&&"autopno"!=t||(i="#");var p=editor.doc.createElement(NODE_TYPE.TEXT,i),u=DocUtil.copyStyle(editor.doc.getSelection().getTextFormat());u[TCConstants.TC]&&delete u[TCConstants.TC],DocUtil.mergeStyles(u,c),u.cls=t,p.css=u;var f=editor.doc.getSelection();if(o){var g=editor.doc.getSelection()[0].start;f.removeAllRanges().addRange(editor.doc.createRange(o))}f.surroundAndInsert(s,d,p);var m;if(g?(f.removeAllRanges().addRange(editor.doc.createRange(g)),m=f.getEnd()):m=f.getEnd()+i.length+2,Op.fillCursorPos(m,m),"autopno"==t){var h=e[2],T=e[3];h&&T&&editor.doc.execCmd("formatAutoField",[h,T])}}),e.on("mergeField",function(e){var t,i;editor.doc.getSelection().isCollapsed()||editor.doc.getSelection().deleteSelectedContents(),t=e[0],i=e[1];var o=Utils.randomString(),r={type:NODE_TYPE.MAILMERGEFIELD,id:o};r[ATTR_AUTOFIELD.FIELDTYPE]=t,r[MAILMERGE.MMINFO]=i;var n={};n[ATTR_COMMON.TYPE]=NODE_TYPE.TEXT,n[ATTR_TEXT.CLS]=t;var a=DocUtil.copyStyle(r);delete a[MAILMERGE.MMINFO];var l=i[MAILMERGE.FIELD_NAME];i.hasOwnProperty(MAILMERGE.GROUP_NAME)&&(l=i[MAILMERGE.GROUP_NAME]+"."+l),l=UNICODE.MERGEFIELD_START+l+UNICODE.MERGEFIELD_END,t!=CONST.MERGEFIELD&&(n[ATTR_COMMON.FIELDINFO]=o,l="#");var s={char:UNICODE.RANGE_START,style:r},d={char:UNICODE.RANGE_END,style:a},c=l.length+2;if(i[MAILMERGE.TYPE]==MAILMERGE.TYPE_IMAGE){var p={id:o,src:"mm-image",type:NODE_TYPE.IMAGE,ht:180,wid:200};p[MAILMERGE.MMINFO]=i;var u=editor.doc.createElement(NODE_TYPE.IMAGE);PubSub.publish("DocOperation/BeforeImgInsert"),u.setStart(editor.doc.getSelection().getStart()),u.css=p,editor.doc.getSelection().insert(u,p),c=1}else{var u=editor.doc.createElement(NODE_TYPE.TEXT,l),f=DocUtil.copyStyle(editor.doc.getSelection().getTextFormat());f[TCConstants.TC]&&delete f[TCConstants.TC],DocUtil.mergeStyles(f,n),u.css=f,editor.doc.getSelection().surroundAndInsert(s,d,u)}var g=editor.doc.getSelection().getEnd()+c;Op.fillCursorPos(g,g)}),e.on("instable",function(e){TableActions.insertTable(e)}),e.on("deltable",function(){var e=editor.doc.getSelection(),t=e.parents(NODE_TYPE.TABLE);e.deleteContents(t.getStart(),t.getEnd()),PubSub.publish("Document/TableDeleted")}),e.on("delrow",TableActions.deleteRow),e.on("delcolumn",TableActions.deleteColumn),e.on("insrowafter",TableActions.insertRowAfter),e.on("insrowbefore",TableActions.insertRowBefore),e.on("inscolafter",function(){var e=editor.doc.getSelection().getTargetRange(),t=DocTreeManager.doc.getParents(NODE_TYPE.TABLE,e.start),i=t.format[ATTR_TABLE.TBLS_DIR]||PARA_DIR.LTR;i===PARA_DIR.RTL?TableActions.insertColumnBefore():TableActions.insertColumnAfter()}),e.on("inscolbefore",function(){var e=editor.doc.getSelection().getTargetRange(),t=DocTreeManager.doc.getParents(NODE_TYPE.TABLE,e.start),i=t.format[ATTR_TABLE.TBLS_DIR]||PARA_DIR.LTR;i===PARA_DIR.RTL?TableActions.insertColumnAfter():TableActions.insertColumnBefore()}),e.on("mergecells",function(){editor.doc.getSelection().mergeCells()}),e.on("splitcells",TableSplit.splitCells),e.on("distributeColumns",TableActions.distributeColumns),e.on("selectAllCells",function(){var e=Array.prototype.slice.call(arguments),t=editor.doc.getSelection();t.selectAllCells.apply(t,e)}),e.on("fitToWindow",TableActions.fitToWindow),e.on("fixedColumnWidth",TableActions.fixedColumnWidth),e.on("unmergecells",TableActions.unMergeCells),e.on("duplicateToAllCells",TableActions.duplicateToAllCells),e.on("convertTableToText",function(e){var t=e[0];Utils.addToStatistics("TableToText"),ConvertTableToText.convertTableToText(t)}),e.on("splitTable",function(){var e=editor.doc.getSelection(),t=editor.doc.getParents(NODE_TYPE.TABLE,e.getStart()),i=editor.doc.getParents(NODE_TYPE.ROW,e.getStart());SplitTable.split(t,i),Utils.addToStatistics("SplitTable")}),e.on("transposeTable",function(){Utils.addToStatistics("TransposeTable"),TransposeTable.transpose()}),e.on("distributeRows",function(){TableActions.distributeRows()}),e.on("convertTextToTable",function(e){TableActions.insertTable(e)}),e.on("cut",function(){if(InsertShape.selectedShape())ShapeEditor.text.isEditable()||(InsertShape.cut(),CopyUtil.onCopy());else{CopyUtil.onCopy();for(var e,t=editor.doc.getSelection(),i=0,o=t.length;i<o;i++)e=t.getRangeAt(i),t.deleteSelectedContents(e,i<o-1)}}),e.on("copy",CopyUtil.onCopy),e.on("paste",function(e){Array.isArray(e)&&(htmlString=e[1],textString=e[2],e=e[0],PasteUtil.setSelectedCells(),Paste.setPasteInfo(htmlString,textString));var t=document.getElementById("pasteFrame"),i=t.contentWindow.document.getElementsByTagName("body")[0],o=editor.doc.getSelection(),r=J(i);if(o.isListItemSelection||r.is(":empty")){var n=window.event;return n.preventDefault(),Utils.stopEvent(n),!0}!InsertShape.selectedShape()&&PubSub.publish("DocOperation/BeforePaste"),o.isCollapsed()||(o.deleteSelectedContents(),Op.sendMsg());var a=EventHandler.plainTextPaste?CONST.PASTE_TEXTONLYFORMAT:w_usersettings.pasteOptions;new RegExp(ATTR_WIDGET.VIDEO_REGEX);if(InsertShape.selectedShape())return void(i.innerText&&ShapePaste.init(i,null,a));r.css({top:""});var l=Paste.getListPasteInfo(i);l.isSameDoc?l.nonListPaste?a=CONST.PASTE_ASNEWLIST:l.sameListPaste&&(a=CONST.PASTE_CONTINUELIST):l.isListPaste&&(a=CONST.PASTE_MERGELIST),ZWCode&&ZWCode.isCodePara()&&(a=CONST.PASTE_TEXTONLYFORMAT),a=e||a,Paste.init(i,a)}),e.on("changecase",function(e){if(editor.doc.getSelection().isCollapsed()&&editor.doc.getSelection().getWord().select(),!editor.doc.getSelection().isCollapsed())for(var t,i=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.TEXT),o=0;o<i.length;o++){var r=i[o],n=r.nodeValue;if("lower"==e){if("small-caps"==r.attr(ATTR_TEXT.TS_FV)){var a={};a[ATTR_TEXT.TS_FV]="",r.attr(a),Op.sendMsg()}t=n.toLowerCase()}"upper"==e&&(t=n.toUpperCase());var l=editor.doc.createElement(NODE_TYPE.TEXT,t);l.setStart(r.getStart()),l.setEnd(r.getEnd()),editor.doc.getSelection().replace(r,l,!0),Op.fillCursorPos(r.getStart(),r.getEnd())}}),e.on("sentencecase",function(){for(var e=editor.doc.getSelection(),t=e.getStart(),i=e.getEnd(),o=e.getNodesInSelection(NODE_TYPE.PARAGRAPH),r=RegExp("\\.\\s+","m"),n=0,a=null;a=o[n++];){var l=0,s=[],d=a.text(),c=d,p=0,u=0,f=a.getStart(),g=o[n],m=g&&g.getStart()||i;for(f>=t&&s.push(f);c.length>0;){var h=r.exec(c);if(!h)break;l+=h.index+h[0].length-1,l++,1==h[0].length&&p++;var T=c.match(REGEX.docUnicodes)||[];u+=T.length,c=d.substring(l),l<t-f||s.push(f+l-p-u)}Utils.replaceText(s,f,m)}var E=editor.doc.createRange(t,i);e.removeAllRanges().addRange(E)}),e.on("capitalizeword",function(){var e=editor.doc.getSelection().getStart(),t=editor.doc.getSelection().getEnd();if(e==t){var i=editor.doc.getSelection().getWord();e=i.getStart(),t=i.getEnd(),i.select()}for(var o=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.TEXT),r=0;r<o.length;r++){var n=o[r],e=n.getStart(),t=n.getEnd(),a=n.nodeValue;a=a.replace(a[0],a[0].toUpperCase());var l,s="\\.|\\s+?",d=RegExp(s,"g"),c=0,p=a.length,u="";do{l=d.exec(a),p=l?l.index:t+1;var f=a.substring(c,p);if(""!=f){var g=f.replace(f[0],f[0].toUpperCase());g=g[0]+g.substring(1).toLowerCase(),l&&(g+=l[0]),u+=g}c=p+1,""==f&&(u+=a.substring(c,p))}while(p<=t);if(u.length){var m=editor.doc.createElement(NODE_TYPE.TEXT,u);m.setStart(n.getStart()),m.setEnd(n.getEnd()),editor.doc.getSelection().replace(n,m),u=""}Op.fillCursorPos(e,t)}}),e.on("replace",function(e){var t=e[0],i=e[1];editor.doc.getSelection().replace(t,i)}),e.on("mailmerge",function(e){var t,i,o,r;for(t=0;t<e.length;t++)i=e[t],o=editor.doc.createElement(NODE_TYPE.TEXT,i),r={},r[ATTR_TEXT.CLS]="mergeField",r[ATTR_TEXT.MM_FIELDNAME]=i,editor.doc.getSelection().insert(o,r),o=editor.doc.createElement(NODE_TYPE.TEXT," "),editor.doc.getSelection().insert(o,{type:NODE_TYPE.TEXT})}),e.on("insert",function(e){var t=e;editor.doc.getSelection().insert(t,t.css);var i=t.getEnd();Op.fillCursorPos(i,i)}),e.on("inserttab",function(e){for(var t=0,i=e.length;t<i;t++){var o=editor.doc.createElement(NODE_TYPE.TEXT,UNICODE.TAB);o.css={st:"tab",type:"text"},o.setStart(e[t].getStart()),o.setEnd(e[t].getStart()),o.insert()}}),e.on("setTableTheme",function(e){TableLeftPanelTheme.applyTheme(e)}),e.on("cellalignment",function(e){var t=editor.doc.getSelection(),i=t.getSelectedCells();0==i.length&&(i=[t.parents(NODE_TYPE.CELL)]);for(var o=0,r=i.length;o<r;o++)TableActions.setCellAlign(i[o],e)}),e.on("applyBorders",function(e){for(var t=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.PARAGRAPH),i=0;i<t.length;i++)t[i].attr(e)}),e.on("applyLineSpacing",function(e){for(var t=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.PARAGRAPH),i=0;i<t.length;i++)t[i].attr(e)}),e.on("applyStyle",function(e){var t,i=e[0],o=e[1],r=e[2];if(i instanceof Array){var n=jQuery.isArray(o);for(t=0;t<i.length;t++)n?i[t].attr(o[t]):i[t].attr(o)}else i.attr(o);if("applyTablePanelStyle"===r&&o.length&&o[0][ATTR_PARAGRAPH.PS_DIR]===PARA_DIR.RTL){var a=editor.doc.getSelection().getTargetRange(),l=editor.doc.getDocInfo().VERSION+"."+editor.doc.getDocInfo().REVISION;Utils.sendErrorDetails("NO_ERROR_MAIL<ZWERROR>"+l+"<ZWERROR>TABLE DIRECTION CHANGED TO RTL\nRange: "+JSON.stringify(a&&a.toCursorOp())+"\nVersion: "+l),Utils.addToStatistics("TBL_DIRECTION")}r&&(editor.lastOperation=r)}),e.on("changeDesign",function(e){editor.doc.getSelection().parents(NODE_TYPE.BODY).attr(e)}),e.on("removeTab",function(e){var t=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.PARAGRAPH);TabStop.removeTab(e,t)}),e.on("modifyTab",function(e){var t=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.PARAGRAPH);TabStop.updatePoint(e.tpid,e.point,t)}),e.on("applyTab",function(){var e=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.PARAGRAPH);TabStopDlg.applyValues(e)}),e.on("removeAlltab",function(){var e=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.PARAGRAPH);TabStop.removeAllTab(e)}),e.on("insertTab",function(e){var t=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.PARAGRAPH);TabStop.insertTab(e.point,e.align,t)}),e.on("delete",function(e){var t,i,o,r,n=editor.doc.getSelection();if("string"==typeof e){if(r=e,"nextword"==r){if(t=n.getNextWord(),!t)return;if(i=n.getStart(),o=t.getEnd(),editor.doc.getCharAt(t.getEnd()-1)==UNICODE.RANGE_END){var a=editor.doc.createRange(t.getStart(),t.getEnd());n.removeAllRanges().addRange(a)}else i==o-1?n.deleteChar(KEYS.DELETE):t.remove()}else if("prevword"==r){if(t=n.getPreviousWord(),!t)return;if(o=t.getEnd(),i=t.getStart(),editor.doc.getCharAt(t.getEnd()-1)==UNICODE.RANGE_END){var a=editor.doc.createRange(t.getStart(),t.getEnd());n.removeAllRanges().addRange(a)}else i==o-1?n.deleteChar(KEYS.BACKSPACE):t.remove()}else if("nextchar"==r)n.deleteChar(KEYS.DELETE);else if("prevchar"==r)n.isListItemSelection?List.removeList():n.deleteChar(KEYS.BACKSPACE);else if("watermark"==r){var l=editor.doc.createElement(NODE_TYPE.BODY),s={};s[ATTR_BODY.WM_TYPE]="",s[ATTR_BODY.WM_FS]="",s[ATTR_BODY.WM_FF]="",s[ATTR_BODY.WM_TXT]="",s[ATTR_BODY.WM_AN]="",s[ATTR_BODY.WM_FGC]="",s[ATTR_BODY.WM_PURL]="",s[ATTR_BODY.WM_OURL]="",s[ATTR_BODY.WM_URL]="",s[ATTR_BODY.WM_OP]="",s[ATTR_BODY.WM_SIZE]="",s[ATTR_BODY.DS_BGC]=this.bodyFormat[ATTR_BODY.DS_BGC],l.attr(s)}}else{var d=e;d.remove()}}),e.on("deleteAllComments",function(){}),e.on("deleteByAuthor",function(e){}),e.on("deleteAllBookMarks",function(){var e;e=editor.doc.getElement(NODE_TYPE.BOOKMARK);for(var t,i=0;t=e[i++];)t.remove()}),e.on("RemoveFormat",function(){var e,t=editor.doc.getSelection(),i=t.getStart(),o=t.isCollapsed(),r=t.getEnd(),n={};if(i==r){e=t.parents(NODE_TYPE.PARAGRAPH),n[ATTR_PARAGRAPH.PS_NULL]=!0,e.attr(n),Op.fillCursorPos(i,i);var a=SpellCheck.getWordIndices(t.getStart());if(a.start){i=a.start,r=a.end;var l=editor.doc.createRange(i,r);t.removeAllRanges().addRange(l)}}if(i!=r){if(!o){var s=t.getNodesInSelection(NODE_TYPE.PARAGRAPH);if(s.length>1||s[0].getEnd()<=r){n[ATTR_COMMON.TYPE]=NODE_TYPE.PARAGRAPH,n[ATTR_PARAGRAPH.PS_NULL]=!0;for(var d=0,c=s.length;d<c;d++)s[d].attr(n)}}var p={type:NODE_TYPE.TEXT};p[ATTR_TEXT.TS_NULL]=!0,t.applyFormat(p)}else t.textFormat={type:NODE_TYPE.TEXT},t.textFormat[ATTR_TEXT.TS_NULL]=!0}),e.on("changeHdrFtr",function(e){if(e=parseInt(e),editor.doc.getBodyFormat()[ATTR_BODY.DS_HF_TYPE]!==parseInt(e)){var t=editor.doc.getTrackChangeDetails();t.setStopProcessingTC(!0);var i,o,r,n,a,l=DocTreeManager.doc.sections,s=l.length,d={},c=ViewManager.pages.length,p=ViewManager.getPageWithId(editor.getPageID()),u=(p&&p.pageNumber?p.pageNumber:1,J(editor.clientActiveSection)),f=u.hasClass("header_primary"),g=u.hasClass("footer_primary"),m=DocTreeManager.getLastNonMetaSection().end;if(e==HEADER_FOOTER_TYPE.PRIMARY){if(f||g)for(i=0;i<s;i++)o=l[i].start,r=editor.doc.getRawFormatAt(o),r.hasOwnProperty("hftype")&&(r.hftype==CONST.HEADER_PRIMARY&&f||r.hftype==CONST.FOOTER_PRIMARY&&g)&&(a=o+1)}else if(e==HEADER_FOOTER_TYPE.DIFF_FIRST_PAGE){var h=foundFstPageFooter=!1;for(i=0;i<s;i++)o=l[i].start,r=editor.doc.getRawFormatAt(o),r.hasOwnProperty("hftype")&&(r.hftype==CONST.HEADER_FIRST&&(h=!0)&&f||r.hftype==CONST.FOOTER_FIRST&&(foundFstPageFooter=!0)&&g)&&(a=o+1);h||(n=DocUtil.getSectionOps(CONST.HEADER_FIRST,m),Op.processMsg(n)),foundFstPageFooter||(n=DocUtil.getSectionOps(CONST.FOOTER_FIRST,m),Op.processMsg(n))}else if(e==HEADER_FOOTER_TYPE.DIFF_ODD_EVEN_PAGE){var T=foundEvenPageFooter=!1;for(i=0;i<s;i++)o=l[i].start,r=editor.doc.getRawFormatAt(o),r.hasOwnProperty("hftype")&&((r.hftype==CONST.HEADER_EVEN&&(T=!0)&&f||r.hftype==CONST.FOOTER_EVEN&&(foundEvenPageFooter=!0)&&g)&&(a=c>1?o+1:a),(r.hftype===CONST.HEADER_PRIMARY&&f||r.hftype===CONST.FOOTER_PRIMARY&&g)&&(a=o+1));T||(n=DocUtil.getSectionOps(CONST.HEADER_EVEN,m),Op.processMsg(n)),foundEvenPageFooter||(n=DocUtil.getSectionOps(CONST.FOOTER_EVEN,m),Op.processMsg(n))}else if(e==HEADER_FOOTER_TYPE.DIFF_FIRST_ODD_EVEN_PAGE){var h=foundFstPageFooter=!1,T=foundEvenPageFooter=!1;for(i=0;i<s;i++)if(o=l[i].start,r=editor.doc.getRawFormatAt(o),r.hasOwnProperty("hftype")){if(r.hftype==CONST.HEADER_EVEN&&(T=!0)||r.hftype==CONST.FOOTER_EVEN&&(foundEvenPageFooter=!0))continue;(r.hftype==CONST.HEADER_FIRST&&(h=!0)&&f||r.hftype==CONST.FOOTER_FIRST&&(foundFstPageFooter=!0)&&g)&&(a=o+1)}h||(n=DocUtil.getSectionOps(CONST.HEADER_FIRST,m),Op.processMsg(n)),foundFstPageFooter||(n=DocUtil.getSectionOps(CONST.FOOTER_FIRST,m),Op.processMsg(n)),T||(n=DocUtil.getSectionOps(CONST.HEADER_EVEN,m),Op.processMsg(n)),foundEvenPageFooter||(n=DocUtil.getSectionOps(CONST.FOOTER_EVEN,m),Op.processMsg(n))}a?Op.fillCursorPos(a,a):(f||g)&&(a=c>1||e==HEADER_FOOTER_TYPE.DIFF_FIRST_PAGE||e==HEADER_FOOTER_TYPE.DIFF_FIRST_ODD_EVEN_PAGE?m+1:editor.doc.getSelection().getStart(),Op.fillCursorPos(a,a)),d[ATTR_BODY.DS_HF_TYPE]=e;var E=editor.doc.createElement(NODE_TYPE.BODY);E.attr(d),t.setStopProcessingTC(!1)}}),e.on("updateFormula",function(e){var t,i=editor.doc.getSelection().getStart(),o=DocTreeManager.getFormulaAtIndex(i);if(o.text){var r=DocUtil.copyStyle(editor.doc.getRawFormatAt(o.index));r[ATTR_AUTOFIELD.FORMULA]=e[1],t=editor.doc.createElement(NODE_TYPE.AUTOFIELD,r),t.setStart(o.index),t.setEnd(o.index+1),t.attr(r)}else editor.doc.execCmd("autofield",e)}),e.on("show_non_print_symbol",function(e){var t=editor.doc.getBodyFormat(),i=!0;t&&Boolean(t[ATTR_BODY.DS_SHOWNONPRINTINGCHAR])&&(i=!1);var o=editor.doc.createElement(NODE_TYPE.BODY),r={};r.show_non_printing_char=i,o.attr(r);var e={};Settings.updateUserSettings(e),e[ATTR_BODY.DS_SHOWNONPRINTINGCHAR]=String(i),e.action="hideNonPrintingChar",Utils.setCsrfParam(e),J.post(Utils.getContextUrl("savesettings.do"),e)}),e.on("ins-digisign-field",function(e){var t=editor.doc.createElement(NODE_TYPE.IMAGE);t.setStart(editor.doc.getSelection().getStart()),t.setEnd(editor.doc.getSelection().getStart()),editor.doc.getSelection().insert(t,e)}),e.on("ignoreWord",function(e){var t=e[0],i=e[1],o={};o[ATTR_TEXT.TS_SP]="Ignore";var r=editor.doc.createElement(NODE_TYPE.TEXT,o);r.setStart(t),r.setEnd(i),r.attr(o)}),e.on("ignoreGrammar",function(e){var t=e[0],i=e[1],o={};o[ATTR_TEXT.TS_GR]="Ignore";var r=editor.doc.createElement(NODE_TYPE.TEXT,o);r.setStart(t),r.setEnd(i),r.attr(o)}),e.on("insertPlaceHolder",function(e){var t=e,i=Utils.randomString(),o=Utils.randomString(),r=Utils.randomString(),n=[{r:editor.doc.getSelection().getStart()},{as:{start:{id:r,type:"placeholder"},id:i}},{is:""},{as:{end:["id","type"],id:i}}],a=[{as:{start:{id:r,type:"placeholder"},id:o}},{is:""},{as:{end:["id","type"],id:o}}],l=t.split(UNICODE.PARA);_.each(l,function(e,t){0!=e.length&&(i=Utils.randomString(),n.push({as:{start:{cls:"placeholder",type:"text"},id:i}}),n.push({is:e}),n.push({as:{end:["cls","type"],id:i}}));var i=Utils.randomString();n.push({as:{start:{type:"paragraph"},id:i}}),n.push({is:UNICODE.PARA}),n.push({as:{end:["type"],id:i}})}),Op.processMsg(n.concat(a))}),e.on("remove-digisign-field",function(e){var t,i=DocTreeManager.doc.sections,o=i.length;for(t=0;t<o;t++){var r=i[t].start,n=i[t].end,a=editor.doc.getNodesInSelection(NODE_TYPE.IMAGE,r,editor.doc.getSectionEnd(n-1));if(a.length){var l,s=a.length;for(l=0;l<s;l++){var d=a[l];d.attr()&&"digisign-field"===d.attr().st&&d.remove()}Op.sendMsg()}}}),e.on("redact",function(){Lock.insertRedact()}),e.on("lock_nonselction",function(e){ZWCollaboration.msgQueue.isAckPending()||(null==e&&(e={},e.allowed_zuids=editor.zuid+","),Lock.lockUnSelection(e))}),e.on("lock",function(e){ZWCollaboration.msgQueue.isAckPending()||(null==e&&(e={},e.allowed_zuids=editor.zuid+","),Lock.lockSelection(e))}),e.on("unlock",function(){ZWCollaboration.msgQueue.isAckPending()||Lock.unlockSelection()}),e.on("ins_random_text",function(e){var t,i,o,r,n,a;if(n=e.text(),a=n.substring(6,n.length-2).split(","),i=parseInt(a[0]||1),t=parseInt(a[1]||0),editor.doc.getSelection().deleteContents(e.getStart(),e.getEnd()-1),randTextArray=[],randTextArray[0]="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce ac massa id dolor porttitor egestas sed laoreet purus. Donec non nisl volutpat, aliquet justo sed, volutpat nisi. Aliquam maximus hendrerit libero vitae consectetur. In rutrum vel ex et maximus. Cras blandit elit suscipit erat dapibus varius. Vestibulum sit amet convallis justo. Aliquam finibus sem ac massa consectetur porttitor. Fusce ullamcorper sapien tincidunt ligula aliquet, vel vulputate sapien malesuada. Nulla dui sapien, hendrerit bibendum justo ut, fermentum fringilla urna. Morbi id odio iaculis, malesuada lectus id, ullamcorper lectus. Nam feugiat, urna in sollicitudin molestie, augue risus scelerisque orci, sed maximus leo augue sed eros. Sed sed neque ut lectus lobortis ultrices. Nam imperdiet massa at ante viverra vehicula. Donec non massa dui. Aliquam hendrerit tellus non dolor fermentum, eget ornare elit faucibus.",randTextArray[1]="Suspendisse aliquet, justo ut egestas luctus, velit nisi convallis diam, ac venenatis justo ipsum sed nisi. Phasellus vestibulum enim a tellus feugiat efficitur. Ut pharetra ante purus. Aliquam sit amet odio vehicula, tempor sapien nec, vulputate mauris. Mauris dictum fringilla posuere. Fusce ut leo quis mi interdum pharetra. Nullam volutpat sapien non hendrerit eleifend.",randTextArray[2]="Donec sagittis nec erat eleifend venenatis. Integer quis lorem sed nulla pretium aliquam. Vestibulum ac dignissim elit, vitae congue est. Vivamus maximus sagittis sapien sed bibendum. Quisque tempor sem nulla, nec vehicula nisl porta quis. Proin vitae dui bibendum, accumsan arcu ut, luctus est. Vivamus non ex elementum, viverra sem lacinia, interdum tortor. Phasellus elementum erat metus, euismod ultrices nulla fringilla ut. In ornare a velit at condimentum.",randTextArray[3]="Donec lacinia ligula orci, iaculis congue velit porttitor vel. Phasellus sollicitudin pulvinar tristique. Donec eget ipsum ipsum. Integer ultrices aliquam porttitor. Aenean laoreet diam in ante gravida facilisis. Nam elementum ante risus, et porttitor nibh condimentum quis. In pellentesque efficitur aliquet. Phasellus at augue ut magna finibus tristique. Nam placerat magna diam, eu ultrices nulla rutrum at. In eu nibh ut lectus laoreet placerat. Etiam purus ipsum, cursus consequat euismod non, vestibulum vitae ligula. Duis feugiat ipsum vel interdum dictum. Suspendisse fermentum odio velit.",randTextArray[4]="Duis vestibulum ex id cursus feugiat. Aenean aliquet aliquet dui, vel venenatis magna feugiat eget. Ut a nisi vehicula, lobortis nisi eu, pulvinar neque. Curabitur scelerisque venenatis aliquet. In ac mattis ipsum. Praesent in mollis orci, a mollis eros. Aliquam volutpat ligula eget ultricies tempus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Curabitur sagittis leo non ultricies viverra. Vestibulum sed risus scelerisque, sodales velit id, malesuada metus.",t>0){var l=[];for(o=0;o<randTextArray.length;o++){if(l=randTextArray[o].split("."),r=l.length,t>r)for(j=r;j<=t;j++)l.push(l[j-r]);else l.splice(t);randTextArray[o]=l.join("."),randTextArray[o]+="."}}var s=[{r:e.getStart()}];for(i>200&&(i=200),o=0;o<i;o++){var d=Utils.randomString(),c=Utils.randomString();s.push({as:{start:{type:NODE_TYPE.TEXT},id:d}},{is:randTextArray[o%5]},{as:{end:["type"],id:d}},{as:{start:{type:NODE_TYPE.PARAGRAPH},id:c}},{is:UNICODE.PARA},{as:{end:["type"],id:c}})}Op.processMsg(s)}),e.on("ins_random_code",function(e){PubSub.publish("Document/Command/Code/InsertRandomCode",e)}),e.on("insautotable",function(t){var i,o,r,n,a,l,s,d,c,p,u,f,g,m=[];f=t[0],g=t[1],l=t[2];var h=editor.doc.getSelection(),T=h.getLastRange();if(T&&T.setStart(f.getStart())&&T.setEnd(f.getStart()),h.deleteContents(f.getStart(),f.getEnd()-1),"rand"==l){g=g.replace("=table(","");var E,R=g.split(",");return E=parseInt(R[0]),i=parseInt(R[1]),E>200&&(E=200),i>20&&(i=20),void e.exec("instable",[E,i,null])}if(i=g.match(/\+/g).length-1,u=g.split("+"),o=DocTreeManager.getTreeNodeAtIndex(f.getStart()),p=editor.doc.getComputedFormatAt(f.getStart(),NODE_TYPE.TEXT,o.paraProperties.paraFormat[ATTR_PARAGRAPH.PS_HD]),prop=FontUtils.getFontString(p,o?o.paraProperties.paraFormat.textFormat:{}),a=FontUtils.getCharSize("+",prop).width,c=u.length,l!=UNICODE.TAB)for(d=0;d<c;d++)u[d]&&(n={},r=FontUtils.getCharSize(u[d],prop),n[ATTR_CELL.TDS_WID]=a+r.width,m.push(n));else for(s=f.getStart(),d=0;d<c;d++)if(u[d]){s++;for(var S=0,O=u[d].length;S<O;S++)p=editor.doc.getRawFormatAt(s+S),n={},n[ATTR_CELL.TDS_WID]=a+p.width,m.push(n);s+=O}e.exec("instable",[1,i,null,m])}),e.on("changeOrientation",function(e){var t={},i=editor.doc.getSelection().parents(NODE_TYPE.BODY),o=Conversions.globalUnit;if(e!=PageLayoutPanel.Orientation){var r=PageLayoutPanel.getDimension(PageLayoutPanel.paperSize,o,e),n=PageLayoutPanel.isColumnFitToSize(r.width);if(!n)return J("input:radio[name='Orientation'][value='"+PageLayoutPanel.Orientation+"']").zstatebutton("checked",!0),void PubSub.publish("Document/Warning",WARNING_MSG.COLUMN_WIDTH_IS_LESS);PageLayoutPanel.Orientation=e;var a=PageLayoutPanel.pHeight,l=PageLayoutPanel.pWidth;J("#pWidth").val(l).zspinner("setValue",l),J("#pHeight").val(a).zspinner("setValue",a),PageLayoutPanel.pHeight=l,PageLayoutPanel.pWidth=a,t[ATTR_BODY.DS_PW]=PageLayoutPanel.pWidth+Conversions.globalUnit,t[ATTR_BODY.DS_PH]=PageLayoutPanel.pHeight+Conversions.globalUnit,t[ATTR_BODY.DS_OR]=PageLayoutPanel.Orientation,editor.doc.execCmd("applyStyle",[i,t,"updatePageLayout"])}}),e.on("changeView",function(e){Utils.addToStatistics(e),InsertShape.shapeCache={},InsertShape.clearSelection();var t=EditorView.getView();if(t!=e){if(editor.doc.snapShotManager.setSkipSnapShot(!0),!Utils.isNonEditableView()){var i=editor.doc.createElement(NODE_TYPE.BODY),o={};o[ATTR_BODY.DS_VIEW]=e,editor.doc.execCmd("applyStyle",[i,o,"updateView"])}editor.doc.snapShotManager.setSkipSnapShot(!1)}}),e.on("code",function(e){e=e||[],PubSub.publish("Document/Command/Code/Insert",e[0],e[1])}),e.on("updatecode",function(e){e=e||[],PubSub.publish("Document/Command/Code/Update",e[0],e[1])}),e.on("uncode",function(e){PubSub.publish("Document/Command/Code/Remove",e)}),e.on("removeAutoField",function(e){var t=e[0],i=[{r:t},{ds:UNICODE.RANGE_START+"#"+UNICODE.RANGE_END}];Op.processMsg(i)}),e.on("formatAutoField",function(e){var t=e[0],i=e[1];t.attr(i)})}(Command),Indentation.init=function(e,t){var i,o=editor.doc.getSelection(),r=o.getNodesInSelection(NODE_TYPE.PARAGRAPH),n=!1,a=0;for(i=0;i<r.length;i++){if(!a&&"list"==r[i].attr(ATTR_PARAGRAPH.PS_TYPE)&&r[i].attr(ATTR_PARAGRAPH.LS_DATA)){var l=r[i].attr(ATTR_PARAGRAPH.LS_DATA).id;a=DocTreeManager.doc.getSection(o.getStart()).lists[l].length}if(n||"list"==r[i].attr(ATTR_PARAGRAPH.PS_TYPE)||(n=!0),n&&a)break}"indent"==e?Indentation.indent(t,a,n,r):"outdent"==e&&Indentation.outdent(t,a,n,r)},Indentation.indent=function(e,t,i,o){var r=editor.doc.bodyFormat.tps;r=Conversions.toGlobalUnit(r);for(var n=editor.doc.getPaperWidth(),a=editor.doc.getHeadingListId(),l=editor.doc.getParents(NODE_TYPE.PARAGRAPH,editor.doc.getSelection().getStart()),s=0;s<o.length;s++){var d=o[s];if(t>0){var c=List.getListData(d);if(c)if(l.getStart()>DocTreeManager.doc.getSection(editor.doc.getSelection().getStart()).lists[c.id][0].start){var p=d.attr(ATTR_PARAGRAPH.PS_ML);if(p="string"==typeof p?p.convertor().pixels:p,p>=n)return;if(c.l++,c.l>8)return;var a=editor.doc.getHeadingListId();if("undefined"==typeof a||"undefined"!=typeof a&&a!=c.id)c.t=editor.doc.getListType(c.id,c.l),List.updateListData(c,d,"indent");else{if(!(c.l<6))return;DocUtil.applyHeadingForSelection(c.l+1)}}else{if(0==c.l){var u,c,f,g,d=o[s],p=d.attr(ATTR_PARAGRAPH.PS_ML);if(p="string"==typeof p?p.convertor().pixels:p,p>=n)return;var p=d.attr(ATTR_PARAGRAPH.PS_ML);if(p="string"==typeof p?p.convertor().pixels:p,"undefined"!=typeof a&&a==c.id?(g="0.5in",g="string"==typeof g?g.convertor().pixels:g,f=p+g):(g="0.25in",g="string"==typeof g?g.convertor().pixels:g,f=p+g),f>=n)return;do{for(c=d.attr(ATTR_PARAGRAPH.LS_DATA),c.t=editor.doc.getListType(c.id,c.l),editor.doc.getSelection().isCollapsed()||!editor.doc.getSelection().isCollapsed()&&0==i?List.indentFirstObject(c,d):!editor.doc.getSelection().isCollapsed()&&d.getStart()<editor.doc.getSelection().getEnd()&&List.indentFirstObject(c,d),s++,u=editor.doc.getParents(NODE_TYPE.PARAGRAPH,DocTreeManager.doc.getTreeNodeAtIndex(d.getEnd()).start);!("list"==u.attr(ATTR_PARAGRAPH.PS_TYPE)&&u.attr(ATTR_PARAGRAPH.LS_DATA).id==c.id||u.getStart()>DocTreeManager.doc.getSection(editor.doc.getSelection().getStart()).lists[c.id][t-1].start);){if(!editor.doc.getSelection().isCollapsed()&&u.getStart()<editor.doc.getSelection().getEnd()){var m=u.attr(ATTR_PARAGRAPH.PS_TI),n=Conversions.toGlobalUnit(editor.doc.getPaperWidth()/96+"in"),h=Conversions.toGlobalUnit("0.25in"),T=u.attr(ATTR_PARAGRAPH.PS_ML);T=void 0==T?"0in":T,T=Conversions.toGlobalUnit(T)+h,T=T>n?n:T;var E={};T&&(T<n||m&&T+Conversions.toGlobalUnit(m)<n)&&(E[ATTR_PARAGRAPH.PS_ML]=T+Conversions.globalUnit,u.attr(E))}u=editor.doc.getParents(NODE_TYPE.PARAGRAPH,DocTreeManager.doc.getTreeNodeAtIndex(u.getEnd()).start)}if(u.getStart()==d.getStart())break;d=u}while("undefined"!=typeof u.attr(ATTR_PARAGRAPH.PS_TYPE)&&"string"==typeof u.attr(ATTR_PARAGRAPH.PS_TYPE)&&"list"==u.attr(ATTR_PARAGRAPH.PS_TYPE)&&u.attr(ATTR_PARAGRAPH.LS_DATA).id==c.id);if(s==o.length)break;s--;continue}if(c.l++,c.l>8)return;if("undefined"==typeof a||"undefined"!=typeof a&&a!=c.id)c.t=editor.doc.getListType(c.id,c.l),List.updateListData(c,d,"indent");else{if(!(c.l<6))return;DocUtil.applyHeadingForSelection(c.l+1)}}else{var m=d.attr(ATTR_PARAGRAPH.PS_TI);if(1!=o.length||e||"undefined"!=typeof m&&0!=parseFloat(m)){var T=d.attr(ATTR_PARAGRAPH.PS_ML);T=void 0==T?"0in":T;var n=Conversions.toGlobalUnit(editor.doc.getPaperWidth()/96+"in"),h=Conversions.toGlobalUnit("0.25in");T=Conversions.toGlobalUnit(T)+h,T=T>n?n:T;var E={};T&&(T<n||m&&T+Conversions.toGlobalUnit(m)<n)&&(E[ATTR_PARAGRAPH.PS_ML]=T+Conversions.globalUnit,d.attr(E))}else{m=r;var R={};R[ATTR_PARAGRAPH.PS_TI]=m+Conversions.globalUnit,d.attr(R)}}}else{var T=Conversions.toGlobalUnit(d.attr(ATTR_PARAGRAPH.PS_ML)),n=Conversions.toGlobalUnit(editor.doc.getPaperWidth()/96+"in");T=T?T+r>=n?T:T+r:r;var S={};S[ATTR_PARAGRAPH.PS_ML]=T+Conversions.globalUnit,d.attr(S)}}},Indentation.outdent=function(e,t,i,o){var r=editor.doc.bodyFormat.tps;r=Conversions.toGlobalUnit(r);for(var n=editor.doc.getParents(NODE_TYPE.PARAGRAPH,editor.doc.getSelection().getStart()),a=0;a<o.length;a++){var l=o[a];if(t>0){var s=List.getListData(l);if(s&&s.l>=0){var d=editor.doc.getRawFormatAt(n.getStart()-1),c=editor.doc.getRawFormatAt(l.getStart()-1),p=editor.doc.getParents(NODE_TYPE.PARAGRAPH,l.getEnd()+1),u=editor.doc.getHeadingListId();if(0==s.l)if("list"!=d.ps_type||"list"!=c.ps_type||d.ls_data.id!=s.id){var f=l.attr(ATTR_PARAGRAPH.PS_ML);if(f="string"==typeof f?f.convertor().inches:f,f>.5||"undefined"!=typeof u&&u==s.id&&u>=0&&f>0){var p,s;do{for(s=l.attr(ATTR_PARAGRAPH.LS_DATA),s.t=editor.doc.getListType(s.id,s.l),editor.doc.getSelection().isCollapsed()||!editor.doc.getSelection().isCollapsed()&&0==i?List.outdentList(s,l):!editor.doc.getSelection().isCollapsed()&&l.getStart()<editor.doc.getSelection().getEnd()&&List.outdentList(s,l),a++,p=editor.doc.getParents(NODE_TYPE.PARAGRAPH,DocTreeManager.doc.getTreeNodeAtIndex(l.getEnd()).start);!("list"==p.attr(ATTR_PARAGRAPH.PS_TYPE)&&p.attr(ATTR_PARAGRAPH.LS_DATA).id==s.id||p.getStart()>DocTreeManager.doc.getSection(editor.doc.getSelection().getStart()).lists[s.id][t-1].start);){if(!editor.doc.getSelection().isCollapsed()&&p.getStart()<editor.doc.getSelection().getEnd()){var g,m;g=p.attr(ATTR_PARAGRAPH.PS_TI),m=p.attr(ATTR_PARAGRAPH.PS_ML);var h=Conversions.toGlobalUnit("0.25in");if(!m||m<=h)continue;if(1==o.length&&!e&&g&&0!=parseFloat(g)){g=Conversions.toGlobalUnit(g)-r,g<0&&(g=0);var T={};T[ATTR_PARAGRAPH.PS_TI]=g+Conversions.globalUnit,p.attr(T)}else if(e||0==parseInt(g)||void 0==g||o.length>1){m=p.attr(ATTR_PARAGRAPH.PS_ML);var h=Conversions.toGlobalUnit("0.25in");m=m?Conversions.toGlobalUnit(m)-h:-r,m<0&&(m=0);var E={};E[ATTR_PARAGRAPH.PS_ML]=m+Conversions.globalUnit,p.attr(E)}}p=editor.doc.getParents(NODE_TYPE.PARAGRAPH,DocTreeManager.doc.getTreeNodeAtIndex(p.getEnd()).start)}if(p.getStart()==l.getStart())break;l=p}while("string"==typeof p.attr(ATTR_PARAGRAPH.PS_TYPE)&&"list"==p.attr(ATTR_PARAGRAPH.PS_TYPE)&&p.attr(ATTR_PARAGRAPH.LS_DATA).id==s.id);if(a==o.length)break;a--;continue}e&&(s.l--,delete s.t,List.updateListData(s,l,"outdent"))}else e&&(s.l--,delete s.t,List.updateListData(s,l,"outdent"));else if("undefined"==typeof u||"undefined"!=typeof u&&u!=s.id){if(1==s.l&&"list"!=d.ps_type&&l!=o[0]&&"List"!=c.ps_type)continue;s.l--,delete s.t,List.updateListData(s,l,"outdent")}else{if(s.l--,!(s.l>-1))return;DocUtil.applyHeadingForSelection(s.l+1)}}else{var g,m;g=l.attr(ATTR_PARAGRAPH.PS_TI),m=l.attr(ATTR_PARAGRAPH.PS_ML);var h=Conversions.toGlobalUnit("0.25in");if(!m||m<=h)continue;if(1==o.length&&!e&&g&&0!=parseFloat(g)){g=Conversions.toGlobalUnit(g)-r,g<0&&(g=0);var T={};T[ATTR_PARAGRAPH.PS_TI]=g+Conversions.globalUnit,l.attr(T)}else if(e||0==parseInt(g)||void 0==g||o.length>1){m=l.attr(ATTR_PARAGRAPH.PS_ML);var h=Conversions.toGlobalUnit("0.25in");m=m?Conversions.toGlobalUnit(m)-h:-r,m<0&&(m=0);var E={};E[ATTR_PARAGRAPH.PS_ML]=m+Conversions.globalUnit,l.attr(E)}}}else{m=l.attr(ATTR_PARAGRAPH.PS_ML),m=m?Conversions.toGlobalUnit(m)-r:-r,m<0&&(m=0);var R={};R[ATTR_PARAGRAPH.PS_ML]=m+Conversions.globalUnit,l.attr(R)}}},Debugger.enable=function(){J("#c_debugger").is(":visible")?J("#c_debugger").hide():J("#c_debugger").show()},Debugger.disable=function(){J("#c_debugger").hide()},Debugger.getBodyFormat=function(){var e=editor.doc.bodyFormat,t=(editor.doc.formats,"<title>Writer Debugger - AnbuChezhian S</title><style> #index{ width:40px;} .tdTxt{width:1000px;word-wrap: break-word;text-align:center} .tdSty{border:0;} .para{ background-color:pink } .styleFmt{ margin:0; }</style>");t+="<div style='width:auto;height:auto;overflow:auto;border:2px solid;'><table border=1 cellspacing=3 cellpadding=4 style=font-size:18px;border-collapse:collapse;width:100%;text-align:center;><tr style='background-color:black;color:white;'><td>KEY</td><td>FORMAT</td></tr>";for(var i in e){var o=e[i];t+="<tr><td style=text-align:center>"+i+"</td><td style=text-align:center><div class=tdTxt>"+JSON.stringify(o).replace(/^"/g,"").replace(/"$/g,"")+"</td></tr>"}t+="</table></div>",width=screen.width,height=screen.height-100;var r=window.open("","","height="+height+",width="+width+",status,menubar,scrollbars,resizable,titlebar");r.document.write(t)},Debugger.getWholeFormat=function(){var e=editor.doc.contStr.split(""),t=editor.doc.contStr,i="<title>Writer Debugger - AnbuChezhian S</title><style> #index{ width:40px;} .tdTxt{width:1000px;word-wrap: break-word;text-align:center} td{letter-spacing: 2px;} .tdSty{border:0;} .para{ background-color: rgb(6, 150, 218);color: white; } .styleFmt{ margin:0; }</style>";i+="<div style='width:100%;position:fixed;top: 0; left: 0; width: 100%;box-shadow: -2px 2px 5px gray;border-bottom:2px solid;height: 28px;background-color:white'><center><table><tr><td><div style='background-color: rgb(6, 150, 218);width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Paragraph</td><td><div style='background-color:red;width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Range start</td><td><div style='background-color:orange;width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Range end</td><td><div style='background-color:darkgreen;width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Toc start</td><td><div style='background-color:pink;width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Tocend</td><td><div style='background-color:maroon;width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Linebreak</td></tr></table></center></div>",i+="</br><div style='width:auto;height:auto;overflow:auto;border:2px solid;'><table border=1 cellspacing=3 cellpadding=4 style=border-collapse:collapse;font-size:18px;width:100%;text-align:center;><tr style='background-color:black;color:white;'><td>Idx</td><td>Character</td><td>Format</td></tr>";for(var o=0;o<t.length;o++){i+="";var r=JSON.stringify(e[o]);r=r?r.replace(/^"/g,"").replace(/"$/g,""):r;var n=editor.doc.getRawFormatAt(o),a=JSON.stringify(n);if(a=a?a.replace(/"/g,""):a,"\n"==e[o])i+="<tr><td id=index>"+o+"</td><td  class=para>"+r+"</td><td  style='text-align:left;background-color: rgb(225, 238, 245);'><div class=tdTxt>"+a+"</td>";else if(""==e[o])i+="<tr><td id=index>"+o+"</td><td  title='Range Start' style='background-color:red;color:white'>"+r+"</td><td  style='text-align:left;background-color:rgb(255, 231, 231)'><div class=tdTxt>"+a+"</td>";else if(""==e[o])i+="<tr><td id=index>"+o+"</td><td  title='Range End' style='background-color:orange;color:white'>"+r+"</td><td  style='text-align:left;background-color: rgb(255, 227, 176);'><div class=tdTxt>"+a+"</td>";else if(""==e[o])i+="<tr><td id=index>"+o+"</td><td  title='Toc Start' style='background-color:darkgreen;color:white'>"+r+"</td><td  style='text-align:left'><div class=tdTxt>"+a+"</td>";else if(""==e[o])i+="<tr><td id=index>"+o+"</td><td  title='Toc End' style='background-color:pink;color:white'>"+r+"</td><td  style='text-align:left'><div class=tdTxt>"+a+"</td>";else if("\v"==e[o])i+="<tr><td id=index>"+o+"</td><td  title='Toc End' style='background-color:maroon;color:white'>"+r+"</td><td  style='text-align:left'><div class=tdTxt>"+a+"</td>";else if(""==e[o]){var n=editor.doc.getRawFormatAt(o);if(!n.hasOwnProperty("st"))continue;i+="</tr></table></br><center><h3>"+n+"</h3></center><table border=1  style=border-collapse:collapse;font-size:18px;width:100%;text-align:center;><tr><td id=index>"+o+"</td><td  title='Section' style='background-color:pink;color:white'>"+r+"</td><td  style='text-align:left'><div class=tdTxt>"+a+"</td>"}else i+="<tr><td id=index>"+o+"</td><td >"+r+"</td>",i+=a?"<td style='text-align:left'><div class=tdTxt>"+a+"</td>":"<td style=color:#888;text-align:left><div class=tdTxt>"+a+"</td>";i+="</tr>"}i+="</table></div>",width=screen.width,height=screen.height-100;var l=window.open("","","height="+height+",width="+width+",status,menubar,scrollbars,resizable,titlebar");l.document.write(i)},Debugger.getDocumentInfo=function(){var e=editor.doc.docInfo,t=(editor.doc.formats,"<title>Writer Debugger - AnbuChezhian S</title><style> #index{ width:40px;} .tdTxt{width:1000px;word-wrap: break-word;text-align:center} .tdSty{border:0;} .para{ background-color:pink } .styleFmt{ margin:0; }</style>");t+="<div style='width:auto;height:auto;overflow:auto;border:2px solid;'><table border=1 cellspacing=3 cellpadding=4 style=font-size:18px;border-collapse:collapse;width:100%;text-align:center;><tr style='background-color:black;color:white;'><td>KEY</td><td>FORMAT</td></tr>";for(var i in e){var o=e[i];t+="<tr><td style=text-align:center>"+i+"</td><td style=text-align:center><div class=tdTxt>"+JSON.stringify(o).replace(/^"/g,"").replace(/"$/g,"")+"</td></tr>"}t+="</table></div>",width=screen.width,height=screen.height-100;var r=window.open("","","height="+height+",width="+width+",status,menubar,scrollbars,resizable,titlebar");r.document.write(t)},Debugger.getUserSettingInfo=function(){var e=w_usersettings,t="<title>Writer Debugger - AnbuChezhian S</title><style> #index{ width:40px;} .tdTxt{width:1000px;word-wrap: break-word;text-align:center} .tdSty{border:0;} .para{ background-color:pink } .styleFmt{ margin:0; }</style>";t+="<div style='width:auto;height:auto;overflow:auto;border:2px solid;'><table border=1 cellspacing=3 cellpadding=4 style=font-size:18px;border-collapse:collapse;width:100%;text-align:center;><tr style='background-color:black;color:white;'><td>KEY</td><td>FORMAT</td></tr>";for(var i in e){var o=e[i];t+="<tr><td style=text-align:center>"+i+"</td><td style=text-align:center><div class=tdTxt>"+JSON.stringify(o).replace(/^"/g,"").replace(/"$/g,"")+"</td></tr>"}t+="</table></div>",width=screen.width,height=screen.height-100;var r=window.open("","","height="+height+",width="+width+",status,menubar,scrollbars,resizable,titlebar");r.document.write(t)},Debugger.spotFormat=function(){var e='<script src="//ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>';e+="<style>*{letter-spacing:1px;cursor:pointer} .tdTxt{width:1000px;word-wrap: break-word;text-align:center}</style>",e+='<script>function showDiv(idx, chr){ var curfmt = JSON.stringify(fmt[idx]); $("#anbu").html("Char :"+ JSON.stringify(chr)); console.log("fmt::", fmt[idx]);fmtDetails(fmt[idx]); }</script>',e+='<script>$(window).trigger("resize");function fmtDetails(fmt){ $("#fmt").html(""); var curfmt = fmt;for(var idx in curfmt){ $("#fmt").append("<tr style=border-bottom-width:1px;border-bottom-color:gray;border-bottom-style:solid><td style=width:110px;padding:10px>"+idx+"</td><td style=word-wrap:break-word;>"+ JSON.stringify(curfmt[idx])+"</td></tr>") }  }</script>';var t=screen.width-20,i=screen.height-100;e+="<div style=width:"+t+"px;height:"+i+'overflow:auto ><table cellspacing=8 style="width:800px;word-wrap:break-word"><tr><td>',e+="<body style=background-color:rgb(125, 125, 125);>",e+='<div id=content style="background-color: #FDFDFD;padding:20px;width: 700px;height: 580px;word-wrap:break-word;border: 1px solid #CAC9C9;overflow:auto;font-size: 17px;letter-spacing: 23px;border-radius: 5px;">';for(var o=editor.doc.contStr.split(""),r=[],n=0;n<o.length;n++)r.push(editor.doc.getRawFormatAt(n));for(var o=editor.doc.contStr.split(""),a=0;a<o.length;a++)if(JSON.stringify(o[a])){var l=JSON.stringify(o[a]).replace(/"/g,"");e+='<span onclick=$($.find("span")).css({"background-color":"white","color":"black"});$(this).css({"background-color":"yellow","color":"red"});showDiv('+a+',"'+l+'"); id='+a+">"+l+"</span>"}e+='</div></td><td style="vertical-align:text-top;background-color: rgb(234, 234, 234);border: 1px solid #C3C3C3;overflow:auto;width: 400px;border-radius: 5px;"><div id=anbu style="padding:4px;height:20px;background-color: #38B4E4;border-bottom: 1px solid white;text-align: center;color: white;padding-top: 10px;padding-bottom: 10px;width: 550px;border-radius: 4px;">Click a char</div>',e+='<div style=width:auto;height:auto;overflow:auto;><table id=fmt style="padding: 9px;table-layout:fixed;border-collapse:collapse;height:auto;width: 100%;overflow: hidden;margin-top: 10px;text-align: center;"></table></td></tr></table></div></div></body>',t=screen.width,i=screen.height-100;var s=new Date,d=(s.getMilliseconds(),window.open("","","height="+i+",width="+t+",status,menubar,scrollbars,resizable,titlebar"));d.fmt=r,newdocument=d.document,newdocument.write(e),newdocument.close()},Debugger.getSelectedContent=function(){var e=editor.doc.contStr.split(""),t=editor.doc.contStr,i=(editor.doc.formats,editor.doc.cursor?editor.doc.cursor.getStart():editor.doc.getSelection().getStart()),o=editor.doc.cursor?editor.doc.cursor.getEnd():editor.doc.getSelection().getEnd();t=JSON.stringify(t.substring(i,o));var r="<title>Writer Debugger - AnbuChezhian S</title><style> #index{ width:40px;} .tdTxt{width:1000px;word-wrap: break-word;text-align:center} .tdSty{border:0;} .para{ background-color: rgb(6, 150, 218);color: white; }  .styleFmt{ margin:0; }</style>";r+="<div style='width:100%;position:fixed;top: 0; left: 0; width: 100%;box-shadow: -2px 2px 5px gray;border-bottom:2px solid;height: 28px;background-color:white'><center><table><tr><td><div style='background-color: rgb(6, 150, 218);width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Paragraph</td><td><div style='background-color:red;width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Range start</td><td><div style='background-color:orange;width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Range end</td><td><div style='background-color:darkgreen;width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Toc start</td><td><div style='background-color:pink;width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Tocend</td><td><div style='background-color:maroon;width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Linebreak</td></tr></table></center></div>",r+="</br><div style='width:auto;height:auto;overflow:auto;border:2px solid;'><table border=1 cellspacing=3 cellpadding=4 style=border-collapse:collapse;font-size:18px;width:100%;word-wrap:break-word;text-align:center;><tr style=background-color:black;color:white;><td>Idx</td><td>Character</td><td>Format</td></tr>";for(var n=i;n==i||n<o;n++){r+="";var a=JSON.stringify(e[n]);a=a?a.replace(/^"/g,"").replace(/"$/g,""):a;var l=editor.doc.getRawFormatAt?editor.doc.getRawFormatAt(n):editor.doc.getFormatAt(n),s=JSON.stringify(l);if(s=s?s.replace(/"/g,""):s,"\n"==e[n])r+="<tr><td id=index>"+n+"</td><td  class=para>"+a+"</td><td  style='text-align:left;background-color: rgb(225, 238, 245);word-wrap:break-word'><div class=tdTxt>"+s+"</td>";else if(""==e[n])r+="<tr><td id=index>"+n+"</td><td  title='Range Start' style='background-color:red;color:white'>"+a+"</td><td  style='text-align:left;background-color:rgb(255, 231, 231);word-wrap:break-word'><div class=tdTxt>"+s+"</td>";else if(""==e[n])r+="<tr><td id=index>"+n+"</td><td  title='Range End' style='background-color:orange;color:white'>"+a+"</td><td  style='text-align:left;background-color: rgb(255, 227, 176);word-wrap:break-word'><div class=tdTxt>"+s+"</td>";else if(""==e[n])r+="<tr><td id=index>"+n+"</td><td  title='Toc Start' style='background-color:darkgreen;color:white'>"+a+"</td><td  style='text-align:left;word-wrap:break-word'><div class=tdTxt>"+s+"</td>";else if(""==e[n])r+="<tr><td id=index>"+n+"</td><td  title='Toc End' style='background-color:pink;color:white'>"+a+"</td><td  style='text-align:left;word-wrap:break-word'><div class=tdTxt>"+s+"</td>";else if("\v"==e[n])r+="<tr><td id=index>"+n+"</td><td  title='Toc End' style='background-color:maroon;color:white'>"+a+"</td><td  style='text-align:left;word-wrap:break-word'><div class=tdTxt>"+s+"</td>";else if(""==e[n]){var l=editor.doc.getRawFormatAt?editor.doc.getRawFormatAt(n):editor.doc.getFormatAt(n);if(!l.hasOwnProperty("st"))continue;l=l.st.toString().toUpperCase(),r+="</tr></table></br><center><h3>"+l+"</h3></center><table border=1  style=border-collapse:collapse;font-size:18px;width:100%;text-align:center;><tr><td id=index>"+n+"</td><td  title='Section' style='background-color:pink;color:white'>"+a+"</td><td  style='text-align:left;word-wrap:break-word'><div class=tdTxt>"+s+"</td>"}else r+="<tr><td id=index>"+n+"</td><td >"+a+"</td>",r+=s?"<td style='text-align:left;word-wrap:break-word'><div class=tdTxt>"+s+"</td>":"<td style=color:#888;text-align:left;word-wrap:break-word><div class=tdTxt>"+s+"</td>";r+="</tr>"}r+="</table></div>",width=screen.width,height=screen.height-100;var d=window.open("","","height="+height+",width="+width+",status,menubar,scrollbars,resizable,titlebar");d.document.write(r)},Debugger.getCustomContent=function(e,t){var i=e.split(""),e=e,o="<title>Writer Debugger - AnbuChezhian S</title><style> #index{ width:40px;} .tdTxt{width:1000px;word-wrap: break-word;text-align:center} .tdSty{border:0;} .para{ background-color: rgb(6, 150, 218);color: white; }  .styleFmt{ margin:0; }</style>";o+="<div style='width:100%;position:fixed;top: 0; left: 0; width: 100%;box-shadow: -2px 2px 5px gray;border-bottom:2px solid;height: 28px;background-color:white'><center><table><tr><td><div style='background-color: rgb(6, 150, 218);width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Paragraph</td><td><div style='background-color:red;width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Range start</td><td><div style='background-color:orange;width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Range end</td><td><div style='background-color:darkgreen;width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Toc start</td><td><div style='background-color:pink;width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Tocend</td><td><div style='background-color:maroon;width:10px;height;10px;height: 10px;display: inline;float: left;margin-top: 5px;'></div>&nbsp;Linebreak</td></tr></table></center></div>",o+="</br><div style='width:auto;height:auto;overflow:auto;border:2px solid;'><table border=1 cellspacing=3 cellpadding=4 style=border-collapse:collapse;font-size:18px;width:100%;word-wrap:break-word;text-align:center;><tr style=background-color:black;color:white;><td>Idx</td><td>Character</td><td>Format</td></tr>";for(var r=0;r<i.length;r++){o+="";var n=JSON.stringify(i[r]);n=n?n.replace(/^"/g,"").replace(/"$/g,""):n;var a=t[r],l=JSON.stringify(a);if(l=l?l.replace(/"/g,""):l,"\n"==i[r])o+="<tr><td id=index>"+r+"</td><td  class=para>"+n+"</td><td  style='text-align:left;background-color: rgb(225, 238, 245);word-wrap:break-word'><div class=tdTxt>"+l+"</td>";else if(""==i[r])o+="<tr><td id=index>"+r+"</td><td  title='Range Start' style='background-color:red;color:white'>"+n+"</td><td  style='text-align:left;background-color:rgb(255, 231, 231);word-wrap:break-word'><div class=tdTxt>"+l+"</td>";else if(""==i[r])o+="<tr><td id=index>"+r+"</td><td  title='Range End' style='background-color:orange;color:white'>"+n+"</td><td  style='text-align:left;background-color: rgb(255, 227, 176);word-wrap:break-word'><div class=tdTxt>"+l+"</td>";else if(""==i[r])o+="<tr><td id=index>"+r+"</td><td  title='Toc Start' style='background-color:darkgreen;color:white'>"+n+"</td><td  style='text-align:left;word-wrap:break-word'><div class=tdTxt>"+l+"</td>";else if(""==i[r])o+="<tr><td id=index>"+r+"</td><td  title='Toc End' style='background-color:pink;color:white'>"+n+"</td><td  style='text-align:left;word-wrap:break-word'><div class=tdTxt>"+l+"</td>";else if("\v"==i[r])o+="<tr><td id=index>"+r+"</td><td  title='Toc End' style='background-color:maroon;color:white'>"+n+"</td><td  style='text-align:left;word-wrap:break-word'><div class=tdTxt>"+l+"</td>";else if(""==i[r]){if(!a.hasOwnProperty("st"))continue;a=a.st.toString().toUpperCase(),o+="</tr></table></br><center><h3>"+a+"</h3></center><table border=1  style=border-collapse:collapse;font-size:18px;width:100%;text-align:center;><tr><td id=index>"+r+"</td><td  title='Section' style='background-color:pink;color:white'>"+n+"</td><td  style='text-align:left;word-wrap:break-word'><div class=tdTxt>"+l+"</td>"}else o+="<tr><td id=index>"+r+"</td><td >"+n+"</td>",o+=l?"<td style='text-align:left;word-wrap:break-word'><div class=tdTxt>"+l+"</td>":"<td style=color:#888;text-align:left;word-wrap:break-word><div class=tdTxt>"+l+"</td>";o+="</tr>"}o+="</table></div>",width=screen.width,height=screen.height-100;var s=window.open("","","height="+height+",width="+width+",status,menubar,scrollbars,resizable,titlebar");s.document.write(o)},Debugger.openPopup=function(e){debugMode=e,J.dialogutil.open("debugger",J("#c_debugger"),Debugger.dialogInfo)},Follow=new function(e){this.init=function(e){this.$el=e,this.syncUI()},this.states={ALL_CHANGES:!1,ALL_COMMENTS:!1,NEW_COMMENTS:!1,PARTICIPATED_COMMENTS:!1,NO_NOTIFICATION:!1},this.stateValues=NOTIFICATION_RULE_CONSTANTS,this.encodeStates=function(){var e=null;for(var t in this.states)this.states[t]&&(e&&(e|=this.stateValues[t]),e||(e=this.stateValues[t]));return e},this.decodeStates=function(e){e=e==-1?this.states.NO_NOTIFICATION:e;for(var t in this.stateValues){var i=this.stateValues[t];(e&i)===i&&(this.states[t]=!0)}return this.states},this.states=this.decodeStates(parseInt(editor.doc.getDocInfo().NOTIFY_RULE)),this.enableCommentOptions=function(){this.$el.find("#comments-sub-options").find(":checkbox").enable()},this.disableCommentOptions=function(){this.$el.find("#comments-sub-options").find(":checkbox").disable()},this.showCommentSubOptions=function(e){if(this.$el.find("#comment-changes").is(":checked")){var t=this;this.enableCommentOptions();var i=t.$el.find("#all-comments").prop("checked")||t.$el.find("#new-comments").prop("checked")||t.$el.find("#participated-comments").prop("checked");i?t.enforceValidation():t.$el.find("#all-comments").prop("checked",!0)}else{var t=this;this.disableCommentOptions()}},this.enforceValidation=function(e){this.$el.find("#all-comments").prop("checked")&&this.disableCustomCommentNotificationOptions()},this.disableCustomCommentNotificationOptions=function(){this.$el.find("#new-comments").prop("checked",!1),this.$el.find("#participated-comments").prop("checked",!1)},this.disableAllCommentNotificationOption=function(){this.$el.find("#all-comments").prop("checked",!1)},this.onSelectAllCommentNotifcations=function(){this.$el.find("#all-comments").prop("checked")?this.disableCustomCommentNotificationOptions():this.$el.find("#new-comments").prop("checked")||this.$el.find("#participated-comments").prop("checked")||this.$el.find("#all-comments").prop("checked",!0)},this.onSelectNewCommentNotifications=function(){this.$el.find("#new-comments").prop("checked")?this.disableAllCommentNotificationOption():this.$el.find("#all-comments").prop("checked")||this.$el.find("#participated-comments").prop("checked")||this.$el.find("#all-comments").prop("checked",!0)},this.onSelectParticipatedCommentNotifications=function(){this.$el.find("#participated-comments").prop("checked")?this.disableAllCommentNotificationOption():this.$el.find("#all-comments").prop("checked")||this.$el.find("#new-comments").prop("checked")||this.$el.find("#all-comments").prop("checked",!0)},this.events={"#all-changes,#comment-changes,#no-notifications click":this.showCommentSubOptions,"#all-comments click":this.onSelectAllCommentNotifcations,"#new-comments click":this.onSelectNewCommentNotifications,"#participated-comments click":this.onSelectParticipatedCommentNotifications},this._bindEvents=function(){var t=U.keys(this.events),i=this;t.map(function(t){var o=t.split(" ");e=o.length>1?i.$el.find(o[0]):i.$el;var r=o.pop(),n=i.events[t];e.on(r,U.bind(n,i))}),this.$el.data("events.boud",!0)},this.bindEvents=function(){var e=this.$el.data("events.bound");e||this._bindEvents()},this.syncUI=function(){this.states.ALL_CHANGES&&(this.disableCommentOptions(),this.$el.find("#all-changes").prop("checked",!0)),this.states.ALL_COMMENTS&&(this.enableCommentOptions(),this.$el.find("#comment-changes").prop("checked",!0),this.$el.find("#all-comments").prop("checked",!0)),this.states.NEW_COMMENTS&&(this.enableCommentOptions(),this.$el.find("#comment-changes").prop("checked",!0),this.$el.find("#new-comments").prop("checked",!0)),this.states.PARTICIPATED_COMMENTS&&(this.enableCommentOptions(),this.$el.find("#comment-changes").prop("checked",!0),this.$el.find("#participated-comments").prop("checked",!0)),this.states.NO_NOTIFICATION&&(this.disableCommentOptions(),this.$el.find("#no-notifications").prop("checked",!0))},this.done=function(){this.states.ALL_CHANGES=!1,this.states.ALL_COMMENTS=!1,this.states.NEW_COMMENTS=!1,this.states.PARTICIPATED_COMMENTS=!1,this.states.NO_NOTIFICATION=!1,this.$el.find("#all-changes").prop("checked")&&(this.states.ALL_CHANGES=!0),this.$el.find("#comment-changes").prop("checked")&&(this.$el.find("#all-comments").prop("checked")&&(this.states.ALL_COMMENTS=!0),this.$el.find("#new-comments").prop("checked")&&(this.states.NEW_COMMENTS=!0),this.$el.find("#participated-comments").prop("checked")&&(this.states.PARTICIPATED_COMMENTS=!0)),this.$el.find("#no-notifications").prop("checked")&&(this.states.NO_NOTIFICATION=!0);var e=this.encodeStates(),t=this.$el.find("#notify_makedefault").prop("checked"),i={};i.rid=editor.doc.getDocInfo().RID,i.notify=JSON.stringify(this.states),i.notify_default=t,Utils.setCsrfParam(i);var o=this;J.post(Utils.getNiceUrlPrefix("user/settings/notificationrule"),i,function(){editor.doc.getDocInfo().NOTIFY_RULE=JSON.stringify(e),o.states.ALL_CHANGES||o.states.ALL_COMMENTS?CommentUtils.updateFollowers("followAllComments"):o.states.NO_NOTIFICATION?CommentUtils.updateFollowers("unfollowAllComments"):o.states.PARTICIPATED_COMMENTS&&CommentUtils.updateFollowers("followParticipatedComments")}),Utils.addToStatistics("doc_notificationSettings"),J.dialogutil.close("notification")}},Handlebars.registerHelper("getProp",function(e,t){return t[e]}),Handlebars.registerHelper("getId",function(){var e=null!=this.parentId?this.parentId:this.id;return editor.base_url+"/open/"+editor.doc.rid+"/comments/"+e}),Handlebars.registerHelper("getUsername",function(e){var t;return t=e&&""!==e?ReviewUtil.getUserProp(e,"fname"):"Guest"}),Handlebars.registerHelper("timeAgo",function(e){return"string"==typeof e&&(e=parseInt(e)),e=new Date(e).getTime(),e?moment(e).fromNow():""}),Handlebars.registerHelper("safestring",function(e){return new Handlebars.SafeString(e)}),Handlebars.registerHelper("i18n",function(){return J.i18n(arguments[0],arguments[1])}),Handlebars.registerHelper("getMarkedupCommentContent",function(e){var t=CommentUtils.getMarkedupCommentContent(CommentUtils.escapeHTML(e));return new Handlebars.SafeString(t)}),Handlebars.registerHelper("getUserImg",function(e){return Utils.getUserImageURL(e)}),Handlebars.registerHelper("getUserColor",function(e){return ReviewUtil.getUserColour(e)}),Handlebars.registerHelper("getCount",function(e){return CommentUtils.getCount(e)}),Handlebars.registerHelper("datetime",function(e){return e=new Date(e),moment(e).format("LLLL")}),Handlebars.registerHelper("datewithformat",function(e,t){return"string"==typeof e&&(e=parseInt(e)),e=new Date(e),moment(e).format(t||"ll")}),Handlebars.registerHelper("clone",function(e){if(e){var t=J(e);if(t.length<1)return"";t=t.clone();var i=t.attr("id")+"-helper";t=t.attr("id",i).removeAttr("onclick").off("click"),t.find("[onclick]").removeAttr("onclick").off("click"),t.find("[title]").removeAttr("title").off("click");var o=t[0].outerHTML;return new Handlebars.SafeString(o)}return""}),Handlebars.registerHelper("unescapeHtml",function(e){return J("<textarea />").html(e).val()}),Handlebars.registerHelper("escapeHtml",function(e){var t=document.createTextNode(e);return t.nodeValue}),Handlebars.registerHelper("appendWindowProtocol",function(e){return window.location.protocol+"//"+e}),Handlebars.registerHelper("constructQTImgSrc",function(e){return"/writer/v1/web/autotext/preview/"+e}),LikeView=function(e,t){var i=e.View.extend({tagName:"div",tpl:Handlebars.compile(t("#like-view").html()),likelistTpl:Handlebars.compile(t("#like-list-view").html()),initialize:function(e){this.listenTo(this.model,"change:likes",this.render),this.render()},events:{"click #comment-like-btn":"like","click #comment-like-btn-secondary":"like","click #comment-like-count-btn":"showLikes"},like:function(e){CommentUtils.addParticipant();var t=this.model.get("likes");t.indexOf(editor.zuid)>-1?(this.model.unlike(!0),Utils.addToStatistics("comment_unlike")):(this.model.like(!0),Utils.addToStatistics("comment_like"))},showLikes:function(e){if(this.model.get("likes").length){var i=t("#likelistview"),o=t("#likelistoverlay"),r=i.find("#likelist-content-container"),n=this.likelistTpl(this.model.attributes);r.html(n);var a=o.width()/2-i.width()/2;i.css("top","96px").css("left",a+"px").show(),o.show(),Utils.addToStatistics("comment_viewLikes")}},render:function(){var e=this,t={};return t.hasLiked=this.model.get("likes").indexOf(editor.zuid)>-1,t.noOfLikes=this.model.get("likes").length,t.isMultipleLikes=this.model.get("likes").length>1,t.likedUsernames=function(){var t=e.model.get("likes").map(function(e){return e==editor.zuid?"You":CommentUtils.getUsername(e)});return t.join(", ")}(),this.$el.html(this.tpl(t)),this.delegateEvents(),this}});return i}(Backbone,jQuery),FollowView=function(e,t){var i=e.View.extend({tagName:"span",tpl:Handlebars.compile(t("#follow-view").html()),initialize:function(e){this.listenTo(this.model,"change:followers",this.render),this.render()},events:{"click #comment-follow-btn":"follow"},follow:function(e){CommentUtils.addParticipant();var t=this.model.get("followers");if(t.indexOf(editor.zuid)>-1)this.model.unfollow(!0),Utils.addToStatistics("comment_unfollow");else{this.model.follow(!0),Utils.addToStatistics("comment_follow");var i=CommentManager.views.commentCollectionView.commentViewMap[this.model.id],o=CommentManager.views.commentCollectionView.commentBubbleViewMap[this.model.id];i&&i.showFollowToast(),o&&o.showFollowToast()}},render:function(){var e={};return e.hasFollowed=this.model.get("followers").indexOf(editor.zuid)>-1,this.$el.html(this.tpl(e)),this.delegateEvents(),this}});return i}(Backbone,jQuery),CommentCreationView=function(e,t,i){var o=e.View.extend({el:"#postDialog",events:{"input #textarea":"autoHeightTextArea","keydown #textarea":"listenForKeyBoardShortcuts","click #comment-cancel-btn":"cancel","click #comment-add-btn":"done","focus #textarea":function(e){EventHandler.isDialogOpened=!0},"focusout #textarea":function(e){EventHandler.isDialogOpened=!1}},tpl:Handlebars.compile(i("#commentdialog-view-4").html()),initialize:function(e){this.listenTo(this.model,"change:commentCreationDialogShow",this.setVisibility),this.render()},setVisibility:function(e,i,o){if(i)t.cursorSelection=CommentUtils.selectWord(),t.commentPane.set("noCommentsToShow",!1),"SHAREDREADCOMMENT"===editor.doc.getRole()||ModeManager.getCurrentMode()===EDITOR_MODES.COLLABORATE?(CommentUtils.showDialogInCommentPane(this.$el),CommentUtils.pullCommentInputIntoView()):CommentUtils.showDialogInEditorPane(this.$el),setTimeout(function(){this.$("#textarea").trigger("focus")},200);else{var r=this;this.$el.slideUp(200,function(){r.$("#textarea").height(""),r.$("#textarea").val(""),r.$el.css("left","-10000px"),r.$el.detach().appendTo("body"),o.then&&o.then()}),this.$el.find(".ui-ncmt-container-div").removeClass("ui-ncmt-container-cmode"),CommentUtils.isAnyCommentRenderedInPane()||t.commentPane.set("noCommentsToShow",!0),CommentUtils.hideCurrentCommentSelection(),t.cursorSelection.start=null,t.cursorSelection.end=null,EditorUtil.focusMultiByteSpan()}return this},autoHeightTextArea:function(e){CommentUtils.autoHeightTextArea(e)},listenForKeyBoardShortcuts:function(e){CommentUtils.doneKey(e,this.done,this),CommentUtils.cancelKey(e,this.handleEscKey.bind(this,e),this)},handleEscKey:function(e){return this.$("#textarea").val().trim()?(e.stopPropagation(),!1):void this.cancel()},cancel:function(){t.commentPane.set("commentCreationDialogShow",!1)},done:function(){var e=CommentUtils.removeInvalidChars(this.$("#textarea").val());if(""==e.trim())return!1;var i,o,r=editor.doc.getSelection();r.length>1?(o=r.getTargetRange(),i=o.end):i=r.getEnd();var n=t.cursorSelection.start,a=t.cursorSelection.end;t.commentPane.set("commentCreationDialogShow",!1),CommentUtils.addParticipant();var l={text:e,html:CommentUtils.getMarkedupCommentContent(e),doctext:editor.doc.getContent(n,a),reads:[editor.zuid]},s=t.CommentCollection.createComment(l);t.commentCollection.addComment(s,!0,n,a),t.commentToggle.get("display")||CommentManager.toggleCommentPaneVisibility(),editor.doc.getSelection().isCollapsed()||editor.doc.getCharAt(i-1)!=UNICODE.PARA||(i-=1);var d=i+2,r=editor.doc.getSelection(),c=editor.doc.createRange(d);r.setSelectionType(SEL_KEYBOARD).removeAllRanges().addRange(c),EditorUtil.focusMultiByteSpan(),Utils.addToStatistics("comment_add")},focus:function(){this.$("#textarea").trigger("focus")},detach:function(){this.$el.detach()},render:function(){var e={};e.zuid=editor.zuid,e.userImg=Utils.getUserImageURL(editor.zuid),e.colorCode=ReviewUtil.getUserColour(e.zuid);var t=this.tpl(e);return this.$el.html(t),this.$("#textarea").atMention(),this}});return o}(Backbone,CommentModels,jQuery),ReplyCommentView=function(e,t,i){var o=e.View.extend({tagName:"div",commentTpl:Handlebars.compile(i("#reply-comment-view-4").html()),initialize:function(e){this.listenTo(this.model,"change:isShowingMenu",this.setMenuVisibility),this.listenTo(this.model,"change:inEditingMode",this.setEditMode),this.listenTo(this.model,"change:text",this.updateCommentContent),this.likeView=new LikeView({model:this.model})},events:{mouseover:"showOnMouseOver",mouseout:"hideOnMouseOut","click .reply-comment-container":function(){this.model.set("isShowingMenu",!1)},"mouseover .reply-comment-container":function(){!this.model.get("parentComment").get("isResolved")&&this.$(".child-comnt-options").show()},"mouseout .reply-comment-container":function(){!this.model.get("isShowingMenu")&&this.$(".child-comnt-options").hide()},"click #replycomment-menudropdown-handle":"displayMenu","click #replycomment-menuoption-edit":"initEditMode","click #replycomment-menuoption-delete":"showDeleteConfirmation","click #replycomment-delete-cancel":"hideDeleteConfirmation","click #replycomment-delete-confirm":"initDelete","keyup #replycomment-edit-textarea":"autoHeightTextArea","keydown #replycomment-edit-textarea":"listenForKeyBoardShortcuts","click #replycomment-edit-btn":"edit","click #replycomment-edit-cancel-btn":"cancelEditMode","click #replycomment-expand-btn":"expandCommentContent","click #replycomment-shrink-btn":"shrinkCommentContent","focus #replycomment-edit-textarea":function(e){EventHandler.isDialogOpened=!0},"focusout #replycomment-edit-textarea":function(e){EventHandler.isDialogOpened=!1}},displayMenu:function(e){this.model.set("isShowingMenu",!0),this.stopPropagation(e)},setMenuVisibility:function(e,t,i){t?(this.$(".child-menu").show(),this.$(".child-menudropdown-handle").addClass("ui-comnt-edt-options-active")):(this.$(".child-menu").hide(),this.$(".child-menudropdown-handle").removeClass("ui-comnt-edt-options-active"))},autoHeightTextArea:function(e){CommentUtils.autoHeightTextArea(e)},listenForKeyBoardShortcuts:function(e){CommentUtils.doneKey(e,this.edit,this),CommentUtils.cancelKey(e,this.cancelEditMode,this)},initEditMode:function(){this.model.set("inEditingMode",!0),this.model.set("isShowingMenu",!1)},showDeleteConfirmation:function(){this.$(".ui-delete-comment-child").show()},hideDeleteConfirmation:function(){this.$(".ui-delete-comment-child").hide()},setEditMode:function(e,t,i){if(t){this.$("#child-text-container").hide(),this.$(".child-edit-cont").show();var o=this.model.get("text");this.$("#replycomment-edit-textarea").val(o),CommentUtils.updateTextAreaHeight(this.$("#replycomment-edit-textarea")[0]),this.$("#replycomment-edit-textarea").trigger("focus")}else this.$("#child-text-container").show(),this.$(".child-edit-cont").hide()},edit:function(){var e=CommentUtils.removeInvalidChars(this.$("#replycomment-edit-textarea").val());return""!=e.trim()&&e!=this.model.get("text")&&(this.model.set("inEditingMode",!1),this.model.get("parentComment").editReplyComment(this.model,e,!0),void Utils.addToStatistics("comment_edit"))},updateCommentContent:function(e,t,i){this.$("#child-text-container").html(CommentUtils.getMarkedupCommentContent(CommentUtils.escapeHTML(t)))},cancelEditMode:function(){this.model.set("inEditingMode",!1)},initDelete:function(){var e=this;this.$el.slideUp(200,function(){e.model.get("parentComment").removeReplyComment(e.model,!0)})},delete:function(e){},stopPropagation:function(e){e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault()},ellipsizeCommentContent:function(){this.model.get("text").length>400&&this.model.get("text").length-400>50?(this.$(".ui-toggle-replycomment-height").show(),this.$("#child-text-container").addClass("commentcontent-shrinked"),this.$("#replycomment-expand-btn").show(),this.$("#replycomment-shrink-btn").hide()):(this.$(".ui-toggle-replycomment-height").hide(),this.$("#child-text-container").removeClass("commentcontent-shrinked"))},expandCommentContent:function(e){this.$("#child-text-container").removeClass("commentcontent-shrinked"),this.$("#replycomment-expand-btn").hide(),this.$("#replycomment-shrink-btn").show(),this.stopPropagation(e)},shrinkCommentContent:function(e){this.$("#child-text-container").addClass("commentcontent-shrinked"),this.$("#replycomment-expand-btn").show(),this.$("#replycomment-shrink-btn").hide(),this.stopPropagation(e)},showOnMouseOver:function(){this.$(".show-on-hover").show()},hideOnMouseOut:function(){this.$(".show-on-hover").hide()},render:function(){var e=this.model.attributes;return e.canShowOptions=editor.zuid===e.zuid,e.colorCode=ReviewUtil.getUserColour(e.zuid),e.currentUserColorCode=ReviewUtil.getUserColour(editor.zuid),this.$el.html(this.commentTpl(e)),this.$("#child-like-container").html(this.likeView.render().$el),this.ellipsizeCommentContent(),this.$(".enable-atmentions").atMention({commentId:this.model.id}),CommentUtils.initComponents(this.$el),this.hideOnMouseOut(),this}});return o}(Backbone,CommentModels,jQuery),ReplyCommentBubbleView=function(e,t,i){var o=e.View.extend({tagName:"div",commentTpl:Handlebars.compile(i("#reply-comment-bubble-view-4").html()),initialize:function(e){this.listenTo(this.model,"change:text",this.updateCommentContent),this.listenTo(this.model,"change:inEditingMode",this.setEditMode),this.likeView=new LikeView({model:this.model})},events:{"click #replycomment-menuoption-edit":"initEditMode","click #replycomment-menuoption-delete":"showDeleteConfirmation","click #replycomment-delete-cancel":"hideDeleteConfirmation","click #replycomment-delete-confirm":"initDelete","keyup #replycomment-edit-textarea":"autoHeightTextArea","keydown #replycomment-edit-textarea":"listenForKeyBoardShortcuts","click #replycomment-edit-btn":"edit","click #replycomment-edit-cancel-btn":"cancelEditMode","focus #replycomment-edit-textarea":function(e){EventHandler.isDialogOpened=!0},"focusout #replycomment-edit-textarea":function(e){EventHandler.isDialogOpened=!1}},initDelete:function(){var e=this;this.$el.slideUp(200,function(){e.model.get("parentComment").removeReplyComment(e.model,!0)})},showDeleteConfirmation:function(){this.$(".ui-delete-comment-child").show()},hideDeleteConfirmation:function(){this.$(".ui-delete-comment-child").hide()},autoHeightTextArea:function(e){CommentUtils.autoHeightTextArea(e)},listenForKeyBoardShortcuts:function(e){CommentUtils.doneKey(e,this.edit,this),CommentUtils.cancelKey(e,this.cancelEditMode,this)},updateCommentContent:function(e,t,i){this.$("#child-text-container").html(CommentUtils.getMarkedupCommentContent(CommentUtils.escapeHTML(t)))},ellipsizeCommentContent:function(){this.model.get("text").length>400&&this.model.get("text").length-400>50?(this.$(".ui-toggle-comment-height").show(),this.$("#child-text-container").addClass("commentcontent-shrinked"),this.$("#replycomment-expand-btn").show(),this.$("#replycomment-shrink-btn").hide()):(this.$(".ui-toggle-comment-height").hide(),this.$("#child-text-container").removeClass("commentcontent-shrinked"))},expandCommentContent:function(e){this.$("#child-text-container").removeClass("commentcontent-shrinked"),this.$("#replycomment-expand-btn").hide(),this.$("#replycomment-shrink-btn").show(),this.stopPropagation(e)},shrinkCommentContent:function(e){this.$("#child-text-container").addClass("commentcontent-shrinked"),this.$("#replycomment-expand-btn").show(),this.$("#replycomment-shrink-btn").hide(),this.stopPropagation()},initEditMode:function(){this.model.set("inEditingMode",!0),this.model.set("isShowingMenu",!1)},setEditMode:function(e,t,i){if(t){this.$("#child-text-container").hide(),this.$(".child-edit-cont").show();var o=this.model.get("text");this.$("#replycomment-edit-textarea").val(o),CommentUtils.updateTextAreaHeight(this.$("#replycomment-edit-textarea")[0]),this.$("#replycomment-edit-textarea").trigger("focus")}else this.$("#child-text-container").show(),this.$(".child-edit-cont").hide()},edit:function(){var e=CommentUtils.removeInvalidChars(this.$("#replycomment-edit-textarea").val());return""!=e.trim()&&e!=this.model.get("text")&&(this.model.set("inEditingMode",!1),this.model.get("parentComment").editReplyComment(this.model,e,!0),void Utils.addToStatistics("comment_edit"))},updateCommentContent:function(e,t,i){this.$("#child-text-container").html(CommentUtils.getMarkedupCommentContent(CommentUtils.escapeHTML(t)))},cancelEditMode:function(){this.model.set("inEditingMode",!1)},render:function(){var e=this.model.attributes;return e.canShowOptions=editor.zuid===e.zuid,e.colorCode=ReviewUtil.getUserColour(e.zuid),e.currentUserColorCode=ReviewUtil.getUserColour(editor.zuid),this.$el.html(this.commentTpl(e)),this.$("#child-like-container").html(this.likeView.render().$el),this.$(".enable-atmentions").atMention({commentId:this.model.id}),this}});return o}(Backbone,CommentModels,jQuery),ReplyCommentCollectionView=function(e,t,i,o){var r=t.View.extend({tagName:"div",initialize:function(e){this.parentCommentObj=e.parentComment,this.activityLog=this.parentCommentObj.get("activityLog"),this.listenTo(this.collection,"reset",this.render),this.listenTo(this.activityLog,"add",this.render),this.listenTo(this.collection,"remove",this.removeComment)},commentViewMap:{},resolveTpl:Handlebars.compile(o("#resolve-view-4").html()),reopenTpl:Handlebars.compile(o("#reopen-view-4").html()),removeComment:function(e,t){var i=this.commentViewMap[e.id];i&&i.remove(),delete this.commentViewMap[e.id]},renderLog:function(t){if(t.get("action")==i.ACTIVITYLOG.REPLY_ADD){var o=this.collection.get(t.get("commentId"));o&&(replyCommentView=new e({model:o}),this.commentViewMap[o.id]=replyCommentView,this.$el.append(replyCommentView.render().$el))}else t.get("action")==i.ACTIVITYLOG.RESOLVE?this.$el.append(this.resolveTpl(t.attributes)):t.get("action")==i.ACTIVITYLOG.REOPEN&&this.$el.append(this.reopenTpl(t.attributes));CommentUtils.initComponents(this.$el)},render:function(){var e=this;return this.$el.empty(),this.activityLog.each(function(t){e.renderLog(t)}),this}});return r}(ReplyCommentView,Backbone,CommentModels,jQuery),ReplyCommentCollectionBubbleView=function(e,t,i,o){var r=t.View.extend({tagName:"div",initialize:function(e){this.parentCommentObj=e.parentComment,this.activityLog=this.parentCommentObj.get("activityLog"),this.listenTo(this.collection,"reset",this.render),this.listenTo(this.activityLog,"add",this.render),this.listenTo(this.collection,"remove",this.removeComment)},commentViewMap:{},resolveTpl:Handlebars.compile(o("#resolve-bubble-view-4").html()),reopenTpl:Handlebars.compile(o("#reopen-bubble-view-4").html()),removeComment:function(e,t){var i=this.commentViewMap[e.id];i&&i.remove(),delete this.commentViewMap[e.id]},renderLog:function(t){if(t.get("action")==i.ACTIVITYLOG.REPLY_ADD){var o=this.collection.get(t.get("commentId"));o&&(replyCommentView=new e({model:o}),this.commentViewMap[o.id]=replyCommentView,this.$el.append(replyCommentView.render().$el))}else t.get("action")==i.ACTIVITYLOG.RESOLVE?this.$el.append(this.resolveTpl(t.attributes)):t.get("action")==i.ACTIVITYLOG.REOPEN&&this.$el.append(this.reopenTpl(t.attributes))},render:function(){var e=this;return this.$el.empty(),this.activityLog.each(function(t){e.renderLog(t)}),this}});return r}(ReplyCommentBubbleView,Backbone,CommentModels,jQuery),CommentView=function(e,t,i,o){var r=t.View.extend({tagName:"div",events:{mouseover:"showOnMouseOver",mouseout:"hideOnMouseOut","click .ui-ncmt-container":"initFocus","click #comment-reply-add":"addReply","click #comment-reply-cancel":"cancelReply","keydown #comment-reply-textarea":"listenForKeyBoardShortcuts","input #comment-reply-textarea":"autoHeightTextArea","click #comment-menudropdown-handle":"displayMenu","click #comment-menuoption-edit":"initEditMode","click #comment-edit-btn":"edit","click #comment-edit-cancel-btn":"cancelEditMode","click #comment-menuoption-resolve":"initResolve","click #comment-menuoption-reopen":"initReopen","click #comment-menuoption-delete":"showDeleteConfirmation","click #comment-menuoption-markunread":"markAsUnread","click #comment-delete-cancel":"hideDeleteConfirmation","click #comment-delete-confirm":"initDelete","input #comment-edit-textarea":"autoHeightTextArea","keydown #comment-edit-textarea":"listenForKeyBoardShortcuts","click #comment-expand-btn":"expandCommentContent","click #comment-shrink-btn":"shrinkCommentContent","click #hide-replies-btn":"hideReplies","click #show-replies-btn":"showReplies","click #reply-comment-trigger-btn":"showReplyTextArea","click #new-reply-view":"stopPropagation","keyup #comment-reply-textarea":"showReplyActions","blur #comment-reply-textarea":"hideReplyActions","click #comment-menuoption-link":function(e){Utils.addToStatistics("comment_showLink"),this.showLink(e)},"click #comment-time":function(e){Utils.addToStatistics("comment_clickedOnTime"),this.showLink(e)},"focus #comment-edit-textarea":function(e){EventHandler.isDialogOpened=!0},"focusout #comment-edit-textarea":function(e){EventHandler.isDialogOpened=!1},"focus #comment-reply-textarea":function(e){EventHandler.isDialogOpened=!0},"focusout #comment-reply-textarea":function(e){EventHandler.isDialogOpened=!1}},initialize:function(t){this.replyCommentCollection=this.model.get("children"),this.replyCommentCollectionView=new e({collection:this.replyCommentCollection,parentComment:this.model}),this.likeView=new LikeView({model:this.model}),this.followView=new FollowView({model:this.model}),this.listenTo(this.model,"change:inFocus",this.focusComment),this.listenTo(this.model.get("activityLog"),"add",this.displayReplyListToggle),this.listenTo(this.model.get("activityLog"),"add remove",this.updateCountsInReplyListToggle),this.listenTo(this.model.get("children"),"remove",this.hideReplyListToggle),this.listenTo(this.model,"change:inDisplay",this.setVisibility),this.listenTo(this.model,"change:isShowingMenu",this.setMenuVisibility),this.listenTo(this.model,"change:inEditingMode",this.setEditMode),this.listenTo(this.model,"change:text",this.updateCommentContent),this.listenTo(this.model,"change:isResolved",this.updateResolvedStateUI),this.listenTo(this.model,"change:unread",this.updateUnreadStateUI),this.listenTo(this.model,"change:isRangeCharsRendered",this.setVisibility);var i=this;J("body").click(function(e){i.model.set("isShowingMenu",!1)})},commentTpl:Handlebars.compile(o("#comment-view-4").html()),listenForKeyBoardShortcuts:function(e){this.$(e.target).hasClass("reply-textarea")?(CommentUtils.doneKey(e,this.addReply,this),CommentUtils.cancelKey(e,this.handleEscKey.bind(this,e),this)):(CommentUtils.doneKey(e,this.edit,this),CommentUtils.cancelKey(e,this.cancelEditMode,this))},handleEscKey:function(e){var t=this.$(e.target);return t.val().trim()?(e.stopPropagation(),!1):void this.cancelReply()},initResolve:function(e){this.model.resolve(!0),Utils.addToStatistics("comment_resolve"),this.showReplies(),this.stopPropagation(e)},showLink:function(){BookmarkDialog.showLink(this.model.id),Utils.addToStatistics("comment_showlink")},hideLink:function(e){this.$("#link-display-popup").hide()},initReopen:function(e){this.model.reopen(!0),Utils.addToStatistics("comment_reopen"),this.showReplies(),this.stopPropagation(e)},initEditMode:function(e){this.model.set("inEditingMode",!0),Utils.addToStatistics("comment_edit")},cancelEditMode:function(){this.model.set("inEditingMode",!1)},setEditMode:function(e,t,i){if(t){e.get("children").each(function(e){e.set("inEditingMode",!1)}),this.$("#parent-text-container").hide(),this.$(".parent-edit-cont").show();var o=this.model.get("text");this.$("#comment-edit-textarea").val(o),CommentUtils.updateTextAreaHeight(this.$("#comment-edit-textarea")[0]),this.$(".ui-toggle-comment-height").hide(),this.$("#comment-edit-textarea").trigger("focus")}else this.$("#parent-text-container").show(),this.$(".parent-edit-cont").hide()},edit:function(){var e=CommentUtils.removeInvalidChars(this.$("#comment-edit-textarea").val());return""!=e.trim()&&e!=this.model.text&&(this.model.set("inEditingMode",!1),void this.model.edit(e,!0))},updateCommentContent:function(e,t,i){this.$("#parent-text-container").html(CommentUtils.getMarkedupCommentContent(CommentUtils.escapeHTML(t))),this.ellipsizeCommentContent()},updateResolvedStateUI:function(e,t,i){t?(this.$("#comment-menuoption-resolve").hide(),this.$("#comment-menuoption-reopen").show(),this.$(".parent-comnt-options").hide(),this.$("#resolve-mark").show(),CommentUtils.resolveHighlights(e.id),this.hideReplies()):(this.$("#comment-menuoption-resolve").show(),this.$("#comment-menuoption-reopen").hide(),this.$(".parent-comnt-options").show(),this.$("#resolve-mark").hide(),CommentUtils.unresolveHighlights(e.id),this.showReplies())},showDeleteConfirmation:function(){this.$(".ui-delete-comment-child").hide(),this.$(".ui-delete-comment-parent").show()},hideDeleteConfirmation:function(){this.$(".ui-delete-comment-child").hide(),this.$(".ui-delete-comment-parent").hide(),EditorUtil.focusMultiByteSpan()},initDelete:function(e){var t=this;this.$el.slideUp(200,function(){t.model.collection.removeComment(t.model,!0),CommentUtils.removeFocusLine()}),Utils.addToStatistics("comment_delete"),EditorUtil.focusMultiByteSpan()},initFocus:function(e){if(this.model.get("inFocus")){var t=this,i=CommentUtils.pullCommentedDoctextIntoView(t.model.id);i&&i.promise().then(function(){CommentUtils.drawFocusLine(t.model.id)})}this.model.set("focusedFrom","commentpane"),this.model.set("inFocus",!0),this.model.set("isShowingMenu",!1)},focusComment:function(e,t,i){t?(this.highlight(),!editor.isOffline()&&!this.model.get("isResolved")&&this.showReplyTextArea(),this.model.read(editor.zuid)):(this.deHighlight(),this.$("#comment-reply-textarea").val()||this.hideReplyTextArea())},highlight:function(){this.$(".ui-ncmt-container-div").addClass("ui-ncmt-container-selected")},deHighlight:function(){this.$(".ui-ncmt-container-div").removeClass("ui-ncmt-container-selected")},displayMenu:function(e){this.model.set("isShowingMenu",!0),this.model.read(editor.zuid),this.stopPropagation(e),U.each(CommentModels.commentCollection.getRenderedComments(),function(e){e.id!=this.model.id&&e.set("isShowingMenu",!1)},this)},setMenuVisibility:function(e,t,i){t?(this.$("#parent-menu").show(),this.$("#parent-menudropdown-handle").addClass("ui-comnt-edt-options-active")):(this.$("#parent-menu").hide(),this.$("#parent-menudropdown-handle").removeClass("ui-comnt-edt-options-active"))},stopPropagation:function(e){e&&(e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault())},showOptionsHandle:function(e){editor.isOffline()||!this.model.get("isResolved")&&this.$(".parent-comnt-options").show()},hideOptionsHandle:function(e){editor.isOffline()||!this.model.get("isShowingMenu")&&this.$(".parent-comnt-options").hide()},addReply:function(){var e=CommentUtils.removeInvalidChars(this.$("#comment-reply-textarea").val());if(this.$("#comment-reply-textarea").css("height",""),""==e.trim())return!1;e=e,this.$(".reply-textarea").val("");var t=new Date,o=t.getTime(),r={id:"zw"+Utils.randomString(),createdAt:o,updatedAt:o,zuid:editor.zuid,text:e,html:CommentUtils.getMarkedupCommentContent(e),children:null,parentId:this.model.id,inEditingMode:!1,reads:[editor.zuid]};replyCommentObj=i.CommentCollection.createComment(r);this.model.addReplyComment(replyCommentObj,!0),this.showReplies(),this.$("#new-reply-view").hide(),this.showReplyTextArea(),Utils.addToStatistics("comment_addReply")},cancelReply:function(){this.$("#comment-reply-textarea").css("height",""),this.$("#comment-reply-textarea").val(""),this.$("#comment-reply-textarea").trigger("blur")},displayReplyListToggle:function(e,t,o){U.contains([i.ACTIVITYLOG.REPLY_ADD,i.ACTIVITYLOG.RESOLVE,i.ACTIVITYLOG.REOPEN],e.get("action"))&&this.$("#replylist-display-controller").css("display","inline-block")},hideReplyListToggle:function(e,t,i){this.model.get("children").length||this.$("#replylist-display-controller").css("display","none")},autoHeightTextArea:function(e){CommentUtils.autoHeightTextArea(e)},setVisibility:function(e,t,i){t?this.$el.show():this.$el.hide()},updateUnreadStateUI:function(e,t,i){t?(this.$(".unread-comment-badge").show(),this.$(".ui-ncmt-container").addClass("ui-ncmt-unread-bg"),this.$(".ui-ncmt-container").addClass("ui-comment-unread")):(this.$(".unread-comment-badge").hide(),this.$(".ui-ncmt-container").removeClass("ui-ncmt-unread-bg"),this.$(".ui-ncmt-container").removeClass("ui-comment-unread"))},ellipsizeCommentContent:function(){this.model.get("text").length>400&&this.model.get("text").length-400>50?(this.$(".ui-toggle-comment-height").show(),this.$("#parent-text-container").addClass("commentcontent-shrinked"),this.$("#comment-expand-btn").show(),this.$("#comment-shrink-btn").hide()):(this.$(".ui-toggle-comment-height").hide(),this.$("#parent-text-container").removeClass("commentcontent-shrinked"))},expandCommentContent:function(){return!!this.$("#parent-text-container").hasClass("commentcontent-shrinked")&&(this.$("#parent-text-container").removeClass("commentcontent-shrinked"),this.$("#comment-expand-btn").hide(),this.$("#comment-shrink-btn").show(),void Utils.addToStatistics("comment_expandLongComment"))},shrinkCommentContent:function(){this.$("#parent-text-container").addClass("commentcontent-shrinked"),this.$("#comment-expand-btn").show(),this.$("#comment-shrink-btn").hide(),Utils.addToStatistics("comment_shrinkLongComment")},hideReplies:function(e){this.$("#reply-list-container").hide(),this.$("#show-replies-btn").css("display","inline-block"),this.$("#hide-replies-btn").hide(),!this.model.get("isResolved"),e||this.stopPropagation(e),e&&Utils.addToStatistics("comment_hideReplies")},showReplies:function(e){this.getChildViewsLength()&&(this.$("#reply-list-container").show(),!this.model.get("isResolved")&&this.showReplyTextArea(),this.$("#show-replies-btn").hide(),this.$("#hide-replies-btn").css("display","inline-block"),e||this.stopPropagation(e),e&&Utils.addToStatistics("comment_showReplies"))},showReplyTextArea:function(e){this.$("#new-reply-view").slideDown(200,function(){}),this.stopPropagation(e)},hideReplyTextArea:function(){this.$("#new-reply-view").slideUp(200)},getChildViewsLength:function(){var e=this.model.get("children").length,t=this.model.get("activityLog").filter(function(e){return e.get("action")==i.ACTIVITYLOG.RESOLVE||e.get("action")==i.ACTIVITYLOG.REOPEN}).length;return e+t},updateCountsInReplyListToggle:function(){var e=1==this.getChildViewsLength()?"Reply":"Replies";this.$("#show-replies-btn").html(this.getChildViewsLength()+" "+e)},showOnMouseOver:function(){this.$(".ui-ncmt-parent").find(".show-on-hover").show()},hideOnMouseOut:function(){!this.model.get("isShowingMenu")&&this.$(".ui-ncmt-parent").find(".show-on-hover").hide()},showReplyActions:function(e){this.$("#comment-reply-textarea").val().trim()&&this.$("#reply-actions").show()},hideReplyActions:function(e){this.$("#comment-reply-textarea").val().trim()||this.$("#reply-actions").hide()},showFollowToast:function(){var e=this;this.$("#follow-toast").slideDown(100,function(){setTimeout(function(){e.$("#follow-toast").slideUp(500)},2e3)})},markAsUnread:function(e){this.model.unread(editor.zuid),this.stopPropagation(e),this.model.set("isShowingMenu",!1)},canShowOptions:function(){return editor.zuid===this.model.get("zuid")||"OWNER"===editor.doc.getRole()||"COOWNER"===editor.doc.getRole()||editor.doc.getDocInfo().CREATOR_ZUID===editor.zuid||window.RemoteEditor&&"true"===RemoteEditor.options.isCommentAdmin},render:function(){var e=this.model.attributes;e.canShowOptions=this.canShowOptions(),e.canShowEditOption=editor.zuid===e.zuid,e.currentUserZuid=editor.zuid,e.isNotRemote="REMOTE"!=editor.getEditorType();var t=["ANYONELINK_SHAREDREADCOMMENT","ANYONELINK_SHAREDREADWRITE","REMOTEEDIT","REMOTECOLLABEDIT","STOREAGE_SERVICE_WRITER","REMOTEPUBLICUSER"];return e.isFollowAllowed=!U.contains(t,editor.doc.getRole()),e.colorCode=ReviewUtil.getUserColour(e.zuid),e.currentUserColorCode=ReviewUtil.getUserColour(editor.zuid),e.childrenLen=this.getChildViewsLength(),e.isMultipleChildren=e.childrenLen>1,this.$el.html(this.commentTpl(e)),this.$("#reply-list-container").html(this.replyCommentCollectionView.render().$el),this.$("#like-container").html(this.likeView.render().$el),this.$("#follow-container").html(this.followView.render().$el),this.ellipsizeCommentContent(),this.$(".enable-atmentions").atMention({commentId:this.model.id}),this.showReplies(),this.delegateEvents(),CommentUtils.initComponents(this.$el),editor.isOffline()&&CommentManager.enableOfflineMode(),this.hideOnMouseOut(),this}});return r}(ReplyCommentCollectionView,Backbone,CommentModels,jQuery),CommentBubbleView=function(e,t,i,o){var r=t.View.extend({tagName:"div",events:{click:"stopPropagation","click .ui-ncmt-container":"initFocus","click #comment-menuoption-edit":"initEditMode","click #comment-edit-btn":"edit","click #comment-edit-cancel-btn":"cancelEditMode","input #comment-edit-textarea":"autoHeightTextArea","keydown #comment-edit-textarea":"listenForKeyBoardShortcuts","click #comment-reply-add":"addReply","click #comment-reply-cancel":"cancelReply","keydown #comment-reply-textarea":"listenForKeyBoardShortcuts","input #comment-reply-textarea":"autoHeightTextArea","click #comment-menudropdown-handle":"displayMenu","click #comment-menuoption-resolve":"initResolve","click #comment-menuoption-reopen":"initReopen","click #comment-menuoption-delete":"showDeleteConfirmation","click #comment-menuoption-markunread":"markAsUnread","click #comment-delete-cancel":"hideDeleteConfirmation","click #comment-delete-confirm":"initDelete","click #comment-expand-btn":"expandCommentContent","click #comment-shrink-btn":"shrinkCommentContent","click #hide-replies-btn":"hideReplies","click #show-replies-btn":"showReplies","click #reply-comment-trigger-btn":"showReplyTextArea","click #new-reply-view":"stopPropagation","keyup #comment-reply-textarea":"showReplyActions","blur #comment-reply-textarea":"hideReplyActions","click #comment-menuoption-link":function(e){Utils.addToStatistics("comment_showLink"),this.showLink(e)},"click #comment-time":function(e){Utils.addToStatistics("comment_clickedOnTime"),this.showLink(e)},"focus #comment-edit-textarea":function(e){EventHandler.isDialogOpened=!0},"focusout #comment-edit-textarea":function(e){EventHandler.isDialogOpened=!1},"focus #comment-reply-textarea":function(e){EventHandler.isDialogOpened=!0},"focusout #comment-reply-textarea":function(e){EventHandler.isDialogOpened=!1}},initialize:function(e){this.replyCommentCollection=this.model.get("children"),this.replyCommentCollectionView=new ReplyCommentCollectionBubbleView({collection:this.replyCommentCollection,parentComment:this.model}),this.likeView=new LikeView({model:this.model}),this.followView=new FollowView({model:this.model});var t=this;PubSub.subscribe("Document/ModeOpened",function(e){e!=LAYOUTS.COMPOSE&&t.hideBubble()}),J("body").click(function(e){var i=J(e.target);i.parents("#editorpane-container").length||i.parents(".-sew-list-container").length||!U.contains([LAYOUTS.COMPOSE,LAYOUTS.COMPLETE],LayoutManager.getCurrentLayout())||t.model.set("inFocus",!1),t.model.set("isShowingMenu",!1)}),PubSub.subscribe("Document/ViewChanged",t.hideBubble),this.listenTo(this.model,"change:inFocus",this.toggleBubble),this.listenTo(this.model,"change:isResolved",this.updateResolvedStateUI),this.listenTo(this.model.get("activityLog"),"add",this.displayReplyListToggle),this.listenTo(this.model.get("children"),"remove",this.hideReplyListToggle),this.listenTo(this.model,"change:inDisplay",this.setVisibility),this.listenTo(this.model,"change:isShowingMenu",this.setMenuVisibility),this.listenTo(this.model,"change:inEditingMode",this.setEditMode),this.listenTo(this.model,"change:text",this.updateCommentContent),this.listenTo(this.model,"change:unread",this.updateUnreadStateUI),this.listenTo(this.model,"change:isRangeCharsRendered",this.setVisibility)},commentTpl:Handlebars.compile(o("#comment-bubble-view-4").html()),initFocus:function(){this.model.set("isShowingMenu",!1)},initResolve:function(e){this.model.resolve(!0),Utils.addToStatistics("comment_resolve"),this.showReplies(),this.stopPropagation(e)},showLink:function(){BookmarkDialog.showLink(this.model.id),Utils.addToStatistics("comment_showlink")},hideLink:function(e){this.$("#link-display-popup").hide()},initReopen:function(e){this.model.reopen(!0),Utils.addToStatistics("comment_reopen"),this.showReplies(),this.stopPropagation(e)},addReply:function(){var e=CommentUtils.removeInvalidChars(this.$("#comment-reply-textarea").val());if(this.$("#comment-reply-textarea").css("height",""),""==e.trim())return!1;e=e,this.$(".reply-textarea").val("");var t=new Date,o=t.getTime(),r={id:"zw"+Utils.randomString(),createdAt:o,updatedAt:o,zuid:editor.zuid,text:e,html:CommentUtils.getMarkedupCommentContent(e),children:null,parentId:this.model.id,inEditingMode:!1,reads:[editor.zuid]};replyCommentObj=i.CommentCollection.createComment(r);this.model.addReplyComment(replyCommentObj,!0),this.showReplies(),this.$("#new-reply-view").hide(),this.showReplyTextArea(),Utils.addToStatistics("comment_addReply")},cancelReply:function(){this.$("#comment-reply-textarea").css("height",""),this.$("#comment-reply-textarea").val(""),this.$("#comment-reply-textarea").trigger("blur")},showDeleteConfirmation:function(){this.$(".ui-delete-comment-child").hide(),this.$(".ui-delete-comment-parent").show()},hideDeleteConfirmation:function(){this.$(".ui-delete-comment-child").hide(),this.$(".ui-delete-comment-parent").hide(),EditorUtil.focusMultiByteSpan()},toggleBubble:function(e,t){t&&"editor"==e.get("focusedFrom")&&!U.contains([LAYOUTS.COLLABORATE,LAYOUTS.READCOMMENT],LayoutManager.getCurrentLayout())?this.showBubble():this.hideBubble()},positionCommentBubble:function(e){var t=e.offset().left+e.width()+10;if(t>J(document).width()){var i=t-J(document).width(),o=editor.doc.getDomCursorNode(editor.uuid,editor.zuid);o&&e.css({left:e.position().left-(i+20),top:CurUtil.offset.start.top+J(o).height()})}},showBubble:function(){if(ModeManager.getCurrentMode()==EDITOR_MODES.COLLABORATE)return!1;ReviewUtil.setHasComment(!0);var e=ReviewUtil.calculatePostionForTcCommentContainer();Z("popup-menu-tc-proof-cmnt-container").css({left:e.left,top:e.top}),this.$el.find(".dynamic-time").each(function(e,t){Jelm=J(t),Jelm.text(Utils.getTimeFromNow(parseInt(Jelm.attr("data-dynamic-time"))))}),this.$el.appendTo(Z("popup-menu-cmnt-container")).fadeIn(200),ReviewUtil.adjustPositionOfTcCommentContainer(),ReviewUtil.updateTime([this.$el])},hideBubble:function(){if(!this.$el)return!1;this.$el.fadeOut(200);var e=this;setTimeout(function(){e.$el.detach()},200),ReviewUtil.setHasComment(!1)},initEditMode:function(e){this.model.set("inEditingMode",!0),Utils.addToStatistics("comment_edit")},initDelete:function(e){var t=this;this.$el.slideUp(200,function(){t.model.collection.removeComment(t.model,!0)}),Utils.addToStatistics("comment_delete"),EditorUtil.focusMultiByteSpan()},cancelEditMode:function(){this.model.set("inEditingMode",!1)},setEditMode:function(e,t,i){if(t){this.$("#parent-text-container").hide(),this.$(".parent-edit-cont").show();var o=this.model.get("text");this.$("#comment-edit-textarea").val(o),CommentUtils.updateTextAreaHeight(this.$("#comment-edit-textarea")[0]),this.$(".ui-toggle-comment-height").hide(),this.$("#comment-edit-textarea").trigger("focus")}else this.$("#parent-text-container").show(),this.$(".parent-edit-cont").hide()},edit:function(){var e=CommentUtils.removeInvalidChars(this.$("#comment-edit-textarea").val());return""!=e.trim()&&e!=this.model.text&&(this.model.set("inEditingMode",!1),void this.model.edit(e,!0))},updateResolvedStateUI:function(e,t,i){t?(this.$("#comment-menuoption-resolve").hide(),this.$("#comment-menuoption-reopen").show(),this.$(".parent-comnt-options").hide(),this.$("#resolve-mark").show(),this.hideReplyTextArea()):(this.$("#comment-menuoption-resolve").show(),this.$("#comment-menuoption-reopen").hide(),this.$(".parent-comnt-options").show(),this.$("#resolve-mark").hide(),this.showReplyTextArea())},autoHeightTextArea:function(e){CommentUtils.autoHeightTextArea(e)},listenForKeyBoardShortcuts:function(e){this.$(e.target).hasClass("reply-textarea")?(CommentUtils.doneKey(e,this.addReply,this),CommentUtils.cancelKey(e,this.handleEscKey.bind(this,e),this)):(CommentUtils.doneKey(e,this.edit,this),CommentUtils.cancelKey(e,this.cancelEditMode,this))},handleEscKey:function(e){var t=this.$(e.target);return t.val().trim()?(e.stopPropagation(),!1):void this.cancelReply()},displayReplyListToggle:function(e,t,o){e.get("action")===i.ACTIVITYLOG.REPLY_ADD&&this.$("#replylist-display-controller").show()},hideReplyListToggle:function(e,t,i){this.model.get("children").length||this.$("#replylist-display-controller").hide()},autoHeightTextArea:function(e){CommentUtils.autoHeightTextArea(e)},setVisibility:function(e,t,i){t?this.$el.show():this.$el.hide()},updateUnreadStateUI:function(e,t,i){t?this.$(".ui-ncmt-container").addClass("ui-comment-unread"):this.$(".ui-ncmt-container").removeClass("ui-comment-unread")},hideReplies:function(){this.$("#reply-list-container").hide(),this.$("#show-replies-btn").show(),this.$("#hide-replies-btn").hide()},showReplies:function(){this.$("#reply-list-container").show(),this.$("#show-replies-btn").hide(),this.$("#hide-replies-btn").show()},showReplyTextArea:function(){this.$("#reply-comment-trigger-btn").hide(),this.$("#new-reply-view").slideDown(200)},hideReplyTextArea:function(){this.$("#reply-comment-trigger-btn").show(),this.$("#new-reply-view").slideUp(200)},showReplyActions:function(e){this.$("#comment-reply-textarea").val().trim()&&this.$("#reply-actions").show()},hideReplyActions:function(e){this.$("#comment-reply-textarea").val().trim()||this.$("#reply-actions").hide()},stopPropagation:function(e){e.stopPropagation(),e.stopImmediatePropagation()},updateCommentContent:function(e,t,i){this.$("#parent-text-container").html(CommentUtils.getMarkedupCommentContent(CommentUtils.escapeHTML(t)))},displayMenu:function(e){this.model.set("isShowingMenu",!0),this.model.read(editor.zuid),this.stopPropagation(e),U.each(CommentModels.commentCollection.getRenderedComments(),function(e){e.id!=this.model.id&&e.set("isShowingMenu",!1)},this)},setMenuVisibility:function(e,t,i){t?(this.$("#parent-menu").show(),this.$("#parent-menudropdown-handle").addClass("ui-comnt-edt-options-active")):(this.$("#parent-menu").hide(),this.$("#parent-menudropdown-handle").removeClass("ui-comnt-edt-options-active"))},showFollowToast:function(){var e=this;this.$("#follow-toast").slideDown(100,function(){setTimeout(function(){e.$("#follow-toast").slideUp(500)},2e3)})},markAsUnread:function(e){this.model.unread(editor.zuid),this.stopPropagation(e),this.model.set("isShowingMenu",!1)},canShowOptions:function(){return editor.zuid===this.model.get("zuid")||"OWNER"===editor.doc.getRole()||"COOWNER"===editor.doc.getRole()||editor.doc.getDocInfo().CREATOR_ZUID===editor.zuid||window.RemoteEditor&&"true"===RemoteEditor.options.isCommentAdmin},render:function(){var e=this.model.attributes;e.canShowOptions=this.canShowOptions(),e.canShowEditOption=editor.zuid===e.zuid,e.currentUserZuid=editor.zuid,e.isNotRemote="REMOTE"!=editor.getEditorType();var t=["ANYONELINK_SHAREDREADCOMMENT","ANYONELINK_SHAREDREADWRITE","REMOTEEDIT","REMOTECOLLABEDIT","STOREAGE_SERVICE_WRITER","REMOTEPUBLICUSER"];return e.isFollowAllowed=!U.contains(t,editor.doc.getRole()),e.colorCode=ReviewUtil.getUserColour(e.zuid),e.currentUserColorCode=ReviewUtil.getUserColour(editor.zuid),this.$el.html(this.commentTpl(e)),this.$("#reply-list-container").html(this.replyCommentCollectionView.render().$el),this.$("#like-container").html(this.likeView.render().$el),this.$("#follow-container").html(this.followView.render().$el),this.$(".enable-atmentions").atMention({commentId:this.model.id}),editor.isOffline()&&CommentManager.enableOfflineMode(),this.delegateEvents(),CommentUtils.initComponents(this.$el),this.$el.hide(),this}});return r}(ReplyCommentCollectionView,Backbone,CommentModels,jQuery),CommentCollectionView=function(e,t,i,o){var r=t.View.extend({el:"#comment-list-container",listen:function(){this.listenTo(i.commentCollection,"add",this.setIsRangeCharsRendered),this.listenTo(i.commentCollection,"change:isRangeCharsRendered",this.renderComment),this.listenTo(i.commentCollection,"remove",this.removeComment),this.listenTo(i.commentPane,"change:currentView",this.detachCommentDialog),this.listenTo(i.commentPane,"change:currentView",this.render),this.listenTo(i.commentPane,"change:noCommentsToShow",this.setVisibility),this.listenTo(i.commentCollection,"change:isRangeCharsRendered",this.setTextBackground),this.listenTo(i.commentCollection,"reset",this.removeAllViews),this.listenTo(i.commentCollection,"reset",this.render),this.listenTo(i.commentPane,"change:searchQuery",this.render)},initialize:function(e){this.listen(),this.$el.scroll(CommentUtils.removeFocusLine),editor.editorPaneContainer.scroll(CommentUtils.removeFocusLine)},commentViewMap:{},commentBubbleViewMap:{},removeComment:function(e,t){var i=this.commentViewMap[e.id];i&&i.remove(),delete this.commentViewMap[e.id];var o=this.commentBubbleViewMap[e.id];o&&o.remove(),delete this.commentBubbleViewMap[e.id]},removeAllViews:function(e,t){for(id in this.commentViewMap)this.commentViewMap[id]&&this.commentViewMap[id].remove(),delete this.commentViewMap[id];for(id in this.commentBubbleViewMap)this.commentBubbleViewMap[id]&&this.commentBubbleViewMap[id].remove(),delete this.commentBubbleViewMap[id]},injectByOrder:function(t){if(i.commentOrder.indexOf(t.id)==-1)return!1;var r=function(e){var r=i.commentOrder.indexOf(t.id);if(0==r)return null;for(var n=r-1;n>=0;n--){prevCommentId=i.commentOrder[n];var a=e.commentViewMap[prevCommentId];if(a&&o.contains(e.$el[0],a.$el[0]))return e.commentViewMap[prevCommentId]}return null}(this),n=new e({model:t});return r?r.$el.after(n.render().$el):this.$el.prepend(n.render().$el),this.commentViewMap[t.id]=n,!0},renderComment:function(t){if(i.commentPane.attributes.currentView===i.COMMENTVIEWS.ALL)this.commentViewMap[t.id]?t.set("inDisplay",!0):this.injectByOrder(t)&&t.set("inDisplay",!0);else if(i.commentPane.attributes.currentView===i.COMMENTVIEWS.RESOLVED)this.commentViewMap[t.id]||this.injectByOrder(t),t.get("isResolved")?t.set("inDisplay",!0):t.set("inDisplay",!1);else if(i.commentPane.attributes.currentView===i.COMMENTVIEWS.UNRESOLVED)this.commentViewMap[t.id]||this.injectByOrder(t),t.get("isResolved")?t.set("inDisplay",!1):t.set("inDisplay",!0);else if(i.commentPane.attributes.currentView===i.COMMENTVIEWS.BY_DATE)if(this.commentViewMap[t.id])t.set("inDisplay",!0);else{var o=new e({model:t});this.commentViewMap[t.id]=o,this.render()}else if(i.commentPane.attributes.currentView===i.COMMENTVIEWS.BY_AUTHOR)if(this.commentViewMap[t.id])t.set("inDisplay",!0);else{var o=new e({model:t});this.commentViewMap[t.id]=o,this.render()}else if(i.commentPane.attributes.currentView===i.COMMENTVIEWS.UNREAD)if(this.commentViewMap[t.id])t.set("inDisplay",!0);else{var o=new e({model:t});this.commentViewMap[t.id]=o,o.render(),this.render()}CommentManager.views.commentPaneView&&CommentManager.views.commentPaneView.setPosition();var r=new CommentBubbleView({model:t});this.commentBubbleViewMap[t.id]=r,r.render()},setIsRangeCharsRendered:function(e,t){if(i.commentOrder.indexOf(e.id)>-1&&(e.set("isRangeCharsRendered",!0),!CommentManager.highlightMap.comments[e.id])){CommentUtils.getCommentRange(e.id);CommentManager.pushToHighlightQueue(e.id),CommentManager.drawHighlight()}},renderCommentCollection:function(e){var t=this,o=i.commentCollection.getRenderedComments(),r=U.sortBy(o,function(e){return i.commentOrder.indexOf(e.id)});if(e===i.COMMENTVIEWS.UNREAD)var n=r.filter(function(e){return e.get("unread")});else if(e===i.COMMENTVIEWS.RESOLVED)var n=r.filter(function(e){return e.get("isResolved")});else if(e===i.COMMENTVIEWS.UNRESOLVED)var n=r.filter(function(e){return!e.get("isResolved")});else if(e===i.COMMENTVIEWS.ALL)var n=r;if(n.length?i.commentPane.set("noCommentsToShow",!1):i.commentPane.set("noCommentsToShow",!0),i.commentPane.get("searchQuery").trim()){var a=!0;n=n.filter(function(e){return CommentUtils.containsSearchTerm(e)})}U.each(n,function(e){var i=t.commentViewMap[e.id];t.$el.append(i.render().$el),i.delegateEvents(),e.set("inFocus",!1),e.set("inDisplay",!0),a&&i.showReplies()}),a&&CommentUtils.setVisibilityForNoResultsDiv()},renderCommentsByDate:function(){var e=this,t={TODAY:[],YESTERDAY:[],PREV7:[],PREV30:[],EARLIER:[]},o=i.commentCollection.getRenderedComments();U.each(o,function(e){var i=parseInt(e.get("createdAt"));if(isNaN(i))return t.EARLIER.push(e),!0;var o=moment().diff(i,"days");0==o?t.TODAY.push(e):1==o?t.YESTERDAY.push(e):o>1&&o<=7?t.PREV7.push(e):o>7&&o<=30?t.PREV30.push(e):t.EARLIER.push(e)});var r=["TODAY","YESTERDAY","PREV7","PREV30","EARLIER"];U.each(r,function(i){var o=t[i];if(!o.length)return!1;var r=J('<div class="date-container-'+i.toLowerCase()+'"><div class="ui-comment-band">'+i+"</div></div>");U.each(o,function(t){var i=e.commentViewMap[t.id];r.append(i.render().$el),i.delegateEvents(),t.set("inFocus",!1),t.set("inDisplay",!0)}),e.$el.append(r)})},renderCommentsByAuthor:function(){var e=this,t={},o=[],r=i.commentCollection.getRenderedComments();U.each(r,function(e){var i=CommentUtils.getUsername(e.get("zuid"),e.get("zuid"));t[i]||(t[i]=[]),t[i].push(e)});var n=i.commentPane.get("currentAuthorView");if(n){var a=CommentUtils.getUsername(n);for(var l in t)l!=a&&delete t[l]}for(var s in t)o.push(s);o.sort(),U.each(o,function(o){var r=J('<div"><div class="ui-comment-band" style="display:none; text-align: center;border: 1px solid #DADADA;margin-bottom: 10px;text-transform: uppercase;background: #f9f9f9;padding: 5px;color: #000000;margin-left: 10px;">'+o+"</div></div>"),n=t[o];if(i.commentPane.get("searchQuery").trim()){var a=!0;n=n.filter(function(e){return CommentUtils.containsSearchTerm(e)})}U.each(n,function(t){var i=e.commentViewMap[t.id];r.append(i.render().$el),i.delegateEvents(),t.set("inFocus",!1),t.set("inDisplay",!0),a&&i.showReplies()}),e.$el.append(r),a&&CommentUtils.setVisibilityForNoResultsDiv()})},setVisibilityBasedOnActiveSearchQuery:function(e,t){i.commentPane.get("searchQuery").trim()&&(CommentUtils.containsSearchTerm(t)?e.showReplies():t.set("inDisplay",!1),CommentUtils.setVisibilityForNoResultsDiv())},setVisibility:function(e,t,i){t&&this.$el.hide()||this.$el.show()},expandRepliesForAllComments:function(){U.each(U.keys(this.commentViewMap),function(e){var t=this.commentViewMap[e];t.showReplies()},this),Utils.addToStatistics("comment_showAllReplies")},collapseRepliesForAllComments:function(){U.each(U.keys(this.commentViewMap),function(e){var t=this.commentViewMap[e];t.hideReplies()},this),Utils.addToStatistics("comment_hideAllReplies")},detachCommentDialog:function(){CommentManager.views.commentCreationView&&CommentManager.views.commentCreationView.detach()},render:function(){return this.$el.empty(),U.contains([i.COMMENTVIEWS.ALL,i.COMMENTVIEWS.RESOLVED,i.COMMENTVIEWS.UNRESOLVED,i.COMMENTVIEWS.UNREAD],i.commentPane.get("currentView"))?this.renderCommentCollection(i.commentPane.get("currentView")):i.commentPane.get("currentView")===i.COMMENTVIEWS.BY_AUTHOR?this.renderCommentsByAuthor():i.commentPane.get("currentView")===i.COMMENTVIEWS.UNREAD?this.renderUnreadComments():i.commentPane.get("currentView")===i.COMMENTVIEWS.BY_DATE&&this.renderCommentsByDate(),CommentManager.views.commentPaneView&&CommentManager.views.commentPaneView.setPosition(),editor.isOffline()&&CommentManager.enableOfflineMode(),this}});return r}(CommentView,Backbone,CommentModels,jQuery),CommentPaneView=function(e,t,i,o){var r=t.View.extend({el:"#mount-commentpaneview",topbandTpl:Handlebars.compile(o("#commentpane-template-4").html()),events:{"click #commentpane-comment-add":"openNewCommentDialog","click #commentpane-comment-viewoptions":"displayViewOptions","click #commentpane-comment-moreoptions":"displayMoreOptions","click #commentpane-moreoption-print":"printComments","click #commentpane-moreoption-delete":"deleteAllComments","keydown #comments-search-textbox":"listenForKeyboardShortcuts","keyup #comments-search-textbox":"updateSearchQuery","click #commentpane-moreoption-hide":function(e){CommentManager.toggleCommentPaneVisibility(e)},"click #commentpane-viewoption-all":function(e){Utils.addToStatistics("comment_viewAllComments"),this.model.set("currentView",i.COMMENTVIEWS.ALL)},"click #commentpane-viewoption-resolved":function(e){Utils.addToStatistics("comment_viewResolvedComments"),this.model.set("currentView",i.COMMENTVIEWS.RESOLVED)},"click #commentpane-viewoption-unresolved":function(e){Utils.addToStatistics("comment_viewUnresolvedComments"),this.model.set("currentView",i.COMMENTVIEWS.UNRESOLVED)},"click #commentpane-viewoption-author":function(e){Utils.addToStatistics("comment_viewByAuthor"),this.model.set("currentView",i.COMMENTVIEWS.BY_AUTHOR)},"click #commentpane-viewoption-date":function(e){Utils.addToStatistics("comment_viewByTime"),this.model.set("currentView",i.COMMENTVIEWS.BY_DATE)},"click #commentpane-all-comments-link":function(e){this.model.set("currentView",i.COMMENTVIEWS.ALL)},"focus #comments-search-textbox":function(e){EventHandler.isDialogOpened=!0},"focusout #comments-search-textbox":function(e){EventHandler.isDialogOpened=!1},"click #commentpane-viewoption-unread":function(e){Utils.addToStatistics("comment_viewUnread"),this.model.set("currentView",i.COMMENTVIEWS.UNREAD)}},listen:function(){this.listenTo(i.commentCollection,"change:isRangeCharsRendered",this.showCommentPaneIfFirst),this.listenTo(i.commentCollection,"change:isRangeCharsRendered",this.hideCommentPaneIfLast),this.listenTo(i.commentCollection,"change:isRangeCharsRendered",this.updateCount),this.listenTo(i.commentCollection,"change:isRangeCharsRendered",this.updateAuthorList),this.listenTo(i.commentCollection,"change:isResolved",this.updateCount),this.listenTo(i.commentCollection,"change:inFocus",this.focusComment),this.listenTo(i.commentCollection,"remove",this.hideCommentPaneIfLast),this.listenTo(i.commentCollection,"remove",this.updateCount),this.listenTo(i.commentCollection,"reset",this.hideCommentPaneIfLast),this.listenTo(i.commentCollection,"reset",this.updateCount),this.listenTo(this.model,"change:isShowingMoreMenu",this.setMoreMenuVisibility),this.listenTo(this.model,"change:currentView",this.onCurrentViewChange),this.listenTo(this.model,"change:noOfUnreadComments",this.updateUnreadCommentUI),this.listenTo(this.model,"change:freeze",this.updateFreezeStateUI),this.listenTo(this.model,"change:nosAll change:nosResolved change:nosUnresolved change:noOfUnreadComments",this.updateHeaderCounts),this.listenTo(i.authors,"change:count",CommentUtils.updateAuthorListUI),this.listenTo(this.model,"change:isShowingSearchbox",this.updateSearchboxVisibility),this.listenTo(this.model,"change:searchQuery",this.updateNoResultsDiv),this.listenTo(this.model,"change:currentView",this.updateNoResultsDiv),this.listenTo(this.model,"change:isShowingViewMenu",this.setViewMenuVisibility),this.listenTo(this.model,"change:isLoading",this.setLoaderVisibility),this.listenTo(this.model,"change:noCommentsToShow",function(e,t,i){t?(this.$(".no-comments-div-container").show(),this.commentCollectionView.$el.hide()):(this.$(".no-comments-div-container").hide(),this.commentCollectionView.$el.show())})},initialize:function(){this.drawLineTimer=null,this.listen(),this.render();var e=this;J("body").click(function(t){e.model.set("isShowingMoreMenu",!1)}),J("#review_tab").find("#comments-tab-header").bind("mousedown",function(e){J("#review_tab").find("#comments-more-options").show(),CommentModels.commentCollection.getRenderedComments().length&&J("#review_tab").find(".comment-actions-opt").show(),J("#review_tab").find("#changes-more-options-btn").hide()}),J("#review_tab").find("#review-tab-header").bind("mousedown",function(){J("#review_tab").find("#comments-more-options").hide(),J("#review_tab").find("#changes-more-options-btn").show()})},showCommentPaneIfFirst:function(e,t){if(t){if(i.commentPane.get("commentCreationDialogShow"))return!1;this.model.set("noCommentsToShow",!1),this.model.set("show",!0),this.commentCollectionView.$el.show(),J("#review_tab").find(".comment-actions-opt").show()}},hideCommentPaneIfLast:function(e,t){CommentUtils.isAnyCommentRenderedInPane()||(this.model.set("noCommentsToShow",!0),this.model.set("show",!1),J("#review_tab").find(".comment-actions-opt").hide(),this.model.set("isShowingViewMenu",!1))},updateCount:function(e,t,o){var r=i.commentCollection.getRenderedComments().length,n=i.commentCollection.getRenderedComments().filter(function(e){return e.get("isResolved")}).length,a=i.commentCollection.getRenderedComments().filter(function(e){return!e.get("isResolved")}).length;this.model.set("nosAll",r),this.model.set("nosResolved",n),this.model.set("nosUnresolved",a),this.updateAuthorList()},updateAuthorList:function(e,t,o){var r=i.commentCollection.map(function(e){return e.get("zuid")}),n=r.map(function(e){return{id:e,zuid:e,name:CommentUtils.getUsername(e)}});i.authors.reset(n),i.authors.each(function(e){var t=i.commentCollection.getRenderedComments().filter(function(t){return t.get("zuid")==e.get("zuid")}).length;e.set("count",t)})},updateHeaderCounts:function(e){this.$("#count-all").text(this.model.get("nosAll")),this.$("#count-resolved").text(this.model.get("nosResolved")),this.$("#count-unresolved").text(this.model.get("nosUnresolved")),this.$("#count-unread, .count-unread").text(this.model.get("noOfUnreadComments")),J("#comment-header-unread-count").text(this.model.get("noOfUnreadComments")),this.model.get("noOfUnreadComments")?(J("#li-review-tab-header").hasClass("ui-state-active")&&J("#comment-header-unread-count").show(),this.$("#count-unread, .count-unread").show(),this.$("#zero-unread-count").hide()):(J("#comment-header-unread-count").hide(),this.$("#count-unread, .count-unread").hide(),this.$("#zero-unread-count").show())},openNewCommentDialog:function(){CommentManager.newComment()},focusComment:function(e,t,i){if(1==t&&e.get("focusedFrom")){this.currentFocusedComment&&this.currentFocusedComment.set("inFocus",!1),this.currentFocusedComment=e;var o=this;if("commentpane"==e.get("focusedFrom")){var r=CommentUtils.getCommentRange(e.id);if(!r)return!1;var n=DocTreeManager.lineAtIndex(r.start);if(!n)return!1;CommentUtils.highlightCommentedDoctext(e.id);var a=CommentUtils.pullCommentedDoctextIntoView(e.id);a&&a.promise().then(function(){CommentUtils.drawFocusLine(e.id)})}else if("editor"==e.get("focusedFrom")){CommentUtils.highlightCommentedDoctext(e.id),clearTimeout(this.drawLineTimer);var a=CommentUtils.pullCommentIntoView(e.id);("SHAREDREADCOMMENT"===editor.doc.getRole()||ModeManager.getCurrentMode()===EDITOR_MODES.COLLABORATE&&J("#li-comments-tab-header").hasClass("ui-state-active"))&&a&&a.promise().then(function(){o.drawLineTimer=setTimeout(function(){CommentUtils.drawFocusLine(e.id)},10)})}}else this.currentFocusedComment=null,CommentUtils.removeCommentedDoctextHighlight(e.id)},displayViewOptions:function(e){this.model.set("isShowingViewMenu",!0),this.stopPropagation(e),this.model.set("isShowingMoreMenu",!1)},displayMoreOptions:function(e){this.model.set("isShowingMoreMenu",!0),this.stopPropagation(e),this.model.set("isShowingViewMenu",!1)},setMoreMenuVisibility:function(e,t,i){if(t){this.$(".more-menu").show();var o,r,n=this.$(".ui-comments-moreoptions").position();o=n.top+this.$(".ui-comments-moreoptions").height()+10,r=n.left-this.$(".more-menu")[0].offsetWidth+28,this.$(".more-menu").css("top",o).css("left",r)}else this.$(".more-menu").hide()},onCurrentViewChange:function(e,t,o){if(this.$(".ui-comnt-view-topband").text(e.get("VIEW_NAME_MAP")[t]),this.$(".ui-all-comments-link").hide(),this.$(".ui-comnt-none").hide(),i.commentPane.set("commentCreationDialogShow",!1),CommentUtils.removeFocusLine(),t==i.COMMENTVIEWS.RESOLVED){this.$(".ui-all-comments-link").show();var r=i.commentCollection.filter(function(e){return e.get("isResolved")&&e.get("isRangeCharsRendered")});r.length||this.$(".ui-comnt-none").show().html(i.TXT_NO_COMMENTS_TO_DISPLAY.replace("{{type}}","Resolved"))}else if(t==i.COMMENTVIEWS.UNRESOLVED){this.$(".ui-all-comments-link").show();var n=i.commentCollection.filter(function(e){return!e.get("isResolved")&&e.get("isRangeCharsRendered")});n.length||this.$(".ui-comnt-none").show().html(i.TXT_NO_COMMENTS_TO_DISPLAY.replace("{{type}}","Unresolved"))}else if(t===i.COMMENTVIEWS.UNREAD){this.$(".ui-all-comments-link").show();var a=i.commentCollection.filter(function(e){return e.get("unread")&&e.get("isRangeCharsRendered")});a.length||this.$(".ui-comnt-none").show().html(i.TXT_NO_COMMENTS_TO_DISPLAY.replace("{{type}}","Unread"))}switch(this.$("#commentpane-viewoptions-container").find(".active").removeClass("active"),t){case i.COMMENTVIEWS.ALL:this.$("#commentpane-viewoption-all").addClass("active");break;case i.COMMENTVIEWS.RESOLVED:this.$("#commentpane-viewoption-resolved").addClass("active");break;case i.COMMENTVIEWS.UNRESOLVED:this.$("#commentpane-viewoption-unresolved").addClass("active");break;case i.COMMENTVIEWS.BY_DATE:this.$("#commentpane-viewoption-date").addClass("active");break;case i.COMMENTVIEWS.BY_AUTHOR:this.$("#commentpane-viewoption-author").addClass("active");break;case i.COMMENTVIEWS.UNREAD:this.$("#commentpane-viewoption-unread").addClass("active")}this.setPosition()},printComments:function(e){CommentUtils.printComments()},deleteAllComments:function(e){i.commentCollection.removeAllComments(!0),CommentUtils.removeFocusLine()},resolveAllComments:function(e){i.commentCollection.resolveAllComments(!0)},markAllCommentsAsRead:function(e){var t=i.commentCollection.getRenderedComments().filter(function(e){return e.get("unread")}).map(function(e){return e.id});i.commentCollection.read(t,editor.zuid),i.commentCollection.markRead(t)},markAllCommentsAsUnread:function(e){var t=i.commentCollection.getRenderedComments().filter(function(e){return!e.get("unread")}).map(function(e){return e.id});i.commentCollection.unread(t,editor.zuid),i.commentCollection.markUnread(t)},updateUnreadCommentUI:function(e,t,i){t?this.$(".ui-unread-count").show().text(t):this.$(".ui-unread-count").hide()},stopPropagation:function(e){e&&(e.stopPropagation(),e.stopImmediatePropagation())},setPosition:function(){var e=J(window).innerHeight()-(this.$(".ui-viewmenu").offset().top+this.$(".ui-viewmenu").outerHeight())-Utils.getBottombarHeight();this.commentCollectionView.$el.css({height:e+"px"});var e=J(window).innerHeight()-this.$(".no-comments-div-container").offset().top-J("#bottombar").outerHeight();this.$(".no-comments-div-container").css("height",e+"px")},updateFreezeStateUI:function(e,t,i){t?this.$(".comment-freeze-overlay").show():this.$(".comment-freeze-overlay").hide()},initComponents:function(){CommentUtils.initComponents(this.$el)},listenForKeyboardShortcuts:function(e){CommentUtils.cancelKey(e,this.cancelSearch,this)},cancelSearch:function(){this.model.set("isShowingSearchbox",!1),this.model.set("searchQuery",""),this.$("#comments-search-textbox").val(""),this.$("#noresults-container").hide(),CommentUtils.removeFocusLine()},showLoading:function(){},hideLoading:function(){},updateSearchQuery:function(e){var t=this;this.showLoading(),CommentUtils.delay(function(){t.hideLoading();var e=t.$("#comments-search-textbox").val();e.trim().length>2?t.model.set("searchQuery",e):t.model.set("searchQuery","")},1e3)},updateSearchboxVisibility:function(e,t,i){var o=this;t?this.$("#search-container").slideDown(100,function(){o.$("#comments-search-textbox").trigger("focus")}):this.$("#search-container").slideUp(100,function(){o.setPosition()})},updateNoResultsDiv:function(e,t,o){var t=i.commentPane.get("searchQuery");this.$("#noresults-search-term").text(t.trim()),this.$("#noresults-current-view").text(CommentUtils.getViewLabel(i.commentPane.get("currentView"))),t.trim()||this.$("#noresults-container").hide()},setViewMenuVisibility:function(e,t,i){t?this.$("#commentpane-viewoptions-container").slideDown(100):this.$("#commentpane-viewoptions-container").slideUp(100)},setLoaderVisibility:function(e,t,i){t?Z("cmt-loader-img").show():Z("cmt-loader-img").hide()},render:function(){var t=this.model.attributes;return t.canShowDeleteOption="OWNER"===editor.doc.getRole()||"COOWNER"===editor.doc.getRole(),this.$el.html(this.topbandTpl(this.model.attributes)),this.commentCollectionView=new e({collection:i.commentCollection}),this.$(".comment-collection-view-container").html(this.commentCollectionView.render().$el),this.model.get("freeze")&&(this.model.set("freeze",!1),this.model.set("freeze",!0)),this.initComponents(),J("#comment-more-options").hide(),this}});return r}(CommentCollectionView,Backbone,CommentModels,jQuery),CommentToggleView=function(e,t,i){var o=e.View.extend({el:"#commenttoggle",initialize:function(e){this.listenTo(t.commentPane,"change:noOfUnreadComments",this.updateUnreadCommentUI),this.listenTo(t.commentCollection,"change:isRangeCharsRendered",this.showCommentToggleIfFirst),this.listenTo(t.commentCollection,"change:isRangeCharsRendered",this.hideCommentToggleIfLast),this.listenTo(t.commentCollection,"remove",this.hideCommentToggleIfLast),this.listenTo(t.commentCollection,"reset",this.hideCommentToggleIfLast),this.render()},events:{"click #toggler":"toggleCommentPaneVisibility","click .ui-unread-count":"showUnreadComments"},updateUnreadCommentUI:function(e,t,i){t&&!e.get("show")?this.$(".ui-unread-count").show().text(t):this.$(".ui-unread-count").hide()},toggleCommentPaneVisibility:function(e){CommentManager.toggleCommentPaneVisibility(e)},showCommentToggleIfFirst:function(e,t){t&&this.$el.show()},hideCommentToggleIfLast:function(){CommentUtils.isAnyCommentRenderedInPane()||this.$el.hide()},showUnreadComments:function(e){t.commentPane.set("currentView",t.COMMENTVIEWS.UNREAD)},render:function(){return this.$el.hide(),this.delegateEvents(),this}});return o}(Backbone,CommentModels,jQuery);var CommentManager=function(e,t,i){var o={},r=!1,n=[],a=[],l={comments:{},highlights:{},el:{}},s=function(){CommentManager.highlightMap={comments:{},highlights:{},el:{}}},d=function(t){if(!CommentUtils.shouldLoadComments())return!1;var i=[],o=[];for(var r in t){var n=t[r];n=CommentUtils.refineCommentJSON(n),n.deleted||o.push(n)}U.forEach(o,function(t,o){commentObj=e.CommentCollection.createComment(t),i.push(commentObj)}),U.each(i,function(t){e.commentCollection.add(t)})},c=function(e){a.push(e)},p=function(){U.each(a,function(e){var t=CommentUtils.getCommentRange(e),i=DocTreeManager.lineAtIndex(t.start);if(i){Utils.log("\nCalling linesBetween() with start:"+t.start+"  end:"+t.end+"... comment id : "+e);var o=DocTreeManager.doc.linesBetween(t.start,t.end)}else var o=[];U.each(o,function(e){CommentUtils.discardHighlights(e.viewLine);var t=e.start,i=e.end,o=CommentUtils.getHighlightSegments(t,i);U.each(o,function(e){CommentUtils.drawCommentHighlight(e.start,e.end,e.ids)})})}),a=[]},u=function(e,t){var i=t.parent,o=i.getIndex();CommentUtils.discardHighlights(e);var r=o+t.start,n=o+t.end,a=CommentUtils.getHighlightSegments(r,n);U.each(a,function(e){CommentUtils.drawCommentHighlight(e.start,e.end,e.ids)})},f=function(t,i){e.commentIndices=e.commentIndices.filter(function(e){return e.id!=t});var o,r;for(r=i,i=editor.doc.findPreviousIndexOf(UNICODE.RANGE_START,i);i>-1;){var n=editor.doc.getRawFormatAt(i);if(n&&n.type==NODE_TYPE.COMMENT&&n.id==t){o=i;break}i=editor.doc.findPreviousIndexOf(UNICODE.RANGE_START,i)}e.commentIndices.push({id:t,start:o,end:r}),e.commentOrder=CommentModels.commentIndices.sort(function(e,t){return t.start<e.start?1:-1}).map(function(e){return e.id})},g=function(t){var i=e.commentCollection.get(t);i&&i.set({isRangeCharsRendered:!0})},m=function(){CommentUtils.removeFocusLine()},h=function(t){var i,r=o.commentPaneView;if(t===editor.uuid&&editor.isEditable()&&e.updateCommentFocus){var n=e.SHOULD_HIGHLIGHT_RESOLVED_COMMENTS||editor.doc.getSelection().selectionType===SEL_AUTO_GEN;if(i=CommentUtils.enclosingCommentAtIndex(editor.doc.getSelection().getStart(),n),!i)return r.currentFocusedComment&&r.currentFocusedComment.set("inFocus",!1),!1;var a=e.commentCollection.get(i.id);a&&r.currentFocusedComment!=a&&a.get("isRangeCharsRendered")&&(a.get("isResolved")?e.commentPane.set("currentView",e.COMMENTVIEWS.RESOLVED):e.commentPane.set("currentView",e.COMMENTVIEWS.UNRESOLVED),a.set("focusedFrom","editor"),a.set("inFocus",!0))}},T=function(t){var i=e.commentOrder.indexOf(t);i>-1&&e.commentOrder.splice(i,1)},E=function(){o.commentPaneView&&o.commentPaneView.setPosition()},R=function(t){var i=editor.doc.getSelection().createCursorOp(e.cursorSelection.start,e.cursorSelection.end);i=DocOpBuilder.build(i);var o=DocOpBuilder.xform(i,t),r=o.first.getCursorPos()[0];e.cursorSelection.start=r.start>=0?r.start:r.end,e.cursorSelection.end=r.end>=0?r.end:r.start},S=function(){o.commentPaneView||(o.commentPaneView=new t({model:e.commentPane}),o.commentCreationView=new CommentCreationView({model:e.commentPane}),o.commentCollectionView=o.commentPaneView.commentCollectionView);var i=J.Deferred(),r=CommentUtils.chunkArray(e.commentOrder,5),l=function(e,t){setTimeout(function(){s(e,t)},10)},s=function(e,t){for(var o=0;o<e.length;o++){var n=e[o];g(n);var s=CommentUtils.getCommentRange(n);s&&s.start&&s.end&&a.push(n)&&p(n),o==e.length-1&&(r[t+1]?l(r[t+1],t+1):i.resolve())}};r[0]&&s(r[0],0),i.promise().then(function(){U.each(n,function(e){e.func.apply(CommentManager,e.args)})})},O=function(){e.commentPane.get("commentCreationDialogShow")&&e.cursorSelection.start&&e.cursorSelection.end&&CommentUtils.showCurrentCommentSelection(e.cursorSelection.start,e.cursorSelection.end)},v=function(){return Utils.addToStatistics("Comment"),!(editor.isOffline()||!enabled)&&(J.dialogutil.isDialogOpened("findandreplace")&&J.dialogutil.close("findandreplace"),!(editor.clientActiveSection&&editor.clientActiveSection.className.indexOf("zw-contentpane")==-1||"OWNER"!=editor.doc.getRole()&&editor.doc.getSelection().isUnlockAllowed()||editor.doc.getSelection().isListItemSelection)&&(ReviewUtil.switchTab("comments"),e.commentPane.set("currentView",e.COMMENTVIEWS.UNRESOLVED),o.commentPaneView.cancelSearch(),void(e.commentPane.get("commentCreationDialogShow")&&o.commentCreationView.$el.find("#textarea").val().trim()?(o.commentCreationView.$el.find("#textarea").trigger("focus"),O()):e.commentPane.get("commentCreationDialogShow")&&!o.commentCreationView.$el.find("#textarea").val().trim()?e.commentPane.set("commentCreationDialogShow",!1,{then:function(){e.commentPane.set("commentCreationDialogShow",!0)}}):e.commentPane.set("commentCreationDialogShow",!0))))},b=function(){var e=editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart());if(e){var t=editor.doc.createRange(e.getStart(),e.getEnd());editor.doc.getSelection().setSelectionType(SEL_AUTO_GEN).removeAllRanges().addRange(t),v()}},A=function(){e.commentToggle.set("display",!e.commentToggle.get("display")),e.commentPane.set("show",e.commentToggle.get("display"))},y=function(t){T(t),CommentUtils.removeHighlights(t),e.commentIndices=e.commentIndices.filter(function(e){return e.id!=t}),CommentUtils.removeDocNotification(t)},D=function(){CommentModels.queue.ackReceived(),CommentModels.queue.isReqSent=!1,CommentModels.queue.reqCount=0,CommentModels.queue.getPendingToPushEdit()&&ZWCollaboration.msgQueue.isEmpty()&&(CommentModels.queue.shift(),P())},C=function(e){return function(t){"SUCCESS"==t.RESPONSE?(Utils.log("COMMENT OP SUCCEEDED. CHECKING IF SYNC SHOULD BE DONE."),CommentUtils.getSequenceDiff(t.comment_sequence_number)==e.length?(CommentModels.comment_sequence_number=t.comment_sequence_number,D()):CommentUtils.syncup(D),U.each(e,function(e){"addComment"==e.action&&CommentUtils.notifyMentions(e.commentData.text,e.commentData.id),"addReplyComment"==e.action&&CommentUtils.notifyMentions(e.commentData.text,e.commentData.parentId,e.commentData.id),"updateComment"==e.action&&CommentUtils.notifyMentions(e.commentData.text,e.commentData.id),"updateReplyComment"==e.action&&CommentUtils.notifyMentions(e.commentData.text,e.commentData.parentId,e.commentData.id)})):(Utils.log("COMMENT OP FAILED. CHECK SERVER LOGS."),CommentUtils.onErrorCallback({action:"commentop",info:{ops:e,serverResponse:t},errNo:t.ERR_CODE||CommentModels.COMMENT_SERVER_DATA_MISSING_ERROR}))}},I=function(t){return function(i){Utils.log("COMMENT OP FAILED BY REQUEST FAILURE."),CommentUtils.isJSONString(i.responseText)?(Utils.log("COMMENT OP FAILED. CHECK SERVER LOGS."),CommentUtils.onErrorCallback({action:"commentop",info:{ops:t,serverResponse:i},errNo:CommentModels.COMMENT_SERVER_DATA_MISSING_ERROR})):e.queue.reqCount<=e.MAX_RETRY_COUNT?(Utils.log("RESENDING REQUEST. COUNT: ",CommentModels.queue.reqCount+1),P()):CommentUtils.onErrorCallback({action:"commentop",info:{ops:t,serverResp:i},errNo:CommentModels.COMMENT_REQUEST_FAILURE_ERROR})}},P=function(){var t=e.queue.getAckPendingEdit(),i=J.Deferred();if(Utils.log("SEND COMMENT MUTATION CALLED"),Utils.log("COMMENT QUEUE: \n"+JSON.stringify(CommentModels.queue.pendingCommentEdits)),t){e.queue.isReqSent=!0,e.queue.reqCount++;var i=CommentUtils.sendMessage(t,C(t),I(t))}return i},_=function(e,t){if("SUCCESS"===e){Utils.log("Checking if any comment ops need to be sent."),Utils.log("Comment ops in queue: \n"+JSON.stringify(CommentModels.queue.pendingCommentEdits));var i=CommentModels.queue.getAckPendingEdit(),o=CommentModels.queue.getPendingToPushEdit(),r=(ZWCollaboration.msgQueue.getAckPendingEdit(),ZWCollaboration.msgQueue.getPendingToPushEdit());i&&!CommentModels.queue.isReqSent?P():i||!o||r?CommentUtils.getSequenceDiff(t.comment_sequence_number)>0&&CommentUtils.syncup():(CommentModels.queue.shift(),P())}},N="#comments-more-options, .show-on-hover, #new-reply-view, #like-container",L=function(){J(N).addClass("force-hide"),e.commentCollection.each(function(e){if(o.commentCollectionView){o.commentCollectionView.commentViewMap[e.id];e.set("inEditingMode",!1)}}),e.commentPane.set("commentCreationDialogShow",!1)},w=function(){J(N).removeClass("force-hide")},M=function(){ReviewUtil.setFreeze(!0)},x=function(){ReviewUtil.setFreeze(!1),ZWCollaboration.msgQueue.isEmpty()&&P()},F=function(t,i,o){if(!CommentUtils.shouldLoadComments())return!1;try{switch(CommentModels.comment_sequence_number=o,t.action){case"addComment":e.commentCollection.receiveAddCommentFromCollaborators(t.commentData);break;case"deleteComment":if(!e.commentCollection.get(t.commentData.id))return!1;e.commentCollection.receiveDeleteCommentFromCollaborators(t.commentData);break;case"updateComment":var r=e.commentCollection.get(t.commentData.id);if(!r)return!1;r.edit(t.commentData.text,!1,t.commentData.activityId);break;case"resolveComment":var r=e.commentCollection.get(t.commentData.id);if(!r)return!1;r.resolve(!1,i,t.commentData.time,t.commentData.activityId);break;case"reopenComment":var r=e.commentCollection.get(t.commentData.id);if(!r)return!1;r.reopen(!1,i,t.commentData.time,t.commentData.activityId);break;case"addReplyComment":var r=e.commentCollection.get(t.commentData.parentId);if(!r)return!1;r.receiveReplyCommentFromCollaborators(t.commentData);break;case"deleteReplyComment":var r=e.commentCollection.get(t.commentData.parentId);if(!r)return!1;if(!r.get("children").get(t.commentData.id))return!1;r.receiveReplyDeleteFromCollaborators(t.commentData);break;case"updateReplyComment":var r=e.commentCollection.get(t.commentData.parentId);if(!r)return!1;if(!r.get("children").get(t.commentData.id))return!1;r.receiveReplyEditFromCollaborators(t.commentData);break;case"deleteAllComments":e.commentCollection.removeAllComments(!1,t.commentData.activityId);break;case"resolveAllComments":e.commentCollection.resolveAllComments(!1,i,t.commentData.time,t.commentData.activityId);break;case"likeComment":var r=e.commentCollection.get(t.commentData.id);if(!r)return!1;r.like(!1,i,t.commentData.activityId);break;case"likeReplyComment":var r=e.commentCollection.get(t.commentData.parentId);if(!r)return!1;var n=r.get("children").get(t.commentData.id);if(!n)return!1;n.like(!1,i,t.commentData.activityId);break;case"unlikeComment":var r=e.commentCollection.get(t.commentData.id);if(!r)return!1;r.unlike(!1,i,t.commentData.activityId);break;case"unlikeReplyComment":var r=e.commentCollection.get(t.commentData.parentId);if(!r)return!1;var n=r.get("children").get(t.commentData.id);if(!n)return!1;n.unlike(!1,i,t.commentData.activityId)}}catch(i){CommentUtils.onErrorCallback({action:t.action,info:t,errNo:e.COMMENT_COLLABORATION_HANDLING_ERROR,error:i})}},k=function(){return!r&&(r=!0,PubSub.subscribe("Comment/deleted",y),PubSub.subscribe("Comment/RangeEndInserted",function(e,t){U.each(e,function(e){f(e,t)}),a=a.concat(e)}),caretChangeEvents=["DocOperation/CommandComplete","DocOperation/CollabCommandComplete"],U.each(caretChangeEvents,function(t){PubSub.subscribe(t,function(t){e.commentPane.get("commentCreationDialogShow")&&R(t)})}),PubSub.subscribe("Comment/CollaboratorOperationRecieved",function(e,t,i){U.each(e,function(e){F(e,t,i)})}),void PubSub.subscribe("Document/Mutation/SendSuccess",_))},B=function(){PubSub.subscribe("Document/lineview/create",u),PubSub.subscribe("Document/lineview/update",u),PubSub.subscribe("paraview/before/remove",function(e){U.each(e,function(e){U.each(e.lines,function(e){CommentUtils.discardHighlights(e)})})}),PubSub.subscribe("lineview/before/remove",CommentUtils.discardHighlights),PubSub.subscribe("Comment/RangeEndInserted",function(e){U.each(e,g)}),PubSub.subscribe("Document/CursorPositionChanged",m),PubSub.subscribe("Document/CursorPositionChanged",function(e){isFindSelection=J(".overlay.zw-find").length,isFindSelection?o.commentPaneView.currentFocusedComment&&o.commentPaneView.currentFocusedComment.set("inFocus",!1):h(e)}),PubSub.subscribe("Document/Resize",E);var t=["Document/ViewChanged","Document/FullViewHandling","Document/TrackChangeViewHandling","Document/bodyStyleChanged"];U.each(t,function(e){PubSub.subscribe(e,E)}),PubSub.subscribe("DocOperation/CommandComplete",p),PubSub.subscribe("DocOperation/CommandProgress",O),PubSub.subscribe("DocOperation/CommandComplete",O),PubSub.subscribe("Document/ViewChanged",function(){var t=[EDITOR_VIEWS.HISTORY,EDITOR_VIEWS.MAILMERGE_PREVIEW,EDITOR_VIEWS.PRINT_PREVIEW,EDITOR_VIEWS.TEMPLATEI_EDIT,EDITOR_VIEWS.VERSIONVIEW];U.contains(t,editor.getView())?CommentUtils.removeCommentUI():e.commentPane.set("show",!0)}),PubSub.subscribe("Document/bodyStyleChanged",E),PubSub.subscribe("Document/TrackChangeViewHandling",function(t){var t=editor.doc.getTrackChangeDetails().getIsReviewPage();t?CommentUtils.removeCommentUI():e.commentPane.set("show",!0)}),PubSub.subscribe("Comment/HideCommentUI",CommentUtils.removeCommentUI),PubSub.subscribe("Document/ModeOpened",function(){o.commentPaneView&&o.commentPaneView.setPosition(),CommentUtils.removeFocusLine(),e.commentPane.get("commentCreationDialogShow")&&(CommentUtils.positionCommentDialog(),o.commentCreationView.focus())}),PubSub.subscribe("UiEvents/EditorParentOffsetChanged",function(){CommentUtils.removeFocusLine()}),PubSub.subscribe("Document/FinalStateUpdated",function(e){e.STATUS?CommentUtils.hideAllHighlights():CommentUtils.showAllHighlights()}),PubSub.subscribe("WMS/ServerUp",x),PubSub.subscribe("WMS/ServerDown",M)},H=function(){return e.commentPane.get("show")},G=function(){return e.commentPane.get("commentCreationDialogShow")},z=function(t){return void 0!=e.commentCollection.get(t)},V=function(t){return e.commentCollection.get(t)},Y=function(){e.commentPane.set("commentCreationDialogShow",!1)},W=function(){e.reset(),s()},j=function(){var t=e.commentCollection.json(),i={};return U.each(t,function(e){var t={};U.each(e.children,function(e){t[e.id]=e}),e.children=t,e.isRangeCharsRendered=!1,e.inDisplay=!1,e.inFocus=!1,i[e.id]=e}),i},Z=function(e,t){n.push({func:e,args:t})},X=function(){var t=e.SHOULD_HIGHLIGHT_RESOLVED_COMMENTS||editor.subAction&&editor.subAction.comments;if(id=CommentUtils.enclosingCommentAtIndex(editor.doc.getSelection().getStart(),t),id&&e.commentCollection.get(id)){var i=e.commentCollection.get(id);i.get("isResolved")?e.commentPane.set("currentView",e.COMMENTVIEWS.RESOLVED):e.commentPane.set("currentView",e.COMMENTVIEWS.UNRESOLVED),i.set("focusedFrom","editor").set("inFocus",!0)}},K=function(){var e=["OWNER","COOWNER"];U.contains(e,editor.doc.getRole())||J("#resolve-all-menu-opt,#delete-all-menu-opt").hide()},$=function(){CommentManager.afterInit(E),CommentManager.afterInit(X),CommentManager.afterInit(K),CommentManager.afterInit(function(){e.commentPane.set("isLoading",!1)}),S(),B()},q=function(){if(e.commentPane.get("commentCreationDialogShow")&&o.commentCreationView.$el.find("#textarea").val().trim())return!0;var t=U.map(o.commentCollectionView.commentViewMap,function(e){return e}).concat(U.map(o.commentCollectionView.commentBubbleViewMap,function(e){return e})),i=t.filter(function(e){return e.$el.find("#comment-reply-textarea").val().trim()});return!!i.length},Q=function(t){e.commentPane.set("isLoading",!0),CommentModels.commentCollection.reset(),CommentModels.comment_sequence_number=t.comment_sequence_number,CommentManager.views.commentPaneView.stopListening(),CommentManager.views.commentCollectionView.stopListening(),CommentManager.loadModels(t.comments),CommentManager.views.commentPaneView.listen(),CommentManager.views.commentCollectionView.listen(),CommentManager.renderCommentPane()},ee=function(){enabled=!0,CommentUtils.loadCommentIndices(function(){d(editor.commentCont),k(),editor.isOffline()||Utils.isNonEditableView()||CommentUtils.loadContacts()}),e.SHOULD_HIGHLIGHT_RESOLVED_COMMENTS=CommentUtils.shouldHighlightResolved()};return PubSub.subscribe("Document/EditorReady",ee),{commentOrder:e.commentOrder,commentCollection:e.commentCollection,commentPane:e.commentPane,views:o,newComment:v,addCommentOnImg:b,toggleCommentPaneVisibility:A,EMAIL_REGEX:e.EMAIL_REGEX,loadModels:d,renderComment:g,renderCommentPane:S,createCommentObj:e.CommentCollection.createComment,getCommentObj:V,isCommentPaneInDisplay:H,isCommentCreationDialogInDisplay:G,isCommentExist:z,closeCommentCreationDialog:Y,reset:W,enableOfflineMode:L,disableOfflineMode:w,handleCollaboratorOperation:F,constructCommentsJSON:j,afterInit:Z,initViews:$,sendCommentMutation:P,isUnposted:q,reload:Q,highlightMap:l,pushToHighlightQueue:c,drawHighlight:p}}(CommentModels,CommentPaneView,CommentToggleView);!function(e,t,i){function o(o,r){this.textarea=o,this.$textarea=t(o);var n=r.commentId||this.$textarea.parent(".ui-ncmt-container").attr("cid");if(!U.contains(e.atMention.validRoles,editor.doc.getRole()))return e.atMention.enabled=!1,!1;var a=6,l='<div class="-sew-item-container"><div style="height:30px;width:30px;float:left;height:30px;width:30px;float:left;margin-right: 10px;margin-left: 10px;margin-top: 10px;" class="-sew-item-icon"><img style="border-radius: 100%;height:35px;width:35px;border:1px solid #e0e0e0;" id="contact-img" title=""></div><div class="-sew-item-text" style="float:left;padding:3px;"><div style="" class="-sew-item-fullname"><a style="white-space:nowrap;" class="ui-corner-all" tabindex="-1"><span class="-full-name"></span></a></div><div class="-sew-item-email"><span class="graytxt">&nbsp;</span></div></div></div>',s='<ul class="ui-autocomplete ui-menu ui-widget ui-widget-content ui-corner-all zdc_shareautocompletedialog -sew-list-container -sew-list" role="listbox" aria-activedescendant="ui-active-menuitem" style="display: none; position: fixed;width:350px;"></ul>',d='<li class="ui-menu-item -sew-list-item" role="menuitem"></li>',c=function(e,t){JcustomItemTemplate=J(l),JcustomItemTemplate.find(".-full-name").text(t.fullname),JcustomItemTemplate.find(".graytxt").text("<"+t.emailid+">"),JcustomItemTemplate.find("#contact-img").attr("src",Utils.getUserImageURL(t.zuid)),e.append(JcustomItemTemplate)},p=function(e,t){var o=CommentUtils.getMentionedPeople(t),r=[],n=[];U.each(e,function(e){i.contains(o,e.emailid)?r.push(e):n.push(e)});var n=n.sort(function(e,t){return"shared"===t.usertype}).sort(function(e,t){return"personal"===t.usertype&&"shared"!=e.usertype});return r.concat(n)},u=function(e,t){var i=e.values,o=e.query;if(""===o)return t([]);var r=i.filter(function(e,t){return!(!e.emailid&&!e.fullname)&&(e.fullname.toLowerCase().startsWith(o.toLowerCase())||e.emailid.toLowerCase().startsWith(o.toLowerCase()))});if(r.length>=a)return t(p(r,this.extras.commentId));var n=a-r.length,l=this;Contacts.searchContacts({queryStr:o,limit:n,success:function(e){var e=U.map(e.contactsList,function(e){var t={};return t.emailid=e.email,t.fullname=e.fullName,t.val=e.email,t.zuid=e.zuid,t.usertype="org",t});CommentModels.atMention.add(e),e=e.filter(function(e){for(var t=!0,i=0;i<r.length;i++){var o=r[i];if(o.emailid===e.emailid){t=!1;break}}return t}),t(p(e.concat(r),l.extras.commentId))}})},f=function(e,t){var i=(t.offset().top,J(".comnt-stack-view-container").scrollTop(),function(){var i=e.offset(),o=e.getCaretPosition();t.detach().appendTo("body"),t.css({left:i.left+o.left,top:i.top+o.top}),t.css("left",4+i.left+"px"),t.css("top",parseInt(t.css("top"))+13+"px"),t.removeClass("shadow-top"),t.addClass("shadow-bottom");var r=parseInt(t.css("top"));if(heightOfSuggestionBox=t.outerHeight(),r>400){var n=r-heightOfSuggestionBox-33;t.css("top",n),t.removeClass("shadow-bottom"),t.addClass("shadow-top")}});i(),J(".comnt-stack-view-container").data("atmentionScrollHandlerAttached")||J(".comnt-stack-view-container").data("atmentionScrollHandlerAttached",!0).bind("scroll",function(e){t.is(":visible")&&i()})},g=function(t){e.atMention.isShowing=!0,t.is(":visible")||t.fadeIn(200)},m=function(t){e.atMention.isShowing=!1,t.is(":visible")&&t.fadeOut(200)},h=CommentUtils.getContacts();this.$textarea.sew({values:h,elementFactory:c,filterFn:u,menuTemplate:s,listItemTemplate:d,maxNoOfSuggestions:a,renderCallback:f,show:g,hide:m,extras:{commentId:n}}),this.$textarea.on("mention-selected",function(e,t){J(e.target).trigger("input"),CommentUtils.showHint(e)}),this.$textarea.on("blur",function(e){CommentUtils.hideHint(e)})}var r="atMention";t.fn[r]=function(e){return this.each(function(){t.data(this,"plugin_"+r)||t.data(this,"plugin_"+r,new o(this,e||{}))})}}(CommentModels,jQuery,U);var TrackChangeUI=new function(){this.currentRevision=-1,this.allRevisionDetails=[],this.totalChanges=0,this.noOfAdded=0,this.noOfDeleted=0,this.reviewFilter=TCConstants.ALL,this.authorFilterId=void 0,this.constructReviewPaneTimer,this.JtrianlgeDiv=void 0,this.JhorizontalDiv=void 0,this.JangularDiv=void 0,this.imageBorderWid=2,this.isTooltipVisible=!1,this.tooltipLeft=60,this.tooltipPeakHeight=10};TrackChangeUI.initDOMElements=function(){this.JallRevisionsListDiv=J("#reviewpane"),this.JemptyReviewpane=J("#empty_reviewpane"),this.JloadingReviewpane=J("#loading_reviewpane"),this.allRevisionsListDiv=document.getElementById("reviewpane"),this.reviewToolbar=J("#review-tb"),this.reviewTab=J("#review_toolbar"),this.markup=this.reviewToolbar.find("#review-tb-tcallmarkup"),this.reviewRightPane=J("#review_Rightpane"),this.bottombar=J("#bottombar"),this.reviewAuthorList=this.reviewRightPane.find("#review-author-list"),this.tcStatusSwitch=J(".js-trackchange-switch"),this.changemode=J("#topband-modes"),this.fileMenu=J("#topband-file"),this.customBannerDiv=J("#banner-temp-offline-cont"),this.mainOuterDiv=J("#mainOuterDiv"),this.tcUsersListContainer=J("#tcUsersListContainer"),this.reviewCountContainer=J("#bbar-tc-review-count"),this.otherButtonsInReviewTab=[this.markup]},TrackChangeUI.initUI=function(){TrackChangeUI.drawTCStatus(),TrackChangeUI.updateReviewCountInBottomBar()},TrackChangeUI.toggleState=function(){var e=editor.doc.getTrackChangeDetails(),t=e.isEnabled(),i=(editor.doc.getDocInfo(),editor.doc.getBodyFormat());if(t=!t,e.isOwner()){var o={};o[ATTR_BODY.TC_ISENABLED]=t.toString(),o[ATTR_BODY.TC_ON_BY_ZUID]=editor.zuid,TCHandler.sendTCPropertiesOP(o),Utils.addToStatistics("TC_ON")}else{if(!t&&e.isONByOwner())return MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_INFO,J.i18n("common","TRACK_CHANGES"),J.i18n("trackchange","TC_TURNED_ON_BY_OWNER",[ReviewUtil.getUserProp(i[ATTR_BODY.TC_ON_BY_ZUID],"fname")])),TrackChangeUI.tcStatusSwitch.prop("checked",!0),void TrackChangeUI.tcStatusSwitch.prop("disabled",!0);var r={};t?r[ATTR_BODY.TC_ON_BY_COLLAB]=editor.zuid:r[ATTR_BODY.TC_OFF_BY_COLLAB]=editor.zuid,TCHandler.sendTCPropertiesOP(r),Utils.addToStatistics("TC_ON_BY_COLLAB")}return!1},TrackChangeUI.disableTCSwitch=function(){var e=J(TrackChangeUI.tcStatusSwitch).parents("div .js-trackchange-switch-outer");e.addClass("ui-state-disabled"),TrackChangeUI.tcStatusSwitch.attr("disabled",!0)},TrackChangeUI.enableTcSwitch=function(){var e=J(TrackChangeUI.tcStatusSwitch).parents("div .js-trackchange-switch-outer");e.removeClass("ui-state-disabled"),TrackChangeUI.tcStatusSwitch.attr("disabled",!1)},TrackChangeUI.updateCollabTCSwitch=function(){var e=editor.doc.getTrackChangeDetails();if(e.isEnabled()&&e.isONByOwner()){TrackChangeUI.disableTCSwitch(),Z("bbar-tcswitch-outer").find(".js-tc-collab-action").hide(),Z("bbar-tcswitch-outer").find(".js-tc-owner-action").show(),TrackChangeUI.reviewToolbar.find(".js-tc-collab-action").hide(),TrackChangeUI.reviewToolbar.find(".js-tc-owner-action").show();var t=editor.doc.getBodyFormat(),i=t[ATTR_BODY.TC_ON_BY_ZUID]?ReviewUtil.getUserProp(t[ATTR_BODY.TC_ON_BY_ZUID],"fname"):"Owner",o=J.i18n("trackchange","TC_ON_BY_TOOLTIP",[i]);return Z("bbar-tcswitch-outer").find("#bbar-tcswitch-on").attr("title",o),void TrackChangeUI.reviewToolbar.find("#review-tcswitch-on").attr("title",o)}TrackChangeUI.enableTcSwitch(),Z("bbar-tcswitch-outer").find(".js-tc-collab-action").show(),Z("bbar-tcswitch-outer").find(".js-tc-owner-action").hide(),TrackChangeUI.reviewToolbar.find(".js-tc-collab-action").show(),TrackChangeUI.reviewToolbar.find(".js-tc-owner-action").hide()},TrackChangeUI.drawTCStatus=function(){var e=(editor.doc.getBodyFormat(),editor.doc.getDocInfo(),editor.doc.getTrackChangeDetails());e.isEnabled()?TrackChangeUI.tcStatusSwitch.prop("checked",!0):TrackChangeUI.tcStatusSwitch.prop("checked",!1),e.isOwner()?(TrackChangeUI.enableTcSwitch(),"WORKSPACE_CRMLIB_EDITOR"===editor.doc.getRole()&&(Z("bbar-tcswitch-collabtxt").hide(),TrackChangeUI.reviewToolbar.find("#review-tcswitch-collabtxt").hide())):TrackChangeUI.updateCollabTCSwitch(),editor.doc.getDocInfo().CHECKEDOUT&&editor.doc.getDocInfo().CHECKEDOUTBY_ZUID!=editor.zuid&&TrackChangeUI.disableTCSwitch()},TrackChangeUI.isNormalUser=function(){var e=editor.doc.getRole();return"SHAREDREADWRITE"==e||"ANYONELINK_SHAREDREADWRITE"==e||"WORKSPACE_CRMLIB_EDITOR"==e&&editor.doc.getDocInfo().CREATOR_ZUID!=editor.zuid},TrackChangeUI.showInfo=function(){var e=editor.doc.getBodyFormat(),t=editor.doc.getTrackChangeDetails(),i=(editor.doc.getDocInfo(),e[ATTR_BODY.TC_ON_BY_ZUID]?ReviewUtil.getUserProp(e[ATTR_BODY.TC_ON_BY_ZUID],"fname"):"Owner");t.isEnabled()&&t.isONByOwner()&&(t.isOwner()?t.isOwner()&&editor.zuid!==e[ATTR_BODY.TC_ON_BY_ZUID]&&UIUtils.showMessage("info",J.i18n("trackchange","TC_TURNED_ON",[i]),"showclose","normalfont",4e3):UIUtils.showMessage("info",J.i18n("trackchange","TC_TURNED_ON_BY_OWNER",[i]),"showclose","normalfont",4e3))},TrackChangeUI.startRendering=function(){var e=editor.doc.getTrackChangeDetails(),t=new DocOpBuilder;t.operation="load";var i=editor.doc.getSelection().getLastRange();t.cursorStart=i.start,t.cursorEnd=i.end,t.cursor.push(i.offset()),ViewManager.updateHeaderFooter(),DocTreeManager.refreshTree(),t.postApplyTo(),e.getDisplayMode()===TCConstants.ALL_MARKUP_VIEW||e.getDisplayMode()===TCConstants.NO_MARKUP_VIEW?CurUtil.blinkCursor():CurUtil.stopBlinking()},TrackChangeUI.setEditable=function(){var e=editor.doc.getTrackChangeDetails();e.getDisplayMode()===TCConstants.ORIGINAL_VIEW?editor.setEditable(!1):editor.setEditable(!0)},TrackChangeUI.checkReadOnlyModeUI=function(){var e=editor.doc.getTrackChangeDetails(),t=e.getDisplayMode();t===TCConstants.ORIGINAL_VIEW?(TrackChangeUI.toggleAllTabs(!1),editor.jeditorPane.find("div.spell-error").hide(),UIUtils.showBanner(J.i18n("trackchange","READ_ONLY_MODE"))):(UIUtils.hideBanner(),TrackChangeUI.toggleAllTabs(!0))},TrackChangeUI.changeDisplayMode=function(e){e===TCConstants.ALL_MARKUP_VIEW?Utils.addToStatistics("TC_All_Markup"):e===TCConstants.NO_MARKUP_VIEW?Utils.addToStatistics("TC_No_Markup"):e===TCConstants.ORIGINAL_VIEW&&Utils.addToStatistics("TC_Original");var t=editor.doc.getBodyFormat(),i=t[ATTR_BODY.TC_DISPLAYMODE];t[ATTR_BODY.TC_DISPLAYMODE]=e;var o=editor.doc.getTrackChangeDetails();if(o.setDisplayMode(e),TrackChangeUI.setEditable(),e===TCConstants.ALL_MARKUP_VIEW||e===TCConstants.ORIGINAL_VIEW)i===TCConstants.NO_MARKUP_VIEW?(UIUtils.showLoadingMsg(J.i18n("writer.common.LOADING")),PubSub.subscribe("Document/LoadingStart",TrackChangeUI.postChangeDisplayMode),editor.doc.snapShotManager.resetSnapShotManager(),Utils.reloadDocumentContent()):TrackChangeUI.startRendering();else if(e===TCConstants.NO_MARKUP_VIEW){UIUtils.showLoadingMsg(J.i18n("writer.common.LOADING")),PubSub.subscribe("Document/LoadingStart",TrackChangeUI.postChangeDisplayMode),TcNoMarkupHandler.setup();var r=editor.doc.createRange();editor.doc.getSelection().removeAllRanges().addRange(r)}TrackChangeUI.checkReadOnlyModeUI(),PubSub.publish("Document/TC/ViewChanged")},TrackChangeUI.postChangeDisplayMode=function(){UIUtils.hideLoadingMsg(),PubSub.unsubscribe("Document/LoadingStart",TrackChangeUI.postChangeDisplayMode)},TrackChangeUI.changeMarkUpView=function(e){TrackChangeUI.changeDisplayMode(parseInt(e[0]))},TrackChangeUI.toggleOthersInReviewTab=function(e){for(var t=0,i=TrackChangeUI.otherButtonsInReviewTab.length;t<i;t++){var o=TrackChangeUI.otherButtonsInReviewTab[t];o.zbutton(e)}},TrackChangeUI.disableTopBandButtons=function(e){var t=Z("topband-hamburger"),i=Z("topband-default"),o=Z("popup-filemenu"),r=["filemenu-newdoc","filemenu-newfromtemplate","filemenu-open","filemenu-recentdocs","filemenu-saveas","filemenu-uploadfile","filemenu-shareinvite","filemenu-saveastemplate","filemenu-viewhistory","filemenu-publish","filemenu-marknewversion","filemenu-pagelayout"];e?(t.prop("disabled",!0),i.find("#ui-docnotification button").disable(),i.find("#topband-share-owner button").disable(),i.find("#topband-shared-label").disable(),i.find("#topband-settings,#topband-spotlightsearch").disable(),i.find("#topband-savestatus").hide(),o.zmenu("disableMenuItems",r)):(t.prop("disabled",!1),i.find("#ui-docnotification button").enable(),i.find("#topband-share-owner button").enable(),i.find("#topband-shared-label").enable(),i.find("#topband-settings,#topband-spotlightsearch").enable(),i.find("#topband-savestatus").show(),o.zmenu("enableMenuItems",r))},TrackChangeUI.hideRightpane=function(){Z("editor-rightPanel").hide(),editor.onResize()},TrackChangeUI.showRightpane=function(){Z("editor-rightPanel").show(),editor.onResize()},TrackChangeUI.disableBottomBar=function(e){e?TrackChangeUI.bottombar.find(".js-hide-footer-action").hide():TrackChangeUI.bottombar.find(".js-hide-footer-action").show()},TrackChangeUI.disableLeftPanelTabs=function(){var e=J(".ui-nav.ui-navbar-nav.ui-side-menu").children();e.push(Z("view-lpnl-reader"),Z("view-lpnl-zoom-cont"),Z("view-lpnl-navigatepane"),Z("view-lpnl-pilcrow")),e.push(Z("view-lpnl-gridlines"),Z("view-lpnl-layout-cont")),UIUtils.disableMenuTabs(e),J("#menu-view-parent").removeClass("ui-button-state-disable")},TrackChangeUI.enableLeftPanelTabs=function(){var e=J(".ui-nav.ui-navbar-nav.ui-side-menu").children();e.push(Z("view-lpnl-reader"),Z("view-lpnl-zoom-cont"),Z("view-lpnl-navigatepane"),Z("view-lpnl-pilcrow")),e.push(Z("view-lpnl-gridlines"),Z("view-lpnl-layout-cont")),UIUtils.enableMenuTabs(e)},TrackChangeUI.toggleAllTabs=function(e){e?(UIUtils.toggleElemState(["topband-compose","topband-collaborate","topband-complete"],"enable"),TrackChangeUI.disableTopBandButtons(!1),TrackChangeUI.disableBottomBar(!1),UIUtils.hideWrappers(!1),TrackChangeUI.drawTCStatus(),LayoutManager.getCurrentLayout()===LAYOUTS.COLLABORATE&&(TrackChangeUI.reviewToolbar.find("button").enable(),UIUtils.toggleCollabActionButtons(),TrackChangeUI.showRightpane()),LayoutManager.isRichEditActive()&&LeftPanel.isPanelVisible(ELEM_ID.VIEWPANEL)&&TrackChangeUI.enableLeftPanelTabs()):(UIUtils.toggleElemState(["topband-compose","topband-collaborate","topband-complete"],"disable"),TrackChangeUI.disableTopBandButtons(!0),TrackChangeUI.disableBottomBar(!0),TrackChangeUI.disableTCSwitch(),UIUtils.hideWrappers(!0),LayoutManager.getCurrentLayout()===LAYOUTS.COLLABORATE&&(TrackChangeUI.reviewToolbar.find("button").disable(),TrackChangeUI.reviewToolbar.find("#review-tb-pausecollab input").disable(),TrackChangeUI.reviewToolbar.find("#review-tb-pausecollab").addClass("ui-state-disabled"),TrackChangeUI.toggleOthersInReviewTab("enable"),TrackChangeUI.hideRightpane()),LayoutManager.isRichEditActive()&&(LeftPanel.isPanelVisible(ELEM_ID.VIEWPANEL)?TrackChangeUI.disableLeftPanelTabs():LeftPanel.toggleLeftPanel()))},TrackChangeUI.updateAllMarkupMenu=function(){var e=editor.doc.getTrackChangeDetails(),t=e.getDisplayMode(),i="";t===TCConstants.ALL_MARKUP_VIEW?(i=J.i18n("trackchange","ALL_MARKUP"),ReviewUtil.switchTab("review")):t===TCConstants.NO_MARKUP_VIEW?i=J.i18n("trackchange","NO_MARKUP"):t===TCConstants.ORIGINAL_VIEW&&(i=J.i18n("trackchange","ORIGINAL_ONLY")),Z("review-tb-tcallmarkup").zbutton("changeLabel",i)},TrackChangeUI.showErrorMsg=function(){UIUtils.showMessagePopup(J.i18n("trackchange","TC_ERROR_RELOAD_MSG"),J.i18n("error","OOPS"),"error",function(){location.reload()},!0),PubSub.unsubscribe("trackchange/errormsg",TrackChangeUI.showErrorMsg)},TrackChangeUI.updateReviewCountInBottomBar=function(){if(editor.getView()!==EDITOR_VIEWS.HISTORY&&editor.getView()!==EDITOR_VIEWS.MAILMERGE_PREVIEW){var e=TcManager.getCollection().getVisibleNodesCountDetails().all;if(e>0){var t=e>99?"99+":e;Z("bbar-tc-review-count").text(t).attr("title",J.i18n("trackchange","REVIEW_CHANGES_PENDING",[e])).show()}else Z("bbar-tc-review-count").hide()}},TrackChangeUI.handleReviewModeOpen=function(){TrackChangeUI.updateAllMarkupMenu(),TrackChangeUI.toggleAllMarkupMenu(),PubSub.subscribe("Document/TC/ViewChanged",TrackChangeUI.updateAllMarkupMenu),PubSub.subscribe("Document/TC/CountUpdated",TrackChangeUI.toggleAllMarkupMenu),PubSub.subscribe("Document/TCPropertiesChanged",TrackChangeUI.toggleAllMarkupMenu)},TrackChangeUI.handleReviewModeClose=function(){PubSub.unsubscribe("Document/TC/ViewChanged",TrackChangeUI.updateAllMarkupMenu),PubSub.unsubscribe("Document/TC/CountUpdated",TrackChangeUI.toggleAllMarkupMenu),PubSub.unsubscribe("Document/TCPropertiesChanged",TrackChangeUI.toggleAllMarkupMenu)},TrackChangeUI.toggleAllMarkupMenu=function(){if(!editor.isOfflineMode){var e=0!==TcManager.getCollection().getVisibleNodesCountDetails().all||editor.doc.getTrackChangeDetails().isEnabled();e?TrackChangeUI.markup.zbutton("enable"):TrackChangeUI.markup.zbutton("disable")}},TrackChangeUI.updateLeftPanelMarkUp=function(){var e=editor.doc.getTrackChangeDetails().getDisplayMode();Z("view-lpnl-tcmarkup").zcombo("setValue",e),TrackChangeUI.enableLeftPanelMarkUp()},TrackChangeUI.enableLeftPanelMarkUp=function(){if(!editor.isOfflineMode){var e=0!==TcManager.getCollection().getVisibleNodesCountDetails().all||editor.doc.getTrackChangeDetails().isEnabled();e?Z(ELEM_ID.VIEWPANEL).find("#view-lpnl-tcallmarkup").removeClass("ui-button-state-disable"):Z(ELEM_ID.VIEWPANEL).find("#view-lpnl-tcallmarkup").addClass("ui-button-state-disable")}},TrackChangeUI.handleLeftPanelOpen=function(e){e===ELEM_ID.VIEWPANEL&&(TrackChangeUI.updateLeftPanelMarkUp(),PubSub.subscribe("Document/TC/ViewChanged",TrackChangeUI.updateLeftPanelMarkUp),PubSub.subscribe("Document/TC/CountUpdated",TrackChangeUI.enableLeftPanelMarkUp),PubSub.subscribe("Document/TCPropertiesChanged",TrackChangeUI.enableLeftPanelMarkUp))},TrackChangeUI.handleLeftPanelClose=function(e){e===ELEM_ID.VIEWPANEL&&(PubSub.unsubscribe("Document/TC/ViewChanged",TrackChangeUI.updateLeftPanelMarkUp),PubSub.unsubscribe("Document/TC/CountUpdated",TrackChangeUI.enableLeftPanelMarkUp),PubSub.unsubscribe("Document/TCPropertiesChanged",TrackChangeUI.enableLeftPanelMarkUp))},TrackChangeUI.attachScrollEvent=function(){editor.browserInfo.is_ie&&editor.editorPaneContainer[0].attachEvent?editor.editorPaneContainer[0].attachEvent("onscroll",function(){TrackChangeUI.hideTooltip()}):editor.editorPaneContainer[0].addEventListener("scroll",function(){TrackChangeUI.hideTooltip()},!1)},TrackChangeUI.getDetailsForTooltip=function(e){var t,i=editor.doc.getRawFormatAt(e),o=function(){for(;e>0&&!editor.doc.getRawFormatAt(e);)e--};if(i||(o(),i=editor.doc.getRawFormatAt(e)),i.hasOwnProperty(TCConstants.TC)){var r=i[TCConstants.TC];r.length>1&&TcUtil.sortTCVals(r),t=r[r.length-1]}return t},TrackChangeUI.showTooltip=function(e){var t=Z("tcTooltipDiv"),i=(ReviewUtil.getUserName(e.getUser()),Utils.getUserImageURL(e.getUser()),ReviewUtil.getUserColour(e.getUser())),o=e.getAction()===TCConstants.INSERT?J.i18n("trackchange","INSERTED"):J.i18n("trackchange","DELETED"),r=(moment(Number(e.getTime())).format("h:mm A MMM D,YYYY"),t.find("#tcUserImg")),n=t.find("#tcAction");t.find("#tcUserName").text(ReviewUtil.getUserName(e.getUser())),n.text(o),n.css("color",i),t.find("#tcTime").text(moment(Number(e.getTime())).format("h:mm A MMM D,YYYY")),r.attr("src",Utils.getUserImageURL(e.getUser())),r.css("border-color",i),Z("tc-tooltip-content").empty().append(TcUtil.convertContentToDOMElements(e.toJson()));var a=t.find("#tooltip_changes-acpt,#tooltip_changes-rejt,#tooltip_collab_changes-rejt");a.off("click").on("click",function(t){e.getId();return"tooltip_changes-acpt"==this.id?(TcUtil.accept(e),TrackChangeUI.hideTooltip(),Utils.addToStatistics("tc_tooltip_accept")):(TcUtil.reject(e),TrackChangeUI.hideTooltip(),Utils.addToStatistics("tc_tooltip_reject")),!1}),editor.doc.getTrackChangeDetails().canReview()?(a.show(),t.find("#tooltip_collab_changes-rejt").hide()):(a.hide(),e.getUser()==editor.zuid&&t.find("#tooltip_collab_changes-rejt").show()),TrackChangeUI.adjustTootltipContentHeight(e.getEnd()-e.getStart()),t.appendTo(Z("popup-menu-tc-container")),t.show();var l=ReviewUtil.calculatePostionForTcCommentContainer();Z("popup-menu-tc-proof-cmnt-container").css({left:l.left,top:l.top}),ReviewUtil.adjustPositionOfTcCommentContainer(),TrackChangeUI.isTooltipVisible=!0},TrackChangeUI.hideTooltip=function(){TrackChangeUI.isTooltipVisible&&(Z("tcTooltipDiv").hide(),Z("reviewTcTooltipDiv").hide(),TCHandler.isTooltipVisible=!1,ReviewUtil.setHasTC(!1))},TrackChangeUI.unbindTooltip=function(){TrackChangeUI.hideTooltip(0)},TrackChangeUI.bindTooltip=function(e){Z("popup-menu-tc-container").children().remove(),editor.getView()===EDITOR_VIEWS.HISTORY||Utils.isVersionView()||ModeManager.getCurrentMode()==EDITOR_MODES.COLLABORATE||(ReviewUtil.setHasTC(!0),e&&!e.isHiddenNode()&&TrackChangeUI.showTooltip(e))},TrackChangeUI.updateTooltip=function(e){if(editor.getView()!==EDITOR_VIEWS.HISTORY&&!Utils.isVersionView()&&ModeManager.getCurrentMode()!=EDITOR_MODES.COLLABORATE){Z("tc-tooltip-content").empty().append(TcUtil.convertContentToDOMElements(e.toJson())),TrackChangeUI.adjustTootltipContentHeight(e.getEnd()-e.getStart());var t=ReviewUtil.calculatePostionForTcCommentContainer();Z("popup-menu-tc-proof-cmnt-container").css({left:t.left,top:t.top})}},TrackChangeUI.adjustTootltipContentHeight=function(e){e>210?(Z("tc-tooltip-content").addClass("tc-reviewcontent-shrinked"),Z("tc-tooltip-less").hide(),Z("tc-tooltip-more").show()):(Z("tc-tooltip-content").removeClass("tc-reviewcontent-shrinked"),Z("tc-tooltip-more").hide(),Z("tc-tooltip-less").hide())},TrackChangeUI.expandTootltipContent=function(){Z("tc-tooltip-content").removeClass("tc-reviewcontent-shrinked"),Z("tc-tooltip-less").show(),Z("tc-tooltip-more").hide()},TrackChangeUI.collapseTootltipContent=function(){Z("tc-tooltip-content").addClass("tc-reviewcontent-shrinked"),Z("tc-tooltip-less").hide(),Z("tc-tooltip-more").show()},TrackChangeUI.handleTcPropertyChange=function(){editor.isEditable()&&(TrackChangeUI.showInfo(),TrackChangeUI.initUI())},TrackChangeUI.fillUserColorsInPopup=function(){if(!(/REMOTE|ANYONEWITHLINK/.test(editor.getEditorType())||is_wkhtmltopdf_browser||editor.isOffline())&&editor.isEditable()){var e=0;Z("review-tb-usercolor").disable();var t=function(e){var t=J("#usercolor-wrapper");Z("review-tb-usercolor").enable();for(var i=0,o=e.length;i<o;i++){var r=Utils.createElement(NODE_NAME.SPAN,{class:"js-collab-color","data-color":e[i].color});r.style.backgroundColor=e[i].color,t.append(r)}t.find(".js-collab-color").on("click",function(){var e=this.getAttribute("data-color"),t=editor.doc.getUserData()[editor.zuid].color;if(t!=e){var i=TrackChangeUI.getUserDetailsOfColor(e);if(TrackChangeUI.hideInfoMsgInColorPopup(),i.length)for(var o=0,r=i.length;o<r;o++)i[o].zuid!=editor.zuid&&TrackChangeUI.showInfoMsgInColorPopup(J.i18n("writer.common.COLOR_ALREADY_CHOOSEN_INFO",[i[o].fname]));TrackChangeUI.selectColorInColorPopup(e),TcUtil.setUserColor(e)}}),Z("usercolor-checkbox").on("click",function(){var e=J(this).is(":checked"),t=Z("usercolor-dialog").find("span[data-color-selected=true]").attr("data-color");TcUtil.setDefaultUserColor(e,t)});var n=editor.doc.getUserData()[editor.zuid].color;TrackChangeUI.selectColorInColorPopup(n),J.ui.utils.initComponents(Z("usercolor-dialog"))},i=function(o){if(e++,e<3)TcUtil.getUserColors(t,i);else{var r=ZWCollaboration.TC_USER_COLORS_NOT_LOADED;Utils.sendErrorDetails(r+" <ZWERROR>\n Error Log Start \n\n Err No ="+r+" DOC len ="+editor.doc.getDocumentLength()+" buildLabel::: "+buildLabel+"\n Error Log End \n<ZWERROR>")}};TcUtil.getUserColors(t,i)}},TrackChangeUI.getUserDetailsOfColor=function(e){var t=[],i=editor.doc.getUserData();for(var o in i)i.hasOwnProperty(o)&&i[o].color===e&&t.push(i[o]);return t},TrackChangeUI.selectColorInColorPopup=function(e){var t=editor.doc.getUserData()[editor.zuid];Z("usercolor-dialog").find("span[data-color-selected=true]").removeClass("ui-usercolor-selected").removeAttr("data-color-selected"),Z("usercolor-dialog").find("span[data-default-color-selected=true]").removeClass("ui-usercolor-default-selected").removeAttr("data-default-color-selected").removeAttr("title"),t.default_color&&t.default_color!=e&&Z("usercolor-dialog").find("span[data-color="+t.default_color+"]").addClass("ui-usercolor-default-selected").attr({title:"Your default color","data-default-color-selected":!0}),Z("usercolor-dialog").find("span[data-color="+e+"]").addClass("ui-usercolor-selected").attr("data-color-selected",!0),t.default_color&&t.default_color==e?Z("usercolor-checkbox").prop("checked",!0):Z("usercolor-checkbox").prop("checked",!1)},TrackChangeUI.showInfoMsgInColorPopup=function(e){Z("usercolor-popup-infomsg").text(e),Z("usercolor-popup-info").show()},TrackChangeUI.hideInfoMsgInColorPopup=function(){Z("usercolor-popup-info").hide()},TrackChangeUI.bindReviewModeTooltip=function(e){if(e){var t=CurUtil.offset.start.left,i=CurUtil.offset.start.top,o=editor.doc.getSelection().getRangeAt(0),r=o.getStartPortionNode();if(r){var n=r.getClientRects();n.length&&(line_height=n[0].height,i=n[0].top)}e.isHiddenNode()||TrackChangeUI.showReviewTooltip(e,i,t)}},TrackChangeUI.showReviewTooltip=function(e,t,i){var o=Z("reviewTcTooltipDiv"),r=ReviewUtil.getUserColour(e.getUser()),n=e.getAction()===TCConstants.INSERT?J.i18n("trackchange","INSERTED"):J.i18n("trackchange","DELETED"),a=o.find("#tcUserImg"),l=o.find("#tcAction");o.find("#tcUserName").text(ReviewUtil.getUserName(e.getUser())),l.text(n),l.css("color",r),o.find("#tcTime").text(moment(Number(e.getTime())).format("h:mm A MMM D,YYYY")),a.attr("src",Utils.getUserImageURL(e.getUser())),a.css("border-color",r);var s=o.find("#tooltip_changes-acpt,#tooltip_changes-rejt,#tooltip_collab_changes-rejt");s.off("click").on("click",function(t){return"tooltip_changes-acpt"==this.id?(TcUtil.accept(e),TrackChangeUI.hideTooltip(),Utils.addToStatistics("tc_tooltip_accept")):(TcUtil.reject(e),TrackChangeUI.hideTooltip(),Utils.addToStatistics("tc_tooltip_reject")),!1}),editor.doc.getTrackChangeDetails().canReview()?(s.show(),o.find("#tooltip_collab_changes-rejt").hide()):(s.hide(),e.getUser()==editor.zuid&&o.find("#tooltip_collab_changes-rejt").show());var d=editor.editorPaneContainerOffset,c=i+d.left-TrackChangeUI.tooltipLeft,p=t-(Z("reviewTcTooltipDiv").outerHeight()+TrackChangeUI.tooltipPeakHeight);o.css({left:c,top:p}),o.show(),TrackChangeUI.isTooltipVisible=!0},TrackChangeUI.handleEvents=function(){if(ModeManager.getCurrentMode()==EDITOR_MODES.COLLABORATE){var e=["Document/Resize","Editor/WheelEvent","Cursor/Selected"];U.each(e,function(e){PubSub.subscribe(e,TrackChangeUI.hideTooltip)}),PubSub.subscribe("Document/TCContent/FocusIn",TrackChangeUI.bindReviewModeTooltip),PubSub.subscribe("UIEvent/PopupClosed",TrackChangeUI.unbindTooltip),PubSub.subscribe("Document/TCContent/CurPosChanged",TrackChangeUI.bindReviewModeTooltip),PubSub.unsubscribe("Document/TCContent/FocusIn",TrackChangeUI.bindTooltip),PubSub.unsubscribe("Document/TCContent/CurPosChanged",TrackChangeUI.updateTooltip)}else{var e=["Document/Resize","Editor/WheelEvent","Cursor/Selected"];U.each(e,function(e){PubSub.unsubscribe(e,TrackChangeUI.hideTooltip)}),PubSub.unsubscribe("Document/TCContent/FocusIn",TrackChangeUI.bindReviewModeTooltip),PubSub.unsubscribe("Document/TCContent/CurPosChanged",TrackChangeUI.bindReviewModeTooltip),PubSub.unsubscribe("UIEvent/PopupClosed",TrackChangeUI.unbindTooltip),PubSub.subscribe("Document/TCContent/FocusIn",TrackChangeUI.bindTooltip),PubSub.subscribe("Document/TCContent/CurPosChanged",TrackChangeUI.updateTooltip)}},TrackChangeUI.addSubscribers=function(){PubSub.subscribe("trackchange/errormsg",TrackChangeUI.showErrorMsg),PubSub.subscribe("Document/TC/CountUpdated",TrackChangeUI.updateReviewCountInBottomBar),PubSub.subscribe("Document/FirstTimeComponentReady",TrackChangeUI.fillUserColorsInPopup),PubSub.subscribe("Document/ComponentReady",TrackChangeUI.initUI),PubSub.subscribe("Document/TCPropertiesChanged",TrackChangeUI.handleTcPropertyChange),PubSub.subscribe("BeforePanelOpen",TrackChangeUI.handleLeftPanelOpen),PubSub.subscribe("BeforePanelClose",TrackChangeUI.handleLeftPanelClose),PubSub.subscribe("Document/TCContent/FocusOut",TrackChangeUI.unbindTooltip),PubSub.subscribe("Document/LayoutChanged",TrackChangeUI.handleEvents)}();var TcNoMarkupHandler=function(e,t,i,o,r,n){var a=e.build([]),l=[],s=!1,d="",c=function(){l=[]},p=function(e){a=e},u=function(){return a},f=function(){return l},g=function(e){l=e},m=function(e){var t=editor.doc.getDocInfo();25==t.REVISION&&1!=t.VERSION&&(d="");var i="\n"+(new Date).toLocaleString()+"->"+e+"| DocId ="+Utils.getDocumentId()+" Doc Len ="+editor.doc.getDocumentLength()+"|CUR:"+t.VERSION+"."+t.REVISION,o=editor.doc.getSelection();o&&(i+="|Selection: "+o.toIntervals().join("|")),d+=i},h=function(){var e=editor.doc,t=S();a=t.tcRangeOps,e.snapShotManager.resetSnapShotManager(),ZWCollaboration.transformAndApplyOthersCursor(a);for(var i=t.dsNodesRanges,o=i.length-1;o>=0;o--){var r=i[o],n=r.start,l=r.end;e.bucket.remove(n,l-n+1),e.contStr=e.contStr.substr(0,n)+e.contStr.substr(l+1)}var d={},c={};editor.doc.locks&&(c.locks=editor.doc.locks.toString()),c.rev=editor.doc.getDocInfo().REVISION,c.ver=editor.doc.getDocInfo().VERSION,c.styles=editor.doc.getFormats(),c.content=editor.doc.getContent(),c.defaults=editor.doc.getBodyFormat(),c.comments={comment_sequence_number:CommentModels.comment_sequence_number,comments:CommentManager.constructCommentsJSON()},d.content=c,d.info=editor.doc.getDocInfo(),editor.loadDocument(d),s=!1},T=function(t){for(var i,n,a=e.build([]),l=e.build([]),s=e.build([]),d=e.build([]),c=[],p=[],u=0,f=function(e){var t,i,r;if(e&&e.hasOwnProperty(o.TC)){var n=e[o.TC];r="";for(var a=0,l=n.length;a<l;a++){var s=n[a];if(i=s[o.ZUID],s[o.ACTION]===o.DELETE){t=TC_ACTION_DELETE,r=s[o.TASK]?s[o.TASK]:"";break}t=TC_ACTION_INSERT,r=s[o.TASK]?s[o.TASK]:""}}return{action:t,zuid:i,task:r}},g=t.docOps,m=0,h=g.length;m<h;m++){var T=g[m];if(T.isRetain()){var E=T.length();if(i=p[p.length-1],r.hasTCDeletion(i)){var S=f(i),O=S.task,v=editor.doc.getContent(u,u+E),b=P(u,i),A=e.build([]);if(R(A,b,v),a.push(new TCOp(E,S.action,S.zuid,v,b,o.DELETE,A)),l.deleteCharacters(v),O===o.REMOVE){var y=new TCRemoveOp(E,S.action,S.zuid,v,i,o.DELETE);s.push(y),d.push(new TCRemoveOp(E,S.action,S.zuid,v,i,o.DELETE))}else{var D=new DocOp;D.changeStyles([],i),s.push(D),s.push(T);var C=new DocOp;C.changeStyles(DocUtil.getKeys(i,[])),s.push(C),d.push(new TCOp(E,S.action,S.zuid,v,i,o.DELETE,A))}}else a.skipChars(E),l.skipChars(E),s.skipChars(E),d.skipChars(E);u+=E}else if(T.isAnnotationStart()){if(n=T.styles.begin,p.push(n),!r.hasTCDeletion(n)){var D=new DocOp;D.changeStyles([],n),a.push(D),l.push(D),s.push(D),d.push(D),c.push(u)}}else if(T.isAnnotationEnd()){if(n=T.styles.end,i=p.pop(),c.length){var D=new DocOp;D.changeStyles(n,[]),a.push(D),l.push(D),s.push(D),d.push(D),c.pop()}}else if(T.isInsert()){var E=T.length();if(i=p[p.length-1],r.hasTCDeletion(i)){var S=f(i),O=S.task,v=T.characters,A=e.build([]);if(R(A,i,v),a.push(new TCOp(v.length,S.action,S.zuid,v,i,o.INSERT,A)),O===o.REMOVE)s.push(new TCRemoveOp(v.length,S.action,S.zuid,v,i,o.INSERT)),d.push(new TCRemoveOp(v.length,S.action,S.zuid,v,i,o.INSERT));else{var D=new DocOp;D.changeStyles([],i),s.push(D),s.push(T);var C=new DocOp;C.changeStyles(DocUtil.getKeys(i,[])),s.push(C),d.push(new TCOp(v.length,S.action,S.zuid,v,i,o.INSERT,A))}}else{var I=T.characters;a.newCharacters(I),l.newCharacters(I),s.newCharacters(I),d.newCharacters(I)}u+=E}else if(T.isDelete()){var I=T.delete_characters;a.deleteCharacters(I),l.deleteCharacters(I),s.deleteCharacters(I),d.deleteCharacters(I),u+=I.length}else T.isRemoveTC()&&l.push(T)}return{tcClientOpsForCompose:a,excludedTCDeleteOps:l,includeTCRemoveOps:s,tcServerOpsForCompose:d}},E=function(t){for(var i,o,n=e.build([]),a=[],l=[],s=0,d=t.docOps,c=0,p=d.length;c<p;c++){var u=d[c];if(u.isRetain()){var f=u.length();if(i=l[l.length-1],r.hasTCDeletion(i)){var g=editor.doc.getContent(s,s+f);n.deleteCharacters(g)}else n.skipChars(f);s+=f}else if(u.isAnnotationStart()){if(o=u.styles.begin,l.push(o),!r.hasTCDeletion(o)){var m=new DocOp;m.changeStyles([],o),n.push(m),a.push(s)}}else if(u.isAnnotationEnd()){if(o=u.styles.end,i=l.pop(),a.length){var m=new DocOp;m.changeStyles(o,[]),n.push(m),a.pop()}}else if(u.isInsert()){var f=u.length();if(i=l[l.length-1],!r.hasTCDeletion(i)){var h=u.characters;n.newCharacters(h)}}else if(u.isDelete()){var h=u.delete_characters;n.deleteCharacters(h),s+=h.length}else u.isRemoveTC()&&n.push(u)}return n},R=function(e,t,i){var o=new DocOp,r=new DocOp;asEndOp=new DocOp,o.changeStyles([],t),r.newCharacters(i),asEndOp.changeStyles(DocUtil.getKeys(t),[]),e.push(o),e.push(r),e.push(asEndOp)},S=function(){for(var t,n,a,l=(i.getCollection().getAllNodes(),e.build([])),s=[],d=0,c=0,p=null,t=1,n=editor.doc.getDocumentLength();t<n;t++){var a=editor.doc.getRawFormatAt(t);if(a&&p){s.push({start:d,end:t-1});var u=e.build([]);characters=editor.doc.getContent(d,t),R(u,p,characters);var f=r.getTcDeletionDetails(p);l.push(new TCOp(t-d,o.DELETE,f.zuid,characters,p,"hidden",u)),p=null,c=t}r.hasTCDeletion(a)&&(t!==c&&l.skipChars(t-c),p=a,d=t)}if(p){s.push({start:d,end:t-1});var u=e.build([]);characters=editor.doc.getContent(d,t),R(u,p,characters);var f=r.getTcDeletionDetails(p);l.push(new TCOp(t-d,o.DELETE,f.zuid,characters,p,"hidden",u))}return{dsNodesRanges:s,tcRangeOps:l}},O=function(t){for(var i=t.docOps,o=e.build([]),r=0,n=i.length;r<n;r++){var a=i[r];a.isRetain()?o.skipChars(a.length()):a.isTC()||a.isRemoveTC()?o.push(a):a.isAnnotation()?o.push(a):a.isInsert()&&o.push(a)}return o},v=function(t){for(var i=t.docOps,o=e.build([]),r=0,n=i.length;r<n;r++){var a=i[r];if(a.isRetain())o.skipChars(a.length());else if(a.isInsert()){var l=new DocOp;l.skipChars(a.length()),o.push(l)}else a.isTC()?o.push(a):a.isAnnotation()&&o.push(a)}return o},b=function(t){for(var i=t.docOps,o=e.build([]),r=0,n=i.length;r<n;r++){var a=i[r];if(a.isInsert()){var l=new DocOp;l.skipChars(a.length()),o.push(l)}else(a.isRetain()||a.isTC())&&o.push(a)}var s=-1;for(r=0,n=o.length();r<n;r++){var a=o.docOps[r];a.isTC()&&(s=r)}if(s!=n-1){var d=e.build([]);for(r=0;r<=s;r++)d.push(o.docOps[r])}else var d=o;return d},A=function(){try{var t=l.length;if(0==t)return;for(var i=l[0],o=null,r=0;r<t;r++)if(o=l[r+1]){var n=e.xform(i,o);i=e.compose(i,n.second),i=e.concise(i)}}catch(e){Utils.log("Exception occurred while composing OPs from client to server in Tc_No_Markup mode"),Utils.log("Tc Msg Buffer: "+JSON.stringify(l)),Utils.log("Exception: "+(e.stack||e)),c();var a=new Error(ZWCollaboration.TC_NOMARKUP_OPS_PROCESSING_ERROR);throw editor.lastError=a,a}return i},y=function(){try{var t=A();Utils.log("Tc No Markup client OPs before transform "+t.toString()),m("Tc No Markup client OPs before transform "+t.toString()),m("Tc No Markup hidden Ops before transform "+a.toString());var i=e.xform(a,t),o=e.concise(i.first);i=e.concise(i.second);var r=T(i);r=r.tcClientOpsForCompose,r=v(r);var n=e.compose(r,o);n=N(n),o=M(n),o=e.concise(o),a=b(o),L(a),a=e.concise(a),m("Tc No Markup hidden Ops after transform "+a.toString())}catch(e){Utils.log("Exception occurred while processing OPs from client to server in Tc_No_Markup mode"),Utils.log("Tc No Markup OPs: "+a.toString()),Utils.log("Ops from client to Server: "+t.toString()),Utils.log("Exception: "+(e.stack||e));var l=new Error(ZWCollaboration.TC_NOMARKUP_OPS_PROCESSING_ERROR);throw editor.lastError=l,l}return Utils.log("Tc No Markup client OPs after transform "+i.toString()),m("Tc No Markup client OPs after transform "+i.toString()),i},D=function(t){try{var i=[];t=JSON.parse(t);for(var o=0,r=t.length;o<r;o++){var n=t[o].si,l=t[o].ei,s=editor.doc.getSelection().createCursorOp(n,l);s=e.build(s);var d=e.xform(a,s),c=d.second.getCursorPos()[0];n=c.start>=0?c.start:c.end,l=c.end>=0?c.end:c.start,i.push({si:n,ei:l})}}catch(e){Utils.log("Exception occurred while XForm the Cursor OP from Client to Server with Tc_No_Markup OPs"),Utils.log("Tc No Markup OPs: "+a.toString()),Utils.log("Cursor OP : "+s.toString()),Utils.log("Exception: "+(e.stack||e));var p=new Error(ZWCollaboration.TC_NOMARKUP_OPS_PROCESSING_ERROR);throw editor.lastError=p,p}return JSON.stringify(i)},C=function(t,i){try{var o=editor.doc.getSelection().createCursorOp(t,i);o=e.build(o);var r=e.xform(o,a),n=r.first.getCursorPos()[0];t=n.start>=0?n.start:n.end,i=n.end>=0?n.end:n.start}catch(e){Utils.log("Exception occurred while XForm the Cursor OP from Server to Client with Tc_No_Markup OPs"),Utils.log("Tc No Markup OPs: "+a.toString()),Utils.log("Cursor OP : "+o.toString()),Utils.log("Exception: "+(e.stack||e));var l=new Error(ZWCollaboration.TC_NOMARKUP_OPS_PROCESSING_ERROR);throw editor.lastError=l,l}return{start:t,end:i}},I=function(e){for(var t=e.docOps,i=0,r=t.length;i<r;i++){var n=t[i];n.isTC()&&n.getOriginAction()===o.DELETE&&n.setChars("")}},P=function(e,t){var i=editor.doc.getRawFormatAt(e);return i=i?i:DocUtil.getTextStyle(e),_(i,t),i},_=function(e,t){!e.hasOwnProperty(o.TC)&&t.hasOwnProperty(o.TC)?e[o.TC]=t[o.TC]:e.hasOwnProperty(o.TC)&&t.hasOwnProperty(o.TC)&&DocOpUtil.updateTCStyles(e,t)},N=function(t){for(var i=t.docOps,r=e.build([]),n=0,a=0,l=0,s=i.length;l<s;l++){var d=i[l];if(d.isRetain())n+=d.length(),r.push(d);else if(d.isTC()&&d.getOriginAction()===o.DELETE){var a=d.length(),c=0,p=null;p=editor.doc.getRawFormatAt(n),p=p?p:DocUtil.getTextStyle(n),c=n;for(var u=n+1;u<n+a;u++){var f=editor.doc.getRawFormatAt(u);if(f){var g=editor.doc.getContent(c,u),m=e.build([]);R(m,p,g);var h=d.getStyle(),T=e.build([]),E=new DocOp,S=new DocOp;E.changeStyles([],h),S.changeStyles(DocUtil.getKeys(h),[]),T.push(E),T.skipChars(g.length),T.push(S);var O=e.compose(m,T);r.push(new TCOp(u-c,o.DELETE,d.getUser(),g,d.getStyle(),d.getOriginAction(),O)),p=f,c=u}}if(p){var g=editor.doc.getContent(c,u),m=e.build([]);R(m,p,g);var h=d.getStyle(),T=e.build([]),E=new DocOp,S=new DocOp;E.changeStyles([],h),S.changeStyles(DocUtil.getKeys(h),[]),T.push(E),T.skipChars(g.length),T.push(S);var O=e.compose(m,T);r.push(new TCOp(u-c,o.DELETE,d.getUser(),g,d.getStyle(),d.getOriginAction(),O))}n+=a}else r.push(d)}return r},L=function(e){for(var t=e.docOps,i=0,o=t.length;i<o;i++){var r=t[i];r.isTC()&&r.setOriginAction("hidden")}},w=function(t){for(var i=t.docOps,o=e.build([]),r=0,n=i.length;r<n;r++){var a=i[r];if(a.isRemoveTC()){var l=a.getContentStyleOp();if(!l||0===l.length()){o.skipChars(a.length());continue}var s=new DocOp,d=new DocOp,c=e.build([]);s.changeStyles([],a.style),d.changeStyles(DocUtil.getKeys(a.style),[]),c.push(s),c.skipChars(a.getContentStyleOpLength()),c.push(d);for(var p=e.compose(l,c),u=p.docOps,f=0,g=u.length;f<g;f++)o.push(u[f])}else o.push(a)}return o},M=function(t){for(var i=t.docOps,o=e.build([]),r=[],n=0,a=i.length;n<a;n++){var l=i[n];if(l.isRetain())o.skipChars(l.length());else if(l.isTC()){for(var s=r.length-1;s>=0;s--){var d=r[s],c=l.getContentStyleOp(),p=e.build([]),u=new DocOp,f=new DocOp;u.changeStyles([],d),f.changeStyles(DocUtil.getKeys(d),[]),p.push(u),p.skipChars(l.getContentStyleOpLength()),p.push(f);var g=e.compose(c,p);l.setContentStyleOp(g)}o.push(l)}else l.isAnnotationStart()?r.push(l.styles.begin):l.isAnnotationEnd()&&r.pop()}return o},U=function(e){for(var t=e.docOps,i=0,o=0,r=t.length;o<r;o++){var n=t[o];n.isInsert()&&(i+=n.length())}return i},x=function(e){for(var t=e.docOps,i="",o=0,r=t.length;o<r;o++){var n=t[o];n.isInsert()&&(i+=n.characters)}return i},F=function(t,i){var o=t.getContentStyleOp();o=o.length()>0?o.docOps:[];var r=e.build([]),n=e.build([]);contentIndex=0;for(var a=0,l=o.length;a<l;a++){var s=o[a];if(s.isAnnotation())r.push(s),n.push(s);else if(s.isInsert()){var d=s.length();if(contentIndex+d<=i)r.push(s);else if(contentIndex>=i)n.push(s);else{var c=s.characters,p=i-contentIndex,u=c.substr(0,p),f=c.substr(p),g=new DocOp;g.newCharacters(u);var m=new DocOp;m.newCharacters(f),r.push(g),n.push(m)}contentIndex+=d}}return r=e.concise(r),n=e.concise(n),{inclusiveCutop:r,exclusiveCutop:n}},k=function(t){try{var i=t;Utils.log("Tc No Markup server OPs before transform "+i.toString()),m("Tc No Markup server OPs before transform "+i.toString()),m("Tc No Markup hidden Ops before transform "+a.toString()),t=T(t);var o=e.xform(t.includeTCRemoveOps,a),r=e.concise(o.second);o=e.concise(o.first);var n=t.tcServerOpsForCompose;n=O(n),I(n);var l=e.compose(n,r);l=N(l),r=M(l),r=e.concise(l),a=b(r),L(a),a=e.concise(a),t=E(o),t=w(t),m("Tc No Markup hidden Ops after transform "+a.toString())}catch(e){Utils.log("Exception occurred while processing OPs from server to client in Tc_No_Markup mode"),Utils.log("Tc No Markup OPs: "+a.toString()),Utils.log("Ops from server to client : "+i.toString()),Utils.log("Exception: "+(e.stack||e));var s=new Error(ZWCollaboration.TC_NOMARKUP_OPS_PROCESSING_ERROR);throw editor.lastError=s,s}return Utils.log("Tc No Markup server OPs after transform "+t.toString()),m("Tc No Markup server OPs after transform "+t.toString()),t},B=function(e){return l.push(e),e=T(e),s||(s=!0,Utils.addToStatistics("TC_No_Markup_Edit")),e.excludedTCDeleteOps},J=function(){var t=editor.doc.getTrackChangeDetails().getDisplayMode();t===o.NO_MARKUP_VIEW&&(a=e.build([]),l=[],n.changeDisplayMode(o.ALL_MARKUP_VIEW))},H=function(e){var t=editor.doc.getTrackChangeDetails();if(t.getDisplayMode()===o.NO_MARKUP_VIEW){if(e&&e.errorNo&&e.errorNo===ZWCollaboration.TC_NOMARKUP_OPS_PROCESSING_ERROR)return;var i=ZWCollaboration.TC_NO_MARKUP_CLIENT_ERROR,r=Utils.shrinkOperationSequence(ZWCollaboration.operationSequence).join(",");Utils.sendErrorDetails(i+" <ZWERROR>"+editor.doc.getDocInfo().VERSION+"."+editor.doc.getDocInfo().REVISION+"<ZWERROR>\n Error Log Start \n"+d+"\n Err No ="+i+" DOC len ="+editor.doc.getDocumentLength()+" Cur St ="+editor.doc.getSelection().getStart()+" Cur end="+editor.doc.getSelection().getEnd()+" Pen [0]="+(ZWCollaboration.msgQueue.getAckPendingEdit()?ZWCollaboration.msgQueue.getAckPendingEdit().toString():"")+"[1]="+(ZWCollaboration.msgQueue.getPendingToPushEdit()?ZWCollaboration.msgQueue.getPendingToPushEdit().toString():"")+" FULL DOC OP IDS :: "+ZWCollaboration.docOpIds+" buildLabel::: "+buildLabel+"\nOperation Sequence: \n"+r+"\nError Log End \n<ZWERROR>"+ZWCollaboration.mailInfo)}};(function(){t.subscribe("Document/Error",H),t.subscribe("Document/Error",J)})();return{setup:h,getMsgBuffer:f,setMsgBuffer:g,getRangeOPs:u,setRangeOPs:p,processClientToServerOp:y,processClientToServerCursorOp:D,processServerToClientCursorOp:C,processServerToClientOp:k,processMsg:B,resetBuffer:c,getNoMarkupOPs:S,cutContentStyleOp:F,getContentStyleOpLength:U,getContentStyleOpChars:x}}(DocOpBuilder,PubSub,TcManager,TCConstants,TcUtil,TrackChangeUI),TcPane=function(e,t,i,o,r,n,a,l,s){var d,c={},p=null,u=0,f=210;viewFilter=t.ALL_FILTER,userFilter=t.ALL_FILTER,SPL_CHARS=UNICODE.IMAGE+UNICODE.TAB+UNICODE.PARA+UNICODE.HR,SPL_CHARS_REGEX=new RegExp("([^"+SPL_CHARS+"]+){1}|(["+SPL_CHARS+"]+){1}","g");var g,m={REVIEWPANE:"reviewpane",EMPTY_REVIEWPANE:"empty_reviewpane",VIEW_FILTER:"tc-view-menu",USER_FILTER:"tc-user-menu",REVIEWALL_MENU:"tc-reviewall-menu",MOREOPTION_BUTTON:"tc-more-opt",TC_VIEW_CONT:"tc-views",LOADING_IMG:"loading_revisions"},h=27,T=function(){var e=[],t=function(){e=[]},i=function(t){var i,o;for(i=0,o=e.length;i<o;i++)if(t==e[i].getId())return!0;return!1},o=function(t,i){e.splice(t,0,i)},r=function(t){o(e.length,t)},n=function(e){var t,i,o;for(t=0,i=e.length;t<i;t++)o=e[t],r(o)},a=function(t){var i,o;for(i=0,o=e.length;i<o;i++)if(e[i].getId()==t){e.splice(i,1);break}},l=function(){var t=e[0];return a(t.getId()),t},s=function(){return e.length},d=function(t){var n,a,l,s=0,d=0,c=t.length,p=e.length;if(p>0){for(;s<c&&d<p;)a=t[s],i(a.getId())?s++:(l=e[d],node1Start=a.getStart(),node2Start=l.getStart(),node1Start===node2Start?(o(d,a),s++,d++):node1Start<node2Start?(o(d,a),s++,d++):d++);if(s!==c)for(n=s;n<c;n++)r(t[n])}else for(s=0;s<c;s++)r(t[s])},c=function(){var t,i,o,r=[];for(t=0,i=e.length;t<i;t++)o=e[t],r.push(o.toJson());return r},p=function(){var t,i,o,r="";for(t=0,i=e.length;t<i;t++)o=e[t],r+="\n"+JSON.stringify(o.toJson());return r};return{init:t,has:i,addAll:n,remove:a,shift:l,length:s,injectNodes:d,toJson:c,toString:p}}(),E=function(e,t,i){var o=!1;return o=i?e.getUser()===d&&e.getAction()===t:e.getAction()===t},R=function(e){var i=[],o=userFilter!=t.ALL_FILTER;return viewFilter===t.ALL_FILTER?i=o?e.filter(function(e){return e.getUser()===d}):e:viewFilter===t.ADDED_FILTER?i=e.filter(function(e){return E(e,t.INSERT,o)}):viewFilter===t.DELETED_FILTER&&(i=e.filter(function(e){return E(e,t.DELETE,o)})),i},S=function(){return R(e.getCollection().getAllNodes())},O=function(){return T},v=function(){return c},b=function(){c={}},A=function(e){var t=e.getId();T.has(t)&&T.remove(t),J(c[t]).remove()},y=function(e){T.injectNodes(R([e]))},D=function(){clearInterval(p)},C=function(e){for(var i=e.prev,o=userFilter!=t.ALL_FILTER;i;)if(i.isHiddenNode())i=i.prev;else if(viewFilter===t.ALL_FILTER){if(!o||o&&i.getUser()==d)break;i=i.prev}else if(viewFilter===t.ADDED_FILTER){if(E(i,t.INSERT,o))break;i=i.prev}else if(viewFilter===t.DELETED_FILTER){if(E(i,t.DELETE,o))break;i=i.prev}return i},I=function(){var i=function(e){var t=(e.id,e.start,e.end,e.action,e.zuid),i=e.time,o=(e.type,r.convertContentToDOMElements(e)),n=(a.getUserName(t),s(e,o,parseInt(i)));return n},o=function(e,t){var i=moment(t).format("h:mm a MMM D,YYYY"),o=e.find("#time");o.attr("data-dynamic-time",t),o.addClass("dynamic-time"),o.attr("title",i),o.text(n.getTimeFromNow(t))},l=function(e){var t=(editor.doc.getDocInfo(),"<div class='ui-ntchange-div' data-userid="+e+"><div id='bodyContent' class='ui-ntchange'><div class='ui-auth-header'><div class='ui-flt-left'><img id='author_img' class='ui-auth-img' /></div><div class='ui-flt-left ui-auth-details'><div id='author_name' class='ui-auth-name'></div><div id='time' class='ui-auth-time'></div></div><div id='status' class='ui-fr ui-auth-clr ui-top-margin-small'></div><div class='clearfix'></div></div><div id='content' class='ui-auth-txt'></div><div><a id='tc-expand-btn' href='#' style='cursor: pointer;font-style: italic;display:none;'>More...</a><a id='tc-collapse-btn' href='#' style='cursor: pointer;font-style: italic;display:none;'>Less</a></div><div id='actionButton' class='ui-fl' style='padding-top: 10px;'>");return editor.doc.getTrackChangeDetails().canReview()?t+="<button id='changes-acpt' class='ui-auth-actbtn ui-right-margin-small ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary' ><span class='ui-button-icon-primary ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-accept-trans-sm'></span><span class='ui-button-text'>Accept</span></button><button id='changes-rejt' class='ui-auth-actbtn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary' role='button' aria-disabled='false' autocomplete='off'><span class='ui-button-icon-primary ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-reject-trans-sm'></span><span class='ui-button-text'>Reject</span></button>":editor.zuid===e&&(t+="<button id='collab_changes-rejt' class='ui-auth-actbtn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary' role='button' aria-disabled='false' autocomplete='off'><span class='ui-button-icon-primary ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-reject-trans-sm'></span><span class='ui-button-text'>Reject</span></button>"),t+="</div><div id='tc-nav-txt' class='ui-fr' style='padding-top: 10px;'></div><div class='clearfix'></div></div></div>",J(t)},s=function(i,s,p){var u=i.id,f=i.zuid,g=J.i18n("trackchange","INSERTED");i.action===t.DELETE&&(g=J.i18n("trackchange","DELETED"));var m=n.getUserImageURL(f),h=l(f),T=a.getUserColour(f);return h.attr("id","revision_"+u),h.find("#author_img").attr("src",m).css("border-color",T),h.find("#author_name").text(a.getUserName(f)),h.find("#status").text(g).css({"border-color":T,color:T}),h.find("#content").append(s),h.attr("node-id",u),d(i,h),o(h,p),h.off().on({click:function(){r.selectRevision(u)},mouseover:function(){J(this).find("#actionButton").css("visibility","visible")},mouseout:function(){J(this).hasClass("ui-tc-revision-selected")||J(this).find("#actionButton,#tc-nav-txt").css("visibility","hidden")}}),h.find("#changes-acpt").on({click:function(t){r.accept(e.getCollection().get(u)),r.clearFocusingLines()}}),h.find("#changes-rejt, #collab_changes-rejt").on({click:function(t){r.reject(e.getCollection().get(u)),r.clearFocusingLines()}}),h.find("#tc-expand-btn").on({click:function(){c[u]&&(this.style.display="none",c[u].find("#content").removeClass("tc-reviewcontent-shrinked"),c[u].find("#tc-collapse-btn").show())}}),h.find("#tc-collapse-btn").on({click:function(){c[u]&&(this.style.display="none",c[u].find("#content").addClass("tc-reviewcontent-shrinked"),c[u].find("#tc-expand-btn").show())}}),h},d=function(e,t){!e.isBlock&&e.end-e.start>f?(t.find("#content").addClass("tc-reviewcontent-shrinked"),t.find("#tc-collapse-btn").hide(),t.find("#tc-expand-btn").show()):(t.find("#content").removeClass("tc-reviewcontent-shrinked"),t.find("#tc-collapse-btn,#tc-expand-btn").hide())};return{getHtml:i,updateTime:o,adjustContentHeight:d}}(),P=function(e){for(var t,i=Z(m.REVIEWPANE).children(),o=0,r=i.length;o<r;o++)if(t=i[o],t.getAttribute("node-id")===e)return o+1;return 0},_=function(e){var t=J.Deferred(),i=c[e];if(i)return Z(m.REVIEWPANE).scrollTop(0),Z(m.REVIEWPANE).animate({scrollTop:i.position().top-200},function(){t.resolve(!0)}),t},N=function(e){L();var t=c[e];if(t){var i=P(e)+" / "+J.i18n("writer.common.CHANGES",[u]);t.find("#tc-nav-txt").text(i).css("visibility","visible"),t.find("#actionButton").css("visibility","visible"),t.addClass("ui-tc-revision-selected"),g=!0}},L=function(){if(g){var e=o.JallRevisionsListDiv.find(".ui-tc-revision-selected");e.length&&(e.find("#actionButton, #tc-nav-txt").css("visibility","hidden"),e.removeClass("ui-tc-revision-selected"))}g=!1},w=function(){var e=V();Z(m.VIEW_FILTER).zcombo("updateLabel",t.ALL_FILTER.toString(),J.i18n("trackchange","ALL_COUNT",[e[t.INSERT]+e[t.DELETE]])),Z(m.VIEW_FILTER).zcombo("updateLabel",t.ADDED_FILTER.toString(),J.i18n("trackchange","INSERTIONS_COUNT",[e[t.INSERT]])),Z(m.VIEW_FILTER).zcombo("updateLabel",t.DELETED_FILTER.toString(),J.i18n("trackchange","DELETIONS_COUNT",[e[t.DELETE]]))},M=function(){var i=e.getCollection().getVisibleNodesCountDetails(),o=i.authors,r=Z(m.USER_FILTER);r.zcombo("removeAllOptions"),r.zcombo("addOption",{label:J.i18n("writer.common.ALL"),value:t.ALL_FILTER});for(var n in o){var l={label:a.getUserName(n),value:n};r.zcombo("addOption",l)}o&&r.zcombo("updateLabel",t.ALL_FILTER.toString(),J.i18n("trackchange","ALL_COUNT",[U.keys(o).length]))},x=function(i){var o={label:a.getUserName(i),value:a.removeSplCharsInZuid(i)};Z(m.USER_FILTER).zcombo("addOption",o);var r=e.getCollection().getVisibleNodesCountDetails().authors;Z(m.USER_FILTER).zcombo("updateLabel",t.ALL_FILTER.toString(),J.i18n("trackchange","ALL_COUNT",[U.keys(r).length]))},F=function(i){userFilter===t.AUTHOR_BY_FILTER&&d===i&&X(viewFilter,t.ALL_FILTER),Z(m.USER_FILTER).zcombo("removeOption",a.removeSplCharsInZuid(i));var o=e.getCollection().getVisibleNodesCountDetails().authors;Z(m.USER_FILTER).zcombo("updateLabel",t.ALL_FILTER.toString(),J.i18n("trackchange","ALL_COUNT",[U.keys(o).length]))},k=function(){var e,i,o={},r=userFilter===t.AUTHOR_BY_FILTER,n=r?a.getUserName(d):"";return viewFilter===t.ADDED_FILTER?(e=r?J.i18n("trackchange","ACCEPT_ALL_INSERTIONS_BY_USER",[n]):J.i18n("trackchange","ACCEPT_ALL_INSERTIONS"),i=r?J.i18n("trackchange","REJECT_ALL_INSERTIONS_BY_USER",[n]):J.i18n("trackchange","REJECT_ALL_INSERTIONS")):viewFilter===t.DELETED_FILTER?(e=r?J.i18n("trackchange","ACCEPT_ALL_DELETIONS_BY_USER",[n]):J.i18n("trackchange","ACCEPT_ALL_DELETIONS"),i=r?J.i18n("trackchange","REJECT_ALL_DELETIONS_BY_USER",[n]):J.i18n("trackchange","REJECT_ALL_DELETIONS")):(e=r?J.i18n("trackchange","ACCEPT_ALL_CHANGES_BY_USER",[n]):J.i18n("trackchange","ACCEPT_ALL_CHANGES"),i=r?J.i18n("trackchange","REJECT_ALL_CHANGES_BY_USER",[n]):J.i18n("trackchange","REJECT_ALL_CHANGES")),o.acceptAll=e,o.rejectAll=i,o},B=function(){var e=Z(m.REVIEWALL_MENU);e.zmenu("removeAllMenuItems");var i=k();userFilter===t.ALL_FILTER?(e.zmenu("addMenuItem",{label:i.acceptAll,title:i.acceptAll,data:"{'appData':{'action':'TcPane.acceptAll'}}"}),e.zmenu("addMenuItem",{label:i.rejectAll,title:i.rejectAll,data:"{'appData':{'action':'TcPane.rejectAll'}}"})):userFilter===t.AUTHOR_BY_FILTER&&(e.zmenu("addMenuItem",{label:i.acceptAll,title:i.acceptAll,data:"{'appData':{'action':'TcPane.acceptUserChanges'}}"}),e.zmenu("addMenuItem",{label:i.rejectAll,title:i.rejectAll,data:"{'appData':{'action':'TcPane.rejectUserChanges'}}"}))},H=function(){Z(m.LOADING_IMG).show(),p=setInterval(function(){var e=1;if(!(u>0))return Z(m.EMPTY_REVIEWPANE).show(),Z(m.REVIEWPANE).hide(),Z(m.LOADING_IMG).hide(),Z(m.MOREOPTION_BUTTON).zbutton("disable"),void D();Z(m.MOREOPTION_BUTTON).zbutton("enable"),Z(m.EMPTY_REVIEWPANE).hide(),Z(m.REVIEWPANE).show();for(var i=function(e){var t=I.getHtml(e.toJson()),i=C(e);if(i){var o=i.getId(),r=c[o];J(r).after(t)}else Z(m.REVIEWPANE).prepend(t);c[e.getId()]=J(t)};e<=50&&T.length();){var o=T.shift();if(o.isHiddenNode())e++;else{if(o.getMode()===t.CREATE_MODE)i(o);else if(o.getMode()===t.UPDATE_MODE){var n=c[o.getId()];if(n){var a=r.convertContentToDOMElements(o.toJson());n.find("#content").empty().append(a),I.adjustContentHeight(o,n),I.updateTime(n,o.getTime()),c[o.getId()]=J(n)}else i(o)}e++}}0==T.length()&&(D(),Z(m.LOADING_IMG).hide()),te()},500)},G=function(e){e&&(viewFilter=e,userFilter=t.ALL_FILTER,Z(m.VIEW_FILTER).zcombo("setValue",e),Z(m.USER_FILTER).zcombo("setValue",t.ALL_FILTER)),z(),M()},z=function(){D(),Z(m.REVIEWPANE).empty(),T.init(),b();var i=e.getCollection();i.setMode(t.CREATE_MODE);var o=R(i.getAllNodes());T.addAll(o),B(),w(),Y(),H()},V=function(){var i=e.getCollection().getVisibleNodesCountDetails(),o=userFilter===t.AUTHOR_BY_FILTER?i.authors[d]:i;return o||(o={ins:0,del:0}),o},Y=function(){var e=V();u=viewFilter===t.ALL_FILTER?e[t.INSERT]+e[t.DELETE]:viewFilter===t.ADDED_FILTER?e[t.INSERT]:e[t.DELETE]},W=function(e){e=parseInt(e[0]),X(e),e===t.ALL_FILTER?n.addToStatistics("TC_Filter_Insertions"):e===t.DELETED_FILTER?n.addToStatistics("TC_Filter_Deletions"):n.addToStatistics("TC_Filter_All")},j=function(e){e=e[0],e==t.ALL_FILTER?(X(viewFilter,t.ALL_FILTER),n.addToStatistics("TC_Filter_Author_All")):(X(viewFilter,t.AUTHOR_BY_FILTER,e),n.addToStatistics("TC_Filter_Author"))},X=function(e,i,o){Z(m.REVIEWPANE).empty(),e&&(viewFilter=parseInt(e)),i&&(userFilter=i,i===t.AUTHOR_BY_FILTER&&(d=o)),z()},K=function(){var e=k();MsgDialog.showMessage(CONST.MSG_TYPE_YESNO,CONST.SEVERITY_WARNING,e.acceptAll,J.i18n("writer.trackchange.ACCEPT_ALL_CONFIRM_TEXT"),null,function(e){switch(e){case CONST.BUTTON_YES_CLICKED:r.acceptAll()}})},$=function(){var e=k();MsgDialog.showMessage(CONST.MSG_TYPE_YESNO,CONST.SEVERITY_WARNING,e.rejectAll,J.i18n("writer.trackchange.REJECT_ALL_CONFIRM_TEXT"),null,function(e){switch(e){case CONST.BUTTON_YES_CLICKED:r.rejectAll()}})},q=function(){var e=a.getUserName(d);MsgDialog.showMessage(CONST.MSG_TYPE_YESNO,CONST.SEVERITY_WARNING,J.i18n("trackchange","ACCEPT_USER_CHANGES",[e]),J.i18n("trackchange","ACCEPT_USER_CHANGES_CONFRIM_TEXT",[e]),null,function(e){switch(e){case CONST.BUTTON_YES_CLICKED:r.acceptUserChanges()}})},Q=function(){var e=a.getUserName(d);MsgDialog.showMessage(CONST.MSG_TYPE_YESNO,CONST.SEVERITY_WARNING,J.i18n("trackchange","REJECT_USER_CHANGES",[e]),J.i18n("trackchange","REJECT_USER_CHANGES_CONFRIM_TEXT",[e]),null,function(e){switch(e){case CONST.BUTTON_YES_CLICKED:r.rejectUserChanges()}})},ee=function(){ModeManager.getCurrentMode()===EDITOR_MODES.COLLABORATE&&G()},te=function(){if(Z(m.REVIEWPANE)&&Z(m.EMPTY_REVIEWPANE)){var e=J(window).innerHeight()-(Z("li-review-tab-header").offset().top+Z("li-review-tab-header").outerHeight())-UIUtils.bottomBar.outerHeight();Z("wmstoolbar").is(":visible")&&(e-=Z("wmstoolbar").outerHeight());var t=Z(m.TC_VIEW_CONT).attr("data-visible");"false"!=t&&(e-=h),Z(m.REVIEWPANE).height(e+"px"),Z(m.EMPTY_REVIEWPANE).height(e+"px")}},ie=function(e){var t=Z(m.REVIEWPANE).find("[data-userid="+e+"]"),i=a.getUserColour(e);t.find("#author_img").css("border-color",i),t.find("#status").css({"border-color":i,color:i})},oe=function(){PubSub.subscribe("Document/TC/NodeRemoved",A),PubSub.subscribe("Document/TC/NodeCreated",y),PubSub.subscribe("Document/TC/NodeUpdated",y),PubSub.subscribe("Document/TC/ModelUpdationStarted",D),PubSub.subscribe("DocOperation/CommandComplete",H),PubSub.subscribe("Document/EditorReady",ee),PubSub.subscribe("Document/TC/UserAdded",x),PubSub.subscribe("Document/TC/UserRemoved",F),PubSub.subscribe("Document/TC/CountUpdated",Y),PubSub.subscribe("Document/TC/CountUpdated",w),PubSub.subscribe("Document/CursorPositionChanged",r.clearFocusingLines),PubSub.subscribe("UiEvents/EditorParentOffsetChanged",r.clearFocusingLines),PubSub.subscribe("Document/Resize",te),PubSub.subscribe("Collaboration/UsercolorUpdated",ie),PubSub.subscribe("Document/UsercolorUpdated",ie),editor.editorPaneContainer.on("scroll",r.clearFocusingLines),Z(m.REVIEWPANE).on("scroll",r.clearFocusingLines)},re=function(){PubSub.unsubscribe("Document/TC/NodeRemoved",A),PubSub.unsubscribe("Document/TC/NodeCreated",y),PubSub.unsubscribe("Document/TC/NodeUpdated",y),PubSub.unsubscribe("Document/TC/ModelUpdationStarted",D),PubSub.unsubscribe("DocOperation/CommandComplete",H),PubSub.unsubscribe("Document/EditorReady",ee),PubSub.unsubscribe("Document/TC/UserAdded",x),PubSub.unsubscribe("Document/TC/UserRemoved",F),PubSub.unsubscribe("Document/TC/CountUpdated",Y),PubSub.unsubscribe("Document/TC/CountUpdated",w),PubSub.unsubscribe("Document/CursorPositionChanged",r.clearFocusingLines),PubSub.unsubscribe("UiEvents/EditorParentOffsetChanged",r.clearFocusingLines),PubSub.unsubscribe("Collaboration/UsercolorUpdated",ie),PubSub.unsubscribe("Document/UsercolorUpdated",ie),editor.editorPaneContainer.off("scroll",r.clearFocusingLines),Z(m.REVIEWPANE).off("scroll",r.clearFocusingLines),r.clearFocusingLines()};return{getNodesToUpdate:O,getNodeElementMap:v,drawRightPane:G,toggleView:X,subscribe:oe,unsubscribe:re,selectRevision:N,unSelectRevision:L,scrollRevisionIntoView:_,showFilterByUser:j,showFilterByView:W,getFilteredNodes:S,updateUserColorInNodes:ie,acceptAll:K,rejectAll:$,acceptUserChanges:q,rejectUserChanges:Q}}(TcManager,TCConstants,TCHandler,TrackChangeUI,TcUtil,Utils,ReviewUtil,DomUtil,ViewManager);TableInsertDlg=function(){},TableInsertDlg.noOfRows=3,TableInsertDlg.noOfColumns=3,TableInsertDlg.openTablePopup=function(){J.dialogutil.open("inserttabledialog",void 0,TableInsertDlg.info)},TableInsertDlg.info={get:function(e,t){return"COLUMNS"==e?TableInsertDlg.noOfColumns:"ROWS"==e?TableInsertDlg.noOfRows:void 0},set:function(e,t,i){"COLUMNS"==e.action?TableInsertDlg.noOfColumns=t:"ROWS"==e.action&&(TableInsertDlg.noOfRows=t)}},TableInsertDlg.insertTable=function(){editor.doc.execCmd("instable",[TableInsertDlg.noOfRows,TableInsertDlg.noOfColumns]),J.dialogutil.close("inserttabledialog")},function(e,t,i){function o(){J("#searchdiv").children().remove(),J("#shortcutabs ul.menutabs li.ui-state-active").find("a").attr("href");var e=J("#shortcutabs ul.menutabs li.ui-state-active").find("a");$(e).bind("click",function(){var t=J(e).attr("href");J(t).css("display","block")})}function r(){return!1}function n(e){return function(t){i.handleDeafaultAutoCorrects(e,t)}}function a(t,i){e.bind(i,n(t),"keypress")}function l(){var e={"( c )":"(c)","( r )":"(r)","( t m )":"(tm)","1 / 4":"1/4","1 / 2":"1/2","3 / 4":"3/4","- - >":"-->","< - -":"<--","< - >":"<->","= = >":"==>","< = =":"<==","< = >":"<=>"};U.each(e,a)}function s(){var i=editor.browserInfo.is_mac?"alt":"ctrl";editor.browserInfo.is_mac?(e.bind("ctrl+shift+up",t.moveParaUp),e.bind("ctrl+shift+down",t.moveParaDown),e.bind("ctrl+down",r),e.bind("ctrl+up",r)):(e.bind("alt+shift+up",t.moveParaUp),e.bind("alt+shift+down",t.moveParaDown)),e.bind("left",t.moveLeft),e.bind(i+"+left",t.moveToPrevWordStart),e.bind("command+left",t.moveToLineStart),e.bind("shift+left",t.selectLeft),e.bind(i+"+shift+left",t.selectToPrevWordStart),e.bind("command+shift+left",t.selectToLineStart),e.bind("right",t.moveRight),e.bind(i+"+right",t.moveToCurrentWordEnd),e.bind("command+right",t.moveToLineEnd),e.bind("shift+right",t.selectRight),e.bind(i+"+shift+right",t.selectToCurrentWordEnd),e.bind("command+shift+right",t.selectToLineEnd),e.bind("down",t.moveDown),e.bind(i+"+down",t.moveToParaEnd),e.bind("command+down",t.moveToDocumentEnd),e.bind("shift+down",t.selectDown),e.bind(i+"+shift+down",t.selectToParaEnd),e.bind("command+shift+down",t.selectToDocumentEnd),e.bind("up",t.moveUp),e.bind(i+"+up",t.moveToParaStart),e.bind("command+up",t.moveToDocumentStart),e.bind("shift+up",t.selectUp),e.bind(i+"+shift+up",t.selectToParaStart),e.bind("command+shift+up",t.selectToDocumentStart),e.bind("pageup",t.moveToPrevPage),e.bind("shift+pageup",t.selectToPrevPage),e.bind("pagedown",t.moveToNextPage),e.bind("shift+pagedown",t.selectToNextPage),e.bind("home",t.moveToLineStart),e.bind(["ctrl+home","meta+home"],t.moveToDocumentStart),e.bind("shift+home",t.selectToLineStart),e.bind(["shift+ctrl+home","shift+meta+home"],t.selectToDocumentStart),e.bind("end",t.moveToLineEnd),e.bind(["ctrl+end","meta+end"],t.moveToDocumentEnd),e.bind("shift+end",t.selectToLineEnd),e.bind(["shift+ctrl+end","shift+meta+end"],t.selectToDocumentEnd),e.bind(["ctrl+alt+shift+j","meta+alt+shift+j"],t.moveToTableStart),e.bind(["ctrl+alt+shift+k","meta+alt+shift+k"],t.moveToTableEnd)}function d(){e.init(document.getElementById("editorpane")),s(),e.bind(["alt+enter"],i.goToLink),editor.browserInfo.is_mac?(e.bind("command+g",function(){return GoToDialogue.openGoToDialogue(),!1}),e.bind("command+shift+g",function(){return WordCountDlg.insertWCDlg(),!1})):(e.bind("ctrl+g",function(){return GoToDialogue.openGoToDialogue(),!1}),e.bind("ctrl+shift+g",function(){return WordCountDlg.insertWCDlg(),!1}));var t=editor.doc.getRole();"SHAREDREAD"!==t&&"SHAREDREADCOMMENT"!==t||Jdocument.bind("keydown",function(e){e.keyCode===KEYS.ESC&&EditorView.isFullView()&&EditorView.exitFullView()}),editor.isEditable()&&(e.bind("ctrl+space",r),editor.browserInfo.is_mac&&e.bind("command+shift+z",function(){return editor.doc.snapShotManager.getLastRedoOp()?(editor.doc.execCmd("redo"),!1):void editor.doc.applyLastAction()}),editor.browserInfo.is_mac?(e.bind("command+y",editor.doc.applyLastAction),e.bind("command+a",function(){return editor.doc.getSelection().selectAll(),!1}),e.bind("command+/",function(){u(),i.addToStatistics("KeyBrdDlgSC")})):(e.bind("ctrl+y",editor.doc.applyLastAction),e.bind("ctrl+a",function(){return editor.doc.getSelection().selectAll(),!1}),e.bind("ctrl+/",function(){u(),i.addToStatistics("KeyBrdDlgSC")})),e.bind(["ctrl+shift+1","meta+shift+1"],function(){editor.doc.execCmd(["SetLineSpacing","1"])}),e.bind(["ctrl+shift+2","meta+shift+2"],function(){editor.doc.execCmd(["SetLineSpacing","2"])}),e.bind(["ctrl+shift+5","meta+shift+5"],function(){editor.doc.execCmd(["SetLineSpacing","1.5"])}),"SHAREDREADCOMMENT"!==t&&"ANYONELINK_SHAREDREADCOMMENT"!==t&&(editor.browserInfo.is_mac?(e.bind("ctrl+shift+d",Dates.insertCurrentDate),e.bind("ctrl+shift+t",Dates.insertCurrentTime),e.bind("command+shift+space",EventHandler.insertNonbreakingSpace),e.bind("ctrl+alt+tab",function(){return TabKeyHandler.insertTab(),!1}),e.bind("command+alt+t",function(){return TrackChangeUI.toggleState(),!1})):(e.bind("alt+shift+d",Dates.insertCurrentDate),e.bind("alt+shift+t",Dates.insertCurrentTime),e.bind("ctrl+shift+space",EventHandler.insertNonbreakingSpace),e.bind("ctrl+alt+t",function(){return TrackChangeUI.toggleState(),!1})),e.bind(["ctrl+shift+f9","meta+shift+f9"],i.removeAllLinks),l()))}function c(){var e=J("#shorcut_search").val().toLowerCase();if(""==e){J("#searchdiv").css("display","none");var t=J("#shortcutabs ul.menutabs li.ui-state-active").find("a").attr("href");J(t).css("display","block")}else J("#searchdiv").children().remove(),J(".ui-pop-content-div:visible").css("display","none"),J("#shortcutabs").find(".ui-key-short-label").each(function(){J(this).text().toLowerCase().indexOf(e)!=-1&&(J("#searchdiv").append(J(this).parent().clone(!0)),J("#searchdiv").css("display","block"))})}function p(){var e=document.createElement("div"),t=editorProps.deployment.zohowriter;J(e).append('<div class="ui-kbsc-title"><b>'+t+" </b><span>Keyboard Shortcut Keys</span></div>");var i=document.createElement("div");J(e).append(i),J("#shortcutabs ul li").find("a").each(function(){var e=J(this).attr("href");if("searchdiv"!=e){var t=document.createElement("h5");J(t).text(J(this).text()),i.appendChild(t);var o=J(e).clone()[0];J(o).removeAttr("style"),i.appendChild(o)}});var o=document.createElement("style");o.type="text/css";var r=".ui-pop-content-div{border-top: 1px solid #000;height: auto;}";r+='.ui-pop-content-div:after{content:"";clear:both;display:block;}',r+=".ui-key-short-pTop{padding: 8px 0px;border-bottom: 1px dotted #ddd;width: 100%;}",r+=".ui-key-short-label{float: left;display:inline-block;width: 64%;}",r+=".ui-key-short-span {color: #666;display: inline-block;text-align: right;width:36%}",r+="h5 {font-size: 18px;margin: 20px 0px 5px 0px;}",r+=".ui-kbsc-title {font-size: 20px;margin: 10px 0px 0px 0px;}",r+=".ui-kbsc-title span {font-family: proxima_nova_light, open_sans_light, sans-serif;}}",r+=".ui-keyboardshortcut-note {font-style: italic;}",o.innerHTML=r,J(e).append(o);var n,a=document.getElementById("zw-shortcuts-print");if(!a){a=document.createElement("iframe"),a.id="zw-shortcuts-print",document.body.appendChild(a),n=a.contentWindow;var l=n.document;l.open(),l.write(e.innerHTML),l.close()}n=n||a.contentWindow,printFrameTimer=setInterval(function(){"complete"===a.contentWindow.document.readyState&&(n.document.body.style.overflow="auto",clearInterval(printFrameTimer),n.print())},0)}function u(){J.dialogutil.open("shortcut",void 0,g),i.addToStatistics("KeyBrdDlg")}function f(e){e.keyCode==KEYS.ENTER&&c()}var g={init:function(){for(var e=J("#shortcutabs li"),t=0;t<e.length;t++)e[t].addEventListener("click",o,!0)}};PubSub.subscribe("Document/EditPermissionChanged",d),this.KeyBoardShortCuts={init:d,searchShortCuts:c,keyDown:f,openKeyBoardShortcutDialog:u,printShortCuts:p}}(Mousetrap,NavUtil,Utils);var hipurl;WebUtil.saveDocumentCurrentVersions=function(e){var t={};t.sid=editor.uuid,t.tstamp=(new Date).getTime(),Utils.setCsrfParam(t);var i=Utils.getUrl("save");"REMOTE"==editor.getEditorType()?t.rsid=RemoteEditor.rsid:t.rid=editor.doc.getDocInfo().RID,J.ajax({type:"POST",dataType:"json",global:!1,url:i,data:t,error:function(){UIUtils.hideLoadingMsg()},success:function(t){return UIUtils.hideLoadingMsg(),"FAILED"==t.SAVE?(editor.setEditable(!1),PubSub.publish("Document/SaveStatus",!1,J.i18n("writer.common.SAVE_FAILURE")),void PubSub.publish("Document/Error",{title:"OOPS",errorNo:ZWCollaboration.SERVER_EXCEPTION,errorMsg:"MSG_EDIT_ERROR"})):void(e&&e(t))}})},WebUtil.notifyCollaborators=function(){Utils.addToStatistics("Notify"),NotifyCollaborator.open(editor.doc.getDocInfo().RID)},WebUtil.checkOutDocument=function(){var e={};e.rid=Utils.getDocumentId(),Utils.setCsrfParam(e);var t=setTimeout(function(){UIUtils.showMessage("info",J.i18n("common","PAUSE_COLLABORATION_PROCESSING"),"showclose","normalfont")},1e3);J.ajax({type:"POST",global:!1,url:Utils.getUrl("checkout"),data:e,dataType:"json",error:function(){clearTimeout(t),UIUtils.showMessage("error",J.i18n("common","UNABLE_TO_PROCESS_PAUSE_COLLABORATION"),"showclose","normalfont",5e3),J("#pausecollab").prop("checked")?J("#pausecollab").prop("checked",!1):J("#pausecollab").prop("checked",!0)},success:function(e){if(clearTimeout(t),"SUCCESS"==e.RESPONSE){e&&e.VERSION&&e.REVISION&&(editor.doc.getDocInfo().VERSION=e.VERSION,editor.doc.getDocInfo().REVISION=e.REVISION);var i=e.ACTION;"CHECKEDIN"==i?(UIUtils.showMessage("info",J.i18n("common","CHECKIN_SUCCESS"),"showclose","normalfont",3e3),UIUtils.handleDocumentCheckIn(editor.zuid,editor.loginName,!1)):"CHECKEDOUT"!=i&&"ALREADY_CHECKEDOUT"!=i||(UIUtils.showMessage("info",J.i18n("common","CHECKOUT_SUCCESS"),"showclose","normalfont",3e3),UIUtils.handleDocumentCheckOut(editor.zuid,editor.loginName,!1,!1)),Utils.addToStatistics("CheckOut")}else if("FAILED"==e.RESPONSE){var i="CHECKEDOUT"==e.ACTION?"CHECKOUT_FAILURE":"CHECKIN_FAILURE";UIUtils.showMessage("error",J.i18n("common",i),"showclose","normalfont",3e3)}}})},WebUtil.listNumberingInfo={get:function(e){if("listNumber"==e){var t,i=editor.doc.getSelection().paraFormat.ls_data.id,o=editor.doc.getSelection().paraFormat.ls_data,r=editor.doc.getSelection().paraFormat.ls_data.l,n=editor.doc.getListType(i,r);r>0&&(t=List.getLevelZeroType(o));var a=J("#inputtxt");a.on("keyup",function(e){var t=J(this).val();if(0==n){var i=/^\d*[0-9]$/;return i.test(t)?(J("#errmsg").hide(),J("#applybtn1").enable(),!0):(J("#errmsg").show().html(UIUtils.getErrorMsg("error",J.i18n("common","ONLY_POSITIVE"))),J("#applybtn1").disable(),!1)}if(4==n||3==n){var o=/^\s*[a-zA-Z0-9]+\s*$/;return o.test(t)?(J("#errmsg").hide(),J("#applybtn1").enable(),!0):(J("#errmsg").show().html(UIUtils.getErrorMsg("error",J.i18n("common","ONLY_ALPHANUMERIC"))),J("#applybtn1").disable(),!1)}if(1==n||2==n){if(isNaN(t)){t=t.toUpperCase();var r=/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/;return r.test(t)?(J("#errmsg").hide(),J("#applybtn1").enable(),!0):(J("#errmsg").show().html(UIUtils.getErrorMsg("error",J.i18n("common","ONLY_ROMAN_NUMERIC"))),J("#applybtn1").disable(),!1)}var i=/^\d*[0-9]$/;return i.test(t)?(J("#errmsg").hide(),J("#applybtn1").enable(),!0):(J("#errmsg").show().html(UIUtils.getErrorMsg("error",J.i18n("common","ONLY_ROMAN_NUMERIC"))),J("#applybtn1").disable(),!1)}});var l=editor.doc.getListObj(i)["level"+r].startsWith;if(0==n)if(0==l)l=0;else{var s,d;d=l.toString(),s=d.replace(/\b0+/g,""),l=parseInt(s)}var c;return c=3==n||4==n?List.getStartsWith(n,l,o):1==n||2==n?List.getStartsWith(n,l,o):l}},set:function(e,t,i){"listNumber"==e.action&&(this.numberValue=t)},apply:function(){var e=editor.doc.getSelection().paraFormat.ls_data.id,t=editor.doc.getSelection().paraFormat.ls_data.l,i=(editor.doc.getSelection().paraFormat.ls_data,editor.doc.getListType(e,t));if(!isNaN(this.numberValue))if(0==this.numberValue)this.numberValue=0;else{var o,r,n;n=this.numberValue,r=n.toString(),o=r.replace(/\b0+/g,""),this.numberValue=parseInt(o)}0!=i&&isNaN(this.numberValue)&&(3==i||4==i?this.numberValue=List.AlphatoNumber(this.numberValue):1!=i&&2!=i||(this.numberValue=List.AlphatoRoman(this.numberValue))),editor.doc.execCmd("updateLevelNumbering",[e,t,this.numberValue]),J.dialogutil.close("listnumberingstart"),delete this.numberValue}},WebUtil.listPrefixSuffixInfo={init:function(){var e={action:"prefix"},t={action:"suffix"};J("#prefixInputTxt").donetyping(function(){WebUtil.listPrefixSuffixInfo.set(e,this.value,J(this))},50),J("#suffixInputTxt").donetyping(function(){WebUtil.listPrefixSuffixInfo.set(t,this.value,J(this))},50)},get:function(e){var t,i=editor.doc.getSelection(),o=i.getFirstRange(),r=editor.doc.getNodesInSelection(NODE_TYPE.PARAGRAPH,o.start,o.end),n=r[0].dtNode.paraProperties.listData,a=(r[0].dtNode.paraProperties.isHeadingList,n.id),l=n.listLevel,s=editor.doc.getListChar(a,l),d=-1;if(s)for(var c,p=0;c=ListLevelNo[p++];)if(d=J.inArray(c,s),d>-1){t=s.replace(c,"");break}return"prefix"==e?(d>0?this.prefix=s.substring(0,d):(J(".prefixInput").attr("placeholder","Add Prefix"),this.prefix=""),WebUtil.prefixSuffixValues.prefix=WebUtil.newPrefixSuffixValues.prefix=this.prefix,U.unescape(this.prefix)):"suffix"==e?(d!=-1?this.suffix=s.substring(d+1,s.length):(J(".suffixInput").attr("placeholder","Add Suffix"),this.suffix=""),WebUtil.prefixSuffixValues.suffix=WebUtil.newPrefixSuffixValues.suffix=this.suffix,U.unescape(this.suffix)):"listnumlabel"==e?(this.listNumLabel=WebUtil.prefixSuffixValues.listNum=WebUtil.newPrefixSuffixValues.listNum=List.getStartsWith(n.listType,n.levelInfo["level"+n.listLevel],n,!0),this.listNumLabel):"applyToEntireList"==e?(WebUtil.prefixSuffixValues.isEntireList=WebUtil.newPrefixSuffixValues.isEntireList=this.isEntireList=WebUtil.prefixSuffixValues.isEntireList?WebUtil.prefixSuffixValues.isEntireList:0,this.isEntireList):void 0},set:function(e,t,i){t=U.escape(t),"prefix"==e.action&&(0==t.length&&J(".prefixInput").attr("placeholder","Add Prefix"),this.prefix=WebUtil.newPrefixSuffixValues.prefix=t,WebUtil.updateListPreview()),"suffix"==e.action?(0==t.length&&J(".suffixInput").attr("placeholder","Add Suffix"),this.suffix=WebUtil.newPrefixSuffixValues.suffix=t,WebUtil.updateListPreview()):"applyToEntireList"==e.action&&(this.isEntireList=WebUtil.newPrefixSuffixValues.isEntireList=t?1:0)},apply:function(){if(!Utils.compareJSON(WebUtil.prefixSuffixValues,WebUtil.newPrefixSuffixValues)){var e=editor.doc.getSelection(),t=e.getFirstRange(),i=editor.doc.getNodesInSelection(NODE_TYPE.PARAGRAPH,t.start,t.end),o=i[0].dtNode.paraProperties.listData,r=o.id,n=o.listLevel;editor.doc.getListChar(r,n);editor.doc.execCmd("updateListPrefixAndSuffix",[r,n,this.prefix,this.suffix,this.isEntireList])}J.dialogutil.close("listprefixsuffix"),delete this.prefix,delete this.suffix}},WebUtil.updateListPreview=function(){var e=WebUtil.newPrefixSuffixValues.prefix+WebUtil.newPrefixSuffixValues.listNum+WebUtil.newPrefixSuffixValues.suffix;J("#prefSufPreview").html(e)},WebUtil.updateLevelNumbering=function(e){editor.doc.execCmd("updateLevelNumbering",e)},WebUtil.showNumberedList=function(){J.dialogutil.open("listnumberingstart",void 0,WebUtil.listNumberingInfo)},WebUtil.showPrefixSuffixDialog=function(){WebUtil.prefixSuffixValues={},WebUtil.newPrefixSuffixValues={},J.dialogutil.open("listprefixsuffix",void 0,WebUtil.listPrefixSuffixInfo)},WebUtil.TocMenuHTML={classic:{showNo:!0,level:3,leader:1,case:["small","small","small","small","small","small"]},contemporary:{showNo:!0,level:3,leader:0,case:["caps","caps","caps","small","small","small"]},formal:{showNo:!0,level:3,leader:1,case:["caps","caps","small","small","small","small"]},modern:{showNo:!0,level:3,leader:1,case:["small","small","small","small","small","small"]},simple:{showNo:!0,level:3,leader:0,case:["small","small","small","small","small","small"]}},WebUtil.getTocTheme=function(e,t){var o={},r=t.case,n=t.showNo,a=t.level,l=t.leader;for(i=0;i<r.length;i++)if("small"===r[i]){var s=i+1;o[s]=J.i18n("writer.common.TOC.HEADING"+s+"SMALL")}else{var s=i+1;o[s]=J.i18n("writer.common.TOC.HEADING"+s)}var d='<div class="ui-toc-presetmenu ui-toc-'+e+'">';for(i=0;i<r.length;i++){var s=i+1,c=i+1;"modern"===e&&i>0&&(c=s-1),d+=i<a?1==i&&"modern"===e?'<div class="ui-toc-head'+c+'" style="color:grey;">':'<div class="ui-toc-head'+c+'">':'<div class="ui-toc-head'+c+'" style="display:none">',void 0===l?d+=o[s]+'<span class="ui-toc-dotted-span"></span>':1===l?d+=o[s]+'<span style ="border-bottom:1px dotted #000;display:inline-block;margin:0px 5px"></span>':2===l?d+=o[s]+'<span style ="border-bottom:1px dashed #000;display:inline-block;margin:0px 5px"></span>':3===l?d+=o[s]+'<span style ="border-bottom:1px solid #000;display:inline-block;margin:0px 5px"></span>':0===l&&(d+=o[s]+'<span style ="display:inline-block;margin:0px 5px"></span>'),n&&(d+=s),d+="</div>"}return d+="</div>"},WebUtil.constructTocMenu=function(){var e,t={},i=J("#tocmenu");for(e in WebUtil.TocMenuHTML){var o=J.i18n("writer.common."+e.toUpperCase());t={mtype:"radio",name:"tocType",title:o,data:"{'appData':{'action':'editor.doc.execCmd','params':['inserttoc', '"+e+"']}}"},t.html={},t.html.content=WebUtil.getTocTheme(e,WebUtil.TocMenuHTML[e]),i.zmenu("addMenuItem",t)}var t={mtype:"separator"};i.zmenu("addMenuItem",t);var r={mtype:"group",type:"text_only",menuItems:[{label:"More Options...",con:"options__aicon",data:"{'appData':{'icon':'ui-show-toolbar-icon ui-icon-zreflections','action':'TocDialog.openTocSettingsDlg'}}"}]};i.zmenu("addMenuItem",r)},WebUtil.ListMenuHTML={},WebUtil.ListMenuHTML[LIST_TYPE.NONE]='<div id="ui-zlist5" class="ui-list-header-presetmenu"> <div><span class="ui-list-line ui-list-bullet-none"></span></div> <div><span class="ui-list-line ui-list-bullet-none"></span></div> <div><span class="ui-list-line ui-list-bullet-none"></span></div> </div>',WebUtil.ListMenuHTML[LIST_TYPE.DISC]='<div id="ui-zlist6" class="ui-list-header-presetmenu"> <div><span class="ui-list-bullet-disc"></span><span class="ui-list-line"></span></div> <div><span class="ui-list-bullet-disc"></span><span class="ui-list-line"></span></div> <div><span class="ui-list-bullet-disc"></span><span class="ui-list-line"></span></div> </div>',WebUtil.ListMenuHTML[LIST_TYPE.CIRCLE]='<div id="ui-zlist7" class="ui-list-header-presetmenu"> <div><span class="ui-list-bullet-circle"></span><span class="ui-list-line"></span></div> <div><span class="ui-list-bullet-circle"></span><span class="ui-list-line"></span></div> <div><span class="ui-list-bullet-circle"></span><span class="ui-list-line"></span></div> </div>',WebUtil.ListMenuHTML[LIST_TYPE.BOX]='<div id="ui-zlist8" class="ui-list-header-presetmenu"> <div><span class="ui-list-bullet-box"></span><span class="ui-list-line"></span></div> <div><span class="ui-list-bullet-box"></span><span class="ui-list-line"></span></div> <div><span class="ui-list-bullet-box"></span><span class="ui-list-line"></span></div> </div>',WebUtil.ListMenuHTML[LIST_TYPE.DECIMAL]='<div id="ui-zlist0" class="ui-list-header-presetmenu"> <div>1.<span class="ui-list-line"></span></div> <div>2.<span class="ui-list-line"></span></div> <div>3.<span class="ui-list-line"></span></div> </div>',WebUtil.ListMenuHTML[LIST_TYPE.LOWER_ALPHA]='<div id="ui-zlist1" class="ui-list-header-presetmenu"> <div>a.<span class="ui-list-line"></span></div> <div>b.<span class="ui-list-line"></span></div> <div>c.<span class="ui-list-line"></span></div> </div>',WebUtil.ListMenuHTML[LIST_TYPE.UPPER_ALPHA]='<div id="ui-zlist2" class="ui-list-header-presetmenu"> <div>A.<span class="ui-list-line"></span></div> <div>B.<span class="ui-list-line"></span></div> <div>C.<span class="ui-list-line"></span></div> </div>',WebUtil.ListMenuHTML[LIST_TYPE.LOWER_ROMAN]='<div id="ui-zlist3" class="ui-list-header-presetmenu"> <div>i.<span class="ui-list-line"></span></div> <div>ii.<span class="ui-list-line"></span></div> <div>iii.<span class="ui-list-line"></span></div> </div>',WebUtil.ListMenuHTML[LIST_TYPE.UPPER_ROMAN]='<div id="ui-zlist4" class="ui-list-header-presetmenu"> <div>I.<span class="ui-list-line"></span></div> <div>II.<span class="ui-list-line"></span></div> <div>III.<span class="ui-list-line"></span></div> </div>',WebUtil.ListMenuHTML.hlist16='<div id="ui-headlist0" class="ui-list-header-presetmenu"> <div class="ui-head1">'+J.i18n("writer.common.LIST.ARTICLE")+'<span class="ui-li-lbl-margin">'+J.i18n("writer.common.TOC.HEADING1SMALL")+'</span></div> <div class="ui-head2">'+J.i18n("writer.common.LIST.SECTION")+'<span class="ui-li-lbl-margin">'+J.i18n("writer.common.TOC.HEADING2SMALL")+'</span></div> <div class="ui-head3">(a)<span class="ui-li-lbl-margin">'+J.i18n("writer.common.TOC.HEADING3SMALL")+'</span><span class="ui-head-line"></span></div> </div>',WebUtil.ListMenuHTML.hlist17='<div id="ui-headlist1" class="ui-list-header-presetmenu"> <div class="ui-head1">1.<span class="ui-li-lbl-margin">'+J.i18n("writer.common.TOC.HEADING1SMALL")+'</span><span class="ui-head-line"></span></div> <div class="ui-head2">1.1<span class="ui-li-lbl-margin">'+J.i18n("writer.common.TOC.HEADING2SMALL")+'</span><span class="ui-head-line"></span></div> <div class="ui-head3">1.1.1<span class="ui-li-lbl-margin">'+J.i18n("writer.common.TOC.HEADING3SMALL")+'</span><span class="ui-head-line"></span></div> </div>',WebUtil.ListMenuHTML.hlist18='<div id="ui-headlist2" class="ui-list-header-presetmenu"> <div class="ui-head1">I.<span class="ui-li-lbl-margin">'+J.i18n("writer.common.TOC.HEADING1SMALL")+'</span><span class="ui-head-line"></span></div> <div class="ui-head2 ui-head2-2">A.<span class="ui-li-lbl-margin">'+J.i18n("writer.common.TOC.HEADING2SMALL")+'</span><span class="ui-head-line"></span></div> <div class="ui-head3 ui-head2-3">1.</span><span class="ui-li-lbl-margin">'+J.i18n("writer.common.TOC.HEADING3SMALL")+'</span><span class="ui-head-line"></span></div> </div>',WebUtil.ListMenuHTML.hlist19='<div id="ui-headlist3" class="ui-list-header-presetmenu"> <div class="ui-head1 ui-head3-1">'+J.i18n("writer.common.LIST.CHAPTER")+'<span class="ui-li-lbl-margin">'+J.i18n("writer.common.TOC.HEADING1SMALL")+"</span></div> <div><span>"+J.i18n("writer.common.TOC.HEADING2SMALL")+'</span><span class="ui-head-line"></span></div> <div class="ui-head3"><span>'+J.i18n("writer.common.TOC.HEADING3SMALL")+'</span><span class="ui-head-line"></span></div> </div>',WebUtil.ListMenuHTML.hlist0='<div id="ui-headlist4" class="ui-list-header-presetmenu"> <div class="ui-head1"><span>'+J.i18n("writer.common.TOC.HEADING1SMALL")+'</span><span class="ui-head-line"></span></div> <div class="ui-head2"><span>'+J.i18n("writer.common.TOC.HEADING2SMALL")+'</span><span class="ui-head-line"></span></div> <div class="ui-head3"><span>'+J.i18n("writer.common.TOC.HEADING3SMALL")+'</span><span class="ui-head-line"></span></div> </div>',WebUtil.constructListMenu=function(e,t){t.target=J(t.target).parent().hasClass("ui-zmenu-splitgroup")?J(J(t.target).prev().data("relatedButton")):J(t.target);var i=J(t.target).metadata().appData.type,o=J("#bullettypemenu"),r=0,n=4;if("ORDER"===i?(r=4,n=9):"HEADING"===i?(r=9,n=14):"ALL"===i&&(r=0,n=9),"ALL"===i?o.addClass("ui-smarttoolbar-bullets"):o.removeClass("ui-smarttoolbar-bullets"),!o.children().length){var a={UNORDER:[{type:LIST_TYPE.DISC},{type:LIST_TYPE.CIRCLE},{type:LIST_TYPE.BOX},{type:LIST_TYPE.NONE}],ORDER:[{type:LIST_TYPE.DECIMAL},{type:LIST_TYPE.LOWER_ALPHA},{type:LIST_TYPE.UPPER_ALPHA},{type:LIST_TYPE.LOWER_ROMAN},{type:LIST_TYPE.UPPER_ROMAN}],HEADING:[{type:"hlist16"},{type:"hlist17"},{type:"hlist18"},{type:"hlist19"},{type:"hlist0"}]};for(i in a)J.each(a[i],function(){var e=this.type;"HEADING"===i&&(e=e.substring("hlist".length));var t={icon:"ui-zlisttype-items ui-zlist"+e,mtype:"radio",name:"listType",data:"{'appData':{'action':"+("HEADING"===i?"'editor.doc.execCmd'":"'List.applyListStyle'")+",'params':"+("HEADING"===i?"0"===e?"'removeHeadingList'":"['hlist', '"+e+"']":e)+"}}"};WebUtil.ListMenuHTML[this.type]&&(delete t.icon,t.html={},t.html.content=WebUtil.ListMenuHTML[this.type]),J("#bullettypemenu").zmenu("addMenuItem",t)})}o.children().hide().slice(r,n).show()},WebUtil.nciku=function(){var e=editor.doc.getSelection(),t=e.isCollapsed()?e.getWord():e.getNextWord();t.select();var i=e.getSelectedText(e.getStart(),e.getEnd()),o=editorProps.deployment.zohowriter;if(""!=i){var r="width=500,height=500,scrollbars=yes,resizable=no,toolbar=no,directories=no,menubar=no,copyhistory=no,status=no,location=no",n="http://ce.linedict.com/dict.html#/cnen/search?query="+encodeURI(i),a=window.open(n,"Nciku",r);a.moveTo(250,150),a.focus()}else MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,null,o,J.i18n("writer.common.PLEASESELECTSOMETEXT"))},WebUtil.saveStorageService=function(){var e={};e.rid=Utils.getDocumentId(),Utils.setCsrfParam(e),J.ajax({type:"POST",global:!1,async:!1,dataType:"json",url:Utils.getContextUrl("v1/web/gdrive/savestorage"),data:e,error:function(){UIUtils.showLoadingMsg(J.i18n("writer.remotesave.SAVE_FAILURE_MSG"),3e3)},success:function(e){var t=e.statusCode;e.statusValue;"200"===t?UIUtils.showLoadingMsg(J.i18n("writer.remotesave.SUCCESS"),3e3):UIUtils.showLoadingMsg(J.i18n("writer.remotesave.SAVE_FAILURE_MSG"),3e3)}})},WebUtil.clrError=function(){J("#errormsg").show().html(""),J("#errormsg").css("display","none")};var FontCombo=function(){"use strict";var e=[],t=[],i=[],o=4,r={"fmt-lpnl-fontfamily":{recentFontsOptGroup:"recentfonts",allFontsOptGroup:"AllFonts"},smart_fontFamily:{recentFontsOptGroup:"smart_recentfonts",allFontsOptGroup:"smartAllFonts"},"shapepanel-fontFamily":{recentFontsOptGroup:"shape_recentfonts",allFontsOptGroup:"shapeAllFonts"},"dropcap-fontfamily":{recentFontsOptGroup:"dropcap_recentfonts",allFontsOptGroup:"dropcapAllFonts"}},n=["fmt-lpnl-fontsize","smart_fontSize","shape_fontSize"],a=function(){return editor.doc.getDefaultFontSizeList()},l=function(){for(var e=a(),t=0,i=e.length;t<i;t++)for(var o=e[t],r={label:o,value:o,position:t},l=0,s=n.length;l<s;l++)Z(n[l]).zcombo("addOption",r)},s=function(){if(0==t.length){for(var e,i=Z("fmt-lpnl-fontsize").find("option"),o=0;e=i[o++];)t.push(parseFloat(e.value,10));t=U.unique(t)}return t.slice(0)},d=function(e){t.push(e),t.sort(function(e,t){return e-t});for(var i=t.indexOf(e),o={label:e,value:e,position:i},r=0,a=n.length;r<a;r++)Z(n[r]).zcombo("addOption",o)},c=function(){if(0==e.length){for(var t,i=Z("fmt-lpnl-fontfamily").find("option"),o=0;t=i[o++];)e.push(t.value);e=U.unique(e)}return e.slice(0)},p=function(t){var i=t.toLowerCase();e.push(i);var o={label:t,value:i,style:"font-family:"+i+";"};for(var n in r){var a=r[n];o.optionGroup=Z(a.allFontsOptGroup),Z(n).zfontcombo("addOption",o)}},u=function(t){var i=e.indexOf(t);e.splice(i,1);for(var o in r)Z(o).zfontcombo("removeOption",t)},f=function(e){for(var t=e.toLowerCase(),i=t.split(",")[0],o=c(),r=o.length,n=0;n<r;n++){var a=o[n].toLowerCase(),l=a.split(",")[0];if(l==i)return a}return""},g=function(e){if(!/zwminor|zwmajor/.test(e.value)){var t=i.length;if(0==t)m();else{var r=i.indexOf(e.value);r!=-1?h(r):t>=o&&h(o-1)}T(e)}},m=function(){var e={label:"Recent Fonts",position:"0",options:[]};for(var t in r){var i=r[t];e.id=i.recentFontsOptGroup,Z(t).zfontcombo("addOption",[e])}},h=function(e){if(!(e<0)){var t=i.splice(e,1)[0];for(var o in r){var n=r[o];Z(o).zfontcombo("removeOptGroupOption",t,n.recentFontsOptGroup)}}},T=function(e){i.unshift(e.value);var t={label:e.name,value:e.value,position:0,style:"font-family:"+e.value+";"};for(var o in r){var n=r[o];t.optionGroup=Z(n.recentFontsOptGroup),Z(o).zfontcombo("addOption",t)}},E=function(){for(var e,t=U.sortBy(WebFonts.userWebFonts),i=c(),o=0,r=t.length;o<r;o++)e=t[o],e&&!i.contains(e)&&p(e)},R=function(){E(),l()};return PubSub.subscribe("Document/FirstTimeComponentReady",R),{getDefaultFontSizeList:a,getFontSizeList:s,addFontSize:d,getFontList:c,addFont:p,removeFont:u,getFontStr:f,updateRecentFonts:g}}(),Toolbar=function(){var e={},t=function(t,i,o){if(t&&o&&i!==o){var r=e[t],n=r[i]||{},a=n.hideList||[],l=n.disableList||[],s=r[o]||{},d=s.hideList||[],c=s.disableList||[];if(i){var p=a.filter(function(e){return d.indexOf(e)==-1}),u=d.filter(function(e){return a.indexOf(e)==-1}),f=l.filter(function(e){return c.indexOf(e)==-1}),g=c.filter(function(e){return l.indexOf(e)==-1});a=p,d=u,l=f,c=g;for(var m=0,h=a.length;m<h;m++){var T=a[m];PopupHandler.isPinned("smartToolbar")?SmartToolbar.updateSmartToolbarPositionIfPinned("show",T):Z(T).show()}for(var m=0,h=l.length;m<h;m++)Z(l[m]).enable()}for(var m=0,h=d.length;m<h;m++){var T=d[m];PopupHandler.isPinned("smartToolbar")?SmartToolbar.updateSmartToolbarPositionIfPinned("hide",T):Z(T).hide()}for(var m=0,h=c.length;m<h;m++)Z(c[m]).disable()}},i=function(t,i){t&&i&&(e[t]=i)},o=function(t){t&&delete e[t]},r=function(e,t){if(e&&t&&t.length>0){var i=FontCombo.getFontSizeList(),o=i.indexOf(e);o==-1&&FontCombo.addFontSize(e),t.zcombo("setValue",e)}},n=function(e,t){if(e&&t&&t.length>0){var i=FontCombo.getFontStr(e);i||(i=e.toLowerCase(),FontCombo.addFont(e)),t.zfontcombo("setValue",i),t.zfontcombo("refresh")}},a=function(){try{UIUtils.toggleLockBtnAndInserts(),UIUtils.updateBookMarkButton();var e=DocUtil.copyStyle(editor.doc.getSelection().getParaFormat());e[ATTR_PARAGRAPH.PS_AL]=e[ATTR_PARAGRAPH.PS_AL]||0;var t=editor.doc.getSelection().getComputedTextFormat(),i=["#bold","#smart_bold","#italic","#smart_italic","#underline","#smart_underline","#subscript","#superscript","#strikethrough","#smart_strikethrough"];UIUtils.uiTextAlignment.zbutton()&&UIUtils.uiTextAlignment.zbutton("check","#LEFT"),UIUtils.uiTextAlignment.zbutton("check","#pcm-left"),UIUtils.uiTextAlignment.zbutton("check","#sub-LEFT"),l(0),UIUtils.uiParaDir.zbutton("check","#fmt-lpnl-sub-dirltr"),J("#rtlmenu").zmenu("check","#fmt-lpnl-dirltr",!0),UIUtils.uiFontStyle.zbutton("changeLabel","Normal"),J("#fmt-lpnl-headingmenulist").zmenu("check","#contentHeading0",!0);var o=J("#paraPropformat_headingStyle");o.zcombo("setValue","0"),UIUtils.uiBulletsAndIndent.find("#fmt-lpnl-list-number,#fmt-lpnl-list-bullet").parent().removeClass("ui-state-highlight");var a=J(".js-sel-undo"),s=J(".js-sel-redo");editor.doc.snapShotManager.isUndoQueueEmpty()?(Z("fmt-lpnl-undo").disable(),a.disable()):(Z("fmt-lpnl-undo").enable(),a.enable()),editor.doc.snapShotManager.isRedoQueueEmpty()?(Z("fmt-lpnl-redo").disable(),s.disable()):(Z("fmt-lpnl-redo").enable(),s.enable()),editor.doc.getSelection().isCollapsed()?UIUtils.uiCopyButton.prop("disable",!0):UIUtils.uiCopyButton.prop("enable",!0);var d=editor.doc.getSelection().parents(NODE_TYPE.PARAGRAPH);InsertShape.updateDropcapButton(d);var c,p=editor.doc.getSelection().textFormat;if(p[ATTR_TEXT.TS_FF])c=p[ATTR_TEXT.TS_FF];else{var u=d&&d.attr(ATTR_PARAGRAPH.PS_HD);c=u?OrigDocStyleObject[ATTR_BODY.DS_PARA]["h"+u].textFormat.ff:OrigDocStyleObject[ATTR_BODY.DS_PARA].h0.textFormat.ff,c=c?c:"zwminor"}var f=9;UIUtils.uiSmartToolbar.zbutton("uncheck",i.join());for(var g in t)if(t.hasOwnProperty(g)&&"type"!=g){var m=t[g];g==ATTR_TEXT.TS_FW&&"bold"==m?(UIUtils.uiPortionStyles.zbutton("check","#bold"),i.splice(i.indexOf("#bold"),1),UIUtils.uiSmartToolbar.zbutton("check","#smart_bold"),i.splice(i.indexOf("#smart_bold"),1)):g==ATTR_TEXT.TS_FS&&"italic"==m?(UIUtils.uiPortionStyles.zbutton("check","#italic"),i.splice(i.indexOf("#italic"),1),UIUtils.uiSmartToolbar.zbutton("check","#smart_italic"),i.splice(i.indexOf("#smart_italic"),1)):g==ATTR_TEXT.TS_VA&&"super"==m?(UIUtils.uiPortionStyles.zbutton("check","#superscript"),i.splice(i.indexOf("#superscript"),1)):g==ATTR_TEXT.TS_VA&&"sub"==m?(UIUtils.uiPortionStyles.zbutton("check","#subscript"),i.splice(i.indexOf("#subscript"),1)):g==ATTR_TEXT.TS_TD&&"none"!=m||m&&"link"==m?((m.indexOf("underline")>=0||m.indexOf("link")>=0)&&(UIUtils.uiPortionStyles.zbutton("check","#underline"),i.splice(i.indexOf("#underline"),1),UIUtils.uiSmartToolbar.zbutton("check","#smart_underline"),i.splice(i.indexOf("#smart_underline"),1)),m.indexOf("line-through")>=0&&(UIUtils.uiPortionStyles.zbutton("check","#strikethrough"),i.splice(i.indexOf("#strikethrough"),1),UIUtils.uiSmartToolbar.zbutton("check","#smart_strikethrough"),i.splice(i.indexOf("#smart_strikethrough"),1))):g==ATTR_TEXT.TS_SIZE&&(m=parseFloat(m),isNaN(m)||(f=m))}UIUtils.uiPortionStyles.zbutton("uncheck",i.join());for(var g in e)if(e.hasOwnProperty(g)&&"type"!=g){var m=e[g];if(g==ATTR_PARAGRAPH.PS_HD&&m>0)m=parseInt(m),m&&(UIUtils.uiFontStyle.zbutton("changeLabel",PARA_TAG_MAPPING[m]),J("#fmt-lpnl-headingmenulist").zmenu("check","#contentHeading"+m,!0),o.zcombo("setValue",m));else if(g==ATTR_PARAGRAPH.PS_AL&&0==m)e.dir==PARA_DIR.RTL?(UIUtils.uiTextAlignment.zbutton("check","#RIGHT"),UIUtils.uiTextAlignment.zbutton("check","#pcm-right"),UIUtils.uiTextAlignment.zbutton("check","#sub-RIGHT"),l(2)):(UIUtils.uiTextAlignment.zbutton("check","#LEFT"),UIUtils.uiTextAlignment.zbutton("check","#pcm-left"),UIUtils.uiTextAlignment.zbutton("check","#sub-LEFT"),l(0));else if(g==ATTR_PARAGRAPH.PS_AL&&1==m)UIUtils.uiTextAlignment.zbutton("check","#CENTER"),UIUtils.uiTextAlignment.zbutton("check","#pcm-center"),UIUtils.uiTextAlignment.zbutton("check","#sub-CENTER"),l(1);else if(g==ATTR_PARAGRAPH.PS_AL&&2==m)e.dir==PARA_DIR.RTL?(UIUtils.uiTextAlignment.zbutton("check","#LEFT"),UIUtils.uiTextAlignment.zbutton("check","#pcm-left"),UIUtils.uiTextAlignment.zbutton("check","#sub-LEFT"),l(0)):(UIUtils.uiTextAlignment.zbutton("check","#RIGHT"),UIUtils.uiTextAlignment.zbutton("check","#pcm-right"),UIUtils.uiTextAlignment.zbutton("check","#sub-RIGHT"),l(2));else if(g==ATTR_PARAGRAPH.PS_AL&&3==m)UIUtils.uiTextAlignment.zbutton("check","#JUSTIFY"),UIUtils.uiTextAlignment.zbutton("check","#pcm-justify"),UIUtils.uiTextAlignment.zbutton("check","#sub-JUSTIFY"),l(3);else if(g==ATTR_PARAGRAPH.PS_TYPE&&"list"==m){var h=e[ATTR_PARAGRAPH.LS_DATA],T=h.id,E=h.l,R=editor.doc.getListType(T,E);R<6?UIUtils.uiBulletsAndIndent.find("#fmt-lpnl-list-number").parent().addClass("ui-state-highlight"):UIUtils.uiBulletsAndIndent.find("#fmt-lpnl-list-bullet").parent().addClass("ui-state-highlight")}else g==ATTR_PARAGRAPH.PS_DIR&&m==PARA_DIR.RTL&&(UIUtils.uiParaDir.zbutton("check","#fmt-lpnl-sub-dirrtl"),J("#rtlmenu").zmenu("check","#fmt-lpnl-dirrtl",!0))}n(c,UIUtils.defaultFontFamily),r(f,UIUtils.defaultFontSize),PubSub.publish("EditorEvents/ToolbarUpdateComplete")}catch(e){}},l=function(e){var t=J("#smart-textalign");t.zcombo("setValue",e);var i=J("#pcm-textalign");i.zcombo("setValue",e)};return PubSub.subscribe(["Cursor/Collapsed","Cursor/Selected","Document/FirstTimeComponentReady"],a,{async:!0,timeout:500}),{updateToolset:t,addToolsetToCollection:i,removeToolsetFromCollection:o,updateFontSize:r,updateFontFamily:n,updateToolbar:a}};Toolbar=Toolbar(),function(e){e.ZToolbarHandler={init:function(){this._bindEvents()},_bindEvents:function(){var t=this,i=e("#inlineDatemenu,#panel-container,#topband-default,#footerContainer,#review-tb,#review_Rightpane,#paraPropWrapper,#microtoolbardialog,#complete-tb,#topband-history,#topband-history-compare,#bottombar,#topband-mailmerge,#mm-preview-toolbar,#embedObject,#readcomment-tb,#readonly-tb,#mm-preview-btn-printcurr,#mm-preview-listcont,#esign-pdf-viewer,#fmt-lpnl-sub-pc-container,#toolbar-versionview,#ui-reader-popup,#ins-col-before,#ins-col-after,#del-col,#ins-row-before,#ins-row-after,#del-row,#row-show-smarttoolbar,#col-show-smarttoolbar");i.find(":checkbox").on("click",function(i,o){var r=e(i.target);t._handleEvents(r,o)}),i.on("click",function(i,o){var r=e(i.target),n=o&&o.fromShortCut,a=n||r.hasClass("ui-button")?r:r.closest(".ui-button");(n||a&&a.hasClass("ui-button")&&!a.is("input")&&!a.is(":disabled"))&&(a.is("label")&&(a=a.prev()),a.is(":checkbox")||t._handleEvents(a,o))}),e("#smartToolbar,#rht_click_clipboardSmart,#rht_click_clipboardSmart_shape").on("click",function(i,o){var r=e(i.target),n=o&&o.fromShortCut,a=n||r.hasClass("ui-button")?r:r.closest(".ui-button");(n||a&&a.hasClass("ui-button")&&!a.is("input")&&!a.is(":disabled"))&&(a.is("label")&&(a=a.prev()),t._handleEvents(a,o),J(i.target).parents("#Rmenu").length&&J.ZContextMenu.currentMenu.hide())}),J("#menuHeaderFooter").on("statechange",function(e,t){var i=J(t.stateEle).metadata().appData,o=i.action;if(o){var r=i.params,n=Utils.getAsFunction(o);n.callable(r)}}),J("#hTop").bind("spinnerchange",function(e,t){CustomHdrFtr.changeHeaderMargin()}),J("#fBot").bind("spinnerchange",function(e,t){CustomHdrFtr.changeFooterMargin()}),editor.jeditorPane.on("dblclick","div.ui-page-collapse-div ,span.js-collpse-span",function(e){var t="Fixed View"==EditorView.getView()?"Page View":"Fixed View";EditorView.setView(t),ViewManager.updatePageSettings(),PubSub.publish("Document/view/changed");var i=J(this).parents("div.zw-page");return pageId=i.data("id"),dtPage=ViewManager.pages.items[pageId],UIUtils.setEditorPaneWrapperHeight(!0),UIUtils.gotoPage(dtPage.pageNumber,!0),e.preventDefault(),!1}),J("#bbar-pagenuminput").bind("keydown",function(e){var t=RegExp(/^[0-9]*$/),i=J(this).html(),o=t.test(i);return o?(parseInt(i)>ViewManager.pages.length&&J(this).html(editor.currentPageIndex+1),void(e.keyCode==KEYS.ENTER&&(e.preventDefault(),UIUtils.gotoPage(i)))):void J(this).html(editor.currentPageIndex+1)});var o=function(e,t){ParaBorders.updateColor(t.color),CurUtil.blinkCursor()};J("#pcm-bordercolorlist, #fmt-lpnl-bordercolor-DropDown").bind("colorpalettecolorselected",o);var r="#fmt-lpnl-fontfamily,#fmt-lpnl-fontsize,#smart_fontFamily,#smart_fontSize,#smart-textalign,#pcm-textalign,#paraPropformat_headingStyle,#smart-table_cellalignment,#shapepanel-fontFamily,#shape_fontSize,#dropcap-fontfamily,#dropcap-fontsize";J(r).bind("comboshow",function(e){e.currentTarget.selectedIndex=-1}),J("#dateSelect").bind("combochange",function(e,t){Dates.changeOptions()}),J("#mergeFields,#mm-preview-fieldnavigation,#bbar-zoom,#bbar-editorview,#view-lpnl-zoom,#view-lpnl-tcmarkup,#history-changesfilter,#tc-user-menu,#tc-view-menu").bind("combochange",function(e,t){var i=this,o=J(i).metadata().appData,r=o.action,n=Utils.getAsFunction(r),a=[t.value];n.callable(a)}),J("#fmt-lpnl-fontfamily,#fmt-lpnl-fontsize,#smart_fontFamily,#smart_fontSize,#shapepanel-fontFamily,#shape_fontSize,#smart-table_cellalignment").bind("combochange",function(e,t){var i=t.combo,o=i.metadata().appData,r=o.action,n=t.value;if("FontName"==o.params){var a=i.find("option:selected").text();FontCombo.updateRecentFonts({name:a,value:n})}else if("FontSize"==o.params){var l=parseFloat(n);if(l<6)n="6";else if(l>400)n="400";else{var s=l%1;.5!==s&&(l=.3<=s&&s<=.7?parseInt(l)+.5:Math.round(l),n=l.toString())}i.zcombo("setValue",n)}var d=[o.params,n],c=Utils.getAsFunction(r);c.callable(d)}),J("#bbar-docviewslist,#format_headingStyle,#paraPropformat_headingStyle,#smart-textalign,#pcm-textalign,#code-lang-dropdown,#code-theme-dropdown").bind("combochange",function(e,t){var i=this,o=i.options[i.selectedIndex],r=J(o).metadata().appData;if(r){var n=r.action,a=Utils.getAsFunction(n),l=r.params;a.callable(l)}}),J("#tablepanel-tabs").bind("tabselect",function(e,t){TablePanel.refreshPanels()}),J("#Rmenu,#documentmenu").bind("keydown",function(e){var t=e.keyCode||e.which;t!=KEYS.NAV_UP&&t!=KEYS.NAV_DOWN&&UIUtils.hideRightClickMenu()}),J("#ins-col-before,#ins-col-after,#del-col,#ins-row-before,#ins-row-after,#del-row").on("mouseover",function(){TableVisualCueHandler.handlePopupsMouseOver(this)}),J("#ins-col-before,#ins-col-after,#del-col,#ins-row-before,#ins-row-after,#del-row").on("mouseout",function(){TableVisualCueHandler.handlePopupsMouseOut(this)}),J("#table-visualcue-popup").on("mouseleave",function(){this.style.opacity="0.2"}),J("#table-visualcue-popup").on("mouseenter",function(){this.style.opacity="1"})},_handleEvents:function(e,t){if(target=e,target&&target.length){if(target.attr("colorpalette"))return EventHandler.isMenuOpened=!0,void CurUtil.stopBlinking(!0);var i=target[0],o=J(target).attr("id"),r=o?o.indexOf("quick"):-1;0==r?Utils.addToStatistics(o):null;if(J(i).attr("id")&&"headingMenuButtonDropDown"==J(i).attr("id")){var n=editor.doc.getSelection().paraFormat.hd?editor.doc.getSelection().paraFormat.hd:0;return void J("#contentHeading"+n).addClass("ui-icon-bullet")}var a=J(i).metadata().appData;if(target.blur(),a){var l=a.action,s=a.params;if(editorProps.signInRequiredFeatures&&editorProps.signInRequiredFeatures.contains(J(i).attr("id"))&&(l="UIUtils.openSignupDialog",s=void 0),l){var d=Utils.getAsFunction(l);d.callable(s)}}}}}}(jQuery),HandleTheme=function(){"use strict";var e,t,i,o,r,n,a=["Oswald","OSP DIN","Cabin","Source Sans Pro","Cabin Sketch","Roboto","League Gothic","Latin Modern Roman","TeX Gyre Heros","Alegreya","Quicksand","Colaborate","Droid Sans","Titillium Web","Unna","Rokkitt","Otama ep","Ubuntu","glegoo","open sans","roboto","lato","istok web","pt serif","pt sans","pontano sans","aclonica","oxygen"],l={"arial,helvetica,sans-serif":"Arial","arial black,avant garde":"Arial Black","courier new,courier,monospace":"Courier New","georgia,times new roman,times,serif":"Georgia","ms mincho,ipmincho,serif":"MSMincho","ms pmincho,ipapmincho,serif":"MSPMincho","tahoma,arial,helvetica,sans-serif":"Tahoma","times new roman,times,serif":"Times New Roman","trebuchet ms,geneva":"Trebuchet MS"},s=function(){var e=function(e){return e.substring(e.indexOf("(")+1,e.lastIndexOf(")")).split(/,\s*/)};return{baseColors:[{color:e(Theme.color.light1),title:"Background1"},{color:e(Theme.color.dark1),title:"Text1"},{color:e(Theme.color.light2),title:"Background2"},{color:e(Theme.color.dark2),title:"Text2"},{color:e(Theme.color.accent1),title:"Accent1"},{color:e(Theme.color.accent2),title:"Accent2"},{color:e(Theme.color.accent3),title:"Accent3"},{color:e(Theme.color.accent4),title:"Accent4"},{color:e(Theme.color.accent5),title:"Accent5"},{color:e(Theme.color.accent6),title:"Accent6"}]}},d=function(e,t){var i=function(e,t){var i=e?ColorSets[e]:t.color;return e=e?e:t.color.name,"<p>"+e+'</p><div class="ui-themeclrschema" style="margin-top: 1px;"><span style="background: '+i.dark2+';"></span><span style="background:'+i.light2+';"></span><span style="background:'+i.accent1+';"></span><span style="background: '+i.accent2+';"></span><span style="background:'+i.accent3+';"></span><span style="background:'+i.accent4+';"></span><span style="background:'+i.accent5+'"></span><span style="background:'+i.accent6+';"></span></div>'},o=U.keys(ColorSets);J(e?e:"#themeColorCombo").empty();for(var r=0;r<o.length;r++){var n={};n.html={};var a=o[r];n.html.content=i(a?a:null,a?null:Theme),n.html.replaceWithText=!0;var l=document.createElement("option");J(e?e:"#themeColorCombo").append(l),J(l).attr({data:JSON.stringify(n),value:a})}J(e?e:"#themeColorCombo").zcombo("refresh"),J(e?e:"#themeColorCombo").zcombo("setValue",t?t:Theme.color.name)},c=function(e){for(var t="",i=e.split(" "),o=0;o<i.length;o++)t+=i[o].substring(0,1).toUpperCase()+i[o].substring(1),t+=o!=i.length?" ":"";return t},p=function(e,t){var i=function(e,t){var i=e?FontSets[e]:t.font,o=i.minor.latin,r=i.major.latin,n=l[o]?l[o]:c(o),a=l[r]?l[r]:c(r);return e=e?e:t.font.name,'<div class="ui-themefont" style="text-align:left;width:192px;margin-top:2px;"><div style="font-family:'+r+';">'+a+'<span style="font-size: 11px;font-family: sans-serif;"> ( Headings ) </span></div><div style="font-family:'+o+';">'+n+'<span style="font-size: 11px;font-family: sans-serif;"> ( Body ) </span></div></div>'},o=U.keys(FontSets);J(e?e:"#themeFontCombo").empty();for(var r=0;r<o.length;r++){var n={};n.html={};var a=o[r];n.html.content=i(a?a:null,a?null:Theme),n.html.replaceWithText=!0;var s=document.createElement("option");J(e?e:"#themeFontCombo").append(s),J(s).attr({data:JSON.stringify(n),value:a})}J(e?e:"#themeFontCombo").zcombo("refresh"),J(e?e:"#themeFontCombo").zcombo("setValue",t?t:Theme.font.name)},u=function(o){var r=function(o){if(!J(o.target).hasClass("active")){var r=J(o.target).attr("data-value");e=r,"INUSE"===r?(i=Theme.color.name,t=Theme.font.name):r.indexOf("custom|")!=-1?(i=SavedDesign[r].theme.color.name,t=SavedDesign[r].theme.font.name):(i=DesignSets[r].theme.color.name,t=DesignSets[r].theme.font.name),J("#thmClrCombo").zcombo("setValue",i),J("#thmFntCombo").zcombo("setValue",t),A(),f(r)}},n=J(".ui-design-dialog-preset-list");n.empty();var a=J("<div>").attr({"data-value":"INUSE"}).addClass("active").click(r);a.text(J.i18n("writer.design.IN_USE")),a.appendTo(n);var l=J("<div>");l.addClass("label").text(J.i18n("writer.design.BTIN")),l.appendTo(n);for(var s=U.keys(DesignSets),d=0;d<s.length;d++){var c=J("<div>").attr({"data-value":s[d]}).text(s[d]).click(r);c.appendTo(n)}if(s=U.keys(SavedDesign),0!=s.length){var l=J("<div>");l.addClass("label").text(J.i18n("writer.common.CUSTOM")),l.appendTo(n);for(var d=0;d<s.length;d++){var c=J("<div>").attr({"data-value":s[d]}).text(s[d].substr("custom|".length)).click(r);c.appendTo(n)}}f(o,!0)},f=function(e,t){if(e){var i=J("div.ui-design-dialog-preset-list"),o=J('div[data-value="'+e+'"]');if(i.find("div.active").removeClass("active"),o.addClass("active"),t){var r=i[0].offsetTop,n=o[0].offsetTop;i.scrollTop(n-r-5)}}},g=function(){for(var e=function(e,t){var i=e?FontSets[e]:t.font,o=i.minor.latin,r=i.major.latin,n=l[r]?l[r]:c(r),a=e?ColorSets[e]:t.color;return e=e?e:t.name,'<div class="ui-designthemeset"><p noi18n="true" class="ui-dtheme-name ui-no-margin" style="text-align:left;">'+e+'</p><div class="ui-fl" style="width: 42%;"><span noi18n="true" class="ui-dtheme-txt ui-fl"><span style="font-family:'+r+';">A</span><span style="font-family:'+o+';">a</span></span><span class="ui-dtheme-txt-line ui-dtheme-txt-fline ui-fl"></span><span class="ui-dtheme-txt-line ui-fl"></span><span class="ui-dtheme-txt-line ui-fl"></span></div><div class="ui-fl"><div noi18n="true" style="text-align:left;" class="ui-dtheme-font">'+n+'</div><div class="ui-themeclrschema" ><span style="background: '+a.light2+'"></span><span style="background: '+a.dark2+'"></span><span style="background: '+a.accent1+'"></span><span style="background: '+a.accent2+'"></span><span style="background: '+a.accent3+'"></span><span style="background: '+a.accent4+'"></span><span style="background: '+a.accent5+'"></span><span style="background: '+a.accent6+'"></span></div></div><div class="clearfix"></div></div>'},t=0;t<Themesetnames.length;t++){var i={};i.html={};var o=Themesetnames[t];i.html.content=e(o?o:null,o?null:Theme),i.html.replaceWithText=!0;var r=document.createElement("option");J("#docThemeCombo").append(r),J(r).attr({data:JSON.stringify(i),value:o})}J("#docThemeCombo").zcombo("refresh")},m=function(){var e=l[Theme.font.minor.latin]?l[Theme.font.minor.latin]:c(Theme.font.minor.latin),t=l[Theme.font.major.latin]?l[Theme.font.major.latin]:c(Theme.font.major.latin);J("option#minorFontOption").attr({style:"font-family:"+Theme.font.minor.latin+";"}).text(e+" (Body)"),J("option#majorFontOption").attr({style:"font-family:"+Theme.font.major.latin+";"}).text(t+" (Headings)"),J("#fmt-lpnl-fontfamily").zfontcombo("refresh"),J("option#smartMinorFontOption").attr({style:"font-family:"+Theme.font.minor.latin+";"}).text(e+" (Body)"),J("option#smartMajorFontOption").attr({style:"font-family:"+Theme.font.major.latin+";"}).text(t+" (Headings)"),J("#smart_fontFamily").zfontcombo("refresh")},h=function(){var e=HandleTheme.colorPaleteObj();$.ui.zcolorpalette.defaults.baseColors=e.baseColors,$.ui.zcolorpalette.defaults.defaultColor="#000000"},T=function(){m(),UIUtils.setHeadingDropdownStyle(),h()},E=function(){var o={},n=/[0-9a-zA-Z_\-\.\$@\?\,\:\'\/\!\s]+/g;if(n.test(r)){o.name=r,o[ATTR_BODY.DS_STYLES]="INUSE"===e?DocUtil.copyStyle(OrigDocStyleObject):e.indexOf("custom|")!=-1?SavedDesign[e]:DesignSets[e].styles,o[ATTR_BODY.DS_THEME]={name:"",font:FontSets[t],color:ColorSets[i],fmtScheme:{}},o[ATTR_BODY.DS_THEME].font.name=t,o[ATTR_BODY.DS_THEME].color.name=i,SavedDesign[r]=o;var a={};csrfParamName&&(a[csrfParamName]=getcsrf()),a.SavedDesign=JSON.stringify(SavedDesign),J.post(Utils.getNiceUrlPrefix("user/settings/savedesign"),a,function(){C()})}},R=function(e){delete SavedDesign[e];var t={};csrfParamName&&(t[csrfParamName]=getcsrf()),t.SavedDesign=JSON.stringify(SavedDesign),J.post(Utils.getNiceUrlPrefix("user/settings/savedesign"),t,function(){C(),UIUtils.showMessage("info",e.substr("custom|".length)+" "+J.i18n("writer.trackchange.DELETED"),!0,"normalfont",1e3)})},S=function(e){var t=(editor.doc.getSelection().parents(NODE_TYPE.BODY),{});e.indexOf("custom|")!=-1?(t[ATTR_BODY.DS_STYLES]=SavedDesign[e][ATTR_BODY.DS_STYLES],t[ATTR_BODY.DS_THEME]=SavedDesign[e][ATTR_BODY.DS_THEME]):(t[ATTR_BODY.DS_STYLES]=DesignSets[e][ATTR_BODY.DS_STYLES],t[ATTR_BODY.DS_THEME]=DesignSets[e][ATTR_BODY.DS_THEME]);var i=t[ATTR_BODY.DS_THEME];UIUtils.showLoadingMsg(J.i18n("common","LOADING")),Utils.log("@applyDesign-->addFonts"),editor.addFonts(Utils.getThemeFonts(i),function(){UIUtils.hideLoadingMsg(),editor.doc.execCmd("changeDesign",t);var i=e.indexOf("custom|")!=-1?e.substr("custom|".length):e,o=J.i18n("writer.design.DESIGN_APPLIED_TO_DOCUMENT").replace("{0}",i);UIUtils.showMessage("info",o,!0,"normalfont",2500)})},O=function(){var e,t=(editor.doc.getSelection().parents(NODE_TYPE.BODY),{});t[ATTR_BODY.DS_STYLES]=DocUtil.copyStyle(DefaultStyles),t[ATTR_BODY.DS_THEME]=e=DocUtil.copyStyle(DefaultTheme);var i=function(i){1==i&&(UIUtils.showLoadingMsg(J.i18n("common","LOADING")),Utils.log("@resetDesign-->addFonts"),editor.addFonts(Utils.getThemeFonts(e),function(){UIUtils.hideLoadingMsg(),editor.doc.execCmd("changeDesign",t)}))};MsgDialog.showMessage(CONST.MSG_TYPE_YESNO,"info",J.i18n("writer.design.RESET_DESIGN"),J.i18n("writer.design.RESET_DESIGN_MSG"),null,i)},v=function(){if(J("#designPopup").zvalidation("validateAllFields",J("#designPopup"))){var a=(editor.doc.getSelection().parents(NODE_TYPE.BODY),{});if(e===t&&e===i)a[ATTR_BODY.DS_THEME]=DesignSets[e][ATTR_BODY.DS_THEME],a[ATTR_BODY.DS_STYLES]=DesignSets[e][ATTR_BODY.DS_STYLES];else{e.indexOf("custom|")!=-1?a[ATTR_BODY.DS_STYLES]=SavedDesign[e][ATTR_BODY.DS_STYLES]:"INUSE"!=e?a[ATTR_BODY.DS_STYLES]=DesignSets[e][ATTR_BODY.DS_STYLES]:a[ATTR_BODY.DS_STYLES]=DocUtil.copyStyle(OrigDocStyleObject);var l={font:FontSets[t],color:ColorSets[i],fmtScheme:{},name:t===i?t:null};l.font.name=t,l.color.name=i,a[ATTR_BODY.DS_THEME]=l}UIUtils.showLoadingMsg(J.i18n("common","LOADING")),Utils.log("@changeDesign-->addFonts"),editor.addFonts(Utils.getThemeFonts(l),function(){UIUtils.hideLoadingMsg(),editor.doc.execCmd("changeDesign",a),o&&QuickStyle.updateDefaultStyleandTheme(a),n&&r&&E(),J.dialogutil.close("designdialog")})}},b=function(e){var t=J(e);t.hasClass("normal-preview")?(J(".ui-design-dialog-preview").show(),J(".ui-design-dialog-page-preview").hide(),t.addClass("active"),J(".page-preview").removeClass("active")):(J(".ui-design-dialog-preview").hide(),J(".ui-design-dialog-page-preview").show(),t.addClass("active"),J(".normal-preview").removeClass("active"))},A=function(){var o,r,n,a=DocUtil.copyStyle(DesignSets[e]);o=DocUtil.copyStyle(FontSets[t]),r=DocUtil.copyStyle(ColorSets[i]),n="INUSE"===e?DocUtil.copyStyle(OrigDocStyleObject):e.indexOf("custom|")!=-1?DocUtil.copyStyle(SavedDesign[e].styles):DocUtil.copyStyle(a.styles);var l={color:r,font:o};DocUtil.constructRenderingFormat(n,l);for(var s=["h0","h1","h2","h3","h4","h5","h6","h101","h102","h103"],d=function(e,t){if(J(e.parentNode).hasClass("ui-design-dialog-preview"))J(e).css(f.styles);else{var i=DocUtil.copyStyle(f.styles);i.hasOwnProperty("font-size")&&(i["font-size"]=parseInt(.7*parseInt(i["font-size"]))),J(e).css(i)}},c=0;c<s.length;c++){var p=J(".preview_"+s[c]);J(p).removeAttr("style");var u=n.para[s[c]],f=Utils.getStyle(u.textFormat);delete u[ATTR_PARAGRAPH.PS_LS],delete u[ATTR_PARAGRAPH.PS_SA],delete u[ATTR_PARAGRAPH.PS_SB],delete u[ATTR_PARAGRAPH.PS_ML],delete u[ATTR_PARAGRAPH.PS_MR],delete u[ATTR_PARAGRAPH.PS_TI],delete u[ATTR_PARAGRAPH.PS_PL];var g=Utils.getStyle(u);U.each(p,d),J(p).css(g.styles)}},y=function(l){var s={set:function(e,a){if("colorName"===e.action)i=a;else if("fontName"===e.action)t=a;else{if("makeDef"===e.action)return void(o=a);if("saveDesign"===e.action)return n=a,void(a?J("#designName").show():J("#designName").hide());if("customDesignName"===e.action)return void(r="custom|"+a)}A()},init:function(){r="",n=!1,a.length&&(Utils.log("@initThemeDialog-->addFonts"),editor.addFonts(a),a=[]),o=!1,e=l?l:"INUSE",t=l&&"INUSE"!=l?l.indexOf("custom|")!=-1?SavedDesign[l].theme.font.name:DesignSets[l].theme.font.name:Theme.font.name,i=l&&"INUSE"!=l?l.indexOf("custom|")!=-1?SavedDesign[l].theme.color.name:DesignSets[l].theme.color.name:Theme.color.name,p("#thmFntCombo",t),d("#thmClrCombo",i),u(l),A();var s=function(){var e=J(".ui-font-color");e.is(":hidden")?(e.show(),e.animate({height:55},500)):e.animate({height:0},500,function(){e.hide()})};J(".ui-toggle-font-color").click(s),J(".ui-font-color").height(0).hide();var c=function(e){var t=J("."+e),i=t.find("div.ui-zcombo-dropdown"),o=i.attr("popup");i.removeAttr("popup"),t.attr("popup",o),J("ul#"+o).removeAttr("relativeTo")};c("ui-dlg-style-set-panel"),c("ui-dlg-font-set-panel"),c("ui-dlg-color-set-panel")}};J.dialogutil.open("designdialog",null,s)},D=function(){for(var e=editor.doc.getBodyFormat(),t=e[ATTR_BODY.DS_STYLES],i=e[ATTR_BODY.DS_THEME],o=U.keys(DesignSets),r=U.keys(SavedDesign),n=null;o.length;){var a=o.shift();if(U.isEqual(DesignSets[a].styles,t)&&U.isEqual(DesignSets[a].theme.font,i.font)&&U.isEqual(DesignSets[a].theme.color,i.color)){n=a;break}}for(;!n&&r.length;){var a=r.shift();if(U.isEqual(SavedDesign[a].styles,t)&&U.isEqual(SavedDesign[a].theme.font,i.font)&&U.isEqual(SavedDesign[a].theme.color,i.color)){n=a;break}}setTimeout(function(){J("#fmt-lpnl-designmenubtn").zbutton("changeLabel",n?n.indexOf("custom|")!=-1?n.substr("custom|".length):n:J.i18n("writer.common.CUSTOM"))},0)},C=function(){var e=J("#fmt-lpnl-designmenulist");if(!e[0])return!1;SavedDesign=J.isEmptyObject(SavedDesign)&&w_usersettings.SavedDesign?w_usersettings.SavedDesign:SavedDesign,D(),e.empty();var t={mtype:"custom",html:"<div class='ui-designmenulist-headings'>"+J.i18n("writer.design.BTIN")+"</div>"};e.zmenu("addMenuItem",t),U.each(DesignSets,function(i,o){var r=o.replace("(","-").replace(")","");t={label:o,mtype:"submenu",menuItems:[{mtype:"custom",id:"ui-designmenulist-preview",html:"<div class='' style='padding: 0px!important;margin-top: -7px;'><div class=\"writer_Design_Preview ui-icon-"+r+'"></div><div class="ui-designmenulist-button" onclick="HandleTheme.applyDesign(\''+o+"')\"> "+J.i18n("writer.common.APPLY")+" </div></div>"}]},e.zmenu("addMenuItem",t)}),U.keys(SavedDesign).length&&(t={mtype:"custom",html:"<div class='ui-designmenulist-headings'>"+J.i18n("writer.common.CUSTOM")+"</div>"},e.zmenu("addMenuItem",t),U.each(SavedDesign,function(i,o){t={label:o.substr("custom|".length),mtype:"submenu",menuItems:[{label:J.i18n("writer.common.PREVIEW"),appData:{action:"HandleTheme.openDesignDialog",params:o}},{label:J.i18n("writer.common.APPLY"),appData:{action:"HandleTheme.applyDesign",params:o}},{label:J.i18n("writer.common.DELETE"),appData:{action:"HandleTheme.deleteDocumentDesign",params:o}}]},e.zmenu("addMenuItem",t)})),t={mtype:"separator"},e.zmenu("addMenuItem",t),t={label:J.i18n("writer.design.CUSTOMIZE"),mtype:"customLabel",appData:{action:"HandleTheme.openDesignDialog"}},e.zmenu("addMenuItem",t),t={label:J.i18n("writer.design.RESET_DESIGN"),mtype:"customLabel",appData:{action:"HandleTheme.resetDesign"}},e.zmenu("addMenuItem",t)};return PubSub.subscribe("Document/themeChanged",D),{consrtuctDesginCombo:C,constructThemeColorCombo:d,constructThemeFontCombo:p,constructDocThemeCombo:g,colorPaleteObj:s,updateCombos:T,constructDesignSetCombo:u,openDesignDialog:y,updateColorPalete:h,saveDocumentDesign:E,deleteDocumentDesign:R,applyDesign:S,resetDesign:O,changeDesign:v,swapPreview:b}}(),function(e){e.ZMenuHandler={init:function(){J(document).bind("menushow",function(e,t){EventHandler.isMenuOpened=!0}).bind("menuhide",function(e,t){if(J("#quicksearchinput").is(":visible")){var o=J("#quicksearchmenu li");for(i=0;i<o.length;i++){var r=J(o[i]).metadata();r.submenu&&r.submenu.is(t.menu)&&"click"==window.event.type&&QuickSearch.hideSearchBar()}}else J("#helpDiv").is(":visible")&&J("#helpDiv").hide(),EventHandler.isMenuOpened=!1,CommentManager.isCommentCreationDialogInDisplay()||!LinkDialog.isLinkDialogHidden()||BookmarkDialog.isGetLinkDialogueOpened||InsertShape.selectedShape()||InsertShape.isDrawingMode||EditorUtil.focusMultiByteSpan()}),J("[ctype=zmenu], [ctype_lazy=zmenu], [zw-ctype=zmenu], [zw-ctype_lazy=zmenu]").bind("menuitemclicked",function(e,t){UIUtils._itemClicked(e,t)}),J("[colorpalette=true]").bind("colorpalettecolorselected",function(e,t){var i=J(this);i.is("#pcm-parabgcolorlist,#fmt-lnpl-parabgcolorlist")?UIUtils.changeParaBackgroundColor(e,t):i.is("#fmt-lpnl-fgcolorlist,#textforegroundcolorDropDown-smart")?UIUtils.changeForegroundColor(e,t):i.is("#fmt-lpnl-bgcolorlist,#textbackgroundcolorDropDown-smart")?UIUtils.changeTextBackgroundColor(e,t):i.is("#shapefillcolor")||i.is("#dropcap-fillcolor")?InsertShape.changeShapeFillColor(e,t):i.is("#strokecolor")||i.is("#dropcap-strokecolor")?InsertShape.changeStrokeColor(e,t):i.is("#shp-lpnl-fgcolorlist")||i.is("#dropcap-lpnl-fgcolorlist")?InsertShape.changeShapeForegroundColor(e,t):J(this).is("#tbl-theme-clrpicker")?(J(".ui-tbl-theme-clr-active").removeClass("ui-tbl-theme-clr-active"),J("#tbl-theme-clrpicker").addClass("ui-tbl-theme-clr-active"),TableLeftPanelTheme.changePanelBySelectedColor(e,t)):J(this).is("#micro-tool-theme-clr")&&TableLeftPanelTheme.changeThemeObjColor(J(this)[0],t)}),J("#bookmark-popup").on("focusout",function(){J("#bookmark-popup").hide(),BookmarkDialog.isGetLinkDialogueOpened=!1})}}}(jQuery);var TableLeftPanelTheme=function(){var e,t,i={theme1:{tblPr:{cell:{borders:{"border-top":{type:"solid",width:"1px",color:"color100%"},"border-left":{type:"solid",width:"1px",color:"color100%"},"border-bottom":{type:"solid",width:"1px",color:"color100%"},"border-right":{type:"solid",width:"1px",color:"color100%"}}}}},theme2:{tblPr:{borders:{"border-top":{type:"solid",width:"0px",color:"rgb(0,0,0)"},"border-left":{type:"solid",width:"0px",color:"rgb(0,0,0)"},"border-bottom":{type:"solid",width:"0px",color:"rgb(0,0,0)"},"border-right":{type:"solid",width:"0px",color:"rgb(0,0,0)"},insideH:{type:"solid",width:"0px",color:"rgb(0,0,0)"},insideV:{type:"solid",width:"0px",color:"rgb(0,0,0)"}},cell:{bgc:"rgb(255,255,255)"}}},theme3:{tblPr:{borders:{"border-bottom":{width:"1px",type:"solid",color:"color100%"},"border-top":{width:"1px",type:"solid",color:"color100%"}},cell:{bgc:"rgb(255,255,255)"}},firstRow:{cell:{borders:{"border-bottom":{width:"1px",type:"solid",color:"color100%"}}}}},theme4:{tblPr:{cell:{bgc:"rgb(255,255,255)",borders:{"border-top":{type:"solid",width:"1px",color:"color100%"},"border-left":{type:"solid",width:"1px",color:"color100%"},"border-bottom":{type:"solid",width:"1px",color:"color100%"},"border-right":{type:"solid",width:"1px",color:"color100%"}}}},firstRow:{cell:{bgc:"color100%"},para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}}}},theme5:{tblPr:{borders:{"border-top":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-bottom":{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideV:{type:"solid",width:"1px",color:"rgb(255,255,255)"}},cell:{bgc:"colorLight60%"}},firstRow:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-top":{type:"solid",width:"0px",color:"color100%"},"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"}}}},firstColumn:{cell:{borders:{"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"}}}},lastColumn:{cell:{borders:{"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"}}}}},theme6:{tblPr:{cell:{bgc:"rgb(255,255,255)",borders:{"border-top":{type:"solid",width:"1px",color:"color100%"},"border-left":{type:"solid",width:"1px",color:"color100%"},"border-bottom":{type:"solid",width:"1px",color:"color100%"},"border-right":{type:"solid",width:"1px",color:"color100%"}}}},band1Horz:{cell:{bgc:"colorLight80%"}}},theme7:{tblPr:{borders:{"border-top":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-bottom":{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideV:{type:"solid",width:"1px",color:"rgb(255,255,255)"}}},band1Horz:{cell:{bgc:"colorLight40%"}},band2Horz:{cell:{bgc:"colorLight80%"}}},theme8:{tblPr:{borders:{"border-bottom":{type:"solid",width:"3px",color:"color100%"}},cell:{bgc:"rgb(255,255,255)"}},firstRow:{cell:{bgc:"colorLight40%",borders:{"border-bottom":{type:"solid",width:"3px",color:"color100%"},"border-top":{type:"solid",width:"3px",color:"color100%"}}}},band1Horz:{cell:{bgc:"colorLight80%"}}},theme9:{tblPr:{borders:{insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideV:{type:"solid",width:"1px",color:"rgb(255,255,255)"}},cell:{bgc:"colorLight80%"}},firstRow:{cell:{bgc:"color100%"},para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}}},band1Horz:{cell:{bgc:"colorLight40%"}}},theme10:{tblPr:{cell:{bgc:"rgb(255,255,255)",borders:{"border-top":{type:"solid",width:"1px",color:"color100%"},"border-left":{type:"solid",width:"1px",color:"color100%"},"border-bottom":{type:"solid",width:"1px",color:"color100%"},"border-right":{type:"solid",width:"1px",color:"color100%"}}}},firstRow:{cell:{borders:{"border-bottom":{type:"solid",width:"3px",color:"color100%"}}}},band1Horz:{cell:{bgc:"colorLight80%"}}},theme11:{tblPr:{cell:{bgc:"rgb(255,255,255)",borders:{"border-top":{type:"solid",width:"1px",color:"color100%"},"border-left":{type:"solid",width:"1px",color:"color100%"},"border-bottom":{type:"solid",width:"1px",color:"color100%"},"border-right":{type:"solid",width:"1px",color:"color100%"}}}},firstRow:{cell:{bgc:"color100%"},para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}}},band1Horz:{cell:{bgc:"colorLight80%"}}},theme12:{tblPr:{borders:{"border-top":{type:"solid",width:"1px",color:"color100%"},"border-left":{type:"solid",width:"1px",color:"color100%"},"border-bottom":{type:"solid",width:"1px",color:"color100%"},"border-right":{type:"solid",width:"1px",color:"color100%"},insideH:{type:"solid",width:"1px",color:"color100%"}},cell:{bgc:"rgb(255,255,255)"}},firstRow:{cell:{bgc:"color100%"},para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}}},band1Horz:{cell:{bgc:"colorLight80%"}}},theme13:{tblPr:{cell:{bgc:"colorLight40%",borders:{"border-top":{type:"solid",width:"1px",color:"color100%"},"border-left":{type:"solid",width:"1px",color:"color100%"},"border-bottom":{type:"solid",width:"1px",color:"color100%"},"border-right":{type:"solid",width:"1px",color:"color100%"}}}},firstRow:{cell:{bgc:"color100%"},para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}}},band1Horz:{cell:{bgc:"colorLight80%"}}},theme14:{tblPr:{borders:{"border-top":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-bottom":{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideV:{type:"solid",width:"1px",color:"rgb(255,255,255)"}},cell:{bgc:"colorLight60%"}},firstColumn:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-left":{type:"solid",width:"0px",color:"color100%"}}}},lastColumn:{cell:{borders:{"border-right":{type:"solid",width:"0px",color:"color100%"}}}},firstRow:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-top":{type:"solid",width:"0px",color:"color100%"},"border-left":{type:"solid",width:"0px",color:"color100%"},"border-right":{type:"solid",width:"0px",color:"color100%"}}}}},theme15:{tblPr:{borders:{insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"}},cell:{bgc:"color100%"},para:{textFormat:{fgc:"rgb(255,255,255)"}}},firstRow:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-bottom":{type:"solid",width:"3px",color:"rgb(255,255,255)"},"border-right":{type:"solid",width:"0px",color:"rgb(255,255,255)"}}}},firstColumn:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{borders:{"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"}}}},band1Horz:{para:{textFormat:{fgc:"rgb(255,255,255)"}}},band2Horz:{para:{textFormat:{fgc:"rgb(255,255,255)"}}}},theme16:{tblPr:{borders:{"border-top":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-bottom":{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideV:{type:"solid",width:"1px",color:"rgb(255,255,255)"}}},firstRow:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-right":{type:"solid",width:"0px",color:"color100%"},"border-left":{type:"solid",width:"0px",color:"color100%"},"border-top":{type:"solid",width:"0px",color:"color100%"}}}},firstColumn:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-left":{type:"solid",width:"0px",color:"color100%"}}}},lastColumn:{cell:{borders:{"border-right":{type:"solid",width:"0px",color:"color100%"}}}},band1Horz:{cell:{bgc:"colorLight60%"}},band2Horz:{cell:{bgc:"colorLight80%"}}},theme17:{tblPr:{borders:{"border-top":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-bottom":{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideV:{type:"solid",width:"1px",color:"rgb(255,255,255)"}},cell:{bgc:"colorLight80%"}},band1Horz:{cell:{bgc:"colorLight40%"}},band1Vert:{cell:{bgc:"colorLight40%"}}},theme18:{tblPr:{cell:{bgc:"rgb(255,255,255)",borders:{"border-top":{type:"solid",width:"1px",color:"color100%"},"border-left":{type:"solid",width:"1px",color:"color100%"},"border-bottom":{type:"solid",width:"1px",color:"color100%"},"border-right":{type:"solid",width:"1px",color:"color100%"}}}},band1Vert:{cell:{bgc:"colorLight60%"}}},theme19:{tblPr:{borders:{insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideV:{type:"solid",width:"1px",color:"rgb(255,255,255)"}},cell:{bgc:"colorLight80%"}},band1Vert:{cell:{bgc:"colorLight40%"}}},theme20:{tblPr:{cell:{bgc:"rgb(255,255,255)",borders:{"border-top":{type:"solid",width:"1px",color:"color100%"},"border-left":{type:"solid",width:"1px",color:"color100%"},"border-bottom":{type:"solid",width:"1px",color:"color100%"},"border-right":{type:"solid",width:"1px",color:"color100%"}}}},firstRow:{cell:{bgc:"color100%"},para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}}},band1Vert:{cell:{bgc:"colorLight80%"}}},theme21:{tblPr:{borders:{insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideV:{type:"solid",width:"1px",color:"rgb(255,255,255)"}},cell:{bgc:"colorLight40%"}},firstRow:{cell:{bgc:"color100%"},para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}}},band2Vert:{cell:{bgc:"colorLight80%"}}},theme22:{tblPr:{borders:{"border-top":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-bottom":{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideV:{type:"solid",width:"1px",color:"rgb(255,255,255)"}}},firstRow:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-top":{type:"solid",width:"0px",color:"color100%"}}}},firstColumn:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%"}},lastColumn:{cell:{borders:{"border-right":{type:"solid",width:"0px",color:"color100%"}}}},band1Vert:{cell:{bgc:"colorLight40%"}},band2Vert:{cell:{bgc:"colorLight80%"}}},theme23:{tblPr:{borders:{"border-top":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-bottom":{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideV:{type:"solid",width:"1px",color:"rgb(255,255,255)"}},cell:{bgc:"color100%"}},firstColumn:{cell:{borders:{"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"}}}},band1Horz:{para:{textFormat:{fgc:"rgb(255,255,255)"}}},band2Horz:{para:{textFormat:{fgc:"rgb(255,255,255)"}}}},lastColumn:{cell:{borders:{"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"}}}},theme24:{tblPr:{borders:{"border-top":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-bottom":{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideV:{type:"solid",width:"1px",color:"rgb(255,255,255)"}},cell:{bgc:"colorLight60%"}},firstRow:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-top":{type:"solid",width:"0px",color:"color100%"},"border-left":{type:"solid",width:"0px",color:"color100%"},"border-right":{type:"solid",width:"0px",color:"color100%"}}}},lastColumn:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-right":{type:"solid",width:"0px",color:"color100%"}}}},firstColumn:{cell:{borders:{"border-left":{type:"solid",width:"0px",color:"color100%"}}}},band1Horz:{cell:{bgc:"colorLight40%"}}},theme25:{tblPr:{borders:{"border-top":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-bottom":{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideV:{type:"solid",width:"1px",color:"rgb(255,255,255)"}},cell:{bgc:"colorLight60%"}},lastRow:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-bottom":{type:"solid",width:"0px",color:"color100%"},"border-left":{type:"solid",width:"0px",color:"color100%"},"border-right":{type:"solid",width:"0px",color:"color100%"}}}},lastColumn:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-right":{type:"solid",width:"0px",color:"color100%"}}}},firstColumn:{cell:{borders:{"border-left":{type:"solid",width:"0px",color:"color100%"}}}},band1Horz:{cell:{bgc:"colorLight40%"}}},theme26:{tblPr:{cell:{bgc:"rgb(255,255,255)",borders:{"border-top":{type:"solid",width:"1px",color:"colorLight40%"},"border-left":{type:"solid",width:"1px",color:"colorLight40%"},"border-bottom":{type:"solid",width:"1px",color:"colorLight40%"},"border-right":{type:"solid",width:"1px",color:"colorLight40%"}}}},firstRow:{cell:{borders:{"border-bottom":{type:"solid",width:"3px",color:"color100%"}}}},lastRow:{cell:{borders:{"border-top":{type:"double",width:"3px",color:"color100%"}}}},band1Horz:{cell:{bgc:"colorLight80%"}}},theme27:{tblPr:{cell:{bgc:"rgb(255,255,255)",borders:{"border-top":{type:"solid",width:"1px",color:"color100%"},"border-left":{type:"solid",width:"1px",color:"color100%"},"border-bottom":{type:"solid",width:"1px",color:"color100%"},"border-right":{type:"solid",width:"1px",color:"color100%"}}}},firstRow:{cell:{bgc:"color100%"},para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}}},lastRow:{cell:{borders:{"border-top":{type:"double",width:"3px",color:"color100%"}}}}},theme28:{tblPr:{borders:{"border-top":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-bottom":{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideV:{type:"solid",width:"1px",color:"rgb(255,255,255)"}}},firstRow:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-right":{type:"solid",width:"0px",color:"color100%"},"border-left":{type:"solid",width:"0px",color:"color100%"},"border-top":{type:"solid",width:"0px",color:"color100%"}}}},lastRow:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-right":{type:"solid",width:"0px",color:"color100%"},"border-left":{type:"solid",width:"0px",color:"color100%"},"border-bottom":{type:"solid",width:"0px",color:"color100%"}}}},lastColumn:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-right":{type:"solid",width:"0px",color:"color100%"},"border-left":{type:"solid",width:"0px",color:"color100%"},"border-top":{type:"solid",width:"0px",color:"color100%"}}}},firstColumn:{cell:{borders:{"border-left":{type:"solid",width:"0px",color:"color100%"}}}},band1Horz:{cell:{bgc:"colorLight60%"}},band2Horz:{cell:{bgc:"colorLight80%"}}},theme29:{tblPr:{borders:{"border-top":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-bottom":{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideV:{type:"solid",width:"1px",color:"rgb(255,255,255)"}},cell:{bgc:"colorLight60%"}},lastRow:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-bottom":{type:"solid",width:"0px",color:"color100%"},"border-left":{type:"solid",width:"0px",color:"color100%"},"border-right":{type:"solid",width:"0px",color:"color100%"}}}},firstColumn:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-left":{type:"solid",width:"0px",color:"color100%"}}}},lastColumn:{cell:{borders:{"border-left":{type:"solid",width:"0px",color:"color100%"}}}},band1Horz:{cell:{bgc:"colorLight40%"}},firstRow:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%"}}},theme30:{tblPr:{borders:{"border-top":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-left":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-bottom":{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideH:{type:"solid",width:"1px",color:"rgb(255,255,255)"},insideV:{type:"solid",width:"1px",color:"rgb(255,255,255)"}}},firstRow:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-right":{type:"solid",width:"0px",color:"color100%"},"border-left":{type:"solid",width:"0px",color:"color100%"},"border-top":{type:"solid",width:"0px",color:"color100%"}}}},lastRow:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-right":{type:"solid",width:"0px",color:"color100%"},"border-left":{type:"solid",width:"0px",color:"color100%"},"border-bottom":{type:"solid",width:"0px",color:"color100%"}}}},lastColumn:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-right":{type:"solid",width:"0px",color:"color100%"},"border-left":{type:"solid",width:"0px",color:"color100%"},"border-top":{type:"solid",width:"0px",color:"color100%"}}}},firstColumn:{para:{textFormat:{fgc:"rgb(255,255,255)",fw:"bold"}},cell:{bgc:"color100%",borders:{"border-right":{type:"solid",width:"1px",color:"rgb(255,255,255)"},"border-left":{type:"solid",width:"0px",color:"color100%"},"border-top":{type:"solid",width:"0px",color:"color100%"}}}},band1Horz:{cell:{bgc:"colorLight40%"}},band2Horz:{cell:{bgc:"colorLight80%"}}}},o=["table.theme1>:first-of-type>tr>td { border-top\t:\t1px solid rgb(0,0,0) !important;\t}\ntable.theme1>:first-of-type>tr>td { border-left:\t1px solid rgb(0,0,0) !important;\t}\ntable.theme1>:first-of-type>tr>td { border-bottom:\t1px solid rgb(0,0,0) !important;\t}\ntable.theme1>:first-of-type>tr>td { border-right:\t1px solid rgb(0,0,0) !important;\t}\ntable.theme1>:first-of-type>tr>td {background-color : rgb(255,255,255) !important;}\n","table.theme2>:first-of-type>tr:first-child td { border-top\t:\t0px solid rgb(0,0,0) !important;\t}\ntable.theme2>:first-of-type>tr>td:first-child { border-left\t:\t0px solid rgb(0,0,0) !important;\t}\ntable.theme2>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t0px solid rgb(0,0,0) !important;\t}\ntable.theme2>:first-of-type>tr>td:last-child\t{ border-right\t:\t0px solid rgb(0,0,0) !important;\t}\ntable.theme2>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t0px solid rgb(0,0,0) !important;\t}\ntable.theme2>:first-of-type>tr>td {background-color : rgb(255,255,255) !important;}\ntable.theme2>:first-of-type>tr>td:not(:last-child) { border-right:\t0px solid rgb(0,0,0) !important;\t}\n","table.theme3>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t1px solid rgb(122, 122, 122) !important;\t}\ntable.theme3>:first-of-type>tr:first-child>td { border-top\t:\t1px solid rgb(122, 122, 122) !important;\t}\ntable.theme3>:first-of-type>tr>td {background-color : rgb(255,255,255) !important;}\ntable.theme3>:first-of-type>tr:first-child>td { border-bottom:\t1px solid rgb(122, 122, 122) !important;\t}\n","table.theme4>:first-of-type>tr:first-child>td{ color:paraColor !important;}\ntable.theme4>:first-of-type>tr>td {background-color : rgb(255,255,255) !important;}\ntable.theme4>:first-of-type>tr>td { border-top\t:\t1px solid color100 !important;\t}\ntable.theme4>:first-of-type>tr>td { border-left:\t1px solid color100 !important;\t}\ntable.theme4>:first-of-type>tr>td { border-bottom:\t1px solid color100 !important;\t}\ntable.theme4>:first-of-type>tr>td { border-right:\t1px solid color100 !important;\t}\ntable.theme4>:first-of-type>tr:first-child td { background-color : color100 !important; }\n","table.theme5>:first-of-type>tr:first-child>td{ color:paraColor !important;}\ntable.theme5>:first-of-type>tr:first-child>td { border-top\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme5>:first-of-type>tr>td:first-child { border-left\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme5>:first-of-type>tr>td:last-child\t{ border-right\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme5>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme5>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme5>:first-of-type>tr>td:not(:last-child) { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme5>:first-of-type>tr>td {background-color : colorLight60 !important;}\ntable.theme5>:first-of-type>tr:first-child>td { border-top\t:\t0px solid color100 !important;\t}\ntable.theme5>:first-of-type>tr:first-child>td { border-left:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme5>:first-of-type>tr:first-child>td { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme5>:first-of-type>tr:first-child>td { background-color : color100 !important; }\ntable.theme5>:first-of-type>tr>td:first-child { border-left: 1px solid rgb(255,255,255) !important;}\ntable.theme5>:first-of-type>tr>td:last-child { border-right: 1px solid rgb(255,255,255) !important;}\n","table.theme6>:first-of-type>tr>td {background-color : rgb(255,255,255) !important;}\ntable.theme6>:first-of-type>tr>td { border-top\t:\t1px solid color100 !important;\t}\ntable.theme6>:first-of-type>tr>td { border-left:\t1px solid color100 !important;\t}\ntable.theme6>:first-of-type>tr>td { border-bottom:\t1px solid color100 !important;\t}\ntable.theme6>:first-of-type>tr>td { border-right:\t1px solid color100 !important;\t}\ntable.theme6>:first-of-type>tr:nth-child(odd)>td {background-color : colorLight80 !important; }\n","table.theme7>:first-of-type>tr:first-child>td { border-top\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme7>:first-of-type>tr>td:first-child { border-left\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme7>:first-of-type>tr>td:last-child\t{ border-right\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme7>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme7>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme7>:first-of-type>tr>td:not(:last-child) { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme7>:first-of-type>tr:nth-child(odd)>td {background-color : colorLight40 !important; }\ntable.theme7>:first-of-type>tr:nth-child(even)>td {background-color : colorLight80 !important; }\n","table.theme8>:first-of-type>tr>td {background-color : rgb(255,255,255) !important;}\ntable.theme8>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t1px solid color100 !important;\t}\ntable.theme8>:first-of-type>tr:first-child>td { border-bottom:\t1px solid color100 !important;\t}\ntable.theme8>:first-of-type>tr:first-child>td { border-top\t:\t1px solid color100 !important;\t}\ntable.theme8>:first-of-type>tr:first-child>td { background-color : colorLight40 !important; }\ntable.theme8>:first-of-type>tr:nth-child(even)>td {background-color : colorLight80 !important; }\n","table.theme9>:first-of-type>tr:first-child>td{ color:paraColor !important;}\ntable.theme9>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme9>:first-of-type>tr>td:not(:last-child) { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme9>:first-of-type>tr>td {background-color : colorLight80 !important;}\ntable.theme9>:first-of-type>tr:first-child>td { background-color : color100 !important; }\ntable.theme9>:first-of-type>tr:nth-child(even)>td {background-color : colorLight40 !important; }\n","table.theme10>:first-of-type>tr>td {background-color : rgb(255,255,255) !important;}\ntable.theme10>:first-of-type>tr>td { border-top\t:\t1px solid color100 !important;\t}\ntable.theme10>:first-of-type>tr>td { border-left:\t1px solid color100 !important;\t}\ntable.theme10>:first-of-type>tr>td { border-bottom:\t1px solid color100 !important;\t}\ntable.theme10>:first-of-type>tr>td { border-right:\t1px solid color100 !important;\t}\ntable.theme10>:first-of-type>tr:first-child>td { border-bottom:\t2px solid color100 !important;\t}\ntable.theme10>:first-of-type>tr:nth-child(even)>td {background-color : colorLight80 !important; }\n","table.theme11>:first-of-type>tr:first-child>td{ color:paraColor !important;}\ntable.theme11>:first-of-type>tr>td {background-color : rgb(255,255,255) !important;}\ntable.theme11>:first-of-type>tr>td { border-top\t:\t1px solid color100 !important;\t}\ntable.theme11>:first-of-type>tr>td { border-left:\t1px solid color100 !important;\t}\ntable.theme11>:first-of-type>tr>td { border-bottom:\t1px solid color100 !important;\t}\ntable.theme11>:first-of-type>tr>td { border-right:\t1px solid color100 !important;\t}\ntable.theme11>:first-of-type>tr:first-child>td { background-color : color100 !important; }\ntable.theme11>:first-of-type>tr:nth-child(even)>td {background-color : colorLight80 !important; }\n","table.theme12>:first-of-type>tr:first-child>td{ color:paraColor !important;}\ntable.theme12>:first-of-type>tr>td {background-color : rgb(255,255,255) !important;}\ntable.theme12>:first-of-type>tr:first-child>td { border-top\t:\t1px solid color100 !important;\t}\ntable.theme12>:first-of-type>tr>td:first-child { border-left\t:\t1px solid color100 !important;\t}\ntable.theme12>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t1px solid color100 !important;\t}\ntable.theme12>:first-of-type>tr>td:last-child\t{ border-right\t:\t1px solid color100 !important;\t}\ntable.theme12>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid color100 !important;\t}\ntable.theme12>:first-of-type>tr:first-child>td { background-color : color100 !important; }\ntable.theme12>:first-of-type>tr:first-child>td>div.zw-cell-container>div.zw-paragraph>div.zw-line-div>div.zw-line-content>span.zw-portion{ color:rgb(255,255,255) !important;}\ntable.theme12>:first-of-type>tr:nth-child(even)>td {background-color : colorLight80 !important; }\n","table.theme13>:first-of-type>tr:first-child>td{ color:paraColor !important;}\ntable.theme13>:first-of-type>tr>td { border-top\t:\t1px solid color100 !important;\t}\ntable.theme13>:first-of-type>tr>td { border-left:\t1px solid color100 !important;\t}\ntable.theme13>:first-of-type>tr>td { border-bottom:\t1px solid color100 !important;\t}\ntable.theme13>:first-of-type>tr>td { border-right:\t1px solid color100 !important;\t}\ntable.theme13>:first-of-type>tr:first-child>td { background-color : color100 !important; }\ntable.theme13>:first-of-type>tr>td {background-color : colorLight40 !important;}\ntable.theme13>:first-of-type>tr:nth-child(even)>td {background-color : colorLight80 !important; }\n","table.theme14>:first-of-type>tr:first-child>td{ color:paraColor !important;}\ntable.theme14>:first-of-type>tr>td:first-child { color:paraColor !important;}\ntable.theme14>:first-of-type>tr:first-child>td { border-top\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme14>:first-of-type>tr>td:first-child { border-left\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme14>:first-of-type>tr>td:last-child\t{ border-right\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme14>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme14>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme14>:first-of-type>tr>td:not(:last-child) { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme14>:first-of-type>tr>td {background-color : colorLight60 !important;}\ntable.theme14>:first-of-type>tr:first-child>td { border-top\t:\t0px solid color100 !important;\t}\ntable.theme14>:first-of-type>tr:first-child>td { border-left:\t0px solid color100 !important;\t}\ntable.theme14>:first-of-type>tr:first-child>td { border-right:\t0px solid color100 !important;\t}\ntable.theme14>:first-of-type>tr:first-child>td { background-color : color100 !important; }\ntable.theme14>:first-of-type>tr>td:first-child { background-color : color100 !important;}\ntable.theme14>:first-of-type>tr>td:first-child { border-left: 0px solid color100 !important;}\ntable.theme14>:first-of-type>tr>td:last-child { border-right: 0px solid color100 !important;}\n","table.theme15>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme15>:first-of-type>tr>td {background-color : color100 !important;}\ntable.theme15>:first-of-type>tr:first-child>td { border-bottom:\t2px solid rgb(255,255,255) !important;\t}\ntable.theme15>:first-of-type>tr:first-child>td { background-color : color100 !important; }\ntable.theme15>:first-of-type>tr>td:first-child { border-right\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme15>:first-of-type>tr:first-child>td { border-right:\t0px solid rgb(255,255,255) !important;\t}\ntable.theme15>:first-of-type>tr:nth-child(even)>td{color:paraColor !important;}\ntable.theme15>:first-of-type>tr:nth-child(odd)>td{color:paraColor !important;}\n","table.theme16>:first-of-type>tr>td:first-child { color : paraColor !important;}\ntable.theme16>:first-of-type>tr:first-child>td { color : paraColor !important; }\ntable.theme16>:first-of-type>tr:first-child>td { border-top\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme16>:first-of-type>tr>td:first-child { border-left\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme16>:first-of-type>tr>td:last-child\t{ border-right\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme16>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme16>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme16>:first-of-type>tr>td:not(:last-child) { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme16>:first-of-type>tr:first-child>td { border-right:\t0px solid color100 !important;\t}\ntable.theme16>:first-of-type>tr:first-child>td { border-left:\t0px solid color100 !important;\t}\ntable.theme16>:first-of-type>tr:first-child>td { border-top\t:\t0px solid color100 !important;\t}\ntable.theme16>:first-of-type>tr>td:first-child { border-left\t:\t0px solid color100 !important;\t}\ntable.theme16>:first-of-type>tr>td:last-child { border-right\t:\t0px solid color100 !important;\t}\ntable.theme16>:first-of-type>tr:nth-child(even)>td {background-color : colorLight60 !important; }\ntable.theme16>:first-of-type>tr:nth-child(odd)>td {background-color : colorLight80 !important; }\ntable.theme16>:first-of-type>tr:first-child>td { background-color : color100 !important; }\ntable.theme16>:first-of-type>tr>td:first-child { background-color : color100 !important;}\n","table.theme17>:first-of-type>tr:first-child>td { border-top\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme17>:first-of-type>tr>td:first-child { border-left\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme17>:first-of-type>tr>td:last-child\t{ border-right\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme17>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme17>:first-of-type>tr>td {background-color : colorLight80 !important;}\ntable.theme17>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme17>:first-of-type>tr>td:not(:last-child) { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme17>:first-of-type>tr>td:nth-child(odd) {background-color : colorLight40 !important; }\ntable.theme17>:first-of-type>tr:nth-child(odd)>td {background-color : colorLight40 !important; }\n","table.theme18>:first-of-type>tr>td {background-color : rgb(255,255,255) !important;}\ntable.theme18>:first-of-type>tr>td { border-top\t:\t1px solid color100 !important;\t}\ntable.theme18>:first-of-type>tr>td { border-left:\t1px solid color100 !important;\t}\ntable.theme18>:first-of-type>tr>td { border-bottom:\t1px solid color100 !important;\t}\ntable.theme18>:first-of-type>tr>td { border-right:\t1px solid color100 !important;\t}\ntable.theme18>:first-of-type>tr>td:nth-child(odd) {background-color : colorLight60 !important; }\n","table.theme19>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme19>:first-of-type>tr>td:not(:last-child) { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme19>:first-of-type>tr>td {background-color : colorLight80 !important;}\ntable.theme19>:first-of-type>tr>td:nth-child(odd) {background-color : colorLight40 !important; }\n","table.theme20>:first-of-type>tr:first-child>td{ color:paraColor !important;}\ntable.theme20>:first-of-type>tr>td {background-color : rgb(255,255,255) !important;}\ntable.theme20>:first-of-type>tr>td { border-top\t:\t1px solid color100 !important;\t}\ntable.theme20>:first-of-type>tr>td { border-left:\t1px solid color100 !important;\t}\ntable.theme20>:first-of-type>tr>td { border-bottom:\t1px solid color100 !important;\t}\ntable.theme20>:first-of-type>tr>td { border-right:\t1px solid color100 !important;\t}\ntable.theme20>:first-of-type>tr>td:nth-child(odd) {background-color : colorLight80 !important; }\ntable.theme20>:first-of-type>tr:first-child>td { background-color : color100 !important; }\n","table.theme21>:first-of-type>tr:first-child>td{ color:paraColor !important;}\ntable.theme21>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme21>:first-of-type>tr>td:not(:last-child) { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme21>:first-of-type>tr>td {background-color : colorLight40 !important;}\ntable.theme21>:first-of-type>tr>td:nth-child(even) {background-color : colorLight80 !important; }\ntable.theme21>:first-of-type>tr:first-child>td { background-color : color100 !important; }\n","table.theme22>:first-of-type>tr:first-child>td{ color:paraColor !important;}\ntable.theme22>:first-of-type>tr>td:first-child { color:paraColor !important;}\ntable.theme22>:first-of-type>tr:first-child>td { border-top\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme22>:first-of-type>tr>td:first-child { border-left\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme22>:first-of-type>tr>td:last-child\t{ border-right\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme22>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme22>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme22>:first-of-type>tr>td:not(:last-child) { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme22>:first-of-type>tr:first-child>td { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme22>:first-of-type>tr:first-child>td { border-left:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme22>:first-of-type>tr:first-child>td { border-top\t:\t0px solid color100 !important;\t}\ntable.theme22>:first-of-type>tr>td:nth-child(odd) {background-color : colorLight80 !important; }\ntable.theme22>:first-of-type>tr>td:nth-child(even) {background-color : colorLight40 !important; }\ntable.theme22>:first-of-type>tr:first-child>td { background-color : color100 !important; }\ntable.theme22>:first-of-type>tr>td:first-child { background-color: color100 !important;}\ntable.theme22>:first-of-type>tr>td:last-child { border-right: 0px solid color100 !important;}\n","table.theme23>:first-of-type>tr:first-child>td { border-top\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme23>:first-of-type>tr>td:first-child { border-left\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme23>:first-of-type>tr>td:last-child\t{ border-right\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme23>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme23>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme23>:first-of-type>tr>td:not(:last-child) { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme23>:first-of-type>tr>td {background-color : color100 !important;}\ntable.theme23>:first-of-type>tr:first-child>td { border-top\t:\t0px solid color100 !important;\t}\ntable.theme23>:first-of-type>tr:first-child>td { border-left:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme23>:first-of-type>tr:first-child>td { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme23>:first-of-type>tr>td:first-child { border-left: 1px solid rgb(255,255,255) !important;}\ntable.theme23>:first-of-type>tr>td:last-child { border-right: 1px solid rgb(255,255,255) !important;}\ntable.theme23>:first-of-type>tr:nth-child(even)>td{color:paraColor !important;}\ntable.theme23>:first-of-type>tr:nth-child(odd)>td{color:paraColor !important;}\n","table.theme24>:first-of-type>tr:first-child>td { color:paraColor !important;}\ntable.theme24>:first-of-type>tr>td:last-child {color:paraColor !important;}\ntable.theme24>:first-of-type>tr:first-child td { border-top\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme24>:first-of-type>tr:first-child>td { border-top\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme24>:first-of-type>tr>td:first-child { border-left\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme24>:first-of-type>tr>td:last-child\t{ border-right\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme24>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme24>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme24>:first-of-type>tr>td:not(:last-child) { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme24>:first-of-type>tr>td {background-color : colorLight60 !important;}\ntable.theme24>:first-of-type>tr:nth-child(even)>td {background-color : colorLight40 !important; }\ntable.theme24>:first-of-type>tr:first-child>td { border-top\t:\t0px solid color100 !important;\t}\ntable.theme24>:first-of-type>tr:first-child>td { border-left:\t0px solid color100 !important;\t}\ntable.theme24>:first-of-type>tr:first-child>td { border-right:\t0px solid color100 !important;\t}\ntable.theme24>:first-of-type>tr:first-child>td { background-color : color100 !important; }\ntable.theme24>:first-of-type>tr>td:last-child { background-color : color100 !important;}\ntable.theme24>:first-of-type>tr>td:first-child { border-left: 0px solid color100 !important;}\ntable.theme24>:first-of-type>tr>td:last-child { border-right: 0px solid color100 !important;}\n","table.theme25>:last-of-type>tr:last-child>td { color:paraColor !important; }\ntable.theme25>:first-of-type>tr>td:last-child { color:paraColor !important;}\ntable.theme25>:first-of-type>tr:first-child>td { border-top\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme25>:first-of-type>tr>td:first-child { border-left\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme25>:first-of-type>tr>td:last-child\t{ border-right\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme25>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme25>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme25>:first-of-type>tr>td:not(:last-child) { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme25>:first-of-type>tr>td {background-color : colorLight60 !important;}\ntable.theme25>:first-of-type>tr:nth-child(odd)>td {background-color : colorLight40 !important; }\ntable.theme25>:last-of-type>tr:last-child>td { border-bottom\t:\t0px solid color100 !important;\t}\ntable.theme25>:last-of-type>tr:last-child>td { border-left\t:\t0px solid color100 !important;\t}\ntable.theme25>:last-of-type>tr:last-child>td { border-right\t:\t0px solid color100 !important;\t}\ntable.theme25>:last-of-type>tr:last-child>td { background-color :color100 !important; }\ntable.theme25>:first-of-type>tr>td:last-child { background-color : color100 !important;}\ntable.theme25>:first-of-type>tr>td:first-child { border-left: 0px solid color100 !important;}\ntable.theme25>:first-of-type>tr>td:last-child { border-right: 0px solid color100 !important;}\n","table.theme26>:first-of-type>tr>td {background-color : rgb(255,255,255) !important;}\ntable.theme26>:first-of-type>tr>td { border-top\t:\t1px solid colorLight40 !important;\t}\ntable.theme26>:first-of-type>tr>td { border-left:\t1px solid colorLight40 !important;\t}\ntable.theme26>:first-of-type>tr>td { border-bottom:\t1px solid colorLight40 !important;\t}\ntable.theme26>:first-of-type>tr>td { border-right:\t1px solid colorLight40 !important;\t}\ntable.theme26>:first-of-type>tr:first-child>td { border-bottom:\t3px solid color100 !important;\t}\ntable.theme26>:last-of-type>tr:last-child>td { border-top\t:\t3px double color100 !important;\t}\ntable.theme26>:first-of-type>tr:nth-child(even)>td {background-color :colorLight80 !important; }\n","table.theme27>:first-of-type>tr:first-child>td{ color:paraColor !important;}\ntable.theme27>:first-of-type>tr>td {background-color : rgb(255,255,255) !important;}\ntable.theme27>:first-of-type>tr>td { border-top\t:\t1px solid color100 !important;\t}\ntable.theme27>:first-of-type>tr>td { border-left:\t1px solid color100 !important;\t}\ntable.theme27>:first-of-type>tr>td { border-bottom:\t1px solid color100 !important;\t}\ntable.theme27>:first-of-type>tr>td { border-right:\t1px solid color100 !important;\t}\ntable.theme27>:first-of-type>tr:first-child>td { background-color : color100 !important; }\ntable.theme27>:last-of-type>tr:last-child>td { border-top\t:\t3px double color100 !important;\t}\n","table.theme28>:first-of-type>tr:first-child>td{ color:paraColor !important;}\ntable.theme28>:last-of-type>tr:last-child>td { color:paraColor !important;}\ntable.theme28>:first-of-type>tr>td:last-child{ color:paraColor !important;}\ntable.theme28>:first-of-type>tr:first-child>td { border-top\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme28>:first-of-type>tr>td:first-child { border-left\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme28>:first-of-type>tr>td:last-child\t{ border-right\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme28>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme28>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme28>:first-of-type>tr>td:not(:last-child) { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme28>:first-of-type>tr:first-child>td { border-right:\t0px solid color100 !important;\t}\ntable.theme28>:first-of-type>tr:first-child>td { border-left:\t0px solid color100 !important;\t}\ntable.theme28>:first-of-type>tr:first-child>td { border-top\t:\t0px solid color100 !important;\t}\ntable.theme28>:last-of-type>tr:last-child>td { border-right\t:\t0px solid color100 !important;\t}\ntable.theme28>:last-of-type>tr:last-child>td { border-left\t:\t0px solid color100 !important;\t}\ntable.theme28>:last-of-type>tr:last-child>td { border-bottom:\t0px solid color100 !important;\t}\ntable.theme28>:first-of-type>tr:nth-child(even)>td {background-color : colorLight60 !important; }\ntable.theme28>:first-of-type>tr:nth-child(odd)>td {background-color : colorLight80 !important; }\ntable.theme28>:first-of-type>tr:first-child>td { background-color : color100 !important; }\ntable.theme28>:last-of-type>tr:last-child>td { background-color : color100 !important; }\ntable.theme28>:first-of-type>tr>td:last-child { border-right\t:\t0px solid color100 !important;\t}\ntable.theme28>:first-of-type>tr>td:last-child { border-left\t:\t0px solid color100 !important;\t}\ntable.theme28>:first-of-type>tr>td:last-child { border-top\t:\t0px solid color100 !important;\t}\ntable.theme28>:first-of-type>tr>td:last-child { background-color : color100 !important;}\ntable.theme28>:first-of-type>tr>td:first-child { border-left: 0px solid color100 !important;}\n","table.theme29>:first-of-type>tr>td:first-child {  color:paraColor !important; }\ntable.theme29>:first-of-type>tr:first-child>td {  color:paraColor !important;  }\ntable.theme29>:last-of-type>tr:last-child>td {  color:paraColor !important; }\ntable.theme29>:first-of-type>tr:first-child>td { border-top\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme29>:first-of-type>tr>td:first-child { border-left\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme29>:first-of-type>tr>td:last-child\t{ border-right\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme29>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme29>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme29>:first-of-type>tr>td:not(:last-child) { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme29>:first-of-type>tr:nth-child(even)>td {background-color : colorLight40 !important; }\ntable.theme29>:first-of-type>tr>td {background-color : colorLight60 !important;}\ntable.theme29>:first-of-type>tr:first-child>td { background-color : color100 !important; }\ntable.theme29>:last-of-type>tr:last-child>td{ border-bottom\t:\t0px solid color100 !important;\t}\ntable.theme29>:last-of-type>tr:last-child>td { border-left\t:\t0px solid color100 !important;\t}\ntable.theme29>:last-of-type>tr:last-child>td { border-right\t:\t0px solid color100 !important;\t}\ntable.theme29>:last-of-type>tr:last-child>td { background-color : color100 !important; }\ntable.theme29>:first-of-type>tr>td:first-child { background-color : color100 !important;}\ntable.theme29>:first-of-type>tr>td:first-child { border-left: 0px solid color100 !important;}\ntable.theme29>:first-of-type>tr>td:last-child { border-right: 0px solid color100 !important;}\n","table.theme30>:first-of-type>tr:first-child>td{ color:paraColor !important;}\ntable.theme30>:first-of-type>tr>td:first-child{ color:paraColor !important;}\ntable.theme30>:last-of-type>tr:last-child>td { color:paraColor !important;}\ntable.theme30>:first-of-type>tr>td:last-child{ color:paraColor !important;}\ntable.theme30>:first-of-type>tr:first-child>td { border-top\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme30>:first-of-type>tr>td:first-child { border-left\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme30>:first-of-type>tr>td:last-child\t{ border-right\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme30>:first-of-type>tr:last-child>td\t{ border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme30>:first-of-type>tr:not(:last-child)>td { border-bottom\t:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme30>:first-of-type>tr>td:not(:last-child) { border-right:\t1px solid rgb(255,255,255) !important;\t}\ntable.theme30>:first-of-type>tr:first-child>td { border-right:\t0px solid color100 !important;\t}\ntable.theme30>:first-of-type>tr:first-child>td { border-left:\t0px solid color100 !important;\t}\ntable.theme30>:first-of-type>tr:first-child>td { border-top\t:\t0px solid color100 !important;\t}\ntable.theme30>:last-of-type>tr:last-child>td { border-right\t:\t0px solid color100 !important;\t}\ntable.theme30>:last-of-type>tr:last-child>td { border-left\t:\t0px solid color100 !important;\t}\ntable.theme30>:last-of-type>tr:last-child>td { border-bottom:\t0px solid color100 !important;\t}\ntable.theme30>:first-of-type>tr:nth-child(even)>td {background-color : colorLight40 !important; }\ntable.theme30>:first-of-type>tr:nth-child(odd)>td {background-color : colorLight80 !important; }\ntable.theme30>:first-of-type>tr:first-child>td { background-color : color100 !important; }\ntable.theme30>:last-of-type>tr:last-child>td { background-color : color100 !important; }\ntable.theme30>:first-of-type>tr>td:last-child { border-right\t:\t0px solid color100 !important;\t}\ntable.theme30>:first-of-type>tr>td:last-child { border-left\t:\t0px solid color100 !important;\t}\ntable.theme30>:first-of-type>tr>td:last-child { border-top\t:\t0px solid color100 !important;\t}\ntable.theme30>:first-of-type>tr>td:last-child { background-color : color100 !important;}\ntable.theme30>:first-of-type>tr>td:first-child { background-color :color100 !important;}\ntable.theme30>:first-of-type>tr>td:first-child { border-left: 0px solid color100 !important;}\n"],r="",n=function(){PanelUtil.showMoreTableThemes(),TableLeftPanelTheme.setThemeColorForColorCircles(),c(J("#tbl-theme-clrclip")[0])},a=function(){LeftPanel.closeSubPanel("subpanel-tabletheme"),s("MultiColor")},l=function(){return[r]},s=function(e){r=e,PubSub.publish("TableThemes/colorChanged")},d=function(){var e={accent1:"tbl-theme-clr1",accent2:"tbl-theme-clr2",accent3:"tbl-theme-clr3",accent4:"tbl-theme-clr4",accent5:"tbl-theme-clr5",accent6:"tbl-theme-clr6"},t=DocUtil.copyStyle(Theme.color);for(var i in e)Z(e[i]).css("background-color",t[i]),Z(e[i]).css("border-color",A(t[i],75));var o,r=Z("themepanel"),n=r[0].innerText,a=60,l=11,d=7;for(o=1;o<d;o++){var c=t["accent"+o];n+=".ui-clrclip:nth-child("+o+"):after{\nbackground-color: "+c+";\ntransform: rotate("+a+"deg);\nz-index: "+l+";\n}",n+="\n",a+=60,l-=1}r.text(n).appendTo(document.head),u(),s("MultiColor")},c=function(e,t){J(".ui-tbl-theme-clr-active").removeClass("ui-tbl-theme-clr-active"),J("#"+e.id).addClass("ui-tbl-theme-clr-active");var i=J("#"+e.id).css("background-color");if("tbl-theme-clrclip"!=e.id){var o=e.id.split("tbl-theme-clr")[1];i="zwaccent"+o,s(i)}else s("MultiColor")},p=function(){var e,t="",i=Z("themepanel"),r="zwaccent1",n="zwaccent2",a="zwaccent3",l="zwaccent4",d="zwaccent5",c="zwaccent6",p=[1,2,3,4,5,7,9,16,19,22,29],u=["rgb(0,0,0)","","rgb(122, 122, 122)",n,a,c,l,d,n,a,r];for(t+="table.removetheme>:first-of-type>tr>td { border-top\t:\t0px solid rgb(255,255,255) !important;\t}\ntable.removetheme>:first-of-type>tr>td { border-left\t:\t0px solid rgb(255,255,255) !important;\t}\ntable.removetheme>:first-of-type>tr>td\t{ border-right\t:\t0px solid rgb(255,255,255) !important;\t}\ntable.removetheme>:first-of-type>tr>td{ border-bottom\t:\t0px solid rgb(255,255,255) !important;\t}\ntable.removetheme>:first-of-type>tr>td {background-color : rgb(255,255,255) !important;}\n",e=0;e<p.length;e++){var f=u[e];f||(f=u[0]),f=C(f);var g=v(f),m=b(f,80),h=b(f,60),T=b(f,40),E=A(f,75),R=A(f,50);t+=o[p[e]-1].replaceAll("theme"+p[e],"frontTheme"+(e+1)).replaceAll("color100",f).replaceAll("colorLight80",m).replaceAll("colorLight60",h).replaceAll("colorLight40",T).replaceAll("colorDark25",E).replaceAll("colorDark50",R).replaceAll("paraColor",g)}i.text(t).appendTo(document.head),s("MultiColor")},u=function(){J(".ui-tbl-theme-li").mouseleave(function(){clearTimeout(t),t=setTimeout(function(){h()},500)});var e,i=Z("themepanel"),r=i[0].innerText,n=l();"MultiColor"==n[0]&&(n=R());var a=30;for(e=0;e<a;e++){var s=n[e];s||(s=n[0]);var d=Utils.getColorValFromRefString(s),c=s.indexOf("/")!=-1?s.split("/")[0]:s.split("*")[0],p=b(d,80),u=b(d,60),f=b(d,40),g=b(d,20);A(d,75),A(d,50);if(s.indexOf("rgb")==-1){if(s.indexOf("/")!=-1)var p=b(d,80),u=b(d,60),f=b(d,40),g=b(d,20);if(s.indexOf("*")!=-1)if(s.indexOf("50")!=-1){var p=c+"/40",u=c+"/60",f=c+"/80",g=c+"/90";p=Utils.getColorValFromRefString(p),u=Utils.getColorValFromRefString(u),f=Utils.getColorValFromRefString(f),g=Utils.getColorValFromRefString(g)}else if(s.indexOf("75")!=-1){var p=c+"/20",u=c+"/40",f=c+"/60",g=c+"/80";p=Utils.getColorValFromRefString(p),u=Utils.getColorValFromRefString(u),f=Utils.getColorValFromRefString(f),g=Utils.getColorValFromRefString(g)}}var m=v(d);r+=o[e].replace(/color100/g,d).replace(/colorLight80/g,p).replace(/colorLight60/g,u).replace(/colorLight40/g,f).replace(/colorLight20/g,g).replace(/paraColor/g,m)}i.text(r).appendTo(document.head)},f=function(e){var t=editor.doc.getSelection().parents(NODE_TYPE.TABLE),i=e.indexOf(",");if(i!=-1)o=e.slice(i+1,e.length-1),e=e.slice(1,i);else var o=TableLeftPanelTheme.getThemeColor()[0];"theme1"==e?o="rgb(0,0,0)":"theme3"==e&&(o="rgb(122, 122, 122)"),g(t,e,o)},g=function(e,t,o){if(e&&t){J(".zw-column").children(".dummyTable").remove(),void 0==i[t]&&(t="theme1");var r=m(t,o),n={},a={};a[ATTR_TABLE.TBLS_THEMENAME]=t,a.themeObj=r,n[ATTR_TABLE.TBLS_THEME]=a,editor.doc.execCmd("applyStyle",[e,n,"tabletheme"]),O(e),Op.sendMsg(),Utils.addToStatistics("theme"),Utils.addToStatistics("table"+t),PubSub.publish("TableThemes/themeChanged")}},m=function(e,t){if("MultiColor"==t){var o=R();t=o[e.split("theme")[1]-1]}var r=i[e],n=Utils.getColorValFromRefString(t),a=t.indexOf("/")!=-1?t.split("/")[0]:t.split("*")[0],l=v(n);r.firstRow&&r.firstRow.para&&(r.firstRow.para.textFormat.fgc=l),r.lastRow&&r.lastRow.para&&(r.lastRow.para.textFormat.fgc=l),r.firstColumn&&r.firstColumn.para&&(r.firstColumn.para.textFormat.fgc=l),r.lastColumn&&r.lastColumn.para&&(r.lastColumn.para.textFormat.fgc=l),r.band1Horz&&r.band1Horz.para&&(r.band1Horz.para.textFormat.fgc=l),r.band2Horz&&r.band2Horz.para&&(r.band2Horz.para.textFormat.fgc=l);var s=b(n,80),d=b(n,60),c=b(n,40),p=b(n,20);if(a&&t.indexOf("rgb")==-1)if(t.indexOf("*")!=-1){if(t.indexOf("50")!=-1)var s=a+"/40",d=a+"/60",c=a+"/80",p=a+"/90";else if(t.indexOf("75")!=-1)var s=a+"/20",d=a+"/40",c=a+"/60",p=a+"/80"}else{var s=b(n,80),d=b(n,60),c=b(n,40),p=b(n,20);s=y(a,s),d=y(a,d),c=y(a,c),p=y(a,p)}var u=JSON.stringify(r).replaceAll("color100%",t).replaceAll("colorLight80%",s).replaceAll("colorLight60%",d).replaceAll("colorLight40%",c).replaceAll("colorLight20%",p);return JSON.parse(u)},h=function(t){for(var i=editor.doc.getParents(NODE_TYPE.TABLE,editor.doc.getSelection().getStart()),o=ViewManager.getViews(i.dtNode,editor.getPageID()),r=0;r<o.length;r++){var n=J(o[r].el);n.removeAttr("class"),n.addClass("zw-table")}clearTimeout(e),J(".zw-column").find(".dummyTable").remove()},T=function(i){var o=i.currentTarget;o=o.children[0],clearTimeout(t),clearTimeout(e),e=setTimeout(function(){for(var e=editor.doc.getParents(NODE_TYPE.TABLE,editor.doc.getSelection().getStart()),t=ViewManager.getViews(e.dtNode,editor.getPageID()),i=0;i<t.length;i++){var r=J(t[i].el);r.removeAttr("class"),r.addClass("zw-table"),r.addClass("removetheme"),r.addClass(o.id)}},200)},E=function(){s(Utils.getColorReference(arguments[1]))},R=function(){var e="zwaccent1",t="zwaccent2",i="zwaccent3",o="zwaccent4",r="zwaccent5",n="zwaccent6",a=["rgb(0,0,0)","","rgb(122, 122, 122)",r,i,n,i,t,o,e,r,n,t,o,i,e,r,o,t,o,i,i,t,n,r,i,t,n,t,n];return a},S=function(){var e=Utils.getColorReference(arguments[1]),t=editor.doc.getParents(NODE_TYPE.TABLE,editor.doc.getSelection().getStart()),i=t.attr().theme.themeName;E(null,arguments[1]),g(t,i,e)},O=function(e){var t,i=TableUtil.getTableCells(e),o=i.allCells,r=o.length,n=[],a=[];for(t=0;t<r;t++){var l=o[t];if(l.attr()[ATTR_COMMON.BORDERS]||l.attr()[ATTR_CELL.Z_TD_BGC]){a.push(l);var s={};s.removeBorder=!0,n.push(s)}}0!=Object.keys(a).length&&0!=Object.keys(n).length&&editor.doc.execCmd("applyStyle",[a,n,"tabletheme"])},v=function(e){var t=e.substring(e.indexOf("(")+1,e.lastIndexOf(")")).split(/,\s*/),i=parseInt(t[0]),o=parseInt(t[1]),r=parseInt(t[2]);return i+o+r>=620?"rgb(0,0,0)":"rgb(255,255,255)"},b=function(e,t){t/=100;var i=e.substring(e.indexOf("(")+1,e.lastIndexOf(")")).split(/,\s*/),o=parseInt(i[0]),r=parseInt(i[1]),n=parseInt(i[2]),a=Math.round(o+t*(255-o)),l=Math.round(r+t*(255-r)),s=Math.round(n+t*(255-n));return"rgb("+a+","+l+","+s+")"},A=function(e,t){var i=e.substring(e.indexOf("(")+1,e.lastIndexOf(")")).split(/,\s*/),o=parseInt(i[0]),r=parseInt(i[1]),n=parseInt(i[2]);t/=100;var a=Math.round(o*t),l=Math.round(r*t),s=Math.round(n*t);return"rgb("+a+","+l+","+s+")"},y=function(e,t){var i=C(e),o=i.substring(i.indexOf("(")+1,i.lastIndexOf(")")).split(/,\s*/),r=t.substring(t.indexOf("(")+1,t.lastIndexOf(")")).split(/,\s*/);if(255==o[0]||0==o[0]||255==r[0]||0==r[0])if(255==o[1]||0==o[1]||255==r[1]||0==r[1])var n=o[2],a=r[2];else var n=o[1],a=r[1];else var n=o[0],a=r[0];var l=(parseInt(a)-parseInt(n))/(255-parseInt(n));return e+"/"+(100-parseInt(100*l))},D=function(e,t){var i=C(e),o=i.substring(i.indexOf("(")+1,i.lastIndexOf(")")).split(/,\s*/),r=t.substring(t.indexOf("(")+1,t.lastIndexOf(")")).split(/,\s*/);if(255==o[0]||0==o[0]||255==r[0]||0==r[0])if(255==o[1]||0==o[1]||255==r[1]||0==r[1])var n=o[2],a=r[2];else var n=o[1],a=r[1];else var n=o[0],a=r[0];var l=(parseInt(n)-parseInt(a))/parseInt(n);return e+"*"+parseInt(100*l)},C=function(e){var t=/[z][w](\w|\*|\/)+/,i=/\#(\w|\*|\/)+/,o=t.test(e),r=i.test(e);if(!o&&!r)return e;var n=t.exec(e),a=i.exec(e),l=e,s=o?n[0].substr("zw".length):a[0].substr("#".length);if(s.indexOf("accent")>-1||s.indexOf("dark")>-1||s.indexOf("light")>-1){var d=null,c=null,p=null;s.indexOf("*")>-1?(d=s.split("*")[0],c=parseInt(s.split("*")[1])):s.indexOf("/")>-1?(d=s.split("/")[0],p=parseInt(s.split("/")[1])):d=s,d=Theme.color[d],l=c||p?c?A(d,100-c):b(d,100-p):d}return l};return PubSub.subscribe("TableThemes/colorChanged",u),{TableNewThemeInfo:i,getThemeColor:l,open:n,setActiveForSelectedColor:c,panelInit:p,applyTheme:f,setThemeColorForColorCircles:d,removeDummyTable:h,setDummyTable:T,changePanelBySelectedColor:E,changeThemeObjColor:S,getZWColorAfterTint:y,getZWColorAfterShade:D,close:a,getTintColor:b}}();Scale.prototype.destroy=function(){this.view.destroy(),this.unitProps=null,this.viewProps=null,this.view=null},Scale.prototype.getContent=function(){return this.view.getContent()},Scale.prototype.setWidth=function(e){this.width=e,this.view.updateWidth()},Scale.prototype.setHeight=function(e){this.height=e,this.view.updateHeight()},Scale.prototype.setZoomFactor=function(e){this.zoomFactor=e,this.view.updateScaleCSS()},Scale.prototype.setUnit=function(e){this.unit=e,this.view.contructScale()},Scale.prototype.setOrientation=function(e){if(this.orientation=e,e==ORIENTATION.HORIZONTAL&&parseFloat(this.height)>parseFloat(this.width)||e==ORIENTATION.VERTICAL&&parseFloat(this.width)>parseFloat(this.height)){var t=this.width;this.setWidth(this.height),this.setHeight(t)}this.view.contructScale()},Scale.prototype.setType=function(e){this.type=e,this.view.updateView()},Scale.prototype.attachTo=function(e){this.viewProps.parent=e,this.view.attach()};var UNIT_PROPS={in:{incrementVal:1,fragMeasurement:"1in",fragSegmentCount:8},mm:{incrementVal:20,fragMeasurement:"20mm",fragSegmentCount:4},cm:{incrementVal:1,fragMeasurement:"1cm",fragSegmentCount:10},pt:{incrementVal:36,fragMeasurement:"36pt",fragSegmentCount:6}},SCALE_TYPE={REGULAR:"REGULAR",INVERSE:"INVERSE"},SCALE_CSS_STR=" #{{sid}}.ui-scale-container .ui-fragment-container { width: {{containerwidth}}; }  #{{sid}}.ui-scale-container .ui-fragment-container { height:{{containerheight}}; }  #{{sid}}.ui-regular-scale .ui-fragment-container { counter-reset: frag-number {{regularstartingnumber}}; }  #{{sid}}.ui-inverse-scale .ui-fragment-container { counter-reset: frag-number {{inversestartingnumber}}; }  #{{sid}}.ui-horizontal-scale .ui-frag-parent span { width: {{spanwidth}}; }  #{{sid}}.ui-vertical-scale .ui-frag-parent span { height: {{spanheight}}; }  #{{sid}}.ui-scale-container .ui-frag-parent { width: {{fragwidth}}; width: {{mozfragwidth}}; }  #{{sid}}.ui-scale-container .ui-frag-parent { height: {{fragheight}}; height: {{mozfragheight}}; }  #{{sid}}.ui-regular-scale .ui-frag-parent::before { counter-increment: frag-number {{fragincrement}}; }  #{{sid}}.ui-inverse-scale .ui-frag-parent::before { counter-increment: frag-number -{{fragincrement}}; }  #{{sid}}.ui-scale-container .ui-frag-parent::before{ width: {{countertextwidth}}; width: {{mozcountertextwidth}}; } ";ScaleView.prototype.destroy=function(){this.detach(),this.scale=null,this.scaleContainer=null,this.styleTag=null},ScaleView.prototype.getContent=function(){return this.scaleContainer.outerHTML},ScaleView.prototype.getFragmentHTML=function(){for(var e="",t=0,i=this.scale.unitProps[this.scale.unit].fragSegmentCount;t<i;t++)e+="<span></span>";return e='<div class="ui-frag-parent">'+e+"</div>"},ScaleView.prototype.updateView=function(){var e=["ui-scale-container"],t=this.scale.viewProps.classStr;e.push(t||""),this.scale.orientation==ORIENTATION.HORIZONTAL?e.push("ui-horizontal-scale"):e.push("ui-vertical-scale"),this.scale.type==SCALE_TYPE.REGULAR?e.push("ui-regular-scale"):e.push("ui-inverse-scale"),this.scaleContainer.className=e.join(" ")},ScaleView.prototype.getFragmentCount=function(){var e,t=this.scale.unitProps[this.scale.unit];e=this.scale.orientation==ORIENTATION.HORIZONTAL?this.scale.maxWidth:this.scale.maxHeight;var i=Math.ceil(e.convertUnitTo(this.scale.unit)/parseFloat(t.fragMeasurement));return i+10},ScaleView.prototype.contructScale=function(){var e=this.getFragmentCount();this.updateScaleHTML(e),this.updateScaleCSS(e),this.updateView()},ScaleView.prototype.updateScaleHTML=function(e){e=e||this.getFragmentCount();for(var t="",i=this.getFragmentHTML(),o=0;o<e;o++)t+=i;t='<div class="ui-fragment-container">'+t+"</div>",this.scaleContainer.innerHTML=t},ScaleView.prototype.updateScaleCSS=function(e){e=e||this.getFragmentCount();var t=this.scale.unitProps[this.scale.unit],i=t.incrementVal*e,o=0,r=t.incrementVal+i;i*=this.scale.zoomFactor;var n=parseFloat(t.fragMeasurement)*this.scale.zoomFactor,a=1/t.fragSegmentCount*100+"%",l=n+this.scale.unit,s=l;this.scale.unit==RULER_UNITS.MM&&(s=n+"mozmm");var d,c,p,u,f,g;this.scale.orientation==ORIENTATION.HORIZONTAL?(d=i+this.scale.unit,p=a,f=l,mozfragWidth=s,c=u=g=mozfragHeight="inherit"):(c=i+this.scale.unit,u=a,g=l,mozfragHeight=s,d=p=f=mozfragWidth="inherit");var m=SCALE_CSS_STR.replace(/\{\{sid\}\}/g,this.scale.id);m=m.replace(/\{\{containerwidth\}\}/,d),m=m.replace(/\{\{containerheight\}\}/,c),m=m.replace(/\{\{spanwidth\}\}/,p),m=m.replace(/\{\{spanheight\}\}/,u),m=m.replace(/\{\{fragwidth\}\}/,f),m=m.replace(/\{\{mozfragwidth\}\}/,mozfragWidth),m=m.replace(/\{\{fragheight\}\}/,g),m=m.replace(/\{\{mozfragheight\}\}/,mozfragHeight),m=m.replace(/\{\{regularstartingnumber\}\}/,o),m=m.replace(/\{\{inversestartingnumber\}\}/,r),m=m.replace(/\{\{fragincrement\}\}/g,t.incrementVal),m=m.replace(/\{\{countertextwidth\}\}/,l),m=m.replace(/\{\{mozcountertextwidth\}\}/,s),this.styleTag.innerHTML=m},ScaleView.prototype.updateWidth=function(){this.scaleContainer.style.width=this.scale.width},ScaleView.prototype.updateHeight=function(){this.scaleContainer.style.height=this.scale.height},ScaleView.prototype.attach=function(){document.head.appendChild(this.styleTag),this.scale.viewProps.parent.appendChild(this.scaleContainer)},ScaleView.prototype.detach=function(){document.head.removeChild(this.styleTag),this.scale.viewProps.parent&&this.scale.viewProps.parent.removeChild(this.scaleContainer)};var RULER_UNITS={INCH:"in",MM:"mm",CM:"cm",POINT:"pt",PIXELS:"px"},UNIT_VALUE_PER_INCH={px:96,in:1,cm:2.54,mm:25.4,pt:72,pc:862};String.prototype.convertUnitTo=function(e){var t=parseFloat(this),i=this.search(/(px|in|cm|mm|pt|pc)$/i);if(NaN==t||i==-1)return this;var o=this.substring(i);return t*=UNIT_VALUE_PER_INCH[e]/UNIT_VALUE_PER_INCH[o]},Number.prototype.isBetween=function(e,t,i){return i?e<=this&&this<=t:e<this&&this<t},Number.prototype.contains=function(e){return(this&e)==e},Number.prototype.convertUnit=function(e,t){return this*UNIT_VALUE_PER_INCH[t]/UNIT_VALUE_PER_INCH[e]};var ORIENTATION={HORIZONTAL:"HORIZONTAL",VERTICAL:"VERTICAL"},ORIENTATION_PROPS={HORIZONTAL:{axis:"x",start:"left",end:"right",sizeProp:"width"},VERTICAL:{axis:"y",start:"top",end:"bottom",sizeProp:"height"}},PROCESSING_TYPE={REGULAR:1,INVERSE:-1},RulerUtil=function(){var e=function(e){return{left:t(e),top:i(e)}},t=function(e){var t=0;do t+=e.offsetLeft,e=e.offsetParent;while(null!=e);return t},i=function(e){var t=0;do t+=e.offsetTop,e=e.offsetParent;while(null!=e);return t},o=function(e,t){var i={};if(t==ALIGN.FRONT)i={start:0,end:e};else if(t==ALIGN.MIDDLE){var o=e/2;i={start:o,end:o}}else t==ALIGN.REAR&&(i={start:e,end:0});return i};return{getElemOffset:e,getOffsetLeft:t,getOffsetTop:i,getDeltaRelativeToAlignment:o}};RulerUtil=RulerUtil(),RulerCustomObject.prototype.createContent=function(){var e=document.createElement("div");e.id=this.id,e.style.width=this.width,e.style.height=this.height,e.className=this.classStr,this.node=e},RulerCustomObject.prototype.setWidth=function(e){this.width=e,this.node.style.width=e},RulerCustomObject.prototype.setHeight=function(e){this.height=e,this.node.style.height=e},RulerCustomObject.prototype.attachTo=function(e){this.parent=e,this.parent.appendChild(this.node)},RulerCustomObject.prototype.detach=function(e){this.parent&&this.parent.removeChild(this.node)},RulerCustomObject.prototype.detroy=function(e){this.detach(),this.parent=null,this.node=null},RulerElement.prototype.getContainer=function(){return this.view.getContainer()},RulerElement.prototype.setDraggable=function(e){this.isDraggable=e},RulerElement.prototype.setDragRect=function(e){this.dragRect=e},RulerElement.prototype.setZoomFactor=function(e){this.zoomFactor=e,this.view.updateWidth(),this.view.updateHeight(),this.view.updatePosition()},RulerElement.prototype.setResizable=function(e){this.resizableOption=e,this.view.updateView()},RulerElement.prototype.updateResizeMargin=function(){this.resizeMargin=this.sizeInPx*this.resizeMarginRatio},RulerElement.prototype.setWidth=function(e){this.width=e,this.widthInPx=e.convertUnitTo(RULER_UNITS.PIXELS),this.orientation===ORIENTATION.HORIZONTAL&&(this.sizeInPx=this.widthInPx,this.updateResizeMargin()),this.updateRect(),this.view&&(this.view.updatePosition(),this.view.updateWidth())},RulerElement.prototype.setHeight=function(e){this.height=e,this.heightInPx=e.convertUnitTo(RULER_UNITS.PIXELS),this.orientation===ORIENTATION.VERTICAL&&(this.sizeInPx=this.heightInPx,this.updateResizeMargin()),this.updateRect(),this.view&&(this.view.updatePosition(),this.view.updateHeight())},RulerElement.prototype.setMaxSize=function(e){this.maxSize=e,this.maxSizeInPx=e.convertUnitTo(RULER_UNITS.PIXELS)},RulerElement.prototype.setMinSize=function(e){this.minSize=e,this.minSizeInPx=e.convertUnitTo(RULER_UNITS.PIXELS)},RulerElement.prototype.setOffset=function(e){this.offset=e,this.updateRect(),this.view&&this.view.updatePosition()},RulerElement.prototype.getRect=function(e,t){var i,o,r=ORIENTATION_PROPS[this.orientation].start,n=ORIENTATION_PROPS[this.orientation].end;this.orientation===ORIENTATION.HORIZONTAL?(i=t,o=this.heightInPx):(i=this.widthInPx,o=t);var a={left:e.left,right:e.left+i,top:e.top,bottom:e.top+o},l=RulerUtil.getDeltaRelativeToAlignment(t,this.align);return a[r]=e[r]-l.start,a[n]=e[r]+l.end,a},RulerElement.prototype.updateRect=function(){this.width&&this.height&&this.offset&&(this.rect=this.getRect(this.offset,this.sizeInPx))},RulerElement.prototype.destroy=function(){this.view.destroy(),this.offset=null,this.rect=null,this.dragRect=null,this.viewProps=null,this.eventProps=null,this.ruler=null,this.view=null,this.currentOperation=null},RulerElement.prototype.attachTo=function(e){this.viewProps.parent=e,this.view.attach()},RulerElement.prototype.remove=function(){this.view.detach()},RulerElement.prototype.handleMouseDown=function(e,t,i){return this.currentOperation={type:e.type,clickType:e.clickType,mouseDownCoords:t,originalOffset:{left:this.offset.left,top:this.offset.top},originalSizeInPx:this.sizeInPx},PubSub.publish(this.ruler.id+"/MouseDown",this.eventProps,this.currentOperation.clickType,this,t,i),this.rect},RulerElement.prototype.handleMouseUp=function(e,t){ORIENTATION_PROPS[this.orientation].axis;if(this.currentOperation&&this.currentOperation.type){var i=this.currentOperation.mouseDownCoords,o=this.processDisplacement(i,e);PubSub.publish(this.ruler.id+"/MouseUp",this.eventProps,this.currentOperation.clickType,this,e,t,o),this.currentOperation=null}},RulerElement.prototype.handleMouseMove=function(e,t){if(this.currentOperation&&this.currentOperation.type){var i=this.processDisplacement(this.currentOperation.mouseDownCoords,e);return this.hideOutOfDragRect&&i.outOfRect?(this.view.hide(),null):(this.view.show(),PubSub.publish(this.ruler.id+"/MouseMove",this.eventProps,this.currentOperation.clickType,this,e,t,i),i.newRect)}},RulerElement.prototype.updateDisplacement=function(e){e.offset&&this.setOffset(e.offset),this.orientation===ORIENTATION.HORIZONTAL?this.setWidth(e.sizeInPx+RULER_UNITS.PIXELS):this.setHeight(e.sizeInPx+RULER_UNITS.PIXELS)},RulerElement.prototype.processDisplacement=function(e,t){var i=ORIENTATION_PROPS[this.orientation].axis,o=t[i]-e[i],r=ORIENTATION_PROPS[this.orientation].start,n=ORIENTATION_PROPS[this.orientation].end,a={offset:{left:this.currentOperation.originalOffset.left,top:this.currentOperation.originalOffset.top},sizeInPx:this.sizeInPx,displacement:0};if("drag"===this.currentOperation.type){var l=a.offset[r];if(0==o||l==this.dragRect[r]&&o<0||l==this.dragRect[n]&&o>0)a.displacement=0;else{o*=this.computationFactor;var s=o;this.actualValue&&(s+=this.actualValue);var d=Math.round(s/this.ruler.roundingFactor)*this.ruler.roundingFactor,c=d-s;a.displacement=(o+c)*this.computationFactor}var p=l+a.displacement;p>this.dragRect[n]?p=this.dragRect[n]:p<this.dragRect[r]&&(p=this.dragRect[r]),a.displacement=p-l,a.offset[r]=p,a.newRect=this.getRect(a.offset,a.sizeInPx),t.x.isBetween(this.dragRect.left,this.dragRect.right,!0)&&t.y.isBetween(this.dragRect.top,this.dragRect.bottom,!0)?a.outOfRect=!1:a.outOfRect=!0}else if("resizeBefore"===this.currentOperation.type||"resizeAfter"===this.currentOperation.type){var u,f=this.currentOperation.originalSizeInPx,g=this.align==ALIGN.MIDDLE?2*o:o;g=Math.round(g/this.ruler.roundingFactor)*this.ruler.roundingFactor,"resizeBefore"===this.currentOperation.type?(u=f-g,u<this.minSizeInPx?u=this.minSizeInPx:this.maxSizeInPx<u&&(u=this.maxSizeInPx),g=u-f,o=this.align==ALIGN.MIDDLE?g/2:g,this.align==ALIGN.FRONT&&(a.displacement=o,a.offset[r]-=o)):(u=f+g,u<this.minSizeInPx?u=this.minSizeInPx:this.maxSizeInPx<u&&(u=this.maxSizeInPx)),a.sizeInPx=u,a.newRect=this.getRect(a.offset,a.sizeInPx),a.changeInSize=u-f}return a};var RESIZABLE_TYPE={NONE:0,BEFORE:1,AFTER:2},ALIGN={FRONT:0,MIDDLE:1,REAR:2};TableResizeElement.prototype=Object.create(RulerElement.prototype),TableResizeElement.prototype.constructor=TableResizeElement,TabPointElement.prototype=Object.create(RulerElement.prototype),TabPointElement.prototype.constructor=TabPointElement,IndentElement.prototype=Object.create(RulerElement.prototype),IndentElement.prototype.constructor=IndentElement,RulerElementView.prototype.getContainer=function(){return this.elementNode},RulerElementView.prototype.show=function(){this.elementNode.style.display="block"},RulerElementView.prototype.hide=function(){this.elementNode.style.display="none"},RulerElementView.prototype.updateWidth=function(){var e=this.getWidth();this.elementNode.style.width=e+RULER_UNITS.PIXELS},RulerElementView.prototype.getWidth=function(){var e=this.element.widthInPx;return this.element.orientation==ORIENTATION.HORIZONTAL&&(e*=this.element.zoomFactor),e},RulerElementView.prototype.updateHeight=function(){var e=this.getHeight();this.elementNode.style.height=e+RULER_UNITS.PIXELS},RulerElementView.prototype.getHeight=function(){var e=this.element.heightInPx;return this.element.orientation==ORIENTATION.VERTICAL&&(e*=this.element.zoomFactor),e},RulerElementView.prototype.updateView=function(){this.elementNode.className=this.element.viewProps.classStr||"",this.element.viewProps.zIndex&&(this.elementNode.style.zIndex=this.element.viewProps.zIndex),this.updatePosition(),this.updateWidth(),this.updateHeight()},RulerElementView.prototype.updatePosition=function(){var e=this.getOffset();this.elementNode.style.left=e.left+RULER_UNITS.PIXELS,this.elementNode.style.top=e.top+RULER_UNITS.PIXELS},RulerElementView.prototype.getOffset=function(){var e=this.element.rect.top,t=this.element.rect.left;return this.element.orientation==ORIENTATION.HORIZONTAL?t*=this.element.zoomFactor:e*=this.element.zoomFactor,{left:t,top:e}},RulerElementView.prototype.attach=function(){this.element.viewProps.parent.appendChild(this.elementNode),this.attached=!0,this.updateView()},RulerElementView.prototype.detach=function(){this.element.viewProps.parent&&this.element.viewProps.parent.removeChild(this.elementNode),this.attached=!1},RulerElementView.prototype.destroy=function(){this.attached&&this.detach(this.elementNode),this.element.viewProps.parent=null,this.elementNode=null,this.element=null},RulerEvtHandler.prototype.bindEvents=function(){this.eventNode.addEventListener("mousedown",this.mouseDownHandler),this.eventNode.addEventListener("mouseup",this.mouseUpHandler),this.eventNode.addEventListener("mousemove",this.mouseMoveHandler),this.eventNode.addEventListener("mouseout",this.mouseOutHandler)},RulerEvtHandler.prototype.unbindEvents=function(){this.eventNode.removeEventListener("mousedown",this.mouseDownHandler),this.eventNode.removeEventListener("mouseup",this.mouseUpHandler),this.eventNode.removeEventListener("mousemove",this.mouseMoveHandler),this.eventNode.removeEventListener("mouseout",this.mouseOutHandler)},RulerEvtHandler.prototype.destroy=function(){this.unbindEvents(),this.ruler.container.removeChild(this.eventNode),this.ruler.container.removeChild(this.lineNode),this.ruler=null,this.eventNode=null,this.lineNode=null,this.mouseDownHandler=null,this.mouseUpHandler=null,this.mouseMoveHandler=null,this.mouseOutHandler=null,this.currentOperation=null,this.hoverOperation=null,this.mouseCoords=null},RulerEvtHandler.prototype.getObsoluteOffset=function(e){return{left:this.ruler.containerRect.left+e.left,top:this.ruler.containerRect.top+e.top}},RulerEvtHandler.prototype.getRelativeCoords=function(e){var t={x:e.x-this.ruler.containerRect.left,y:e.y-this.ruler.containerRect.top},i=ORIENTATION_PROPS[this.ruler.orientation].axis;return t[i]=t[i]/this.ruler.zoomFactor,t},RulerEvtHandler.prototype.findElementAt=function(e){var t,i,o=null;for(t in this.ruler.elements)i=this.ruler.elements[t],e.x.isBetween(i.rect.left,i.rect.right,!0)&&e.y.isBetween(i.rect.top,i.rect.bottom,!0)&&(!o||o.priority<i.priority)&&(o=i);return o},RulerEvtHandler.prototype.getCurrentOperationAt=function(e){var t=this.findElementAt(e);if(t&&t.shouldHandleEvent){var i,o=t.resizableOption,r=ORIENTATION_PROPS[t.orientation].axis,n=ORIENTATION_PROPS[t.orientation].start,a=ORIENTATION_PROPS[t.orientation].end;return i=o.contains(RESIZABLE_TYPE.BEFORE)&&e[r].isBetween(t.rect[n],t.rect[n]+t.resizeMargin,!0)?"resizeBefore":o.contains(RESIZABLE_TYPE.AFTER)&&e[r].isBetween(t.rect[a]-t.resizeMargin,t.rect[a],!0)?"resizeAfter":t.isDraggable&&e[r].isBetween(t.rect[n]+t.resizeMargin,t.rect[a]-t.resizeMargin)?"drag":"none",{element:t,type:i}}return null},RulerEvtHandler.prototype.mouseDownHandler=function(e){if(!this.currentOperation){this.eventNode.removeAttribute("title");var t=Utils.getCorrectedCoord(e),i=this.getRelativeCoords(t);if(this.mouseCoords.x==i.x&&this.mouseCoords.y==i.y||(this.mouseCoords=i),this.currentOperation=this.getCurrentOperationAt(this.mouseCoords),0==e.button){if(!this.currentOperation)return;this.currentOperation.clickType="leftClick";var o=this.currentOperation.element.handleMouseDown(this.currentOperation,i,t);"none"!==this.currentOperation.type&&this.updateLineDiv(o)}else{if(2!=e.button)return;if(!this.currentOperation)return;this.currentOperation.clickType="rightClick",this.currentOperation.element.handleMouseDown(this.currentOperation,i,t)}}},RulerEvtHandler.prototype.mouseUpHandler=function(e){if(this.currentOperation){var t=Utils.getCorrectedCoord(e),i=this.getRelativeCoords(t);this.currentOperation.element.handleMouseUp(i,t),this.currentOperation=null,this.lineNode.style.display="none"}},RulerEvtHandler.prototype.mouseMoveHandler=function(e){var t=Utils.getCorrectedCoord(e);if(this.mouseCoords=this.getRelativeCoords(t),this.currentOperation){var i=this.currentOperation.element.handleMouseMove(this.mouseCoords,t);this.updateLineDiv(i)}else{this.hoverOperation=this.getCurrentOperationAt(this.mouseCoords);var o="auto";if(this.hoverOperation){var r=this.hoverOperation.element;if("drag"==this.hoverOperation.type?o="pointer":"resizeBefore"==this.hoverOperation.type?o=r.orientation===ORIENTATION.HORIZONTAL?"w-resize":"n-resize":"resizeAfter"==this.hoverOperation.type&&(o=r.orientation===ORIENTATION.HORIZONTAL?"e-resize":"s-resize"),this.hoverOperation.element.title){var n;n=r.orientation===ORIENTATION.HORIZONTAL?{left:(r.rect.left+r.rect.right)/2,top:r.rect.bottom}:{left:r.rect.right,top:(r.rect.top+r.rect.bottom)/2};var a={componentOptions:{content:r.title,offset:this.getObsoluteOffset(n),calloutHideMode:!0}};this.eventNode.setAttribute("title",JSON.stringify(a))}}this.eventNode.style.cursor=o}},RulerEvtHandler.prototype.mouseOutHandler=function(e){this.eventNode.removeAttribute("title")},RulerEvtHandler.prototype.updateLineDiv=function(e){if(null==e)return void(this.lineNode.style.display="none");var t=this.currentOperation.element,i={left:this.ruler.containerRect.left+e.right,top:this.ruler.containerRect.top+e.bottom},o=ORIENTATION_PROPS[t.orientation].start,r=ORIENTATION_PROPS[t.orientation].end,n=this.ruler.containerRect[o];if("resizeBefore"===this.currentOperation.type)i[o]=e[o]*t.zoomFactor;else if("resizeAfter"===this.currentOperation.type)i[o]=e[r]*t.zoomFactor;else if("drag"===this.currentOperation.type){var a=0;t.align==ALIGN.FRONT?a=e[o]:t.align==ALIGN.MIDDLE?a=(e[o]+e[r])/2:t.align==ALIGN.REAR&&(a=e[r]),i[o]=a*t.zoomFactor}i[o]+=n,this.lineNode.style.display="block",this.lineNode.style.left=i.left+RULER_UNITS.PIXELS,this.lineNode.style.top=i.top+RULER_UNITS.PIXELS},Ruler.prototype.updateRect=function(){var e=RulerUtil.getElemOffset(this.container);this.containerRect={left:e.left,top:e.top,right:e.left+this.widthInPx,bottom:e.top+this.heightInPx}},Ruler.prototype.getComputedProps=function(e){var t,i,o=e.convertUnitTo(RULER_UNITS.PIXELS);return this.orientation==ORIENTATION.HORIZONTAL?(t=o,i=this.heightInPx):(t=this.widthInPx,i=o),{size:e,sizeInPx:o,width:t+RULER_UNITS.PIXELS,height:i+RULER_UNITS.PIXELS}},Ruler.prototype.setZoomFactor=function(e){this.zoomFactor=e,this.view&&(this.view.updateWidth(),this.view.updateHeight())},Ruler.prototype.setInteractable=function(e){this.isInteractable=e,this.isInteractable?this.evtHandler=this.evtHandler?this.evtHandler:new RulerEvtHandler(this):(this.evtHandler&&this.evtHandler.destroy(),this.evtHandler=null)},Ruler.prototype.setWidth=function(e){this.width=e,this.widthInPx=this.width.convertUnitTo(RULER_UNITS.PIXELS),this.orientation===ORIENTATION.HORIZONTAL&&(this.sizeInPx=this.widthInPx),this.view&&this.view.updateWidth()},Ruler.prototype.setHeight=function(e){this.height=e,this.heightInPx=this.height.convertUnitTo(RULER_UNITS.PIXELS),this.orientation===ORIENTATION.VERTICAL&&(this.sizeInPx=this.heightInPx),this.view&&this.view.updateHeight()},Ruler.prototype.setUnit=function(e){this.unit=e},Ruler.prototype.setOrientation=function(e){if(this.orientation=e,e==ORIENTATION.HORIZONTAL&&this.heightInPx>this.widthInPx||e==ORIENTATION.VERTICAL&&this.widthInPx>this.heightInPx){var t=this.width;this.setWidth(this.height),this.setHeight(t)}},Ruler.prototype.setDirection=function(e){this.direction=e},Ruler.prototype.addElement=function(e,t){this.elements[e]=t,t.attachTo(this.container)},Ruler.prototype.removeElement=function(e){var t=this.elements[e];return t&&t.remove(),delete this.elements[e],t},Ruler.prototype.reset=function(){var e,t;for(e in this.elements)this.elements[e].retainOnReset||(t=this.removeElement(e),t&&t.destroy())},Ruler.prototype.attachTo=function(e){this.viewProps.parent=e,this.view.attach(),this.updateRect()},Ruler.prototype.destroy=function(){this.reset(),this.setInteractable(!1),this.elements=null,this.view.destroy(),this.viewProps.parent=null,this.viewProps=null,this.view=null,this.containerRect=null};var DIRECTION={LEFT_TO_RIGHT:1,RIGHT_TO_LEFT:2,TOP_TO_BOTTOM:3,BOTTOM_TO_TOP:4};RulerView.prototype.updateWidth=function(){var e=this.ruler.widthInPx;this.ruler.orientation==ORIENTATION.HORIZONTAL&&(e*=this.ruler.zoomFactor),this.ruler.container.style.width=e+RULER_UNITS.PIXELS},RulerView.prototype.updateHeight=function(){var e=this.ruler.heightInPx;this.ruler.orientation==ORIENTATION.VERTICAL&&(e*=this.ruler.zoomFactor),this.ruler.container.style.height=e+RULER_UNITS.PIXELS},RulerView.prototype.attach=function(){this.ruler.viewProps.parent.appendChild(this.ruler.container)},RulerView.prototype.destroy=function(){this.ruler.viewProps.parent.removeChild(this.ruler.container),this.ruler.container=null,this.ruler=null};var MARGIN_AREA={BEFORE:"before",AFTER:"after"},COLUMN_SPACE_PROPS={PAGE_COLUMN:{resizableOption:RESIZABLE_TYPE.BEFORE|RESIZABLE_TYPE.AFTER,resizeMarginRatio:.5,classStr:"ui-ruler-icon ui-ruler-colspace",updateOnMouseMove:!1,isDraggable:!1,shouldHandleEvent:!0,defaultSize:"25px",groupName:"PageColumnSpace",title:J.i18n("writer.common.RULER.RESIZE_PAGE_COLUMN")},TABLE_COLUMN:{resizableOption:RESIZABLE_TYPE.NONE,resizeMarginRatio:0,classStr:"ui-ruler-icon ui-ruler-tablecolspace",updateOnMouseMove:!0,isDraggable:!0,shouldHandleEvent:!0,defaultSize:"12px",groupName:"TableColumnSpace",title:J.i18n("writer.common.RULER.RESIZE_TABLE_COLUMN")}},MARGIN_TITLE={HORIZONTAL:{before:J.i18n("writer.common.RULER.LeftMargin"),after:J.i18n("writer.common.RULER.RightMargin")},VERTICAL:{before:J.i18n("writer.common.RULER.TOP_MARGIN"),after:J.i18n("writer.common.RULER.BOTTOM_MARGIN")}};ZWRuler.prototype=Object.create(Ruler.prototype),ZWRuler.prototype.constructor=ZWRuler,ZWRuler.prototype.setZoomFactor=function(e){Ruler.prototype.setZoomFactor.call(this,e),this.scale1&&this.scale1.setZoomFactor(e),this.scale2&&this.scale2.setZoomFactor(e);for(var t in this.elements){var i=this.elements[t];i.setZoomFactor(e)}},ZWRuler.prototype.setRulerLayoutProps=function(e){this.layoutProps=e,this.processMarginProps(),this.processColumnProps(),this.setMarginMinMaxSize()},ZWRuler.prototype.processMarginProps=function(){this.computedMargins.before=this.getComputedMargin(MARGIN_AREA.BEFORE,this.layoutProps.marginBefore.size),this.marginBeforeElement?this.updateMarginElement(this.marginBeforeElement,this.computedMargins.before.size,this.getMarginBeforeOffset()):this.createMarginBefore(),this.computedMargins.after=this.getComputedMargin(MARGIN_AREA.AFTER,this.layoutProps.marginAfter.size),this.marginAfterElement?this.updateMarginElement(this.marginAfterElement,this.computedMargins.after.size,this.getMarginAfterOffset()):this.createMarginAfter()},ZWRuler.prototype.getComputedMargin=function(e,t){var i,o,r=t.convertUnitTo(RULER_UNITS.PIXELS),n=0,a=0;return this.orientation==ORIENTATION.HORIZONTAL?(i=r,o=this.heightInPx,n=e===MARGIN_AREA.BEFORE?0:this.widthInPx-r):(i=this.widthInPx,o=r,a=e===MARGIN_AREA.BEFORE?0:this.heightInPx-r),{size:t,sizeInPx:r,width:i+RULER_UNITS.PIXELS,height:o+RULER_UNITS.PIXELS,rect:{top:a,left:n,bottom:a+o,right:n+i}}},ZWRuler.prototype.createMarginBefore=function(){var e={id:this.id+"margin-before-element",rulerInstance:this,orientation:this.orientation,zoomFactor:this.zoomFactor,width:this.computedMargins.before.width,height:this.computedMargins.before.height,offset:this.getMarginBeforeOffset(),viewProps:{parent:this.container,classStr:"ui-ruler-margin"},eventProps:{groupName:"MarginBefore"},priority:3,shouldHandleEvent:!0,isDraggable:!1,align:ALIGN.FRONT,resizableOption:RESIZABLE_TYPE.AFTER,resizeMarginRatio:1,title:MARGIN_TITLE[this.orientation].before,updateOnMouseMove:!0,retainOnReset:!0};this.marginBeforeElement=new RulerElement(e),this.addElement(this.marginBeforeElement.id,this.marginBeforeElement)},ZWRuler.prototype.getMarginBeforeOffset=function(){return{left:this.computedMargins.before.rect.left,top:this.computedMargins.before.rect.top}},ZWRuler.prototype.getMarginAfterOffset=function(){return{left:this.orientation===ORIENTATION.HORIZONTAL?this.computedMargins.after.rect.right:this.computedMargins.after.rect.left,top:this.orientation===ORIENTATION.VERTICAL?this.computedMargins.after.rect.bottom:this.computedMargins.after.rect.top}},ZWRuler.prototype.createMarginAfter=function(){var e={id:this.id+"margin-after-element",rulerInstance:this,orientation:this.orientation,zoomFactor:this.zoomFactor,width:this.computedMargins.after.width,height:this.computedMargins.after.height,offset:this.getMarginAfterOffset(),viewProps:{parent:this.container,classStr:"ui-ruler-margin"},eventProps:{groupName:"MarginAfter"},priority:3,shouldHandleEvent:!0,isDraggable:!1,align:ALIGN.REAR,resizableOption:RESIZABLE_TYPE.BEFORE,resizeMarginRatio:1,title:MARGIN_TITLE[this.orientation].after,updateOnMouseMove:!0,retainOnReset:!0};this.marginAfterElement=new RulerElement(e),this.addElement(this.marginAfterElement.id,this.marginAfterElement)},ZWRuler.prototype.updateMarginElement=function(e,t,i){this.orientation===ORIENTATION.HORIZONTAL?e.setWidth(t):e.setHeight(t),e.setOffset(i)},ZWRuler.prototype.setMarginMinMaxSize=function(){this.marginBeforeElement.setMinSize(this.layoutProps.marginBefore.minSize),this.marginAfterElement.setMinSize(this.layoutProps.marginAfter.minSize);var e=this.computedColProps.columnArea[0],t=this.computedColProps.columnArea[this.layoutProps.columnCount-1],i=this.computedMargins.before.sizeInPx+e.sizeInPx-this.layoutProps.minColumnAreaInPx,o=this.computedMargins.after.sizeInPx+t.sizeInPx-this.layoutProps.minColumnAreaInPx;if(this.layoutProps.columnType==COLUMN_TYPE.PAGE){if(this.indentProps&&1==this.layoutProps.columnCount&&(this.direction===DIRECTION.LEFT_TO_RIGHT||this.direction===DIRECTION.RIGHT_TO_LEFT)){var r=Math.max(this.indentProps[TABSELECTORS.RIGHTINDENT].value,0),n=Math.max(this.indentProps[TABSELECTORS.LEFTINDENT].value,this.indentProps[TABSELECTORS.FIRSTLINEINDENT].value,0);i-=n+r,o-=n+r}}else{var a=this.sizeInPx-(this.computedMargins.before.sizeInPx+this.computedMargins.after.sizeInPx);i=this.sizeInPx-a}i<this.computedMargins.before.sizeInPx&&(i=this.computedMargins.before.sizeInPx),o<this.computedMargins.after.sizeInPx&&(o=this.computedMargins.after.sizeInPx),i=this.layoutProps.marginBefore.maxSize||i+RULER_UNITS.PIXELS,o=this.layoutProps.marginAfter.maxSize||o+RULER_UNITS.PIXELS,this.marginBeforeElement.setMaxSize(i),this.marginAfterElement.setMaxSize(o)},ZWRuler.prototype.processColumnProps=function(){this.removeAllColumnSpaceElements(),this.computeColProps(),this.currentColumnElement?this.updateCurrentColumnElement():this.createCurrentColumnElement(),this.createColumnSpaceElements()},ZWRuler.prototype.updateCurrentColumnElement=function(){var e=this.getCurrentColumnProps();this.orientation===ORIENTATION.HORIZONTAL?this.currentColumnElement.setWidth(e.size):this.currentColumnElement.setHeight(e.size);var t={left:e.rect.left,top:e.rect.top};this.currentColumnElement.setOffset(t)},ZWRuler.prototype.createCurrentColumnElement=function(){var e=this.getCurrentColumnProps(),t={id:this.id+"column-area-element",rulerInstance:this,orientation:this.orientation,zoomFactor:this.zoomFactor,width:e.width,height:e.height,offset:e.offset,viewProps:{parent:this.container},eventProps:{groupName:"ActiveColumn"},priority:2,shouldHandleEvent:!0,isDraggable:!1,resizableOption:RESIZABLE_TYPE.NONE,align:ALIGN.FRONT,retainOnReset:!0};this.currentColumnElement=new RulerElement(t),this.addElement(this.currentColumnElement.id,this.currentColumnElement)},ZWRuler.prototype.computeColProps=function(){this.computedColProps={columnArea:[],columnSpace:[]};var e=ORIENTATION_PROPS[this.orientation].start,t={top:0,left:0};t[e]=this.computedMargins.before.sizeInPx;for(var i,o,r=this.layoutProps.columnCount,n=this.layoutProps.columnSpaces.length,a=COLUMN_SPACE_PROPS[this.layoutProps.columnType],l=0;l<r;l++)i=this.getComputedProps(this.layoutProps.columns[l]),i.offset={left:t.left,top:t.top},i.align=ALIGN.FRONT,i.rect=this.getComputedColRect(i),this.computedColProps.columnArea[l]=i,this.computedColProps.columnArea[l].id=this.id+"column-area-element"+l,t[e]+=i.sizeInPx,l<n&&(i={},this.layoutProps.columnType==COLUMN_TYPE.PAGE?(o=this.layoutProps.columnSpaces[l],i=this.getComputedProps(o),i.offset={left:t.left,top:t.top},i.offset[ORIENTATION_PROPS[this.orientation].start]+=i.sizeInPx/2,i.align=ALIGN.MIDDLE,t[e]+=i.sizeInPx):(o=a.defaultSize,i=this.getComputedProps(o),i.offset={left:t.left,top:t.top},i.align=ALIGN.MIDDLE),i.rect=this.getComputedColRect(i),this.computedColProps.columnSpace[l]=i,this.computedColProps.columnSpace[l].id=this.id+"column-space-element"+l)},ZWRuler.prototype.getComputedColRect=function(e){var t=ORIENTATION_PROPS[this.orientation].start,i=ORIENTATION_PROPS[this.orientation].end,o=e.width.convertUnitTo(RULER_UNITS.PIXELS),r=e.height.convertUnitTo(RULER_UNITS.PIXELS),n={left:e.offset.left,right:e.offset.left+o,top:e.offset.top,bottom:e.offset.top+r},a=RulerUtil.getDeltaRelativeToAlignment(e.sizeInPx,e.align);return n[t]=e.offset[t]-a.start,n[i]=e.offset[t]+a.end,n},ZWRuler.prototype.getCurrentColumnProps=function(){return this.computedColProps.columnArea[this.getCurrentColumnIndex()]},ZWRuler.prototype.createColumnSpaceElements=function(){for(var e=COLUMN_SPACE_PROPS[this.layoutProps.columnType],t=0,i=this.computedColProps.columnSpace.length;t<i;t++){var o,r=this.computedColProps.columnSpace[t],n={id:r.id,rulerInstance:this,orientation:this.orientation,zoomFactor:this.zoomFactor,width:r.width,height:r.height,offset:r.offset,viewProps:{parent:this.container,classStr:e.classStr,zIndex:1},eventProps:{groupName:e.groupName,spaceIndex:t},priority:3,shouldHandleEvent:e.shouldHandleEvent,isDraggable:e.isDraggable,resizableOption:e.resizableOption,resizeMarginRatio:e.resizeMarginRatio,title:e.title,updateOnMouseMove:e.updateOnMouseMove,align:ALIGN.MIDDLE,retainOnReset:!1},a=this.computedColProps.columnArea[t],l=this.computedColProps.columnArea[t+1];if(this.layoutProps.columnType==COLUMN_TYPE.PAGE){var s=a.sizeInPx+l.sizeInPx+r.sizeInPx-2*this.layoutProps.minColumnAreaInPx;s<r.sizeInPx&&(s=r.sizeInPx),n.minSize=6+RULER_UNITS.PIXELS,n.maxSize=s+RULER_UNITS.PIXELS,this.layoutProps.isEqualColumnWidth||(n.shouldHandleEvent=!1),o=new RulerElement(n)}else{var d={left:a.rect.left,top:a.rect.top,right:l.rect.right,bottom:l.rect.bottom},c=ORIENTATION_PROPS[this.orientation];d[c.start]+=this.layoutProps.minColumnAreaInPx,d[c.end]-=this.layoutProps.minColumnAreaInPx,d[c.start]>r.offset[c.start]&&(d[c.start]=r.offset[c.start]),d[c.end]<r.offset[c.start]&&(d[c.end]=r.offset[c.start]),n.dragRect=d,n.computationFactor=PROCESSING_TYPE.REGULAR,o=new TableResizeElement(n)}this.addElement(r.id,o)}},ZWRuler.prototype.removeAllColumnSpaceElements=function(){for(var e=0,t=this.computedColProps.columnSpace.length;e<t;e++){var i=this.removeElement(this.computedColProps.columnSpace[e].id);i&&i.destroy()}},ZWRuler.prototype.setCurrentColumnIndex=function(e){this.layoutProps.columnIndex=e},ZWRuler.prototype.getCurrentColumnIndex=function(){return this.layoutProps.columnIndex},ZWRuler.prototype.getColumnRectForScales=function(){var e;return e=this.layoutProps.columnType==COLUMN_TYPE.PAGE?this.getCurrentColumnProps():this.direction===DIRECTION.LEFT_TO_RIGHT||this.direction===DIRECTION.TOP_TO_BOTTOM?this.computedColProps.columnArea[0]:this.computedColProps.columnArea[this.layoutProps.columnCount-1],e.rect},ZWRuler.prototype.getComputedScaleValues=function(e){var t={left:0,top:0},i={left:e.left,top:e.top};this.direction===DIRECTION.RIGHT_TO_LEFT?i={left:e.right,top:e.top}:this.direction===DIRECTION.BOTTOM_TO_TOP&&(i={left:e.left,top:e.bottom});var o=0,r=0,n=0,a=0;return this.orientation===ORIENTATION.HORIZONTAL?(n=this.widthInPx-i.left,o=this.widthInPx-n,r=a=this.heightInPx):(a=this.heightInPx-i.top,r=this.heightInPx-a,o=n=this.widthInPx),{scale1:{width:o+RULER_UNITS.PIXELS,height:r+RULER_UNITS.PIXELS,offset:t},scale2:{width:n+RULER_UNITS.PIXELS,height:a+RULER_UNITS.PIXELS,offset:i}}},ZWRuler.prototype.createScales=function(){var e=this.getColumnRectForScales(),t=this.getComputedScaleValues(e),i={id:this.id+"scale1-element",rulerInstance:this,orientation:this.orientation,zoomFactor:this.zoomFactor,width:t.scale1.width,height:t.scale1.height,offset:t.scale1.offset,viewProps:{parent:this.container},priority:1,shouldHandleEvent:!1,isDraggable:!1,resizableOption:RESIZABLE_TYPE.NONE,resizeMarginRatio:0,retainOnReset:!0},o={id:this.id+"scale2-element",rulerInstance:this,orientation:this.orientation,zoomFactor:this.zoomFactor,width:t.scale2.width,height:t.scale2.height,offset:t.scale2.offset,viewProps:{parent:this.container},priority:1,shouldHandleEvent:!1,isDraggable:!1,resizableOption:RESIZABLE_TYPE.NONE,resizeMarginRatio:0,retainOnReset:!0};this.scale1Element=new RulerElement(i),this.scale2Element=new RulerElement(o),this.addElement(this.scale1Element.id,this.scale1Element),this.addElement(this.scale2Element.id,this.scale2Element);var r={id:this.id+"scale1",unit:this.unit,orientation:this.orientation,zoomFactor:this.zoomFactor,type:SCALE_TYPE.INVERSE,maxWidth:this.width,maxHeight:this.height,viewProps:{parent:this.scale1Element.getContainer()}},n={id:this.id+"scale2",unit:this.unit,orientation:this.orientation,zoomFactor:this.zoomFactor,type:SCALE_TYPE.REGULAR,maxWidth:this.width,maxHeight:this.height,viewProps:{parent:this.scale2Element.getContainer()}};this.scale1=new Scale(r),this.scale2=new Scale(n)},ZWRuler.prototype.setTabStops=function(e){this.removeAlltabPoints(),this.tabPoints=e||{},this.createtabPoints()},ZWRuler.prototype.createtabPoints=function(){var e,t=this.getCurrentColumnProps(),i=20,o={left:t.rect.left,right:t.rect.right,top:t.rect.top-i,bottom:t.rect.bottom+i};for(var r in this.tabPoints){var n,a=this.tabPoints[r],l=a.align;this.direction===DIRECTION.LEFT_TO_RIGHT?(e=t.rect.left+a.point,n=PROCESSING_TYPE.REGULAR):this.direction===DIRECTION.RIGHT_TO_LEFT&&(e=t.rect.right-a.point,l==TABSELECTORS.LEFTTAB?l=TABSELECTORS.RIGHTTAB:l==TABSELECTORS.RIGHTTAB&&(l=TABSELECTORS.LEFTTAB),n=PROCESSING_TYPE.INVERSE);var s={id:r,rulerInstance:this,orientation:this.orientation,zoomFactor:this.zoomFactor,width:TABSELECTORS_PROPS[l].width,height:TABSELECTORS_PROPS[l].height,offset:{left:e,top:TABSELECTORS_PROPS[l].top},viewProps:{parent:this.container,classStr:TABSELECTORS_PROPS[l].classStr,zIndex:5},eventProps:{groupName:"TabStop",tpid:a.tpid},priority:5,shouldHandleEvent:!0,isDraggable:!0,hideOutOfDragRect:!0,dragRect:o,actualValue:a.point,resizableOption:RESIZABLE_TYPE.NONE,updateOnMouseMove:!0,computationFactor:n,align:l,retainOnReset:!0},d=new TabPointElement(s);this.addElement(r,d)}},ZWRuler.prototype.removeAlltabPoints=function(){if(this.tabPoints)for(var e in this.tabPoints){var t=this.removeElement(e);t&&t.destroy()}},ZWRuler.prototype.setIndents=function(e){this.removeAllIndents(),this.indentProps=this.computeIndentProps(e),this.createIndents(),this.setMarginMinMaxSize()},ZWRuler.prototype.computeIndentProps=function(e){if(!e)return null;var t=this.getCurrentColumnProps(),i={};for(var o in e){var r=TABSELECTORS_PROPS[o];i[o]={id:this.id+r.id,width:r.width,height:r.height,classStr:r.classStr,title:r.title,value:e[o]}}if(this.direction===DIRECTION.LEFT_TO_RIGHT){i[TABSELECTORS.LEFTINDENT].offset={top:TABSELECTORS_PROPS[TABSELECTORS.LEFTINDENT].top,left:t.rect.left+e[TABSELECTORS.LEFTINDENT]},i[TABSELECTORS.FIRSTLINEINDENT].offset={top:TABSELECTORS_PROPS[TABSELECTORS.FIRSTLINEINDENT].top,left:t.rect.left+e[TABSELECTORS.FIRSTLINEINDENT]},i[TABSELECTORS.RIGHTINDENT].offset={top:TABSELECTORS_PROPS[TABSELECTORS.RIGHTINDENT].top,left:t.rect.right-e[TABSELECTORS.RIGHTINDENT]};var n=Math.min(i[TABSELECTORS.RIGHTINDENT].offset.left,this.widthInPx),a=0,l=0;e[TABSELECTORS.LEFTINDENT]<e[TABSELECTORS.FIRSTLINEINDENT]?l=e[TABSELECTORS.FIRSTLINEINDENT]-e[TABSELECTORS.LEFTINDENT]:a=e[TABSELECTORS.LEFTINDENT]-e[TABSELECTORS.FIRSTLINEINDENT],i[TABSELECTORS.LEFTINDENT].dragRect={left:a,top:0,right:n-this.layoutProps.minColumnAreaInPx-l,bottom:this.heightInPx},i[TABSELECTORS.FIRSTLINEINDENT].dragRect={left:0,top:0,right:n-this.layoutProps.minColumnAreaInPx,bottom:this.heightInPx};var s=Math.max(i[TABSELECTORS.LEFTINDENT].offset.left,i[TABSELECTORS.FIRSTLINEINDENT].offset.left,0);i[TABSELECTORS.RIGHTINDENT].dragRect={left:s+this.layoutProps.minColumnAreaInPx,top:0,right:this.widthInPx,bottom:this.heightInPx},i[TABSELECTORS.LEFTINDENT].dragRect.right<i[TABSELECTORS.LEFTINDENT].offset.left&&(i[TABSELECTORS.LEFTINDENT].dragRect.right=i[TABSELECTORS.LEFTINDENT].offset.left),i[TABSELECTORS.FIRSTLINEINDENT].dragRect.right<i[TABSELECTORS.FIRSTLINEINDENT].offset.left&&(i[TABSELECTORS.FIRSTLINEINDENT].dragRect.right=i[TABSELECTORS.FIRSTLINEINDENT].offset.left),i[TABSELECTORS.RIGHTINDENT].dragRect.left>i[TABSELECTORS.RIGHTINDENT].offset.left&&(i[TABSELECTORS.RIGHTINDENT].dragRect.left=i[TABSELECTORS.RIGHTINDENT].offset.left),i[TABSELECTORS.LEFTINDENT].computationFactor=PROCESSING_TYPE.REGULAR,i[TABSELECTORS.FIRSTLINEINDENT].computationFactor=PROCESSING_TYPE.REGULAR,i[TABSELECTORS.RIGHTINDENT].computationFactor=PROCESSING_TYPE.INVERSE}else if(this.direction===DIRECTION.RIGHT_TO_LEFT){i[TABSELECTORS.LEFTINDENT].offset={top:TABSELECTORS_PROPS[TABSELECTORS.LEFTINDENT].top,left:t.rect.right-e[TABSELECTORS.LEFTINDENT]},i[TABSELECTORS.FIRSTLINEINDENT].offset={top:TABSELECTORS_PROPS[TABSELECTORS.FIRSTLINEINDENT].top,left:t.rect.right-e[TABSELECTORS.FIRSTLINEINDENT]},i[TABSELECTORS.RIGHTINDENT].offset={top:TABSELECTORS_PROPS[TABSELECTORS.RIGHTINDENT].top,left:t.rect.left+e[TABSELECTORS.RIGHTINDENT]};var s=Math.max(i[TABSELECTORS.RIGHTINDENT].offset.left,0),a=0,l=0;e[TABSELECTORS.LEFTINDENT]<e[TABSELECTORS.FIRSTLINEINDENT]?a=e[TABSELECTORS.FIRSTLINEINDENT]-e[TABSELECTORS.LEFTINDENT]:l=e[TABSELECTORS.LEFTINDENT]-e[TABSELECTORS.FIRSTLINEINDENT],i[TABSELECTORS.LEFTINDENT].dragRect={left:s+this.layoutProps.minColumnAreaInPx+a,top:0,right:this.widthInPx-l,bottom:this.heightInPx},i[TABSELECTORS.FIRSTLINEINDENT].dragRect={left:s+this.layoutProps.minColumnAreaInPx,top:0,right:this.widthInPx,bottom:this.heightInPx};var n=Math.min(i[TABSELECTORS.LEFTINDENT].offset.left,i[TABSELECTORS.FIRSTLINEINDENT].offset.left,this.widthInPx);i[TABSELECTORS.RIGHTINDENT].dragRect={left:0,top:0,right:n-this.layoutProps.minColumnAreaInPx,bottom:this.heightInPx},i[TABSELECTORS.LEFTINDENT].dragRect.left>i[TABSELECTORS.LEFTINDENT].offset.left&&(i[TABSELECTORS.LEFTINDENT].dragRect.left=i[TABSELECTORS.LEFTINDENT].offset.left),i[TABSELECTORS.FIRSTLINEINDENT].dragRect.left>i[TABSELECTORS.FIRSTLINEINDENT].offset.left&&(i[TABSELECTORS.FIRSTLINEINDENT].dragRect.left=i[TABSELECTORS.FIRSTLINEINDENT].offset.left),i[TABSELECTORS.RIGHTINDENT].dragRect.right<i[TABSELECTORS.RIGHTINDENT].offset.left&&(i[TABSELECTORS.RIGHTINDENT].dragRect.right=i[TABSELECTORS.RIGHTINDENT].offset.left),i[TABSELECTORS.LEFTINDENT].computationFactor=PROCESSING_TYPE.INVERSE,i[TABSELECTORS.FIRSTLINEINDENT].computationFactor=PROCESSING_TYPE.INVERSE,i[TABSELECTORS.RIGHTINDENT].computationFactor=PROCESSING_TYPE.REGULAR}return i},ZWRuler.prototype.createIndents=function(){if(this.indentProps)for(var e in this.indentProps){var t=this.indentProps[e],i={id:t.id,rulerInstance:this,orientation:this.orientation,zoomFactor:this.zoomFactor,width:t.width,height:t.height,offset:t.offset,viewProps:{parent:this.container,classStr:t.classStr,zIndex:4},eventProps:{groupName:"Indents"},dragRect:t.dragRect,actualValue:t.value,priority:4,shouldHandleEvent:!0,isDraggable:!0,computationFactor:t.computationFactor,resizableOption:RESIZABLE_TYPE.NONE,title:t.title,updateOnMouseMove:!0,align:ALIGN.MIDDLE,retainOnReset:!0},o=new IndentElement(i);this.addElement(t.id,o),this.affectedElements[o.id]&&(this.affectedElements[o.id]={element:o,originalOffset:{left:o.offset.left,top:o.offset.top},originalSizeInPx:o.sizeInPx})}},ZWRuler.prototype.removeAllIndents=function(){if(this.indentProps)for(var e in this.indentProps){var t=this.indentProps[e],i=this.removeElement(t.id);i&&i.destroy()}},ZWRuler.prototype.setRoundingFactor=function(){var e=UNIT_PROPS[this.unit];this.roundingFactor=e.fragMeasurement.convertUnitTo(RULER_UNITS.PIXELS)/e.fragSegmentCount},ZWRuler.prototype.setUnit=function(e){Ruler.prototype.setUnit.call(this,e),this.setRoundingFactor(),this.scale1.setUnit(e),this.scale2.setUnit(e)},ZWRuler.prototype.setOrientation=function(e){Ruler.prototype.setOrientation.call(this,e),this.view.contructRuler()},ZWRuler.prototype.setDirection=function(e){Ruler.prototype.setDirection.call(this,e),this.updateScales()},ZWRuler.prototype.updateScales=function(e){if(!e){var t=this.getColumnRectForScales();e=this.getComputedScaleValues(t)}this.scale1Element.setWidth(e.scale1.width),this.scale1Element.setHeight(e.scale1.height),this.scale1Element.setOffset(e.scale1.offset),this.scale2Element.setWidth(e.scale2.width),this.scale2Element.setHeight(e.scale2.height),this.scale2Element.setOffset(e.scale2.offset)},ZWRuler.prototype.updateScalesDisplacement=function(e){var t=this.getColumnRectForScales(),t={left:t.left,top:t.top,right:t.right,bottom:t.bottom};e.before?this.direction===DIRECTION.LEFT_TO_RIGHT?t.left+=e.before:this.direction===DIRECTION.TOP_TO_BOTTOM&&(t.top+=e.before):e.after&&(this.direction===DIRECTION.RIGHT_TO_LEFT?t.right+=e.after:this.direction===DIRECTION.BOTTOM_TO_TOP&&(t.bottom+=e.after));var i=this.getComputedScaleValues(t);this.updateScales(i)};var TABSELECTORS={LEFTTAB:"0",CENTERTAB:"1",RIGHTTAB:"2",LEFTINDENT:"3",FIRSTLINEINDENT:"4",RIGHTINDENT:"5"},TABSELECTORS_PROPS={0:{id:"left-tab",width:"8px",height:"8px",top:3,classStr:"ui-ruler-icon ui-tabpoint-left",title:J.i18n("tabselector","LEFTTAB"),tabSelectorClass:"ui-ruler-icon ui-icon-ruler-lefttabpoint-sm"},1:{id:"center-tab",width:"12px",height:"8px",top:3,classStr:"ui-ruler-icon ui-tabpoint-center",title:J.i18n("tabselector","CENTERTAB"),tabSelectorClass:"ui-ruler-icon ui-icon-ruler-centertabpoint-sm"},2:{id:"right-tab",width:"8px",height:"8px",top:3,classStr:"ui-ruler-icon ui-tabpoint-right",title:J.i18n("tabselector","RIGHTTAB"),tabSelectorClass:"ui-ruler-icon ui-icon-ruler-righttabpoint-sm"},3:{id:"left-indent",width:"12px",height:"10px",top:6,classStr:"ui-ruler-icon ui-ruler-leftindent",title:J.i18n("writer.common.RULER.LEFTINDENT"),tabSelectorClass:"ui-ruler-icon ui-icon-ruler-leftindent-sm"},4:{id:"first-line-indent",width:"12px",height:"5px",top:0,classStr:"ui-ruler-icon ui-ruler-firstlineindent",title:J.i18n("writer.common.RULER.FirstLineIndent"),tabSelectorClass:"ui-ruler-icon ui-icon-ruler-firstlineindent-sm"},5:{id:"right-indent",width:"12px",height:"10px",top:6,classStr:"ui-ruler-icon ui-ruler-rightindent",title:J.i18n("writer.common.RULER.RIGHTINDENT"),tabSelectorClass:"ui-ruler-icon ui-icon-ruler-rightindent-sm"}},COLUMN_TYPE={PAGE:"PAGE_COLUMN",TABLE:"TABLE_COLUMN"},MIN_HEADER_FOOTER_SIZE=24,ZWRulerController=function(){"use strict";var e,t,i,o={point:"0in",selector:TABSELECTORS.LEFTTAB},r={HRULER_WRAPPER:"ruler-wrapper",HRULER_OUTERCONTAINER:"hruler-container",VRULER_OUTERCONTAINER:"vruler-container",HRULER_CONTAINER:"HRuler",VRULER_CONTAINER:"VRuler",TAB_SELECTOR:"tabselector-container"},n=function(){try{var o=editor.doc.getRole();if("ANYONELINK_SHAREDREADCOMMENT"==o||"SHAREDREAD"==o||"SHAREDREADCOMMENT"==o||"REMOTEVIEW"==o||"REMOTECOLLABVIEW"==o)return;i=editor.doc;var n=i.getBodyFormat(),a={id:r.HRULER_CONTAINER,unit:Conversions.globalUnit,direction:DIRECTION.LEFT_TO_RIGHT,orientation:ORIENTATION.HORIZONTAL,zoomFactor:editor.zoomFactor,width:editor.doc.getPaperWidth(!0)+RULER_UNITS.PIXELS,height:"14px",layoutProps:M(),isInteractable:!0,viewProps:{classStr:"ui-horizontal-ruler",parent:Z(r.HRULER_OUTERCONTAINER)[0],context:"RTabmenu"}},l={id:r.VRULER_CONTAINER,unit:Conversions.globalUnit,direction:DIRECTION.TOP_TO_BOTTOM,orientation:ORIENTATION.VERTICAL,zoomFactor:editor.zoomFactor,width:"14px",height:n[ATTR_BODY.DS_PH],layoutProps:x(),isInteractable:!0,viewProps:{classStr:"ui-vertical-ruler",parent:Z(r.VRULER_OUTERCONTAINER)[0]}};e=new ZWRuler(a),t=new ZWRuler(l),p(),B(),z(TABSELECTORS.LEFTTAB),F(),d()}catch(e){var s="CRL_100";Utils.sendErrorDetails(s+"<ZWERROR>"+e.stack+"\nHRULER_INFO::"+JSON.stringify(M())+"\nVRULER_INFO::"+JSON.stringify(x())+"<ZWERROR>#")}},a=function(){return editor.isEditable()&&(UserPreferences.isPrefered("ruler")||ModeManager.getCurrentMode()==EDITOR_MODES.COMPOSE&&LayoutManager.isRichEditActive())},l=function(){Z(r.HRULER_WRAPPER).show(),Z(r.VRULER_OUTERCONTAINER).show(),EditorView.isPageView()?Z(r.VRULER_OUTERCONTAINER)[0].style.visibility="":Z(r.VRULER_OUTERCONTAINER)[0].style.visibility="hidden",editor.onResize()},s=function(){Z(r.HRULER_WRAPPER).hide(),Z(r.VRULER_OUTERCONTAINER).hide(),editor.onResize()},d=function(){a()?l():s()},c=function(){k(),d()},p=function(){PubSub.subscribe("Document/Zoom",$),PubSub.subscribe("Settings/UnitsChanged",X),PubSub.subscribe(["Document/or/changed","Document/papersize/changed"],k),PubSub.subscribe("Document/view/changed",c),PubSub.subscribe(["Document/ScrollEvent","Document/Resize"],B),PubSub.subscribe(["UIEvents/UserPreferenceUpdated","Document/EditPermissionChanged","Document/RichEditLayoutOpened","Document/RichEditLayoutClosed"],d),PubSub.subscribe(["Cursor/Collapsed","Cursor/Selected"],F,{async:!0,timeout:50}),PubSub.subscribe("HRuler/MouseDown",v),PubSub.subscribe("HRuler/MouseUp",b),PubSub.subscribe("HRuler/MouseMove",O),PubSub.subscribe("VRuler/MouseDown",T),PubSub.subscribe("VRuler/MouseUp",E),PubSub.subscribe("VRuler/MouseMove",h),Z("RTabmenu").bind("menubeforeshow",_)},u=function(e,t){t.offset&&e.setOffset(t.offset),e.orientation===ORIENTATION.HORIZONTAL?e.setWidth(t.sizeInPx+RULER_UNITS.PIXELS):e.setHeight(t.sizeInPx+RULER_UNITS.PIXELS)},f=function(e,t){for(var i in e.affectedElements){var o=e.affectedElements[i],r=o.element;if(r.isDraggable){var n={};e.orientation===ORIENTATION.HORIZONTAL?n={left:o.originalOffset.left+t,top:o.originalOffset.top}:e.orientation===ORIENTATION.VERTICAL&&(n={left:o.originalOffset.left,top:o.originalOffset.top+t}),r.setOffset(n)}}},g=function(e,t){for(var i=0,o=t.length;i<o;i++){var r=t[i];e.affectedElements[r.id]={element:r,originalOffset:{left:r.offset.left,top:r.offset.top},originalSizeInPx:r.sizeInPx}}},m=function(e){e.affectedElements={}},h=function(e,i,o,r,n,a){if("leftClick"==i&&o.updateOnMouseMove)switch(u(o,a),e.groupName){case"MarginBefore":var l={before:a.changeInSize};t.updateScalesDisplacement(l);break;case"MarginAfter":var l={after:-a.changeInSize};t.updateScalesDisplacement(l)}},T=function(e,t,i,o,r){if("leftClick"==t)switch(e.groupName){case"ActiveColumn":break;case"MarginBefore":break;case"MarginAfter":}},E=function(e,i,o,r,n,a){if("leftClick"==i){switch(e.groupName){case"ActiveColumn":break;case"MarginBefore":if(u(o,a),0!==a.changeInSize){var l={before:a.changeInSize};t.updateScalesDisplacement(l),R(o,a),Utils.addToStatistics("VRULER_"+e.groupName)}break;case"MarginAfter":if(u(o,a),0!==a.changeInSize){var l={after:-a.changeInSize};t.updateScalesDisplacement(l),S(o,a),Utils.addToStatistics("VRULER_"+e.groupName)}}m(t)}},R=function(e,o){var r=i.getSelection(),n=r.parents(NODE_TYPE.BODY),a=i.getBodyFormat(),l=e.sizeInPx,s=J(editor.clientActiveSection);if(s.hasClass("header_primary")){var d={};d[ATTR_BODY.DS_HT]=(l+RULER_UNITS.PIXELS).convertUnitTo(t.unit)+t.unit,i.execCmd("applyStyle",[n,d,"updateHeaderHeight"])}else if(s.hasClass("footer_primary")){var c={},p=ViewManager.getCurrentPageFooterHeight(r.getStart());c[ATTR_BODY.DS_MB]=(p-o.changeInSize+RULER_UNITS.PIXELS).convertUnitTo(t.unit)+t.unit,i.execCmd("applyStyle",[n,c,"updateFooterHeight"])}else{var u=a[ATTR_BODY.DS_HT].convertor().pixels,f=MIN_HEADER_FOOTER_SIZE;if(l<u+f){var g=Math.max(l-f,0),d={};d[ATTR_BODY.DS_HT]=(g+RULER_UNITS.PIXELS).convertUnitTo(t.unit)+t.unit,i.execCmd("applyStyle",[n,d,"updateDocHeight"])}var m={};m[ATTR_BODY.DS_MT]=(l+RULER_UNITS.PIXELS).convertUnitTo(t.unit)+t.unit,i.execCmd("applyStyle",[n,m,"updateDocMarginTop"])}},S=function(e,o){var r=i.getSelection(),n=r.parents(NODE_TYPE.BODY),a=i.getBodyFormat(),l=e.sizeInPx,s=J(editor.clientActiveSection);if(s.hasClass("footer_primary")){var d={};d[ATTR_BODY.DS_FB]=(l+RULER_UNITS.PIXELS).convertUnitTo(t.unit)+t.unit,i.execCmd("applyStyle",[n,d,"updateFooterBottom"])}else if(s.hasClass("header_primary")){var c={},p=ViewManager.getCurrentPageHeaderHeight(r.getStart());c[ATTR_BODY.DS_MT]=(p-o.changeInSize+RULER_UNITS.PIXELS).convertUnitTo(t.unit)+t.unit,i.execCmd("applyStyle",[n,c,"updateHeaderMarginTop"])}else{var u=a[ATTR_BODY.DS_FB].convertor().pixels,f=MIN_HEADER_FOOTER_SIZE;if(l<u+f){var g=Math.max(l-f,0),d={};d[ATTR_BODY.DS_HT]=(g+RULER_UNITS.PIXELS).convertUnitTo(t.unit)+t.unit,i.execCmd("applyStyle",[n,d,"updateDocFooterBottom"])}var m={};m[ATTR_BODY.DS_MB]=(l+RULER_UNITS.PIXELS).convertUnitTo(t.unit)+t.unit,i.execCmd("applyStyle",[n,m,"updateDocMarginBottom"])}},O=function(t,i,o,r,n,a){if("leftClick"==i&&o.updateOnMouseMove)switch(u(o,a),t.groupName){case"Indents":f(e,a.displacement);break;case"MarginBefore":f(e,a.changeInSize);var l={before:a.changeInSize};e.updateScalesDisplacement(l);break;case"MarginAfter":f(e,-a.changeInSize);var l={after:-a.changeInSize};e.updateScalesDisplacement(l)}},v=function(t,i,r,n,a){if("leftClick"==i)switch(m(e),t.groupName){case"ActiveColumn":if(o.selector==TABSELECTORS.LEFTTAB||o.selector==TABSELECTORS.CENTERTAB||o.selector==TABSELECTORS.RIGHTTAB)V(r,n.x),j(o.selector);else if(o.selector==TABSELECTORS.LEFTINDENT||o.selector==TABSELECTORS.FIRSTLINEINDENT||o.selector==TABSELECTORS.RIGHTINDENT){var l=e.elements[e.indentProps[o.selector].id],s={left:l.offset.left,top:l.offset.top},d=n.x;n.x>l.dragRect.right?d=l.dragRect.right:n.x<l.dragRect.left&&(d=l.dragRect.left),s.left=d,l.setOffset(s),P(l)}break;case"Indents":if(r.id==e.indentProps[TABSELECTORS.LEFTINDENT].id){var c=e.elements[e.indentProps[TABSELECTORS.FIRSTLINEINDENT].id],p=[c];g(e,p)}break;case"MarginBefore":if(e.layoutProps.columnType==COLUMN_TYPE.PAGE){var p=[];if(e.direction===DIRECTION.LEFT_TO_RIGHT){var c=e.elements[e.indentProps[TABSELECTORS.FIRSTLINEINDENT].id],u=e.elements[e.indentProps[TABSELECTORS.LEFTINDENT].id];p=[c,u];for(var f in e.tabPoints){var r=e.elements[f];p.push(r)}}else if(e.direction===DIRECTION.RIGHT_TO_LEFT){var h=e.elements[e.indentProps[TABSELECTORS.RIGHTINDENT].id];p=[h]}g(e,p)}break;case"MarginAfter":if(e.layoutProps.columnType==COLUMN_TYPE.PAGE){var p=[];if(e.direction===DIRECTION.RIGHT_TO_LEFT){var c=e.elements[e.indentProps[TABSELECTORS.FIRSTLINEINDENT].id],u=e.elements[e.indentProps[TABSELECTORS.LEFTINDENT].id];p=[c,u];for(var f in e.tabPoints){var r=e.elements[f];p.push(r)}}else if(e.direction===DIRECTION.LEFT_TO_RIGHT){var h=e.elements[e.indentProps[TABSELECTORS.RIGHTINDENT].id];p=[h]}g(e,p)}}},b=function(t,i,o,r,n,a){if("leftClick"==i)switch(t.groupName){case"ActiveColumn":break;case"TabStop":var l=t.tpid;if(a.outOfRect)editor.doc.execCmd("removeTab",l);else if(0!==a.displacement){var s=a.offset.left;e.direction===DIRECTION.LEFT_TO_RIGHT?s-=o.dragRect.left:s=o.dragRect.right-s,s=(s+UNITS.PIXELS).convertUnitTo(e.unit);var d={tpid:l,point:s+e.unit};editor.doc.execCmd("modifyTab",d),Utils.addToStatistics("HRULER_"+t.groupName)}break;case"Indents":u(o,a),f(e,a.displacement),m(e),0!==a.displacement&&(P(o),Utils.addToStatistics("HRULER_"+t.groupName));break;case"MarginBefore":if(u(o,a),f(e,a.changeInSize),m(e),0!==a.changeInSize){var c={before:a.changeInSize};e.updateScalesDisplacement(c),e.layoutProps.columnType==COLUMN_TYPE.PAGE?(C(o),Utils.addToStatistics("HRULER_PAGE_"+t.groupName)):(y(o,a),Utils.addToStatistics("HRULER_TABLE_"+t.groupName))}break;case"MarginAfter":if(u(o,a),f(e,-a.changeInSize),m(e),0!==a.changeInSize){var c={after:-a.changeInSize};if(e.updateScalesDisplacement(c),e.layoutProps.columnType==COLUMN_TYPE.PAGE)I(o),Utils.addToStatistics("HRULER_PAGE_"+t.groupName);else{var p=e.layoutProps.columnCount-1;D(p,-a.changeInSize),Utils.addToStatistics("HRULER_TABLE_"+t.groupName)}}break;case"PageColumnSpace":if(u(o,a),0!==a.changeInSize){var p=o.eventProps.spaceIndex;A(p,a),Utils.addToStatistics("HRULER_"+t.groupName)}break;case"TableColumnSpace":if(u(o,a),0!==a.displacement){var p=o.eventProps.spaceIndex;D(p,a.displacement),Utils.addToStatistics("HRULER_"+t.groupName)}}else if("rightClick"==i)switch(t.groupName){case"ActiveColumn":V(o,r.x)}},A=function(t,i){var o=(i.sizeInPx+RULER_UNITS.PIXELS).convertUnitTo(e.unit)+e.unit,r=ViewManager.getColumnFormat(),n=editor.doc.getSelection().parents(NODE_TYPE.BODY),a={};a[ATTR_BODY.DS_COLCOLS]={},a[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLCOUNT]=r.count,a[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLWID]=[],a[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLSPACE]=[],a[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLSEP]=r.seperator,a[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_DEFAULTSPACE]=o,a[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLISEQWID]=r.iseqwidth,editor.doc.execCmd("applyStyle",[n,a])},y=function(t,o){var r=editor.doc.getParents(NODE_TYPE.TABLE,editor.doc.getSelection().getStart()),n=TableUtil.calculateTableMarginLeft(r.dtNode).convertUnitTo(RULER_UNITS.PIXELS),a={},l=(n+o.changeInSize+RULER_UNITS.PIXELS).convertUnitTo(e.unit)+e.unit;a[ATTR_TABLE.TBLS_ML]=l,i.execCmd("applyStyle",[r,a,"tableLeftMarginChanged"])},D=function(e,t){TableUtil.updateCurrentColumn(e,t)},C=function(t){var o=i.getSelection().parents(NODE_TYPE.BODY),r={};r[ATTR_BODY.DS_ML]=t.width.convertUnitTo(e.unit)+e.unit,editor.doc.execCmd("applyStyle",[o,r,"applyAreaLeftMargin"])},I=function(t){var o=i.getSelection().parents(NODE_TYPE.BODY),r={};r[ATTR_BODY.DS_MR]=t.width.convertUnitTo(e.unit)+e.unit,editor.doc.execCmd("applyStyle",[o,r,"applyAreaRightMargin"])},P=function(t){var o=editor.doc.getSelection(),r=o.getNodesInSelection(NODE_TYPE.PARAGRAPH),n=r[0],a=editor.doc.getParents(NODE_TYPE.CELL,o.getStart()),l=0,s=0;if(a&&(l=a.dtNode.cellPadding.left,s=a.dtNode.cellPadding.right),t.id==e.indentProps[TABSELECTORS.LEFTINDENT].id){var d=n.attr(ATTR_PARAGRAPH.PS_PL);l+=d?d.convertUnitTo(RULER_UNITS.PIXELS):0;var c;e.direction===DIRECTION.LEFT_TO_RIGHT?c=t.offset.left-e.getCurrentColumnProps().rect.left:e.direction===DIRECTION.RIGHT_TO_LEFT&&(c=e.getCurrentColumnProps().rect.right-t.offset.left),c-=l;var p={};c=(c+RULER_UNITS.PIXELS).convertUnitTo(e.unit),p[ATTR_PARAGRAPH.PS_ML]=c.toFixed(3)+e.unit,editor.doc.execCmd("applyStyle",[r,p,"applyAreaLeftIndent"])}else if(t.id==e.indentProps[TABSELECTORS.RIGHTINDENT].id){var u=n.attr(ATTR_PARAGRAPH.PS_PR);s+=u?u.convertUnitTo(RULER_UNITS.PIXELS):0;var f;e.direction===DIRECTION.LEFT_TO_RIGHT?f=e.getCurrentColumnProps().rect.right-t.offset.left:e.direction===DIRECTION.RIGHT_TO_LEFT&&(f=t.offset.left-e.getCurrentColumnProps().rect.left),f-=s;var p={};f=(f+RULER_UNITS.PIXELS).convertUnitTo(e.unit),p[ATTR_PARAGRAPH.PS_MR]=f.toFixed(3)+e.unit,i.execCmd("applyStyle",[r,p,"applyAreaRightIndent"])}else if(t.id==e.indentProps[TABSELECTORS.FIRSTLINEINDENT].id){var g=n.attr(ATTR_PARAGRAPH.PS_ML),d=n.attr(ATTR_PARAGRAPH.PS_PL),m=g?g.convertUnitTo(RULER_UNITS.PIXELS):0;l+=d?d.convertUnitTo(RULER_UNITS.PIXELS):0,m+=l;var h;e.direction===DIRECTION.LEFT_TO_RIGHT?h=t.offset.left-e.getCurrentColumnProps().rect.left:e.direction===DIRECTION.RIGHT_TO_LEFT&&(h=e.getCurrentColumnProps().rect.right-t.offset.left),h-=m;var p={},T=(h+RULER_UNITS.PIXELS).convertUnitTo(e.unit);T<=0&&(m+=h,m=(m+RULER_UNITS.PIXELS).convertUnitTo(e.unit),p[ATTR_PARAGRAPH.PS_ML]=m.toFixed(3)+e.unit,p[ATTR_PARAGRAPH.PS_PL]=-T.toFixed(3)+e.unit),p[ATTR_PARAGRAPH.PS_TI]=T.toFixed(3)+e.unit,i.execCmd("applyStyle",[r,p,"applyAreaFirstLineIndent"])}},_=function(t,i){var o=e.getCurrentColumnProps().rect,r={x:t.clientX-e.containerRect.left,y:t.clientY-e.containerRect.top};return!(!r.x.isBetween(o.left,o.right,!0)||!r.y.isBetween(o.top,o.bottom,!0))},N=function(){G(),W()},L=function(){var t=M();e.setRulerLayoutProps(t),K()},w=function(e){var t=e.dtNode.getMatrixPosition()[1];return TableResize.getVisibleCellIdx(t)},M=function(){var e,t,o=J(editor.clientActiveSection),r=i.getBodyFormat(),n=editor.doc.getSelection(),a=r[ATTR_BODY.DS_ML],l=r[ATTR_BODY.DS_MR],s=96;if(o.hasClass("zw-contentpane")||o.hasClass("zw-endnotepane")||o.hasClass("zw-footnotepane"))e=ViewManager.getColumnWidthArray(),t=ViewManager.getColumnSpaceArray();else{var d=editor.doc.getPaperWidth()+RULER_UNITS.PIXELS;e=[d],t=[]}var c=editor.currentColumnIndex||0,p=ViewManager.isEqualColumnWidth(),u=COLUMN_TYPE.PAGE,f=editor.doc.getParents(NODE_TYPE.TABLE,n.getStart());if(f){u=COLUMN_TYPE.TABLE,e=TableUtil.getCurrRowsVisibleColWidth(),t=[];for(var g=0+Conversions.globalUnit,m=0,h=e.length-1;m<h;m++)t.push(g);var T=editor.doc.getParents(NODE_TYPE.CELL,n.getStart());c=w(T),p=!1,s=24,a=Math.max(TableUtil.getTableLeftPosition(f.dtNode).convertUnitTo(RULER_UNITS.PIXELS),0),l=Math.max(editor.doc.getPaperWidth(!0)-(a+f.dtNode.actualWidth),0),a+=RULER_UNITS.PIXELS,l+=RULER_UNITS.PIXELS}return a=a.convertUnitTo(Conversions.globalUnit)+Conversions.globalUnit,l=l.convertUnitTo(Conversions.globalUnit)+Conversions.globalUnit,{columnIndex:c||0,columnCount:e.length,columns:e,columnSpaces:t,isEqualColumnWidth:p||!1,minColumnAreaInPx:s,columnType:u,marginBefore:{size:a,minSize:0+RULER_UNITS.PIXELS},marginAfter:{size:l,minSize:0+RULER_UNITS.PIXELS}}},U=function(){var e=x();t.setRulerLayoutProps(e),t.setDirection(DIRECTION.TOP_TO_BOTTOM)},x=function(){var e,t,o,r,n,a,l,s=J(editor.clientActiveSection),d=i.getBodyFormat(),c=d[ATTR_BODY.DS_PH].convertor().pixels,p=.4*c,u=i.getSelection().getStart();if(s.hasClass("header_primary")){e=d[ATTR_BODY.DS_HT];var f=ViewManager.getCurrentPageHeaderHeight(u)||s[0].offsetHeight;t=c-f+RULER_UNITS.PIXELS,o=0+RULER_UNITS.PIXELS,r=c-p+RULER_UNITS.PIXELS,n=MIN_HEADER_FOOTER_SIZE}else if(s.hasClass("footer_primary")){var g=ViewManager.getCurrentPageFooterHeight(u)||s[0].offsetHeight;e=c-g+RULER_UNITS.PIXELS,t=d[ATTR_BODY.DS_FB],o=c-p+RULER_UNITS.PIXELS,r=0+RULER_UNITS.PIXELS,n=MIN_HEADER_FOOTER_SIZE}else e=d[ATTR_BODY.DS_MT],t=d[ATTR_BODY.DS_MB],o=0+RULER_UNITS.PIXELS,r=0+RULER_UNITS.PIXELS,a=p+RULER_UNITS.PIXELS,l=p+RULER_UNITS.PIXELS,n=.2*c;e=e.convertUnitTo(Conversions.globalUnit)+Conversions.globalUnit,t=t.convertUnitTo(Conversions.globalUnit)+Conversions.globalUnit;var m=e.convertUnitTo(RULER_UNITS.PIXELS),h=t.convertUnitTo(RULER_UNITS.PIXELS),T=c-(m+h)+RULER_UNITS.PIXELS,E={columnIndex:0,columnCount:1,columns:[T],columnSpaces:[],isEqualColumnWidth:!0,minColumnAreaInPx:n,columnType:COLUMN_TYPE.PAGE,marginBefore:{size:e,minSize:o,maxSize:a},marginAfter:{size:t,minSize:r,maxSize:l}};return E},F=function(){L(),N(),U(),H()},k=function(){var o=i.getBodyFormat(),r=editor.doc.getPaperWidth(!0)+RULER_UNITS.PIXELS,n=o[ATTR_BODY.DS_PH];e.setWidth(r),t.setHeight(n),editor.onResize()},B=function(){var t=editor.widthVariant-Z(ELEM_ID.EDITOROUTERDIV).scrollLeft();Z(r.HRULER_CONTAINER).css("left",t+"px"),e.updateRect(),H()},H=function(){var e=ViewManager.getPageAtPageNumber(editor.currentPageIndex+1),i=e&&J(e.el);if(i&&i[0]&&EditorView.isPageView()){var o=i.offset().top;if(0!==o){var n=editor.editorPaneContainer.offset().top;Z(r.VRULER_CONTAINER).css("margin-top",o-n)}t.updateRect()}},G=function(){var t=i.getSelection(),o=t.getParaFormat(),r=0,n=0,a=0;if(o){o=DocUtil.copyStyle(o);var l=0,s=0,d=editor.doc.getParents(NODE_TYPE.CELL,t.getStart());if(d){var c=d.dtNode.cellPadding.left,p=d.dtNode.cellPadding.right;l+=c,s+=p}var u=o[ATTR_PARAGRAPH.PS_ML];u=u?u.convertUnitTo(RULER_UNITS.PIXELS):0;var f=o[ATTR_PARAGRAPH.PS_PL];f=f?f.convertUnitTo(RULER_UNITS.PIXELS):0;var g=o[ATTR_PARAGRAPH.PS_MR];g=g?g.convertUnitTo(RULER_UNITS.PIXELS):0;var m=o[ATTR_PARAGRAPH.PS_TI];m=m?m.convertUnitTo(RULER_UNITS.PIXELS):0,r=l+u+f,n=s+g,a=r+m}var h={};h[TABSELECTORS.LEFTINDENT]=r,h[TABSELECTORS.FIRSTLINEINDENT]=a,h[TABSELECTORS.RIGHTINDENT]=n,e.setIndents(h)},z=function(e){o.selector=e,Z("tabselector-btn")[0].className=TABSELECTORS_PROPS[e].tabSelectorClass,Z("tabselector-container")[0].setAttribute("title",TABSELECTORS_PROPS[e].title)},V=function(t,i){var r;e.direction===DIRECTION.LEFT_TO_RIGHT?r=i-t.rect.left:e.direction===DIRECTION.RIGHT_TO_LEFT&&(r=t.rect.right-i);var n=Math.round(r/e.roundingFactor)*e.roundingFactor;o.point=(n+UNITS.PIXELS).convertUnitTo(e.unit)+e.unit},Y=function(){Z("tabstop-position").find(".ui-zmenu-text").html(J.i18n("writer.common.TAB_STOP_POSITION")+" "+o.point)},W=function(){for(var t,i,o=TabStop.getTabPoints(),r={},n=0,a=o.length;n<a;n++){t="tabpoint"+n,i=o[n];try{r[t]={tpid:i.id,align:i.align,point:i.point.convertUnitTo(RULER_UNITS.PIXELS)}}catch(e){}}e.setTabStops(r)},j=function(e){var t={point:o.point,align:e};editor.doc.execCmd("insertTab",t)},X=function(){var i=Conversions.globalUnit;e.setUnit(i),t.setUnit(i)},K=function(){var t,o=i.getSelection().getParaFormat();t=o&&o.dir&&"ltr"!=o.dir?DIRECTION.RIGHT_TO_LEFT:DIRECTION.LEFT_TO_RIGHT,e.setDirection(t)},$=function(){e.setZoomFactor(editor.zoomFactor),t.setZoomFactor(editor.zoomFactor)};return PubSub.subscribe("Document/FirstTimeComponentReady",n),{setDirection:K,insertTabPoint:j,showTabPtPosition:Y,setSelector:z}};ZWRulerController=ZWRulerController();var TabStop=function(){"use strict";var e=function(){var e=editor.doc.getSelection();if(e.isTableSelected()||0==DocTreeManager.doc.sections.length)return[];var t=e.parents(NODE_TYPE.PARAGRAPH),i=t&&t.attr(ATTR_PARAGRAPH.PS_TPS);if(i)for(var o=0,r=i.length;o<r;o++)parseInt(i[o].align)>2&&(i[o].align="0");else i=[];return i},t=function(e){TabStopDlg.removeAllRow();var t,i,o,r;for(t=0,r=e.length;t<r;t++)i=e[t],o={},o[ATTR_PARAGRAPH.PS_TPS]=[],i.attr(o)},i=function(e,t){var i,o,r,n,a,l,s;for(i=0,o=t.length;i<o;i++){for(r=t[i],n=r.attr(ATTR_PARAGRAPH.PS_TPS),n||(n=[]),a=0,l=n.length;a<l;a++)if(n[a].id==e){n.splice(a,1);break}s={},s[ATTR_PARAGRAPH.PS_TPS]=n,r.attr(s)}},o=function(e,t,i){var o,r,n,a,l,s;for(r=0,o=i.length;r<o;r++){for(n=i[r],a=n.attr(ATTR_PARAGRAPH.PS_TPS),a||(a=[]),l=0,s=a.length;l<s;l++)a[l].id==e&&(a[l].point=t);var d={};d[ATTR_PARAGRAPH.PS_TPS]=a,n.attr(d)}},r=function(e,t,i){var o,r,n,a,l,s,d;for(o=0,l=i.length;o<l;o++)r=i[o],s=r.attr(ATTR_PARAGRAPH.PS_TPS),s||(s=[]),n=Utils.randomString(),a={id:n,point:e,align:t,leader:"0"},s.push(a),d={},d[ATTR_PARAGRAPH.PS_TPS]=s,r.attr(d)};return{getTabPoints:e,removeAllTab:t,removeTab:i,updatePoint:o,insertTab:r}};TabStop=TabStop();var Resize=function(e,t,i,o){var r,n,a,l,s,d,c=!1,p=null,u=!1,f=null,g=!1,m=!1,h=null,T=0,E=null,R=null,S=null,O=null,v=null,b=null,A=0,y=0,D=0,C=0,I=8,P=0,_=null,N=null,L=null,w=!1,M=function(e){c=!1,w=!1,u=!1;var t=J("#imgResizeGrid");p&&(J(p).css("pointer-events","all"),p=null),x(),t.get(0)&&(t.remove(),m||g||(u=!1))},U=function(){PubSub.subscribe("ImageControlGrid/MouseUp",be),PubSub.subscribe(["Cursor/Collapsed","Cursor/Selected"],M)},x=function(){PubSub.unsubscribe(["Cursor/Collapsed","Cursor/Selected"],M),PubSub.unsubscribe("Document/MouseMove",f),PubSub.unsubscribe("Document/MouseUp",be),PubSub.unsubscribe("ImageControlGrid/MouseUp",be)},F=function(e){return(e.is("image")||DomUtil.isHRDiv(e[0]))&&EventHandler.mouseDown_coord.srcElem==e[0]},k=function(e,t,i,o,r){var n={};return n.cropTop=r/t*i.cropTop+i.cropTop,n.cropBottom=r/t*i.cropBottom+i.cropBottom,n.cropLeft=o/e*i.cropLeft+i.cropLeft,n.cropRight=o/e*i.cropRight+i.cropRight,n},B=function(e,t){var i=editor.doc.getRawFormatAt(editor.doc.getSelection().getStart()),o=Utils.getOrginalHeighWidthOfImage(i),r=o.wid,n=o.ht;"%"==i[ATTR_IMAGE.I_WID_UN]&&(r=ViewManager.getColumnWidth(),n=i[ATTR_IMAGE.I_ORGINALHT]*ViewManager.getColumnWidth()/i[ATTR_IMAGE.I_ORGINALWID]);var a,l,s=e?e:S.getAttribute("width"),d=t?t:S.getAttribute("height"),c=J(S).offset(),p={},u=null;if(i[ATTR_IMAGE.I_CROPRECT]&&(u=Utils.convertCropDataToPixel(i[ATTR_IMAGE.I_CROPRECT],n,r)),l=d,a=s,CropImage.isCropImageActive()){u||(u={},u.cropLeft=0,u.cropTop=0,u.cropBottom=0,u.cropRight=0),"%"==i[ATTR_IMAGE.I_WID_UN]&&(r+=u.cropLeft+u.cropRight,n+=u.cropBottom+u.cropTop);var t,e,u;e=r,t=n;var f=J("#mainRect")[0];l=f.height.animVal.value,a=f.width.animVal.value;var g=J(f).offset();u.cropLeft=g.left-c.left,u.cropTop=g.top-c.top;var m=s-(u.cropLeft+a),h=d-(u.cropTop+l);u.cropRight=m,u.cropBottom=h,u=Utils.convertCropDataToPercentage(u,d,s),p.cropRect=u}return p.width=a,p.height=l,p},H=function(e){g=!1;var t,i,o,l={},s=!1;if(u){if(t=w?editor.doc.getParents(NODE_TYPE.IFRAME,editor.doc.getSelection().getStart()):editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart())){var d=B(),c=editor.doc.getPaperWidth(),f=t.getStart();if(i=editor.doc.getRawFormatAt(f),"PAD"===editor.getEditorType()&&p&&T>c&&(T=c,height=p.height*(c/p.width)),s=editor.isFloatingImage(i)){a=editor.doc.getSelection().getStart(),o=J(S).offset();var h=removeImageAndGetStyles(e,o,editor.doc.getSelection().getStart(),i);jQuery.extend(l,h)}l[ATTR_IMAGE.I_WID_UN]="px",l[ATTR_IMAGE.I_HT_UN]="px",l[ATTR_IMAGE.I_WID]=d.width,l[ATTR_IMAGE.I_HT]=d.height,d.cropRect&&(l[ATTR_IMAGE.I_CROPRECT]=d.cropRect),m&&(l[ATTR_IMAGE.I_ROTATE]=ce()),p=null,s?(n=editor.doc.getSelection().getStart(),editor.doc.execCmd("insimg",l),_e(a,n)):editor.doc.execCmd("applyStyle",[t,l,"resizeImage"])}J(p).css("pointer-events","all"),m=!1,r="image",CropImage.setIsResizeImageOn(g)}else if(t=editor.doc.getSelection().parents(NODE_TYPE.HR)){var T=O.x2.animVal.value-O.x1.animVal.value;l[ATTR_HR.HR_WID]=T,J(p).css("pointer-events","all"),p=null,editor.doc.execCmd("applyStyle",[t,l,"resizeHR"]),r="hr"}},G=function(e,t,i,r,n,a,c){var f,g=J(o).width(),m=p.parentElement||p.parentNode,A=J(m).offset().left+(c>i?c:i),D=g>A?(g-50)/editor.zoomFactor:A/editor.zoomFactor,C=r+300+y+500;_||(_=Handlebars.compile(J("#img-resize-menu").html()),N=Handlebars.compile(J("#img-resize-svg").html())),l=_(),s=N(),u?f=J(s).css({height:C,width:D}).add(l):(L||(L=Handlebars.compile(J("#img-hr-resize-svg").html())),d=L(),f=J(d).css({height:C,width:D})),e.append(f);o.getElementById("imgResizeGrid");E=e[0].getElementsByTagName("svg")[0],R=E.createSVGPoint(),S=E.querySelector("rect"),O=E.querySelector("line"),v=J(O),b={NONE:{value:0,circle:null},NORTH:{value:1,circle:E.querySelector(".NorthCircle")},NORTHEAST:{value:2,circle:E.querySelector(".NorthEastCircle")},EAST:{value:3,circle:E.querySelector(".EastCircle")},SOUTHEAST:{value:4,circle:E.querySelector(".SouthEastCircle")},SOUTH:{value:5,circle:E.querySelector(".SouthCircle")},SOUTHWEST:{value:6,circle:E.querySelector(".SouthWestCircle")},WEST:{value:7,circle:E.querySelector(".WestCircle")},NORTHWEST:{value:8,circle:E.querySelector(".NorthWestCircle")}},h=b.NONE,T=b.NONE.value,z(i,r,n,a)},z=function(e,t,i,o){var r=J("#imgResizeGrid").offset(),n={},a=Resize.getTargetImg();if(u){var l=a.parentElement||a.parentNode,s=l.parentElement||l.parentNode,d=editor.doc.getRawFormatAt(editor.doc.getSelection().getStart());a&&(CropImage.isCropImageActive()?n=J(l).offset():editor.isFloatingImage(d)&&0!=i?(n=J(s).parent().offset(),d.ml&&(n.left=n.left+parseInt(d.ml.convertor().pixels),n.top=n.top+parseInt(d.mt.convertor().pixels))):n=J(s).offset());var c=(n.left-r.left)/editor.zoomFactor,f=(n.top-r.top)/editor.zoomFactor,g=null,m=Utils.getOrginalHeighWidthOfImage(d);if(d[ATTR_IMAGE.I_CROPRECT]&&(g=Utils.convertCropDataToPixel(d[ATTR_IMAGE.I_CROPRECT],m.ht,m.wid)),g&&CropImage.isCropImageActive()&&0!=i){var h=m.wid,T=m.ht,R=Utils.getTransformedSize(i,h,T);f+=(R.height-T)/2,c+=(R.width-h)/2}g&&CropImage.isCropImageActive()||0==i||(c+=parseFloat(J(s).css("left")),f+=parseFloat(J(s).css("top"))),CropImage.isCropImageActive()&&!g&&(c-=4,f-=4,e+=10,t+=10);var O,b=1;O=CropImage.isCropImageActive()?b:parseInt(o)+b,S.setAttribute("x",c+O),S.setAttribute("y",f+O),S.setAttribute("width",e-b),S.setAttribute("height",t-b),V(),D=c+e/2+O,C=f+t/2+O,0!=i&&pe(i),"zw-iframe"==a.className||"zw-ifr-div"==a.className?Le(p):Se()}else{n=J(a).offset(),e=J(a).width();var c=(n.left-r.left)/editor.zoomFactor,f=(n.top-r.top)/editor.zoomFactor;v.attr({x1:c,y1:f,x2:c+e,y2:f})}Oe();var A=[".NorthCircle",".NorthEastCircle",".EastCircle",".SouthEastCircle",".SouthCircle",".SouthWestCircle",".WestCircle",".NorthWestCircle"],y=["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"];se(A,y,E),le(),PubSub.publish("ImageControlGrid/AfterShow"),J("#imgResizeGrid").on("mouseup mousedown",function(e){e.stopPropagation(),e.preventDefault(),"mouseup"==e.type&&PubSub.publish("ImageControlGrid/MouseUp",e)})},V=function(){if(p.getAttribute("class").indexOf("zw-iframe")!=-1||CropImage.isCropImageActive())return void J("div#con-menu-parent").hide();var e=E.querySelector("path.rotationObject"),t=E.querySelector("circle.rotationObject"),i=Number(S.getAttribute("x")),o=Number(S.getAttribute("y")),r=Number(S.getAttribute("width")),n=i+r/2,a="M"+n+","+o+" L"+n+" "+(o-20);e.setAttribute("d",a),t.setAttribute("cx",n),t.setAttribute("cy",o-20)},Y=function(e){return R.x=e.clientX,R.y=e.clientY,R.matrixTransform(E.getScreenCTM().inverse())},W=function(e,t,i){return R.x=t,R.y=i,R.matrixTransform(e.getCTM(E).inverse())},j=function(e){h=e,Z()},Z=function(){var e=h.value+de();T=e%I},X=function(e){if(u){var t=S.width.animVal.value;if(e.x<=S.x.animVal.value)return;t=e.x-S.x.animVal.value,S.setAttribute("width",t)}else{var i=O.x1.animVal.value,o=O.x2.animVal.value,t=o-i;if(e.x<=i)return;t=e.x-i,O.setAttribute("x2",i+t)}},K=function(e){var t=e.y,i=S.y.animVal.value,o=S.height.animVal.value;t<=i||(t<=i+o?o-=i+o-t:t>i+o&&(o+=t-(i+o)),S.setAttribute("height",o))},$=function(e){var t=S.height.animVal.value,i=e.y,o=S.y.animVal.value;i>=o+t||(i>o?t-=i-o:i<o&&(t+=o-i),S.setAttribute("y",i),S.setAttribute("height",t))},q=function(e){if(u){var t=S.width.animVal.value,i=e.x,o=S.x.animVal.value;if(i>=o+t)return;i>o?t-=i-o:i<o&&(t+=o-i),S.setAttribute("x",i),S.setAttribute("width",t)}else{var r=O.x1.animVal.value,n=O.x2.animVal.value,t=n-r;if(e.x>=r+t)return;e.x>r?t-=e.x-r:e.x<r&&(t+=r-e.x),O.setAttribute("x1",e.x)}},Q=function(e){var t=e/S.width.animVal.value*100,i=t/100*S.height.animVal.value;return i},ee=function(e){var t=e/S.height.animVal.value*100,i=t/100*S.width.animVal.value;return i},te=function(e){var t,i,o=0,r=0,n=!1;o=e.x-(S.x.animVal.value+S.width.animVal.value),r=e.y-(S.y.animVal.value+S.height.animVal.value),o>0?(t=S.width.animVal.value+o,r=Q(o),i=S.height.animVal.value+r,n=!0):r>0?(i=S.height.animVal.value+r,o=ee(r),t=S.width.animVal.value+o,n=!0):o<0&&r<0&&(o=Math.abs(o),r=Math.abs(r),o<r?(t=S.width.animVal.value-o,r=Q(o),i=S.height.animVal.value-r):(i=S.height.animVal.value-r,o=ee(r),t=S.width.animVal.value-o),n=!0),n&&t>=0&&i>=0&&(S.setAttribute("width",t),S.setAttribute("height",i))},ie=function(e){var t,i,o,r=0,n=0,a=!1,l=S.y.animVal.value;r=e.x-(S.x.animVal.value+S.width.animVal.value),n=e.y-S.y.animVal.value,r>0?(t=S.width.animVal.value+r,n=Q(r),i=S.height.animVal.value+n,o=l-n,a=!0):n<0?(n=Math.abs(n),i=S.height.animVal.value+n,r=ee(n),t=S.width.animVal.value+r,o=l-n,a=!0):r<0&&n>0&&(r=Math.abs(r),r<n?(t=S.width.animVal.value-r,n=Q(r),i=S.height.animVal.value-n):(i=S.height.animVal.value-n,r=ee(n),t=S.width.animVal.value-r),o=l+n,a=!0),a&&t>=0&&i>=0&&(S.setAttribute("width",t),S.setAttribute("height",i),S.setAttribute("y",o))},oe=function(e){var t,i,o,r,n=0,a=0,l=!1,s=S.x.animVal.value,d=S.y.animVal.value;n=e.x-S.x.animVal.value,a=e.y-S.y.animVal.value,n<0?(n=Math.abs(n),t=S.width.animVal.value+n,a=Q(n),i=S.height.animVal.value+a,o=s-n,r=d-a,l=!0):a<0?(a=Math.abs(a),i=S.height.animVal.value+a,n=ee(a),t=S.width.animVal.value+n,o=s-n,r=d-a,l=!0):n>0&&a>0&&(n<a?(t=S.width.animVal.value-n,a=Q(n),i=S.height.animVal.value-a):(i=S.height.animVal.value-a,n=ee(a),t=S.width.animVal.value-n),o=s+n,r=d+a,l=!0),l&&t>=0&&i>=0&&(S.setAttribute("width",t),S.setAttribute("height",i),S.setAttribute("x",o),S.setAttribute("y",r))},re=function(e){var t,i,o,r=0,n=0,a=!1,l=S.x.animVal.value;r=e.x-S.x.animVal.value,n=e.y-(S.y.animVal.value+S.height.animVal.value),r<0?(r=Math.abs(r),t=S.width.animVal.value+r,n=Q(r),i=S.height.animVal.value+n,o=l-r,a=!0):n>0?(i=S.height.animVal.value+n,r=ee(n),t=S.width.animVal.value+r,o=l-r,a=!0):r>0&&n<0&&(n=Math.abs(n),r<n?(t=S.width.animVal.value-r,n=Q(r),i=S.height.animVal.value-n):(i=S.height.animVal.value-n,r=ee(n),t=S.width.animVal.value-r),o=l+r,a=!0),a&&t>=0&&i>=0&&(S.setAttribute("width",t),S.setAttribute("height",i),S.setAttribute("x",o))},ne=function(){var e,t=h.circle;switch(e=u?W(S,t.x.animVal.value,t.y.animVal.value):W(O,t.cx.animVal.value,t.cy.animVal.value),h.value){case b.EAST.value:X(e);break;case b.SOUTH.value:K(e);break;case b.NORTH.value:$(e);break;case b.WEST.value:q(e);break;case b.SOUTHEAST.value:te(e);break;case b.NORTHEAST.value:ie(e);break;case b.NORTHWEST.value:oe(e);break;case b.SOUTHWEST.value:re(e)}},ae=function(e){e.addEventListener("mousedown",function(e){PubSub.publish("Gridlines/show"),j(b[this.getAttribute("direction")]);var t=Y(e);if(u)var i={x:this.x.animVal.value,y:this.y.animVal.value};else var i={x:this.cx.animVal.value,y:this.cy.animVal.value};J(this).unbind("dragstart").bind("dragstart",function(){return!1}),J("#imgResizeGrid").css("pointer-events","auto"),PubSub.subscribe("ImageControlGrid/MouseUp",be),f=function(e){PubSub.subscribe("Document/MouseUp",be),PubSub.subscribe("ImageControlGrid/MouseUp",be),J(p).css("pointer-events","none"),g=!0;var o=h.circle,r=Y(e);R.x=r.x-t.x,R.y=r.y-t.y;var n=o.getCTM(E).inverse();if(n.e=n.f=0,R=R.matrixTransform(n),u?(o.setAttribute("x",i.x+R.x/editor.zoomFactor),o.setAttribute("y",i.y+R.y/editor.zoomFactor)):(o.setAttribute("cx",i.x+R.x/editor.zoomFactor),o.setAttribute("cy",i.y+R.y/editor.zoomFactor)),ne(),Oe(),u){V(),clearTimeout(Resize.toolTipPositionTimer);var a=E.getElementById("resize_tooltip"),l=E.getElementById("resize_tooltip_bg");a.setAttributeNS(null,"visibility","hidden"),l.setAttributeNS(null,"visibility","hidden"),a.setAttributeNS(null,"x",r.x/editor.zoomFactor+25),a.setAttributeNS(null,"y",r.y/editor.zoomFactor+29);var s=S.width.animVal.value,d=S.height.animVal.value;a.firstChild.data=Math.round(s)+" x "+Math.round(d),l.setAttributeNS(null,"x",r.x/editor.zoomFactor+15),l.setAttributeNS(null,"y",r.y/editor.zoomFactor+15),Resize.toolTipPositionTimer=setTimeout(function(){a.setAttributeNS(null,"visibility","visible"),l.setAttributeNS(null,"visibility","visible")},50)}Utils.stopEvent(e)},PubSub.subscribe("Document/MouseMove",f)},!1)},le=function(){for(var e=E.querySelectorAll(".ResizeCircle"),t=0,i=e.length;t<i;++t){var o=e[t];ae(o)}if(u){var r=E.querySelector("circle.RotationCircle");r.addEventListener("mousedown",function(e){PubSub.publish("Gridlines/show"),J(this).unbind("dragstart").bind("dragstart",function(){return!1}),J("#imgResizeGrid").css("pointer-events","auto"),f=function(e){m=!0;var t=Y(e),i=0,o=t.x-D,r=C-t.y,n=Math.atan(r/o),a=180*n/Math.PI,i=450-a;i+=o>=0&&r>=0?0:o<0&&r>=0?180:o<0&&r<0?180:360,i%=360,i=Math.round(i),i=360===i?0:i,pe(i),Oe();var l=E.getElementById("tooltip");l.setAttributeNS(null,"x",t.x+25),l.setAttributeNS(null,"y",t.y+29),l.firstChild.data="rotate : "+i+"°",l.setAttributeNS(null,"visibility","visible");var s=E.getElementById("tooltip_bg");s.setAttributeNS(null,"x",t.x+15),s.setAttributeNS(null,"y",t.y+15),s.setAttributeNS(null,"visibility","visible"),Utils.stopEvent(e)},PubSub.subscribe("Document/MouseMove",f)},!1)}},se=function(e,t,i){for(var o=de(),r=J(i),n=0,a=t.length;n<a;n++){var l=r.find(e[n]);l&&l.css("cursor",t[o]),o++,o%=a}},de=function(){var e=0;if(!u)return e;var t=ce();return t>=337.5&&t<=360||t>=0&&t<=22.5?e=0:t>=22.6&&t<=67.5?e=1:t>=67.6&&t<=112.5?e=2:t>=112.6&&t<=157.5?e=3:t>=157.6&&t<=202.5?e=4:t>=202.6&&t<=247.5?e=5:t>=247.6&&t<=292.5?e=6:t>=292.6&&t<=337.5&&(e=7),e},ce=function(){var t=0,i=S.transform.baseVal;return i.numberOfItems>0&&i.getItem(0).type===e.SVG_TRANSFORM_ROTATE&&(t=i.getItem(0).angle),t>360&&(t%=360),t},pe=function(e){for(var t=E.querySelectorAll(".rotationObject"),i=0,o=t.length;i<o;++i)t[i].setAttribute("transform","rotate("+e+" "+D+" "+C+")")},ue=function(){return R.x=S.x.animVal.value+S.width.animVal.value/2,R.y=S.y.animVal.value,R.matrixTransform(S.getCTM(E))},fe=function(){return u?(R.x=S.x.animVal.value+S.width.animVal.value,R.y=S.y.animVal.value+S.height.animVal.value/2,R.matrixTransform(S.getCTM(E))):{x:O.x2.animVal.value,y:O.y2.animVal.value}},ge=function(){return R.x=S.x.animVal.value+S.width.animVal.value/2,R.y=S.y.animVal.value+S.height.animVal.value,R.matrixTransform(S.getCTM(E))},me=function(){return u?(R.x=S.x.animVal.value,R.y=S.y.animVal.value+S.height.animVal.value/2,R.matrixTransform(S.getCTM(E))):{x:O.x1.animVal.value,y:O.y1.animVal.value}},he=function(){return R.x=S.x.animVal.value,R.y=S.y.animVal.value,R.matrixTransform(S.getCTM(E))},Te=function(){return R.x=S.x.animVal.value+S.width.animVal.value,R.y=S.y.animVal.value,R.matrixTransform(S.getCTM(E))},Ee=function(){return R.x=S.x.animVal.value+S.width.animVal.value,R.y=S.y.animVal.value+S.height.animVal.value,R.matrixTransform(S.getCTM(E))},Re=function(){return R.x=S.x.animVal.value,R.y=S.y.animVal.value+S.height.animVal.value,R.matrixTransform(S.getCTM(E))},Se=function(){var e=Math.min(Te().y,he().y,Ee().y,Re().y),i=editor.jeditorPane.offset().left,r=t.offsetLeft(J(Resize.getTargetImg()).parents("div")[0])-J("#con-menu-parent").width()-30;r+=i/editor.zoomFactor,J("#con-menu-parent").css({top:e+5,left:r});var n=0;if(LeftPanel.isContainerVisible(ELEM_ID.MAINPANELCONTAINER)&&(n+=J("#"+ELEM_ID.MAINPANELCONTAINER).width()),LeftPanel.isContainerVisible(ELEM_ID.PANELCONTAINER)&&(n+=J("#"+ELEM_ID.PANELCONTAINER).width()),editor.jeditorPane.offset().left-n<180?(J("#con-wrap-menu").css({top:e+4,left:r+40}),J("#con-border-menu").css({top:e+24,left:r+40}),J("#con-margin-menu").css({top:e+44,left:r+40}),J("#con-bordersize-menu").css({top:e+24,left:r+40}),J("#open-arrow-align,#open-arrow-bordersize,#open-arrow-border,#open-arrow-margin").attr("class","js-context-click ui-image-select-arrow-left"),J("#img-outer-align,#img-outer-bordersize,#img-outer-borderstyle,#img-outer-margin").css({float:"right"})):(J("#con-wrap-menu").css({top:e+4,left:r-87}),J("#con-border-menu").css({top:e+24,left:r-111}),J("#con-margin-menu").css({top:e+44,left:r-105}),J("#con-bordersize-menu").css({top:e+24,left:r-111}),J("#open-arrow-align,#open-arrow-bordersize,#open-arrow-border,#open-arrow-margin").attr("class","js-context-click ui-image-select-arrow-right"),J("#img-outer-align,#img-outer-bordersize,#img-outer-borderstyle,#img-outer-margin").css({float:"left"})),"mm"==Conversions.globalUnit)for(var a=["3mm","6mm","9mm","12mm"],l=1;l<5;l++)J("#con-margin-menu").children()[0].children[l].children[0].innerHTML=a[l-1]+" "+J.i18n("writer.image.MARGIN");J("#imgResizeGrid").css({"z-index":"20"});var s=editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart()),d=s.attr(),c=J("#ui-link-bubble-div");if(c.hide(),d.linkData&&d.linkData.url){J("#go-to-link").text(d.linkData.url),c.show();var p=Math.max(Te().y,he().y,Ee().y,Re().y),r=D-o.getElementById("ui-link-bubble-div").offsetWidth/2;c.css({top:p,left:r})}},Oe=function(){for(var e,t=[".NorthCircle",".NorthEastCircle",".EastCircle",".SouthEastCircle",".SouthCircle",".SouthWestCircle",".WestCircle",".NorthWestCircle"],i=[ue,Te,fe,Ee,ge,Re,me,he],o=0,r=t.length;o<r;o++){var n=E.querySelector(t[o]);n&&(e=i[o](),u?(n.setAttribute("x",e.x-3.5),n.setAttribute("y",e.y-3.5)):(n.setAttribute("cx",e.x),n.setAttribute("cy",e.y)))}},ve=function(e,t,i){U();var r,n;c=!0;var a=p.parentElement||p.parentNode,l=J(a),s=l.parents(".zw-paragraph:first");if(e)M();else if(l.is("#imgResizeGrid"))return!1;var d,f,g=editor.doc.getRawFormatAt(editor.doc.getSelection().getStart()),m=l.parents("div.zw-contentpane,div.header_primary,div.footer_primary")[0],h=l.css("margin-left")||"0px",T=l.offset().top-J(m).offset().top,E=l.offset().left-J(m).offset().left;h&&(E-=parseFloat(h)),d=parseInt(getComputedStyle(l[0]).width),f=parseInt(getComputedStyle(l[0]).height);var R=null,S=Utils.getOrginalHeighWidthOfImage(g);g[ATTR_IMAGE.I_CROPRECT]&&(R=Utils.convertCropDataToPixel(g[ATTR_IMAGE.I_CROPRECT],S.ht,S.wid)),R&&!CropImage.isCropImageActive()&&(T+=R.cropTop,f=l.height()-(R.cropTop+R.cropBottom),d=l.width()-(R.cropLeft+R.cropRight)),CropImage.isCropImageActive()&&R&&(E-=R.cropLeft);var O=J(m).offset().left;P=O/editor.zoomFactor-25,A=E+parseInt(s.css("border-left-width")||0),y=T+parseInt(s.css("border-top-width")||0);var v=0;if(u){t=t?t:editor.doc.getSelection().getStart();var b=editor.doc.getParents(NODE_TYPE.IMAGE,t),D=b.getStart();g=editor.doc.getRawFormatAt(D),g&&g.hasOwnProperty(ATTR_IMAGE.I_ROTATE)&&(v=parseFloat(g[ATTR_IMAGE.I_ROTATE]),n=g.rot_width),g&&g.hasOwnProperty(ATTR_COMMON.BORDERS)&&g[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_TOP]&&(r=parseFloat(g[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_TOP][ATTR_BORDERS.WIDTH])),g&&g.hasOwnProperty("tc")&&(r=TrackChangeUI.imageBorderWid)}i&&"%"==g[ATTR_IMAGE.I_WID_UN];var C=J(o.createElement("div")).attr("id","imgResizeGrid").css({top:-300,left:-P,position:"absolute","pointer-events":"none","z-index":10}).appendTo(m);G(C,l.attr("src"),d,f,v,r||0,n||0),jElement=J("#margin-menu"),u&&editor.isFloatingImage(g)?jElement.removeClass("ui-button-state-disable"):jElement.addClass("ui-button-state-disable")},be=function(e,t,o,n){PubSub.publish("Gridlines/hide"),t=t||e.srcElement||e.target;var a=J(t),l=a.parent(),s=a.parents("div.zw-contentpane,div.header_primary,div.footer_primary").hasClass("selectableSection");return g||m?(CropImage.isCropImageActive()&&CropImage.setIsResizeImageOn(g),H(e),h=b.NONE,u=!1,M(),void("image"==r?(Ae(),CropImage.isCropImageActive()&&CropImage.showCropGrid(Resize.getTargetImg())):ye())):(l.is(".js-context-click")||l.is("#ui-link-bubble-div")||l.is("#ui-link-changes")||M(),void(o&&s&&F(a)&&!J(t).is('img[id^="latexexpressionimage"]')&&!l.is("#imgResizeGrid")&&(p=t,u=!(!a.is("image")&&!a.is("svg")),clearTimeout(i.stopBlinking),i.stopBlinking())))},Ae=function(){var e=editor.doc.getSelection().getStart(),t=editor.doc.getRawFormatAt(e),i=ImageUtils.getDomImage(e,t);Resize.removeResizeDiv(),Pe(!0),J(i).find("iframe")[0]?(w=!0,i=J(i).find("iframe")[0]):J(i).find("img")[0]&&(w=!0,i=J(i).find("img")[0]),Ce(i),ve(!1,e,!0)},ye=function(){var e=DocUtil.getDOMSourceIndex(editor.doc.getSelection().getStart()+1,UNICODE.HR),t=DomUtil.getElementAt("hr",e,editor.clientActiveSection);Ce(t),ve(!1,editor.doc.getSelection().getStart())},De=function(){return p},Ce=function(e){p=e},Ie=function(){return c},Pe=function(e){u=e},_e=function(e,t){if(e!=t){var i=editor.doc.getSelection(),o=i.getLastRange(),r=editor.doc.createRange(o.start-1,o.start);i.removeAllRanges().addRange(r)}},Ne=function(){return g};editor.jeditorPane.on("click",".zw-image, .zw-hr",function(){if(!(EventHandler.clickEvt.clkCount>1)){var e=editor.doc.getRole();"SHAREDREADCOMMENT"!=e&&"ANYONELINK_SHAREDREADCOMMENT"!=e&&editor.editable&&!J(this).parents().hasClass("unselectableSection")&&(Pe("string"!=typeof this.className),Ce(this),ve(!1))}});var Le=function(e){if(J(e.parentElement).children(".ui-edit-icon-btn").css("display","block"),"zw-ifr-div"==e.className){var t=J(e.parentElement).find(".zw-ifr-msg-div");t.addClass("ui-iframe-hover-div")}PubSub.subscribe(["Cursor/Collapsed","Cursor/Selected"],Widget.widgetSelect),Widget.getWidgetProperty()};return editor.jeditorPane.on("click",".zw-ifr-div",function(){Le(this);var e=editor.doc.getSelection().getStart(),t=editor.doc.getFormats()[e];if("iframe"!=t.type&&"YOUTUBE"!=t.service){if(EventHandler.clickEvt.clkCount>1)return;var i=editor.doc.getRole();"SHAREDREADCOMMENT"!=i&&"ANYONELINK_SHAREDREADCOMMENT"!=i&&editor.editable&&(Pe("string"!=typeof this.className),w=!0,Pe(!0),Ce(J(this).find(".zw-iframe")[0]),ve(!1))}}),editor.jeditorPane.on("dblclick",".zw-ifr-div",function(){J(".zw-ifr-msg-div").removeClass("ui-iframe-hover-div"),J(this).children(".zw-iframe").addClass("ui-frm-actv")}),editor.jeditorPane.on("click",".ui-edit-icon-btn",function(){var e=editor.doc.getFormats()[editor.doc.getSelection().getStart()][ATTR_WIDGET.SRC];Utils.safeWindowOpen(e)}),editor.jeditorPane.on("click",".yt-imgPlay-icon",function(e){var t=J(this),i=t.attr("src");Jimage=t.parent(),JimgPos=Jimage.position(),Jparent=Jimage.parent(),imgHt=parseInt(getComputedStyle(Jimage[0]).height),imgWid=parseInt(getComputedStyle(Jimage[0]).width),videoSrc=i+"?autoplay=1&rel=0&showinfo=0&modestbranding=1&fs=0 allowfullscreen",createIfrDiv=o.createElement("div"),createIfr=o.createElement("iframe"),J(createIfrDiv).attr("class","ifCont").css({top:JimgPos.top+"px",left:JimgPos.left+"px",position:"absolute"}),J(createIfr).attr({id:"youtubeplayer",src:videoSrc,sandbox:"allow-scripts allow-same-origin"}).css({border:"none",height:imgHt,width:imgWid}),createIfrDiv.appendChild(createIfr),Jparent.append(createIfrDiv),Widget.isIframeLoaded=!0,M(),e.preventDefault(),e.stopPropagation()}),handleImageMove=function(e,t){return"mousemove"==e.type?handleMouseMoveEvent(e,t):"mouseup"==e.type?handleMouseUpEvent(e,t):"mousedown"==e.type?handleMouseDownEvent(e,t):void 0},handleMouseDownEvent=function(e,t){var i=e.srcElement||e.target,o=editor.doc.getRole();if(!editor.isEditable()||"SHAREDREADCOMMENT"==o||"ANYONELINK_SHAREDREADCOMMENT"==o||J(i).parents().hasClass("unselectableSection"))return!1;if("object"==typeof i.className&&i.className.baseVal.indexOf("zw-image")!=-1&&2!=e.button){var i=editor.browserInfo.is_ie?e.srcElement:e.target;J(i);return Resize.removeResizeDiv(),addDummyImage(e),Resize.mouseDownCoord={clientX:e.clientX,clientY:e.clientY},editor.imgDragStart=!0,!1}return!1},handleMouseMoveEvent=function(e,t){var i=e.srcElement||e.target;if(CropImage.getImageDrag())return void CropImage.handleDrag(e);if(editor.imgDragStart){if("object"==typeof i.className&&i.className.baseVal.indexOf("zw-image")!=-1||editor.imgDrag){if(!editor.imgDrag){editor.imgDrag=!0;var o=editor.doc.getSelection(),r=(o.getLastRange(),editor.doc.getParents(NODE_TYPE.IMAGE,o.getStart()));if(r){var n=DocUtil.copyStyle(r.attr());EventHandler.imgDragAttr=n;var a=editor.isFloatingImage(EventHandler.imgDragAttr);a?PubSub.publish("Gridlines/show"):EventHandler.isInline=!0,EventHandler.textDragSt=EventHandler.textDragEnd=o.getStart();var l=[{r:o.getStart()},{ds:editor.doc.getCharAt(o.getStart())}];Op.processMsg(l)}}changeDummyImagePosition(e);var i=editor.browserInfo.is_ie?e.srcElement:e.target;J(i);if(EventHandler.textDragStart||editor.externalImgDrag||!editor.isFloatingImage(EventHandler.imgDragAttr)){if(0==J(e.originalEvent?e.originalEvent.target:i).parents("#ui-editor-outer-div").length)return;EventHandler.moveCursor(e)}if(!editor.imgDrag)return Utils.stopEvent(e),!0}else editor.imgDrag||(editor.imgDragStart=!1);return!0}return!1},handleMouseUpEvent=function(e,i){var o=editor.browserInfo.is_ie?e.srcElement:e.target;J(o);if(CropImage.getImageDrag())return void CropImage.handleMouseUp(e);EventHandler.mouseUpDone=!0,J("#dummyDragImage").remove();var r=editor.doc.getSelection();if(editor.imgDrag){PubSub.publish("Gridlines/hide"),editor.lastOperation="Drag and Drop",r.removeTableSelection();var n=r.getStart();if(editor.doc.getDomCursorNode(editor.uuid,editor.zuid,"start").css("border-left-style",""),editor.isFloatingImage(EventHandler.imgDragAttr)){if(Resize.mouseDownCoord&&Resize.mouseDownCoord.clientX!=e.clientX){var a=e.clientX,l=e.clientY;EventHandler.moveCursorToParaStart(e,a,l);var s,d,c,p,u,f=editor.clientActiveSection,g=0;if("zw-contentpane selectableSection"!=f.className)s=Utils.getClosestChild(f,"span.zw-portion",a,l),d=J(s).parents("div.zw-paragraph"),c=d[0];else{s=Utils.getClosestChild(editor.editorPaneContainer[0],"span.zw-portion",a,l),d=J(s).parents("div.zw-paragraph"),c=d[0];for(var m=ViewManager.getView(d),h=ViewManager.getViews(m.node),T=0,E=h.length;T<E;T++)h[T].start<m.start&&(g+=h[T].getHeight())}u=a-t.offsetLeft(c)*editor.zoomFactor-editor.editorOffset.left,u>editor.jeditorPane.width()?u=editor.doc.getPaperWidth(!0)-EventHandler.imgDragAttr.wid:u<0&&(u=0),p=l-t.offsetTop(c)*editor.zoomFactor-editor.editorOffset.top,p%=ViewManager.getPageHeight(),p+=g,p-=imageTopDiff,u-=imageLeftDiff,EventHandler.imgDragAttr[ATTR_IMAGE.I_LEFT]=u/editor.zoomFactor,EventHandler.imgDragAttr[ATTR_IMAGE.I_TOP]=p/editor.zoomFactor;var R=r.parents(NODE_TYPE.PARAGRAPH);if(R){var S=r.getLastRange();S&&S.setStart(R.getStart())&&S.setEnd(R.getStart())}}}else EventHandler.isInline=!1;delete EventHandler.imgDragAttr.id;var O=r.getStart();if(editor.doc.execCmd("insimg",EventHandler.imgDragAttr),editor.imgDrag=!1,r.getStart()>editor.textDragSt){var S=editor.doc.createRange(n);r.removeAllRanges().addRange(S)}EventHandler.imgDragAttr={},Resize.moveCursorOnImg(EventHandler.textDragSt,O),Resize.selectImg()}else editor.imgDragStart=!1;return mouseDownY=null,mouseDownX=null,imageTopDiff=null,imageLeftDiff=null,editor.imgDragStart=!1,!1},addDummyImage=function(e){var t=e.srcElement||e.target,i=J(t).parent().parent().clone();i.css("pointer-events","none"),i.children().children().css("pointer-events","none");var o={position:"absolute",top:0,left:0,opacity:"0.6","z-index":"100",display:"none"},r=J(t).parent().parent().offset();i.css(o),mouseDownY=e.clientY,mouseDownX=e.clientX,imageTopDiff=e.clientY-r.top,imageLeftDiff=e.clientX-r.left,i[0].setAttribute("id","dummyDragImage"),J(t).parent().parent().parent().prepend(i)},changeDummyImagePosition=function(e){var t=e.srcElement||e.target,i=!(J(t).parents("div")[1]&&J(J(t).parents("div")[1]).hasClass("zw-float")),o=J("#dummyDragImage"),r=0,n=0;i||(r=parseInt(J(t).parents("div")[0].style.top),n=parseInt(J(t).parents("div")[0].style.left),r=isNaN(r)?0:r,n=isNaN(n)?0:n);var a=e.clientX-mouseDownX,l=e.clientY-mouseDownY;o.css({top:l+r,left:a+n}),i||o.css("display","block")},removeImageAndGetStyles=function(e,i,o,r){var n=J("#editorpane").offset().left,a=n<0?i.left-n:i.left*editor.zoomFactor,l=i.top*editor.zoomFactor,s=(editor.doc.getSelection().getStart(),[{r:o},{ds:editor.doc.getCharAt(o)}]);Op.processMsg(s),EventHandler.moveCursorToParaStart(e,a,l);var d=editor.clientActiveSection,c=Utils.getClosestChild(d,"span.zw-portion",a,l),p=J(c).parents("div.zw-paragraph")[0],u=r.ml?r.ml.convertor().pixels:0,f=r.mt?r.mt.convertor().pixels:0,g={};return jQuery.extend(g,r),g[ATTR_IMAGE.I_LEFT]=a-t.offsetLeft(p)*editor.zoomFactor-(editor.editorOffset.left>0?editor.editorOffset.left:0)-u,g[ATTR_IMAGE.I_TOP]=l-t.offsetTop(p)*editor.zoomFactor-editor.editorOffset.top-f,g},{removeResizeDiv:M,getTargetImg:De,setTargetImg:Ce,getIsProgress:Ie,setIsImage:Pe,setResizeDiv:ve,selectImg:Ae,selectHR:ye,moveCursorOnImg:_e,isResize:Ne,updateCursorTypes:se,handleImageMove:handleImageMove,getCropData:k,getAppliedStyles:B,removeImageAndGetStyles:removeImageAndGetStyles}}(SVGTransform,PUtil,CurUtil,document),CropImage=function(){var e=0,t=0,i=null,o={},r=null,n=!1,a=null,l=!1,s=!1,d=!1,c=!1,p=!1,u=null,f=null,g=null,m=null,h=null,T=null,E=null,R=null,S=null,O=null,v={},b=!1,A=null,y={},D=null,C=!1,I=function(e){if(!n){if(y={northWestRect:" v 18 h 4 v -14 h 14  v -4 h -14 z",northEastRect:" h 18 v 18 h -4 v -14 h -14 v -4 z",southWestRect:" h 18 v -4 h -14 v -14  h -4 v 14 z",southEastRect:" v -18 h -4 v 14 h -14  v 4 h 18 z"},0==J("#cropGridSVG").length){var t=editor.doc.getBodyFormat(),i=Handlebars.compile(J("#img-crop-resize-svg").html());g=J(i())[0],f=J(g).children()[0],editor.clientActiveSection.className.indexOf("zw-contentpane")==-1&&(g.style.top=t.mt.convertor().pixels+"px",g.style.left=t.ml.convertor().pixels+"px"),u=J(f).find("#mainRect")[0],f.style.top=-t.mt.convertor().pixels+"px",f.style.left=-t.ml.convertor().pixels+"px"}if(0==J("#bgImgOuterDiv").length){var o=Handlebars.compile(J("#dummy-image-div").html());m=J(o())[0],h=J(m).children()[0],T=J(h).children()[0]}w()}P(),n=!0},P=function(){l=!0,J("#imgResizeGrid").remove(),Resize.selectImg(),S=J("#imgResizeGrid")[0],O=J(S).find("rect.svgEditable")[0],r=Resize.getTargetImg(),R=r.parentElement||r.parentNode,E=R.parentElement||R.parentNode,a=editor.doc.getSelection().getStart(),A=editor.doc.getFormats()[a];var e=J(R).offset(),t=Utils.getOrginalHeighWidthOfImage(A),i=J(editor.doc.getCursorPortionNode()).parents("div.selectableSection").offset();o.width=parseInt(t.wid),o.height=parseInt(t.ht),o.left=(e.left-i.left)/editor.zoomFactor,o.top=(e.top-i.top)/editor.zoomFactor,"%"==A[ATTR_IMAGE.I_WID_UN]&&(o.width=ViewManager.getColumnWidth(),o.height=A[ATTR_IMAGE.I_ORGINALHT]*ViewManager.getColumnWidth()/A[ATTR_IMAGE.I_ORGINALWID]);var n=null;if(A[ATTR_IMAGE.I_CROPRECT]&&(n=Utils.convertCropDataToPixel(A[ATTR_IMAGE.I_CROPRECT],o.height,o.width)),n&&(o.width=parseInt(o.width-(n.cropLeft+n.cropRight)),o.height=parseInt(o.height-(n.cropTop+n.cropBottom)),o.left+=n.cropLeft,o.top+=n.cropTop),A[ATTR_IMAGE.I_ROTATE]&&0!=A[ATTR_IMAGE.I_ROTATE]){var s=J(E),d=s.offset(),c=0;imageLeft=0,!editor.isFloatingImage(A)||A[ATTR_IMAGE.I_ROTATE]&&0!=A[ATTR_IMAGE.I_ROTATE]?(c=parseInt(s[0].style.top),imageLeft=parseInt(s[0].style.left)):(d=s.parent().offset(),A.ml&&(d.left=d.left+parseInt(A.ml.convertor().pixels),d.top=d.top+parseInt(A.mt.convertor().pixels))),o.top=(d.top-i.top)/editor.zoomFactor+c,o.left=(d.left-i.left)/editor.zoomFactor+imageLeft;var p=parseInt(A[ATTR_COMMON.BORDERS]&&A[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_TOP]?parseInt(A[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_TOP][ATTR_BORDERS.WIDTH]):0);o.top=o.top+p,o.left=o.left+p}_(o.width,o.height,o.left,o.top,A[ATTR_IMAGE.I_ROTATE])},_=function(e,t,i,r,n){var a=editor.doc.getBodyFormat(),l=1,s=18,d=4,c=10.5;editor.clientActiveSection.className.indexOf("zw-contentpane")!=-1&&(r=r+a.mt.convertor().pixels+l,i=i+a.ml.convertor().pixels+l),n=n?n:0;var p=(J(f),J(m));if(p.insertBefore(J(S)),!A[ATTR_IMAGE.I_CROPRECT]&&!b){if(!(editor.isFloatingImage(A)||A[ATTR_IMAGE.I_ROTATE]&&0!=A[ATTR_IMAGE.I_ROTATE])){var g=A.mt?A.mt.convertor().pixels:0,h=document.createElement("div"),T={id:"duumyDiv",width:o.width+"px",height:o.height+"px"};Q(h,T),J(h).insertBefore(J(E)),Q(E,{position:"absolute",marginTop:-o.height+"px"}),g=-o.height}var T={width:e+"px",height:t+"px",marginTop:g+"px",overflow:"hidden"};Q(E,T)}var R=u,T={x:i,y:r,width:e,height:t,display:"block"};q(R,T);var O=f.querySelectorAll("#northWestRect");T={d:"M "+i+" "+r+y.northWestRect},q(O[0],T),O=f.querySelectorAll("#northEastRect"),T={d:"M "+(e+i-s)+" "+r+y.northEastRect},q(O[0],T),R=f.querySelector("#northRect"),T={x:e/2+i-c,y:r},q(R,T),R=f.querySelector("#westRect"),T={x:i,y:r+t/2-c},q(R,T),R=f.querySelector("#eastRect"),T={x:e+i-d,y:r+t/2-c},q(R,T),O=f.querySelectorAll("#southWestRect"),T={d:"M "+i+" "+(r+t)+y.southWestRect},q(O[0],T),O=f.querySelectorAll("#southEastRect"),T={d:"M "+(e+i)+" "+(r+t)+y.southEastRect},q(O[0],T),R=f.querySelector("#southRect"),T={x:e/2+i-c,y:r+t-d},q(R,T);var v=f.parentElement||f.parentNode;J(v).remove(),J(v).insertBefore(J(S)),svgPt=f.createSVGPoint();var D=i+e/2,C=r+t/2;0!=n&&L(n,D,C),N();var I=["#northRect","#northEastRect","#eastRect","#southEastRect","#southRect","#southWestRect","#westRect","#northWestRect"],P=["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"];Resize.updateCursorTypes(I,P,f)},N=function(){var e=J(m),t=J(r).offset(),i=A[ATTR_IMAGE.I_ROTATE],o=Utils.getOrginalHeighWidthOfImage(A),n=J(editor.clientActiveSection).offset(),a=o.wid,l=o.ht;"%"==A[ATTR_IMAGE.I_WID_UN]&&(a=ViewManager.getColumnWidth(),l=A[ATTR_IMAGE.I_ORGINALHT]*ViewManager.getColumnWidth()/A[ATTR_IMAGE.I_ORGINALWID]);var s=(t.top-n.top)/editor.zoomFactor,d=(t.left-n.left)/editor.zoomFactor,c=e.find("image")[0];if(i&&0!=i){var p=Utils.getTransformedSize(i,a,l);s+=(p.height-l)/2,d+=(p.width-a)/2}c.setAttribute("width",a),c.setAttribute("height",l),Q(m,{width:a+"px",height:l+"px"}),Q(h,{width:a+"px",height:l+"px",marginTop:"0px",marginLeft:"0px"}),c.setAttribute("xlink:href",r.getAttribute("xlink:href"));var u={top:s+"px",left:d+"px",position:"absolute"};i&&(u.transform="rotate("+i+"deg)"),Q(m,u)},L=function(e,t,i){var o=f.querySelectorAll(".rect"),r=0,n=o.length;for(r=0;r<n;++r)o[r].setAttribute("transform","rotate("+e+" "+t+" "+i+")");u.setAttribute("transform","rotate("+e+" "+t+" "+i+")")},w=function(){var e=f.querySelectorAll(".rect"),t=0,i=e.length;for(t=0;t<i;t++)M(e[t]);f.addEventListener("mousedown",function(e){V(e)}),f.addEventListener("mousemove",function(e){U(e)}),f.addEventListener("mouseup",function(e){x(e)}),m.addEventListener("mousedown",function(e){return H(e),e.preventDefault(),!1}),m.addEventListener("mousemove",function(e){G(e)}),m.addEventListener("mouseup",function(e){z(e)}),PubSub.subscribe("Cursor/Collapsed",B)},M=function(o){o.addEventListener("mousedown",function(o){svgPt.x=o.clientX,svgPt.y=o.clientY;var r=svgPt.matrixTransform(f.getScreenCTM().inverse());e=r.x,t=r.y,i=o.target,b=!0,f.style["pointer-events"]="all"})},U=function(e){return C?void Y(e):void F(e)},x=function(r){if(b)f.style["pointer-events"]="none",k(r),i=null;else if(p)W(r);else if(!A[ATTR_IMAGE.I_CROPRECT]){var n=o.width,a=o.height;editor.isFloatingImage(A)||A[ATTR_IMAGE.I_ROTATE]&&0!=A[ATTR_IMAGE.I_ROTATE]||(J(E).siblings()[0].remove(),E.style.position=""),Q(E,{width:n+"px",height:a+"px",marginTop:"0px",marginLeft:"0px",overflow:"hidden",position:""}),Q(R,{marginLeft:"0px",marginTop:"0px"})}e=null,t=null,b=!1,c=!1,p=!1,C=!1,D=null},F=function(r){if(null!=i){var n=X(r,e,t,i,f);cropCornerName=i.className.animVal.split(" ")[0];var a=o.top,l=o.left,s=o.width,d=o.height;if(re(),"northWestRect"==cropCornerName?(D.cropTop=D.cropTop+n.y,D.cropLeft=D.cropLeft+n.x,a+=n.y,d-=n.y,s-=n.x,l+=n.x):"northRect"==cropCornerName?(D.cropTop=D.cropTop+n.y,a+=n.y,d-=n.y):"northEastRect"==cropCornerName?(D.cropTop=D.cropTop+n.y,D.cropRight=D.cropRight-n.x,a+=n.y,s+=n.x,d-=n.y):"westRect"==cropCornerName?(D.cropLeft=D.cropLeft+n.x,l+=n.x,s-=n.x):"eastRect"==cropCornerName?(D.cropRight=D.cropRight-n.x,s+=n.x):"southWestRect"==cropCornerName?(D.cropLeft=D.cropLeft+n.x,D.cropBottom=D.cropBottom-n.y,l+=n.x,s-=n.x,d+=n.y):"southRect"==cropCornerName?(D.cropBottom=D.cropBottom-n.y,d+=n.y):"southEastRect"==cropCornerName&&(D.cropRight=D.cropRight-n.x,D.cropBottom=D.cropBottom-n.y,s+=n.x,d+=n.y),s<25||d<25)return;_(s,d,l,a,A[ATTR_IMAGE.I_ROTATE])}},k=function(e){if(i||c||p){elem=editor.doc.getParents(NODE_TYPE.IMAGE,a);var t={};if(D){d=!0;var o=Utils.getOrginalHeighWidthOfImage(A);D=Utils.convertCropDataToPercentage(D,o.ht,o.wid);var r=editor.isFloatingImage(A);if(r){offset=J(u).offset();var n=Resize.removeImageAndGetStyles(e,offset,a,A);jQuery.extend(t,n)}if(i&&(t[ATTR_IMAGE.I_WID]=parseInt(u.width.animVal.value),t[ATTR_IMAGE.I_HT]=parseInt(u.height.animVal.value),t[ATTR_IMAGE.I_WID_UN]="px",t[ATTR_IMAGE.I_HT_UN]="px"),t[ATTR_IMAGE.I_CROPRECT]=D,r){var l=editor.doc.getSelection().getStart();editor.doc.execCmd("insimg",t),Resize.moveCursorOnImg(a,l),a=l}else editor.doc.execCmd("applyStyle",[elem,t,"cropImage"]);P(),d=!1}}},B=function(){if(!b&&!A[ATTR_IMAGE.I_CROPRECT]){if(!(editor.isFloatingImage(A)||A[ATTR_IMAGE.I_ROTATE]&&0!=A[ATTR_IMAGE.I_ROTATE])){var a=J(E).siblings()[0];a&&a.remove(),E.style.position=""}var d=A.mt?A.mt.convertor().pixels:0,c=A.ml?A.ml.convertor().pixels:0;Q(E,{width:o.width+"px",height:o.height+"px",marginTop:d+"px",marginLeft:c+"px",overflow:"hidden"}),Q(R,{marginLeft:"0px",marginTop:"0px"})}l=!!ee(),l||(J(f.parentElement||f.parentNode).remove(),J(m).remove(),PubSub.unsubscribe("Cursor/Collapsed",B),s=!1,n=!1,targetElem=null,e=null,t=null,i=null,o={},y={},u=null,f=null,g=null,m=null,h=null,T=null,E=null,R=null,S=null,O=null,r=null,D=null)},H=function(e){e.stopPropagation(),c=!0,v.mouseDown={},v.mouseDown.clienX=e.clientX,v.mouseDown.clienY=e.clientY,J(S).hide(),Q(m,{"z-index":"11"})},G=function(e){if(e.stopPropagation(),b)U(e);else if(c){var t=e.clientX-v.mouseDown.clienX,i=e.clientY-v.mouseDown.clienY;j(i,t),Z(i,t)}},z=function(e){e.stopPropagation(),EventHandler.mouseUpDone=!0,b?x(e):c&&(v={},k(e),Q(m,{width:"",height:"","z-index":"10"}),e.stopPropagation()),c=!1},V=function(e){if(e.stopPropagation(),!C&&!p&&!b){Q(m,{"pointer-events":"none"}),Q(f,{"pointer-events":"all"}),v.mouseDown={};svgPt.matrixTransform(R.getScreenCTM().inverse());v.mouseDown.clienX=e.clientX,v.mouseDown.clienY=e.clientY,C=!0;var t=J("#dummyDiv")[0];if(!t&&!editor.isFloatingImage(A)&&(!A[ATTR_IMAGE.I_ROTATE]||0==A[ATTR_IMAGE.I_ROTATE])&&A[ATTR_IMAGE.I_CROPRECT]){var i=document.createElement("div");i.setAttribute("id","dummyDiv");var r={width:o.width+"px",height:o.height+"px"};Q(i,r),J(i).insertBefore(J(E));var n=-o.height;Q(E,{position:"absolute",marginTop:n+"px"})}svgPt=R.createSVGPoint(),v.gridPostion={};var a=e.srcElement||e.target;v.gridPostion.top=a.y.animVal.value,v.gridPostion.left=a.x.animVal.value,v.fgImage={},v.fgImage.top=parseInt(E.style.marginTop.convertor().pixels),v.fgImage.left=parseInt(E.style.marginLeft.convertor().pixels),v.gridRects=[];var l=0;J(".cropCorners").each(function(){v.gridRects[l]={};var e=this.getAttribute("d"),t=e.split(" ");v.gridRects[l].x=parseFloat(t[1]),v.gridRects[l].y=parseFloat(t[2]),l++}),J(".cropSides").each(function(){v.gridRects[l]={},v.gridRects[l]={},v.gridRects[l].x=this.x.animVal.value,v.gridRects[l].y=this.y.animVal.value,l++})}},Y=function(e){if(e.stopPropagation(),C){p=!0;var t=e.clientX-v.mouseDown.clienX,i=e.clientY-v.mouseDown.clienY,r=-t,n=-i;if(changeGridPosition(t,i,e),A.rotation){var a=180-A.rotation;a=22*a/1260,r=t*Math.cos(a)-i*Math.sin(a),n=i*Math.cos(a)+t*Math.sin(a)}var l=v.fgImage.top>0?v.fgImage.top:0,s=v.fgImage.left>0?v.fgImage.left:0,d=0;editor.isFloatingImage(A)||A[ATTR_IMAGE.I_ROTATE]&&0!=A[ATTR_IMAGE.I_ROTATE]||(d=parseInt(o.height));var c=null,f=0,g=0,m=Utils.getOrginalHeighWidthOfImage(A);"%"==A[ATTR_IMAGE.I_WID_UN]?(f=ViewManager.getColumnWidth(),g=A[ATTR_IMAGE.I_ORGINALHT]*ViewManager.getColumnWidth()/A[ATTR_IMAGE.I_ORGINALWID]):(f=m.wid,g=m.ht),A.cropRect&&(c=Utils.convertCropDataToPixel(A.cropRect,g,f));var h=c?c.cropTop:0,T=c?c.cropLeft:0;Q(R,{marginTop:-(h-n)+"px",marginLeft:-(T-r)+"px"}),Q(E,{marginTop:l+i-d+"px",marginLeft:s+t+"px"}),re();var S=parseInt(u.width.animVal.value),O=parseInt(u.height.animVal.value),b=m.wid,g=m.ht;"%"==A[ATTR_IMAGE.I_WID_UN]&&(b=ViewManager.getColumnWidth(),g=A[ATTR_IMAGE.I_ORGINALHT]*ViewManager.getColumnWidth()/A[ATTR_IMAGE.I_ORGINALWID]),D.cropTop=D.cropTop-n,D.cropLeft=D.cropLeft-r,D.cropRight=b-(S+D.cropLeft),D.cropBottom=g-(O+D.cropTop)}},W=function(e){e.stopPropagation(),p&&(v={},k(e),Q(f,{"pointer-events":"none"}),Q(m,{"pointer-events":"visiblefill"}),p=!1,C=!1)};changeGridPosition=function(e,t,i){var r=J(f).children()[0],n={y:v.gridPostion.top+t,x:v.gridPostion.left+e};q(r,n);var a=v.gridPostion.top+t+o.height/2,l=v.gridPostion.left+e+o.width/2,s=0;J(".cropCorners").each(function(){var i={d:"M "+(v.gridRects[s].x+e)+" "+(v.gridRects[s].y+t)+y[this.id]};q(this,i),s++}),J(".cropSides").each(function(){var i={x:v.gridRects[s].x+e,y:v.gridRects[s].y+t};q(this,i),s++}),A[ATTR_IMAGE.I_ROTATE]&&0!=A[ATTR_IMAGE.I_ROTATE]&&L(A[ATTR_IMAGE.I_ROTATE],l,a)};var j=function(e,t){v.bgImage||(v.bgImage={},v.bgImage.top=parseInt(m.style.top),v.bgImage.left=parseInt(m.style.left)),Q(h,{marginTop:e+"px",marginLeft:t+"px"})},Z=function(e,t){v.fgImage||(v.fgImage={},v.fgImage.marginLeft=parseInt(R.style.marginLeft),v.fgImage.marginTop=parseInt(R.style.marginTop),v.fgImage.top=parseInt(E.style.top),v.fgImage.left=parseInt(E.style.left));var i=null,o=0,r=Utils.getOrginalHeighWidthOfImage(A);"%"==A[ATTR_IMAGE.I_WID_UN]?(wid=ViewManager.getColumnWidth(),o=A[ATTR_IMAGE.I_ORGINALHT]*ViewManager.getColumnWidth()/A[ATTR_IMAGE.I_ORGINALWID]):(wid=r.wid,o=r.ht),A.cropRect&&(i=Utils.convertCropDataToPixel(A.cropRect,o,wid));var n=i?i.cropTop:0,a=i?i.cropLeft:0;Q(R,{marginLeft:-(a-t)+"px",marginTop:-(n-e)+"px"}),re();var l=parseInt(u.width.animVal.value),s=parseInt(u.height.animVal.value),d=r.wid,o=r.ht;"%"==A[ATTR_IMAGE.I_WID_UN]&&(d=ViewManager.getColumnWidth(),o=A[ATTR_IMAGE.I_ORGINALHT]*ViewManager.getColumnWidth()/A[ATTR_IMAGE.I_ORGINALWID]),D.cropTop=D.cropTop-e,D.cropLeft=D.cropLeft-t,D.cropRight=d-(l+D.cropLeft),D.cropBottom=o-(s+D.cropTop)},X=function(e,t,i,o,r){svgPt.x=e.clientX,svgPt.y=e.clientY;var n=svgPt.matrixTransform(f.getScreenCTM().inverse());if(svgPt.x=n.x-t,svgPt.y=n.y-i,o){var a=o.getCTM(r).inverse();a.e=a.f=0,svgPt=svgPt.matrixTransform(a)}return{x:svgPt.x,y:svgPt.y}},K=function(e){s=e},$=function(){return l},q=function(e,t){for(var i in t)e.setAttribute(i,t[i])},Q=function(e,t){for(var i in t)e.style[i]=t[i]},ee=function(){return s||d||c||p},te=function(){return c||p},ie=function(e){C?Y(e):c&&G(e)},oe=function(e){p?W(e):c&&z(e)},re=function(){D={};var e=null,t=0,i=0,o=Utils.getOrginalHeighWidthOfImage(A);"%"==A[ATTR_IMAGE.I_WID_UN]?(t=ViewManager.getColumnWidth(),i=A[ATTR_IMAGE.I_ORGINALHT]*ViewManager.getColumnWidth()/A[ATTR_IMAGE.I_ORGINALWID]):(t=o.wid,i=o.ht),A.cropRect&&(e=Utils.convertCropDataToPixel(A.cropRect,i,t));e?e.cropTop:0,e?e.cropLeft:0;e||(e={},e.cropTop=0,e.cropLeft=0,e.cropRight=0,e.cropBottom=0),D.cropTop=e.cropTop,D.cropLeft=e.cropLeft,D.cropRight=e.cropRight,D.cropBottom=e.cropBottom},ne=function(){CropImage.closeCropDiv(),Resize.removeResizeDiv(),Resize.selectImg()};return{drawCropDiv:_,showCropGrid:P,init:I,isCropImageActive:$,setIsResizeImageOn:K,getImageDrag:te,closeCropDiv:B,handleDrag:ie,handleMouseUp:oe,removeCrop:ne}}();!function(){function e(e,i){var o=t(),r="",n=[],a=[];o.hasOwnProperty(e)&&o[e].hasOwnProperty("tobeEnabled")&&1!=o[e].tobeEnabled||(r="checked");var l="<div class='ui-bottom-margin-medium ui-pop-2c-variable'><input class='js-custom-autocorrect-checkbox ui-checkbox-textspace ui-fl' onclick='AutoCorrect.resetSelectAll(this)' style='margin-top:4px' type='checkbox' ctype='zstatebutton' "+r+"><input class='autocorrect-key ui-fl' maxlength='255' style='width:125px' ctype='zstatebutton' type='text' value='"+e+"' /><input class='autocorrect-val ui-fl' maxlength='255' style='width:125px' ctype='zstatebutton' type='text' value='"+i+"' /><span class='tkclose'><span class='ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-autocor-delete-sm' onclick='AutoCorrect.deleteCorrect(this);'></span></span></div>";J("div#defdiv div").each(function(){var e=J(this),t=e.find("input.autocorrect-key").val(),i=e.find("input.autocorrect-val").val();n.push(t),a.push(i)});for(var s=0;s<n.length;s++)if(n[s]==e)return a[s]!=i?(J("#defdiv").find("input[value="+a[s]+"]").parent().parent().find('input[type="checkbox"]').check(!1),l):"";return l}function t(){return J.isEmptyObject(r)?(r=w_usersettings&&w_usersettings[ATTR_BODY.DS_AUTOCORRECTS]||"{}",r=jQuery.parseJSON(r)):r}function i(){var e=J("div#prefMainDiv").children("div");if(0!=e.length){r={},e.each(function(){var e=J(this),t=e.find("input.autocorrect-key").val(),i=Utils.removeUnWantedUnicodes(e.find("input.autocorrect-val").val()),o=e.find('input[type="checkbox"]').prop("checked")?1:0;t&&i&&(r[t]={value:i,tobeEnabled:o})});var t=J("div#defdiv div");t.each(function(){var e=J(this),t=e.find("input.autocorrect-key").val(),i=e.find("input.autocorrect-val").val(),o=e.find('input[type="checkbox"]').prop("checked")?1:0;"1"!=o&&"0"!=o||(r[t]={value:i,tobeEnabled:o})})}}function o(e){var t=J("."+e),i=t.length;if(0==i)return!1;for(var o=0;o<i;o++){var r=J(t[o]).prop("checked");if(0==r)return!1}return!0}var r={},n={"custom-autocorrect-selectall":"js-custom-autocorrect-checkbox","default-autocorrect-selectall":"js-def-autocorrect-checkbox"};window.AutoCorrect={addCorrect:function(){var i=J("#autoCorrect_Key_Id").val().trim(),r=J("#autoCorrect_Value_Id").val();if(""!=i&&""!=r){var n=t();for(var a in n){var l=n[a].tobeEnabled,s=editorProps.deployment.zohowriter;if(i==a&&"1"==l)return void MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,null,s,J.i18n("writer.common.KEY_ALREADY_AVAILABLE"))}var d=e(i.trim(),r);J("#custom-autocorrect-div").after(d),J("#autoCorrect_Key_Id").val(null),J("#autoCorrect_Value_Id").val(null);var c=o("js-custom-autocorrect-checkbox");J("#custom-autocorrect-selectall").prop("checked",c)}},deleteCorrect:function(e){J(e).parents("div:first").remove();var t=o("js-custom-autocorrect-checkbox");J("#custom-autocorrect-selectall").prop("checked",t)},getUserCorrects:function(e){return e&&i(),t()},addCorrects:function(e){var t=editor.doc.getContent(e.start,e.end);SpellCheck.updateWord(e);var i=e.correction,o={},r=AutoCorrect.getUserCorrects(!0);r[t]={value:i,tobeEnabled:1},w_usersettings[ATTR_BODY.DS_AUTOCORRECTS]=JSON.stringify(r),o[ATTR_BODY.DS_AUTOCORRECTS]=JSON.stringify(r),Utils.setCsrfParam(o),J.post(Utils.getNiceUrlPrefix("user/settings/options"),o)},showCorrects:function(){var i="",r=t();for(var a in r){var l=r[a];i+=e(a,l.value),J("div#defdiv div").each(function(){var e=J(this),t=e.find("input.autocorrect-key").val(),i=e.find("input.autocorrect-val").val();a==t&&l.value==i&&"1"==r[a].tobeEnabled&&e.find('input[type="checkbox"]').attr("checked",!0)})}J("div#prefMainDiv").append(i),"0"==w_usersettings[ATTR_BODY.DS_PREF]&&J("div#prefdiv, div#defaultprefdiv").find(":input").attr("disabled",!0);for(var a in n){var s=o(n[a]);J("#"+a).prop("checked",s)}},toggleSelectAllCorrects:function(e){var t=J(e).prop("checked"),i=n[e.id];J("."+i).prop("checked",t)},resetSelectAll:function(e){var t,i,r=J(e),a=r.prop("checked");for(var l in n)r.hasClass(n[l])&&(i=l,t=n[l]);if(t&&i)if(0==a)J("#"+i).prop("checked",!1);else{var s=o(t);J("#"+i).prop("checked",s)}}}}(),BookmarkDialog.prototype={name:"",selectedId:"",hideBookmark:!1,isGetLinkDialogueOpened:!1,openBookmarkPopup:function(){var e=editor.doc.getSelection();if(e.isCollapsed()){var t=e.getWord();t.select()}J.dialogutil.open("bookmarkdialog",J("#ins_bookmark"),this.info)},validation:function(){return!0},isSelectionContainsHR:function(){var e=editor.doc.getSelection().getLastRange();return!!e&&e.getContent().indexOf(UNICODE.HR)!=-1},info:{get:function(e){"bookmarkdiv"==e&&BookmarkDialog.update()},set:function(e,t,i){t=Utils.removeUnWantedUnicodes(t),"bookmarkname"==e.action&&(BookmarkDialog.name=t)}},insert:function(){var e=J("#bookmark_popup"),t=e.zvalidation("validateAllFields",e);if(t){var i;i=editor.doc.createElement(NODE_TYPE.BOOKMARK,{id:Utils.randomString(),name:Utils.removeUnWantedUnicodes(J("#bMarkText").val())}),editor.doc.execCmd("bookmark",i),J("#bMarkText").attr("value",""),BookmarkDialog.update(),J.dialogutil.close("bookmarkdialog")}},toggleBookmark:function(){BookmarkDialog.hideBookmark=!BookmarkDialog.hideBookmark,JbookMarkDivs=J(".bMark"),BookmarkDialog.hideBookmark?(JbookMarkDivs.hide(),Utils.addToStatistics("HideBookmark")):JbookMarkDivs.show()},remove:function(e){if(BookmarkDialog.selectedId||e){var t=e?e:BookmarkDialog.selectedId;delete editor.bookmarks[t];var i=editor.doc.getElement("bookmark",t)[0];editor.doc.execCmd("delete",i),editor.jeditorPane.children("div.markingDiv").remove(),BookmarkDialog.selectedId="",BookmarkDialog.update(),J.dialogutil.isDialogOpened("bookmarkdialog")||(EventHandler.isDialogOpened=!1)}},removeAll:function(){editor.doc.execCmd("deleteAllBookMarks"),editor.bookmarks={},this.update()},optionSelect:function(e){BookmarkDialog.selectedId=e.id,J("p.ui-insert-bookmark-selected").removeClass("ui-insert-bookmark-selected").addClass("ui-insert-bookmark-normal"),J(e).removeAttr("class").addClass("ui-insert-bookmark-selected")},update:function(){var e=J("#bookmarkList"),t=editor.doc.getElement("bookmark");if(e.empty(),t.length){for(var i,o=0;i=t[o++];)i.id.indexOf("toc_")==-1&&i.name&&(editor.bookmarks[i.id]={name:i.name},e.append(J("<p></p>").attr("id",i.id).addClass("ui-insert-bookmark-normal").click(function(){BookmarkDialog.optionSelect(this)}).text(i.name)));BookmarkDialog.selectedId?e.find("p#"+BookmarkDialog.selectedId).addClass("ui-insert-bookmark-normal"):(J("p#"+t[0].id).addClass("ui-insert-bookmark-normal"),BookmarkDialog.selectedId=t[0].id),J("#bMarkGoTo,#bMarkDelete,#bMarkAllDelete").attr("disabled",!1)}else e.empty(),J("#bMarkGoTo,#bMarkDelete,#bMarkAllDelete").attr("disabled",!0);J("#bMarkGoTo,#bMarkDelete,#bAllDelete").button("refresh"),EventHandler.isDialogOpened&&CurUtil.stopBlinking(),J("#bMarkText").focus()},constructMenu:function(e){for(var t,i,o=DocTreeManager.lineAtIndex(DocTreeManager.getStartIndex(e.parentElement),editor.getPageID()).bookMarks,r=[],n=o.length,a=0;a<n;a++)i=o[a].id,i.indexOf("toc")==-1&&(t={label:o[a].name,data:"{'appData':{'action':'Utils.moveToBookmark','params':'"+i+"'}}",menu:J("#bookmark")},r.push(t),t={label:J.i18n("writer.common.REMOVE"),data:"{'appData':{'action':'BookmarkDialog.remove','params':'"+i+"'}}",menu:J("#bookmark")},r.push(t),t={label:J.i18n("writer.common.GET_LINK"),data:"{'appData':{'action':'BookmarkDialog.showLink','params':['"+i+"']}}",menu:J("#bookmark")},r.push(t),a!=n-1&&r.push({mtype:"separator",menu:J("#bookmark")}));return r},showLink:function(e){var t,i,o,r,n;if(this.isGetLinkDialogueOpened=!0,"string"==typeof e?(t=e,i="comment",o="comments"):(t=e[0],i=e[1],o="bookmarks"),"link"==i)n=CurUtil.offset.start.top+editor.editorPaneContainer.offset().top+20-editor.editorPaneContainer.scrollTop(),r=CurUtil.offset.start.left+editor.editorPaneContainer.scrollLeft();else if("comment"==i){if(ModeManager.getCurrentMode()===EDITOR_MODES.COLLABORATE)var a=CommentManager.views.commentCollectionView.commentViewMap[t].$el;else var a=CommentManager.views.commentCollectionView.commentBubbleViewMap[t].$el;var l=a.find(".ui-auth-txt").offset();n=l.top,r=l.left}else if("version"==i){o="version";var s=HistoryUI.getSelectedVersionItemDOM(),d=s.offset();n=d.top,r=d.left}else{var c=J("#"+t),p=c.offset();n=p.top,r=p.left}var u=J("#bookmarklink-text");J("#bookmark-popup").css({top:n,left:r}).show(),u.val(editor.base_url+"/open/"+editor.doc.rid+"/"+o+"/"+t).select()},showAdvance:function(){var e=J("fieldset#manageBookmark"),t=J("#bookmark_popup");e.is(":hidden")?(e.show(),t.find(".ui-icon-triangle-1a-e").removeClass("ui-icon-triangle-1a-e").addClass("ui-icon-triangle-1a-s")):(e.hide(),t.find(".ui-icon-triangle-1a-s").removeClass("ui-icon-triangle-1a-s").addClass("ui-icon-triangle-1a-e"))}};var BookmarkDialog=new BookmarkDialog;CollabPanelHandler.unreadChatCount=0,CollabPanelHandler.contactServer,CollabPanelHandler.collabPanel,CollabPanelHandler.isInitialised=!1,CollabPanelHandler.collabPanelUserList={},CollabPanelHandler.chatContent=!1,CollabPanelHandler.unreadNotificationContainer,CollabPanelHandler.getTranscript=function(e){var t={rid:e};csrfParamName&&(t[csrfParamName]=getcsrf()),J.ajax({type:"POST",url:Utils.getNiceUrlPrefix("user/settings/chat"),data:t,success:function(e){e&&"SUCCESS"===e.RESPONSE&&(CollabPanelHandler.chatContent=e.transcript,J(".ui-zcollaborator-content").last().html(CollabPanelHandler.chatContent))},error:function(e,t,i){}})},CollabPanelHandler.init=function(){CollabPanelHandler.isInitialised=!0,CollabPanelHandler.contactServer=contactServer,CollabPanelHandler.collabPanel=J("#collabdialog"),CollabPanelHandler.collabPanel.zcollaborator(),CollabPanelHandler.unreadNotificationContainer=J("#chat-notify-cont"),CollabPanelHandler.initPanel(),CollabPanelHandler.updateCollabCount()},CollabPanelHandler.initPanel=function(){CollabPanelHandler.collabPanel.unbind("collaboratorchatentered"),CollabPanelHandler.collabPanel.unbind("collaboratorusernameclicked"),CollabPanelHandler.collabPanel.parents(".ui-statusbar-collab-dialog").css({top:"",bottom:26}),CollabPanelHandler.collabPanel.parent(".ui-dialog-content").css({overflow:"hidden"}),CollabPanelHandler.bindPanelEvents(),J(".ui-statusbar-collab-dialog .ui-dialog-titlebar a span").removeClass().addClass("ui-icon ui-components-icon ui-icon-minus"),J(".ui-statusbar-collab-dialog .ui-dialog-titlebar a").attr("title",J.i18n("common","MINIMIZE")),J(".ui-statusbar-collab-dialog .ui-dialog-titlebar a").css({background:"none"}),"REMOTE"==editor.getEditorType()||CollabPanelHandler.chatContent||CollabPanelHandler.getTranscript(editor.doc.getDocInfo().RID)},CollabPanelHandler.bindPanelEvents=function(){CollabPanelHandler.collabPanel.zcollaborator({statusBarKeys:{messageKeys:{editing:"ui-icon ui-components-icon ui-icon-zdocedit",viewing:"ui-icon ui-components-icon ui-icon-zview"},statusKeys:["offline"]}}),CollabPanelHandler.collabPanel.bind("collaboratorchatentered",function(e,t){currentUsername="REMOTE"==editor.getEditorType()?editor.loginName:editor.doc.getUserData()[editor.zuid].fname,CollabPanelHandler.collabPanel.zcollaborator("addChatMessage",currentUsername,t),CollabPanelHandler.sendMessage(t)}),CollabPanelHandler.collabPanel.bind("collaboratorusernameclicked",function(e,t){"false"===w_usersettings.showchatbar&&UIUtils.changeChatBarView(),WebMessanger.chat(t.uid)});var e=J("#collaboratorPanelDiv");e.on("click",function(t){J(this).hasClass("visible")?(CollabPanelHandler.collabPanel.zcollaborator("close"),EventHandler.isDialogOpened=!1,J(this).removeClass("visible")):(J("#collabdialog").zcollaborator("open"),CollabPanelHandler.unreadChatCount=0,CollabPanelHandler.unreadNotificationContainer.hide(),J("#collaboratorPanelDiv").removeClass("ui-yellow-bg"),e.addClass("visible"),setTimeout(function(){J("div#collabdialog").unbind("mousedown").bind("mousedown",function(){EventHandler.isDialogOpened=!0})},500))})},CollabPanelHandler.addCollaborator=function(e,t,i){if(e!==editor.zuid&&!CollabPanelHandler.isExistingCollaborator(e)){var o={zuid:e,dname:t,box:{color:i},image:Utils.getUserImageURL(e),status:"active"};CollabPanelHandler.collabPanel&&(CollabPanelHandler.collabPanelUserList[e]=o,CollabPanelHandler.collabPanel.zcollaborator("addUser",o),J("div[uid="+Utils.escapeSelectorId(e)+"]").click(function(){try{var t=editor.doc.userData[e].uuids;if(t){var i=t.split(",")[0];if(i){var o=editor.doc.getCursorPortionNode(i,"start");if(o){var r=Utils.scrollElementIntoView(o,500);r&&r.promise().then(function(){CurUtil.showCollbUserName(i)})}}}return!1}catch(e){}}),CollabPanelHandler.updateCollabCount())}},CollabPanelHandler.removeCollaborator=function(e,t){e!==editor.zuid&&CollabPanelHandler.isExistingCollaborator(e)&&(delete CollabPanelHandler.collabPanelUserList[e],CollabPanelHandler.updateCollabCount(),CollabPanelHandler.collabPanel.zcollaborator("removeUser",e),UIUtils.toggleCollabActionButtons())},CollabPanelHandler.addChatMessage=function(e,t){J("#collaboratorPanelDiv").hasClass("visible")||(CollabPanelHandler.unreadChatCount++,CollabPanelHandler.unreadNotificationContainer.find("#chat-notify-text").text(CollabPanelHandler.unreadChatCount),J("#collaboratorPanelDiv").addClass("ui-yellow-bg"),CollabPanelHandler.unreadNotificationContainer.show()),CollabPanelHandler.collabPanel.zcollaborator("addChatMessage",e,t),CollabPanelHandler.chatContent=J(".ui-zcollaborator-content").last().html(),"undefinded"!=typeof w_usersettings.AUDIO&&"1"===w_usersettings.AUDIO&&"REMOTE"!=editor.getEditorType()&&("undefined"==typeof window.sound&&(window.sound={},sound.alert=new Audio(mediaStaticURL+"sound/alert.wav"),sound.ascending=new Audio(mediaStaticURL+"sound/ascending.wav"),sound.beep=new Audio(mediaStaticURL+"sound/beep.wav"),sound.cuckoo=new Audio(mediaStaticURL+"sound/cuckoo.wav"),sound.doorbell=new Audio(mediaStaticURL+"sound/doorbell.wav"),sound.event=new Audio(mediaStaticURL+"sound/event.wav"),sound.phonering=new Audio(mediaStaticURL+"sound/phonering.wav"),sound.shaker=new Audio(mediaStaticURL+"sound/shaker.wav"),sound.techno=new Audio(mediaStaticURL+"sound/techno.wav"),sound.xylo=new Audio(mediaStaticURL+"sound/xylo.wav")),"undefined"!=window.sound[w_usersettings.SOUNDPREF]&&window.sound[w_usersettings.SOUNDPREF].play())},CollabPanelHandler.sendMessage=function(e){var t=editor.doc.getDocInfo();CollabPanelHandler.chatContent=J(".ui-zcollaborator-content").last().html();var i={DOCUMENT_ID:t.DOCUMENT_ID,collabId:t.COLLAB_ID,rid:t.RID,zuid:editor.zuid,html:J(".ui-zcollaborator-content").last().html(),msg:e};i[csrfParamName]=getcsrf(),"REMOTE"==editor.getEditorType()&&(i.rsid=RemoteEditor.rsid,i.zuid=RemoteEditor.options.wms_annnonuser_id),J.ajax({type:"post",url:Utils.getUrl("chat"),data:i,success:function(e){},error:function(e,t,i){}})},CollabPanelHandler.updateCollabCount=function(){var e=Object.keys(CollabPanelHandler.collabPanelUserList).length;"true"==editor.doc.getDocInfo().ISSHARED||e>0||CollabPanelHandler.chatContent&&CollabPanelHandler.chatContent.length>0?(J("#collaboratorPanelDiv").addClass("ui-collaborators-userinside").removeClass("ui-collaborators-userediting").show(),J("#Collaborators_btn,#notifyCollaborators").prop("enable",!0),J("#bbar-collabcnt").html(e)):J("#collaboratorPanelDiv").hide()},CollabPanelHandler.isExistingCollaborator=function(e){var t=Object.keys(CollabPanelHandler.collabPanelUserList);return!!t.contains(e)},CollabPanelHandler.handleComponentReady=function(){CollabPanelHandler.init();var e,t=editor.doc.getUserData(),i=[];for(var o in t)RemoteEditor.options.wms_annnonuser_id!=o&&(e=t[o],e.unique_userid&&i.push(e.unique_userid),ZWCollaboration.addCollaborator(o,e));for(var r=0,n=i.length;r<n;r++)ZWCollaboration.removeCollaborator(i[r])},PubSub.subscribe("Document/FirstTimeComponentReady",CollabPanelHandler.handleComponentReady);var FontLibrary=function(){var e=function(e,t){var i=t.fontName,o=FontCombo.getFontList();if(o.indexOf(i.toLowerCase())==-1){var r=t.fontAction;"add"==r?(FontCombo.addFont(i),editor.addFonts([i])):"remove"==r&&FontCombo.removeFont(lowerCasedName)}},t=function(){ZFontLibrary.open({previewText:"The quick brown fox jumps over a lazy dog"}),J("body").off("zfontlibraryupdate",e).on("zfontlibraryupdate",e)};return{openFontLibraryDlg:t}}();DocRoll.insertDRDlg=function(){J.dialogutil.open("drdialog",J("#share_btn_docroll"),DocRoll.info)},DocRoll.info={set:function(e,t,i){},get:function(e,t){if("SHOWSCRIPT"==e)return DocRoll.showDocrollScript(editor.zuid)}},DocRoll.showDocrollScript=function(e){var t='<script language="javascript" type="text/javascript" ';return t+='src="',t+=editor.getBaseURL(),t+="/docroll/",t+=e,t+='/10">',t+="</script>"},function(){var e=!1,t="",i="docx",o=[],r="",n=function(){var e=function(){Utils.addToStatistics("Fm_emlOut"),J.dialogutil.open("emailout",void 0,a)};UIUtils.showRedactWarningMsg(e)},a={get:function(n,a){if("formattype"==n)return J("#editorpane img.zw-image").length>0&&"html-inline"===i&&this.set({action:"formattype"},"zip"),this.checkEmailContentDisable(i),i||"docx";if("checkbox"==n)e=!1;else{if("subject"==n)return t;if("mailContent"==n)return r;if("senderemail"==n)return o.toString()}},set:function(n,a,l){"senderemail"==n.action?o=a:"formattype"==n.action?(this.checkEmailContentDisable(a),i=a):"subject"==n.action?t=a:"mailContent"==n.action?r=a:"checkbox"==n.action&&(e=a)},init:function(e){var t=J("#senderemailid input");t.on("focus.writer",l),t.trigger("click")},checkEmailContentDisable:function(e){var t=J("#emailoutzdialog .ui-email-doc-content");"html-inline"===e?t.prop("disabled",!0).addClass("ui-opacity"):t.prop("disabled",!1).removeClass("ui-opacity")}},l=function(){var e=J("#senderemailid input"),t=Contacts.getContacts({callback:s});s(t),e.off("focus.writer")},s=function(e){var t=J("#senderemailid");t.zautosuggest("option","imageURL",window.contactServer),t.zautosuggest("setSource",e)},d=function(e,t,i){var o=J("#submit-mail-doc");o.find("span").text(J.i18n("writer.common.SEND")),e.STATUS&&(Notification.show({container:"#maildoc-notify-container",message:"writer.common.DOCUMENT_SENT_SUCCESSFULLY",close:!1}),J("#senderemailid").trigger("click"),o.button("enable"))},c=function(e,t,i){var o,r=e?e.responseJSON.ERRORCODE:500;switch(r){case 101:o="CheckOrgPolicy";break;case 102:o="EMAIL_BY_UNCONFIRMED_USER";break;case 103:o="CheckOrgPolicy";break;default:o="EMAIL_FAIL",J("#submit-mail-doc").button("enable")}Notification.show({container:"#maildoc-notify-container",message:"writer.common."+o,close:!1,type:"error"}),J("#submit-mail-doc").find("span").text(J.i18n("writer.common.SEND"))},p=function(){if(!o.length)return Notification.show({container:"#maildoc-notify-container",message:"writer.common.ENTER_VALID_EMAIL_ADDRESS",close:!1,type:"warning"}),void J("#senderemailid").trigger("click");var n={},a=editor.doc.getDocInfo(),l=J("#submit-mail-doc"),s=i.split("-"),p=Utils.getContextUrl("v1/web/"+a.RID+"/sendmail/");l.button("disable"),l.find("span").text(J.i18n("writer.common.SENDING")),n.sid=editor.uuid,n.mailToMe=e,n.subject=t,n.emailId=o.toString(),s[1]?p+="inline":(p+="attachment/"+s[0],n.mailContent=r.replace(/(\r\n|\n|\r)/gm,"<br/>").replace(/ /g,"&nbsp;")),"pdf"===s[0]&&(n.timeZone=moment().zone()),Utils.setCsrfParam(n),J.ajax({url:p,data:n,type:"POST",dataType:"json",success:d,error:c})},u=function(){o=[],t=null,r=null,e=!1,i="docx"},f=function(){u(),J("#senderemailid").zautosuggest("refresh"),J.dialogutil.refreshValues(null,"emailout",!1,void 0)};window.EmailDocument={apply:p,resetDialog:f,showEmailOutDlg:n}}();var Template=function(){"use strict";var e,t,i=window.location.protocol+"//"+editor.docsServerURL,o=["MY_TEMPLATES","RESUMES","LETTERS_AND_COVERS","BUSINESS","MEETING_AND_AGENDA","POSTERS_AND_INVITATIONS","LABELS_AND_ENVELOPE","SEASONAL","CREATIVE_WRITING","EDUCATION","PERSONAL_USE"],r=window.location.protocol+"//"+document.domain+"/writer/signup",n={CATEGORY_MENU_CONT:"#template-categories-container",CATEGORY_VIEW_CONT:"#category-view-container",PREVIEW_CONTAINER:"#document-preview-container",HOME_VIEW_CONTAINER:"#home-views-container",THUMBNAIL_VIEW_CONTAINER:"#thumbnails-view-container",THUMBNAIL_BOX:"#thumbnail-box",CATEGORY_CONTAINER:".ui-lp-right"},a=function(){return l.open(),Utils.addToStatistics("NewFromTemplate"),l.model?(l.reset(),void l.hideLoadingMsg()):void setTimeout(function(){l.initialize()},100)},l={model:void 0,initialize:function(){this.beforeRender(),this.fetchAndRenderView()},beforeRender:function(){this.showLoadingMsg(J.i18n("writer.common.LOADING"))},render:function(){var e=this.model;s.initialize(e),d.initialize(e),c.initialize(),p.initialize(),s.beforeRender&&s.beforeRender(),d.beforeRender&&d.beforeRender();for(var t=o.length,i=0;i<t;i++){var r=o[i],n=e[r];n&&(this.renderCategories(n),delete e[r])}for(var a=Object.keys(e),l=a.length,i=0;i<l;i++){var n=e[a[i]];n&&this.renderCategories(n)}s.afterRender&&s.afterRender(),d.afterRender&&d.afterRender()},renderCategories:function(e){if(0!=e.DOCUMENTS.length){var t=JSON.stringify(e);s.render(JSON.parse(t)),d.render(JSON.parse(t))}},afterRender:function(){this.hideLoadingMsg(),this.bindevents()},bindevents:function(){J(".ui-lp-right").off("scroll").on("scroll",function(){_whenScrolling()}),J("#template-scrolltop").on("click",function(){J(n.CATEGORY_CONTAINER).animate({scrollTop:"0px"},"slow"),setTimeout(function(){h()},1e3)}),J("#home-views-container,#document-preview-container").on("contextmenu",function(){return!1}),J("#template-close-btn").on("click",this.close),J("#home-views-container").on("keydown",function(e){27==(e.keycode||e.which)&&(l.close(),e.stopPropagation(),e.preventDefault())},!1),J("#document-preview-container").on("click",function(e){p.close()})},fetchAndRenderView:function(){var e={success:function(e){l.model=e.TEMPLATES,l.render(),l.afterRender()},error:function(e){}},t="template/list",i={limit:100,fromIndex:0};u(i,!0,t,e,null)},open:function(){J(n.HOME_VIEW_CONTAINER).show().animate({top:"0px"},function(){J(this).focus(),J(".ui-lp-right-title h3").css("position","fixed"),J(".ui-temp-close").css("position","fixed")})},close:function(){J(".ui-lp-right-title.fixed").addClass("absolute"),J(".ui-lp-right-title h3").css("position","relative"),J(".ui-temp-close").css("position","absolute"),J(n.HOME_VIEW_CONTAINER).animate({top:"-1200px"},function(){J(this).hide()})},showLoadingMsg:function(e){J("#template-loading-message").text(e||"").show(),J("#template-loading-container").show()},hideLoadingMsg:function(){J("#template-loading-message").hide(),J("#template-loading-container").hide()},reset:function(){d.showAllViews(),J(".ui-lp-right").scrollTop(0)}},s={views:[],beforeRender:function(){var e=this.render({CATEGORY_NAME:"all",CATEGORY_NAME_HTML:J.i18n("writer.common.ALL")});e.on("click",function(){d.showAllViews()})},initialize:function(){return this.el=J("#categories-menu-container"),this.template=Handlebars.compile(J("#template-menu-view").html()),this},render:function(e){var t=J(this.template(e));J(this.el).append(t),e.el=t;var i={};return i[e.CATEGORY_NAME]=e,this.views.push(i),t},deleteView:function(e){var t=this.getViewObj(e.CATEGORY_NAME),i=t.view;i.el.remove(),this.views.splice(t.index,1)},getViewObj:function(e){for(var t=0,i={},o=this.views.length,r=0;r<o;r++)if(this.views[r][e]){t=r;break}return i.index=t,i.view=this.views[t][e],i},afterRender:function(){J(".ui-lp-left").niceScroll({cursorborder:"",cursorcolor:"#33373a",boxzoom:!1})}},d={views:[],currentViewThumbnailCollection:[],isFilteredView:!1,previousTitle:"",currentViewIdx:0,initialize:function(e){return this.template=Handlebars.compile(J("#category-view").html()),this.el=J("#category-view-container"),this},render:function(e){var t=J(this.template(e));this.previousTitle==e.TITLE?t.find(".ui-lp-right-thumb-title").addClass("category-title-replicated"):this.previousTitle=e.TITLE,this.previousViewName=e.TITLE,e.iS_OWNED_DOCUMENTS&&t.addClass("ui-gray-bg"),c.el=t.find(n.THUMBNAIL_VIEW_CONTAINER);for(var i=e.DOCUMENTS,o=[],r=0;r<i.length;r++){var a=c.render(i[r]);o.push(a)}e.THUMBNAILVIEWS=o,this.el.append(t),e.el=t;var s={};s[e.CATEGORY_NAME]=e,this.views.push(s);var d=this.views.length;1==d&&l.hideLoadingMsg()},show:function(e){var t=this.getViewObj(e),i=t.view;this.currentViewIdx=t.index;var o=i.el;J(".ui-lp-right")[i.iS_OWNED_DOCUMENTS?"addClass":"removeClass"]("ui-gray-bg"),J(".category-view").hide(),o.show().find(".category-title-replicated").show(),J(".ui-dummy-container").removeClass("ui-dummy-ht").css("height","0px"),J(".ui-lp-right-title p").css("position","fixed"),J(".ui-lp-right").scrollTop(0),this.currentViewThumbnailCollection=i.THUMBNAILVIEWS,this.isFilteredView=!0},showAllViews:function(){this.currentViewIdx=-1,J("#category-view-container").find(".category-title-replicated").hide(),J(".ui-lp-right-title p").css("position","relative"),J(".category-view").show(),J(".ui-nav a").removeClass("ui-active"),J(".ui-lp-right").removeClass("ui-gray-bg"),J("#categories-menu-container li[cname='all']").find("a").addClass("ui-active"),this.currentViewThumbnailCollection=c.allViews,this.isFilteredView=!1,J(".ui-lp-right").scrollTop(0);var e=J(".ui-lp-right").height(),t=J(".ui-lp-right-thump-cont").height(),i=J(".ui-lp-right-top-nav").height(),o=e-(t+i);J(".ui-dummy-container").addClass("ui-dummy-ht").css("height",o)},afterRender:function(){this.showAllViews(),this.bindEvents()},bindEvents:function(){m(J(".ui-lp-right-title")),J("#categories-menu-container li[cname!='all']").on("click",function(e){J(".ui-nav a").removeClass("ui-active"),J(this).find("a").addClass("ui-active");var t=g(e);d.show(t)}),J(".document-preview-btn,.thumbnail-overlay-menus").on("click",function(e){var t=f(e),i=J(e.target);i.hasClass("delete-template-button")||i.parents("button.delete-template-button").length?c.deleteTemplate(t):i.hasClass("edit-template-button")||i.parents("button.edit-template-button").length?c.editTemplate(t):p.show(t),e.stopPropagation(),e.preventDefault()}),J(".document-usethis-btn").on("click",function(e){var t=f(e);c.duplicateTemplate(t),e.stopPropagation(),e.preventDefault()}),J(".ui-temp-preview-prev").on("click",function(e){p.previous(),e.stopPropagation(),e.preventDefault()}),J(".ui-temp-preview-next").on("click",function(e){p.next(),e.stopPropagation(),e.preventDefault()}),J(".thumbnail-img").error(function(){J(this).unbind("error");var e=J(this).hide().removeAttr("src"),t=e.parent(n.THUMBNAIL_BOX);t.find(".thumbnail-def-img").show()}).load(function(){var e=J(this).show(),t=e.parent(n.THUMBNAIL_BOX);t.find(".thumbnail-def-img").hide()}),J.ui.utils.initComponents(J("#home-views-container"))},deleteFromViewCollection:function(e){for(var t=this.getViewObj(e.CATEGORY_NAME_HTML),i=t.view,o=i.THUMBNAILVIEWS,r=0;r<o.length;r++){var n=o[r];n.RESOURCE_ID==e.RESOURCE_ID&&(o.splice(r,1),0==o.length&&(i.el.remove(),this.views.splice(t.index,1),s.deleteView(e),this.showAllViews(),this.setTitleForNextView()))}if(o.length){var a=this.getViewObj(e.CATEGORY_NAME_HTML).view;a.THUMBNAILVIEWS=o}},getViewObj:function(e){for(var t=0,i={},o=this.views.length,r=0;r<o;r++){var n=this.views[r];if(n[e]){t=r;break}}return i.index=t,i.view=this.views[t][e],i},getView:function(e){var t=this.views[e];return t[Object.keys(t)[0]]},setTitleForNextView:function(){var e=this.currentViewIdx+1,t=this.getView(e);t.el.next().find(".category-title").text(t.TITLE).removeClass("category-title-replicated").show()}},c={allViews:[],isSelectableState:!1,initialize:function(){return this.template=Handlebars.compile(J("#thumbnail-view").html()),this},render:function(e){var t=e.iS_OWNED_DOCUMENTS,i=e.RESOURCE_ID;e.THUMBNAILURL=this.constructThumbnailUrl(t,i);var o=J(this.template(e));this.bindRenameComponent(i,o,t),e.el=o;var r={};return this.allViews.push(r[i]=e),this.el.append(o),e},constructThumbnailUrl:function(e,t){var o="";return o=e?Utils.getNiceUrlPrefix("template/")+t+"/thumbnail":i+"/thumbnail/"+t+"?width=100&height=100"},bindRenameComponent:function(e,t,i){var o=t.find(".document-name-field"),r={fileId:e,displayLength:"138",saveToFolder:!1,canFavourite:!1,rename:i,fetchDataFromServer:!1};o.zfilefield(r)},getViewIndex:function(e){var t=-1,i=d.currentViewThumbnailCollection;return J.each(i,function(i,o){if(o.RESOURCE_ID==e)return void(t=i)}),t},getView:function(e){var t=d.currentViewThumbnailCollection[e];return t.index=e,t},getNextView:function(){var e=d.currentViewThumbnailCollection,t=p.currentViewIdx,i=t>=e.length-1?t:t+1;if(i==t)return null;var o=e[i];return o.index=i,o},getPreviousView:function(){var e=d.currentViewThumbnailCollection,t=p.currentViewIdx,i=t>0?t-1:t;if(i==t)return null;var o=e[i];return o.index=i,o},deleteTemplate:function(e){if(parseInt(editor.zuid)==-1)return void T();var t=editorProps.deployment.zohowriter,i={templateId:e,trash:function(){var e={success:function(e){var i=e.TRASHED_RID;return"FAILED"==e.SAVEAS||"-1"==i?void this.error():(c.deleteView(i),void MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_SUCCESS,t,J.i18n("writer.common.TEMPLATE.TRASH_SUCCESS"),null,null))},error:function(){MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_ERROR,t,J.i18n("writer.common.TEMPLATE.TRASH_FAILED"),null,null)}},i="template/"+this.templateId.toString()+"/trash";l.showLoadingMsg(),u({},!0,i,e,!0)}},o=i.trash.bind(i);MsgDialog.showMessage(CONST.MSG_TYPE_YESNO,CONST.SEVERITY_INFO,t,J.i18n("writer.common.TEMPLATE.TRASH_WARNING_MSG"),null,function(e){switch(e){case CONST.BUTTON_YES_CLICKED:o()}})},duplicateTemplate:function(e){var t=editor.getBaseURL()+"/template/"+e+"/copytemplate";E(t)},editTemplate:function(e){var t=editor.getBaseURL()+"/template/"+e;E(t)},deleteView:function(e){var t=this.getViewIndex(e),i=this.getView(t);J(i.el).remove(),this.allViews.splice(t,0),d.deleteFromViewCollection(i)}},p={currentView:void 0,currentViewIdx:0,initialize:function(){J(n.PREVIEW_CONTAINER).on("keydown",this.keyEventHandler),this.image=J("#preview-image-large"),this.image.load(this.load),J(".preview-close-btn").on("click",this.close)},keyEventHandler:function(e){var t=e.keyCode||e.which;27==t?p.close():39==t?p.next():37==t&&p.previous(),e.preventDefault(),e.stopPropagation()},show:function(e){var t=c.getViewIndex(e),i=c.getView(t);this.updateView(i),J(n.PREVIEW_CONTAINER).fadeIn(300,function(){J(this).focus()})},close:function(){J(n.PREVIEW_CONTAINER).fadeOut(300,function(){J(n.HOME_VIEW_CONTAINER).focus()})},next:function(){var e=c.getNextView();this.updateView(e)},previous:function(){var e=c.getPreviousView();this.updateView(e)},updateView:function(e){if(e){J(".preview-result-container").hide(),J("#default-preview-loader").show(),this.currentViewIdx=e.index,this.currentView=e,this.image.attr("src","").attr("src",e.THUMBNAILURL);var t=J("<textarea />");J("#preview-document-name-placeholder").text(t.html(e.DOCUMENT_NAME_HTML).text()),J("#preview-category-name").text(t.html(e.CATEGORY_NAME_HTML).text()),this.image.bind("error",this.error)}},error:function(){J("#default-preview-loader").hide(),J(this).unbind("error").attr("src",""),J("#preview-error-box").show()},load:function(){J("#default-preview-loader").hide(),J("#preview-image-box").show()}},u=function(e,t,i,o,r){e||(e={}),r&&setCsrfParam(e),J.ajax({type:"POST",data:e,async:t,global:!1,dataType:"json",url:Utils.getNiceUrlPrefix(i),error:function(e){l.hideLoadingMsg(),o.error(e)},success:function(e){l.hideLoadingMsg(),o.success(e)}})},f=function(e){for(var t=J(e.target),i=t.attr("rid"),o=0;!(i||(t=t.parent(),i=t.attr("rid"),i||o>=5));)o++;return i},g=function(e){for(var t=J(e.target),i=t.attr("cname"),o=0;!(i||(t=t.parent(),i=t.attr("cname"),i||o>=5));)o++;return i},m=function(t){"object"==typeof t&&t instanceof jQuery&&t.length>0&&(e=t.each(function(){var e=J(this).wrap('<div class="followWrap" />');e.data("originalPosition",e.offset().top).data("originalHeight",e.outerHeight()).parent().height(e.outerHeight())}))},h=function(){J("#template-scrolltop").css({opacity:"0",bottom:"-40px"})},T=function(){var e=screen.width/2-400,t=screen.height/2-250;Utils.safeWindowOpen(decodeURI(r),{height:415,width:800,top:t,left:e},"_blank")},E=function(e){if(parseInt(editor.zuid)==-1)return void T();l.showLoadingMsg(J.i18n("writer.common.LOADING_TEMPLATE"));var t=editor.doc.getDocInfo(),i=editor.doc.getRole(),o=void 0;!t||1==t.VERSION&&0==t.REVISION&&t.newDoc||i==USER_ROLE.TEMPLATE_USER||i==USER_ROLE.REMOTE_PUBLIC_USER?o="_self":(l.close(),l.hideLoadingMsg()),Utils.safeWindowOpen(decodeURI(e),{},o)},R={init:function(e){J("#savingButton").hide(),setTimeout(function(){e.find("input:first").select().focus()},1)},get:function(e){if(J("#savingButton").button({icons:{primary:"ui-icon-loader-small-1"}}).addClass("ui-state-disabled"),"templateSave"==e)return editor.doc.getDocInfo().DOCUMENT_NAME},set:function(e,t,i){if("templateSave"==e.action){UIUtils.enterKey(J("input#templateName"),Template.saveAsTemplate)}}},S=function(){"TEMPLATE_USER"===editor.doc.getRole()&&(J("#banner-div").show(),J("#banner-template-cont").show(),J("#template-startwith-container").show())},O=function(){J.dialogutil.open("templatedialog",J("#expTemp"),R)},v=function(){var e=J("#templateDialog").zvalidation("validateAllFields",J("#templateDialog"));if(e){var i=Utils.removeUnWantedUnicodes(J("#templateName").val()),o=J("#okButton"),r=J("#savingButton");o.hide(),r.show();var n={};n.TEMP_NAME=i,editor.doc.getDocInfo().template_name&&(n.TEMP_NAME=editor.doc.getDocInfo().template_name),Utils.updateCaptchaInfo(n,t),csrfParamName&&(n[csrfParamName]=getcsrf()),J.ajax({type:"POST",dataType:"json",async:!0,data:n,url:Utils.getNiceUrlPrefix("template/"+editor.doc.getDocInfo().RID+"/new"),success:function(e){if("SUCCESS"==e.RESPONSE){J.dialogutil.close("templatedialog");var t=editor.getBaseURL()+"/open/"+e.rid;Utils.addToStatistics("saveAsTemplate"),Utils.safeWindowOpen(decodeURI(t),{},"_self")}else"FAILED"==e.RESPONSE&&(J.dialogutil.close("templatedialog"),UIUtils.showMessagePopup(J.i18n("writer.common.TEMPLATE.SAVEDFAILURE"),J.i18n("error","OOPS"),"error"))},error:function(e){if(500===e.status){var i=jQuery.parseJSON(J.trim(e.responseText));i&&i.errorCode&&"I5003"===i.errorCode?(r.hide(),o.show(),t=i.parameterName,Utils.handleCaptcha(t)):UIUtils.showMessagePopup(J.i18n("writer.common.TEMPLATE.SAVEDFAILURE"),J.i18n("error","OOPS"),"error")}else J.dialogutil.close("templatedialog"),UIUtils.showMessagePopup(J.i18n("writer.common.TEMPLATE.SAVEDFAILURE"),J.i18n("error","OOPS"),"error")}})}},b=function(){l.showLoadingMsg(J.i18n("writer.common.LOADING_TEMPLATE")),c.duplicateTemplate(editor.doc.getDocInfo().RID)};return PubSub.subscribe("Document/FirstTimeComponentReady",S),{loadTemplates:a,saveAsTemplate:v,openSaveAsTemplatePopup:O,useThisTemplate:b}}();!function(){var e=0,t=["MSG1","MSG2","MSG3","MSG4"],i=["Report a Problem","Suggestions","Appreciation","Help"],o={attachment:!0,minHeight:408,maxHeight:409,screengrabber:!1,formType:"feedback",sendTo:editorProps.urls.supportURL,keys:{"thankyou.label":J.i18n("writer.survey.THANKS")},submitURL:Utils.getContextUrl("fcomponents/sendfeedback.do")},r=U.once(function(){Jbody.on("zfeedbackopen",n),Jbody.on("zfeedbacksending",l),Jbody.on("zfeedbackbeforesend",a)}),n=function(){var e=J("#ui-zfeedback-dialog"),t=Handlebars.compile(J("#feedback-template").html());e.find("#ui-zfb-form").prepend(t()),e.find(".ui-dialog-title").text(J.i18n("writer.common.FEEBACK_DIALOG_TITLE")),e.find("#feedbackTab").ztab(),e.find("#feedbackTab").bind("tabselect",s),d()},a=function(t,o){return o.mailSubject=i[e]+": "+o.mailSubject,o},l=function(){var t={},o={},r=editor.doc.getDocInfo();o.ZUID=editor.zuid,o.ZOID=editor.zoid,o.Language=editor.lang,o.UserRole=editor.doc.getRole(),o.CurrentDocumentRID=r.RID,o.Reason=i[e],o.CurrentDocumentVersion=r.VERSION+"."+r.REVISION,o.deploymentDetail=editorProps.deployment.customername+" : "+editorProps.deployment.domain,t[FComponents.option("csrfParamName")]=FCUtil.getCSRFToken(),ZFeedback.option("customData",t),ZFeedback.option("customHeaders",o)},s=function(t,i){e=i.index,d()},d=function(){J("#zfb-input-subject").focus(),J("#zfb-input-message").attr({placeholder:c()})},c=function(){return J.i18n("writer.feedback."+t[e])},p=function(){e=0,r(),ZFeedback.open(o),Utils.addToStatistics("Feedback")};window.Feedback={showFeedbackDlg:p}}(),function(){var e={init:function(e){setTimeout(function(){e.find("input:first").select().focus()},1)},set:function(e,t,i){if("marknewversion"==e.action){var o=function(){FileMenu.markNewVersion()};UIUtils.enterKey(J("#marknewversion_input"),o)}}},t={get:function(e){if("rename"==e||"DOCUMENT_NAME"==e)return editor.doc.getDocInfo().DOCUMENT_NAME;if("DOC_OWNER_NAME"===e){var t=editor.doc.getDocInfo(),i=editor.zuid===t.CREATOR_ZUID?t.CREATOR+" ("+J.i18n("writer.common.YOU")+")":t.CREATOR;return i}if("VERSION"==e){var t=editor.doc.getDocInfo();return t.DOCS_VERSION}if("saveas"==e)return J.i18n("writer.common.COPYOF",[editor.doc.getDocInfo().DOCUMENT_NAME]);if("CREATED"==e){var t=editor.doc.getDocInfo(),o=t.CREATOR;return editor.zuid===t.CREATOR_ZUID&&(o+=" ("+J.i18n("writer.common.YOU")+")"),J("#dp_doccreated_by_name").text(o),moment(t.CREATED_DATE_LONG).calendar()}if("MODIFIED"==e){var t=editor.doc.getDocInfo(),r=t.LASTMODIFIEDBY;return editor.zuid===t.LASTMODIFIEDBY_ZUID&&(r+=" ("+J.i18n("writer.common.YOU")+")"),J("#dp_docmodified_by_name").text(r),moment(t.LAST_MODIFIED_TIME_LONG).calendar()}if("OPENED"==e)return moment(editor.doc.getDocInfo().LAST_CLOSED_TIME).calendar();if("PERMALINK"==e){var n=editor.scheme+"://"+editor.docsServerURL+"/file/"+editor.doc.getDocInfo().RID;return J("#dp_permalink").attr("href",n),n}if("PUBLISH"==e){var t=editor.doc.getDocInfo(),a=t.PUBLISH_SCOPE||0,l=["NOT_PUBLISHED_YET","DOCUMENTPUBLISHEDTOORG","DOCUMENTPUBLISHEDTOEXTERNALWORLD"];return 0!=a||t.CREATOR_ZUID!=editor.zuid&&"COOWNER"!=editor.doc.getRole()||J("#dp_doc_publish_link").show(),J.i18n("writer.common."+l[a])}return documentUtil.docInfo[e]},set:function(e,t,i){if("rename"==e.action){var o=function(){FileMenu.renameFile()};UIUtils.enterKey(J("#renamefilename"),o)}else if("saveas"==e.action){var o=function(){FileMenu.saveAsFile()};UIUtils.enterKey(J("#saveasfilename"),o)}},init:function(e){J.i18n("writer.common.AT");todayAtStr=J.i18n("writer.common.TODAYAT"),yesterdayAtStr=J.i18n("writer.common.YESTERDAYAT"),config={calendar:{sameDay:todayAtStr+" LT",lastDay:yesterdayAtStr+" LT",lastWeek:"LLL",sameElse:"LLL"}},locale=window.navigator.userLanguage||window.navigator.language,moment.locale(locale,config),setTimeout(function(){e.find("input:first").select().focus()},1)}};window.FileMenu={recentDocList:[],lastRecentDocListFetchTime:0,isGetDocListReqSent:!1,newFile:function(){Utils.addToStatistics("Fm_newFile"),window.open("https://"+editor.docsServerURL+"/writer/new")},saveFile:function(){Utils.addToStatistics("Fm_saveFile"),"REMOTE"==editor.getEditorType()?RemoteEditor.save():"STOREAGE_SERVICE_WRITER"===editor.doc.getRole()?(UIUtils.showLoadingMsg(J.i18n("writer.editor.SAVING")),WebUtil.saveStorageService()):WebUtil.saveDocumentCurrentVersions()},openSaveAsPopup:function(){var e={fileId:editor.doc.rid,fileName:J.i18n("writer.common.COPYOF",[editor.doc.getDocInfo().DOCUMENT_NAME]),dialogTitle:J.i18n("writer.common.MAKE_A_COPY"),allowDuplicateName:!0,onSuccess:function(e){MsgDialog.showMessage([J.i18n("writer.common.OPEN_NOW"),J.i18n("writer.common.LATER")],CONST.SEVERITY_SUCCESS,J.i18n("writer.common.HOORAY"),J.i18n("writer.common.COPY_OF_DOCUMENT_SUCCESS"),null,function(t){switch(t){case CONST.BUTTON_1_CLICKED:window.open(editor.getBaseURL()+"/open/"+e.fileId,"_blank")}})}},t='<div><input id="saveas-copycomments" type="checkbox" value="true"><label for="saveas-copycomments">'+J.i18n("writer.common.INCLUDE_COMMENTS")+'</label></div><div><input id="saveas-copytc" type="checkbox" value="true"><label for="saveas-copytc">'+J.i18n("writer.common.INCLUDE_TRACKED_CHANGES")+"</label></div>";"true"!==editor.makeACopyCustomOptions||"OWNER"!==editor.doc.getRole()&&"COOWNER"!==editor.doc.getRole()||(e.advancedOptionsInnerHTML=t,e.advancedOptionsLabel=J.i18n("writer.common.ADVANCED_OPTIONS"),e.postURL="/writer/v1/makeacopy"),ZSaveAs.open(e)},openMarkNewVersion:function(){Utils.addToStatistics("Fm_mkNewVer"),J.dialogutil.open("marknewversion",J("#filemenu-marknewversion"),e)},saveToFolderCallback:function(){},docProperties:function(){return Utils.addToStatistics("Fm_prp"),J.dialogutil.open("documentpropertiesdlg",void 0,t),!1},openDocs:function(){var e="https://"+editor.docsServerURL;!UIUtils.docsWindow||UIUtils.docsWindow.closed?UIUtils.docsWindow=window.open(e):UIUtils.docsWindow.focus()},openRecentDocumentsList:function(){var e=(new Date).getTime(),t=e-FileMenu.lastRecentDocListFetchTime;if(t<6e4)FileMenu.showRecentDocListMenu();else{if(FileMenu.isGetDocListReqSent)return;FileMenu.showRecentDocListLoading(),FileMenu.fetchRecentDocuments()}},beforeOpenMenu:function(){Utils.addToStatistics("File_Button"),"REMOTE"==editor.getEditorType()||editor.isOffline()||1==editor.doc.getDocInfo().CHECKEDOUT&&editor.zuid!=editor.doc.docInfo.CHECKEDOUTBY_ZUID&&J("#filemenu-saveas,#filemenu-saveastemplate,#filemenu-export,#filemenu-emailout,#filemenu-pagelayout,#filemenu-marknewversion,#filemenu-viewhistory,#printpreview").each(function(){J(this).disable()})},fetchRecentDocuments:function(){var e={};e.limit=10,e.fromIndex=0,e.sortBy="CREATED_TIME",e.nonNativeNeeded=!0,FileMenu.isGetDocListReqSent=!0,J.ajax({type:"POST",data:e,global:!1,dataType:"json",url:Utils.getContextUrl("v1/web/doclist"),error:function(e){FileMenu.showErrorMsg(e)},success:function(e){FileMenu.isGetDocListReqSent=!1,FileMenu.lastRecentDocListFetchTime=(new Date).getTime(),FileMenu.recentDocList=e.DOCUMENTS,FileMenu.showRecentDocListMenu()}})},showRecentDocListLoading:function(){var e=[],t=J("#recentDocument"),i={mtype:"custom",html:'<div class="ui-loading-cont ui-recent-doc-list-loading"><div>'+J.i18n("writer.common.LOADING")+'</div><div class="ui-loading-gif"> </div></div>'};return e.push(i),t.zmenu("removeAllMenuItems"),t.zmenu("addMenuItems",e),!0},showErrorMsg:function(e){FileMenu.isGetDocListReqSent=!1;var t=[],i=J("#recentDocument"),o=e?e.responseJSON.ERRORCODE:400;return 401==o?loadingMenuItem={mtype:"custom",html:'<div class="ui-loading-cont ui-recent-doc-list-loading"><div>'+J.i18n("writer.common.NO_RECENT_DOCUMENTS")+"</div></div>"}:loadingMenuItem={mtype:"custom",html:'<div class="ui-loading-cont ui-recent-doc-list-loading"><div>'+J.i18n("writer.common.UNABLE_TO_LOAD_RECENT_DOCUMENTS")+"</div></div>"},t.push(loadingMenuItem),i.zmenu("removeAllMenuItems"),i.zmenu("addMenuItems",t),!0},showRecentDocListMenu:function(){var e,t=[],o=!1,r=J("#recentDocument");for(i=0;i<FileMenu.recentDocList.length;i++){var n={},a="ui-button-icon-primary ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ";e=FileMenu.recentDocList[i],o=editor.zuid===e.OWNER_ZUID,a+=o?"ui-icon-download-docx-sm":"ui-icon-download-pdf-sm",n.label=e.DOCUMENT_NAME,n.data="{ icon: '"+a+"', appData : { action: 'FileOpen.loadContent', params:'"+e.RESOURCE_ID+"' } }",n.width="50px",t.push(n)}r.zmenu("removeAllMenuItems"),r.zmenu("addMenuItems",t)},markNewVersion:function(){var e=J("#marknewversion_ui").zvalidation("validateAllFields",J("#marknewversion_ui"));if(e){var t=HistoryUI.addVersionDescription(J("#marknewversion_input").val());t.done(function(){UIUtils.showMessage("info",J.i18n("common","CREATE_VERSION"),"showclose","normalfont",5e3)}),t.fail(function(){UIUtils.showMessage("error",J.i18n("common","UNABLE_TO_CREATE_VERSION"),"","normalfont",5e3);}),J.dialogutil.close("marknewversion")}},openPublishDialog:function(){J.dialogutil.close("documentpropertiesdlg"),Publish.openDialog()},beforeOpenFileMenu:function(){var e=editor.doc.getDocInfo();U.isEmpty(CollabListHandler.userStatus)&&Utils.getSharedUserStatus();var t=CollabListHandler.userStatus[e.CREATOR_ZUID],i=t.WMSSTATUS,o=J(".ui-badge");"1"==i?o.removeClass("ui-doc-user-offline"):o.addClass("ui-doc-user-offline")}}}(),function(){function e(){var e="_blank";return 1==editor.doc.getDocInfo().VERSION&&0==editor.doc.getDocInfo().REVISION&&editor.doc.getDocInfo().newDoc&&(e="_self"),e}window.FileOpen={fileOpenDialog:function(){editor.isOffline()?ZWOffline.offlineFileOpen():"REMOTE"!=editor.getEditorType()&&(Utils.addToStatistics("Fm_FileOpen"),FILEDIALOG.showOpenFileDialog("zw",e(),editor.orgPolicyData.create,!0))},closeFileOpenDialog:function(){J.dialogutil.close("fileopenDialog")},openWriterDocument:function(e,t){if("templates"==e||"shared"==e)FileOpen.openDocument(t);else if("userdocument"==e){var i={};Utils.setCsrfParam(i),J.ajax({type:"POST",global:!1,url:Utils.getNiceUrlPrefix(editor.doc.getDocInfo().RID+"/util/doctype"),async:!1,data:i,dataType:"json",error:function(e,i,o){FileOpen.openDocument(t)},success:function(e){"SUCCESS"==e.STATUS?"WRITER2"==e.VERSION?FileOpen.openDocument(t):"WRITER3"==e.VERSION&&FileOpen.loadContent(t):FileOpen.openDocument(t)}})}},openDocument:function(t){var i,o=e();t=t||editor.doc.getDocInfo().RID,i=editor.getBaseURL()+"/open/"+t,window.open(i,o)},loadContent:function(e){if(1==editor.doc.getDocInfo().VERSION&&0==editor.doc.getDocInfo().REVISION&&editor.doc.getDocInfo().newDoc){UIUtils.showLoadingMsg(J.i18n("writer.common.LOADING"));var t=function(){var i=Utils.getContextUrl("open/"+e);window.history.pushState(null,null,i),UIUtils.handleFirstCharSave(),PubSub.unsubscribe("Document/LoadingStart",t)};PubSub.subscribe("Document/LoadingStart",t),editor.fetchDocument(e,"")}else FileOpen.openDocument(e)}}}();var ImagePanel=function(e){"use strict";var t={},i=!1,o={type:"solid",color:"zwdark1",width:"1px",space:"0px"},r=!1,n=ATTR_BORDERS.WIDTH,a=ATTR_BORDERS.COLOR,l=ATTR_BORDERS.TYPE,s={IMG_HEIGHT:"customheight",IMG_WIDTH:"customwidth",IMG_WRAP_TYPE:"img-wrap-type",IMAGE_CUSTOM_MARGIN:"img-custom-margin",BDR_STYLE:"img_borderstyle",BDR_WIDTH:"img_borderwidth",BDR_COLOR:"img_border_color",IMAGE_ROTATE_DEGREE:"img-pnl-rot-deg"},d={left:"writer.common.LEFT",front:"writer.image.INFRONT_OF_TEXT",right:"writer.common.RIGHT",bottom:"writer.image.INLINE",behind:"writer.image.BEHIND_TEXT",square:"writer.image.SQUARE"},c={ORIGINALSIZE:{get:function(e,i){return t.isOrgSize?"on":"off"},set:function(e,i,o){t.isOrgSize=!0;var r=t.naturalHeight,n=t.naturalWidth,a={};return a.ht=r,a.wid=n,a.htUnit="px",a.widUnit="px",Z(s.IMG_HEIGHT).zspinner("setUnit","px").zspinner("setValue",r).enable(),Z(s.IMG_WIDTH).zspinner("setUnit","px").zspinner("setValue",n).enable(),Z("keepaspect").enable(),a}},FITWIDTH:{get:function(e,i){return t.isFitWid?"on":"off"},set:function(e,i,o){t.isFitWid=!0;var r={};return r.ht=t.naturalHeight*ViewManager.getColumnWidth()/t.naturalWidth,r.wid=ViewManager.getColumnWidth(),Z(s.IMG_HEIGHT).zspinner("setUnit","px").zspinner("setValue",r.ht).disable(),Z(s.IMG_WIDTH).zspinner("setUnit","px").zspinner("setValue",r.wid).disable(),Z("keepaspect").disable(),r}},HEIGHT:{get:function(e,i){return t.ht},set:function(e,i,o){var r={};if(r.ht=i,r.htUnit="px",Z("keepaspect").prop("checked")){var n=i*t.naturalWidth/t.naturalHeight;Z(s.IMG_WIDTH).zspinner("setUnit","px").zspinner("setValue",n),r.wid=n}return r}},WIDTH:{get:function(e,i){return t.wid},set:function(e,i,o){var r={};if(r.wid=i,r.widUnit="px",Z("keepaspect").prop("checked")){var n=i*t.naturalHeight/t.naturalWidth;Z(s.IMG_HEIGHT).zspinner("setUnit","px").zspinner("setValue",n),r.ht=n}return r}},OPACITY:{get:function(e,i){return parseInt(t.opacity)},set:function(e,t,i){var o={};return o.opacity=t,o}},IMAGE_BORDER_COLOR:{get:function(e,i){var o=!!t[ATTR_BORDERS.COLOR]&&t[ATTR_BORDERS.COLOR];return _(o,!0),o},set:function(e,i,o){r=!0,_(Utils.rgbToHex(i),!0),t[ATTR_BORDERS.COLOR]=Utils.getColorReference(arguments[4]);var n={};return n[ATTR_COMMON.BORDERS]=P(a,t[ATTR_BORDERS.COLOR]),n}},IMAGE_BORDER_WIDTH:{get:function(e,i){return!!t[ATTR_BORDERS.WIDTH]&&parseFloat(t[ATTR_BORDERS.WIDTH])},set:function(e,i,o){r=!0,t[ATTR_BORDERS.WIDTH]=i;var a={};return a[ATTR_COMMON.BORDERS]=P(n,parseFloat(i)+UNITS.PIXELS),a}},IMAGE_BORDER_TYPE:{get:function(e,i){return!!t[ATTR_BORDERS.TYPE]&&t[ATTR_BORDERS.TYPE]},set:function(e,i,o){r=!0,t[ATTR_BORDERS.TYPE]=i;var n={};return n[ATTR_COMMON.BORDERS]=P(l,i),n}},IMAGE_WRAP:{get:function(e,i){return Z(s.IMG_WRAP_TYPE).text(J.i18n(d[t.al])),t.al},set:function(e,t,i){var o={};return o.al=e.params,"bottom"==e.params?Z(s.IMAGE_CUSTOM_MARGIN).hide():Z(s.IMAGE_CUSTOM_MARGIN).show(),o}},MARGIN_TYPE:{get:function(e,i){var o=t.marginType;return t.isFloatImg?(i.enable(),"custom"==t.marginType?Z(s.IMAGE_CUSTOM_MARGIN).show():Z(s.IMAGE_CUSTOM_MARGIN).hide()):(i.disable(),Z(s.IMAGE_CUSTOM_MARGIN).hide()),ImagePanel.setMarginValues(i),o},set:function(e,t,i){var o={};if("custom"==t)return void Z(s.IMAGE_CUSTOM_MARGIN).show();var r=Conversions.toGlobalUnit(parseFloat(t)+"in");return r="mm"==Conversions.globalUnit?parseInt(r):r,r+=Conversions.globalUnit,o.marginTop=o.marginLeft=o.marginRight=o.marginBottom=r,Z(s.IMAGE_CUSTOM_MARGIN).hide(),o}},MARGIN_TOP:{get:function(e,i){return Conversions.toGlobalValue(t.marginTop)},set:function(e,t,i){var o={};return o.marginTop=t+Conversions.globalUnit,o}},MARGIN_BOTTOM:{get:function(e,i){return Conversions.toGlobalValue(t.marginBottom)},set:function(e,t,i){var o={};return o.marginBottom=t+Conversions.globalUnit,o}},MARGIN_LEFT:{get:function(e,i){return Conversions.toGlobalValue(t.marginLeft)},set:function(e,t,i){var o={};return o.marginLeft=t+Conversions.globalUnit,o}},MARGIN_RIGHT:{get:function(e,i){return Conversions.toGlobalValue(t.marginRight)},set:function(e,t,i){var o={};return o.marginRight=t+Conversions.globalUnit,o}},ROTATE_CW:{get:function(e,i){Z(s.IMAGE_ROTATE_DEGREE).html(t.rotation)},set:function(e,i,o){var r=t.rotation+90;r>360&&(r%=360);var n={};return n.rotation=r,n}},ROTATE_ACW:{get:function(e,i){Z(s.IMAGE_ROTATE_DEGREE).html(t.rotation)},set:function(e,i,o){var r=t.rotation-90;r<0&&(r=270);var n={};return n.rotation=r,n}},ALTTXT:{get:function(e,i){return t.altTxt},set:function(e,t,i){var o={};return o.altTxt=t,o}},TOOLTIPTXT:{get:function(e,i){return t.tooltipText},set:function(e,t,i){var o={};return o.tooltipText=t,o}}},p={beforeFillValues:function(){t={isOrgSize:!1,isFitWid:!1,ht:null,wid:null,opacity:null,width:!1,type:!1,color:!1,al:null,marginTop:null,marginLeft:null,marginRight:null,marginBottom:null,marginType:null,rotation:null,altTxt:null,tooltipText:null,borders:{},naturalHeight:null,naturalWidth:null,cropRect:null},t=u(t)},init:function(){C()},get:function(e,t){var i=c[e.action].get;if(i)return i(e,t)},set:function(e,i,o){arguments[5]&&arguments[5].keyCode==KEYS.TAB?EventHandler.isDialogFocused=!0:EventHandler.isDialogFocused=!1;var r=c[e.action].set,n=r&&r.apply(null,arguments);if(null!=n){for(var a in n)t[a]=n[a];f(n)}}},u=function(e){var t=editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart()),i=t.attr(),o=i[ATTR_COMMON.BORDERS];e[ATTR_COMMON.BORDERS]=o?o:{},BorderUtils.convertZWColorToRGB(e[ATTR_COMMON.BORDERS]);var r={};for(var n in e[ATTR_COMMON.BORDERS])"0px"!=e[ATTR_COMMON.BORDERS][n][ATTR_BORDERS.WIDTH]&&(r[n]=e[ATTR_COMMON.BORDERS][n]);var a=DocUtil.getDOMSourceIndex(editor.doc.getSelection().getStart(),UNICODE.IMAGE);DomUtil.getElementAt(NODE_TYPE.IMAGE,a,editor.clientActiveSection);e.isOrgSize=i.ht==i.orginalHt&&i.wid==i.orginalWid,e.isFitWid=i.wid==ViewManager.getColumnWidth(),e.ht=i.ht,e.wid=i.wid,e.opacity=i.op?i.op:"100",e.al=i.al?i.al:"bottom",e.marginTop=i.mt,e.marginLeft=i.ml,e.marginRight=i.mr,e.marginBottom=i.mb,e.marginType=ImagePanel.getMarginType(i),e.rotation=i.rotation?i.rotation:0,e.tooltipText=i.tooltip,e.altTxt=i.alt,e.naturalHeight=i.orginalHt,e.naturalWidth=i.orginalWid,e.isFloatImg=editor.isFloatingImage(i);var l=Utils.getOrginalHeighWidthOfImage(i);return i.cropRect&&(e.cropRect=Utils.convertCropDataToPixel(i.cropRect,l.ht,l.wid)),jQuery.isEmptyObject(e[ATTR_COMMON.BORDERS])||(e[ATTR_BORDERS.COLOR]=e[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_TOP][ATTR_BORDERS.COLOR],e[ATTR_BORDERS.WIDTH]=e[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_TOP][ATTR_BORDERS.WIDTH],e[ATTR_BORDERS.TYPE]=e[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_TOP][ATTR_BORDERS.TYPE]),e},f=function(e){var t=[],i=[],o={};for(var r in e)g[r](o,e[r]);var n=editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart());t.push(n),i.push(o),t&&i&&(editor.doc.execCmd("applyStyle",[t,i,"updateImageStyle"]),Resize.selectImg(),i[0].al&&v())},g={ht:function(e,t){e[ATTR_IMAGE.I_HT]=t},wid:function(e,t){e[ATTR_IMAGE.I_WID]=t},htUnit:function(e,t){e[ATTR_IMAGE.I_HT_UN]=t},widUnit:function(e,t){e[ATTR_IMAGE.I_WID_UN]=t},opacity:function(e,t){e[ATTR_IMAGE.I_OP]=t},marginTop:function(e,t){e[ATTR_IMAGE.I_MT]=t},marginLeft:function(e,t){e[ATTR_IMAGE.I_ML]=t},marginRight:function(e,t){e[ATTR_IMAGE.I_MR]=t},marginBottom:function(e,t){e[ATTR_IMAGE.I_MB]=t},rotation:function(e,t){e[ATTR_IMAGE.I_ROTATE]=t,Z(s.IMAGE_ROTATE_DEGREE).html(t)},altTxt:function(e,t){e[ATTR_IMAGE.I_ALT]=t},tooltipText:function(e,t){e[ATTR_IMAGE.I_TOOLTIP]=t},al:function(e,t){var i=editor.doc.getCursorPortionNode(editor.uuid,"start"),o=J(i).parents("div.zw-paragraph")[0],r=editor.doc.getDomCursorNode(editor.uuid,editor.zuid,"start");e[ATTR_IMAGE.I_AL]=t,"SQUARE"==t||"FRONT"==t||"BEHIND"==t?(e[ATTR_IMAGE.I_LEFT]=parseFloat(r.css("left")),e[ATTR_IMAGE.I_TOP]=PUtil.offsetTop(J(i).parents("div.zw-line-div")[0],o)):"ALIGNLEFT"!=t&&"ALIGNRIGHT"!=t||(e[ATTR_IMAGE.I_TOP]=PUtil.offsetTop(J(i).parents("div.zw-line-div")[0],o))},borders:function(e,t){e[ATTR_COMMON.BORDERS]=t}},m=function(){var e=editor.doc.getRole();"ANYONELINK_SHAREDREADCOMMENT"!=e&&"SHAREDREAD"!=e&&"SHAREDREADCOMMENT"!=e&&"REMOTEVIEW"!=e&&"REMOTECOLLABVIEW"!=e&&PubSub.subscribe("Document/CursorPositionChanged",h,{async:!0,timeout:100})},h=function(){var e="image"==editor.doc.getElementAt(editor.doc.getSelection().getStart()).type||!1,t=editor.doc.getSelection().getStart();if(e&&Resize.getIsProgress()){var i=editor.doc.getRawFormatAt(t),o=ImageUtils.getDomImage(t,i);o.getAttribute("class").indexOf("embedobj-play-icon")!=-1||o.getAttribute("class").indexOf("zw-ifr-div")!=-1?E():T()}else E()},T=function(){if(i){var e=editor.doc.getSelection();e.getStart()!=e._.LAST_RANGE.start&&ImagePanel.refreshValues()}else Z("menu-img-parent").show(),LayoutManager.isRichEditActive()&&ImagePanel.open();i=!0},E=function(){i&&(i=!1,Z("menu-img-parent").hide(),ImagePanel.close())},R=function(){LayoutManager.isRichEditActive()?LeftPanel.showSubPanel(e.IMAGEOPTIONSPANEL,ANIMATIONS.FADEIN):LayoutManager.toggleRichEdit("open",e.IMAGEOPTIONSPANEL),O()},S=function(){LeftPanel.closeDynamicPanel(e.IMAGEOPTIONSPANEL)},O=function(){v()},v=function(){var t=Z(e.IMAGEOPTIONSPANEL);t.data("ztrackObject")?t.ZCtrackObjects("refreshValues"):t.ZCtrackObjects({callbacks:ImagePanel.panelInfo,fillVisible:!1,eventNameMapping:{zspinner:"spinnerblur"}})},b=function(e){var t=J("#con-"+e);if(!J("#"+e).attr("disabled")){var i="none"==t.css("display")?"inline-block":"none";J("#con-bordersize-menu, #con-wrap-menu, #con-border-menu, #con-margin-menu").css("display","none"),t.css("display",i)}},A=function(){LeftPanel.findPanelObj(e.IMAGEOPTIONSPANEL)>=0?ImagePanel.close():ImagePanel.open()},y=function(e){var t=parseFloat(e[ATTR_IMAGE.I_ML]),i=parseFloat(e[ATTR_IMAGE.I_MR]),o=parseFloat(e[ATTR_IMAGE.I_MT]),r=parseFloat(e[ATTR_IMAGE.I_MB]);return t!=i||o!=r||o!=i?"custom":t==1/8||.25==t||t==3/8||.5==t||0==t?t:3!=t&&6!=t&&9!=t&&12!=t||"mm"!=Conversions.globalUnit?"custom":3==t?1/8:6==t?.25:9==t?3/8:12==t?.5:void 0},D=function(e){var t=["1/8","1/4","3/8","1/2"],i=["3","6","9","12"];"mm"==Conversions.globalUnit?(e.zcombo("updateLabel","0.125",i[0]+Conversions.showUnit+" "+J.i18n("writer.image.MARGIN")),e.zcombo("updateLabel","0.250",i[1]+Conversions.showUnit+" "+J.i18n("writer.image.MARGIN")),e.zcombo("updateLabel","0.375",i[2]+Conversions.showUnit+" "+J.i18n("writer.image.MARGIN")),e.zcombo("updateLabel","0.500",i[3]+Conversions.showUnit+" "+J.i18n("writer.image.MARGIN"))):(e.zcombo("updateLabel","0.125",t[0]+Conversions.showUnit+" "+J.i18n("writer.image.MARGIN")),e.zcombo("updateLabel","0.250",t[1]+Conversions.showUnit+" "+J.i18n("writer.image.MARGIN")),e.zcombo("updateLabel","0.375",t[2]+Conversions.showUnit+" "+J.i18n("writer.image.MARGIN")),e.zcombo("updateLabel","0.500",t[3]+Conversions.showUnit+" "+J.i18n("writer.image.MARGIN")))},C=function(){var e=editor.doc.getPaperWidth(!0)/Conversions.globalUnitInPx*.4,t=Conversions.step;e-=e%t;var i=0,o=J("#img-margin-right, #img-margin-left, #img-margin-bottom, #img-margin-top");ImagePanel.setMinMaxValue(o,i,e,t)},I=function(e,t,i,o){e.zspinner("setMinValue",t).zspinner("setMaxValue",i).zspinner("setStepValue",o).zspinner("setUnit",Conversions.showUnit)},P=function(e,i){for(var r=(editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart()),t[ATTR_COMMON.BORDERS]?DocUtil.copyStyle(t[ATTR_COMMON.BORDERS]):{}),n=[ATTR_BORDERS.BORDER_TOP,ATTR_BORDERS.BORDER_LEFT,ATTR_BORDERS.BORDER_RIGHT,ATTR_BORDERS.BORDER_BOTTOM],a=!1,l=0,d=n.length;l<d;l++){var c=n[l];if(r&&r[c])r[c][e]=i;else{var p=DocUtil.copyStyle(o);p[e]=i,r[c]=p,a=!0}e==ATTR_BORDERS.TYPE&&"double"==i&&parseInt(r[c][ATTR_BORDERS.WIDTH])<3&&(r[c][ATTR_BORDERS.WIDTH]="3px")}return a&&(Z(s.BDR_WIDTH).zcombo("setValue",parseInt(r[ATTR_BORDERS.BORDER_TOP][ATTR_BORDERS.WIDTH])),Z(s.BDR_STYLE).zcombo("setValue",r[ATTR_BORDERS.BORDER_TOP][ATTR_BORDERS.TYPE]),Z(s.BDR_COLOR).zcolorfield("setColor",Utils.getColorValFromRefString(r[ATTR_BORDERS.BORDER_TOP][ATTR_BORDERS.COLOR]))),r},_=function(e,t){var i=Z("combo_img_borderwidthMenu").find(".ui-borderstylebg");if(i=i.add(Z("combo_img_borderstyleMenu").find(".ui-borderstylebg")),i=i.add(Z(s.BDR_STYLE).next().find(".ui-borderstylebg")),i.css({"border-top-color":e}),t);},N=function(e,t){var i={};if("bottom"==e||"square"==e||"left"==e||"right"==e||"front"==e||"behind"==e)i.al=e;else if("margin"==e){var o=Conversions.toGlobalUnit(parseFloat(t)+"in");o="mm"==Conversions.globalUnit?parseInt(o):o,o+=Conversions.globalUnit,i.marginTop=i.marginLeft=i.marginRight=i.marginBottom=o}f(i)};return PubSub.subscribe("Document/FirstTimeComponentReady",m),{refreshValues:v,open:R,close:S,panelInfo:p,handleImagePropWrapper:A,toggleShow:b,toggleImageOptions:h,panelData:t,getMarginType:y,setMarginValues:D,setMinMaxValue:I,applyStyleInContextMenu:N}}(ELEM_ID),DropcapPanel=function(e){"use strict";var t={},i=!1,o={beforeFillValues:function(){t={POSITION:null,LINES_TO_DROP:null,FILL_COLOR:null,STROKE_COLOR:null,FONTFAMILY:null,FONTSIZE:null,BOLD:!1,ITALIC:null,UNDERLINE:null,SRIKETHROUGH:null,MARGIN_RIGHT:null,MARGIN_BOTTOM:null},t=c(t),f()},get:function(e,t){var i=s[e.action].get;if(i)return i(e,t)},set:function(e,i,o){arguments[5]&&arguments[5].keyCode==KEYS.TAB?EventHandler.isDialogFocused=!0:EventHandler.isDialogFocused=!1;var r=s[e.action].set,n=r&&r(e,i,o);if(null!=n){for(var a in n)t[a]=n[a];p(n)}}},r=function(){d()},n=function(){},a=function(){if(!LeftPanel.isPanelVisible(e.DROPCAPPANEL)){var t=ANIMATIONS.FLIPIN;LeftPanel.isPanelVisible(e.SHAPESPANEL)&&(InsertShape.closeShapeToolbar(),t=ANIMATIONS.FADEIN),LeftPanel.showSubPanel(e.DROPCAPPANEL,t)}r()},l=function(){LeftPanel.closeDynamicPanel(e.DROPCAPPANEL),n()},s={POSITION:{get:function(e,i){if(t.POSITION==e.params)return Z("dropcap-pos-lbl").text(J(i).value),!0},set:function(e,t,i){var o={};return o.POSITION={value:t,params:e.params},o}},LINES_TO_DROP:{get:function(e,i){return t.LINES_TO_DROP},set:function(e,t,i){var o={};return o.LINES_TO_DROP={value:t},o}},FILL_COLOR:{get:function(e,i){Z("dropcap-fillcolor").css({background:t.FILL_COLOR})}},STROKE_COLOR:{get:function(e,i){Z("dropcap-strokecolor").css({background:t.STROKE_COLOR})}},FONTFAMILY:{get:function(e,i){return Toolbar.updateFontFamily(t.FONTFAMILY,Z("dropcap-fontfamily")),!1},set:function(e,t,i){var o={};return o.FONTFAMILY={value:t},o}},FONTSIZE:{get:function(e,i){return Toolbar.updateFontSize(parseInt(t.FONTSIZE),Z("dropcap-fontsize")),!1},set:function(e,t,i){var o={};return o.FONTSIZE={value:t},o}},BOLD:{get:function(e,i){return J("#dropcapPortionstyles").zbutton(t.BOLD?"check":"uncheck","#dc-bold"),t.BOLD},set:function(e,t,i){var o={};return o.BOLD={value:t},o}},ITALIC:{get:function(e,i){return J("#dropcapPortionstyles").zbutton(t.ITALIC?"check":"uncheck","#dc-italic"),t.ITALIC},set:function(e,t,i){var o={};return o.ITALIC={value:t},o}},UNDERLINE:{get:function(e,i){return J("#dropcapPortionstyles").zbutton(t.UNDERLINE?"check":"uncheck","#dc-underline"),t.UNDERLINE},set:function(e,t,i){var o={};return o.UNDERLINE={value:t},o}},SRIKETHROUGH:{get:function(e,i){return J("#dropcapPortionstyles").zbutton(t.SRIKETHROUGH?"check":"uncheck","#dc-strikethrough"),t.SRIKETHROUGH},set:function(e,t,i){var o={};return o.SRIKETHROUGH={value:t},o}},MARGIN_RIGHT:{get:function(e,i){return t.MARGIN_RIGHT},set:function(e,t,i){var o={};return o.MARGIN_RIGHT={value:t},o}},MARGIN_BOTTOM:{get:function(e,i){return t.MARGIN_BOTTOM},set:function(e,t,i){var o={};return o.MARGIN_BOTTOM={value:t},o}}},d=function(){var t=Z(e.DROPCAPPANEL);i?LeftPanel.isPanelVisible(e.DROPCAPPANEL)&&t.ZCtrackObjects("refreshValues"):(i=!0,t.ZCtrackObjects({callbacks:o,fillVisible:!1,eventNameMapping:{zspinner:"spinnerblur",zfontcombo:"combochange"}}))},c=function(e){var t=InsertShape.selectedShape().data,i=t.dropcapData;if(!i)return{length:0};var o="shadow0",r="preset0";t.props.effects&&(t.props.effects.reflection&&(r=t.props.effects.reflection.preset&&t.props.effects.reflection.preset.toLowerCase()),t.props.effects.shadow&&(o=t.props.effects.shadow.distance&&"shadow"+t.props.effects.shadow.distance.angle)),e.POSITION=i.type,e.LINES_TO_DROP=i.linestodrop,"SOLID"==t.props.fill.type?e.FILL_COLOR="rgb("+t.props.fill.solid.color.rgb.toString()+")":e.FILL_COLOR="transparent","SOLID"==t.props.stroke.fill.type?e.STROKE_COLOR="rgb("+t.props.stroke.fill.solid.color.rgb.toString()+")":e.STROKE_COLOR="transparent";var n=t.textBody.paras[0].portions[0].props;return e.FONTFAMILY=n.font.fontFamily.name,e.FONTSIZE=n.size,e.BOLD=!!n.bold,e.ITALIC=!!n.italic,e.UNDERLINE="SINGLE"==n.underline,e.SRIKETHROUGH="SINGLE"==n.strike,e.MARGIN_RIGHT=t[ATTR_IMAGE.I_MR]||0,e.MARGIN_BOTTOM=t[ATTR_IMAGE.I_MB]||0,e.SHADOW=o,e.REFLECTION=r,e},p=function(e){for(key in e){var t=u[key];t&&t(e[key])}},u={POSITION:function(e){InsertShape.modifyDropcapProperty("POSITION",e.params)},LINES_TO_DROP:function(e){InsertShape.modifyDropcapProperty("LINESTODROP",e.value)},BOLD:function(e){InsertShape.processTxtFormat(["bold"])},ITALIC:function(e){InsertShape.processTxtFormat(["italic"])},UNDERLINE:function(e){InsertShape.processTxtFormat(["underline"])},SRIKETHROUGH:function(e){InsertShape.processTxtFormat(["strikethrough"])},MARGIN_RIGHT:function(e){InsertShape.modifyDropcapProperty("DISTANCEFROMRIGHT",e.value+"in")},MARGIN_BOTTOM:function(e){InsertShape.modifyDropcapProperty("DISTANCEFROMBOTTOM",e.value+"in")},FONTFAMILY:function(e){var t=Z("dropcap-fontfamily").find("option:selected").text();FontCombo.updateRecentFonts({name:t,value:e.value}),InsertShape.processTxtFormat(["fontname",e.value])},FONTSIZE:function(e){InsertShape.processTxtFormat(["fontsize",e.value])}},f=function(){Z("shadowpresetmenu").zmenu("check",t.SHADOW),Z("reflectionpresetmenu").zmenu("check",t.REFLECTION)};return{refreshValues:d,open:a,close:l}}(ELEM_ID);Imagelibrary.prototype={replaceImageAction:!1,openInsertImgDlg:function(){var e={insertFrom:"local",noOfImagesToBeSelected:IMAGELIBRARY_MAXCOUNT_TOBEUPLOAD,gadgetsURL:"//"+editorProps.urls.gadgetServerURL},t=editorProps.deployment.customername;if("REMOTE"==editor.getEditorType()||"ANYONEWITHLINK"===editor.getEditorType()||"facebook"===t)if(0!=Object.keys(Imagelibrary.getAppData()).length)e=J.extend({},e,Imagelibrary.getAppData());else{e.uploadURL=Utils.getUrl("uploadImageFile"),e.enableGadgets=!1;var i={docId:editor.doc.getDocInfo().DOCUMENT_ID};Utils.setCsrfParam(i),e.customData=i}"baihui"!==t&&"fuji"!==t&&"CRM_VERTICAL_MAILMERGE_LIBRARY"!==editor.doc.getRole()||(e.enableGadgets=!1),FCImageLibrary.open(e),J("#imagelibrary").on("imageinsert",function(e,t){var i=editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart());i&&Resize.getTargetImg()&&!InsertShape.selectedShape()&&(Imagelibrary.replaceImageAction=!0),Imagelibrary.newattr={};var o={},r=[],n=[];if(r=t.info,r[0].hasOwnProperty("RESOURCE_ID")){for(var a=0,l=r.length;a<l;a++){var s={};s.IMAGE_EXTENSION=r[a].IMAGE_EXTENSION,s.RESOURCE_ID=r[a].RESOURCE_ID,n.push(s)}o.fcimagesinfo=JSON.stringify(n),o.rid=editor.doc.getDocInfo().RID,Utils.setCsrfParam(o),J.ajax({type:"POST",global:!1,url:Utils.getUrl("fcompImageUpload"),data:o,async:!0,error:function(){UIUtils.showMessage("error",J.i18n("writer.common.UNABLE_TO_INSERT_IMAGE"),"showclose","normalfont",3e3)},success:function(e){if("SUCCESS"===e.STATUS){var t=[];t=e.IMAGELIST;for(var i=0,o=t.length;i<o;i++){var r=t[i];if(Imagelibrary.replaceImageAction)Imagelibrary.replaceImage(r.IMAGE_URL);else{var n=Imagelibrary.checkImgWidHeight(r.IMAGE_WIDTH,r.IMAGE_HEIGHT);Imagelibrary.newattr[ATTR_IMAGE.I_HT]=n.IMAGE_HEIGHT,Imagelibrary.newattr[ATTR_IMAGE.I_WID]=n.IMAGE_WIDTH,Imagelibrary.newattr[ATTR_IMAGE.I_ORGINALHT]=n.IMAGE_HEIGHT,Imagelibrary.newattr[ATTR_IMAGE.I_ORGINALWID]=n.IMAGE_WIDTH,Imagelibrary.newattr[ATTR_IMAGE.I_SRC]=r.IMAGE_URL,InsertShape.selectedShape()?InsertShape.changeShapeProperty(["fillimage",[r.IMAGE_URL,n.IMAGE_WIDTH,n.IMAGE_HEIGHT]]):editor.doc.execCmd("insimg",Imagelibrary.newattr)}}}else"FAILED"===e.STATUS&&UIUtils.showMessage("error",J.i18n("writer.common.UNABLE_TO_INSERT_IMAGE"),"showclose","normalfont",3e3)}})}else if(r[0].hasOwnProperty("IMAGE_URL"))Imagelibrary.insertWebImage(r);else if(r[0].hasOwnProperty("uploadedFileUrl"))if(Imagelibrary.replaceImageAction)Imagelibrary.replaceImage(r[0].uploadedFileUrl);else{var d=Imagelibrary.checkImgWidHeight(r[0].IMAGE_WIDTH,r[0].IMAGE_HEIGHT);Imagelibrary.newattr[ATTR_IMAGE.I_HT]=d.IMAGE_HEIGHT,Imagelibrary.newattr[ATTR_IMAGE.I_WID]=d.IMAGE_WIDTH,Imagelibrary.newattr[ATTR_IMAGE.I_ORGINALHT]=d.IMAGE_HEIGHT,Imagelibrary.newattr[ATTR_IMAGE.I_ORGINALWID]=d.IMAGE_WIDTH,Imagelibrary.newattr[ATTR_IMAGE.I_SRC]=r[0].uploadedFileUrl,InsertShape.selectedShape()?InsertShape.changeShapeProperty(["fillimage",[r[0].uploadedFileUrl,d.IMAGE_WIDTH,d.IMAGE_HEIGHT]]):editor.doc.execCmd("insimg",Imagelibrary.newattr)}FCImageLibrary.close()})}},Imagelibrary.prototype.insertWebImage=function(e){if(Imagelibrary.replaceImageAction)Imagelibrary.replaceImage(e[0].IMAGE_URL);else for(var t=0,i=e.length;t<i;t++){var o=e[t],r=Imagelibrary.checkImgWidHeight(o.IMAGE_WIDTH,o.IMAGE_HEIGHT);Imagelibrary.newattr[ATTR_IMAGE.I_HT]=r.IMAGE_HEIGHT,Imagelibrary.newattr[ATTR_IMAGE.I_WID]=r.IMAGE_WIDTH,Imagelibrary.newattr[ATTR_IMAGE.I_ORGINALHT]=r.IMAGE_HEIGHT,Imagelibrary.newattr[ATTR_IMAGE.I_ORGINALWID]=r.IMAGE_WIDTH,Imagelibrary.newattr[ATTR_IMAGE.I_SRC]=o.IMAGE_URL,InsertShape.selectedShape()?InsertShape.changeShapeProperty(["fillimage",[o.IMAGE_URL,r.IMAGE_WIDTH,r.IMAGE_HEIGHT]]):editor.doc.execCmd("insimg",Imagelibrary.newattr)}},Imagelibrary.prototype.replaceImage=function(e){var t=editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart());Imagelibrary.newattr=DocUtil.copyStyle(t.attr()),Imagelibrary.newattr&&Imagelibrary.newattr.cropRect&&(Imagelibrary.newattr.cropRect=null),Imagelibrary.newattr[ATTR_IMAGE.I_SRC]=e,Imagelibrary.newattr[ATTR_IMAGE.I_ID]="",editor.doc.execCmd("applyStyle",[t,Imagelibrary.newattr,"replaceImage"]),Imagelibrary.replaceImageAction=!1},Imagelibrary.prototype.checkImgWidHeight=function(e,t){var i=editor.doc.getPaperWidth();return e>i&&(t=t/e*i,e=i),{IMAGE_WIDTH:e,IMAGE_HEIGHT:t}},Imagelibrary.replaceImageAction=!0,Imagelibrary.prototype.getAppData=function(){return RemoteEditor.imgLibAppData},Imagelibrary=new Imagelibrary;var ImportDoc=function(){"use strict";var e=!1,t=!1,i=!1,o={},r=function(){if(!t){var e={maxSize:"10000000",fileFormats:".doc, .docm, .dot, .dotm, .dotx, .docx, .odt, .rtf, .html, .htm, .txt, .tex",uploadServerStatus:"zoho"===window.customerName,uploadServerURL:editor.docsUploadServerURL+"/postservlet",fileOpenURL:editor.serverurl+"/ropen.do?rid={0}",contextPath:"/writer/fcomponents/"};FCImport.init(e),n(),t=!0}},n=function(){var e=J("#drag"),o=J("#dragdropDiv");o.on("dragleave",function(t){e.hasClass("ui-drop-container")||J(this).hide()}),o.on("drop",function(e){J(this).hide(),e.stopPropagation(),e.preventDefault()}),o.on("dragenter",function(e){e.preventDefault(),e.stopPropagation()}),o.on("dragover",function(e){e.preventDefault(),e.stopPropagation()}),J("#importtoolbar").on("dragenter",function(e){e.stopPropagation(),e.preventDefault(),PanelUtil.showDragAndDropContainer()}),e.on("dragenter",function(t){e.addClass("ui-drop-container"),t.stopPropagation(),t.preventDefault()}),e.on("dragover",function(e){e.stopPropagation(),e.preventDefault()}),e.on("dragleave",function(t){e.removeClass("ui-drop-container"),t.stopPropagation(),t.preventDefault()}),e.on("drop",function(e){e.preventDefault(),e.stopPropagation(),o.hide();var t=e.originalEvent.dataTransfer.files[0];if(t){if(Utils.isImage(t))return EventHandler.dropImage(e),Utils.stopEvent(e),!1;p(),J("#importbrowse").prop("files",e.originalEvent.dataTransfer.files)}}),t=!0,J("#imp_computer,#imp_url").on("statechange",function(e,t){i||J("#impFail,#impDone,#tryImpDoc,#impLoading,#impFromURL").hide(),J(e.currentTarget).is("#imp_url")?J(".ui-upload-container,#upload").fadeOut("fast",function(){J("#impFromURL").fadeIn()}):J("#impFromURL").hide("fast",function(){J(".ui-upload-container,#upload").fadeIn()})})},a=function(e,t){var i=J("#"+e),o="_blank";i.attr("href",editor.getBaseURL()+"/open/"+t),(1==editor.doc.getDocInfo().VERSION&&0==editor.doc.getDocInfo().REVISION&&editor.doc.getDocInfo().newDoc||editorProps.browserInfo.is_macApp)&&(o="_self"),i.attr("target",o)},l=function(e){a("impDlgOpenLink",e),u(),J("#impsuccessdlg").show().animate({bottom:27}),setTimeout(function(){d()},1e4)},s=function(){u(),J("#impFailedDlg").show().animate({bottom:27}),setTimeout(function(){c()},1e4)},d=function(){J("#impsuccessdlg").animate({bottom:-200},function(){J(this).hide()})},c=function(){J("#impFailedDlg").animate({bottom:-200},function(){J(this).hide()})},p=function(){J.ui.utils.initComponents(J("#importtoolbar")),COMPONENTS_INIT_DONE.push("importtoolbar"),ImportDoc.init(),e||(u(),J("#upload").fadeIn());var t=editor.doc.getRole();if("SHAREDREAD"!=t&&"SHAREDREADCOMMENT"!=t&&editor.isEditable()){var i={panelId:ELEM_ID.IMPORTPANEL,animationType:ANIMATIONS.FLIPIN,parentPanels:[ELEM_ID.FORMATPANEL]};LeftPanel.showAdvancedPanel(i)}else LeftPanel.showSubPanel(ELEM_ID.IMPORTPANEL,ANIMATIONS.FLIPIN)},u=function(){J("#impFail,#impDone,#tryImpDoc,#impLoading,#impFromURL").hide(),J("#impurlinput").val(""),J("#imp_computer").prop("checked",!0),J(".ui-upload-container,#upload").fadeIn(),i=!0},f=function(){LeftPanel.closeSubPanel(),e||u()},g=function(){o.pwd=J("#passwordinput").val(),S(o),J.dialogutil.close("imppasswordinputdlg"),T()},m=function(){o.pwd=J("#passwordinput").val(),S(o),J.dialogutil.close("imppassworderrordlg"),T()},h=function(){u(),J("#upload").fadeIn()},T=function(){i=!1,J("#imp_computer,#imp_url").attr("disabled",!0),J("#upload").hide("fast",function(){J("#impLoading").fadeIn()})},E=function(e){J("#impLoading").fadeOut("slow",function(){"success"==e?J("#impDone").fadeIn():J("#impFail").fadeIn()}),J("#imp_computer,#imp_url").removeAttr("disabled"),J("#tryImpDoc").toggle(300),i=!1},R=function(t,i,r){if(e=!1,J("#importtoolbar").is(":visible")){if("success"==t){J("#impDocIcon").removeAttr("class");var n="ui-impIcon ui-icon ui-writer-menu-icons ui-icon-sprit-crazy ui-icon-docimport ui-icon-docimport-"+o.extn+"-lg";J("#impDocIcon").addClass(n),a("openImpDocLink",i)}}else"success"==t?l(i):s();E(t),J("#importForm").trigger("reset"),o={}},S=function(t){T();var i={progress:function(e,t){},success:function(e){if(e="string"==typeof e?JSON.parse(e):e,"success"==e.status){var t=e.resinfo.rid;R("success",t,"impDlgOpenLink")}else R("failure")},fail:function(t){e=!1,t="string"==typeof t?JSON.parse(t):t;var i=t.errorCode;void 0!=i&&"-2"==i?(u(),J.dialogutil.open("imppasswordinputdlg")):void 0!=i&&"-9"==i?(u(),J.dialogutil.open("imppassworderrordlg")):R("failure")}},o={name:t.fileName,password:t.pwd};J("#impDocName").text(t.fileName),e=!0,FCImport.upload(t.filePath,o,i),Utils.addToStatistics("Fm_Import")},O=function(t){if(!e){var i=J("#importbrowse").val(),r="doc,docm,dot,dotm,dotx,docx,odt,rtf,html,htm,txt,tex",n=i.split(".").pop().toLowerCase(),a=editorProps.deployment.zohowriter;if(r.indexOf(n)==-1){var l=setInterval(function(){J(".supImpFmt").fadeIn(1e3,function(){J(this).fadeOut()})},500);return void UIUtils.showMessagePopup(J.i18n("writer.common.UNSUPPORTED_FILE_FORMAT",[a]),J.i18n("writer.common.UNSUPPORTED_FILE_FORMAT_TITLE_MSG"),"info",function(){clearInterval(l),J("#importbrowse,#impurlinput").val("")})}var s=t.files?t.files[0]:t.originalEvent.fileDataTransfer.files[0];o.fileName=s.name,o.pwd="",o.extn=n,o.filePath=J("#importbrowse"),S(o)}},v=function(){var t=J("#impurlinput").val();if(!(e||t.length<1)){var i,r="null",t=J("#impurlinput").val(),n=t.substring(t.lastIndexOf("/")+1),a=/(ht|f)(tp|tps):\/\//g;a.exec(t)||(t=editor.scheme+"://"+t),r=n.split(".")[0],i=n.split(".")[1]||"docx",J("#impFromURL").hide(),J(".ui-upload-container").fadeIn(),o.fileName=r+"."+i,o.pwd="",o.extn=i,o.filePath=t,S(o),Utils.addToStatistics("import_Frome_url")}};return{importFromPC:O,importFromUrl:v,importAgain:h,init:r,closeImpSuccessDlg:d,closeImpFailDlg:c,showImportToolbar:p,hideImportToolbar:f,isInProgress:e,impwithpwd:g,impwithpwdagain:m}}();InsertSpl.jsearchDiv,InsertSpl.splCharDivBottom=0,InsertSpl.splCharDivRight=0,InsertSpl.hoverSymbolsHt=0,InsertSpl.hoverSymbolsWid=0,InsertSpl.frequentlyUsed=[],InsertSpl.open=function(e){"note"==e?(InsertSpl.isNoteSymbol=!0,Utils.addToStatistics("NoteSymbol")):(InsertSpl.isNoteSymbol=!1,Utils.addToStatistics("Symbol")),J.dialogutil.open("insertsplchar",J("#ins-lpnl-splchars"),InsertSpl.dialogInfo),J("#spl_char").focus()},InsertSpl.hideSearchResult=function(){J("#insertSplCont").children().remove();var e=J("#vtabs ul.menutabs li.ui-state-active").find("a"),t=J(e).attr("href");$(e).bind("click",function(){J(t).css("display","block")})},InsertSpl.constructHTML=function(e,t){for(var i=e.length,o="",r=0;r<i;r++){e[r].length;o+="<span label='"+e[r][1]+e[r][2]+'\' class="ui-splcharacter-iconbox"onmouseover="InsertSpl.previewChar(\''+e[r][2]+"','"+e[r][1]+"',this);\"onclick=\"javascript:InsertSpl.insertChar('"+e[r][2]+'\',this);" onmouseout="InsertSpl.hidePreview();" ><a class="ui-splcharacter-inside" style="cursor:pointer;">'+e[r][0]+"</a></span>"}J(t).html(o),InsertSpl.jsearchDiv.append(o)},InsertSpl.constructSymbolDlg=function(){J(".ui-splcharacter-div").removeClass("ui-symbol-loading"),InsertSpl.jsearchDiv=J(document.createElement("div"));for(var e=J("#vtabs li"),t=0;t<e.length;t++)e[t].addEventListener("click",InsertSpl.hideSearchResult,!0);editor.isOffline()&&J("#autocorrect_in_splchar").hide();var i=JSON.parse(punctuation),o=JSON.parse(symbol),r=JSON.parse(arrows),n=JSON.parse(mathalpha),a=JSON.parse(emojis),l=JSON.parse(maths),s=JSON.parse(stars),d=JSON.parse(subsup),c=JSON.parse(currency),p=JSON.parse(shapes),u=JSON.parse(games),f=JSON.parse(zodiac),g=JSON.parse(braille),m=JSON.parse(numberforms),h=JSON.parse(latin);InsertSpl.constructHTML(i,"#tabs_1"),InsertSpl.constructHTML(o,"#tabs_2"),InsertSpl.constructHTML(r,"#tabs_3"),InsertSpl.constructHTML(n,"#tabs_4"),InsertSpl.constructHTML(a,"#tabs_5"),InsertSpl.constructHTML(l,"#tabs_6"),InsertSpl.constructHTML(s,"#tabs_7"),InsertSpl.constructHTML(d,"#tabs_8"),InsertSpl.constructHTML(c,"#tabs_9"),InsertSpl.constructHTML(p,"#tabs_10"),InsertSpl.constructHTML(u,"#tabs_11"),InsertSpl.constructHTML(f,"#tabs_12"),InsertSpl.constructHTML(g,"#tabs_13"),InsertSpl.constructHTML(m,"#tabs_14"),InsertSpl.constructHTML(h,"#tabs_15"),InsertSpl.splCharDivBottom=J(".ui-splcharacter-div").offset().top+J(".ui-splcharacter-div").height(),InsertSpl.splCharDivRight=J(".ui-splcharacter-div").offset().left+J(".ui-splcharacter-div").width(),InsertSpl.hoverSymbolsHt=parseInt(J("#hoversymbols").css("height")),InsertSpl.hoverSymbolsWid=parseInt(J("#hoversymbols").css("width")),InsertSpl.addFrequentlyUsed()},InsertSpl.dialogInfo={init:function(){if(J("#hoversymbols").css("display","none"),J("script#symbolJson")[0])InsertSpl.constructSymbolDlg();else{J("#vtabs").bind("tabbeforeselect",function(e,t){J("#"+t.relatedPaneId+" span").removeClass("ui-splcharacter-iconbox-select")}),J(".ui-splcharacter-div").addClass("ui-symbol-loading");var e={callback:InsertSpl.constructSymbolDlg,src:jsStaticURL+"js/symbols.json",async:"async",id:"symbolJson"};loadJS(e)}},set:function(e,t,i){},get:function(e,t){}},InsertSpl.initAddNewCharField=function(){J("#splChar_unicodeVal").css("color","#8F8F8F"),J("#splChar_unicodeVal").val("Enter Unicode...")},InsertSpl.unicodeTextFocus=function(){var e=J("#splChar_unicodeVal"),t=e.val(),i=document.getElementById("splChar_unicodeVal");if("Enter Unicode..."==t)if(i.createTextRange){var o=i.createTextRange();o.move("character",0),o.select()}else i.setSelectionRange&&i.setSelectionRange(0,0);i.focus()},InsertSpl.unicodeTextBlur=function(){var e=J("#splChar_unicodeVal"),t=e.val();"Enter Unicode..."!=t&&""!=t||(e.css({color:"#8F8F8F"}),e.val("Enter Unicode..."),J("#addNewButton").zbutton("disable"))},InsertSpl.showEmptyValue=function(){J("#previewSymbol").html(""),J("#previewText").html("")},InsertSpl.constructSpan=function(e){var t=InsertSpl.getASCIIVal(e),i='<span class="ui-splcharacter-iconbox" onclick="javascript:InsertSpl.insertChar(\''+e+'\',this);"><a class="ui-splcharacter-inside" style="cursor:pointer;">'+(160==t?"__":"&#"+t+";")+"</a></span>";return i},InsertSpl.addFrequentlyUsed=function(){var e=InsertSpl.frequentlyUsed.length;if(0==e)return void J("#frequentlyUsedCont").hide();J("#frequentlyUsedCont").show();var t=J("#freqUsedView");for(t.empty(),i=0;i<e;i++){if(12==i)return;var o=InsertSpl.frequentlyUsed[i];t.append(InsertSpl.constructSpan(o))}},InsertSpl.addNewCharView=function(e){var t=InsertSpl.getASCIIVal(e);if(t!=-1){var i=String.fromCharCode(t);1==i.length&&InsertSpl.getActiveDiv(InsertSpl.constructSpan(e))}},InsertSpl.search=function(e){var t=J("#splChar_search").val().toLowerCase().replace(/ /g,""),i=J("#vtabs ul.menutabs li.ui-state-active").find("a").attr("href");J("#insertSplCont").empty();var o=t.length;""==t?(J(i).css("display","block"),J("#hoversymbols").css("display","none")):o>3&&1==/^[a-fA-F0-9_]+$/.test(t)?InsertSpl.addNewCharView(t):t.startsWith("u+")?(t=t.replace("u+",""),InsertSpl.addNewCharView(t)):(J(i).css("display","none"),Jtarget=J("#insertSplCont"),InsertSpl.jsearchDiv.find("span[label*='"+t+"']").clone(!0).appendTo(Jtarget))},InsertSpl.searchTimeout,InsertSpl.searchKeyUp=function(e){clearTimeout(InsertSpl.searchTimeout),InsertSpl.searchTimeout=setTimeout(function(){InsertSpl.search(e)},500)},InsertSpl.getActiveDiv=function(e){var t=J("#vtabs ul.menutabs li.ui-state-active").find("a").attr("href");J("#insertSplCont").html(e),J("#insertSplCont").css("display","block"),J(t).css("display","none")},InsertSpl.hidePreview=function(){J("#hoversymbols").css("display","none"),clearTimeout(InsertSpl.previewTimeout)},InsertSpl.previewTimeout,InsertSpl.previewChar=function(e,t,i){clearTimeout(InsertSpl.previewTimeout),InsertSpl.previewTimeout=setTimeout(function(){InsertSpl.preview(e,t,i)},500)},InsertSpl.preview=function(e,t,i){if(null!=i){J("#hoversymbols").css({display:"block"});var o=J(i).offset().top+(J(i).height()+1),r=J(i).offset().left+(J(i).width()+2)/2;o>InsertSpl.splCharDivBottom-20&&(o=J(i).offset().top-InsertSpl.hoverSymbolsHt),r>InsertSpl.splCharDivRight-80&&(r=J(i).offset().left+J(i).width()/2-InsertSpl.hoverSymbolsWid),J("#hoversymbols").offset({top:o,left:r})}e=e||"00A9",t=t||"";var n=InsertSpl.getASCIIVal(e);if(n!=-1){var a=String.fromCharCode(n);1==a.length?(J("#previewSymbol").html(160==n?"__":"&#"+n+";"),J("#previewText").html(t)):InsertSpl.showEmptyValue()}else InsertSpl.showEmptyValue()},InsertSpl.getASCIIVal=function(e){var t=parseInt(e,16);return isNaN(t)?-1:t},InsertSpl.fixedFromCharCode=function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e))):String.fromCharCode(e)},InsertSpl.insertChar=function(e,t){if(e){InsertSpl.val=e,J(J("#vtabs ul.menutabs li.ui-state-active a").attr("href")+" span,#frequentlyUsedCont span").removeClass("ui-splcharacter-iconbox-select"),J(t).addClass("ui-splcharacter-iconbox-select");var i=InsertSpl.fixedFromCharCode("0x"+e);""!=i&&(J("#spl_char").val(i),J("#spl_char").focus(),J("#autocorrect_in_splchar").prop("enable",!0))}},InsertSpl.insert=function(){var e=["»","«","↵"],t=Utils.removeUnWantedUnicodes(J("#spl_char").val().toString(),e);if(InsertSpl.isNoteSymbol)editor.doc.execCmd("insertnotesymbol",{referenceChar:t});else{var i=editor.doc.createElement(NODE_TYPE.TEXT,t);editor.doc.execCmd("insert",i)}InsertSpl.isNoteSymbol=!1,J.dialogutil.close("insertsplchar"),J.inArray(InsertSpl.val,InsertSpl.frequentlyUsed)==-1&&InsertSpl.frequentlyUsed.unshift(InsertSpl.val)},InsertSpl.showAuthorDlg=function(){J.dialogutil.open("insertauthor",J("#ins-lpnl-author"),InsertSpl.AFDialogInfo),setTimeout(function(){J("#authorname").select().focus()},200)},InsertSpl.insertAuthor=function(){var e=J("#insertauthor_ui").zvalidation("validateAllFields",J("#insertauthor_ui"));e&&(editor.doc.execCmd("autofield",["autoauthor",authorName]),J.dialogutil.close("insertauthor"))};var authorName="";InsertSpl.AFDialogInfo={set:function(e,t,i){"author"==e.action&&(authorName=t)},get:function(e,t){if("author"==e)return authorName="REMOTE"!=editor.getEditorType()?editor.doc.getDocInfo().CREATOR:editor.loginName}},function(){"use strict";function e(e,t){for(var i in t)if(t[i]!==e[i])return!1;return!0}function t(e){if(editor.browserInfo.is_ie){e.focus();var t=document.selection.createRange(),i=t.duplicate();i.moveToElementText(e),i.setEndPoint("EndToEnd",t),e.selectionStart=i.text.length-t.text.length,e.selectionEnd=e.selectionStart+t.text.length}}function i(){var e=J("#latexexpression").val(),e=Utils.removeUnWantedUnicodes(e);return e}function o(){var e=i();if(""===e)return!1;var t={},o=editor.doc.getDocInfo(),r=s[a];r=l*r*.01,e=e.replace(/</g," \\textless "),e=e.replace(/>/g," \\textgreater "),t.LATEX_EXPRESSION=encodeURIComponent(e),o.CATEGORY&&"TEMPLATE"!==o.CATEGORY&&(t.AUTHOR_ZUID=o.CREATOR_ZUID),t.RESIZE_VALUE=r,Utils.setCsrfParam(t),J.post(Utils.getNiceUrlPrefix(o.RID+"/latex/preview"),t,function(e){e.indexOf("Invalid LaTeX Expression")==-1&&J("#insertlatexbtn").enable(),J("#loadingDiv").hide(),J("#latexImageDiv").css("opacity",1).html(e)}),J("#loadingDiv").show(),c=e}function r(){J("#zoomStatus").html(s[a]),clearTimeout(d),J("#insertlatexbtn").disable(),d=setTimeout(function(){o()},2e3)}function n(e){if(p+=1,(e.indexOf("ui-latex")&&e.indexOf("format"))==-1)for(var t=J("#"+e).clone(),i=[],o=p,r=0;r<o;r++){if(!(p<20)){i.shift(),i.push(t),J("#recenthideshowdiv").append(i[r]),J("#recenthideshowdiv :first-child").remove();break}i[r]=t,J("#recenthideshowdiv").append(i[r])}}var a=6,l=120,s=[40,50,60,70,80,90,100,125,150,175,200,250,300],d=null,c="",p=0,u={init:function(){var e=editor.getDocument(),t=editor.doc.getSelection().getTargetRange(),i=e.getNodeAt(t.start),o=i&&i.getFormat();if(o&&o.hasOwnProperty("latexexp")){J("#latexexpression").val(o.latexexp);var r=o.src;r&&0===r.indexOf("image.do")&&(r=Utils.getContextUrl(r)),J("#latexImageDiv").html(J(document.createElement("img")).attr("src",r)),a=s.indexOf(o[ATTR_IMAGE.I_IMGSIZE]||100),J("#zoomStatus").html(s[a])}},get:function(e,t){J("#insertlatexbtn").disable()}};window.Latex={insertLatexDialog:function(){Utils.addToStatistics("Equation"),J.dialogutil.open("latexeditordialog",J("#ins_equation"),u)},categoryListMouseOver:function(e){J("#selectGreekLowercase, #selectGreekUppercase, #selectOperaters, #selectSets, #selectComparisonI, #selectComparisonII, #selectArrows, #selectFunctions, #selectOthers").removeClass("ui-selectcategory-list"),J("#GreekLowercase, #GreekUppercase, #Operaters, #Sets, #ComparisonI, #ComparisonII, #Arrows, #Functions, #Others").hide(),J("#select"+e).addClass("ui-selectcategory-list"),J("#"+e).show()},insertExpression:function(e,i){var r,a,l,s=document.getElementById("latexexpression");if(editor.browserInfo.is_ie&&t(s),r=s.value.substr(0,s.selectionStart),a=s.value.substr(s.selectionStart,s.selectionEnd-s.selectionStart),l=s.value.substr(s.selectionEnd),""==a)a=(" "==s.value.substr(s.selectionStart-1,1)?"":" ")+i+(" "==s.value.substr(s.selectionStart,1)?"":" ");else{var d=1==a.length?"":" \\left(",c=1==a.length?"":"\\right) ";a=e.indexOf("ui-others")!=-1?i.replace(/{a}/i,"{"+a+"}"):e.indexOf("ui-latex")!=-1?i.indexOf("{x}^{a}")!=-1||i.indexOf("{x}_{b}")!=-1||i.indexOf("{}^{a}_{b}x")!=-1||i.indexOf("overset{a}{X}")!=-1||i.indexOf("underset{b}{X}")!=-1||i.indexOf("sqrt{x}")!=-1||i.indexOf("sqrt[n]{x}")!=-1||i.indexOf("log_{e} x^{2}")!=-1?i.replace(/x/i,d+a+c):i.indexOf("{e}^")!=-1?i.replace(/e/i,a):i.indexOf("\\left")!=-1&&i.indexOf("\\right")!=-1?i.replace(/ /i," "+a+" "):i.replace(/abc/i,a):e.indexOf("formatSel")!=-1?" "+i+"{"+a+"}":" "+i}J(s).focus().val(r+a+l),s.selectionStart=s.selectionEnd=(r+a).length,o(),n(e)},getLatexSamples:function(){J.dialogutil.open("latexsamplesdialog",void 0,{})},zoomOut:function(){0!=a&&""!==i()&&(a--,r())},zoomIn:function(){12!=a&&""!==i()&&(a++,r())},clearSetTime:function(){var e=i();return""==e.trim()?(J("#latexImageDiv").html(""),void J("#insertlatexbtn").disable()):void(e.trim()!=c.trim()&&r())},clearTxtArea:function(){c="",J("#latexexpression").val(""),J("#latexImageDiv").html(""),J("#insertlatexbtn").disable(),J("#loadingDiv").hide()},regenerate:function(){var e=i();if(""==e.trim())J("#latexImageDiv").html(""),J("#insertlatexbtn").disable();else if(e.trim()==c.trim())return;clearTimeout(d),o()},recentHideShow:function(){J("#recenthideshowdiv").is(":hidden")?J("#recenthideshowdiv").show().siblings("a").html("Hide Recently Used Symbols"):J("#recenthideshowdiv").hide().siblings("a").html("Show Recently Used Symbols")},insertLatexImage:function(){var t=J("#latexImageDiv").find("img"),o=t.attr("src")||"";o||J.dialogutil.close("latexeditordialog");var r={};r[ATTR_IMAGE.I_WID]=t.width(),r[ATTR_IMAGE.I_WID_UN]="px",r[ATTR_IMAGE.I_HT]=t.height(),r[ATTR_IMAGE.I_HT_UN]="px",r[ATTR_IMAGE.I_IMGSIZE]=s[a],r[ATTR_IMAGE.I_LATEXEXP]=i();var n=editor.getDocument(),l=editor.doc.getSelection(),d=l.getTargetRange(),c=n.getNodeAt(d.start),p=c&&c.getFormat()||{};if(!e(p,r)){var u=editor.getDocumentBuilder();if(r[ATTR_IMAGE.I_SRC]=o.slice(o.indexOf("image.do?")),p.hasOwnProperty("latexexp"))u.moveToNode(c).setFormat(r).sync();else{var f=d.start-c.getIndex(),g=d.end-c.getIndex();u.moveToNode(c).insertImage(r,new ZRange(f,g)).sync()}l.removeAllRanges().addRange(editor.doc.createRange(d.start))}J.dialogutil.close("latexeditordialog")},removeEquation:function(){var e=editor.getDocument(),t=editor.doc.getSelection().getTargetRange(),i=e.getNodeAt(t.start),o=i&&i.getFormat()||{};if(o.hasOwnProperty("latexexp")){Resize.removeResizeDiv();var r=editor.getDocumentBuilder();r.moveToNode(i).removeNode().sync()}},modifyEquation:function(){Resize.removeResizeDiv(),this.insertLatexDialog()}}}(),LinkDialog=function(){var e,t,i,o,r,n,a,l,s,d,c=!1,p=!1,u=!1,f=!1,g=!1,m=!1,h="",T="",E={},R=!1,S=function(){e=J("#link-popup"),t=J("#link-url"),i=J("#link-text"),o=J("#link-bookmark-conatiner"),r=J("#linkErrorMsg"),n=J("div.ui-link-bookmark-icon-div"),a=J("#link-bookmark-icon-close"),l=J("#link-nor-bookmark-container"),JtocBookMarkContainer=J("#link-toc-bookmark-container"),s=J("span.ui-link-apply-btn")},O=function(){var e,i,o={},r=!1;if(e=t.val(),!e||m&&e===E.attr(ATTR_LINK.LINK_URL)&&h===T)return void b();if(i=y(e),i===LINK_TYPES.WEBURL){var n=/^((ht|f)tp(s?)\:\/\/){0,1}[-.\w]*(\/?)([a-zA-Z0-9\|\(\)~\-\.\!\?\,\:\'\/\\\+=&amp;%\$#_@\P{InBasicLatin}]*)?$/,a=encodeURI(e.trim());if(r=n.test(a),!r)return void J("#linkErrorMsg").show()}if(i===LINK_TYPES.WEBURL&&e.indexOf("http")===-1&&(e=editor.scheme+"://"+e),i===LINK_TYPES.MAILTO&&e.indexOf("mailto:")===-1&&(e="mailto:"+e),i===LINK_TYPES.BOOKMARK){var l=t.attr("data-bookname");l&&(e=l)}o={url:e,type:i},h!==T&&(o.text=h),m?(o.linkObj=E,o.id=E.attr(ATTR_COMMON.ID),editor.doc.execCmd("ModifyLink",o)):editor.doc.execCmd("CreateLink",o),b()},v=function(){r.hide(),t.attr({"data-bookname":""}),u=p=EventHandler.isMenuOpened=f=g=m=!1,h=T="",E={}},b=function(){v(),c=!1,L(),t.val("").enable(),i.val("").enable(),e.hide(),JtocBookMarkContainer.hide(),o.hide(),l.hide(),n.hide(),a.hide(),o.hide(),EditorUtil.focusMultiByteSpan(),CurUtil.blinkCursor()},A=function(e,t){var i,o,r,n=J.i18n("writer.common.CHECKLINK"),a=e.attr(ATTR_LINK.LINK_TYPE),l=[];return t&&(n=J.i18n("writer.common.GOTO_HEADING")),a==LINK_TYPES.BOOKMARK&&(i=e.attr(ATTR_LINK.LINK_URL),o=editor.doc.getElement(NODE_TYPE.BOOKMARK,i),n=o?n:J.i18n("writer.common.BOOKMARK_REMOVED")),r={label:n,data:"{'appData':{'action':'Utils.goToLink'}}",menu:J("#linkmenu")},l.push(r),t||(n=J.i18n("writer.common.MODIFYLINK"),r={label:n,data:"{'appData':{'action':'LinkDialog.openLinkPopup'}}",menu:J("#linkmenu")},l.push(r)),n=J.i18n("writer.common.REMOVELINK"),r={label:n,data:"{'appData':{'action':'LinkDialog.removeLink'}}",menu:J("#linkmenu")},l.push(r),o&&(r={label:J.i18n("writer.common.GET_LINK"),data:"{'appData':{'action':'BookmarkDialog.showLink',params:['"+o[0].id+"','link']}}",menu:J("#linkmenu")},l.push(r)),l},y=function(e){var t=LINK_TYPES.WEBURL;return p?t=LINK_TYPES.BOOKMARK:/^((mailto:)?[a-zA-Z0-9]+([\w\.\-\+\'])*@\w+([\-]?\w)*(\.\w{1,24})+)$/.test(e)&&(t=LINK_TYPES.MAILTO),t},D=function(){Utils.removeAllLinks()},C=function(){Utils.addToStatistics("Link");var r=editor.doc.getSelection();if(J("#imageLink").hide(),J("#otherLink").show(),!(r.isTableSelected()||"OWNER"!=editor.doc.getRole()&&editor.doc.getSelection().isUnlockAllowed())){PopupHandler.closePopup("smartToolbar");var s=editor.editorPaneContainer;(CurUtil.offset.start.top<=s.scrollTop()||CurUtil.offset.start.top>=s.scrollTop()+s.height())&&(R=!0,Utils.scrollElementIntoView(editor.doc.getDomCursorNode()[0]));var f,g,S,O,v,b,A=(DocTreeManager.lineAtIndex(editor.doc.getSelection().getStart()),J(".zw-page"));J(editor.clientActiveSection).hasClass("zw-contentpane")&&(d=editor.doc.getElement("bookmark"),d.length&&(o.show(),P())),T=h=editor.doc.getContent(editor.doc.getSelection().getStart(),editor.doc.getSelection().getEnd());var y=/^http(s)?:\/\/.*\..*/i,D=/^www\..*\..*/i,C=/^([a-zA-Z0-9]+([\w\.\-\+\'])*@\w+([\-]?\w)*(\.\w{1,24})+)$/,I=T.trim();if(y.test(I)||D.test(I)||C.test(I)){var v=LINK_TYPES.WEBURL,S=I;D.test(I)?S="https://"+I:C.test(I)&&(v=LINK_TYPES.MAILTO,S="mailto:"+I);var _=(editor.doc.createElement(NODE_TYPE.TEXT,I),{type:v,url:S});return void editor.doc.execCmd("CreateLink",_)}var L=editor.doc.getSelection().getStart(),w=editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart());if(w){var f=0,g=0;J("#otherLink").hide(),J("#imageLink").show();var M=w.attr();if(M.linkData){var U=M.linkData.url;J("#link-url").val(U),J("#ui-link-bubble-div").hide()}var x=r.getRangeAt(0),F=x.getStartPortionNode(),k=0;if(F){var B=F.getClientRects();B.length&&(k=B[0].height)}if(M.al&&"bottom"!=M.al){var H=DocUtil.getDOMSourceIndex(L,UNICODE.IMAGE),G=DomUtil.getElementAt("image",H,editor.clientActiveSection),z=J(G),V=z.offset(),Y=G.getBoundingClientRect();f=V.top+Y.height-s.scrollTop(),g=V.left+Y.width/2-e.width()/2}else f=CurUtil.offset.start.top+s.offset().top+k-s.scrollTop(),g=CurUtil.offset.start.left+LeftPanel.getPanelWidth()+s.scrollLeft()+M.wid/2-e.width()/2}else{var r=editor.doc.getSelection();if(r.isCollapsed()&&(L-=1),E=editor.doc.getParents(NODE_TYPE.LINK,L)){if(m=!0,r.isCollapsed()){var W=editor.doc.createRange(E.getStart(),E.getEnd());r.removeAllRanges().setSelectionType(SEL_AUTO_GEN).addRange(W)}if(S=E.attr(ATTR_LINK.LINK_URL),T=h=editor.doc.getContent(E.getStart()+1,E.getEnd()-1),t.val(S),v=E.attr(ATTR_LINK.LINK_TYPE),v===LINK_TYPES.BOOKMARK){var b=editor.doc.getElement("bookmark",S)[0];if(b.id.indexOf("toc_")!=-1){var j=editor.doc.getParents(NODE_TYPE.PARAGRAPH,b.getStart()),Z=editor.doc.getContent(j.getStart(),j.getEnd()-1);Z=Utils.removeUnWantedUnicodes(Z),t.val(Z)}t.disable(),a.show(),n.hide(),p=!0}}var X=0,K="20px",k=0,x=r.getRangeAt(0),F=x.getStartPortionNode();if(F){var B=F.getClientRects();B.length&&(k=B[0].height)}if(f=CurUtil.offset.start.top+s.offset().top+k+X-s.scrollTop(),g=CurUtil.offset.start.left+s.scrollLeft()-X,r.isCollapsed()){var $="undefined"!=typeof LeftPanel?LeftPanel.getPanelWidth():0;g+=$}var q=A.offset().left+A.width()-s.scrollLeft(),Q=s.offset().top+s.height();q>s.width()&&(q=s.offset().left+s.width());var ee=e.width(),te=e.height(),ie=g+ee,oe=f+te,re=".ui-link-arrow-up",ne=".ui-link-arrow-down";ie>q&&(g=g-(ie-q)-10,K=CurUtil.offset.start.left-g,K+="px"),oe>Q&&(f-=te+k+X,re=".ui-link-arrow-down",ne=".ui-link-arrow-up")}e.show().css({top:f,left:g}),u=!!h;var ae=Utils.removeUnWantedUnicodes(h);i.val(ae),O=new RegExp(UNICODE.PARA+"|"+UNICODE.TAB+"|"+UNICODE.BR+"|"+UNICODE.SECTION_START+"|"+UNICODE.TABLE+"|"+UNICODE.TABLEEND+"|"+UNICODE.ROW+"|"+UNICODE.CELL+"|"+UNICODE.RANGE_START+"|"+UNICODE.RANGE_END,"g"),O.test(h)&&i.disable(),JtocBookMarkContainer.find("span.ui-link-bookmark").length<1?J("#ui-link-bookmark-toc").hide():J("#ui-link-bookmark-toc").show(),l.find("span.ui-link-bookmark").length<1?J("#ui-link-bookmark").hide():J("#ui-link-bookmark").show(),c=!0,l.hide(),JtocBookMarkContainer.hide(),CurUtil.stopBlinking(),N(),t.focus()}},I=function(e){e=e||{},e.isToc?g?(JtocBookMarkContainer.is(":visible")?JtocBookMarkContainer.hide():(JtocBookMarkContainer.show(),l.hide()),t.focus()):P(e):f?(l.is(":visible")?l.hide():(l.show(),JtocBookMarkContainer.hide()),t.focus()):P()},P=function(e){e=e||{};var r,n,c=e.isToc,u=0;for(M(),p=!1,t.attr({"data-bookname":""}),c?(g=!0,JtocBookMarkContainer.show()):(f=!0,l.show()),JtocBookMarkContainer.html(""),l.html(""),u=0,r=d.length;u<r;u++)if(n=d[u],n.name)if(n.id.indexOf("toc_")!==-1){var m=editor.doc.getParents(NODE_TYPE.PARAGRAPH,n.getStart()),h=(m.text()||"").replace(UNICODE.PARA,"");h&&JtocBookMarkContainer.append('<span class="ui-link-bookmark" data-bookname="'+n.name+'">'+h+"</span>")}else l.append('<span class="ui-link-bookmark">'+n.name+"</span>");l.find("span.ui-link-bookmark").on("click",function(){p=!0;var e=Utils.removeUnWantedUnicodes(this.innerHTML);t.attr({"data-bookname":""}),t.val(e).disable(),""===i.val()&&_(),a.show(),s.focus(),o.hide()}),JtocBookMarkContainer.find("span.ui-link-bookmark").on("click",function(){p=!0;var e=Utils.removeUnWantedUnicodes(this.innerHTML);t.val(e).disable();var r=J(this).attr("data-bookname");t.attr({"data-bookname":r}),""===i.val()&&_(),a.show(),s.focus(),o.hide()})},_=function(){u||(h=Utils.removeUnWantedUnicodes(t.val()),i.val(h))},N=function(){e.on("keydown",function(e){var t=e.keyCode;t===KEYS.ESC?b():t===KEYS.ENTER&&(J("#imageLink").is(":visible")?ImageLink.insert():O())}),editor.browserInfo.is_ie?t.on("keydown",function(e){(JtocBookMarkContainer.find("span.ui-link-bookmark").length>0||l.find("span.ui-link-bookmark").length>0)&&a.show(),setTimeout(function(){_()},100)}):t.on("input",function(){J("#linkErrorMsg").hide(),o.is(":visible")&&o.hide(),(JtocBookMarkContainer.find("span.ui-link-bookmark").length>0||l.find("span.ui-link-bookmark").length>0)&&a.show(),_()}),i.bind("input",function(){u=!0,h=Utils.removeUnWantedUnicodes(i.val())}),s.focus(function(){s.addClass("ui-link-apply-button-focus")}),s.focusout(function(){s.removeClass("ui-link-apply-button-focus")}),J("#linkdialog_focusdiv2").on("focus",function(){var t=e.find(":enabled");t=t.length?t[0]:s,t.focus()}),J("#linkdialog_focusdiv1").on("focus",function(){s.focus()})},L=function(){e.off("keydown")},w=function(){t.val(""),M(),o.show(),a.hide(),t.attr({"data-bookname":""}),p=!1,f||P(),g||P({isToc:!0}),JtocBookMarkContainer.hide(),l.hide()},M=function(){t.enable(),t.removeClass("ui-state-disabled")},U=function(){return e.is(":hidden")},x=function(){R===!0?R=!1:c&&b()},F=function(){return c};return PubSub.subscribe("Document/ScrollEvent",x),{getMenuObj:A,openLinkPopup:C,createLink:O,removeLink:D,initDomElements:S,removeBookMarkValue:w,toogleBookMarkMenu:I,constructBookMarkMenu:P,closeLinkPopup:b,isDialogOpened:F,isLinkDialogHidden:U,handleScroll:x,getLinkType:y}}(),function(){function e(e){U=e.info||{},P=U.filename,M=e.fields||[],w=e.data||[],L=J.extend([],w),_=e.source}function t(e){x=e}function i(){return x}function o(e){F=e}function r(){return F}function n(){var e=editorProps.urls;switch(_){case N.zcrm:return e.zohoCrmSupportEmail;case N.zpeople:return e.zohoPeopleSupportEmail;case N.zrecruit:return e.zohoRecruitSupportEmail;default:return e.supportURL}}function a(){P=void 0,L=[],w=[],M=[],U={},_=void 0}function l(){return _}function s(){var e=l();return!(!e||N.remote==e||N.zcontacts==e||N.csv==e&&!U.url)}function d(){if(s())return N.zsheet==_?MailMergeSheetPanel.getSheetUrl(U.rid):N.csv==_&&U.url?U.url:_==N.zforms?MailMergeFormPanel.getFormBuilderUrl(U.formlinkname):void 0}function c(){return P}function p(){return U}function u(){return M}function f(e){M=e}function g(e){M.push(e)}function m(e,t){for(var i=e.id,o=0,r=M.length;o<r;o++){var n=M[o][MAILMERGE.FIELD_ID];if(n==i){t?M.splice(o,1,e):M.splice(o,1);break}}}function h(e){if(e)for(var t=u(),i=0,o=t.length;i<o;i++){var r=t[i];if(e==r[MAILMERGE.FIELD_NAME]||r.hasOwnProperty(MAILMERGE.GROUP_NAME)&&e==r[MAILMERGE.GROUP_NAME]+"."+r[MAILMERGE.FIELD_NAME])return r[MAILMERGE.FIELD_ID]}}function T(e){if(e)for(var t=u(),i=0,o=t.length;i<o;i++)if(e==t[i].id)return t[i]}function E(){return w}function R(e){w=e}function S(e){w.push(e)}function O(e){return w[e]||{}}function v(){return w.length}function b(){return void 0!=w&&v()>0}function A(){return void 0!=M&&M.length>0}function y(e,t){for(var i=[],o=e,r=t;o<=r;o++)i.push(O[o]);return i}function D(e,t){}function C(e,t){if(e<0||t>v())return[];w=[];for(var i=e,o=t;i<=o;i++)w.push(L[i])}function I(){docProps.MM_DETAILS&&e(docProps.MM_DETAILS)}var P,_,N={csv:1,remote:2,zsheet:3,zcontacts:4,zcrm:5,zforms:6,zpeople:7,zrecruit:8},L=[],w=[],M=[],U={},x=1e3,F=1e3;window.MailMergeDataModel={init:e,setMailLimit:t,getMailLimit:i,setTotalMailLimit:o,getTotalMailLimit:r,getSupportEmail:n,getSource:l,getFileName:c,getFields:u,setFields:f,addField:g,modifyField:m,getFieldInfo:T,getRecords:E,setRecords:R,addRecord:S,getRecordAt:O,getRecordsCount:v,getRecordsBetweenRange:y,getFieldId:h,filterRecords:C,filterRecordsByPattern:D,isRecordsAvailable:b,isDynamicFetch:s,getSourceLink:d,isFieldNamesAvailable:A,getInfo:p,SOURCE:N,emptydata:a},PubSub.subscribe("Document/AfterInit",I)}(),function(){function e(e,t){var i=P+_[e];return J.i18n(i,t)}function t(t,i,o){return t.responseJSON&&t.responseJSON.REASON&&_[t.responseJSON.REASON]?e(t.responseJSON.REASON,o):i}function i(){for(var e=MailMergeDataModel.getFields(),t=0,i=e.length;t<i;t++){var o=e[t];if("email"==o.type)return o.id}return""}function o(e){e.removeAttr("title"),e.removeClass("mm-panel-csvname"),e.off("click");var t=MailMergeDataModel.getSourceLink();t&&(e.attr("title",t),e.click(function(){Utils.safeWindowOpen(t)}),e.addClass("mm-panel-csvname"))}function r(){var e=MailMergeDataModel.getFileName(),t=Z("mm-panel-csvnamecont"),i=t.find("#mm-panel-csvname");i.text(e),t.show(),o(i)}function n(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}function a(e){var t=MailMergeDataModel.getRecordAt(0);return n(t[e])}function l(){var e=Z("mailmergeIFrame")[0];void 0==e&&(e=document.createElement("iframe"),e.id="mailmergeIFrame",J(e).css({width:0,height:0,position:"absolute",top:"-1000px"}),document.body.appendChild(e))}function s(){var e={propertyGroups:{"*":["border","border-top","border-bottom","border-left","border-right","background-color","color"],block:["margin","padding"]},elementGroups:{"*":["TD"]}};return e}function d(){var e="";return editor.jeditorPane.children("div.zw-page").each(function(){e+=this.outerHTML}),e}function c(e,t){J(document.body).find(".zw-table").css("border-collapse","collapse").inlineStyler(s());var i=J(document.body).clone(!0);if(PubSub.publish("Document/beforePDFStart",i),"digisign"===e){i.find("div.zw-page").css({"border-top":"",height:"","page-break-after":"auto"}).removeClass("zw-paginated"),i.find("div.zw-contentpane").css({height:""}),i.find("div.zw-line-content").removeClass("zw-line-content-div-justify");var o=i.find("div.header_primary").hide(),r=i.find("div.footer_primary").hide();i.find("div.zw-hr").show(),o.first().show(),r.last().show(),i.find("table").width("100%"),i.find("td, div.zw-cell-container").width(""),i.find("div.overlay, div#imgResizeGrid").remove()}if(p(i),u(i),"email"===e){var n=i.find("div.zw-page");n.css({"border-top":"",height:"","page-break-after":"auto"}).removeClass("zw-paginated"),i.find("div.zw-contentpane").css({height:""});var a=n.length;n.each(function(e){var t=J(this);t.css({"margin-left":"","box-shadow":""}),0!=e&&t.find("div.header_primary").hide(),e!=a-1&&t.find("div.footer_primary").hide(),t.find("div.overlay,div.replace-overlay,div.ui-hf-dbl-clk,#headeredit,#footeredit,.ui-hdr-ftr-exit,div.zw-ifr-msg-div").remove(),t.find("span.ui-comment-indication,span.ui-comment-resolved").removeClass("ui-comment-indication ui-comment-resolved"),t.find("div.spell-error").remove()}),i.find('span[class^="EOP"]').remove(),i.find("span.autopcnt,span.autopno,span.autopno_toc,span.autodocname,span.autoauthor,span.autodate,span.autoformula").each(function(){J(this).removeClass("autopcnt autopno autopno_toc autodocname autoauthor autodate autoformula")});var l=i.find('span[class^="zw-portion zeroSize tab"]');i.find('span[class^="zw-portion zeroSize"]').not(l).remove(),i.find("#tocClose").parents("div").first().remove(),i.find("#zwTOCDiv,div.header_flag,div.footer_flag").remove()}1==ViewManager.getColCount()&&i.find("div.zw-contentpane").each(function(){var e=J(this);e.find("div.zw-column").css({height:""}).parent().css({float:"",height:""})}),i.find("span.mergeField").css({"background-color":"",border:"0px"}),i.find('div[id^="z-cursor"]').remove();var d="";if(i.find("#editorpane").children("div.zw-page").each(function(){d+=this.outerHTML}),t){var c=J(document.createElement(NODE_NAME.TABLE));c.css("width","100%");var f=J(document.createElement(NODE_NAME.TR)),g=J(document.createElement(NODE_NAME.TD));g.css({"border-top":"1px solid rgb(229,229,229)","padding-top":"10px"}),g.attr("align","center");var m=J(document.createElement(NODE_NAME.P)),h=J(document.createElement(NODE_NAME.SPAN));h.css({"font-size":"14px",color:"rgb(152,152,152)"}).text("If you wish to unsubscribe, ");var T=J(document.createElement(NODE_NAME.A));T.attr({href:t,target:"blank"}).css({color:"rgb(0,190,135)","text-decoration":"underline","font-size":"14px"}).text("click here."),m.append(h),m.append(T),g.append(m),f.append(g),c.append(f),d+=c[0].outerHTML}return"<!DOCTYPE html><html><body>"+d+"</body></html>"}function p(e){e=Utils.convertSVGToImg(e),e.find("img").each(function(){var e=J(this),t=e.attr("linkdata");if(t){var i=JSON.parse(t);if(i){var o=i["data-link-url"];if("undefined"!=o){var r=J("<a />",{href:o,target:"_blank"});e.wrap(r[0])}}}var n=e.attr("src");n&&(n.indexOf("image.do?imgurl=")>=0||n.indexOf("remoteImage.do?imgurl=")>=0?(0===n.indexOf("/writer/")&&(n=n.substring("8")),e.attr("src",editor.getBaseURL()+"/"+n)):0===n.indexOf("images/")?e.attr("src",imgStaticURL+n):0===n.indexOf("/images/")?e.attr("src",imgStaticURL+n.substring("/".length)):0!=n.indexOf(editor.getBaseURL())&&editor.orgPolicyData&&"undefined"!=typeof editor.orgPolicyData.exportExternalImages&&!editor.orgPolicyData.exportExternalImages&&0===n.indexOf("http")&&e.replaceWith("<a href='javascript:void(0);' style='background-color: #F1F1F1;'>&lt;&lt;"+n+"&gt;&gt;</a>"))})}function u(e){for(var t=e.find("div.zw-contentpane").find("iframe"),i=0,o=t.length;i<o;i++){var r=J(t[i]),n=document.createElement("image");J(n).attr("src",imgStaticURL+"images/shape-obj.png").css({width:"100%",height:"400px"}),r.replaceWith(n)}}function f(e,t){for(var i=MailMergeDataModel.getFields(),o=0,r=i.length;o<r;o++){var n=i[o],a=n.id,l=A(n),s=y(a,t);e=g(e,l,s)}return e}function g(e,t,i){t=(UNICODE.MERGEFIELD_START+t+UNICODE.MERGEFIELD_END).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var o=new RegExp(t,"g");return e=e.replace(o,i)}function m(e,t,i){e.text(t).show(),i&&setTimeout(h,i,e)}function h(e){e.hide()}function T(e,t){UIUtils.showLoadingMsg(e,t)}function E(){for(var e=RegExp(UNICODE.RANGE_START+"|"+UNICODE.IMAGE,"gi"),t=editor.doc.contStr,i=editor.doc.getFormats(),o=e.exec(t);o;){var r=i[o.index],n=r.mminfo;if(n&&n.type!=MAILMERGE.BUILD_IN_FIELD||r.mminfos)return!0;o=e.exec(t)}return!1}function R(){for(var e=[],t=RegExp(UNICODE.RANGE_START+"|"+UNICODE.IMAGE,"gi"),i=MailMerge.getDocContent(),o=i.content,r=i.styles,n=t.exec(o);n;){var a=r[n.index],l=a.mminfo;if(l&&l.type!=MAILMERGE.BUILD_IN_FIELD&&!e.contains(l.id))e.push(l.id);else if(a.mminfos)for(var s=a.mminfos,d=Object.keys(s),c=0,p=d.length;c<p;c++){l=s[d[c]];var u=l.id;l.type==MAILMERGE.BUILD_IN_FIELD||e.contains(u)||e.push(u)}n=t.exec(o)}return e}function S(e,t){MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_ALERT,void 0,J.i18n("writer.editor.MAILMERGE.RECORD_LIMIT_REACHED",[e,t]),void 0,void 0)}function O(e,t){var i=J(e);i.siblings().removeClass("active"),i.addClass("active"),J(t).show()}function v(e){var t=J(e),i=t.data().info.url;Utils.safeWindowOpen(i)}function b(e,t){e.children().each(function(e){var i=J(this),o=i.text();o.toLowerCase().indexOf(t.toLowerCase())==-1?i.hide():i.show()})}function A(e){var t=e[MAILMERGE.GROUP_NAME],i=e[MAILMERGE.FIELD_NAME];return t&&(i=t+"."+i),i}function y(e,t){var i=t.hasOwnProperty(e)?t[e]:"";return i}function D(e){return C(e)||I(e)}function C(e){var t=editor.doc.getDocInfo();return("MAILMERGE_LIBRARY"==e||"CRM_VERTICAL_MAILMERGE_LIBRARY"==e)&&t.MAILMERGE_TEMPLATE||"ZFORMS_TEMPLATE"==e}function I(e){var t=editor.doc.getDocInfo();return("MAILMERGE_LIBRARY"==e||"CRM_VERTICAL_MAILMERGE_LIBRARY"==e)&&!t.MAILMERGE_TEMPLATE}var P="writer.editor.MAILMERGE.",_={};_.EXCEPTION_IN_CREATE_SHEET="SOURCE_CREATION_FAILED",_.LARGE_FILE="LARGE_CSV_FILE",_.NO_CSV_FOUND="NO_CSV_FOUND",_.UNABLE_TO_READ="UNABLE_TO_READ",_.EXCEPTION_IN_IMPORT_CSV="UPLOADPROPERCSV",_.INVALID_FILE_EXTENSION="UPLOAD_VALID_CSV",_.EXCEPTION_IN_IMPORT_CONTACT="UNABLE_TO_IMPORT_YOUR_CONTACT",_.EXCEPTION_IN_GET_CONTACTS="UNABLE_TO_FETCH_CONTACTS",_.EXCEPTION_IN_IMPORT_SHEET="UNABLE_TO_IMPORT_SHEET",_.EXCEPTION_IN_GET_SHEET_FILES="UNABLE_TO_FETCH_SHEET_DOCUMENT",_.FORMS_PERMISSION_DENIED="NO_PERMISSION_FOR_FORM_DOCUMENT",_.FORMS_RESPONSE_NULL_WHILE_LIST="UNABLE_TO_FETCH_FORM_DOCUMENT",_.EXCEPTION_IN_GET_FORMS_LIST="UNABLE_TO_FETCH_FORM_DOCUMENT",_.FORMS_RESPONSE_NULL_WHILE_IMPORT="UNABLE_TO_IMPORT_DATA",_.FORMS_INTERNAL_SERVER_ERROR="UNABLE_TO_IMPORT_DATA",_.FORMS_UNHANDLED_ERROR="UNABLE_TO_IMPORT_DATA",_.EXCEPTION_IN_IMPORT_FORMS="UNABLE_TO_IMPORT_DATA",_.FIELD_RESPONSE_IS_NULL="UNABLE_TO_UPDATE_FIELDS",_.EXCEPTION_IN_GETFIELDS="UNABLE_TO_UPDATE_FIELDS",_.RECORD_RESPONSE_IS_NULL="FETCH_LATEST_RECORDS_NULL",_.EXCEPTION_IN_GETRECORDS="FETCH_LATEST_RECORDS_ERROR",_.MAILMERGE_DATA_DELETED="MAILMERGE_DATA_DELETED",_.EXCEPTION_IN_MERGETONEW="UNABLE_TO_CREATEDOC",_.EXCEPTION_IN_FINISH_MERGE="",window.MailMergeUtil={getErrorMsg:t,getEmailFieldId:i,isMergeFieldsPresentInDocument:E,setSourceFileName:r,isValidEmail:n,isValidEmailField:a,checkIframe:l,getProcessedHTML:c,getClientRenderedHTML:d,showStatusMsg:m,hideStatusMsg:h,replaceFieldsInPlainText:f,replaceFieldInText:g,getMergeFieldsInDocument:R,showMsg:T,showLimitReachedDlg:S,activeCurrentDiv:O,openDataPreview:v,searchDataSourceFiles:b,getFieldName:A,getFieldValue:y,isMailMergeRelatedRole:D,isMailMergeTemplateRole:C,isMailMergeDocumentRole:I}}(),function(){function e(){J("#mm-lpnl-csvurl-cont").hide(),FetchHTML.get({requestName:"mailmergesheetpanel",target:"#mm-subpanel-sheetcontainer",callback:function(){h.beforeInit(),h.init();var e={panelId:ELEM_ID.MMSHEETPANEL,animationType:ANIMATIONS.FLIPIN,parentPanels:[ELEM_ID.TOOLSPANEL,ELEM_ID.MAILMERGEPANEL]};LeftPanel.showAdvancedPanel(e)}})}function t(){LeftPanel.closeSubPanel(),J("#mm-sheetpanel-loadingcontainer,#mm-sheetpanel-loadingstatusmsg,#mm-sheetpanel-loading").show(),J("#mm-sheetpanel-listpanelcontainer,#mm-sheetpanel-importstatuscontainer,#mm-sheetpanel-btn-import").hide()}function i(){var e=n.find("li.active"),i=e.data().info.rid;c.show(),p.show(),u.text(J.i18n("writer.common.importing")).show();var o={sheetrid:i};J.ajax({async:!0,type:"get",url:Utils.getUrl("mailmerge/import/zsheet"),data:o,dataType:"json",timeout:25e3,success:function(e){p.hide(),t(),MailMergeDataModel.init(e.MM_DETAILS),MailMerge.initStep2(),e.originalRecordLen>e.importedRecordLen&&MailMergeUtil.showLimitReachedDlg(e.importedRecordLen,e.originalRecordLen)},error:function(e,t,i){p.hide();var o=MailMergeUtil.getErrorMsg(e,J.i18n("editor","MAILMERGE.UNABLE_TO_IMPORT_SHEET"));MailMergeUtil.showStatusMsg(u,o,g)}})}function o(e){var t=editor.scheme+"://"+editor.docsServerURL+"/sheet/";return e?t+"open/"+e:t+"new"}var r,n,a,l,s,d,c,p,u,f,g=5e3,m=!1,h={beforeInit:function(){m||(r=J("#mm-sheetpanel-listpanelcontainer"),n=J("#mm-sheetpanel-filelisting"),f=n.find("li").clone(!0),a=J("#search_SheetFiles"),l=J("#mm-sheetpanel-loadingcontainer"),s=l.find("#mm-sheetpanel-loading"),d=l.find("#mm-sheetpanel-loadingstatusmsg"),c=J("#mm-sheetpanel-importstatuscontainer"),p=c.find("#mm-sheetpanel-importstatusloading"),u=c.find("#mm-sheetpanel-importstatusmsg"),m=!0),d.text(J.i18n("writer.editor.MAILMERGE.LOADING_SHEET_FILES")),a.val("");var e={};Utils.setCsrfParam(e),J.ajax({type:"get",dataType:"json",url:Utils.getUrl("mailmerge/zsheets/list"),data:e,success:function(e){s.hide();var t=e.LIST;if(t.length>0){n.html("");for(var i=0,a=t.length;i<a;i++){var c=t[i].RID,p=t[i].DOCUMENT_NAME,u=f.clone(!0),g=u.find(".ui-mmsource-name"),m=u.find(".ui-mmsource-plabel");m.data("info",{url:o(c)}),g.text(p),u.data("info",{rid:c}),n.append(u)}l.hide(),r.show()}else{var h=J("<a/>",{href:o(),target:"_blank",onclick:"MailMergeSheetPanel.close()",text:J.i18n("writer.common.CLICK_HERE")}),T=h[0].outerHTML,E=editorProps.deployment.zohosheet;d.html(J.i18n("writer.editor.MAILMERGE.NO_SHEET_DOCUMENT",[T,E]))}},error:function(e,t,i){s.hide();var o=MailMergeUtil.getErrorMsg(e,J.i18n("editor","MAILMERGE.UNABLE_TO_FETCH_SHEET_DOCUMENT"));d.text(o)}})},init:function(e,t){var i;a.unbind().bind({keyup:function(){clearTimeout(i),i=setTimeout(function(){MailMergeUtil.searchDataSourceFiles(n,this.val())},300)}})}};window.MailMergeSheetPanel={open:e,close:t,importSheetData:i,getSheetUrl:o}}(),function(){function e(){J("#mm-lpnl-csvurl-cont").hide(),FetchHTML.get({requestName:"mailmergeformpanel",target:"#mm-subpanel-formcontainer",callback:function(){T.beforeInit(),T.init();var e={panelId:ELEM_ID.MMFORMPANEL,animationType:ANIMATIONS.FLIPIN,parentPanels:[ELEM_ID.TOOLSPANEL,ELEM_ID.MAILMERGEPANEL]};LeftPanel.showAdvancedPanel(e)}})}function t(){LeftPanel.closeSubPanel(),J("#mm-formpanel-listpanelcontainer,#mm-formpanel-importstatuscontainer,#mm-formpanel-btn-import").hide(),J("#mm-formpanel-loadingcontainer,#mm-formpanel-loadingstatusmsg,#mm-formpanel-loading").show()}function i(){var e=n.find("li.active"),i=e.data().info;p.show(),u.show(),f.text(J.i18n("writer.common.importing")).show();var o={formInfo:JSON.stringify(i)};J.ajax({async:!0,type:"get",url:Utils.getUrl("mailmerge/import/zform"),data:o,dataType:"json",success:function(e){u.hide(),t(),MailMergeDataModel.init(e.MM_DETAILS),MailMerge.initStep2()},error:function(e,t,i){u.hide();var o=MailMergeUtil.getErrorMsg(e,J.i18n("editor","MAILMERGE.UNABLE_TO_IMPORT_DATA"));MailMergeUtil.showStatusMsg(f,o,g)}})}function o(e){return editorProps.urls.zohoFormsURL+"/api/builder?formlinkname="+e}var r,n,a,l,s,d,c,p,u,f,g=5e3,m=!1,h=J("<a/>",{href:editorProps.urls.zohoFormsURL,target:"_blank",onclick:"MailMergeFormPanel.close()"}),T={beforeInit:function(){m||(r=J("#mm-formpanel-listpanelcontainer"),n=J("#mm-formpanel-filelisting"),a=n.find("li").clone(!0),l=J("#search_FormFiles"),s=J("#mm-formpanel-loadingcontainer"),d=s.find("#mm-formpanel-loading"),c=s.find("#mm-formpanel-loadingstatusmsg"),p=J("#mm-formpanel-importstatuscontainer"),u=p.find("#mm-formpanel-importstatusloading"),f=p.find("#mm-formpanel-importstatusmsg"),m=!0),c.text(J.i18n("writer.editor.MAILMERGE.LOADING_FORMS_FILES")),l.val("");var e={};Utils.setCsrfParam(e),J.ajax({type:"get",dataType:"json",url:Utils.getUrl("mailmerge/zforms/list"),data:e,success:function(e){d.hide();var t=e.LIST||[];if(t.length>0){n.html("");for(var i=0,o=t.length;i<o;i++){var l=t[i],p=l.display_name,u=l.public_url,f=a.clone(!0),g=f.find(".ui-mmsource-name"),m=f.find(".ui-mmsource-plabel");m.data("info",{url:u}),g.text(p),f.data("info",l),n.append(f)}s.hide(),r.show()}else{h.text(J.i18n("writer.common.CLICK_HERE"));var T=h[0].outerHTML,E=editorProps.deployment.zohoforms;c.html(J.i18n("writer.editor.MAILMERGE.NOFORMDOCUMENT",[T,E]))}},error:function(e,t,i){d.hide(),h.text(J.i18n("writer.common.READ_MORE"));var o=h[0].outerHTML,r=MailMergeUtil.getErrorMsg(e,J.i18n("editor","MAILMERGE.UNABLE_TO_FETCH_FORM_DOCUMENT"),[o]);c.html(r)}})},init:function(e,t){var i;l.unbind().bind({keyup:function(){clearTimeout(i),i=setTimeout(function(){MailMergeUtil.searchDataSourceFiles(n,l.val())},300)}})}};window.MailMergeFormPanel={open:e,close:t,importFormData:i,getFormBuilderUrl:o}}(),function(){function e(e){F=e}function t(){return F.length}function i(e){k.push(e)}function o(){return k}function r(e){var t=k.indexOf(e);t>-1&&k.splice(t,1)}function n(e){return k.contains(e)}function a(){return k.length}function l(e){e.click(function(){g(e.data().info)})}function s(){I.html("");for(var e=0,i=t();e<i;e++){var o=F[e],r=o.EMAIL,a=(o.NAME,c(o,H));l(a),I.append(a),n(r)&&p(o)}var s;_.unbind().bind({keyup:function(){clearTimeout(s),s=setTimeout(function(){d(_.val().toLowerCase())},300)}})}function d(e){I.children().each(function(t){var i=J(this),o=i.children(),r=o[1].textContent,n=o[2].textContent;r.toLowerCase().indexOf(e)==-1&&n.toLowerCase().indexOf(e)==-1?i.hide():i.show()})}function c(e,t){var i=e.EMAIL,o=e.NAME,r=J("<div/>",{id:i,name:o,class:"ui-mmerge-contact",data:{info:e}});return J("<span/>",{style:"cursor:pointer;display:none",class:"ui-button-icon-primary ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue "+t}).appendTo(r),J("<div/>",{class:"ui-mmerge-listcontname",noi18n:"true",text:o}).appendTo(r),J("<div/>",{class:"ui-mmerge-listcontname ui-mmerge-mailid",noi18n:"true",text:i}).appendTo(r),r}function p(e){var o=e.EMAIL;if(!n(o))if(a()<x){var r=c(e,H);r.find("span").css("display","block").click(function(){u(o)}),P.append(r),i(o);var l=a();h(l),T(l);var s=I.find('[id="'+o+'"]');s.find("span").addClass(G).css("display","block"),l!=x&&l!=t()||f(!0)}else E()}function u(e){P.find('[id="'+e+'"]').remove(),r(e);var t=a();h(t),T(t),f(!1);var i=I.find('[id="'+e+'"]');i.find("span").css("display","none")}function f(e){e?(U.attr({title:"Deselect All",checked:!0}),U.button("option","icons",{primary:"ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-checked-sm"})):(U.attr({title:"Select All",checked:!1}),U.button("option","icons",{primary:"ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-unchecked-sm"}))}function g(e){var t=e.EMAIL;n(t)?u(t):p(e)}function m(){if(U.attr("checked"))for(var e=o().slice(0),i=0,r=e.length;i<r;i++){var n=e[i];u(n)}else for(var i=0,r=t();i<r;i++){if(!(i<x)){E();break}p(F[i])}}function h(e){J(".ui-sel-count").text(e+" / "+x)}function T(e){0==e?N.hide():N.show()}function E(){var e=2e3;UIUtils.showLoadingMsg(J.i18n("writer.editor.MAILMERGE.RECORD_LIMIT_WARNING",[x])),clearTimeout(v),v=setTimeout(UIUtils.hideLoadingMsg,e)}function R(){L.show(),M.text(J.i18n("writer.common.importing"));var e={selectedContacts:o()+""};Utils.setCsrfParam(e),J.ajax({type:"post",url:Utils.getUrl("mailmerge/import/zcontacts"),data:e,success:function(e){L.hide(),O(),MailMergeDataModel.init(e.MM_DETAILS),MailMerge.initStep2()},error:function(e,t,i){w.hide();var o=MailMergeUtil.getErrorMsg(e,J.i18n("writer.editor.MAILMERGE.UNABLE_TO_IMPORT_YOUR_CONTACT"));MailMergeUtil.showStatusMsg(M,o,B)}})}function S(){J("#mm-lpnl-csvurl-cont").hide(),FetchHTML.get({requestName:"mailmergecontactspanel",target:"#mm-subpanel-contactscontainer",callback:function(){V.beforeInit(),V.init();var e={panelId:ELEM_ID.MMCONTACTSPANEL,animationType:ANIMATIONS.FLIPIN,parentPanels:[ELEM_ID.TOOLSPANEL,ELEM_ID.MAILMERGEPANEL]};LeftPanel.showAdvancedPanel(e)}})}function O(){LeftPanel.closeSubPanel()}var v,b,A,y,D,C,I,P,_,N,L,w,M,U,x=editorProps.restrictions.mailmergeRecordsLogin,F=[],k=[],B=5e3,H="ui-icon-reject-trans-sm",G="ui-icon-accept-trans-sm",z=!1,V={beforeInit:function(){z||(b=J("#mm-subpanel-contactscontainer"),A=J("#mm-contactspanel-loadingcontainer"),y=A.find("#mm-contactspanel-loadingstatusmsg"),D=A.find("#mm-contactspanel-loading"),C=J("#mm-contactspanel-listpanelcontainer"),I=C.find("#mm-contactspanel-listing"),P=C.find("#mm-contactspanel-addedcontact"),_=J("#searchContact"),N=J("#mm-contactspanel-btn-import"),L=J("#mm-contactspanel-importstatuscontainer"),w=L.find("#mm-contactspanel-importstatusloading"),M=L.find("#mm-contactspanel-importstatusmsg"),U=C.find("#mm-contactspanel-selectallContacts"),z=!0)},init:function(){if(!t()){y.text(J.i18n("writer.editor.MAILMERGE.LOADING_YOUR_CONTACTS"));var i={};J.ajax({type:"get",url:Utils.getUrl("mailmerge/zcontacts/list"),data:i,success:function(i){D.hide(),e(i.LIST),t()?(A.hide(),C.show(),s()):y.text(J.i18n("editor","MAILMERGE.YOU_DONT_HAVE_CONTACTS"))},error:function(e,t,i){D.hide();var o=MailMergeUtil.getErrorMsg(e,J.i18n("editor","MAILMERGE.UNABLE_TO_FETCH_CONTACTS"));y.text(o)}})}}};window.MailMergeContactsPanel={open:S,close:O,importContactData:R,toggleAllContacts:m}}(),function(){function e(){Et||(We=J("#ui-mailmergemenu"),je=We.find("#mm-step1"),_e=je.find("#mm-lpnl-csvurl-cont"),Le=je.find("#mm-panel-csvfile"),we=je.find("#mm-panel-csvurl"),$e=je.find("#mm-panel-notecont"),Me=J("#mm-panel-csvnamecont"),xe=We.find("#mmDefinition"),Fe=je.find("#mm-lpnl-btnset"),Ne=je.find("#mm-panel-importstatus"),ke=Ne.find("#mm-panel-importstatusmsg"),Be=Ne.find("#mm-panel-importloading"),Ze=We.find("#mm-step2"),He=Ze.find("#mm-field-refresh"),Je=Ze.find("#mm-panel-updatefields-container"),Ge=Ze.find("#userFieldContainer"),ze=Ze.find("#buildInFieldContainer"),Ve=ze.find("#mm-panel-buildinfields"),Ye=Ze.find("#searchMergeFields"),Xe=We.find("#mm-step3"),Ke=Xe.find("#mm-lpnl-previewbtn,#mm-lpnl-emailbtn,#mm-lpnl-editbtn,#mm-lpnl-updatetempbtn"),jOptionsCont=Xe.find("#mm-panel-optionscontainer"),Ue=jOptionsCont.find("#mm-panel-options-blankline"),qe=J("#mm-preview-recordlisting"),t(),Et=!0)}function t(){var e=$e.find("#mm-panel-note").find("#mm-panel-note-rec-limit"),t=editorProps.restrictions,i=t.mailmergeRecordsLogin;"REMOTE"==editor.getEditorType()&&(i=t.mailmergeRecordsRemote),e.text(J.i18n("writer.editor.MAILMERGE.RECORD_LIMIT",[i]))}function i(){_e.show()}function o(){Ve.toggle()}function r(){var e=editor.doc.createElement(NODE_TYPE.BODY),t={};t.mm_removeBlankLines=!n(),editor.doc.execCmd("applyStyle",[e,t,"updateToggleBlankLine"])}function n(){return editor.doc.bodyFormat.mm_removeBlankLines}function a(e){dt=e}function l(){return dt}function s(e){ct=e}function d(){return ct}function c(){return pt}function p(e){pt=e}function u(e){e||(e=g()),st=e}function f(){return DocUtil.copyStyle(st)}function g(){var e={};return e.content=editor.doc.getDocumentContent(),e.styles=editor.doc.getFormats(),e}function m(){Ie=editor.documentContent,Ie.content=editor.doc.getDocumentContent(),Ie.styles=editor.doc.getFormats()}function h(){return Ie}function T(){var e=MailMergeDataModel.getSource();return MailMergeDataModel.SOURCE.zcrm==e||MailMergeDataModel.SOURCE.zpeople==e||MailMergeDataModel.SOURCE.zrecruit==e}function E(){var e=!1;if(c()||d()-1)return!!(d()-1);for(var t=editor.doc.getDocumentContent(),i=RegExp(UNICODE.RANGE_START+"#"+UNICODE.RANGE_END,"gi"),o=i.exec(t);o&&!e;){var r=o.index,n=editor.doc.getRawFormatAt(r)||{};e=n[ATTR_AUTOFIELD.FIELDTYPE]==CONST.NEXTRECORD,o=i.exec(t)}for(i=RegExp(UNICODE.IMAGE,"gi"),o=i.exec(t);o&&!e;){var r=o.index,n=editor.doc.getRawFormatAt(r)||{},a=n[MAILMERGE.MMINFOS]||{};e=a.hasOwnProperty(J.i18n("writer.editor.MAILMERGE.NEXT_RECORD")),o=i.exec(t)}return e}function R(){return Tt}function S(e){return editor.docsServerURL+"/folder/"+e}function O(e){"buildInField"==e.type||v(e.id)||ft.push(e)}function v(e){for(var t=0,i=ft.length;t<i;t++)if(ft[t].id==e)return!0;return!1}function b(){for(var e=0,t=ft.length;e<t;e++)if("email"==ft[e].type)return ft[e]}function A(){var t=editorProps.deployment.zohowriter;return editor.isFinalDocument()?(MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_WARNING,t,J.i18n("writer.common.FINAL_REVERT_FROM_MAIL_MERGE")),!1):(UIUtils.initComponent("ui-mailmergemenu"),e(),(MailMergeDataModel.isFieldNamesAvailable()||MailMergeDataModel.isRecordsAvailable()||MailMergeDataModel.isDynamicFetch())&&(D(),MailMergeDataModel.isDynamicFetch()&&V()),y(),void Utils.addToStatistics("MailMerge"))}function y(){var e={panelId:ELEM_ID.MAILMERGEPANEL,animationType:ANIMATIONS.FLIPIN,parentPanels:[ELEM_ID.TOOLSPANEL]};LeftPanel.showAdvancedPanel(e)}function D(){xe.slideUp(),Fe.slideUp(),_e.hide(),$e.hide(),MailMergeUtil.setSourceFileName(),Ze.show(),Xe.show(),_(),C(),I(),P()}function C(){var e=editor.doc.getRole(),t=MailMergeUtil.isMailMergeTemplateRole(e)||!MailMergeDataModel.isRecordsAvailable()&&!MailMergeDataModel.isDynamicFetch()?"disable":"enable";Ke.zbutton(),Ke.zbutton(t),Ue[t](),J("#mm-lpnl-updatetempbtn")[MailMergeUtil.isMailMergeDocumentRole(e)?"show":"hide"]()}function I(){var e=!1;n()&&(e=!0,Ue.find(".ui-icon").addClass("ui-writer-toolbar-icon").addClass("ui-icon-select")),Ue.attr("checked",e)}function P(){MailMergeDataModel.isDynamicFetch()?He.show():He.hide()}function _(){Ge.html("");var e=MailMergeDataModel.getFields();if(e&&e.length>0){for(var t=0,i=e.length;t<i;t++)N(e[t]);U(),Je.stop(!0,!0).delay(1500).slideUp()}else Je.stop(!0,!0).show(),Je.text(J.i18n("writer.editor.MAILMERGE.NO_FIELDS"))}function N(e){if(e.groupname){var t=e.groupname.replace(/\'/g,"\\'"),i=Ge.find("div[group-name='"+t+"']");if(0==i.length){var o=L(e.groupname);Ge.append(o);var r=w(e);Ge.append(r)}else{var r=w(e);r.insertAfter(i.last())}}else{var r=w(e);Ge.append(r)}}function L(e){var t=J("<div class='ui-mmfieldlist-grptitle'></div>");t.attr("name",e);var i=J("<span></span>");return i.text(e),t.append(i),t}function w(e){var t=J("<div class='ui-mmfieldlist-label'></div>");return t.text(e.display_name),e.groupname&&(t.attr("group-name",e.groupname),t.addClass("ui-mailmerge-groupitem")),M(t,e),t}function M(e,t){e.click(function(){x(t)})}function U(){var e;Ye.unbind().bind({keyup:function(){clearTimeout(e),e=setTimeout(function(){Ge.children().each(function(e){var t=Ye.val().toLowerCase(),i=J(this),o=i.text(),r=i.attr("group-name"),n=!1;o.toLowerCase().indexOf(t)!=-1||r&&r.toLowerCase().indexOf(t)!=-1?(i.show(),n=!0):i.hide(),r&&n&&Ge.find("div[name='"+r.replace(/\'/g,"\\'")+"']").show()})},300)}})}function x(e){var t=jQuery.extend(!0,{},e),i=CONST.MERGEFIELD,o=[];"NEXT"==t.id&&(Utils.addToStatistics("Mail_Merge.nextRecord"),i=CONST.NEXTRECORD,t.display_name=J.i18n("writer.editor.MAILMERGE.NEXT_RECORD")),o.push(i),o.push(t),ShapeEditor.select.shapes[0]?(Utils.addToStatistics("Mail_Merge.inShape"),InsertShape.insertMergeFields(o)):editor.doc.execCmd("mergeField",o)}function F(e){var t=e.display_name.replace(/\'/g,"\\'");if(e.groupname){var i=e.groupname.replace(/\'/g,"\\'"),o=Ge.find("div[group-name='"+i+"']");if(1==o.length){var r=Ge.find("div[name='"+i+"']");r.remove()}var n=Ge.find("div[group-name='"+i+"']:contains('"+t+"')");n.remove()}else{var n=Ge.find("div:contains('"+t+"')");n.remove()}}function k(e){var t=e.id,i=MailMergeDataModel.getFieldInfo(t);F(i),N(e)}function B(){var e=Z("mm-panel-create-status"),t=e.find("#mm-panel-create-statusmsg"),i=e.find("#mm-panel-create-loading");e.show(),t.text(J.i18n("writer.editor.MAILMERGE.SOURCE_CREATING")),i.show();var o={};Utils.setCsrfParam(o),J.ajax({type:"POST",global:!1,url:Utils.getUrl("mailmerge/create/data"),async:!0,data:o,dataType:"json",error:function(o,r,n){var a=MailMergeUtil.getErrorMsg(o,J.i18n("writer.editor.MAILMERGE.SOURCE_CREATION_FAILED"));t.text(a),i.hide(),setTimeout(e.hide,2e3)},success:function(t){e.hide();var i=t.MM_DETAILS;MailMergeDataModel.init(i),D(),Utils.safeWindowOpen(MailMergeDataModel.getSourceLink())}})}function H(e){e||_e.hide(),Ne.show(),Be.show(),ke.text(J.i18n("writer.common.importing")).show();var t={success:function(e){we.val(""),Le.val(""),e=JSON.parse(e),Ne.hide(),MailMergeDataModel.init(e.MM_DETAILS),D(),e.originalRecordLen>e.importedRecordLen&&MailMergeUtil.showLimitReachedDlg(e.importedRecordLen,e.originalRecordLen)},fail:function(e){we.val(""),Le.val(""),Be.hide();var t=MailMergeUtil.getErrorMsg(e,J.i18n("writer.editor.MAILMERGE.UPLOADPROPERCSV"));MailMergeUtil.showStatusMsg(ke,t,ut)}},i={};e?i.csv_url=we.val():i.csvInput=Le,"REMOTE"==editor.getEditorType()&&(i.rsid=RemoteEditor.rsid),Utils.setCsrfParam(i);var o=Utils.getUrl("mailmerge/import/csv");editor.browserInfo.is_ie&&(i.tstamp=(new Date).getTime()),J.ajaxUpload(o,i,t,"json")}function G(){var e=function(){var e={};"REMOTE"==editor.getEditorType()&&(e.rsid=RemoteEditor.rsid),Utils.setCsrfParam(e),J.ajax({type:"post",url:Utils.getUrl("mailmerge/deletedata"),data:e,dataType:"json",success:function(e){},error:function(e,t,i){}}),Ze.hide(),Xe.hide(),Me.hide(),MailMergeDataModel.emptydata(),xe.slideDown(),Fe.slideDown(),$e.show()};MsgDialog.showMessage(CONST.MSG_TYPE_YESNO,CONST.SEVERITY_WARNING,J.i18n("editor","MAILMERGE.REMOVE_DATA_TITLE"),J.i18n("editor","MAILMERGE.REMOVE_DATA_SOURCE"),void 0,function(t){switch(t){case CONST.BUTTON_1_CLICKED:e();break;case CONST.BUTTON_2_CLICKED:}})}function z(e,t,i){var o=Utils.getUrl("mailmerge/records"),r={};if("REMOTE"==editor.getEditorType()&&(r.rsid=RemoteEditor.rsid),T()){var n=ht.concat(MailMergeUtil.getMergeFieldsInDocument());r.fields=JSON.stringify(n)}Utils.setCsrfParam(r),e(),J.ajax({type:"post",url:o,data:r,success:function(e){MailMergeDataModel.setRecords(e.RECORDS),t()},error:function(e,t,o){var r=MailMergeUtil.getErrorMsg(e,J.i18n("editor","MAILMERGE.FETCH_LATEST_RECORDS_ERROR"));i(r)}})}function V(){var e="ui-icon-sprit-fast ui-icon-refresh-blue-sm",t="zd-progress-spinner spinner-small";if(!He.hasClass(t)){Je.text(J.i18n("writer.editor.MAILMERGE.FETCH_LATEST_FIELDS")).slideDown().show(),He.addClass(t),He.removeClass(e),Ye.val(""),J(".ui-cbox-grp").animate({scrollTop:0},"fast");var i=Utils.getUrl("mailmerge/fields"),o={};"REMOTE"==editor.getEditorType()&&(o.rsid=RemoteEditor.rsid),Utils.setCsrfParam(o),J.ajax({type:"post",url:i,data:o,success:function(i){MailMergeDataModel.setFields(i.FIELDS),Je.text(J.i18n("editor","MAILMERGE.FIELDS_UPDATED_SUCCESSFULLY")),He.removeClass(t),He.addClass(e),_()},error:function(i,o,r){var n=MailMergeUtil.getErrorMsg(i,J.i18n("editor","MAILMERGE.UNABLE_TO_UPDATE_FIELDS"));He.removeClass(t),He.addClass(e),Je.text(n).delay(1500).slideUp()}})}}function Y(e){if(!MailMergeUtil.isMergeFieldsPresentInDocument())return void UIUtils.showLoadingMsg(J.i18n("mailmerge","DOCUMENT_HAS_NO_MERGEFIELDS"),3e3);var t=e[0];u();var i=function(e){if("preview"===e)W();else{var t=MailMergeDataModel.getSource();MailMergeDataModel.SOURCE.zcrm==t||MailMergeDataModel.SOURCE.zpeople==t||MailMergeDataModel.SOURCE.zrecruit==t?ce():de()}};if(MailMergeDataModel.isDynamicFetch()){var o=function(){UIUtils.showLoadingMsg(J.i18n("writer.editor.MAILMERGE.FETCH_LATEST_RECORDS"))},r=function(){i(t)},n=function(e){UIUtils.showLoadingMsg(e,4e3)};z(o,r,n)}else i(t)}function W(){Utils.addToStatistics("Mail_Merge.preview"),mt=function(){p(!0),UIUtils.hideLoadingMsg(),j(),X(),te();var e=editor.doc.getDocInfo();J("#topband-mm-docname").text(e.DOCUMENT_NAME),editor.doc.getSelection().removeAllRanges()},UIUtils.initComponent("mmpreview-toolbarcontainer"),editor.setView(EDITOR_VIEWS.MAILMERGE_PREVIEW),LayoutManager.loadLayout(LAYOUTS.MAILMERGEPREVIEW),editor.setEditable(!1),PubSub.publish("Document/ViewChanged","",""),ft=[],UIUtils.showLoadingMsg(J.i18n("editor","MAILMERGE.PREVIEW_LOADING_MSG")),gt=!0,editor.fetchDocument(Utils.getDocumentId(),""),editor.clientActiveSection=J("div.zw-contentpane")[0],EventHandler.toggleSection()}function j(){E()?(Z("mm-preview-print").show(),Z("mm-preview-download").show(),Z("mm-preview-printoption").hide(),Z("mm-preview-downloadoption").hide()):(Z("mm-preview-print").hide(),Z("mm-preview-download").hide(),Z("mm-preview-printoption").show(),Z("mm-preview-downloadoption").show())}function X(){var e=K();$(J("#mm-preview-fieldnavigation"),ft,e,void 0,void 0),q(e),Q(0),ee()}function K(){var e=b();if(e)selectFieldId=e.id;else{var t=ft[0]||{};selectFieldId=t.id}return selectFieldId}function $(e,t,i,o,r){var n=t.length;if(n>0){var a=!1;e.empty(),e.zcombo();for(var l=0,s=n;l<s;l++){var d,c=t[l],p=c.id,u=c.display_name,f=c.groupname,g=c.type,m=c.module;if(!(o&&g!=o||r&&m!=r)){if(f){var h=f.replaceAll(" ","_").replaceAll("/","_"),T=e.find("#"+h);if(0==T.length){var E={value:f,label:f,id:h,options:[]};e.zcombo("addOption",E),T=e.find("#"+h)}d={value:p,label:u,optionGroup:T}}else d={value:p,label:u};J(d).data("info",c),e.zcombo("addOption",d),i==p&&(a=!0)}}e.zcombo("refresh");var R=e.find("option");if(R.length){var S=a?i:R[0].value;e.zcombo("setValue",S)}}}function q(e){var t=MailMergeDataModel.getRecords();qe.html("");var i=1,o=0,r=t.length,n=function(){};E()?(o=l(),r=r>o+d()?o+d():r,n=function(){var e=parseInt(J(this).attr("data-loc"));Q(e);var t=J(this).text();ie(UNICODE.RANGE_START+t+UNICODE.RANGE_END)}):n=function(){var e=parseInt(J(this).attr("data-loc"));J("#mm-preview-pagination").zpagination("setCurrentPage",e+1)};for(var a=o;a<r;a+=i)if(t[a].hasOwnProperty(e)&&t[a][e].length>0){var s=J('<div class="ui-mmlist-item" data-loc="'+a+'"></div>');s.text(t[a][e]),s.click(n),qe.append(s)}var c=J('<div id="empty-list-item" class="ui-mmlist-item" style="text-align:center;display:none;">No records found.</div>');qe.append(c)}function Q(e){qe.find("div.active").removeClass("active"),qe.find("[data-loc='"+e+"']").addClass("active")}function ee(){var e=J("#mm_preview_recordsearch");e.unbind().bind({keyup:function(){for(var e=J(this).val(),t=qe.find("div"),i=!0,o=0,r=t.length-1;o<r;o++){var n=J(t[o]),a=n.text();a.toLowerCase().indexOf(e.toLowerCase())>-1?(n.slideDown("slow"),i=!1):n.slideUp("slow")}i?J("#empty-list-item").show():J("#empty-list-item").hide(),qe.toggle().toggle()}})}function te(){J("#mm-preview-pagination").unbind().bind("paginationchange",function(e,t){UIUtils.showLoadingMsg(J.i18n("writer.common.LOADING"));var i=t.value-1,o=function(){UIUtils.hideLoadingMsg(),Q(i)};E()&&(i*=d(),o=function(){UIUtils.hideLoadingMsg();var e=J("#mm-preview-fieldnavigation").val()||K();q(e),Q(i),Rt()}),setTimeout(function(){Te(i,o)},0)}).zpagination("updateTotalItems",MailMergeDataModel.getRecordsCount(),1,d())}function ie(e){var t=[],i=editor.doc.getDocumentContent(),o=e.length,r=RegExp(e,"gi"),n=r.exec(i),a=editor.doc.getSelection();for(a.removeAllRanges();n;){var l=n.index,s=l+o,d=editor.doc.createRange(l,s);a.setSelectionType(SEL_AUTO_GEN).addRange(d),t.push({start:l,end:s}),n=r.exec(i)}var c={buttonBGColor:"#94a1de",buttonBRColor:"#0a42e2",id:"mergeField",overlayToBeAnimated:".overlay",ranges:t};PubSub.publish("QuickSeek/showBarWithObj",c)}function oe(){p(!1),editor.setEditable(!0),editor.doc.getSelection().removeAllRanges().addRange(editor.doc.createRange(1)),Rt(),LayoutManager.loadLayout(LayoutManager.getLayoutType()),editor.setView(EDITOR_VIEWS.EDITOR),UIUtils.showLoadingMsg(J.i18n("writer.common.LOADING"));var e={panelId:ELEM_ID.MAILMERGEPANEL,animationType:ANIMATIONS.FLIPIN,parentPanels:[ELEM_ID.TOOLSPANEL]};LeftPanel.showAdvancedPanel(e);var t=function(){UIUtils.hideLoadingMsg(),UIUtils.showDocStatusIcon(),setTimeout(function(){var e=editor.doc.getParents(NODE_TYPE.PARAGRAPH,1),t=editor.doc.getSelection().removeAllRanges().moveTo(e,!0);Utils.scrollElementIntoView(t.getTargetRange().getStartPortionNode())},100)};PubSub.subscribeOnce("Document/LoadingStart",t),editor.fetchDocument(Utils.getDocumentId(),"")}function re(e){var t=0,i=MailMergeDataModel.getRecordsCount()-1;"current"==e&&(t=l(),i=l());var o={};o.operation="download",o.from=t,o.to=i,o.isMailMerge=!0,o.islabel=E(),PrintPreview.printUsingPDF("true","false","_self",o)}function ne(e){"current"==e?PrintPreview.printUsingPDF("false","true","_self"):"all"==e&&ae()}function ae(){var e={};e.operation="print",e.from=0,e.to=MailMergeDataModel.getRecordsCount()-1,e.type="all",e.islabel=E(),e.source=MailMergeDataModel.getSource();var t=editor.doc.docInfo,i=editor.uuid+Date.now(),o="?mailmergeinfo="+encodeURIComponent(JSON.stringify(e))+"&zuid="+editor.zuid;if("REMOTE"==editor.getEditorType()){o+="&rsid="+RemoteEditor.rsid;var r=Utils.getNiceUrlPrefix("rdoc/mailmerge/"+t.DOCUMENT_ID+"/print")}else{o+="&cookietoken="+i;var r=Utils.getNiceUrlPrefix("doc/mailmerge/"+t.RID+"/print")}var n=r+o;MailMergeUtil.checkIframe(),Z("mailmergeIFrame").attr("src",n)}function le(){var e=MailMergeDataModel.getFields(),t=MailMergeUtil.getEmailFieldId();$(it,e,t,void 0,void 0),it.bind("combochange",function(e,t){St()})}function se(){ZWSave.open({fileId:editor.doc.docInfo.RID,extension:"",fileName:editor.doc.docInfo.DOCUMENT_NAME,title:J.i18n("writer.common.CHOOSE_FOLDER"),submitBtnTitle:J.i18n("writer.common.CHOOSE"),onMove:function(e){R().folderId=e.folderId,J("#mm-createdoc-folderpath").val(S(e.folderId)),ZWSave.close(),St()}})}function de(){J.dialogutil.open("mailmergecreatedoc",void 0,Ot)}function ce(){var e=editor.doc.getDocInfo()||{};if(!J.isEmptyObject(e)){var t={},i=MailMergeDataModel.getSource();if(MailMergeDataModel.SOURCE.zcrm==i||MailMergeDataModel.SOURCE.zpeople==i||MailMergeDataModel.SOURCE.zrecruit==i){t.type="single",t.fileName=editor.doc.getDocInfo().DOCUMENT_NAME+"_",UIUtils.showLoadingMsg(J.i18n("editor","MAILMERGE.PLEASE_WAIT_WHILE_MERGING"));var o=function(e){UIUtils.hideLoadingMsg(),Utils.safeWindowOpen(editor.scheme+"://"+window.location.hostname+Utils.getContextUrl("open/"+e.RID))},r=function(e){if(404==e.status)UIUtils.showLoadingMsg(J.i18n("writer.common.SIGNED_OUT_MESSAGE"),4e3);else{var t=MailMergeUtil.getErrorMsg(e,J.i18n("writer.editor.MAILMERGE.UNABLE_TO_CREATEDOC"));UIUtils.showLoadingMsg(t,4e3)}}}else{var n=J("#mm-createdoc_progess_cont"),a=n.find("#mm_createdoc_progresslabel"),l=n.find("#mm_createdoc_progress"),s=it.val();t.pattern=s,t.type=R().type,t.fileName=ot.val(),t.folderId=R().folderId,n.show(),l.show(),Qe.disable(),et.disable(),a.text(J.i18n("mailmergepopup","CREATING_MERGED_DOCUMENT"));var o=function(e){l.hide();var t=editor.scheme+"://"+editor.docsServerURL+"/folder/"+e.PARENT_ID;e.RID&&(t=editor.getBaseURL()+"/open/"+e.RID);var i=J("<a/>",{href:t,target:"_blank",text:J.i18n("writer.common.CLICK_HERE")}),o=i[0].outerHTML,r=editorProps.deployment.zohodocs;a.html(J.i18n("mailmergepopup","MERGED_DOCUMENTS_CREATED",[o,r])),Qe.hide(),et.hide(),tt.show()},r=function(e){if(St(),l.hide(),404==e.status)a.text(J.i18n("writer.common.SIGNED_OUT_MESSAGE"),4e3);else{var t=MailMergeUtil.getErrorMsg(e,J.i18n("writer.editor.MAILMERGE.UNABLE_TO_CREATEDOC"));a.text(t,4e3)}}}Utils.setCsrfParam(t);var d=Utils.getUrl("mailmerge/createdoc");J.ajax({type:"post",url:d,dataType:"json",data:t,success:function(e){o(e)},error:function(e,t,i){r(e)}})}}function pe(){var e=MailMergeDataModel.getFields();if(e.length>0){var t=[],i=[],o=J("#mailmerge_fieldList_emaildialog");o.zmenu(),o.zmenu("removeAllMenuItems");for(var r=0,n=e.length;r<n;r++){var a,l=e[r].display_name,s=e[r].id,d=e[r].groupname;if(d){var c=d.replace(" ","_"),p=i.indexOf(c);if(p===-1){var u={menuItems:[],id:c,mtype:"submenu",label:d,name:c};t.push(u),i.push(c),p=i.indexOf(c)}a={id:s,appData:{action:"MailMerge.insertMergeFieldInSubject",params:e[r]},label:l,name:l},t[p].menuItems.push(a)}else a={id:s,appData:{action:"MailMerge.insertMergeFieldInSubject",params:e[r]},label:l,name:l},t.push(a)}o.zmenu("addMenuItems",t)}}function ue(e){var t=J("#mailmerge-text-emailsubject"),i=e.id;ht.push(i);var o=t.val(),r=MailMergeUtil.getFieldName(e);r=UNICODE.MERGEFIELD_START+r+UNICODE.MERGEFIELD_END,t.val(o+r),t.focus()}function fe(e){if(!MailMergeUtil.getEmailFieldId())return void UIUtils.showLoadingMsg(J.i18n("writer.mailmergepopup.MAILMERGE.NO_EMAIL_FIELD"),4e3);var t=function(){Pe=e[0],J.dialogutil.open("emailmergeddocdlg",void 0,vt),PubSub.subscribe("Dialog/BeforeClose",bt)};UIUtils.showRedactWarningMsg(t)}function ge(){var e=J("#mm-emaildlg-container").zvalidation("validateAllFields",J("#mm-emaildlg-container"));if(e){var t=J.trim(J("#mailmerge-select-emailfldlist").val());ht.push(t);var i=J("#mm-email-status-cont"),o=i.find("#mm_mailto_label"),r=i.find("#mm_mailto"),n=i.find("#mm_mailto_count");r.hide(),n.hide();var a=function(e){if(!(t&&MailMergeUtil.isValidEmailField(t)||e))return MsgDialog.showMessage([J.i18n("writer.common.PROCEED"),J.i18n("writer.common.CANCEL")],CONST.SEVERITY_WARNING,J.i18n("writer.common.DELETE_AUTOTEX_TITLE_MSG"),J.i18n("writer.editor.MAILMERGE.SEND_MAIL_WITH_IMPROPER_EMAILID"),void 0,void 0,function(e){switch(e){case CONST.BUTTON_1_CLICKED:a(!0);break;case CONST.BUTTON_2_CLICKED:J("#mailmerge-select-emailfldlist").focus(),i.hide()}}),!1;var r=MailMergeDataModel.getMailLimit(),n=MailMergeDataModel.getRecordsCount(),s="preview"==Pe?l():0,d="preview"==Pe?l():n-1,c=d+1-s;if(r<c){var p=MailMergeDataModel.getTotalMailLimit(),u=MailMergeDataModel.getSupportEmail();!editor.getOrgPolicy().license_type||"Normal user"==editor.getOrgPolicy().license_type;At(c,r,p);var f=J.i18n("writer.editor.MAILMERGE.MAIL_LIMIT_WARNING_HEADER"),g=J.i18n("writer.editor.MAILMERGE.MAIL_LIMIT_WARNING_MSG",[r,p,u]);if(0==r)return MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_ERROR,f,g,void 0,void 0,void 0),i.hide(),!1;if(!e)return MsgDialog.showMessage([J.i18n("writer.editor.MAILMERGE.PROCEED_MAIL_MSG",[r]),J.i18n("writer.common.CANCEL")],CONST.SEVERITY_WARNING,f,g,void 0,void 0,function(e){switch(e){case CONST.BUTTON_1_CLICKED:a(!0);break;case CONST.BUTTON_2_CLICKED:i.hide()}}),!1;d=s+(r-1),c=d+1-s}var m=r-c;if(MailMergeDataModel.setMailLimit(m),!MailMergeDataModel.isRecordsAvailable())return me(0,0,void 0),!1;var h=J.trim(J("#mailmerge-text-emailsubject").val()),T={};T.operation="email",T.emailField=t,T.subject=h,T.from=s,T.to=d,T.type="preview"==Pe?"current":"all",T.source=MailMergeDataModel.getSource(),T.islabel=E();var R=editor.doc.docInfo,S=editor.uuid+Date.now(),O="?mailmergeinfo="+encodeURIComponent(JSON.stringify(T))+"&zuid="+editor.zuid;if("REMOTE"==editor.getEditorType()){O+="&rsid="+RemoteEditor.rsid;var v=Utils.getNiceUrlPrefix("rdoc/mailmerge/"+R.DOCUMENT_ID+"/email")}else{O+="&cookietoken="+S;var v=Utils.getNiceUrlPrefix("doc/mailmerge/"+R.RID+"/email")}var b=v+O;MailMergeUtil.checkIframe(),Z("mailmergeIFrame").attr("src",b),o.text(J.i18n("writer.mailmergepopup.PROCESSING")),i.show(),Notification.hide(),J("#mm-email-btn-send,#mm-email-btn-cancel").zbutton(),J("#mm-email-btn-send").zbutton("disable"),J("#mm-email-complete").hide()};if(MailMergeDataModel.isDynamicFetch()){var s=function(){o.text(J.i18n("writer.editor.MAILMERGE.FETCH_LATEST_RECORDS")),i.show()},d=function(){a()},c=function(e){Notification.show({container:"#mm-notify-container",message:"writer.editor.MAILMERGE.FETCH_LATEST_RECORDS_ERROR",close:!1,setTimer:!1,type:"error"}),i.hide()};z(s,d,c)}else a();return!0}}function me(e,t,i){var o=J("#mm-email-status-cont");return e>=t?(o.hide(),J("#mm-email-btn-send").enable(),void Notification.show({container:"#mm-notify-container",message:"writer.mailmergepopup.EMAILSENTSUCCESS",close:!1,setTimer:!1})):(o.find("#mm_mailto_label").text(J.i18n("writer.mailmergepopup.SENDING_TO")),o.find("#mm_mailto").text(i).show(),void o.find("#mm_mailto_count").text(J.i18n("writer.mailmergepopup.SENDMAIL_RECORDSTATUS",[e+1,t+1])).show())}function he(e,t,i){var o=new FormData,r=new Blob([i.html],{type:"text/html"});o.append("content",r),o.append("emailValue",i.email.split(",")[0].trim()),o.append("subject",i.subject),o.append("emailField",i.emailField),o.append("index",e),o.append(csrfParamName,getcsrf()),"REMOTE"==editor.getEditorType()&&o.append("rsid",RemoteEditor.rsid);var n=Utils.getUrl("mailmerge/email");J.ajax({async:!0,type:"post",url:n,data:o,enctype:"multipart/form-data;",contentType:!1,processData:!1,success:function(e){},error:function(e,t,i){}}),me(e,t,i.email)}function Te(e,t){var i=Ee(e),o=i.endWith;"download"!=rt&&"print"!=rt||(Dt=o>It?It:o),a(e),s(o+1-e),u(i);var r=i.finalOp;editor.doc.snapShotManager&&editor.doc.snapShotManager.setSkipSnapShot(!0),r.applyTo(),editor.doc.snapShotManager&&editor.doc.snapShotManager.setSkipSnapShot(!1),ViewManager.renderAllpages(),t&&t()}function Ee(e){var t=f();t=Se(t,e);var i=MailMergeDataModel.getRecords();return t=ve(t,i)}function Re(e,t,i){for(var o=e.charAt(i)==UNICODE.PARA&&e.charAt(i+1)!=UNICODE.SECTION_START,r=e.substr(0,t+1).lastIndexOf(UNICODE.PARA),n=r;o&&n<t;){var a=e.charAt(n);o=a==UNICODE.PARA||a==UNICODE.RANGE_START||a==UNICODE.RANGE_END,n++}return o}function Se(e,t){for(var i=e.deletedCharInfos||{},o=e.deletedChars||"",r=new DocOpBuilder,n=Object.keys(i),a=0,l=n.length;a<l;a++){var s=n[a],d=i[s],c=o.charAt(a),p=[{r:Number(s)},{as:{start:d}},{is:c},{as:{end:DocUtil.getKeys(d)}}];r=DocOpBuilder.concise(DocOpBuilder.compose(r,DocOpBuilder.build(p)))}return e.finalOp=r,e.deletedCharInfos={},e.deletedChars="",e.recordIdx=t,e.endWith=t,e.backUpFormats=e.backUpFormats||{},e}function Oe(e,t,i,o){var r=t.textBody,a=i[o]||{};if(r){for(var l=r.paras,s=0,d=l.length;s<d;s++){for(var c=l[s].portions,p="",u=!1,f=0,g=c.length;f<g;f++){var m=c[f],h=m.t;if(h){if(m.mminfo){u=!0;var T=m.mminfo;O(T);var E=T.id,R=T.type,S=MailMergeUtil.getFieldName(T),v=MailMergeUtil.getFieldValue(E,a);h.indexOf(S)!=-1&&("buildInField"==R?(o++,a=i[o]||{}):e.endWith=o,h=MailMergeUtil.replaceFieldInText(h,S,v))}m.t=h,p+=h}}n()&&""==p&&u&&(l.splice(s,1),s--,d--)}r.paras=l}return o}function ve(e,t){for(var i=(UNICODE.MERGEFIELD_START,UNICODE.MERGEFIELD_END,UNICODE.RANGE_START),o=UNICODE.RANGE_END,r=e.deletedCharInfos,a=e.deletedChars,l=e.recordIdx,s=e.content,d=e.styles,c=e.backUpFormats,p=e.finalOp,u=t[l]||{},f=RegExp(i+"|"+UNICODE.IMAGE,"gi"),g=f.exec(s);g;){var m=g.index,h=d[m];if(h.mminfo||h.mminfos)if(h.type!=NODE_TYPE.IMAGE){var T=m,E=h,R="",S=0,v=E.id,b=RegExp(o,"gi");b.lastIndex=T;for(var A=b.exec(s);A;){var y=A.index,D=d[y],C=D.id;if(v==C)break;A=b.exec(s)}if(A){var I=E.ftype,P=T+1,_=E.mminfo,N=s.slice(P,y),L=N.length,w=_.id;I==CONST.MERGEFIELD?(e.endWith=l,O(_),R+=MailMergeUtil.getFieldValue(w,u)):(l++,u=t[l]||{}),S=R.length;var M=T-1,U=y+1,x=Re(s,M,U),F=s.indexOf(UNICODE.PARA,T),k=DocUtil.copyStyle(d[F]),B={};B.st="tab",B.type="text";var J={};if(c[v]?J=DocUtil.copyStyle(c[v]):(J=DocUtil.copyStyle(d[P]),c[v]=J),J.type=NODE_TYPE.TEXT,delete J.cls,L){var H=[{r:P-a.length},{ds:N}];p=DocOpBuilder.concise(DocOpBuilder.compose(p,DocOpBuilder.build(H))),d.splice(P,L),s=s.substr(0,P)+s.substr(y)}if(S>0){if(_.type==MAILMERGE.TYPE_LINK){var G=Utils.randomString(),z=NODE_TYPE.LINK,V={id:G,type:z,lnktype:1,text:R,url:R},Y={id:G,type:z};s=s.substr(0,P)+UNICODE.RANGE_START+UNICODE.RANGE_END+s.substr(P),d.splice(P,0,V,Y);var W={cls:NODE_TYPE.LINK,lnktype:1,type:NODE_TYPE.TEXT,url:R};Utils.mergeJsonObjs(J,W);var H=[{r:P-a.length},{as:{start:V}},{is:UNICODE.RANGE_START},{as:{end:DocUtil.getKeys(V)}},{as:{start:Y}},{is:UNICODE.RANGE_END},{as:{end:DocUtil.getKeys(Y)}}];p=DocOpBuilder.concise(DocOpBuilder.compose(p,DocOpBuilder.build(H))),P++}for(var j=P-a.length,Z=R.split(UNICODE.PARA),X=0;X<Z.length;){var K=Z[X],H=[{r:j},{as:{start:J}},{is:K},{as:{end:DocUtil.getKeys(J)}}];if(p=DocOpBuilder.concise(DocOpBuilder.compose(p,DocOpBuilder.build(H))),j+=K.length,X++,X<Z.length){var H=[{r:j},{as:{start:k}},{is:UNICODE.PARA},{as:{end:DocUtil.getKeys(k)}}];p=DocOpBuilder.concise(DocOpBuilder.compose(p,DocOpBuilder.build(H))),j++}}for(var $=0,q=R.length;$<q;$++){var Q=R.charAt($);Q!=UNICODE.PARA&&Q!=UNICODE.TAB?0==$?d.splice(P+$,0,J):d.splice(P+$,0,null):(Q==UNICODE.PARA?d.splice(P+$,0,k):Q==UNICODE.TAB&&d.splice(P+$,0,B),$+1<q&&R.charAt($+1)!=UNICODE.PARA&&($++,d.splice(P+$,0,J)))}s=s.substr(0,P)+R+s.substr(P)}else if(0==S&&x&&n()){var H=[{r:U-L-a.length},{ds:UNICODE.PARA}];p=DocOpBuilder.concise(DocOpBuilder.compose(p,DocOpBuilder.build(H))),r[U-L]=d[U-L],a+=UNICODE.PARA}g=f.exec(s)}else f.lastIndex=T+1,g=f.exec(s)}else{var ee=m,te=DocUtil.copyStyle(d[ee]),H=[{r:ee-a.length},{ds:UNICODE.IMAGE}];if(p=DocOpBuilder.concise(DocOpBuilder.compose(p,DocOpBuilder.build(H))),te.mminfos){var ie=te.shapeData;if(ie.shapes)for(var oe=ie.shapes,re=0,ne=oe.length;re<ne;re++){var ae=oe[re];l=Oe(e,ae,t,l),u=t[l]||{}}else l=Oe(e,ie,t,l),u=t[l]||{};var H=[{r:ee-a.length},{as:{start:te}},{is:UNICODE.IMAGE},{as:{end:DocUtil.getKeys(te)}}];p=DocOpBuilder.concise(DocOpBuilder.compose(p,DocOpBuilder.build(H)))}else if(te.mminfo){var le=te.mminfo;if(O(le),u.hasOwnProperty(le.id)){var se=u[le.id];te.src=se,te.id=Utils.randomString(),delete te.mminfo;var H=[{r:ee-a.length},{as:{start:te}},{is:UNICODE.IMAGE},{as:{end:DocUtil.getKeys(te)}}];p=DocOpBuilder.concise(DocOpBuilder.compose(p,DocOpBuilder.build(H)))}else{e.endWith=l;var M=ee-1,U=ee+1;if(r[ee]=te,a+=UNICODE.IMAGE,Re(s,M,U)&&n()){var H=[{r:U-a.length},{ds:UNICODE.PARA}];p=DocOpBuilder.concise(DocOpBuilder.compose(p,DocOpBuilder.build(H))),r[U]=d[U],a+=UNICODE.PARA}}}g=f.exec(s)}else g=f.exec(s)}return e.content=s,e.styles=d,e.backUpFormats=c,e.deletedCharInfos=r,e.deletedChars=a,e.finalOp=p,e}function be(){if(lt)return void MailMergeUtil.showMsg(J.i18n("writer.mailmerge.UPDATE_TEMPLATE_INPROGRESS"),3e3);lt=!0,MailMergeUtil.showMsg(J.i18n("writer.mailmerge.UPDATE_TEMPLATE_INPROGRESS"),3e3);var e={};Utils.setCsrfParam(e),J.ajax({type:"POST",global:!1,url:Utils.getUrl("mailmerge/updatetemplate"),async:!0,data:e,dataType:"json",success:function(e){lt=!1;var t=J.i18n("writer.mailmerge.UPDATE_TEMPLATE_SUCCESS");MailMergeUtil.showMsg(t,3e3)},error:function(e,t,i){lt=!1;var o=MailMergeUtil.getErrorMsg(e,J.i18n("writer.mailmerge.UPDATE_TEMPLATE_FAILURE"));MailMergeUtil.showMsg(o,3e3)}})}function Ae(e){rt=e.operation,"email"==rt&&(nt=e.emailField,Ct=e.subject),at=e.unsubscribeurl,Dt=e.from,It=e.to}function ye(){if(Dt<=It){if("email"==rt){var e=MailMergeDataModel.getRecordAt(Dt),t=e[nt];if(t.trim()){var i={};i.subject=MailMergeUtil.replaceFieldsInPlainText(Ct,e),i.email=t,i.html=MailMergeUtil.getProcessedHTML(rt,at),i.emailField=nt,parent.window.MailMerge.sendMergeRecordsAsEmail(Dt,It,i)}}else"download"!=rt&&"print"!=rt||(Pt=De());Dt++,Dt<=It?Te(Dt):ye()}else{if("download"==rt)Ce(Pt),setTimeout(function(){PubSub.publish("Document/beforePDFStart"),window.status="PaginationCompleted"},500);else if("email"==rt)parent.window.MailMerge.updateEmailStatus(Dt,It,void 0);else if("print"==rt){Ce(Pt),_docHead=document.createElement(NODE_NAME.HEAD);var o=document.getElementsByClassName("table-theme-style");o.length&&_docHead&&J(o).each(function(){_docHead.appendChild(this.cloneNode(!0))}),J(parent.window.document.head).append(_docHead.children),parent.window.PrintPreview.printUsingBrowser(!0)}PubSub.unsubscribe("DocOperation/CommandComplete",ye),PubSub.unsubscribe("Document/Restore",Nt)}}function De(){return editor.jeditorPane.children("div.zw-page").each(function(){J(Pt).append(J(this).clone())}),Pt=Utils.convertSVGToImg(Pt)}function Ce(e){editor.jeditorPane.find("div.zw-page").remove(),editor.jeditorPane.append(e.children())}var Ie,Pe,_e,Ne,Le,we,Me,Ue,xe,Fe,ke,Be,Je,He,Ge,ze,Ve,Ye,We,je,Ze,Xe,Ke,$e,qe,Qe,et,tt,it,ot,rt,nt,at,lt=!1,st={},dt=0,ct=1,pt=!1,ut=5e3,ft=[],gt=!1,mt="",ht=[],Tt={type:"separate",folderId:""},Et=!1,Rt=function(){PubSub.publish("QuickSeek/hideBarWithID","mergeField")},St=function(){Qe.show(),Qe.enable(),et.show(),et.enable(),tt.hide()},Ot={init:function(){Qe=J("#mm-createdoc-create"),et=J("#mm-createdoc-cancel"),tt=J("#mm-createdoc-close"),it=J("#mm-createdoc-fields"),ot=J("#mm-createdoc-filname"),R().folderId=editor.doc.getDocInfo().USER_ROOT_FOLDER_ID,le(),ot.off("keyup").on("keyup",St),St()},set:function(e,t,i){var o=e.action;"single"!=o&&"separate"!=o||("single"==o?it.zcombo("hide"):it.zcombo("show"),R().type=o),St()},get:function(e,t){return"separate"==e?"on":"mm-create-filename"==e?editor.doc.getDocInfo().DOCUMENT_NAME+"_":"mm-create-folder"==e?S(editor.doc.docInfo.USER_ROOT_FOLDER_ID):void 0}},vt={init:function(){var e={};"REMOTE"==editor.getEditorType()&&(e.rsid=RemoteEditor.rsid),Utils.setCsrfParam(e),J.ajax({type:"post",url:Utils.getUrl("mailmerge/"+MailMergeDataModel.getSource()+"/mail/limit"),data:e,dataType:"json",success:function(e){var t=e.MAIL_LIMIT,i=e.TOTAL_MAIL_LIMIT;MailMergeDataModel.setTotalMailLimit(i),MailMergeDataModel.setMailLimit(t)},error:function(e,t,i){}});var t=MailMergeUtil.getEmailFieldId(),i=J("#mailmerge-select-emailfldlist"),o=MailMergeDataModel.getFields();$(i,o,t,"email",void 0)}},bt=function(e){e&&e.target&&"emailmergeddocdlgzdialog"==e.target.id&&(Z("mailmergeIFrame").attr("src",""),PubSub.unsubscribe("Dialog/BeforeClose",bt))},At=function(e,t,i){var o={};o.count=e,o.limit=i,o.remaining=t,"REMOTE"!=editor.getEditorType()&&(Utils.setCsrfParam(o),J.ajax({type:"post",url:Utils.getUrl("mailmerge/mail/limit/exceeds"),data:o,dataType:"json",async:!0,success:function(e){},error:function(e,t,i){}}))},yt=function(){u(),MailMergeUtil.isMailMergeTemplateRole(editor.doc.getRole())?UIUtils.showBanner(J.i18n("writer.common.TEMPLATE_DOCUMENT")):MailMergeUtil.isMailMergeDocumentRole(editor.doc.getRole())&&UIUtils.showBanner(J.i18n("writer.mailmerge.MAILMERGE_DOCUMENT"))},Dt=0,Ct="",It=0,Pt=J(document.createElement("fragment")),_t=!1,Nt=function(){try{J.dialogutil.close("restoredocument"),_t=!0;var e=h(),t={};t.content=e,t.info=editor.doc.getDocInfo(),u(e),editor.loadDocument(t),ye()}catch(e){Nt()}},Lt=function(){gt?(u(),Te(0,mt),gt=!1,mt=""):rt&&!_t&&(PubSub.subscribe("DocOperation/CommandComplete",ye),PubSub.subscribe("Document/Restore",Nt),m(),Te(Dt))};window.MailMerge={init:A,initStep2:D,openEmailMergedDlg:fe,mergeToNewDocument:ce,importCSVData:H,insertMergeFields:x,finishMerge:ge,previewMergedDoc:W,backToEditor:oe,updateTemplate:be,downloadRecord:re,printRecord:ne,getCurrentRecordIdx:l,setDocContent:u,setMailMergeDetails:Ae,insertMergeFieldInSubject:ue,isPreviewMode:c,populateRecordsInPreviewListing:q,toggleBlankLine:r,sendMergeRecordsAsEmail:he,updateEmailStatus:me,getClientRenderedHTML:De,showURLInputField:i,getLatestFields:V,showFoldersChooser:se,populateFieldsInEmailDialog:pe,process:Y,addMergeField:N,modifyMergeField:k,removeMergeField:F,getDocContent:f,deleteMailMergeData:G,toggleBuildIndFields:o,createDataSource:B},PubSub.subscribe("Document/LoadingComplete",Lt),PubSub.subscribe("Document/AfterInit",yt)}(),PageLayoutPanel.prototype={pageInfo:{init:function(){bodyFormat=editor.doc.getBodyFormat(),editor.isOffline()&&J("#watermark-div").hide()},get:function(e,t){e=e.action;var i,o,r=4*Conversions.factor,n=22*Conversions.factor,a=J(t),l=(.2*Conversions.factor,editor.doc.getBodyFormat());if(J("#pgformat_clrfld").one("colorfieldcolorselected",function(e,t){return l[ATTR_BODY.DS_BGC]}),Conversions.isInInches&&(o=.1),Conversions.isInMM&&(o=1),"paperSize"==e)return PageLayoutPanel.paperSize=l[ATTR_BODY.DS_PS],"Custom"==PageLayoutPanel.paperSize?J("#page-lpnl-custom").show():J("#page-lpnl-custom").hide(),PageLayoutPanel.paperSize;if("pWidth"==e)return PageLayoutPanel.pWidth=Conversions.toGlobalUnit(l[ATTR_BODY.DS_PW]),a.zspinner("setMinValue",r).zspinner("setMaxValue",n).zspinner("setStepValue",o).zspinner("setUnit",Conversions.showUnit),PageLayoutPanel.pWidth;if("pWidthSpec"==e)return PageLayoutPanel.pWidth=Conversions.toGlobalUnit(l[ATTR_BODY.DS_PW]),PageLayoutPanel.pWidth;if("pHeight"==e)return PageLayoutPanel.pHeight=Conversions.toGlobalUnit(l[ATTR_BODY.DS_PH]),a.zspinner("setMinValue",r).zspinner("setMaxValue",n).zspinner("setStepValue",o).zspinner("setUnit",Conversions.showUnit),PageLayoutPanel.pHeight;if("pHeightSpec"==e)return PageLayoutPanel.pHeight=Conversions.toGlobalUnit(l[ATTR_BODY.DS_PH]),PageLayoutPanel.pHeight;if("columnCount"==e){PageLayoutPanel.attr[ATTR_BODY.DS_COLCOLS]=ViewManager.getColumnFormat(),PageLayoutPanel.newattr[ATTR_BODY.DS_COLCOLS]={};var s=ViewManager.getColumnFormat(),d=s.count,c=s.iseqwidth;if(2==d&&!c){var p=parseInt(s.width[0].convertor().pixels),u=parseInt(s.width[1].convertor().pixels);if(2*p==u)return"100";if(p==2*u)return"101"}return d.toString()}if("Orientation"==e)return PageLayoutPanel.Orientation=l[ATTR_BODY.DS_OR],PageLayoutPanel.updatePgOrientationLabel(),J("input:radio[name='Orientation'][value='"+PageLayoutPanel.Orientation+"']").zstatebutton("checked",!0),PageLayoutPanel.Orientation;if("defaultMargins"==e){var f=PageLayoutPanel.getMarginType();if("custom"!=f){var g=["narrow","normal","moderate","wide"],m=["0.5in/0.5in","1.0in/1.0in","0.75in/1.0in","2.28in/1.0in"];f=m[g.indexOf(f)]}else J("#page-lpnl-custommargin").show();return f}if(0==e.indexOf("margin")){var n=editor.doc.getPaperWidth(!0)/Conversions.globalUnitInPx*.4,r=0;Utils.isEmptyHeader()||(r=24/Conversions.globalUnitInPx);var o=Conversions.step;if(n-=n%o,r-=r%o,a.zspinner("setMinValue",r).zspinner("setMaxValue",n).zspinner("setUnit",Conversions.showUnit),"marginLeft"==e){var h=Conversions.toGlobalUnit(l[ATTR_BODY.DS_ML]);return PageLayoutPanel.attr[ATTR_BODY.DS_ML]=PageLayoutPanel.newattr[ATTR_BODY.DS_ML]=h+Conversions.globalUnit,i=a.zspinner("getValue")%o,0!==i&&(o-=i),a.zspinner("setStepValue",o),h}if("marginRight"==e){var T=Conversions.toGlobalUnit(l[ATTR_BODY.DS_MR]);return PageLayoutPanel.attr[ATTR_BODY.DS_MR]=PageLayoutPanel.newattr[ATTR_BODY.DS_MR]=T+Conversions.globalUnit,i=a.zspinner("getValue")%o,0!==i&&(o-=i),a.zspinner("setStepValue",o),T}if("marginBottom"==e){var E=Conversions.toGlobalUnit(l[ATTR_BODY.DS_MB]);return E<=.2?J("#footerBottom").zspinner("disable"):J("#footerBottom").zspinner("enable"),PageLayoutPanel.attr[ATTR_BODY.DS_MB]=PageLayoutPanel.newattr[ATTR_BODY.DS_MB]=E+Conversions.globalUnit,i=a.zspinner("getValue")%o,0!==i&&(o-=i),a.zspinner("setStepValue",o),E}if("marginTop"==e){var R=Conversions.toGlobalUnit(l[ATTR_BODY.DS_MT]);return R<=.2?J("#headerTop").zspinner("disable"):J("#headerTop").zspinner("enable"),PageLayoutPanel.attr[ATTR_BODY.DS_MT]=PageLayoutPanel.newattr[ATTR_BODY.DS_MT]=R+Conversions.globalUnit,i=a.zspinner("getValue")%o,0!==i&&(o-=i),a.zspinner("setStepValue",o),R}}else{if("BGCOLOR"==e){var S=l[ATTR_BODY.DS_BGC];return S||(S="rgb(255,255,255)"),PageLayoutPanel.attr[ATTR_BODY.DS_BGC]=PageLayoutPanel.newattr[ATTR_BODY.DS_BGC]=S,PageLayoutPanel.bgColor=Utils.getColorValFromRefString(S),PageLayoutPanel.bgColor}if("headerTop"===e){PageLayoutPanel.updateHFMaxValue(l[ATTR_BODY.DS_MT],t);var O=Conversions.toGlobalUnit(l[ATTR_BODY.DS_HT]);return PageLayoutPanel.attr[ATTR_BODY.DS_HT]=PageLayoutPanel.newattr[ATTR_BODY.DS_HT]=O+Conversions.globalUnit,n=Conversions.toGlobalUnit(PageLayoutPanel.attr[ATTR_BODY.DS_MT])-Conversions.toGlobalUnit('0.25"'),a.zspinner("setMaxValue",n),O}if("footerBottom"===e){PageLayoutPanel.updateHFMaxValue(l[ATTR_BODY.DS_MB],t);var v=Conversions.toGlobalUnit(l[ATTR_BODY.DS_FB]);return PageLayoutPanel.attr[ATTR_BODY.DS_FB]=PageLayoutPanel.newattr[ATTR_BODY.DS_FB]=v+Conversions.globalUnit,n=Conversions.toGlobalUnit(PageLayoutPanel.attr[ATTR_BODY.DS_MB])-Conversions.toGlobalUnit('0.25"'),a.zspinner("setMaxValue",n),v}if("checkbox"==e)return"REMOTE"==editor.getEditorType()||"TEMPLATEUSER"==editor.doc.getRole()||editor.isOffline()?J("#page-lpnl-default").hide():"EXTERNAL_SHAREDREADWRITE"!==editor.doc.getRole()&&"ANYONELINK_SHAREDREADWRITE"!==editor.doc.getRole()||J("#page-lpnl-default").hide(),!1}},set:function(e,t,i){var o,r=Conversions.step,n=J(i);arguments[5].keyCode&&arguments[5].keyCode==KEYS.TAB?EventHandler.isDialogFocused=!0:EventHandler.isDialogFocused=!1,"checkbox"!=e.action&&J("#pl_makedefault").prop("checked",!1);var o,a=4*Conversions.factor,l=22*Conversions.factor,n=J(i),s=Conversions.globalUnit,r=Conversions.step;if("paperSize"==e.action){if("Custom"==t)return void J("#page-lpnl-custom").show();J("#page-lpnl-custom").hide();var d=PageLayoutPanel.getDimension(t,s,PageLayoutPanel.Orientation),c=PageLayoutPanel.isColumnFitToSize(d.width);if(!c)return J("#page-lpnl-pagesizelist").zcombo("setValue",PageLayoutPanel.PaperSize),void PubSub.publish("Document/Warning",WARNING_MSG.COLUMN_WIDTH_IS_LESS,3);PageLayoutPanel.paperSize=t,J("#pHeight").zspinner("setValue",d.height),J("#pWidth").zspinner("setValue",d.width),PageLayoutPanel.pHeight=d.height,PageLayoutPanel.pWidth=d.width}else if("pWidth"==e.action)t=t<a&&a||t,t=t>l&&l||t,PageLayoutPanel.pWidth=t,J("#widthSpec").text(parseFloat(PageLayoutPanel.pWidth).toFixed(2)),PageLayoutPanel.paperSize=PageLayout.getPaperSize(PageLayoutPanel.pWidth,PageLayoutPanel.pHeight,s),PageLayoutPanel.Orientation="Portrait",parseFloat(PageLayoutPanel.pHeight)<parseFloat(PageLayoutPanel.pWidth)&&(PageLayoutPanel.Orientation="Landscape"),J("input[value="+PageLayoutPanel.Orientation+"]").attr("checked","true");else if("pHeight"==e.action)t=t<a&&a||t,t=t>l&&l||t,PageLayoutPanel.pHeight=t,J("#heightSpec").text(parseFloat(PageLayoutPanel.pHeight).toFixed(2)),PageLayoutPanel.paperSize=PageLayout.getPaperSize(PageLayoutPanel.pWidth,PageLayoutPanel.pHeight,s),PageLayoutPanel.Orientation="Portrait",parseFloat(PageLayoutPanel.pHeight)<parseFloat(PageLayoutPanel.pWidth)&&(PageLayoutPanel.Orientation="Landscape"),J("input[value="+PageLayoutPanel.Orientation+"]").attr("checked","true");else if("columnCount"==e.action){Utils.addToStatistics("Multi_Column"),t=n.attr("value");var p=parseInt(t,10),u=[],f=[],g=!0,m=Conversions.toGlobalValue("0.5in"),h="";if(100==p?(p=2,h="left",g=!1):101==p&&(p=2,h="right",g=!1),!g){var T=editor.doc.getPaperWidth()-2;T-=(p-1)*m.convertor().pixels,T/=p+1,"left"==h?(u[0]=Conversions.toGlobalValue(T+"px"),u[1]=Conversions.toGlobalValue(2*T+"px")):"right"==h&&(u[0]=Conversions.toGlobalValue(2*T+"px"),u[1]=Conversions.toGlobalValue(T+"px")),f.push(m)}PageLayoutPanel.newattr[ATTR_BODY.DS_COLCOLS]={},PageLayoutPanel.newattr[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLCOUNT]=p,PageLayoutPanel.newattr[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLWID]=u,PageLayoutPanel.newattr[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLSPACE]=f,PageLayoutPanel.newattr[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLSEP]="0",PageLayoutPanel.newattr[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_DEFAULTSPACE]=m,PageLayoutPanel.newattr[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLISEQWID]=g}else{if("Orientation"==e.action)return t=n.attr("value"),void editor.doc.execCmd("changeOrientation",t);if("columnSpace"==e.action)PageLayoutPanel.ColSpace=t,PageLayoutPanel.updateMaxColumnGap();else{if("defaultMargins"==e.action)return"custom"==t?void J("#page-lpnl-custommargin").show():(J("#page-lpnl-custommargin").hide(),void PageLayoutPanel.ApplyDefMarginValue(t));if("marginLeft"==e.action)o=t%r,0!=o&&(r-=o),n.zspinner("setStepValue",r),PageLayoutPanel.newattr[ATTR_BODY.DS_ML]=t+Conversions.globalUnit;else if("marginRight"==e.action)o=n.zspinner("getValue")%r,0!=o&&(r-=o),n.zspinner("setStepValue",r),PageLayoutPanel.newattr[ATTR_BODY.DS_MR]=t+Conversions.globalUnit;else if("marginTop"==e.action){o=n.zspinner("getValue")%r,0!=o&&(r-=o),n.zspinner("setStepValue",r);var E=J("#headerTop");t<=.2?E.zspinner("disable"):E.zspinner("enable"),PageLayoutPanel.updateHFMaxValue(t+Conversions.globalUnit,E),PageLayoutPanel.newattr[ATTR_BODY.DS_MT]=t+Conversions.globalUnit}else if("marginBottom"==e.action){o=n.zspinner("getValue")%r,0!=o&&(r-=o),n.zspinner("setStepValue",r);var R=J("#footerBottom");t<=.2?R.zspinner("disable"):R.zspinner("enable"),PageLayoutPanel.updateHFMaxValue(t+Conversions.globalUnit,R),PageLayoutPanel.newattr[ATTR_BODY.DS_MB]=t+Conversions.globalUnit}else"headerTop"===e.action?(o=n.zspinner("getValue")%r,0!==o&&(r-=o),n.zspinner("setStepValue",r),PageLayoutPanel.newattr[ATTR_BODY.DS_HT]=t+Conversions.globalUnit):"footerBottom"===e.action?(o=n.zspinner("getValue")%r,0!==o&&(r-=o),n.zspinner("setStepValue",r),PageLayoutPanel.newattr[ATTR_BODY.DS_FB]=t+Conversions.globalUnit):"BGCOLOR"==e.action?("transparent"==t&&(t=arguments[4].color="rgb(255, 255, 255)",arguments[4].color="rgb(255,255,255)"),document.getElementById("pagebgcolorhelper").innerHTML=zoho.color.rgbToHex(t),PageLayoutPanel.newattr[ATTR_BODY.DS_BGC]=Utils.getColorReference(arguments[4]),PageLayoutPanel.bgColor=t):"checkbox"==e.action&&(t?PageLayoutPanel.checked=!0:PageLayoutPanel.checked=!1)}}PageLayoutPanel.apply()}},isColumnFitToSize:function(e){var t=editor.doc.getBodyFormat(),i=ViewManager.getColumnFormat(),o=i.iseqwidth,r=(i.width,i.space),n=i.count;if(o&&n>1){var e=e,a=Conversions.toGlobalUnit(t[ATTR_BODY.DS_ML]),l=Conversions.toGlobalUnit(t[ATTR_BODY.DS_MR]),s=parseFloat(Conversions.toGlobalValue(CONST.MIN_COLUMN_WIDTH))*n,d=parseFloat(r[0])*(n-1),c=s+d+l+a;return!(c>e)}return!0},apply:function(){var e=J("#pagelayout_ui").zvalidation("validateAllFields",J("#pagelayout_ui")),t=!1;if(e){var i=editor.doc.getBodyFormat(),o=editor.doc.getSelection().parents(NODE_TYPE.BODY),r={};if(r[ATTR_BODY.DS_PS]=PageLayoutPanel.paperSize,r[ATTR_BODY.DS_PW]=PageLayoutPanel.pWidth+Conversions.globalUnit,r[ATTR_BODY.DS_PH]=PageLayoutPanel.pHeight+Conversions.globalUnit,r[ATTR_BODY.DS_OR]=PageLayoutPanel.Orientation,0!=DocUtil.getKeys(PageLayoutPanel.newattr.cols).length&&(PageLayoutPanel.isColumnChanged=!1,r[ATTR_BODY.DS_COLCOLS]=PageLayoutPanel.newattr.cols),r[ATTR_BODY.DS_BGC]=PageLayoutPanel.newattr[ATTR_BODY.DS_BGC],r[ATTR_BODY.DS_ML]=PageLayoutPanel.newattr[ATTR_BODY.DS_ML],r[ATTR_BODY.DS_MR]=PageLayoutPanel.newattr[ATTR_BODY.DS_MR],r[ATTR_BODY.DS_MT]=PageLayoutPanel.newattr[ATTR_BODY.DS_MT],r[ATTR_BODY.DS_MB]=PageLayoutPanel.newattr[ATTR_BODY.DS_MB],r[ATTR_BODY.DS_HT]=PageLayoutPanel.newattr[ATTR_BODY.DS_HT],r[ATTR_BODY.DS_FB]=PageLayoutPanel.newattr[ATTR_BODY.DS_FB],U.each(r,function(e,t){e&&e!==i[t]||delete r[t]}),U.isEmpty(r)||(editor.doc.execCmd("applyStyle",[o,r,"updatePageLayout"]),J("#pglayout_clrfld").data("selectedColor",PageLayoutPanel.newattr[ATTR_BODY.DS_BGC]),PageLayoutPanel.updateMarginAndSize()),PageLayoutPanel.checked){var n={};n[ATTR_BODY.DS_PH]=PageLayoutPanel.pHeight+Conversions.globalUnit,n[ATTR_BODY.DS_PW]=PageLayoutPanel.pWidth+Conversions.globalUnit,n[ATTR_BODY.DS_BGC]=PageLayoutPanel.newattr[ATTR_BODY.DS_BGC],n[ATTR_BODY.DS_ML]=PageLayoutPanel.newattr[ATTR_BODY.DS_ML],n[ATTR_BODY.DS_MR]=PageLayoutPanel.newattr[ATTR_BODY.DS_MR],n[ATTR_BODY.DS_MT]=PageLayoutPanel.newattr[ATTR_BODY.DS_MT],n[ATTR_BODY.DS_MB]=PageLayoutPanel.newattr[ATTR_BODY.DS_MB],n[ATTR_BODY.DS_HT]=PageLayoutPanel.newattr[ATTR_BODY.DS_HT],n[ATTR_BODY.DS_FB]=PageLayoutPanel.newattr[ATTR_BODY.DS_FB];for(var a in w_usersettings)if(t||"undefined"==typeof n[a]||n[a]==w_usersettings[a]){if(t)break}else t=!0;t&&(Settings.updateUserSettings(n),Utils.setCsrfParam(n),Utils.updateCaptchaInfo(n,hipurl),J.ajax({type:"POST",url:Utils.getNiceUrlPrefix("user/settings/pagelayout"),data:n,success:function(){J.dialogutil.close("pagelayout")},error:function(e){if(500===e.status){var t=jQuery.parseJSON(J.trim(e.responseText));t&&t.errorCode&&"I5003"===t.errorCode&&(hipurl=t.parameterName,Utils.handleCaptcha(hipurl))}}})),PageLayoutPanel.checked=!1}}},open:function(){Utils.addToStatistics("Fm_pgLyOut"),LayoutManager.isRichEditActive()?LeftPanel.showSubPanel(ELEM_ID.PAGELAYOUTPANEL,ANIMATIONS.FADEIN):LayoutManager.toggleRichEdit("open",ELEM_ID.PAGELAYOUTPANEL),PageLayoutPanel.updatePanel(),PageLayoutPanel.updateMarginAndSize()}},PageLayoutPanel.prototype.changeOrientation=function(e){if(e){Utils.addToStatistics("pg_or");var t=editor.doc.getSelection().parents(NODE_TYPE.BODY),i=t.attr("*");if(i[ATTR_BODY.DS_OR]!=e){var o=i[ATTR_BODY.DS_PS],r=PageLayout.Paper[o],n="in"==Conversions.globalUnit?"inch":Conversions.globalUnit,a=r[e].width[n]+Conversions.globalUnit,l=r[e].height[n]+Conversions.globalUnit,s={};o&&"Custom"==o&&(a=parseFloat(i[ATTR_BODY.DS_PH])+Conversions.globalUnit,l=parseFloat(i[ATTR_BODY.DS_PW])+Conversions.globalUnit),s[ATTR_BODY.DS_OR]=e,s[ATTR_BODY.DS_PW]=a,s[ATTR_BODY.DS_PH]=l,s[ATTR_BODY.DS_PS]=o,editor.doc.execCmd("applyStyle",[t,s])}}},PageLayoutPanel.prototype.getMarginType=function(){Utils.addToStatistics("pg_margin");var e=Conversions.toGlobalUnit(editor.doc.getBodyFormat().ml),t=Conversions.toGlobalUnit(editor.doc.getBodyFormat().mr),i=Conversions.toGlobalUnit(editor.doc.getBodyFormat().mt),o=Conversions.toGlobalUnit(editor.doc.getBodyFormat().mb);return e===t&&i===o?.5===e&&.5===i||12.7===e&&12.7===i?"narrow":1===e&&1===i||25.4===e&&25.4===i?"normal":.75===e&&1===i||19.05===e&&25.4===i?"moderate":2.28===e&&1===i||57.912===e&&25.4===i?"wide":"custom":"custom"},PageLayoutPanel.prototype.ApplyDefMarginValue=function(e){if(e){var t=editor.doc.getSelection().parents(NODE_TYPE.BODY),i=e.split("/"),o={};PageLayoutPanel.newattr[ATTR_BODY.DS_ML]=PageLayoutPanel.newattr[ATTR_BODY.DS_MR]=i[0],PageLayoutPanel.newattr[ATTR_BODY.DS_MT]=PageLayoutPanel.newattr[ATTR_BODY.DS_MB]=i[1],o[ATTR_BODY.DS_ML]=o[ATTR_BODY.DS_MR]=i[0],o[ATTR_BODY.DS_MT]=o[ATTR_BODY.DS_MB]=i[1],editor.doc.execCmd("applyStyle",[t,o,"updatePageMargin"])}},PageLayoutPanel.prototype.updatePgOrientationLabel=function(){var e="Landscape"==PageLayoutPanel.Orientation?J.i18n("writer.common.LANDSCAPE"):J.i18n("writer.common.PORTRAIT");J("#page-lpnl-orientationbtn").text(e)},PageLayoutPanel.prototype.getDimension=function(e,t,i){"in"==t&&(t="inch");var o=PageLayout.Paper[e][i].height[t],r=PageLayout.Paper[e][i].width[t];return{height:o,width:r}},PageLayoutPanel.prototype.updateHFMaxValue=function(e,t){var i=e.convertor().pixels,o=(i-24)/Conversions.globalUnitInPx,r=Conversions.step;o-=o%r,o<0&&(o=0),J(t).zspinner("setMinValue",0).zspinner("setMaxValue",o).zspinner("setStepValue",r).zspinner("setUnit",Conversions.showUnit)},PageLayoutPanel.prototype.updateMaxColumnGap=function(){var e=Conversions.globalUnit;"in"==e&&(e="inch");var t=PageLayoutPanel.paperSize,i=PageLayoutPanel.pWidth,o=(PageLayoutPanel.Orientation,"mm"==e?1/25.4:1),r=editor.doc.getBodyFormat(),n=r[ATTR_BODY.DS_OR];if("inch"!=e&&"Custom"!=t?i="Portrait"==PageLayoutPanel.Orientation?PageLayout.Paper[t][n].width.inch:PageLayout.Paper[t][n].height.inch:"inch"!=e&&"Custom"==t&&(i*=o),!(isNaN(i)||22<i||i<=0)){var a=r.ml.convertor().inches,l=(J('#columnCount li [class $="_selected"]'),PageLayoutPanel.columnCount),s=r.mr.convertor().inches,d=.5,c=i-(a+d*l+s),p=1==l?c:c/(l-1);p="mm"==e?25.4*p:p,J("#columnSpace").zspinner("setMaxValue",p),1==l?J("#column-lpnl-colspace").parent().hide():p>0&&J("#column-lpnl-colspace").text(p.toFixed(2)+" "+Conversions.showUnit).parent().show()}},PageLayoutPanel.prototype.updateMarginAndSize=function(){var e,t,i,o,r,n;if(Conversions.globalUnit===UNITS.INCHES)r="inches",n="inches";else{if(Conversions.globalUnit!==UNITS.MILLIMETERS)return;r="mm",n="millimeters"}e=Conversions.toGlobalValue(editor.doc.bodyFormat.mt),t=Conversions.toGlobalValue(editor.doc.bodyFormat.ml),i=Conversions.toGlobalValue(editor.doc.bodyFormat.mb),o=Conversions.toGlobalValue(editor.doc.bodyFormat.mr),e="string"==typeof e?e.convertor()[n].toFixed(2):e,t="string"==typeof t?t.convertor()[n].toFixed(2):t,i="string"==typeof i?i.convertor()[n].toFixed(2):i,o="string"==typeof o?o.convertor()[n].toFixed(2):o;for(var a in PageLayoutPanel.marginsJson){var l=PageLayoutPanel.marginsJson[a];if("custom"===a)J("#"+a+"_"+s).html(e+r);else for(var s in l)J("#"+a+"_"+s).html(l[s][r])}for(var d in PageLayoutPanel.pgLayoutJson)J("#"+d).html(PageLayoutPanel.pgLayoutJson[d][r]);var c=PageLayoutPanel.paperSize||editor.doc.getBodyFormat()[ATTR_BODY.DS_PS];J("#page-lpnl-pagesizelist").zcombo("setValue",c)},PageLayoutPanel.updateOrientationMenu=function(e,t){var i=editor.doc.createElement(NODE_TYPE.BODY);J("#orientationmenu").zmenu("check","#or_"+i.attr(ATTR_BODY.DS_OR))},PageLayoutPanel.prototype.updatePageSizeMenu=function(e,t){var i=J("#page-lpnl-pagesizelist"),o=editor.doc.createElement(NODE_TYPE.BODY);i.zmenu(),"Custom"!=o.attr(ATTR_BODY.DS_PS)?i.zmenu("check","#ps_"+o.attr(ATTR_BODY.DS_PS)):i.zmenu("checkAllItems",!1)},PageLayoutPanel.prototype.changePageBackgroundColor=function(){var e=editor.doc.getSelection().parents(NODE_TYPE.BODY),t="transparent"==ui.color?"white":Utils.getColorReference(ui);JPageBckGrdClr.children("span:first").css({"border-bottom":"2px solid "+ui.color});var i={};i[ATTR_BODY.DS_BGC]=t,editor.doc.execCmd("applyStyle",[e,i])},PageLayoutPanel.prototype.updatePanel=function(){var e=document.getElementById("subpanel-pagelayout");if(e){var t=J(e);t.data("ztrackObject")?LeftPanel.isPanelVisible(ELEM_ID.PAGELAYOUTPANEL)&&t.ZCtrackObjects("refreshValues"):t.ZCtrackObjects({callbacks:PageLayoutPanel.pageInfo,fillVisible:!1,eventNameMapping:{zspinner:"spinnerblur"}})}},PageLayoutPanel=new PageLayoutPanel,QuickStyle=function(){"use strict";var e={},t={},i="",o="",r=[],n=!1,a={},l=!1,s=function(e){var t=editor.doc.getSelection().parents(NODE_TYPE.BODY);if(e.hasOwnProperty(ATTR_BODY.DS_STYLES)){var i=e[ATTR_BODY.DS_STYLES][ATTR_BODY.DS_PARA],o=DocUtil.copyStyle(i),n=r.length?r:U.range(7);for(DocUtil.constructRenderingFormat(o);n.length;){var a=n.pop();g(a,o)}}t.attr(e)},d=function(){var e=editor.doc.getSelection().parents(NODE_TYPE.PARAGRAPH),t=editor.doc.getRawFormatAt(e.getEnd()-1),i=t[ATTR_PARAGRAPH.PS_HD],i="undefined"==typeof i?0:i,o=OrigDocStyleObject.para.h0;if(0!=i){var r=OrigDocStyleObject.para["h"+i];o=Utils.mergeObjs([o,r])}return t=Utils.mergeObjs([o,t]),shouldNotCarryParaStyle.filter(function(e){delete t[e]}),t},c=function(){var e=editor.doc.getSelection().parents(NODE_TYPE.PARAGRAPH),t=e.attr(ATTR_PARAGRAPH.PS_HD),t="undefined"==typeof t?0:t,i=DocUtil.copyStyle(editor.doc.getSelection().textFormat);shouldNotCarryTextStyle.filter(function(e){delete i[e]});var o=OrigDocStyleObject.para.h0.textFormat;if(0!=t){var r=OrigDocStyleObject.para["h"+t].textFormat;o=Utils.mergeObjs([o,r])}return i=Utils.mergeObjs([o,i])},p=function(e,t){var i,o,r=[];t&&(i=DesignSets[t].styles.para["h"+e],o=i.textFormat,r=Utils.stringToFonts(o[ATTR_TEXT.TS_FF])||[]),UIUtils.showLoadingMsg(J.i18n("common","LOADING")),Utils.log("@onBeforeUpdateHeadingStyle-->addFonts"),editor.addFonts(r,function(){UIUtils.hideLoadingMsg(),editor.doc.execCmd("updateHeadingStyle",[e,t])})},u=function(e,t){var i,o;t&&(i=DocUtil.copyStyle(DesignSets[t].styles.para["h"+e]),o=i.textFormat);var n={paraStyle:i||d(),textStyle:o||c()},a=editor.doc.getSelection().parents(NODE_TYPE.BODY),p=a.attr(ATTR_BODY.DS_STYLES),u=p[ATTR_BODY.DS_PARA],f={};if("undefined"==typeof e){var g=editor.doc.getSelection().parents(NODE_TYPE.PARAGRAPH);e=g.attr(ATTR_PARAGRAPH.PS_HD)||0}DocUtil.applyHeadingForSelection(e),U.isEmpty(n.paraStyle)||(u["h"+e]=n.paraStyle),U.isEmpty(n.textStyle)||(u["h"+e].textFormat=n.textStyle),r.push(e),p[ATTR_BODY.DS_PARA]=u,p.name="",f[ATTR_BODY.DS_STYLES]=p,s(f),l&&E(f),J.dialogutil.close("savenormaltemplate")},f=function(){var e=["main",CONST.HEADER_PRIMARY,CONST.FOOTER_PRIMARY],t=editor.doc.getHeaderType();return t!==HEADER_FOOTER_TYPE.DIFF_FIRST_PAGE&&t!==HEADER_FOOTER_TYPE.DIFF_FIRST_ODD_EVEN_PAGE||(e.push(CONST.HEADER_FIRST),e.push(CONST.FOOTER_FIRST)),t!==HEADER_FOOTER_TYPE.DIFF_ODD_EVEN_PAGE&&t!==HEADER_FOOTER_TYPE.DIFF_FIRST_ODD_EVEN_PAGE||(e.push(CONST.HEADER_EVEN),e.push(CONST.FOOTER_EVEN)),e},g=function(e,t){if(U.isUndefined(e))return null;var i=f(),o=t.h0;0!=e&&(o=Utils.mergeObjs([o,t["h"+e]]));var r=(o.textFormat,function(t){var i=t.attr("*"),o=parseInt(i[ATTR_PARAGRAPH.PS_HD]),r=i[ATTR_PARAGRAPH.LS_DATA],o=o?o:0;if(o==e){var n={ps_null:!0,hd:o};r&&(n[ATTR_PARAGRAPH.LS_DATA]=r,n[ATTR_PARAGRAPH.PS_ML]=i[ATTR_PARAGRAPH.PS_ML],n[ATTR_PARAGRAPH.PS_TI]=i[ATTR_PARAGRAPH.PS_TI],n[ATTR_PARAGRAPH.PS_TYPE]=i[ATTR_PARAGRAPH.PS_TYPE]),t.attr(n);var a=editor.doc.getTextNodesInSelection(t.getStart(),t.getEnd()-1);U.each(a,function(e){o?e.attr({ts_null:!0}):e.attr({ff:"",size:""})},this)}});U.each(i,function(e){var t=editor.doc.getSelection().getNodesInSection(e,NODE_TYPE.PARAGRAPH);U.each(t,r,this)},this)},m=function(){var e={};e[ATTR_BODY.DS_STYLES]=DocUtil.copyStyle(DefaultStyles),s(e)},h=function(){editor.doc.execCmd("resetStyle")},T=function(){return t.saveToCustom&&""===i.trim(),!(isThemeNameExist(i)&&!confirm(J.i18n("writer.styles.NAMEALREADYEXIST")))&&(y(),void applyDocumentStyle())},E=function(e){e=e?e:{};var t=editor.doc.getSelection().parents(NODE_TYPE.BODY),i=e.hasOwnProperty(ATTR_BODY.DS_STYLES)?e[ATTR_BODY.DS_STYLES]:t.attr(ATTR_BODY.DS_STYLES);e[ATTR_BODY.DS_STYLES]={font:i.para,char:i.char,table:i.table,shape:i.table,name:i.name},e[ATTR_BODY.DS_STYLES]=JSON.stringify(e[ATTR_BODY.DS_STYLES]);var o=e.hasOwnProperty(ATTR_BODY.DS_THEME)?e[ATTR_BODY.DS_THEME]:t.attr(ATTR_BODY.DS_THEME);e[ATTR_BODY.DS_THEME]=JSON.stringify(o),csrfParamName&&(e[csrfParamName]=getcsrf()),J.post(Utils.getNiceUrlPrefix("user/settings/defthemeandstyles"),e)},R=function(){p(0)},S=function(e){var i={},o={font:t[ATTR_BODY.DS_STYLES].para,color:{},styles:{},char:t[ATTR_BODY.DS_STYLES].char};i[ATTR_BODY.DS_STYLES]=JSON.stringify(o),i.action="defaultTextStyles",csrfParamName&&(i[csrfParamName]=getcsrf()),J.post(Utils.getContextUrl("savesettings.do"),i)},O=function(){J.dialogutil.open("savenormaltemplate",J("#savenormaltemplate"),v)},v={set:function(e,t,i){"makeDef"==e.action&&(l=t)},init:function(){l=!1;var e=editor.doc.getSelection().parents(NODE_TYPE.PARAGRAPH),t=e.attr(ATTR_PARAGRAPH.PS_HD);t=t?t:0;var i=J.i18n("writer.styles.DO_YOU_WANT_THE_FOLLOWING_STYLE_SET")+" "+J.i18n("writer.styles.TO")+" "+(0===t?J.i18n("writer.styles.NORMALTEXT"):J.i18n("writer.styles.HEADING")+" "+t)+" ?";J(".ui-template-imfo").text(i);var o=(DocUtil.copyStyle(OrigDocStyleObject.para["h"+t]),editor.doc.getSelection().computedTextFormat),r=editor.doc.getSelection().paraFormat;DocUtil.constructRenderingFormat(o);var n={ff:J.i18n("writer.format.FONT"),fw:J.i18n("writer.format.BOLD"),cs:J.i18n("writer.format.CHARACTER_SPACING"),fs:J.i18n("writer.format.ITALIC"),size:J.i18n("writer.format.FONT_SIZE"),va:J.i18n("writer.format.VERTICAL_ALIGN"),td:J.i18n("writer.format.TEXT_DECORATION")},a=J(".textstyleinfo");for(var s in o){var d=document.createElement("div"),c=o[s];if(c){var p="",u="";if(U.has(n,s))"ff"==s&&(c=c.substr(0,c.indexOf(",")!=-1?c.indexOf(","):c.length).capitalize()),"fw"!=s&&"fs"!=s||(c=c.indexOf("none")!=-1?J.i18n("writer.common.NONE"):J.i18n("writer.common.YES")),"va"==s&&(c=c.replaceAll("super",J.i18n("writer.format.SUPERSCRIPT")),c=c.replaceAll("sub",J.i18n("writer.format.SUBSCRIPT"))),p='<span class="ui-def-style-prop">'+n[s]+" : </span>",u='<span class="ui-def-style-val">'+c+"</span>";else if(s==ATTR_TEXT.TS_TD)c.indexOf("line-through")==-1&&c.indexOf("underline")==-1||(c=c.replaceAll("line-through",J.i18n("writer.format.STRIKETHROUGH")),c=c.replaceAll("underline",J.i18n("writer.format.UNDERLINE")),c=c.replaceAll("none",J.i18n("writer.common.NONE")),p='<span class="ui-def-style-prop">'+n[s]+" : </span>",u='<span class="ui-def-style-val">'+c+"</span>");else{if(s!=ATTR_TEXT.TS_FGC&&s!=ATTR_TEXT.TS_BGC)continue;p='<span class="ui-def-style-prop">'+(s==ATTR_TEXT.TS_FGC?J.i18n("writer.format.FONT_COLOR")+" : ":J.i18n("writer.format.BACKGROUND_COLOR")+" : ")+"</span>",u='<span class="ui-def-style-val">'+c+'<div style="margin-left: 5px;vertical-align: middle;display:inline-block;height:10px;width:10px;background-color:'+c+';"><div></span>'}var f=J(p),g=J(u);J(d).append(f,g),J(d).appendTo(a)}}var m={bw:J.i18n("writer.format.BORDER_WIDTH"),dir:J.i18n("writer.format.DIRECTION"),sa:J.i18n("writer.format.SPACE_AFTER"),sb:J.i18n("writer.format.SPACE_BEFORE"),ml:J.i18n("writer.format.MARGIN_LEFT"),mr:J.i18n("writer.format.MARGIN_RIGHT"),pl:J.i18n("writer.format.PADDING_LEFT"),pr:J.i18n("writer.format.PADDING_RIGHT"),ti:J.i18n("writer.format.TEXT_INDENT"),ls:J.i18n("writer.format.LINE_SPACING"),ri:J.i18n("writer.common.RULER.RIGHTINDENT"),al:J.i18n("writer.format.ALIGNMENT")},h=J(".parastyleinfo");for(var s in r){var d=document.createElement("div"),c=r[s],T=parseInt(c);if(c&&(isNaN(T)||0!=T)){var p="",u="";if(U.has(m,s))"ls"==s&&(c=parseFloat(c).toFixed(2)),p='<span class="ui-def-style-prop">'+m[s]+" : </span>",u='<span class="ui-def-style-val">'+c+"</span>";else if(s==ATTR_PARAGRAPH.PS_BS)p='<span class="ui-def-style-prop">'+J.i18n("writer.format.BORDER_STYLE")+" : </span>",u='<span class="ui-def-style-val">'+c+"</span>";else{if(s!=ATTR_PARAGRAPH.PS_BGC&&s!=ATTR_PARAGRAPH.PS_BC)continue;p='<span class="ui-def-style-prop">'+(s==ATTR_PARAGRAPH.PS_BC?J.i18n("writer.format.BORDER_COLOR")+" : ":J.i18n("writer.format.BACKGROUND_COLOR")+" : ")+"</span>",u='<span class="ui-def-style-val">'+c+'<div style="margin-left: 5px;vertical-align: middle;display:inline-block;height:10px;width:10px;background-color:'+c+';"><div></span>'}var f=J(p),g=J(u);J(d).append(f,g),J(d).appendTo(h)}}}},b=function(){return!(isThemeNameExist(i)&&!confirm(J.i18n("writer.styles.NAMEALREADYEXIST")))&&void validateSaveDocStyle()},A=function(){e=t={},i="",r=[],a={},n=!1;var o=editor.doc.getBodyFormat();e[ATTR_BODY.DS_STYLES]=DocUtil.copyStyle(o[ATTR_BODY.DS_STYLES]),t[ATTR_BODY.DS_STYLES]=DocUtil.copyStyle(o[ATTR_BODY.DS_STYLES]),J.dialogutil.open("editstyles",null,D)},y=function(){U.isEmpty(a)||(t[ATTR_BODY.DS_STYLES][ATTR_BODY.DS_PARA][o]=DocUtil.copyStyle(a),a={},o="")},D={init:function(){editor.isOffline()&&J("#docTheme_saveAs,#docTheme_default").hide()},get:function(e,t){},set:function(e,t,i){}};return{onBeforeUpdateHeadingStyle:p,updateHeadingStyle:u,applyResetDocumentStyle:h,resetDocumentStyle:m,initApplyDocumentStyle:T,initValidateSaveDocStyle:b,initEditDlg:A,updateDefaultDocStyle:S,updateDefaultStyleandTheme:E,showSaveNormalTempDlg:O,initUpdateOfParaTemplate:R}}(),function(){function e(){$="",Z=null,K=H=1,H=G=0,Y=!1,J("#pdf_container").scrollTop(0),J("#pdf_sidebar").scrollTop(0)}function t(){e(),editor.setView(EDITOR_VIEWS.EDITOR),DocumentMap.togglePane(),j=!1,J("#topband-hamburger").show(),J("#topband-file").show(),J("div#toolbarContainer").removeClass("ui-history-printview-height"),J("#printPreviewPrint").show(),J("#rev-name, #printpreviewtoolbar, #docprintpreview").hide(),J("#file, #commonicondiv, #components, #ui-editor-outer-div, #topband-savestatus-msg,#bottombar, #statusbar").show(),Q&&(Q=!1),UIUtils.enableDocumentShortcuts(),editor.setEditable(!0),editor.jMbSpan_editableSpan.attr("contenteditable","true"),J(".ui-top-mailid-sep").show(),Utils.setEditorHht();var t=J(".ui-ztab-custom-right.ui-ztab-expand");t.hasClass("ui-icon-collapse")&&J(".ui-ztab-custom-right.ui-ztab-expand").trigger("click"),editor.editorOffset=editor.jeditorPane.offset(),InsertShape.shapeCache={},LayoutManager.loadLayout(ModeManager.getCurrentMode())}function i(e,t){var i=document.createElement(NODE_NAME.SCRIPT);i.src=e,i.type="text/javascript",t.appendChild(i)}function o(e,t){var i=document.createElement(NODE_NAME.LINK);i.href=e,i.rel="stylesheet",i.type="text/css",t.appendChild(i)}function r(e,t){var i=document.createElement(NODE_NAME.STYLE);i.type="text/css",t.appendChild(i),J(i).text(e)}function n(e,t){var i=document.createElement(NODE_NAME.STYLE);i.type="text/css",t.appendChild(i),J(i).text(e)}function a(e){var t=document.getElementById("webfonts-style");t&&e&&e.appendChild(t.cloneNode(!0))}function l(){var e=E(),t=(e.paperwidth+"in").convertor().pixels-PAGE_BORDER_WIDTH+"px",i=t.convertor().inches+"in "+e.paperheight+"in";return"@media print{div.zw-page{overflow:auto;box-shadow:0;margin-top:0px;margin-bottom:0px} @page { size: "+i+"; margin:0;-webkit-print-color-adjust:exact}}"}function s(){var e={body:{"-webkit-print-color-adjust":"exact",margin:"0in",outline:"0in none"},p:{margin:"0in",padding:"0in",outline:"0in none"},span:{}},t=(editor.doc.getBodyFormat(),editor.doc.getParaStyles().h0),i=Utils.getStyle(t).styles,o=t.textFormat,r=Utils.getStyle(o).styles;delete i["margin-top"],delete i["margin-bottom"],delete i["line-height"],e.p=Utils.mergeObjs([e.p,i]),e.span=r,W&&(e.body.zoom="95%");var n,a,l="body{";for(n in e.body)a=e.body[n],l+=n+":"+a+";";l+="} body div.zw-paragraph{";for(n in e.p)a=e.p[n],l+=n+":"+a+";";l+="}body span.zw-portion{";for(n in e.span)a=e.span[n],l+=n+":"+a+";";return l+="}",l+=Utils.setDocumentStyle(),l+="p{margin:0px;padding:0px;outline:0px;}",(V||W)&&(l+=".pgbrk{page-break-after:always;}"),l+="div#tablePropWrapper{display:none !important;}",l=l.replace(/\#editorpane/g,"body")}function d(e){var t=editor.jeditorPane.width();e.find("img").each(function(){var e=J(this);!V&&t<=e.width()&&e.width(t);var i=e.attr("src");i&&(i.indexOf("image.do?imgurl=")>=0||i.indexOf("remoteImage.do?imgurl=")>=0?(0===i.indexOf("/writer/")&&(i=i.substring("8")),e.attr("src",editor.getBaseURL()+"/"+i)):0===i.indexOf("images/")?e.attr("src",imgStaticURL+i):0===i.indexOf("/images/")?e.attr("src",imgStaticURL+i.substring("/".length)):0!=i.indexOf(editor.getBaseURL())&&editor.orgPolicyData&&"undefined"!=typeof editor.orgPolicyData.exportExternalImages&&!editor.orgPolicyData.exportExternalImages&&0===i.indexOf("http")&&e.replaceWith("<a href='javascript:void(0);' style='background-color: #F1F1F1;'>&lt;&lt;"+i+"&gt;&gt;</a>"))})}function c(){var e=editor.doc.getBodyFormat(),t={};return t["background-color"]=e[ATTR_BODY.DS_BGC],!editor.browserInfo.isWebkit&&e.hasOwnProperty(ATTR_BODY.WM_URL)&&(t["background-image"]="url("+editor.getBaseURL()+"/"+e[ATTR_BODY.WM_URL]+")",t["background-repeat"]="no-repeat repeat-y",t["background-position"]="0% 0%"),t["margin-bottom"]="0px",t["margin-top"]="0px",t["margin-left"]="auto",t.border="0px",t["box-shadow"]="",t["min-height"]="",t}function p(e){e.find("span.autopcnt,span.autopno,span.autopno_toc,span.autodocname,span.autoauthor,span.autodate,span.autoformula,span.footnote,span.endnote,span.autodocversion").each(function(){var e=J(this).find("div."+CONST.FIELD_TEXT_NODE).html();this.innerHTML=e})}function u(e){for(var t=e.find("div.zw-contentpane").find("iframe"),i=0,o=t.length;i<o;i++){var r=J(t[i]),n=document.createElement("image");J(n).attr("src",imgStaticURL+"images/shape-obj.png").css({width:"100%",height:"400px"}),r.replaceWith(n)}}function f(e){e.find("#tocClose").parents("div").first().remove(),e.find("#zwTOCDiv,div.header_flag,div.footer_flag").remove()}function g(e){B=document.createElement(NODE_NAME.HTML),k=document.createElement(NODE_NAME.HEAD),x=document.createElement(NODE_NAME.BODY),F=J(x),j=!0,B.appendChild(k);var t=document.createElement(NODE_NAME.META);t.content="text/html; charset=UTF-8",t.httpEquiv="Content-Type",k.appendChild(t),B.appendChild(x);var i=s();o(commoncssStaticURL+"styles/common/writer_common_min_all.css",k),o(commoncssStaticURL+"styles/common/writer_codetheme.css",k),o(cssStaticURL+"styles/writer_min_all.css",k),a(k),ee(k),n(i,k),r(l(),k);var g=!1;ViewManager.renderAllpages(),EditorView.isFixedView()&&(EditorView.setView("Page View"),g=!0,ViewManager.updatePageSettings(),PubSub.publish("header/updateAutoFields"),PubSub.publish("footer/updateAutoFields"),e.css({"border-top":""}));var m=J("<div>",{id:"editorpane"});F.append(m),e.each(function(){var e=this.cloneNode(!0),t=J(e),i=t.height(),o=0,r=editor.doc.getBodyFormat();if(t.width=J(".zw-page").width()-PAGE_BORDER_WIDTH,r&&"Custom"===r[ATTR_BODY.DS_PS]&&(o-=2),i){t.height(i+o);var n=t.find("div.zw-contentpane"),a=n.height();if(a){var l=o/2;n.css({"margin-top":l,"margin-bottom":l})}}m.append(e)}),p(F);var h=c();return F.find("div.zw-page").css(h),F.find("div.zw-contentpane").show(),d(F),u(F),f(F),HiddenMarkers.isEnabled()&&F.find("span.zw-space").html("&nbsp;"),j=!1,g&&(EditorView.setView("Fixed View"),ViewManager.updatePageSettings(),ViewManager.updateAllPageHeight()),F.find('div[id^="z-cursor"]').remove(),"<!DOCTYPE html><html>"+B.innerHTML+"</html>"}function m(){var e=J("#mailmergeIFrame").contents().find("#editorpane").children(".zw-page");return g(e)}function h(){return g(editor.jeditorPane.find("div.zw-page"))}function T(e){e=e||{};var t=editor.doc.getDocInfo();if(!t||!t.VERSION)return"";W=e.hasOwnProperty("DigiSign")&&e.DigiSign||!1,z=e.hasOwnProperty("isEmail")&&e.isEmail||!1,V=e.hasOwnProperty("MailMerge")&&e.MailMerge||!1,j=e.hasOwnProperty("PrintPreview")&&e.PrintPreview||!1,V&&(j=!0),B=document.createElement(NODE_NAME.HTML),k=document.createElement(NODE_NAME.HEAD),x=document.createElement(NODE_NAME.BODY),F=J(x),B.appendChild(k);var r=document.createElement(NODE_NAME.META);r.content="text/html; charset=UTF-8",r.httpEquiv="Content-Type",k.appendChild(r),B.appendChild(x);var l=s();o(commoncssStaticURL+"styles/common/writer_common_min_all.css",k),o(cssStaticURL+"styles/writer_min_all.css",k),o(commoncssStaticURL+"styles/common/writer_codetheme.css",k),a(k),ee(k),n(l,k);var g=!1;EditorView.isFixedView()&&j&&(g=!0,ViewManager.updatePageSettings(),PubSub.publish("header/updateAutoFields"),PubSub.publish("footer/updateAutoFields"),editor.jeditorPane.find("div.zw-page").css({"border-top":""}));var m=J("<div>",{id:"editorpane"});if(F.append(m),editor.jeditorPane.find("div.zw-page").each(function(){var e=this;m.append(e.cloneNode(!0))}),W){F.find("div.zw-page").css({"border-top":"",height:"","page-break-after":"auto"}).removeClass("zw-paginated"),F.find("div.zw-contentpane").css({height:""}),F.find("div.zw-line-content").removeClass("zw-line-content-div-justify");var h=F.find("div.header_primary").hide(),T=F.find("div.footer_primary").hide();F.find("div.zw-hr").show(),h.first().show(),T.last().show(),F.find("table").width("100%"),F.find("td, div.zw-cell-container").width(""),F.find("div.overlay, div#imgResizeGrid").remove()}if(V||W)for(var E=x.getElementsByClassName("link"),R=0;R<E.length;R++){var S=J(E[R]),O=S.attr("data-href"),v=S.text();S[0].innerHTML="<a href="+O+">"+v+"</a>"}p(F);var b=c();if(F.find("div.zw-page").css(b),F.find("div.zw-contentpane").show(),d(F),u(F),f(F),HiddenMarkers.isEnabled()&&F.find("span.zw-space").html("&nbsp;"),j=!1,g&&(ViewManager.updatePageSettings(),ViewManager.updateAllPageHeight(),editor.doc.getSelection().select()),V&&z){var A=F.find("div.zw-page");A.css({"border-top":"",height:"","page-break-after":"auto"}).removeClass("zw-paginated"),F.find("div.zw-contentpane").css({height:""});var y=A.length;A.each(function(e){var t=J(this);t.css("margin-left",""),0!=e&&t.find("div.header_primary").hide(),e!=y-1&&t.find("div.footer_primary").hide(),t.find("div.overlay,div.replace-overlay,div.ui-hf-dbl-clk,#headeredit,#footeredit").remove(),t.find("span.ui-comment-indication,span.ui-comment-resolved").removeClass("ui-comment-indication ui-comment-resolved"),t.find("div.spell-error").remove()}),F.find('span[class^="EOP"]').remove(),F.find("span.autopcnt,span.autopno,span.autopno_toc,span.autodocname,span.autoauthor,span.autodate,span.autoformula").each(function(){J(this).removeClass("autopcnt autopno autopno_toc autodocname autoauthor autodate autoformula")});var D=F.find('span[class^="zw-portion zeroSize tab"]');F.find('span[class^="zw-portion zeroSize"]').not(D).remove(),o(cssStaticURL+"styles/writer_min_all.css",k),i(jsStaticURL+"js/jquery_min_all.js",k)}return F.find('div[id^="z-cursor"]').remove(),"<!DOCTYPE html><html>"+B.innerHTML+"</html>"}function E(){var e=editor.doc.getBodyFormat(),t={orientation:"portrait",papersize:"letter",paperheight:"11in",paperwidth:"8.5in"};J.isEmptyObject(e)||(t.orientation=e[ATTR_BODY.DS_OR]&&e[ATTR_BODY.DS_OR].toLowerCase()||t.orientation,t.papersize=e[ATTR_BODY.DS_PS]&&e[ATTR_BODY.DS_PS].toLowerCase()||t.papersize,t.paperheight=e[ATTR_BODY.DS_PH]&&e[ATTR_BODY.DS_PH].toLowerCase()||t.paperheight,t.paperwidth=e[ATTR_BODY.DS_PW]&&e[ATTR_BODY.DS_PW].toLowerCase()||t.paperwidth),t.margin={};var i=PUtil.getMargin();return t.margin.top=i.top.convertor().inches,t.margin.right=i.right.convertor().inches,t.margin.bottom=i.bottom.convertor().inches,t.margin.left=i.left.convertor().inches,t.paperheight=t.paperheight.convertor().inches,t.paperwidth=t.paperwidth.convertor().inches,t}function R(e){Utils.addToStatistics("Print");var t=editor.doc.getTrackChangeDetails(),i=t.getDisplayMode(),o=function(){S(e)};if(i===TCConstants.NO_MARKUP_VIEW||TcManager.isEmpty())o();else{var r=null,n=function(t){switch(t){case 1:S(e)}};MsgDialog.showMessage([J.i18n("writer.common.YES"),J.i18n("writer.common.NO")],"warning",J.i18n("common","PRINT_WITH_MARKUP"),J.i18n("writer.trackchange.PRINT_WITH_MARKUP_CONFIRM_MSG"),r,n)}}function S(e){var t={PrintPreview:!1};if(editor.browserInfo.is_chrome||editor.browserInfo.is_opera)t.PrintPreview=!0;else{var i=confirm(J.i18n("writer.common.PRINT_CONFIRM_MSG"));if(!i)return}if(!e&&$){var o=J("#browserPrint");o[0]||(o=J(document.createElement("iframe")).attr({id:"browserPrint",style:"display:none"}),o.appendTo(document.body));var r="browserPrint";frames[r].src=$,setTimeout(function(){frames[r].focus(),frames[r].contentWindow.print()},500)}else{var n=J("#browserPrint");n[0]||(n=J(document.createElement("iframe")).attr({id:"browserPrint",frameBorder:0,scrolling:"no",src:""}).css({border:"0px none",height:0,width:0}).appendTo(document.body));var a=n[0].contentWindow,l=a.document;if(l.open(),editor.browserInfo.is_chrome||editor.browserInfo.is_opera){var s=e?m():h();l.write(s)}else l.write(T(t));if(t.PrintPreview&&(j=!1),l.close(),q)return!1;q=setInterval(function(){"complete"===n[0].contentWindow.document.readyState&&(clearInterval(q),q=void 0,setTimeout(function(){a.print()},1e3))},0)}}function O(e,t,i,o){var r=editor.doc.getTrackChangeDetails(),n=r.getDisplayMode(),a=function(){b(e,t,i,o)},l=Utils.getUnsupportedFonts();if(n===TCConstants.NO_MARKUP_VIEW||TcManager.isEmpty())l.length>0&&LayoutManager.getCurrentLayout()!=LAYOUTS.PRINTPREVIEW?v(a,l):a();else{var s=function(e){switch(e){case 1:l.length>0&&LayoutManager.getCurrentLayout()!=LAYOUTS.PRINTPREVIEW?v(a,l):a()}},d=null;MsgDialog.showMessage([J.i18n("writer.common.YES"),J.i18n("writer.common.NO")],"warning",J.i18n("common","PRINT_WITH_MARKUP"),J.i18n("writer.trackchange.PRINT_WITH_MARKUP_CONFIRM_MSG"),d,s)}}function v(e,t){var i=t.slice(0,3).join(" , ");t.length>3&&(i+=", etc."),i="("+i+")",UIUtils.showMessage("error",J.i18n("common","PRINT_WITH_UNSUPPORTEDFONTS_CONFIRM_MSG",[i]),"showclose","normalfont"),e()}function b(e,t,i,o){if((editor.browserInfo.is_chrome||editor.browserInfo.is_opera)&&"true"==t)return void S();"object"==typeof e?(i=e[2]||"_self",print=e[1]||"false",attachment=e[0]||"true"):(attachment=e||"true",print=t||"false",i=i||"_self");var r=editor.doc.getDocInfo(),n=(E(),editor.doc.getTrackChangeDetails().getDisplayMode()),a=moment().zone(),l=editor.uuid+Date.now(),s=!!o&&o.isMailMerge,d="/writer/jsp/popups/error.jsp?FORMAT=pdf&IS_ATTACHMENT="+attachment+"&IS_PRINT="+print+"&cookietoken="+l+"&timeZone="+a+"&TARGET="+i;o&&o.version&&(d+="&version="+o.version);var c=r.RID,p="export";"REMOTE"==editor.getEditorType()?(d+="&rsid="+RemoteEditor.rsid,p="remoteExport"):d+="&rid="+c,s&&(d+="&mailmergeinfo="+encodeURIComponent(JSON.stringify(o))),TrackChangeDetails.isEnabled()&&(d+="&TC_DISPLAYMODE="+n),d+="&ACTION="+p,UIUtils.showLoadingMsg(J.i18n("writer.common.GENERATING_PDF")),exportDoc.checkIframe(),J("#exportErr").attr("src",d),te=0,pdfprocessTimer=setInterval(function(){A(l)},1e3)}function A(e){var t=document.cookie.split(e+"="),i=t.pop().split(";").shift();te++,"PDFGenerationCompleted"==i||"PDFGenerationFailed"==i?(UIUtils.hideLoadingMsg(),document.cookie=encodeURIComponent(e)+"=deleted; expires="+new Date(0).toUTCString(),clearInterval(pdfprocessTimer),"PDFGenerationFailed"==i&&(UIUtils.showLoadingMsg(J.i18n("writer.common.GENERATING_PDF_FAILURE")),setTimeout(function(){UIUtils.hideLoadingMsg()},2e3))):te>900&&(UIUtils.hideLoadingMsg(),clearInterval(pdfprocessTimer))}function y(){return j}function D(){return G}function C(){var e=1,t=J("#pdf_container").scrollTop(),i=D()+20;return t>i&&(e=parseInt(t/i)+1),e}function I(e,t){var i=J("div#pdf_container");J("div#pdf_sidebar");t&&(J("#previewpagination").zpagination("setCurrentPage",e),J(".thumbnailPage").each(function(){J(this).css("border","1px solid #CCC")}),J("#thumbnailPage"+e).css("border","1px solid #4190F2"));var o=i.scrollTop()+J("#pageimg"+e).offset().top-i.offset().top;i.animate({scrollTop:o},500)}function P(e){var t=Utils.getUnsupportedFonts(),i=function(t){switch(t){case 1:_(e)}};if(t.length>0){var o=t.slice(0,3).join(" , ");MsgDialog.showMessage([J.i18n("writer.common.YES"),J.i18n("writer.common.NO")],"warning",J.i18n("common","PRINT_WITH_UNSUPPORTEDFONTS_CONFIRM_MSG"),o,null,i)}else _(e)}function _(e){var t=editor.base_url,i=editor.doc.getDocInfo();t+="REMOTE"==editor.getEditorType()?"/remote/preview/"+RemoteEditor.rsid:"/preview/"+i.RID,t+="?v=-1",UIUtils.initComponent("previewToolbar_container"),J("div#toolbarContainer").addClass("ui-history-printview-height"),J("#docprintpreview").css("display","block"),J("#topband-hamburger").hide(),LayoutManager.loadLayout(LAYOUTS.PRINTPREVIEW),DocumentMap.togglePane(),PopupHandler.closeAllPopup(),"REMOTE"==editor.type?(J("#topband-default").show(),J("#topband-file").hide(),J("#topband-printpreview").hide()):(J("#topband-printpreview").show(),J("#topband-printpreview-docname").text(editor.doc.docInfo.DOCUMENT_NAME),J("#previewToolbar_container").show()),J("#topband-printpreview-docname").text(editor.doc.docInfo.DOCUMENT_NAME),J("#file, #commonicondiv, #components, #top,#ui-editor-outer-div, #topband-savestatus-msg,#bottombar,#statusbar, #previewpagination").hide(),UIUtils.disableDocumentShortcuts(),editor.setEditable(!1);var o=document.getElementById("pdf_container"),r=Utils.getBottombarHeight(),n=document.documentElement.clientHeight-J(o).position().top-r;J(o).height(n),r>0&&J(o).css("margin-bottom",r),J("#closePreviewButton").button("option","label",J.i18n("writer.common.CLOSE_PREVIEW")),J("#closePreview").css("border-right","1px solid #DDD"),J(".ui-top-mailid-sep").hide(),Utils.setEditorHht();var a=J("#pdf_container").empty();a.empty(),J("<iframe>",{src:t,frameborder:"0",width:"100%",height:"100%"}).appendTo(a)}function N(e){var t=J("#pdf_container"),i=J("#pageNoScrollParent"),o=t.offset().top,r=t.scrollTop(),n=J("#topband-wrapper").height(),a=t[0].scrollHeight,l=a/t.height(),s=o+r/l,d=J("#pageNoScroll");d.text(J.i18n("common","PAGE")+" "+e),s=n?s+n:s,i.css({top:s}).show(),clearTimeout(PrintPreview.scrollBarTimer),PrintPreview.scrollBarTimer=void 0,PrintPreview.scrollBarTimer=setTimeout(function(){i.fadeOut("slow")},1e3)}function L(){var e=moment().zone(),t=editor.getBaseURL(),i=editor.doc.getDocInfo();if("REMOTE"==editor.getEditorType())t+="/print/remote/"+RemoteEditor.rsid+"?timeZone="+e;else if(t+="/print/"+i.RID+"?timeZone="+e,TrackChangeDetails.isEnabled()){var o=editor.doc.getTrackChangeDetails().getDisplayMode();t+="&TC_DISPLAYMODE="+o}var i=editor.doc.getDocInfo(),r=J("#browserPrint");r[0]||(r=J(document.createElement("iframe")).attr({id:"browserPrint",frameBorder:0,scrolling:"no",src:""}).css({border:"0px none",height:0,width:0}).appendTo(document.body)),r.attr("src",t)}function w(){var e=document.createElement("a");e.click&&"undefined"!=e.download&&void 0!=e.download?(e.href=$,e.target="_parent",e.download=editor.doc.getDocInfo().DOCUMENT_NAME+".pdf",(document.body||document.documentElement).appendChild(e),e.click(),e.remove()):PrintPreview.printUsingPDF("true","false","_self")}function M(){return X}function U(e){J(".page").css("zoom",parseInt(e))}var x,F,k,B,H,G,z=!1,V=!1,Y=!1,W=!1,j=!1,Z=null,X=1,K=1,$="";e();var q,Q=!1,ee=function(e){var t=document.getElementsByClassName("table-theme-style");t.length&&e&&J(t).each(function(){e.appendChild(this.cloneNode(!0))})},te=0;window.PrintPreview={backToEditor:t,generateImages:P,getHTML:T,getChromePrintHTML:h,getPageLayout:E,goToPage:I,downloadPDF:w,getCurrentPage:C,printUsingPDF:O,printUsingBrowser:R,isPrintPreview:y,getPageCount:M,setZoom:U,printForPreview:L,updatePageInfoFlag:N}}(),ReplaceDialog.openrofind=function(){J.dialogutil.open("find",void 0,ReplaceDialog.dialogInfo)},ReplaceDialog.open=function(){J("#findToolbar").hide(),Replace.searchFor&&Replace.find(editor.doc.getSelection().getStart()),J.dialogutil.open("findandreplace",J("#rt_btn_findreplace"),ReplaceDialog.dialogInfo)},ReplaceDialog.handleEnter=function(e){if(e){var t=J("div#errormsg");t&&t.hide(),Replace.searchFor=e,Replace.find(),Replace.updateCurrentPosition()}},ReplaceDialog.handleClose=function(){Replace.searchFor="",editor.jeditorPane.find("div.replace-overlay").remove(),editor.jeditorPane.find("div.overlay").removeClass("animated"),PubSub.publish("QuickSeek/hideBarWithID","Replace"),J.dialogutil.close("findandreplace")},ReplaceDialog.find=function(){Replace.find(),Replace.updateCurrentPosition(),Utils.addToStatistics("replace_findNext")},ReplaceDialog.replace=function(){Replace.replace(),Replace.updateCurrentPosition(),Utils.addToStatistics("replace_replace")},ReplaceDialog.replaceAll=function(){Replace.replaceAll(),Replace.updateCurrentPosition(),Utils.addToStatistics("replace_replaceAll")},ReplaceDialog.dialogInfo={init:function(){Replace.replaceAllVal=!1,Replace.searchIn=editor.doc.getDocumentContent(),Replace.replaceCount=0,Replace.replaceStr="",Replace.backwards=!1,Replace.navigator=J(".js_fnavigator"),Replace.pos=editor.doc.getSelection().getStart(),J("input#findTxt").unbind("input, focusin, focusout").bind({input:function(){Replace.findAllTexts(J(this))},focusin:function(){J(this).parents("table").addClass("ui-find-replace-focus")},focusout:function(){J(this).parents("table").removeClass("ui-find-replace-focus")}}).unbind("keyup").bind("keyup",function(e){var t=e.keyCode;if(t===KEYS.ENTER){var i=this.value;ReplaceDialog.handleEnter(i)}}),Replace.updateCurrentPosition()},set:function(e,t,i){"Find"==e.action?(Replace.searchFor=Utils.removeUnWantedUnicodes(t),Replace.pos=editor.doc.getSelection().getStart()):"Replace"==e.action?Replace.replaceStr=Utils.removeUnWantedUnicodes(t):"casesensitive"==e.action?Replace.casesensitive=t:"searchType"==e.action&&("up"==J(i).attr("value")?(Replace.pos=editor.doc.getSelection().getEnd(),Replace.backwards=!0,Replace.replaceCount=0):(Replace.pos=editor.doc.getSelection().getEnd(),Replace.backwards=!1,Replace.replaceCount=0))},get:function(e,t){if("Find"==e){if(t.focus(),Replace.searchFor)o=Replace.searchFor;else var i=editor.doc.getSelection(),o=i.getSelectedText(i.getStart(),i.getEnd());if(o)return o}else{if("searchType"==e)return backwards=!1,"down";if("casesensitive"==e)return Replace.casesensitive=!1,!1}}};var TocDialog=function(){var e=!0,t=function(e){e==ELEM_ID.TOCPANEL&&(EventHandler.isDialogOpened=!1)},i=function(e){TocDialog.isHeadingChanged||e.paraProperties.isHeading&&(TocDialog.isHeadingChanged=!0)};return PubSub.subscribe("BeforePanelClose",t),PubSub.subscribe("Para/Create",i),PubSub.subscribe("Para/Update",i),PubSub.subscribe("Para/Modify",i),PubSub.publish("Para/Remove",i),{isHeadingChanged:e}}();TocDialog.openTocSettingsDlg=function(){TocDialog.newAttr={},TocDialog.attr={};var e={theme:"classic",level:3,leader:1,showNo:!0,al_right:!1};TocDialog.attr=DocUtil.copyStyle(e),TocDialog.newAttr=DocUtil.copyStyle(e);var t=editor.doc.findNextIndexOf(UNICODE.TOCSTART,0);if(TocDialog.documentHeadingParas=editor.doc.getSelection().getAllHeadings(),TocDialog.isTocExist=!1,t>0){TocDialog.isTocExist=!0;var i=editor.doc.getRawFormatAt(t);void 0!==i.theme&&(TocDialog.attr=DocUtil.copyStyle(i),TocDialog.newAttr=DocUtil.copyStyle(i))}FetchHTML.get({requestName:"tocsettings",target:"#subpanel-toc",callback:function(){var e=J("#subpanel-toc");e.data("ztrackObject")?e.ZCtrackObjects("refreshValues"):e.ZCtrackObjects({callbacks:TocDialog.dialogInfo,fillVisible:!1}),EventHandler.isDialogOpened=!0;var t={panelId:ELEM_ID.TOCPANEL,animationType:ANIMATIONS.FLIPIN,parentPanels:[ELEM_ID.INSERTPANEL]};LeftPanel.showAdvancedPanel(t)}})},TocDialog.updatePreview=function(){var e=TocDialog.newAttr[ATTR_TOC.theme],t=WebUtil.TocMenuHTML[e];t[ATTR_TOC.showNo]=TocDialog.newAttr[ATTR_TOC.showNo],t[ATTR_TOC.level]=TocDialog.newAttr[ATTR_TOC.level],t[ATTR_TOC.leader]=TocDialog.newAttr[ATTR_TOC.leader];var i=WebUtil.getTocTheme(e,t);J("#toc-theme-"+e).children("div.ui-toc-theme-preview").html(i)},TocDialog.updateTheme=function(e){var t=J("select#tableader");"modern"===e||"formal"===e||"classic"===e?(TocDialog.newAttr[ATTR_TOC.leader]=1,t.zcombo("setValue","1")):(TocDialog.newAttr[ATTR_TOC.leader]=0,t.zcombo("setValue","0")),TocDialog.newAttr[ATTR_TOC.showNo]||(TocDialog.newAttr[ATTR_TOC.leader]=0,t.zcombo("setValue","0")),TocDialog.newAttr[ATTR_TOC.theme]=e},TocDialog.bindEvents=!0,TocDialog.dialogInfo={init:function(){TocDialog.updatePreview(),TocDialog.isTocExist?(J("#toc-update").show(),J("#toc-insert").hide()):(J("#toc-update").hide(),J("#toc-insert").show()),TocDialog.bindEvents&&(TocDialog.bindEvents=!1,carousel.init(),J("#toc-carousel-next").click(function(){setTimeout(function(){var e=J("#carousel-parent ul").children("li").eq(1).attr("id");e=e.replace("toc-theme-",""),TocDialog.updateTheme(e),TocDialog.updatePreview()},300)}),J("#toc-carousel-prev").click(function(){setTimeout(function(){var e=J("#carousel-parent ul").children("li").eq(1).attr("id");e=e.replace("toc-theme-",""),TocDialog.updateTheme(e),TocDialog.updatePreview()},300)}))},get:function(e,t){return e=e.action,"strokeType"===e?TocDialog.attr[ATTR_TOC.leader]:"level"===e?TocDialog.attr[ATTR_TOC.level]:"showNo"===e?TocDialog.attr[ATTR_TOC.showNo]:"alignRight"===e?TocDialog.attr[ATTR_TOC.al_right]:void 0},set:function(e,t,i){var o=J("select#newLeaderId");if("strokeType"===e.action)TocDialog.newAttr[ATTR_TOC.leader]=parseInt(t);else if("level"===e.action)TocDialog.newAttr[ATTR_TOC.level]=parseInt(t);else if("showNo"===e.action){if(t){var r=TocDialog.newAttr[ATTR_TOC.theme];"modern"===r||"formal"===r||"classic"===r?(TocDialog.newAttr[ATTR_TOC.leader]=1,o.zcombo("setValue","1")):(TocDialog.newAttr[ATTR_TOC.leader]=0,o.zcombo("setValue","0"))}else TocDialog.newAttr[ATTR_TOC.leader]=0,o.zcombo("setValue","0");TocDialog.newAttr[ATTR_TOC.showNo]=t}else"alignRight"===e.action&&(TocDialog.newAttr[ATTR_TOC.al_right]=t);TocDialog.updatePreview()}},TocDialog.applyValues=function(){var e=editor.doc.findNextIndexOf(UNICODE.TOCSTART,0);EventHandler.isDialogOpened=!1,(!Utils.compareJSON(TocDialog.newAttr,TocDialog.attr)||e<0||TocDialog.isHeadingChanged)&&(Toc.generate(TocDialog.newAttr),TocDialog.isHeadingChanged&&(TocDialog.isHeadingChanged=!1)),LeftPanel.closeSubPanel()},Settings.prototype={pageInfo:{init:function(){if("ui_preferences"===Settings.toBeOpenedTab)J("#settings_ui #menutabs").ztab("selectTab","1");else if("autocorrect"===Settings.toBeOpenedTab){J("#settings_ui #menutabs").ztab("selectTab","2");var e=J("#spl_char").val();J("#autoCorrect_Value_Id").val(e)}else"spellcheck"===Settings.toBeOpenedTab?J("#settings_ui #menutabs").ztab("selectTab","3"):(J("#settings_ui #menutabs").ztab("selectTab","0"),"REMOTE"!=editor.getEditorType()&&"ANYONEWITHLINK"!=editor.getEditorType()||J("#defaultDateFmtMenu").hide());if(Settings.updateDisplayLanguage(),"undefined"!=typeof SpellCheck){var t=J("#langselection"),i=Proofing.getSupportedLanguages();for(var o in i){var r=i[o];r=r.replace("-",""),r=r.replace("'","\\'"),t.zcombo("addOption",{value:o,label:r,data:"{'icon': 'ui-icon-script'}"})}}delete Settings.toBeOpenedTab},get:function(e){if(Settings.soundMap||"undefined"!=typeof Settings.soundMap||(Settings.soundMap={}),Settings.vc_info={},"viewType"==e)return Settings.ViewType=w_usersettings[ATTR_BODY.DS_VIEW],"Normal View"===Settings.ViewType&&(Settings.ViewType="Fixed View"),Settings.ViewType;if("pasteOptions"===e)return Settings.PasteOptions=w_usersettings[ATTR_BODY.DS_PASTEOPTIONS]+"",Settings.PasteOptions;if("getsoundpref"==e)return Settings.soundMap.PREF=w_usersettings.SOUNDPREF,Settings.soundMap.AUDIO=w_usersettings.AUDIO,"1"===Settings.soundMap.AUDIO?J("#enableaudio")[0].checked=!0:J("#enableaudio")[0].checked=!1,Settings.soundMap.PREF;if("units"==e)return Settings.Unit=w_usersettings[ATTR_BODY.DS_UN],Settings.Unit;if("allowcomments"==e)return Settings.AllowComments=w_usersettings[ATTR_BODY.DS_COMM],Settings.AllowComments;if("setlanguage"==e)return Settings.proofingLang=w_usersettings[ATTR_BODY.DS_SPLANG],Settings.proofingLang;if("ignoreuppercase"==e){var t=w_usersettings[ATTR_BODY.SP_IGNOREUPPERCASE];return Settings.ignoreUppercase=!!t&&"true"===t.toString(),Settings.ignoreUppercase?1:0}if("ignorenumbered"==e){var i=w_usersettings[ATTR_BODY.SP_IGNORENUMBERED];return Settings.ignoreNumbered=!!i&&"true"===i.toString(),Settings.ignoreNumbered?1:0}if("flagrepeatedword"==e){var o=w_usersettings[ATTR_BODY.SP_FLAGREPEATEDWORD];return Settings.flagrepeatedword=!!o&&"true"===o.toString(),Settings.flagrepeatedword?1:0}if("ignorelink"==e){var r=w_usersettings[ATTR_BODY.SP_IGNORELINK];return Settings.ignoreLink=!!r&&"true"===r.toString(),Settings.ignoreLink?1:0}return"autolink"==e?(Settings.AutoLink=w_usersettings[ATTR_BODY.DS_AUTOLINK],Settings.AutoLink):"autolist"==e?(Settings.AutoList=w_usersettings[ATTR_BODY.DS_AUTOLIST],Settings.AutoList):"autocaps"==e?(Settings.AutoCaps=w_usersettings[ATTR_BODY.DS_AUTOCAPS],Settings.AutoCaps):"autocaps_correct"==e?(Settings.AutoCapsLock=w_usersettings[ATTR_BODY.DS_AUTOCORRECTCAPSLOCK],Settings.AutoCapsLock):"autocaps_days"==e?(Settings.AutoCapsDays=w_usersettings[ATTR_BODY.DS_AUTOCAPSDAYS],Settings.AutoCapsDays):"autocomplete"===e?(Settings.AutoComplete=w_usersettings[ATTR_BODY.DS_AUTOCOMPLETE],Settings.AutoComplete):"autosmartquotes"===e?(Settings.AutoSmartQuotes=w_usersettings[ATTR_BODY.DS_AUTOSMARTQUOTES],Settings.AutoSmartQuotes):"autodatefmt"===e?(Settings.DateFmt=w_usersettings[ATTR_BODY.DS_AUTODATEFORMAT],Settings.DateFmt):"smarttoolbar"==e?(Settings.vc_info.smarttoolbar=UserPreferences.isPrefered(e),Settings.vc_info.smarttoolbar):"para_microtoolbar"==e?(Settings.vc_info.para_microtoolbar=UserPreferences.isPrefered(e),Settings.vc_info.para_microtoolbar):"ruler"==e?(Settings.vc_info.ruler=UserPreferences.isPrefered(e),Settings.vc_info.ruler):"pref"==e?(AutoCorrect.showCorrects(),Settings.Pref=w_usersettings[ATTR_BODY.DS_PREF],isNaN(Settings.Pref)&&(Settings.Pref="1"==Settings.Pref?1:0),1==Settings.Pref?(J("#inline")[0].checked=!1,J("div#prefdiv, div#defaultprefdiv").find(":input").removeAttr("disabled")):setTimeout(function(){J("#inline")[0].checked=!0,J("div#prefdiv, div#defaultprefdiv").find(":input").attr("disabled",!0)},100),!Settings.Pref):void 0},set:function(e,t,i){"viewType"==e.action?Settings.ViewType=t:"pasteOptions"===e.action?Settings.PasteOptions=J(i).attr("value"):"getaudio"==e.action?t?Settings.soundMap.AUDIO="1":Settings.soundMap.AUDIO="0":"getsoundpref"==e.action?Settings.soundMap.PREF=J("#sound_list option:selected").val():"pagebreak"==e.action?t?Settings.PageBreak=1:Settings.PageBreak=0:"setlanguage"==e.action?Settings.proofingLang=J("#langselection option:selected").val():"ignoreuppercase"==e.action?Settings.ignoreUppercase=t:"ignorenumbered"==e.action?Settings.ignoreNumbered=t:"flagrepeatedword"==e.action?Settings.flagrepeatedword=t:"ignorelink"==e.action?Settings.ignoreLink=t:"units"==e.action?Settings.Unit=t:"autodatefmt"==e.action?Settings.DateFmt=t||"M/d/yy":"allowcomments"==e.action?Settings.AllowComments=t?1:0:"autolink"==e.action?Settings.AutoLink=t?1:0:"autolist"==e.action?Settings.AutoList=t?1:0:"autocaps"==e.action?Settings.AutoCaps=t?1:0:"autocaps_correct"==e.action?Settings.AutoCapsLock=t?1:0:"autocaps_days"==e.action?Settings.AutoCapsDays=t?1:0:"autocomplete"===e.action?Settings.AutoComplete=t?1:0:"autosmartquotes"===e.action?Settings.AutoSmartQuotes=t?1:0:"smarttoolbar"==e.action?Settings.vc_info.smarttoolbar=t:"para_microtoolbar"==e.action?Settings.vc_info.para_microtoolbar=t:"ruler"==e.action?Settings.vc_info.ruler=t:"pref"==e.action&&(t?J("div#prefdiv, div#defaultprefdiv").find(":input").attr("disabled",!0):J("div#prefdiv, div#defaultprefdiv").find(":input").removeAttr("disabled"),Settings.Pref=t?0:1)}},apply:function(){var e=!1,t=UserPreferences.handleUserPrefChange(Settings.vc_info),i={};i[ATTR_BODY.DS_UN]=Settings.Unit,i[ATTR_BODY.DS_AUTODATEFORMAT]=Settings.DateFmt,i[ATTR_BODY.DS_COMM]=Settings.AllowComments,i[ATTR_BODY.DS_AUTOLINK]=Settings.AutoLink,i[ATTR_BODY.DS_AUTOLIST]=Settings.AutoList,i[ATTR_BODY.DS_AUTOCAPS]=Settings.AutoCaps,i[ATTR_BODY.DS_AUTOCORRECTCAPSLOCK]=Settings.AutoCapsLock,i[ATTR_BODY.DS_AUTOCAPSDAYS]=Settings.AutoCapsDays,i[ATTR_BODY.DS_AUTOCOMPLETE]=Settings.AutoComplete,i[ATTR_BODY.DS_AUTOSMARTQUOTES]=Settings.AutoSmartQuotes,i[ATTR_BODY.DS_PASTEOPTIONS]=Settings.PasteOptions,i.disabled_tools=t,i[ATTR_BODY.DS_PREF]=Settings.Pref,i[ATTR_BODY.DS_SPLANG]=Settings.proofingLang,i[ATTR_BODY.SP_IGNOREUPPERCASE]=Settings.ignoreUppercase,i[ATTR_BODY.SP_IGNORENUMBERED]=Settings.ignoreNumbered,i[ATTR_BODY.SP_FLAGREPEATEDWORD]=Settings.flagrepeatedword,i[ATTR_BODY.SP_IGNORELINK]=Settings.ignoreLink,i.AUDIO=Settings.soundMap.AUDIO,i.SOUNDPREF=Settings.soundMap.PREF,i[ATTR_BODY.DS_AUTOCORRECTS]=JSON.stringify(AutoCorrect.getUserCorrects(!0));var o=w_usersettings[ATTR_BODY.DS_UN];for(var r in w_usersettings)if(e||"undefined"==typeof i[r]||i[r]==w_usersettings[r]){if(e)break}else e=!0;if(e){Settings.updateUserSettings(i),Utils.setCsrfParam(i),J.post(Utils.getNiceUrlPrefix("user/settings/options"),i),Settings.Unit!=o&&(Conversions.init(),PubSub.publish("Settings/UnitsChanged")),PubSub.publish("Settings/Saved");var n=!1;"undefined"!=typeof SpellCheck&&(Settings.ignoreUppercase==SpellCheck.getIsUppercaseIgnored()&&Settings.ignoreNumbered==SpellCheck.getIsNumberIgnored()&&Settings.flagrepeatedword==SpellCheck.getIsFlagRepeatedWord()&&Settings.ignoreLink==SpellCheck.getIsLinkIgnored()||(SpellCheck.setAdvancedSettingValues(),n=!0),Settings.proofingLang!==editor.doc.getBodyFormat()[ATTR_BODY.DS_SPLANG]&&(SpellCheck.setLangInUserSettings(Settings.proofingLang),n=!1),n&&Proofing.canProceed()&&SpellCheck.checkAll())}J.dialogutil.close("settings")},showSettingsDlg:function(e){UIUtils.hideControllers(e),Settings.toBeOpenedTab="",J.dialogutil.open("settings",void 0,Settings.pageInfo)},notification:{init:function(){var e=J("#follow_ui");Follow.init(e),Follow.bindEvents()},apply:function(){Follow.done()}}},Settings.prototype.updateUserSettings=function(e){for(var t in e)w_usersettings[t]=e[t]},Settings.prototype.showNotificationDialog=function(){Utils.addToStatistics("ShowNotify"),J.dialogutil.open("notification",void 0,Settings.notification)},Settings.prototype.showAutoCorrectDlg=function(){Settings.toBeOpenedTab="autocorrect",J.dialogutil.open("settings",void 0,Settings.pageInfo)},Settings.prototype.showUIPreferencesDlg=function(){Settings.toBeOpenedTab="ui_preferences",J.dialogutil.open("settings",void 0,Settings.pageInfo)},Settings.prototype.playsound=function(){"undefined"==typeof window.sound&&(window.sound={},sound.alert=new Audio(mediaStaticURL+"sound/alert.wav"),sound.ascending=new Audio(mediaStaticURL+"sound/ascending.wav"),sound.beep=new Audio(mediaStaticURL+"sound/beep.wav"),sound.cuckoo=new Audio(mediaStaticURL+"sound/cuckoo.wav"),sound.doorbell=new Audio(mediaStaticURL+"sound/doorbell.wav"),sound.event=new Audio(mediaStaticURL+"sound/event.wav"),sound.phonering=new Audio(mediaStaticURL+"sound/phonering.wav"),sound.shaker=new Audio(mediaStaticURL+"sound/shaker.wav"),sound.techno=new Audio(mediaStaticURL+"sound/techno.wav"),sound.xylo=new Audio(mediaStaticURL+"sound/xylo.wav"));var e=J("#sound_list option:selected").val();window.sound[e].play()},Settings.prototype.changeLanguage=function(){var e=editor.iamServerURL+"/u/h#profile/personal";Utils.safeWindowOpen(e)},Settings.prototype.updateDisplayLanguage=function(){var e,t=Utils.isSupportedLanguage(editor.lang);t?(e=editor.lang,J("#set-display-lang-infomsg").hide()):(e=DEFAULT_LANGUAGE,J("#set-display-lang-infomsg").show());var i=Utils.getLanguageFullString(e);J("#set-display-lang").text(i),null==Settings.supportedLangStr&&(Settings.supportedLangStr=Utils.getAllSupportedLanguages().join(", ")),J("#set-supt-display-lang").text(Settings.supportedLangStr)},Settings=new Settings,Settings.supportedLangStr=null,ShowInfo.attentionMsg=function(e){var t,i;e instanceof Array?(t=e[1],i=e[0]):i=e;var o=Utils.contextMenuSupportedBrowser();if(editor.browserInfo.is_chrome){var r=EditorUtil.isClipboardWebInstalled(),n=EditorUtil.isZohoWriterChromeAppInstalled();if(!(n||"paste"!=i&&o))return void(r?MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,null,J.i18n("writer.common.CLIPBOARD_UNSUPPORTED_TITLE_MSG"),J.i18n("writer.common.UNINSTALL_CLIPBOARD_MSG")):UIUtils.showZohoWriterWebAppInstalDlg())}else if(!o||"paste"==i){var a=editor.browserInfo.is_mac?"Cmd":"Ctrl";return void("cut"==i?UIUtils.showMessagePopup(J.i18n("writer.common.CUT_COPY_PASTE",[a,"X",J.i18n("writer.common.CUT")]),J.i18n("writer.common.JUST_LETTING_YOU_KNOW_TITLE_MSG"),"warning"):"copy"==i?UIUtils.showMessagePopup(J.i18n("writer.common.CUT_COPY_PASTE",[a,"C",J.i18n("writer.common.COPY")]),J.i18n("writer.common.JUST_LETTING_YOU_KNOW_TITLE_MSG"),"warning"):"paste"==i&&UIUtils.showMessagePopup(J.i18n("writer.common.CUT_COPY_PASTE",[a,"V",J.i18n("writer.common.PASTE")]),J.i18n("writer.common.JUST_LETTING_YOU_KNOW_TITLE_MSG"),"warning"))}"cut"==i&&EventHandler.btnCut(),"copy"==i&&EventHandler.btnCopy(),"paste"==i&&EventHandler.btnPaste()},ParagraphPanel.open=function(e){ParagraphPanel.attr={},ParagraphPanel.newAttr={},UIUtils.initComponent("subpanel-para"),Utils.addToStatistics("ParaOptions");var t=J("#fmt-sub-pnl-layout"),i=J("#fmt-lpnl-borderoptions");t.data("ztrackObject")?(t.ZCtrackObjects("refreshValues"),i.ZCtrackObjects("refreshValues")):(t.ZCtrackObjects({callbacks:this.info,fillVisible:!1,eventNameMapping:{zspinner:"spinnerblur"}}),i.ZCtrackObjects({callbacks:ParaBorders.panelInfo,fillVisible:!1,eventNameMapping:{zspinner:"spinnerblur"}})),J("#fmt-sub-pnl-paraoptions").ztab("selectTab",e||0),ParagraphPanel.delta=editor.doc.getPaperWidth(!0)/(J(".ui-spacingind-preview").outerWidth()-10),ParagraphPanel.updatePreview();var o={panelId:ELEM_ID.PARAGRAPHOPTIONPANEL,animationType:ANIMATIONS.FLIPIN,parentPanels:[ELEM_ID.FORMATPANEL]};LeftPanel.showAdvancedPanel(o),PubSub.subscribe("BeforePanelClose",ParagraphPanel.handleClose),PubSub.subscribe(["Cursor/Collapsed","Cursor/Selected"],ParagraphPanel.refreshValues,{async:!0,timeout:300}),PubSub.subscribe(["Cursor/ParaChanged","Cursor/Selected"],ParagraphPanel.handleCursorParaChange,{async:!0,timeout:100}),PubSub.subscribe("Document/UndoRedo",ParagraphPanel.refreshBorderValues,{async:!0,timeout:300})},ParagraphPanel.handleCursorParaChange=function(){PanelUtil.activeLeftPanelSpinner=null,ParagraphPanel.refreshBorderValues()},ParagraphPanel.refreshValues=function(){PanelUtil.activeLeftPanelSpinner&&/BEF_PARA|AF_PARA|LINE_SP|LEFT|RIGHT|FIRST_HANG|FIRSTLINE|HANGING/.test(PanelUtil.activeLeftPanelSpinner)||J("#fmt-sub-pnl-layout").ZCtrackObjects("refreshValues")},ParagraphPanel.refreshBorderValues=function(){J("#fmt-lpnl-borderoptions").ZCtrackObjects("refreshValues")},ParagraphPanel.handleClose=function(e){"subpanel-para"==e&&(PubSub.unsubscribe("BeforePanelClose",ParagraphPanel.handleClose),PubSub.unsubscribe(["Cursor/Collapsed","Cursor/Selected"],ParagraphPanel.refreshValues,{async:!0,timeout:500}),PubSub.unsubscribe("Cursor/ParaChanged",ParagraphPanel.refreshBorderValues,{async:!0,timeout:100}),PubSub.unsubscribe("Document/UndoRedo",ParagraphPanel.refreshBorderValues,{async:!0,timeout:800}))},ParagraphPanel.info={set:function(e,t,i){arguments[5].keyCode&&arguments[5].keyCode==KEYS.TAB?EventHandler.isDialogFocused=!0:EventHandler.isDialogFocused=!1,e.action&&/BEF_PARA|AF_PARA|LINE_SP|LEFT|RIGHT|FIRST_HANG|FIRSTLINE|HANGING/.test(e.action)&&PanelUtil.setActiveLeftPanelSpinner(e.action);var o,r=Conversions.step;if("WID_ORPHAN"==e.action||"PARA_BREAK"==e.action||"PAGE_BREAK"==e.action?(J("#line_space_prev").hide(),J("#page_break_prev").show()):(J("#line_space_prev").show(),J("#page_break_prev").hide()),"BEF_PARA"==e.action)ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_SB]=parseFloat(t);else if("WID_ORPHAN"===e.action)ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_WO]=t;else if("PARA_BREAK"===e.action)ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_BL]=t;else if("PAGE_BREAK"===e.action)ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_PB]=t;else if("AF_PARA"==e.action)ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_SA]=parseFloat(t);else if("WORD_SP"==e.action)ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_WS]=parseFloat(t);else if("LINE_SP"==e.action)"Multiple"===t?J("#custom_line_space").zspinner("enable"):(ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_LS]=parseFloat(t),J("#custom_line_space").zspinner("disable"));else if("CUSTOM_LINE_SPACE"===e.action)ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_LS]=parseFloat(t.toFixed(3));else{if("CHAR_SPACE"===e.action)return void editor.doc.execCmd("CharSpacing",t);if("LEFT"==e.action)o=J(i).zspinner("getValue")%r,0!=o&&(r-=o),J(i).zspinner("setStepValue",r),ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_ML]=parseFloat(t);else if("RIGHT"==e.action)o=J(i).zspinner("getValue")%r,0!=o&&(r-=o),J(i).zspinner("setStepValue",r),ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_MR]=parseFloat(t);else if("FIRST_HANG"==e.action||"FIRSTLINE"==e.action||"HANGING"==e.action){"FIRST_HANG"!=e.action&&(ParagraphPanel.newAttr.type="FIRSTLINE"==e.action?"1":"2");var n=J("div.ui-indent-hanging").find("input#spinner"),t=J(n).zspinner("getValue");o=t%r,0!=o&&(r-=o),J(n).zspinner("setStepValue",r),ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_TI]=parseFloat(t);var a=ParagraphPanel.newAttr.type;"2"==a?(ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_PL]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_TI],ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_TI]=-ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_TI]):"1"==a&&(ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_TI]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_TI],ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_PL]=0)}}ParagraphPanel.applyValues()},get:function(e,t){e=e.action;var i=editor.doc.getBodyFormat(),o=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.PARAGRAPH)[0],r=J(editor.clientActiveSection),n=r.hasClass("header_primary"),a=r.hasClass("footer_primary");(n||a)&&(J("#linesAndBreaking").attr("disabled","disabled").css("opacity",".22"),J("#preview").css("opacity",".22"));var l,s,d,c,p,u=DocUtil.getParaFormat(o.getEnd()-1);if("BEF_PARA"==e){var f=0;return u[ATTR_PARAGRAPH.PS_SB]&&(f=parseFloat(u[ATTR_PARAGRAPH.PS_SB])),ParagraphPanel.attr[ATTR_PARAGRAPH.PS_SB]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_SB]=f,f}if("WID_ORPHAN"===e){var g=ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_WO]=u[ATTR_PARAGRAPH.EN_WO];return ParagraphPanel.updatePreview(),g}if("PARA_BREAK"===e){var g=ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_BL]=u[ATTR_PARAGRAPH.EN_BL];return ParagraphPanel.updatePreview(),g}if("PAGE_BREAK"===e){var g=ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_PB]=u[ATTR_PARAGRAPH.EN_PB];return ParagraphPanel.updatePreview(),g}if("AF_PARA"==e){var m=0;return u[ATTR_PARAGRAPH.PS_SA]&&(m=parseFloat(u[ATTR_PARAGRAPH.PS_SA])),ParagraphPanel.attr[ATTR_PARAGRAPH.PS_SA]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_SA]=m,m}if("WORD_SP"==e){var h=0;return u[ATTR_PARAGRAPH.PS_WS]&&(h=parseFloat(u[ATTR_PARAGRAPH.PS_WS])),ParagraphPanel.attr[ATTR_PARAGRAPH.PS_WS]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_WS]=h,h}if("LINE_SP"==e){var T=1.2;return u[ATTR_PARAGRAPH.PS_LS]&&(T=parseFloat(u[ATTR_PARAGRAPH.PS_LS])),ParagraphPanel.attr[ATTR_PARAGRAPH.PS_LS]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_LS]=T,1!==T&&1.2!==T&&1.5!==T&&2!==T&&(J("#custom_line_space").zspinner("enable"),T="Multiple"),T}if("CUSTOM_LINE_SPACE"===e){var T=1.2;return u[ATTR_PARAGRAPH.PS_LS]&&(T=parseFloat(u[ATTR_PARAGRAPH.PS_LS])),ParagraphPanel.attr[ATTR_PARAGRAPH.PS_LS]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_LS]=T,T}if("CHAR_SPACE"==e){var E=editor.doc.getSelection().getTextFormat();return E[ATTR_TEXT.TS_CS]||"none"}if("LEFT"==e){l=-i.ml.convertor().inches;var R,S,O,v;v=editor.doc.getPaperWidth(!1),R=Conversions.toPixels(u[ATTR_PARAGRAPH.PS_MR]),void 0==R&&(R=0),S=Conversions.globalUnitInPx,O=Conversions.toGlobalValue(v-R-S+"px"),s=Conversions.toGlobalUnit(O),c=Conversions.step,l-=l%c,s-=s%c,d=Conversions.showUnit;var b=0;return u[ATTR_PARAGRAPH.PS_ML]&&(b=Conversions.toGlobalUnit(u[ATTR_PARAGRAPH.PS_ML]),0==b&&(b="0")),ParagraphPanel.attr[ATTR_PARAGRAPH.PS_ML]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_ML]=b,J(t).zspinner("setMinValue",l),J(t).zspinner("setMaxValue",s),J(t).zspinner("setStepValue",c),J(t).zspinner("setUnit",d),b}if("RIGHT"==e){l=-i.mr.convertor().inches;var A=Conversions.toGlobalUnit(Conversions.toGlobalValue(editor.doc.getPaperWidth(!1)+"px")),y=Conversions.toGlobalUnit(u[ATTR_PARAGRAPH.PS_ML])||0;u[ATTR_PARAGRAPH.PS_PL]&&(y+=Conversions.toGlobalUnit(u[ATTR_PARAGRAPH.PS_PL])),u[ATTR_PARAGRAPH.PS_TI]&&(y+=Conversions.toGlobalUnit(u[ATTR_PARAGRAPH.PS_TI])),s=A-y-Conversions.toGlobalUnit("1in"),c=Conversions.step,l-=l%c,d=Conversions.showUnit;var D=0;return u[ATTR_PARAGRAPH.PS_MR]&&(D=Conversions.toGlobalUnit(u[ATTR_PARAGRAPH.PS_MR]),0==D&&(D="0")),p=J(t).zspinner("getValue")%c,0!=p&&(c-=p),J(t).zspinner("setStepValue",c),J(t).zspinner("setMinValue",l),J(t).zspinner("setMaxValue",s),J(t).zspinner("setUnit",d),ParagraphPanel.attr[ATTR_PARAGRAPH.PS_MR]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_MR]=D,D}if("FIRSTLINE"==e){var C=0;return u[ATTR_PARAGRAPH.PS_TI]?(C=parseFloat(u[ATTR_PARAGRAPH.PS_TI]),0==C.toString().indexOf("-")||0==C&&J("#para_hanging").prop("checked")?(ParagraphPanel.attr.type=ParagraphPanel.newAttr.type="2","off"):(ParagraphPanel.attr.type=ParagraphPanel.newAttr.type="1","on")):"on"}if("HANGING"==e){var C=0;return u[ATTR_PARAGRAPH.PS_TI]?(C=parseFloat(u[ATTR_PARAGRAPH.PS_TI]),0==C.toString().indexOf("-")||0==C&&!J("#para_firstline").prop("checked")?(ParagraphPanel.attr.type=ParagraphPanel.newAttr.type="2","on"):(ParagraphPanel.attr.type=ParagraphPanel.newAttr.type="1","off")):"off"}if("FIRST_HANG"==e){var C="0";l=0;var R,S,v,O;return v=editor.doc.getPaperWidth(!1),R=Conversions.toPixels(u[ATTR_PARAGRAPH.PS_MR]),void 0==R&&(R=0),S=Conversions.globalUnitInPx,O=Conversions.toGlobalValue(v-R-S+"px"),s=Conversions.toGlobalUnit(O),c=Conversions.step,s-=s%c,d=Conversions.showUnit,u[ATTR_PARAGRAPH.PS_TI]&&(C=Conversions.toGlobalUnit(u[ATTR_PARAGRAPH.PS_TI]),0==C&&(C="0")),ParagraphPanel.attr[ATTR_PARAGRAPH.PS_TI]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_TI]=C,0==C.toString().indexOf("-")&&(C=C.toString().substring(1)),J(t).zspinner("setMinValue",l),J(t).zspinner("setMaxValue",s),J(t).zspinner("setStepValue",c),J(t).zspinner("setUnit",d),C}return e}},ParagraphPanel.updatePreview=function(e){var t=DocUtil.copyStyle(ParagraphPanel.newAttr);for(var i in t)if(i==ATTR_PARAGRAPH.PS_ML||i==ATTR_PARAGRAPH.PS_MR){var o=parseFloat(t[i])/ParagraphPanel.delta+Conversions.globalUnit;t[i]=o}else if(i==ATTR_PARAGRAPH.PS_TI){var r=parseFloat(t[ATTR_PARAGRAPH.PS_TI])/ParagraphPanel.delta;r+=Conversions.globalUnit,t[i]=r}else i!=ATTR_PARAGRAPH.PS_SB&&i!=ATTR_PARAGRAPH.PS_SA&&i!=ATTR_PARAGRAPH.PS_WS||(t[i]=parseFloat(t[i])/2);ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_WO]&&(J(".wopara,.pbpara").show(),J(".normal,.nbpara").hide()),ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_BL]&&(J(".pbpara,.nbpara").show(),J(".normal,.wopara").hide()),ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_PB]&&(J(".nbpara,.pbpara").show(),J(".normal,.wopara").hide()),ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_WO]||ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_BL]||ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_PB]||(J(".normal,.pbpara").show(),J(".wopara,.bpara,.nbpara").hide()),DomUtil.setParaStyle(J("#previewpara")[0],t)},ParagraphPanel.applyValues=function(){if(!Utils.compareJSON(ParagraphPanel.attr,ParagraphPanel.newAttr)){var e={};e[ATTR_PARAGRAPH.PS_SB]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_SB]+"pt",e[ATTR_PARAGRAPH.PS_SA]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_SA]+"pt",e[ATTR_PARAGRAPH.PS_LS]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_LS],e[ATTR_PARAGRAPH.PS_ML]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_ML]+Conversions.globalUnit,e[ATTR_PARAGRAPH.PS_MR]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_MR]+Conversions.globalUnit,e[ATTR_PARAGRAPH.PS_TI]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_TI]+Conversions.globalUnit,void 0!=ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_PB]?e[ATTR_PARAGRAPH.EN_PB]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_PB]:void 0==J("#enPageBreak").attr("checked")?e[ATTR_PARAGRAPH.EN_PB]=!1:e[ATTR_PARAGRAPH.EN_PB]=!0,void 0!=ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_BL]?e[ATTR_PARAGRAPH.EN_BL]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_BL]:void 0==J("#enKeepLines").attr("checked")?e[ATTR_PARAGRAPH.EN_BL]=!1:e[ATTR_PARAGRAPH.EN_BL]=!0,void 0!=ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_WO]?e[ATTR_PARAGRAPH.EN_WO]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.EN_WO]:void 0==J("#enablewidoworphan").attr("checked")?e[ATTR_PARAGRAPH.EN_WO]=!1:e[ATTR_PARAGRAPH.EN_WO]=!0,void 0!=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_PL]&&(e[ATTR_PARAGRAPH.PS_PL]=ParagraphPanel.newAttr[ATTR_PARAGRAPH.PS_PL]+Conversions.globalUnit),editor.doc.execCmd("applyLineSpacing",e)}},ParagraphPanel.updateMenu=function(e,t){var i=J("#fmt-lpnl-linespacemenu"),o=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.PARAGRAPH)[0],r=DocUtil.getParaFormat(o.getEnd()-1),n=r[ATTR_PARAGRAPH.PS_SA],a=r[ATTR_PARAGRAPH.PS_SB],l="1.2",s=DocUtil.copyStyle(editor.doc.getParaStyles());J("#lnSpcustom_linespacing").hide(),s=DocUtil.getComputedParaStyles(o.getEnd()-1,s),i.zmenu("hideMenuItem","#lnSpCustom"),r&&r[ATTR_PARAGRAPH.PS_LS]?l=parseFloat(r[ATTR_PARAGRAPH.PS_LS]):s.h0[ATTR_BODY.DS_LS]&&(l=parseFloat(s.h0[ATTR_BODY.DS_LS])),1.2==l?l="1_2":1.5==l?l="1_5":1==l||2==l?l=parseInt(l):(i.zmenu("showMenuItem","#lnSpcustom_linespacing").zmenu("changeLabel","#lnSpcustom_linespacing",l+" ("+J.i18n("writer.common.CUSTOM")+")"),l="custom_linespacing"),i.zmenu("check","lnSp"+l);var d="charspace",c=editor.doc.getSelection().getTextFormat();c[ATTR_TEXT.TS_CS]&&(d=parseFloat(c[ATTR_TEXT.TS_CS]));var p="charspace"+d,u=J("#"+p);i.zmenu("check",u[0]?u:J("#charspace")),n&&parseFloat(n)?i.zmenu("hideMenuItem","addSpaceA").zmenu("showMenuItem","delSpaceA"):i.zmenu("showMenuItem","addSpaceA").zmenu("hideMenuItem","delSpaceA"),a&&parseFloat(a)?i.zmenu("hideMenuItem","addSpaceB").zmenu("showMenuItem","delSpaceB"):i.zmenu("showMenuItem","addSpaceB").zmenu("hideMenuItem","delSpaceB")},TableMenu.onCellMouseOver=function(e){var t=e.target;inside_div=!0;for(var i=t.id,o=TableMenu.parseRowColumnFromId(i),r=o.row,n=o.col,a=1;a<=r;a++)for(var l=1;l<=n;l++)J("#showtd_"+a+"_"+l)[0].style.backgroundColor="#99c7ff";J("#display_div_ins_table").text(r+" x "+n+" "+J.i18n("writer.common.CELLS"))},TableMenu.onCellMouseOut=function(e){for(var t=(e.target,J("#showinserttabletbody")[0]),i=t.rows,o=i.length,r=1;r<=o;r++)for(var n=1;n<=i[r-1].cells.length;n++)J("#showtd_"+r+"_"+n)[0].style.backgroundColor="#fff";J("#display_div_ins_table").text("0 x 0 "+J.i18n("writer.common.CELLS"))},TableMenu.onCellMouseUp=function(e){var t=e.target;if(1==e.which){var i=TableMenu.parseRowColumnFromId(t.id),o=i.row,r=i.col;editor.doc.execCmd("instable",[o,r])}},TableMenu.parseRowColumnFromId=function(e){var t=e.split("_"),i=t[1],o=t[2],r={row:i,col:o};return r},ConvertTextToTable=function(){var e={get:function(e,t){return"COLUMNS"==e?ConvertTextToTable.noOfCols:"ROWS"==e?ConvertTextToTable.noOfRows:"DELIMITER"==e?ConvertTextToTable.getCurrentDelimStr():"OTHER_DELIM"==e?"-":void 0},set:function(e,t,r){if("COLUMNS"==e.action){var n=63,a=1;t>n||t<a?(J("#errmsg_table").show().html(UIUtils.getErrorMsg("error",J.i18n("writer.table.ENTER_PROPER_VAL"))),J("#convertTextToTableBtn").disable()):(J("#errmsg_table").hide(),J("#convertTextToTableBtn").enable(),ConvertTextToTable.noOfCols=t,ConvertTextToTable.noOfRows=ConvertTextToTable.getRowCountFromColsCount(ConvertTextToTable.noOfCols),J("#rowCount").val(ConvertTextToTable.noOfRows))}else"DELIMITER"==e.action?(t=J(r).attr("value"),ConvertTextToTable.delim=o(t),""!=ConvertTextToTable.delim&&i(ConvertTextToTable.delim)):"OTHER_DELIM"==e.action&&J("#delim_other").attr("checked")&&""!=t&&(ConvertTextToTable.delim=t,i(ConvertTextToTable.delim))}},t=function(){ConvertTextToTable.initialRows=1,ConvertTextToTable.initialCols=1,ConvertTextToTable.noOfRows=ConvertTextToTable.noOfCols=1,ConvertTextToTable.delim=",",ConvertTextToTable.tableValuesOpsArr=[],ConvertTextToTable.selectedTxt="";var e=editor.doc.getCharAt(editor.doc.getSelection().getEnd()-1)==UNICODE.PARA?editor.doc.getSelection().getEnd()-1:editor.doc.getSelection().getEnd();if(ConvertTextToTable.selectedTxt=editor.doc.getContent(editor.doc.getSelection().getStart(),e),""==ConvertTextToTable.selectedTxt)return void MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,null,J.i18n("writer.table.CONVERT_TO_TABLE_TITLE_MSG"),J.i18n("writer.table.CONVERT_TO_TABLE_MSG"));var t=ConvertTextToTable.initCellCounts(ConvertTextToTable.selectedTxt,ConvertTextToTable.delim);ConvertTextToTable.noOfRows=ConvertTextToTable.initialRows=t.rows,ConvertTextToTable.noOfCols=ConvertTextToTable.initialCols=t.cols,J.dialogutil.open("converttexttotabledlg",J("#ins-lpnl-img"),this.dialogInfo),Utils.addToStatistics("TextToTable")},i=function(e){if(e||(e=J("#delim_other_value").val()),""!=e){ConvertTextToTable.delim=e,J("#convertTextToTablePopup_demlimiter").attr("checked",!0);var t=ConvertTextToTable.initCellCounts(ConvertTextToTable.selectedTxt,e);ConvertTextToTable.noOfRows=ConvertTextToTable.initialRows=t.rows,ConvertTextToTable.noOfCols=ConvertTextToTable.initialCols=t.cols,J("#columnCount").val(ConvertTextToTable.noOfCols).zspinner("setValue",ConvertTextToTable.noOfCols),J("#rowCount").val(ConvertTextToTable.noOfRows)}},o=function(e){return"PARAGRAPH"==e?"\n":"COMMA"==e?",":"TAB"==e?"\t":"OTHER"==e?J("#delim_other_value").val():void 0},r=function(){return J("#delim_other").attr("checked")&&""==J("#delim_other_value").val()?(UIUtils.showMessagePopup(J.i18n("writer.table.MUST_TYPE_SEPARATOR"),J.i18n("table","MUST_TYPE_SEPARATOR_TITLE_MSG"),"info"),!1):(ConvertTextToTable.tableValuesOpsArr=ConvertTextToTable.getCellValuesOps(ConvertTextToTable.selectedTxt,ConvertTextToTable.noOfRows,ConvertTextToTable.noOfCols,ConvertTextToTable.delim),editor.doc.execCmd("convertTextToTable",[ConvertTextToTable.tableValuesOpsArr.length,ConvertTextToTable.noOfCols,ConvertTextToTable.tableValuesOpsArr]),void J.dialogutil.close("converttexttotabledlg"))},n=function(e){var t=ConvertTextToTable.initialRows;return e<ConvertTextToTable.initialCols?t=Math.ceil(ConvertTextToTable.initialCols/e)*t:"\n"==ConvertTextToTable.delim&&e>ConvertTextToTable.initialCols&&(t=Math.ceil(ConvertTextToTable.initialRows/e)),t},a=function(){return"\n"==ConvertTextToTable.delim?"PARAGRAPH":","==ConvertTextToTable.delim?"COMMA":"\t"==ConvertTextToTable.delim?"TAB":"OTHER"},l=function(e,t){var i,o,r=e.splitWithIndex("\n");if("\n"==t)i=r.length,o=1;else{i=r.length,o=1;for(var n=0;n<r.length;n++){var a=r[n][1],l=a.splitWithIndex(t);l.length>o&&(o=l.length)}}return{rows:i,cols:o}},s=function(e,t,i){if(e!=t){var o=editor.doc.createRange(e,t),r=o.getSelectedOps();r.shift(),i.push(r)}else i.push(void 0)},d=function(e,t,i,o){var r=[],n=e.splitWithIndex("\n"),a=editor.doc.getNodesInSelection(NODE_TYPE.PARAGRAPH,editor.doc.getSelection().getStart(),editor.doc.getSelection().getEnd());if("\n"==o)for(var l=0;l<n.length;l++){var d=editor.doc.getSelection().getStart()+n[l][0],c=d+n[l][1].length,p=a[l].attr("*"),u={};u.paraFormat=p;var f=[];s(d,c,f),u.cellValuesOpsArr=f,r.push(u)}else for(var l=0;l<n.length;l++){var g=n[l][1],m=g.splitWithIndex(o),h=editor.doc.getSelection().getStart()+n[l][0],p=a[l].attr("*"),u={};u.paraFormat=p;for(var f=[],T=m.length,E=Math.ceil(T/i),R=0,S=0;S<E;S++)for(var O=0;O<i;O++)if(R=S*i+O,R>=T)f.push(void 0);else{var d=h+m[R][0],c=d+m[R][1].length;s(d,c,f)}u.cellValuesOpsArr=f,r.push(u)}return r},c=function(){var e=UNICODE.TABLE+"|"+UNICODE.HR+"|"+UNICODE.CELL+"|"+UNICODE.ROW+"|"+UNICODE.TABLEEND+"|"+UNICODE.SECTION_START+"|"+UNICODE.TOCSTART+"|"+UNICODE.TOCEND,t=editor.doc.findNextIndexOf(e,editor.doc.getSelection().getStart());return t!=-1&&t<editor.doc.getSelection().getEnd()};return{canConvert:function(){var e=editor.clientActiveSection.className;return!editor.doc.getSelection().isCollapsed()&&!c()&&e.indexOf("zw-footnotepane")==-1&&e.indexOf("zw-endnotepane")==-1},getRowCountFromColsCount:n,initCellCounts:l,getCellValuesOps:d,getCurrentDelimStr:a,convert:r,getDelim:o,updateCellCountsFromDelim:i,init:t,dialogInfo:e}}(),ConvertTableToText=function(){var e=function(){ConvertTableToText.delimiter=",",J.dialogutil.open("converttabletotextdlg",void 0,this.dialogInfo)},t={get:function(e,t){return"DELIMITER"==e?ConvertTableToText.getCurrentDelimStr():"OTHER_DELIM"==e?"-":"CONVERT_NESTED_TABLES"==e?(ConvertTableToText.convertNestedTables=!0,!0):void 0},set:function(e,t,i){"DELIMITER"==e.action?(t=J(i).attr("value"),"PARAGRAPH"==t?ConvertTableToText.enableConvertNestedTable():ConvertTableToText.disableConvertNestedTable(),ConvertTableToText.delimiter=ConvertTableToText.getDelim(t)):"OTHER_DELIM"==e.action?(ConvertTableToText.disableConvertNestedTable(),J("#tabletotext_delim_other").prop("checked")&&""!=t&&(ConvertTableToText.delimiter=t)):"CONVERT_NESTED_TABLES"==e.action&&(J("#convertNestedTables").prop("checked")?ConvertTableToText.convertNestedTables=!0:ConvertTableToText.convertNestedTables=!1)}},i=function(){return"\n"==ConvertTableToText.delimiter?"PARAGRAPH":","==ConvertTableToText.delimiter?"COMMA":"\t"==ConvertTableToText.delimiter?"TAB":"OTHER"},o=function(){J("#convertNestedTables").zstatebutton("checked",!0),J("#convertNestedTables").zstatebutton("disable"),ConvertTableToText.convertNestedTables=!0},r=function(){J("#convertNestedTables").zstatebutton("enable")},n=function(e){return"PARAGRAPH"==e?"\n":"COMMA"==e?",":"TAB"==e?"\t":"OTHER"==e?J("#tabletotext_delim_other_value").val():void 0},a=function(){var e=J("#tabletotext_delim_other_value").val();J("#tabletotext_delim_other").prop("checked")&&""!=e&&(ConvertTableToText.delimiter=e)},l=function(){return J("#tabletotext_delim_other").attr("checked")&&""==J("#tabletotext_delim_other_value").val()?(UIUtils.showMessagePopup(J.i18n("writer.table.MUST_TYPE_MERGER"),J.i18n("table","MUST_TYPE_MERGER_TITLE_MSG"),"info"),!1):(editor.doc.execCmd("convertTableToText",[ConvertTableToText.delimiter]),void J.dialogutil.close("converttabletotextdlg"))},s=function(e){var t=editor.doc.getSelection(),i=editor.doc.getParents(NODE_TYPE.TABLE,t.getStart()),o=i.getStart(),r=[];r.push({r:o-1});for(var n=editor.doc.createRange(i.getStart()-1,i.getStart()).getSelectedOps().slice(1),a=0;a<n.length;a++)r.push(n[a]);d(i,r,e,!1),Op.processMsg(r),t.deleteContents(i.getStart(),i.getEnd())},d=function(e,t,i,o){var r=function(e){e.push({as:{start:{type:"paragraph"}}},{is:"\n"},{as:{end:["type"]}})},n=function(e,t){for(var i=[],o=0;o<t.length-1;o++){var r={point:t[o],align:"0",leader:"0"};i.push(r)}e.push({as:{start:{tps:i,type:"paragraph"}}},{is:"\n"},{as:{end:["tps","type"]}})},a=e.children(),l=a.length,s=parseFloat(Conversions.toGlobalValue(ViewManager.getColumnWidth()+"px"));Conversions.isInMM&&(s/=Conversions.oneInchInMM);for(var c=0;c<l;c++)for(var p=[],u=a[c].children(),f=u.length,g=e.attr(),m=0;m<f;m++){if("\t"==i){var h=g.cols[m].wt;if("%"==h.slice(-1)){var T=parseFloat(h);h=T*s/100+"in"}if(0==p.length)p.push(Conversions.toGlobalValue(h));else{var E=parseFloat(p[p.length-1]);p.push(E+Conversions.toGlobalUnit(h)+Conversions.globalUnit)}}for(var R=u[m],S=R.children(),O=S.length,v=0;v<O;v++){var b=S[v];if(b.type==NODE_TYPE.TABLE){var A=b;if(ConvertTableToText.convertNestedTables)d(A,t,i,!0);else for(var y=editor.doc.createRange(A.getStart(),A.getEnd()).getSelectedOps().slice(1),D=0;D<y.length;D++)t.push(y[D])}else{var y,C=b;v==O-1?c==l-1&&m==f-1?(y=editor.doc.createRange(C.getStart(),C.getEnd()).getSelectedOps().slice(1),y=y.slice(-y.length,-3),"\t"!=i?r(y):n(y,p),o&&("\t"==i?n(y,p):(y=y.slice(-y.length,-3),r(y)))):(y=editor.doc.createRange(C.getStart(),C.getEnd()).getSelectedOps().slice(1),y=y.slice(-y.length,-3),m==u.length-1?"\t"==i?n(y,p):r(y):y.push({is:i})):(y=editor.doc.createRange(C.getStart(),C.getEnd()).getSelectedOps().slice(1),0==v&&"\t"==i&&(y=y.slice(-y.length,-3),r(y)));for(var D=0;D<y.length;D++)t.push(y[D])}}}},c=function(){return!0};return{init:e,dialogInfo:t,getCurrentDelimStr:i,disableConvertNestedTable:o,enableConvertNestedTable:r,getDelim:n,updateOtherDelimValue:a,convert:l,convertTableToText:s,canConvert:c}}(),TransposeTable=function(){var e=function(){for(var e=editor.doc.getSelection(),t=editor.doc.getParents(NODE_TYPE.TABLE,e.getStart()),i=t.children(),o=i.length,r=i[0].children().length,n=r,a=o,l=[],s=[],d=[],c=ViewManager.getViews(t.dtNode),p=c.length,u=[],f=0;f<p;f++)for(var g=c[f],m=g.getRowsHeight(),h=m.length,T=0;T<h;T++)u.push(m[T]);for(var E=[],R=0,S=u.length,f=0;f<S;f++){var O=u[f].ht,v=(O+"px").convertor().inches;R+=v,E.push(v)}for(var b,A=[],f=0;f<a;f++)if(t.dtNode.isTableWidthInPercentage){var y=E[f]/R*100+"%";A.push({wt:y})}else{b=Conversions.toGlobalValue(t.attr().wid);var y=E[f]/R*parseFloat(b)+"in";A.push({wt:Conversions.toGlobalValue(y)})}for(var D=[{as:{start:{theme:t.attr().theme,type:"table",wid:b||"100%",cols:A,ver:t.attr().ver}}},{is:""},{as:{end:["theme","type","wid","cols","ver"]}}],C=D.length,I=[{is:""}],P=I.length,_=[{as:{start:{ht:"auto",type:"row"}}},{is:""},{as:{end:["ht","type"]}}],N=_.length,f=0;f<o;f++){l.push([]);for(var L=i[f].children(),T=0;T<r;T++)l[f][T]=L[T]}for(var f=0;f<n;f++){s.push([]),d.push([]);for(var T=0;T<a;T++)s[f][T]={},d[f][T]={}}for(var f=0;f<o;f++)for(var T=0;T<r;T++)s[T][f]=l[f][T];for(var w=[{r:t.getStart()-1}],M=editor.doc.createRange(t.getStart()-1,t.getStart()).getSelectedOps().slice(1),U=M.length,f=0;f<U;f++)w.push(M[f]);for(var f=0;f<C;f++)w.push(D[f]);for(var f=0;f<n;f++)for(var T=0;T<a;T++){var x=s[f][T],F=editor.doc.createRange(x.getStart(),x.getEnd()).getSelectedOps().slice(1);delete F[0].as.start.ht;var k=F[0].as.start.merge;if(k)if("fc"==k){var B=F[0].as.start.rspan;F[0].as.start.rspan=F[0].as.start.cspan,F[0].as.start.cspan=B}else if("hmp"==k){for(var J=!1,H=f-1;H>=0;H--){var G=s[H][T],z=editor.doc.createRange(G.getStart(),G.getEnd()).getSelectedOps().slice(1),V=z[0].as.start.merge;if(!V)break;if("hmp"!=V){if("vmp"==V)break;if("fc"==V){J=!0;break}}}J&&(F[0].as.start.merge="vmp")}var Y=F[0].as.start.borders;if(void 0!=Y){for(var W=Object.keys(Y),j={},Z=0;Z<W.length;Z++)"border-top"==W[Z]?j["border-left"]=Y["border-top"]:"border-right"==W[Z]?j["border-bottom"]=Y["border-right"]:"border-bottom"==W[Z]?j["border-right"]=Y["border-bottom"]:"border-left"==W[Z]&&(j["border-top"]=Y["border-left"]);F[0].as.start.borders=j}d[f][T]=F}for(var f=0;f<n;f++){for(var X=0;X<N;X++)w.push(_[X]);for(var K=!1,$=0,T=0;T<a;T++){var x=s[f][T],F=d[f][T],q=F.length,k=x.attr().merge;k&&("fc"==k?(K=!0,$=F[0].as.start.cspan-1):"vmp"==k&&K&&$>0&&($--,F[0].as.start.merge="hmp",0==$&&(K=!1)));for(var X=0;X<q;X++)w.push(F[X])}}for(var f=0;f<P;f++)w.push(I[f]);Op.processMsg(w),e.deleteContents(t.getStart(),t.getEnd())},t=function(e){var t=e.children().length;if(t>30)return!1;for(var i=ViewManager.getViews(e.dtNode),o=i.length,r=0;r<o;r++)for(var n=i[r],a=n.getRowsHeight(),l=a.length,s=0;s<l;s++)if(0==a[s].ht)return!1;return!0};return{transpose:e,canAllowTransposeTable:t}}(),SplitTable=function(){var e=function(e,t){for(var i=editor.doc.createRange(e.getStart(),e.getEnd()).getSelectedOps(),o=i.slice(1,4),r=[{is:""}],n=[t];void 0!=t.nextSibling();)t=t.nextSibling(),n.push(t);for(var a=[],l=0;l<n.length;l++)for(var s=editor.doc.createRange(n[l].getStart(),n[l].getEnd()).getSelectedOps().slice(1),d=0;d<s.length;d++)a.push(s[d]);t=n[0],editor.doc.getSelection().deleteContents(t.getStart(),e.getEnd()-1);var c=[{r:e.getEnd()}];c.push({as:{start:{type:"paragraph"}}},{is:"\n"},{as:{end:["type"]}});for(var l=0;l<o.length;l++)c.push(o[l]);for(var l=0;l<a.length;l++)c.push(a[l]);for(var l=0;l<r.length;l++)c.push(r[l]);Op.processMsg(c);var p;t=n[0],void 0!=t.previousSibling()?(t=t.previousSibling(),p=t.getEnd()+2):p=t.getStart()+1,Op.resetCursorPos(),Op.fillCursorPos(p,p)},t=function(e){for(var t=e.children(),i=t.length,o=0;o<i;o++)if("vmp"==t[o].attr().merge)return!1;return!0};return{split:e,canAllowSplitTable:t}}(),function(){function e(e){var t;if("table"==e)var i=editor.doc.getSelection().parents(NODE_TYPE.TABLE),o=DocUtil.getDOMSourceIndex(i.getStart(),UNICODE.TABLE),t=DomUtil.getElementAt("table",o,editor.clientActiveSection);else if("tr"==e)var r=editor.doc.getSelection().parents(NODE_TYPE.ROW),o=DocUtil.getDOMSourceIndex(r.getStart(),UNICODE.ROW),t=DomUtil.getElementAt("tr",o,editor.clientActiveSection);else var n=editor.doc.getSelection().parents(NODE_TYPE.CELL),o=DocUtil.getDOMSourceIndex(n.getStart(),UNICODE.CELL),t=DomUtil.getElementAt("td",o,editor.clientActiveSection);return t}function t(e){var t=0;return"center"==e?t=1:"right"==e?t=2:"justify"==e&&(t=3),t}function i(e,t){var i,o=editor.doc.getNodesInSelection(NODE_TYPE.PARAGRAPH,e.getStart(),e.getEnd()),r=o.length;for(i=0;i<r;i++)o[i].attr(t)}var o,r,n,a,l,s,d,c,p,u,f,g,m={init:function(){o={},r={},n={},a={},l={},s={},f;var e,t=editor.doc.getSelection().parents(NODE_TYPE.TABLE),i=editor.doc.getSelection().parents(NODE_TYPE.ROW),d=editor.doc.getSelection().parents(NODE_TYPE.CELL),c=TableUtil.getCols(t);o=t.attr(),r=i.attr(),n=d.attr(),n.colWid=c[TableUtil.findColIdx(d)-1].wt;var p=d.attr(),u=editor.doc.getSelection();for(e in p)e==ATTR_CELL.TDS_VA||e==ATTR_CELL.TDS_TXTAL||e==ATTR_CELL.TDS_PT||e==ATTR_CELL.TDS_PR||e==ATTR_CELL.TDS_PB||e==ATTR_CELL.TDS_PL?n[e]=p[e]:u.isTableSelected()||e!=ATTR_CELL.TDS_WID||(n[e]=p[e])},get:function(t,i){t=t.action;var r,a=Conversions.showUnit,l=Conversions.step,s=22*Conversions.factor,m=s-s%Conversions.cellPaddingStep;if(s-=s%l,g=!1,o[ATTR_TABLE.TBLS_WID].indexOf(UNITS.PERCENTAGE)!==-1&&(g=!0,l=1,a="%"),"tbls_wid"==t){var h=editor.doc.getSelection().parents(NODE_TYPE.TABLE),T=h.attr().wid,E=ViewManager.getViewElements(h.dtNode,editor.getPageID()),R=TableUtil.getCols(h),S=20,O=parseFloat(Conversions.toGlobalValue(T)),v=20/parseInt(J(E).width())*100,b=parseFloat(g?100:Conversions.toGlobalValue(Z("editorpane").width()-(J(E).offset().left-Z("editorpane").offset().left)+UNITS.PIXELS)),A=parseFloat(g?v*R.length:Conversions.toGlobalValue(S*R.length+UNITS.PIXELS));return Conversions.isInMM&&(b=parseInt(b),A=parseInt(A),O=parseInt(O)),J(i).zspinner("setMaxValue",b),J(i).zspinner("setMinValue",A),J(i).zspinner("setStepValue",l),J(i).zspinner("setUnit",a),O}if("DIRECTION"==t){var y=o[ATTR_TABLE.TBLS_DIR]||PARA_DIR.LTR,D="ltr"==y?J.i18n("writer.common.LEFT_TO_RIGHT"):J.i18n("writer.common.RIGHT_TO_LEFT");return J("#tbl-lpnl-directionbtn").text(D),y}if("col_wid"==t){var C=editor.doc.getSelection();if(!C.isTableSelected()){J("#col_wid").enable(),d=g?n.colWid:parseFloat(Conversions.toGlobalValue(n.colWid)),l=Conversions.step;var r=parseFloat(d)%l;return 0!==r&&(l-=r),Conversions.isInMM&&(s=parseInt(s),d=parseInt(d)),i.focus(),J(i).zspinner("setMinValue",0),J(i).zspinner("setMaxValue",g?100:s),J(i).zspinner("setStepValue",l),J(i).zspinner("setUnit",a),d}J("#col_wid").disable()}else{if("rows_ht"==t){var I=editor.doc.getSelection().parents(NODE_TYPE.CELL),P=I.attr("ht");if(P)c=Conversions.toGlobalUnit(I.attr("ht"))+Conversions.showUnit;else{var _=e("tr");c=J(_).height()/Conversions.globalUnitInPx+Conversions.showUnit}A=parseFloat(Conversions.rowHtMinValue),Conversions.isInMM&&(s=parseInt(s),A=parseInt(A),c=parseInt(c)),l=Conversions.step;var r=parseFloat(c)%l;return 0!==r&&(l-=r),J(i).zspinner("setMinValue",A),J(i).zspinner("setMaxValue",s),J(i).zspinner("setStepValue",l),J(i).zspinner("setUnit",Conversions.showUnit),parseFloat(c)}if("cells_txtal"==t){var N=n[ATTR_CELL.TDS_TXTAL];return N=N?N:"left",p=N}if("cells_vtal"==t){var L=n[ATTR_CELL.TDS_VA];return L=L?L:"middle",u=L}if("tbls_al"==t){var w=o[ATTR_TABLE.TBLS_AL];return w||(w="left"),_tableAlign=w,_tableAlign}if("default_margin"==t){var M,U,x,F;if(x=n.pt?Conversions.toGlobalUnit(n.pt)+Conversions.globalUnit:Conversions.defaultCellPadding,U=n.pr?Conversions.toGlobalUnit(n.pr)+Conversions.globalUnit:Conversions.defaultCellPadding,F=n.pb?Conversions.toGlobalUnit(n.pb)+Conversions.globalUnit:Conversions.defaultCellPadding,M=n.pl?Conversions.toGlobalUnit(n.pl)+Conversions.globalUnit:Conversions.defaultCellPadding,M!=U||x!=F||x!=U)return J("#table-lpnl-custommargin").show(),"custom";if(J("#table-lpnl-custommargin").hide(),Conversions.globalUnit===UNITS.INCHES){if("0.059in"==M)return"normal";if("0.098in"==M)return"narrow";if("0.118in"==M)return"moderate";if("0.138in"==M)return"wide";if("0in"==M)return"none"}else if(Conversions.globalUnit===UNITS.MILLIMETERS){if("1.5mm"==M)return"normal";if("2.5mm"==M)return"narrow";if("3.0mm"==M||"3mm"==M)return"moderate";if("3.5mm"==M)return"wide";if("0mm"==M)return"none"}}else{if("tds_pt"==t){var k=Conversions.toGlobalUnit(n[ATTR_CELL.TDS_PT]);return k||(k=Conversions.defaultCellPadding),f=k,J(i).zspinner("setMinValue",Conversions.cellPaddingStep),J(i).zspinner("setMaxValue",m),J(i).zspinner("setStepValue",Conversions.cellPaddingStep),J(i).zspinner("setUnit",Conversions.showUnit),f}if("tds_pr"==t){var k=Conversions.toGlobalUnit(n[ATTR_CELL.TDS_PR]);return k||(k=Conversions.defaultCellPadding),f=k,J(i).zspinner("setMinValue",Conversions.cellPaddingStep),J(i).zspinner("setMaxValue",m),J(i).zspinner("setStepValue",Conversions.cellPaddingStep),J(i).zspinner("setUnit",Conversions.showUnit),f}if("tds_pb"==t){var k=Conversions.toGlobalUnit(n[ATTR_CELL.TDS_PB]);return k||(k=Conversions.defaultCellPadding),f=k,J(i).zspinner("setMinValue",Conversions.cellPaddingStep),J(i).zspinner("setMaxValue",m),J(i).zspinner("setStepValue",Conversions.cellPaddingStep),J(i).zspinner("setUnit",Conversions.showUnit),f}if("tds_pl"==t){var k=Conversions.toGlobalUnit(n[ATTR_CELL.TDS_PL]);return k||(k=Conversions.defaultCellPaddingLeft),f=k,J(i).zspinner("setMinValue",Conversions.cellPaddingStep),J(i).zspinner("setMaxValue",m),J(i).zspinner("setStepValue",Conversions.cellPaddingStep),J(i).zspinner("setUnit",Conversions.showUnit),f}if("tbl_autofit"==t)return TableUtil.isTableWidthInPercentage(o)?"fitToWindow":"fixedColumnWidth";if("cell_al"==t){var N=n[ATTR_CELL.TDS_TXTAL];N=N?N:"left";var L=n[ATTR_CELL.TDS_VA];L=L?L:"middle";var B=L+N;return B}if("left_indent"==t){var H=0;o[ATTR_TABLE.TBLS_ML]&&(H=Conversions.toGlobalValue(o[ATTR_TABLE.TBLS_ML])),r=J(i).zspinner("getValue")%l,0!=r&&(l-=r);var G=editor.doc.getBodyFormat(),z=Conversions.toGlobalValue(G[ATTR_BODY.DS_ML]),V=J("#editorpane"),Y=editor.doc.getSelection().parents(NODE_TYPE.TABLE),E=ViewManager.getViewElements(Y.dtNode,editor.getPageID()),W=J(E).offset().left-J(V).offset().left,j=J(V).width()-(W+J(E).width()),X=(j/Conversions.globalUnitInPx).toFixed(3),A=-parseFloat(z),b=parseFloat(H)+parseFloat(X);return J(i).zspinner("setMinValue",A),J(i).zspinner("setMaxValue",b),J(i).zspinner("setStepValue",l),J(i).zspinner("setUnit",Conversions.showUnit),parseFloat(H).toFixed(3)}}}},set:function(e,t,i){e.action&&/cols_wid|rows_ht|tds_pr|tds_pb|tds_pt|tds_pl|tbls_wid/.test(e.action)&&PanelUtil.setActiveLeftPanelSpinner(e.action);var o,r=Conversions.step,n=J(i);if(arguments[5].keyCode&&arguments[5].keyCode==KEYS.TAB?EventHandler.isDialogFocused=!0:EventHandler.isDialogFocused=!1,"tbls_wid"==e.action){var d,c,p,u=editor.doc.getSelection().parents(NODE_TYPE.TABLE),f=u.attr().wid,m=ViewManager.getViewElements(u.dtNode,editor.getPageID());if(g)p=t+UNITS.PERCENTAGE,d=u,c={ver:"4.0",wid:p};else{var h,T=TableUtil.getCols(u),E=t-parseFloat(f);for(h=0;h<T.length;h++){var R=T[h].wt,S=parseFloat(R)/parseFloat(f)*100;T[h].wt=Conversions.toGlobalValue(parseFloat(R)+parseFloat(E)/100*S)}p=Conversions.toGlobalValue(t),d=u,c={ver:"4.0",wid:p,cols:T}}var h;for(h=0;h<T.length;h++)if(0==Object.keys(T[h]).length||isNaN(parseFloat(T[h].wt))){Utils.sendErrorDetails("TABLE_RESIZE_FAIL<ZWERROR>"+editor.doc.getDocInfo().VERSION+"."+editor.doc.getDocInfo().REVISION+"."+editor.doc.getDocInfo().RID+"<ZWERROR>\n Error Log Start \n buildLabel: "+buildLabel+"\n Error Log End \n <ZWERROR>#### TABLE_RESIZE_FAIL: \n\n AditionalInfo: tableResizeByLeftPanel #####");break}editor.doc.execCmd("applyStyle",[d,c,"tableResize"]),Utils.addToStatistics("tableResize")}else if("DIRECTION"==e.action){var O=n.attr("value");a.dir=O}else if("col_wid"==e.action)t+=g?UNITS.PERCENTAGE:Conversions.globalUnit,s.colWid=t,o=n.zspinner("getValue")%r,0!==o&&(r-=o),J(i).zspinner("setStepValue",r);else if("rows_ht"==e.action)o=n.zspinner("getValue")%r,0!==o&&(r-=o),J(i).zspinner("setStepValue",r),l[ATTR_ROW.TRS_HT]=t+Conversions.globalUnit;else if("cells_txtal"==e.action)s[ATTR_CELL.TDS_TXTAL]=t;else if("tbls_al"==e.action)a[ATTR_TABLE.TBLS_AL]=t;else if("cells_vtal"==e.action)s[ATTR_CELL.TDS_VA]=t;else if("default_margin"==e.action){if("custom"==t)return void J("#table-lpnl-custommargin").show();J("#table-lpnl-custommargin").hide(),"normal"==t?s[ATTR_CELL.TDS_PT]=s[ATTR_CELL.TDS_PR]=s[ATTR_CELL.TDS_PB]=s[ATTR_CELL.TDS_PL]="1.5mm":"narrow"==t?s[ATTR_CELL.TDS_PT]=s[ATTR_CELL.TDS_PR]=s[ATTR_CELL.TDS_PB]=s[ATTR_CELL.TDS_PL]="2.5mm":"moderate"==t?s[ATTR_CELL.TDS_PT]=s[ATTR_CELL.TDS_PR]=s[ATTR_CELL.TDS_PB]=s[ATTR_CELL.TDS_PL]="3.0mm":"wide"==t?s[ATTR_CELL.TDS_PT]=s[ATTR_CELL.TDS_PR]=s[ATTR_CELL.TDS_PB]=s[ATTR_CELL.TDS_PL]="3.5mm":"none"==t&&(s[ATTR_CELL.TDS_PT]=s[ATTR_CELL.TDS_PR]=s[ATTR_CELL.TDS_PB]=s[ATTR_CELL.TDS_PL]="0.0mm")}else if("tds_pt"==e.action)s[ATTR_CELL.TDS_PT]=t.toFixed(3)+Conversions.globalUnit;else if("tds_pr"==e.action)s[ATTR_CELL.TDS_PR]=t.toFixed(3)+Conversions.globalUnit;else if("tds_pb"==e.action)s[ATTR_CELL.TDS_PB]=t.toFixed(3)+Conversions.globalUnit;else if("tds_pl"==e.action)s[ATTR_CELL.TDS_PL]=t.toFixed(3)+Conversions.globalUnit;else{if("cell_al"==e.action)return void editor.doc.execCmd(e.params[0],i.val());if("left_indent"==e.action){a[ATTR_TABLE.TBLS_ML]=parseFloat(t)+Conversions.globalUnit,o=t%r,0!=o&&(r-=o);var v=editor.doc.getSelection().parents(NODE_TYPE.TABLE),m=ViewManager.getViewElements(v.dtNode,editor.getPageID()),b=J("#editorpane"),A=J(m).offset().left-J(b).offset().left,y=J(b).width()-(A+J(m).width()),D=editor.doc.getBodyFormat(),C=D[ATTR_BODY.DS_ML],I=(y/Conversions.globalUnitInPx).toFixed(3),P=-parseFloat(C),_=parseFloat(t)+parseFloat(I);J(d).zspinner("setMinValue",P),J(d).zspinner("setMaxValue",_),J(d).zspinner("setStepValue",r),J(d).zspinner("setUnit",Conversions.showUnit)}}TablePanel.apply(),PanelUtil.updateTablePropWrapperPos()}};window.TablePanel={apply:function(){var e,o=[],d=[],c=[],p=null,u=editor.doc.getSelection(),p=u.parents(NODE_TYPE.TABLE);if(J.isEmptyObject(a)||(o.push(p),d.push(a)),!J.isEmptyObject(l)){TablePanel.getStyleDiff(l,r);if(u.isTableSelected()){var f=u.getSelectedCells(),m=f.length;for(e=0;e<m;e++)o.push(f[e]),d.push(l)}else{var h=u.parents(NODE_TYPE.ROW),T=h.children(),E=T.length;for(e=0;e<E;e++)o.push(T[e]),d.push(l)}}if(!J.isEmptyObject(s)){var R=(TablePanel.getStyleDiff(s,n),u.parents(NODE_TYPE.CELL));if(s.colWid){var S=0,O=R.getStart();if(g){var v=parseFloat(n.colWid),b=parseFloat(DocTreeManager.getTreeNodeAtIndex(O).actualWidth),A=parseFloat(s.colWid),y=b/v*A;S=y-b}else S=parseFloat(s.colWid)-parseFloat(n.colWid),S=Conversions.toPixels(S+Conversions.globalUnit);var D=R.dtNode,C=TableResize.getOriginalCellIdx(TableUtil.findColIdx(R),D.parent),I=TableResize.resizeColumnWidth(C,p,S);n.colWid=s.colWid;var P=I.eleArr,_=P.length,N=I.styArr;for(e=0;e<_;e++)P[e].dtNode.id!=R.dtNode.id?(o.push(P[e]),d.push(N[e])):(o.push(P[e]),d.push(s))}else if(u.isTableSelected()){var f=u.getSelectedCells(),m=f.length;for(e=0;e<m;e++){var L=f[e];o.push(L),c.push(L),d.push(s)}}else c.push(R),o.push(R),d.push(s)}if(s[ATTR_CELL.TDS_TXTAL]){var w={},M=c.length;for(w[ATTR_PARAGRAPH.PS_AL]=t(s[ATTR_CELL.TDS_TXTAL]),e=0;e<M;e++)i(c[e],w)}editor.doc.execCmd("applyStyle",[o,d,"applyTablePanelStyle"])},getStyleDiff:function(e,t){var i,o={};for(i in e)if(e.hasOwnProperty(i)){var r=e[i],n=t[i];r==n&&n||(o[i]=r)}return o},removeCellProperty:function(e){var t,i,o,r=editor.doc.getSelection().parents(NODE_TYPE.TABLE),n=r.children(),a=n.length;for(t=0;t<a;t++){var l=n[t];cells=l.children();var s=cells.length;for(i=0;i<s;i++){var d=cells[i];if(d.attr(e)){var c={},p=d.attr();for(o in p){p[o];o==e&&(c[o]="")}d.attr(c),editor.doc.execCmd("applyStyle",[d,c],"removeCellProperty")}}}},open:function(){LayoutManager.isRichEditActive()?LeftPanel.showSubPanel(ELEM_ID.TABLEOPTIONSPANEL,ANIMATIONS.FADEIN):LayoutManager.toggleRichEdit("open",ELEM_ID.TABLEOPTIONSPANEL),Z("tablepanel-tabs").ztab("selectTab",1),TablePanel.refreshTablePanel(),CellBorders.refreshValues(),TableBorders.refreshValues(),TableLeftPanelTheme.panelInit()},close:function(){LeftPanel.closeDynamicPanel(ELEM_ID.TABLEOPTIONSPANEL)},refreshPanels:function(){Z("cell-bdr-container"),Z("tbl-bdr-container");if(LeftPanel.isPanelVisible(ELEM_ID.TABLEOPTIONSPANEL)){var e=Z("tablepanel-tabs").ztab("getSelectedTab").children().attr("href");if("#tablepanel-design-tab"==e){var t=Z("tbl-prop-bdr-container").ztab("getSelectedTab").children().attr("href");if("#cell-bdr-container"==t)CellBorders.refreshValues();else{if("#tbl-bdr-container"!=t)return;TableBorders.refreshValues()}}else TablePanel.refreshTablePanel()}},refreshTablePanel:function(){if(!PanelUtil.activeLeftPanelSpinner||!/cols_wid|rows_ht|tds_pr|tds_pb|tds_pt|tds_pl|tbls_wid/.test(PanelUtil.activeLeftPanelSpinner)){var e=Z("table_properties");0!=e.length&&LeftPanel.isPanelVisible(ELEM_ID.TABLEOPTIONSPANEL)&&(selectedTabId=Z("tablepanel-tabs").ztab("getSelectedTab").children().attr("href"),"#tablepanel-layout-tab"==selectedTabId&&(e.data("ztrackObject")?e.ZCtrackObjects("refreshValues"):e.ZCtrackObjects({callbacks:m,fillVisible:!1,eventNameMapping:{zspinner:"spinnerblur"}})))}}};PubSub.subscribe(["Cursor/ParaChanged","Document/UndoRedo","TableThemes/themeChanged"],TablePanel.refreshPanels,{async:!0,timeout:1e3})}(),function(){function e(e){"string"==typeof e&&(e=jQuery.parseJSON(e));var t=editor.doc;g=e.orgImgURL,p=e.wmImgURL;var i=editor.doc.createElement(NODE_TYPE.BODY),o={};o[ATTR_BODY.WM_TYPE]="wmimg",o[ATTR_BODY.WM_OURL]=g,o[ATTR_BODY.WM_PURL]=c,o[ATTR_BODY.WM_URL]=p,o[ATTR_BODY.WM_OP]=u,o[ATTR_BODY.WM_SIZE]=f,o[ATTR_BODY.DS_BGC]=t.bodyFormat.bgc,editor.doc.execCmd("applyStyle",[i,o,"applyImgWatermarkStyle"]),J.dialogutil.close("watermark")}function t(){var t={progress:function(e){J("#wm-panel-importstatus").show(),J("#wm-panel-importstatusmsg").show().html(J.i18n("image","UPLOADING_MSG")).css("color","#000000"),J("#wm-panel-importloading").show()},success:function(t){editor.doc;return""===t?(J("#wm-panel-importstatusmsg").show().html(J.i18n("image","CORRUPTED_IMAGE_FILE")).css("color","red"),void J("#wm-panel-importloading").hide()):(e(t),J("#wm-panel-importstatusmsg").hide(),void J("#wm-panel-importloading").hide())},fail:function(e){return J("#imagefile").val(""),"string"==typeof e&&(e=jQuery.parseJSON(e)),"UNMATCHED_FILE_CONTENT_TYPE"===e.uploadedFileUrl?(J("#wm-panel-importstatusmsg").show().html(J.i18n("image","CORRUPTED_IMAGE_FILE")).css("color","red"),void J("#wm-panel-importloading").hide()):(J("#wm-panel-importstatusmsg").show().html(J.i18n("image","IMAGE_SIZE_EXCEED")).css("color","red"),void J("#wm-panel-importloading").hide())}},i={};f=J("#img_resize").zspinnerslider("getValue"),u=parseInt(J("#washout").zspinnerslider("getValue"))/100,u=u>1?1:u,"REMOTE"==editor.getEditorType()?i.rsid=RemoteEditor.rsid:i.rid=editor.doc.getDocInfo().RID,i.wmType="wmimg",i.resizeval=f;var o,r,n=editor.doc.getBodyFormat();if(o=n[ATTR_BODY.DS_PH].convertor().pixels,r=n[ATTR_BODY.DS_PW].convertor().pixels,i.pageHeight=o,i.pageWidth=r,i.washoutval=u,i.IMGSIZE=d,Utils.setCsrfParam(i),!m||m&&""==g)i.imagefile=J("#imagefile")[0],J.ajaxUpload(Utils.getUrl("watermarkpreview"),i,t,"json");else{i.orgimg=g;var a=Utils.getUrl("watermarkpreview");J.post(a,i,function(t){e(t)},"json")}}function i(){var e={},t=editor.doc;"default"==a&&(a="rgb(255, 255, 255)"),""==s&&(s="DRAFT"),e.WATERMARK_TXT=s,"REMOTE"==editor.getEditorType()?e.rsid=RemoteEditor.rsid:e.rid=editor.doc.getDocInfo().RID,e.FONTFAMILY=n,e.FONTSIZE=r,e.ANGLE=l,e.color=a,e.wmType="wmtxt",e.IMGSIZE=d;var i,o,u=editor.doc.getBodyFormat();i=u[ATTR_BODY.DS_PH].convertor().pixels,o=u[ATTR_BODY.DS_PW].convertor().pixels,e.pageHeight=i,e.pageWidth=o,Utils.setCsrfParam(e),J("#progressbar1").show(),J("#wm-panel-textimportstatus").show(),J("#wm-panel-textimportstatusmsg").show().html(J.i18n("mailmergepopup","PROCESSING")).css("color","#000000"),J("#wm-panel-textimportloading").show(),J.post(Utils.getUrl("watermarkpreview"),e,function(e){var i=e.wmImgURL;if(J("#progressbar1").hide(),J("#wm-panel-textimportloading").hide(),J("#wm-panel-textimportstatusmsg").html(""),"PreviewSize"==d)return void J("#WMTXT_PREVIEW").css("background-image","url("+i+")");p=e.wmImgURL;var o=editor.doc.createElement(NODE_TYPE.BODY),u={};u[ATTR_BODY.WM_TYPE]="wmtxt",u[ATTR_BODY.WM_FS]=r,u[ATTR_BODY.WM_FF]=n,u[ATTR_BODY.WM_TXT]=s,u[ATTR_BODY.WM_AN]=l,u[ATTR_BODY.WM_FGC]=a,u[ATTR_BODY.WM_PURL]=c,u[ATTR_BODY.WM_URL]=p,u[ATTR_BODY.DS_BGC]=t.bodyFormat.bgc,editor.doc.execCmd("applyStyle",[o,u,"applyTextWatermarkStyle"]),J.dialogutil.close("watermark"),p="",m=!1},"json").error(function(e){J("#wm-panel-textimportstatusmsg").show().html(J.i18n("image","PLEASE_ENTER_VALID_TEXT")).css("color","red"),J("#wm-panel-textimportloading").hide(),J("#progressbar1").hide()})}var o=!0,r="60",n="arial,helvetica,sans-serif",a="rgb(0, 0, 0)",l="diagonal",s="",d="A4Size",c="",p="",u="0.6",f="100",g="",m=!1,h={set:function(e,t,i){if("FONTSIZE"==e.action)r=t;else if("FONTFAMILY"==e.action)n=t;else if("FONTCOLOR"==e.action)a=t;else if("Diagonal"==e.action)l="diagonal";else if("Horizontal"==e.action)l="horizontal";else if("WMTEXT"==e.action){s=Utils.removeUnWantedUnicodes(t);var d=new RegExp(/^(a-z|A-Z|0-9)*[^`~,.<>;':"!\/\[\]\|{}()=_+-]*$/),p=d.test(s);if(!p)return J("#wm-panel-textimportstatusmsg").show().html(J.i18n("writer.image.PLEASE_ENTER_VALID_TEXT")).css("color","red"),void(s="");J("#wm-panel-textimportstatus").hide()}else if("TEXTWM"==e.action)o=!0,wmType="wmtxt",J("#watermarkAsPicture").hide(),J("#watermarkAsText").show();else if("IMGWM"==e.action)wmType="wmimg",J("#watermarkAsText").hide(),J("#watermarkAsPicture").show(),o=!1;else if("IMGSIZE"==e.action)f=parseInt(t);else if("WASHOUT"==e.action)t=parseInt(t),u=t/100;else if("IMAGEFILE"==e.action){var h=J("#imagefile").val();Utils.isValidImage(h)?(J("#imageurl").text(h),J("#wm-panel-importstatus").hide(),m&&(g="")):(J("#wm-panel-importstatus").show(),J("#wm-panel-importstatusmsg").show().html(J.i18n("image","INVALID_IMG_EXT")).css("color","red"),J("#wm-panel-importloading").hide(),J("#imagefile").val(""))}else"IMAGEFILE"==e.action&&m&&c&&(g="")},get:function(e,t){e=e.action;var i=editor.doc.bodyFormat.wm_url;if("TEXTWM"==e){var d={panelId:ELEM_ID.WATERMARKPANEL,animationType:ANIMATIONS.FLIPIN,parentPanels:[ELEM_ID.PAGELAYOUTPANEL]};if(LeftPanel.showAdvancedPanel(d),J("#watermark-fmt-lpnl-fgcolorlist").bind("colorpalettecolorselected",function(e,t){J("#watermark-fmt-lpnl-fgcolor").children("span:first").css({"border-bottom":"2px solid "+t.color}),a=t.color}),o)return"TEXTWM"}else if("IMGWM"==e){if(!o)return J("#watermarkAsPicture").show(),J("#watermarkAsText").hide(),i&&J("#imageurl").text(i),"IMGWM"}else{if("WMTEXT"==e)return""==s&&(s=J.i18n("common","WATERMARK.DRAFT")),s;if("FONTFAMILY"==e)return n;if("FONTCOLOR"==e)J("#watermark-fmt-lpnl-fgcolor").children("span:first").css({"border-bottom":"2px solid "+a});else{if("FONTSIZE"==e)return r;if("Diagonal"==e){if("diagonal"==l)return"Diagonal"}else if("Horizontal"==e){if("horizontal"==l)return"Horizontal"}else if("IMGWM"==e){if(!o)return"IMGWM"}else{if("WASHOUT"==e)return 100*u;if("IMGSIZE"==e)return f}}}}};window.Watermark={showWatermarkDlg:function(){var e=editor.doc.createElement(NODE_TYPE.BODY),t=e.attr("*");o=!t[ATTR_BODY.WM_TYPE]||"wmtxt"==t[ATTR_BODY.WM_TYPE],o?(t[ATTR_BODY.WM_TXT]&&(s=t[ATTR_BODY.WM_TXT]),t[ATTR_BODY.WM_AN]&&(l=t[ATTR_BODY.WM_AN]),t[ATTR_BODY.WM_FGC]&&(a=t[ATTR_BODY.WM_FGC]),t[ATTR_BODY.WM_FS]&&(r=t[ATTR_BODY.WM_FS]),t[ATTR_BODY.WM_FF]&&(n=t[ATTR_BODY.WM_FF])):(t[ATTR_BODY.WM_SIZE]&&(f=t[ATTR_BODY.WM_SIZE]),t[ATTR_BODY.WM_OP]&&(u=t[ATTR_BODY.WM_OP])),t[ATTR_BODY.WM_PURL]&&(c=t[ATTR_BODY.WM_PURL]),t[ATTR_BODY.WM_OURL]&&(g=t[ATTR_BODY.WM_OURL]),g&&(m=!0),FetchHTML.get({requestName:"watermark",target:"#subpanel-watermark",callback:function(){var e=J("#subpanel-watermark");e.data("ztrackObject")?e.ZCtrackObjects("refreshValues"):e.ZCtrackObjects({callbacks:h,fillVisible:!1,eventNameMapping:{zspinner:"spinnerblur",zspinnerslider:"spinnerslidersubmit"}})}})},apply:function(){if(J("button.WatermarkRemove").button("enable"),d="A4Size",o)Utils.addToStatistics("TxtWaterMark"),i();else{if(Utils.addToStatistics("ImgWaterMark"),"No File Chosen"==J("#imageurl").html())return;Utils.addToStatistics("ins_wm"),t()}},remove:function(){c="",p="",g="",m=!1,s="",o?(J("#imageurl").text("No File Chosen"),J("#watermark_text").val(""),J("#wm-panel-textimportstatus").hide()):(J("#wmimgurl").hide(),J("#imageurl").text("No File Chosen"),J("#wm-panel-importstatus").hide()),editor.doc.execCmd("delete","watermark"),J("button.WatermarkRemove").button("disable")},preview:function(){var e=J("#watermark_ui").zvalidation("validateAllFields",J("#watermark_ui"));if(e)if(d="PreviewSize",o)i();else{if(!J("#imagefile").val()&&J("#WMIMG_PREVIEW").css("background-image").indexOf("image.do")<0)return void J("#wm-panel-importstatusmsg").show().html(J.i18n("image","PLEASE_SELECT_AN_MAGE"));t()}},showFileUpload:function(){f=100,u=.6,J("#img_resize").zspinner("setValue",f+"%"),J("#washout").zcombo("setValue",100*u+"%"),J(J("div#WMIMG_PREVIEW").find("img")[0]).remove(),J("#wmimgurl").attr("style","display:none"),J("#wmimgfile").attr("style","display:block;width:175px;float:left;overflow:hidden"),J("#wmnew").text(""),J("#imagefile").val(""),J("#imageurl").val(""),J("div#WMIMG_PREVIEW").css("background",""),m=!1}}}();var WordCountDlg=function(){var e=function(){Utils.addToStatistics("wordCnt");var e=WC.getWordCountDetails();J.dialogutil.open("wcdialog",J("#rt_btn_wordcount"),{get:function(t,i){"SHOWWORDCOUNT"==t&&(J("span#w_words").html(e.wordcount),J("span#w_chars_spaces").html(e.charCountWithSpaces),J("span#w_chars_out_spaces").html(e.charCountWithoutSpaces),J("span#w_sel_words").html(e.sel_wordcount),J("span#w_sel_chars_spaces").html(e.sel_charcount_withspaces),J("span#w_sel_chars_out_spaces").html(e.sel_charcount_withoutspaces))}})},t=function(){var e=WC.getWordCountDetails();J("span.wordCnt").html((e.sel_wordcount?e.sel_wordcount+"/":"")+e.wordcount),J("span.charCnt").html((e.sel_charcount_withspaces?e.sel_charcount_withspaces+"/":"")+e.charCountWithSpaces)};return PubSub.subscribe("Para/Modify",t,{async:!0,timeout:3e3}),Array.prototype.forEach.call(["Cursor/Collapsed","Cursor/Selected"],function(e){PubSub.subscribe(e,t,{async:!0,timeout:500})}),{insertWCDlg:e,updateWordCountInBottomPannel:t}}();!function(e){e.fcomponents=e.extend(!0,e.fcomponents,{getCurrentDocStatus:function(){return"0"==editor.doc.getDocInfo().REVISION||window.isMacNative?0:1}})}(jQuery),TabKeyHandler=function(){},TabKeyHandler.getNextVisibleCell=function(e,t){for(;e&&!TableUtil.isVisibleCell(e.getStart());){var i=e;if(e=t?e.previousSibling():e.nextSibling(),!e){var o=i.parentNode();o=t?o.previousSibling():o.nextSibling(),o&&(e=t?o.lastChild():o.firstChild())}}return e},TabKeyHandler.tabKeyHandling=function(e){var t=editor.doc.getSelection();t.isTableSelected()&&t.removeTableSelection();var i,o,r,n=t.parents(NODE_TYPE.CELL),a=t.getNodesInSelection(NODE_TYPE.PARAGRAPH,t.getStart(),t.getEnd());if(n){var l=e?n.previousSibling():n.nextSibling();if(l=TabKeyHandler.getNextVisibleCell(l,e))if(l.getEnd()-l.getStart()==2){var s=l.firstChild();t.removeAllRanges().moveTo(s,!0)}else i=l.getStart()+1,o=l.getEnd()-1,r=editor.doc.createRange(i,o),t.removeAllRanges().setSelectionType(SEL_AUTO_GEN).addRange(r);else{var n,d=t.parents(NODE_TYPE.ROW),c=e?d.previousSibling():d.nextSibling();if(c&&(n=e?c.lastChild():c.firstChild(),n=TabKeyHandler.getNextVisibleCell(n,e)),c&&n)if(n.getEnd()-n.getStart()==2){var s=n.firstChild();t.removeAllRanges().moveTo(s,!0)}else i=n.getStart()+1,o=n.getEnd()-1,r=editor.doc.createRange(i,o),t.removeAllRanges().addRange(r);else if(e){var n=t.parents(NODE_TYPE.CELL);if(n){var p=n.previousSibling();p&&t.removeAllRanges().moveTo(p,!1)}}else editor.doc.execCmd("insrowafter")}}else if(a.length)if(1==a.length){var s=a[0],u=t.find("previous",NODE_TYPE.PARAGRAPH+"|"+NODE_TYPE.TEXT),f=t.find("next",NODE_TYPE.TEXT),g=s.attr(ATTR_PARAGRAPH.PS_TPS);u||(u=t.find("next",NODE_TYPE.PARAGRAPH));var m=Conversions.toGlobalUnit(editor.doc.getBodyFormat()[ATTR_BODY.DS_TPS]),h=[],T=[],E=t.getLastRange(),R=E.start==a[0].getStart();if(!a[0].dtNode.isCode()&&u&&u.type==NODE_TYPE.PARAGRAPH&&("list"==s.attr(ATTR_PARAGRAPH.PS_TYPE)||f&&(!g||g&&0==g.length||R))){var S=J(editor.doc.getCursorPortionNode()).parents("div.zw-paragraph"),O=S.attr("data-listids"),a=J(editor.clientActiveSection).find("[data-listids="+O+"]");if(a[0]==S[0]){for(var v=Conversions.toGlobalUnit(editor.doc.getPaperWidth()/96+"in"),b=0;b<a.length;b++){var s=DocUtil.getDocElement(a[b]),A={};if(s){var y=s.attr(ATTR_PARAGRAPH.PS_ML);if(y)if(y=Conversions.toGlobalUnit(y),e){if(!(y&&y>m))break;y=y-m+Conversions.globalUnit}else{if(v==y&&0==b)break;y=y+m+Conversions.globalUnit}A[ATTR_PARAGRAPH.PS_ML]=y,h.push(s),T.push(A)}}editor.doc.execCmd("applyStyle",[h,T,"updateParaMarginLeft"])}else{var D=s.attr(ATTR_PARAGRAPH.PS_TI),A=(s.attr(ATTR_PARAGRAPH.PS_ML),{});D&&0!=parseFloat(D)||"list"==s.attr(ATTR_PARAGRAPH.PS_TYPE)||e||R&&!t.isCollapsed()?e&&"list"!=s.attr(ATTR_PARAGRAPH.PS_TYPE)&&D&&0!=parseFloat(D)&&(!R||t.isCollapsed())?(A[ATTR_PARAGRAPH.PS_TI]=0,h.push(s),T.push(A),editor.doc.execCmd("applyStyle",[h,T,"updateParaTextIndent"])):editor.doc.execCmd(e?"outdent":"indent"):(A[ATTR_PARAGRAPH.PS_TI]=m+Conversions.globalUnit,h.push(s),T.push(A),editor.doc.execCmd("applyStyle",[h,T,"updateParaTextIndent"]))}}else TabKeyHandler.insertTab()}else ZWCode.isOnlyCodeParas(a)?TabKeyHandler.insertTabs(a):editor.doc.execCmd(e?"outdent":"indent")},TabKeyHandler.insertTab=function(){var e=editor.doc.createElement(NODE_TYPE.TEXT,UNICODE.TAB);e.css={st:"tab",type:"text"},editor.doc.execCmd("insert",e)},TabKeyHandler.insertTabs=function(e){editor.doc.execCmd("inserttab",e)};var AutoText=function(){"use strict";var e=null,t=function(e,t){J.dialogutil.close("insertautotxtdlg"),J.ZContextMenu.hideMenu();var o,r={autoTxtName:e,deleteSingleAutoTxt:function(){i(this.autoTxtName)}};o=t?AutoText.deleteall:r.deleteSingleAutoTxt.bind(r),UIUtils.showMessagePopup(J.i18n("writer.common.DELETE_AUTOTEX_MSG"),J.i18n("writer.common.DELETE_AUTOTEX_TITLE_MSG"),"warning",o,!1,!0,null,null)},i=function(t){var i={};i.AUTOTXT_NAME=t,Utils.setCsrfParam(i);var o={id:t,success:function(){delete e[t],J.ZContextMenu.highlightItem(J("#quicktextbtn"),!0);}};J.ajax({type:"POST",global:!1,url:Utils.getNiceUrlPrefix("autotext/delete"),data:i,async:!0,error:function(e){},success:function(e){o.success()}})},o=function(){var e=editor.doc.getSelection();if(e.getEnd()-e.getStart()>1e3)return void MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_ALERT,J.i18n("writer.error.OOPS"),J.i18n("writer.quicktext.MAX_CHAR_EXCEDDED_MSG"),null,null);var t={init:function(){EventHandler.isDialogOpened=!0,J.dialogutil.close("insertautotxt")},open:function(){J("#previewSelCont").html(r())}};J.dialogutil.close("insertautotxt"),J.dialogutil.open("insertautotxtdlg",J("#autoTxt"),t),Z("qt-error-message").hide()},r=function(){var e=editor.doc.getSelection().getLastRange(),t=e&&HTMLUtil.getHTML(e)||"";if(""==t&&Resize.getTargetImg()){var i=editor.doc.getSelection().getLastRange();t=HTMLUtil.getHTML(editor.doc.createRange(i.start,i.start+1))}return t},n=function(){var e=J("#insertautotxtdlg"),t=e.zvalidation("validateAllFields",e);if(t){var i=J("#insertTxt");i.text(J.i18n("editor","SAVING")),i.addClass("ui-italic"),i.disable(),p()}},a=function(t,i){var o=new FormData;o.append("content",i),o.append("image",t.imageFile),o.append("name",J("#autoTxtBox").val()),o.append(csrfParamName,getcsrf()),J.ajax({type:"POST",dataType:"json",url:Utils.getNiceUrlPrefix("autotext/insert"),data:o,enctype:"multipart/form-data; "+t.type,contentType:!1,processData:!1,success:function(t){e=t,J.dialogutil.close("insertautotxtdlg")},error:function(e,t,i){Z("qt-error-message").show()}})},l=function(t){PasteUtil.preparePasteDiv(!1);var i=J(t).attr("qtid"),o=e[i].content;document.getElementById("_zohoPaste");PasteUtil.insertCustomContent(J("<div>"+o+"</div>")[0]),InsertShape.clearSelection(),J.dialogutil.close("insertautotxt"),UIUtils.hidePasteToolbar()},s=function(){if(e)d(e);else{var t={};Utils.setCsrfParam(t),Utils.addToStatistics("Quicktext"),J.ajax({type:"POST",global:!1,url:Utils.getNiceUrlPrefix("autotext/view"),data:t,async:!1,error:function(e){},success:function(t){e=t,d(e)}})}},d=function(e){var t=J("div#autoTxtDiv");t.find(".autoTxtBox").remove();var i=Object.keys(e);if(0==i.length)return void J(".savetxttogallerysep").hide();for(var o=Handlebars.compile(J("#autotext-view-card").html()),r=0;r<i.length;r++){var n=i[r],a=e[n];a.id=n;var s=J(o(a));t.append(s),s.find("img").load(function(){J(this.previousSibling).addClass("ui-hide"),this.style.height=this.naturalHeight/2+"px",this.style.width=this.naturalWidth/2+"px",this.style.display="block"})}J(".autoTxtBox").hover(function(){J(this).find("#autoTxtDel").show(),J(this).append(J("#autoTxtApply").show())},function(){J(this).find("#autoTxtDel").hide()}),J(".autoTxtBox").click(function(e){l(this),J.ZContextMenu.hideMenu(),J.ZContextMenu._isMenuShowing=!1}),J("div#autoTxtDel").click(function(e){e.stopPropagation();var t=J(this).parents(".autoTxtBox"),i=t.attr("qtid");AutoText.deleteConformation(i)})},c=function(e,t){var i=editor.doc.getSelection()[0].collapsed;J("#savetxttogallerybtn")[i?"disable":"enable"](),AutoText.view()},p=function(){var e=J("#previewSelCont").html(),t=J.parseHTML(e);if(e.indexOf("base64,")!=-1)for(var i=J(t),o=0;o<i.length;o++)if("IMG"==i[o].nodeName){var r=HTMLUtil.storeImageInFileStore(J(i[o]).attr("src"));J(i[o]).attr("src","/writer/"+r)}var n=J("#previewSelCont").html(t),l={previewHtml:n.html(),success:function(e){a(e,this.previewHtml)},onpreloaded:function(e){var t=e.elements.parent();t.attr("style","overflow:visible !important; height:auto !important;"),e.elements.attr("style","overflow:visible !important; height:auto !important;");var i=e.elements.height();e.elements.width();t.attr("style","overflow:visible !important; height:"+i+"px !important;"),e.elements.attr("style","overflow:visible !important; height:"+i+"px !important;")},onparsed:function(e){e.elements.parent().attr("style","")}};UIUtils.convertHTMLToBlob(n,l)};return{deleteConformation:t,getTextnamePopup:o,beforeShow:c,saveSelection:n,view:s}}();!function(){var e={get:function(e,t){var i;if("formula"==e)return i=editor.doc.getSelection().getStart(),DocTreeManager.getFormulaAtIndex(i).text||"="},set:function(e,t,i){var o,r;if("pasteFn"==e.action){var o=document.getElementById("formula");if(r=o.value.length,editor.browserInfo.is_ie){o.focus();var n=document.selection.createRange();n.moveStart("character",o.value.length)}var a=J("#formula").val();J("#formula").val(a.substr(0,r)+t+a.substr(r)),J("#pasteFunction option:first-child").attr("selected","selected"),J("#formula").focus()}}};window.FormulaHandler={showFormulaDialog:function(){J.dialogutil.open("formula",null,e,null,{onLoad:this.setFocus}),setTimeout(function(){J("#formula").focus()},200)},enterFormula:function(){var e=J("#formula").val();editor.doc.execCmd("updateFormula",["autoformula",e]),J.dialogutil.close("formula")},updateFormula:function(){var e,t,i,o,r,n,a=editor.doc.getSelection(),l=a.getSelectedCells(),s=l.length,d=FormulaHandler.isFormulaInSelection();if(d){if(a.isTableSelected()&&s>0)for(e=0;e<s;e++)o=l[e].dtNode,i=ViewManager.getViews(o)[0].el,J(i).find("div[data-fieldtype=autoformula]").length>0&&(t=DocTreeManager.getFormulaAtIndex(o.getIndex()+1),r=DocUtil.copyStyle(editor.doc.getRawFormatAt(t.index)),n=editor.doc.createElement(NODE_TYPE.AUTOFIELD,r),n.setStart(t.index),n.setEnd(t.index+1),n.attr(r));else t=DocTreeManager.getFormulaAtIndex(editor.doc.getSelection().getStart()),r=DocUtil.copyStyle(editor.doc.getRawFormatAt(t.index)),n=editor.doc.createElement(NODE_TYPE.AUTOFIELD,r),n.setStart(t.index),n.setEnd(t.index+1),n.attr(r);Op.sendMsg()}},updateAllFormulaInTable:function(){var e=editor.doc.getSelection().getStart(),t=editor.doc.createElement(NODE_TYPE.AUTOFIELD,{}),i=TableUtil.getTableStart(e),o=TableUtil.getTableEnd(e);t.setStart(i),t.setEnd(o),t.updateAllFileds("autoformula"),Op.sendMsg()},isFormulaInSelection:function(){var e=editor.doc.getSelection(),t=e.getLastRange();if(t.isPartialTableSelected()||t.isMultipleTablesSelected())return!1;var i=e.getSelectedCells();0==i.length&&(i=[e.parents(NODE_TYPE.CELL)]);for(var o=0;o<i.length;o++)for(var r=ViewManager.getViews(i[o].dtNode)||[],n=0;n<r.length;n++)if(J(r[n].el).find("div[data-fieldtype=autoformula]").length)return!0;return!1}}}();var Widget=function(){"use strict";var e,t,i,o=!1,r=function(){return!!J(".zw-ifr-div.ui-actv")[0]},n=function(){J("#searchSnippet").on("paste",function(e){var t=e.originalEvent.clipboardData.getData("text")||"";Widget.loadVideos(t)}),J("#embed-url").on("keydown",function(e){var t=e.keyCode||e.which,i=e.ctrlKey||e.metaKey;return!(!i||t!=KEYS.V)||void(t==KEYS.BACKSPACE||t==KEYS.DELETE?(this.selectionStart!=this.selectionEnd&&0==this.selectionStart&&this.selectionEnd==J(this).val().length?(J(this).val(""),J("#embedobjecterrormsg").hide()):J(this).select(),e.preventDefault()):e.preventDefault())}).on("paste",function(e){var t=/(<iframe.*?)/g,i=!1,o=e.originalEvent.clipboardData.getData("text"),r={};o.length>0&&(r=f(o));var n=t.exec(o);n&&r[ATTR_WIDGET.SRC]&&r[ATTR_WIDGET.SRC].match(ATTR_WIDGET.URL_REGEX)&&(i=!0),i?(J(this).val(o).text(o),J("#embed_url_btn").zbutton("enable"),J("#embedobjecterrormsg").hide()):J("#embedobjecterrormsg").show().text(J.i18n("writer.common.INVALID_CODE"))}),J("#searchSnippet").on("keyup",function(e){e.keyCode==KEYS.ENTER&&J(this).val().length>0&&Widget.loadVideos()}),e=!0},a=function(e,t){J(".ui-videoitem-vid,.ui-videoitem-insert").css("display","none"),J(".ui-videoitem-vid").attr("src",""),J(".ui-videoitem-img").css("display","block"),J(".ui-videoitem-play").css("display","");var i=J(t),o=i.parents(".ui-videoitem"),r=window.location.protocol+"//www.youtube.com/embed/"+e+"?autoplay=1&rel=0&showinfo=0&modestbranding=1&fs=0 allowfullscreen",n="<iframe class='ui-videoitem-vid ui-videoitem-cont' src='"+r+"'></iframe>";o.find(".ui-videoitem-vid").length>0?o.find(".ui-videoitem-vid").attr("src",r):o.find("#videoCont").append(n),o.find(".ui-videoitem-vid,.ui-videoitem-insert").css("display","block").end().find(".ui-videoitem-img,.ui-videoitem-play").css("display","none")},l=function(){var e=J("#searchSnippet").val().trim();if(!(e.length<1)){var t=J(".ui-video-listcont"),i=!1,o=J.ZVideoLibrary.PublicVideos.youtube,r={startIndex:0,limit:10,keyword:e,nextPageToken:"",contextPath:"/writer/fcomponents/"};o.load(void 0,r,function(e,o){try{if(i="string"==typeof o?JSON.parse(o):o,i&&i.TOTALCOUNT>0){for(var r="",n="",a=i.VIDEOS,l=0;l<a.length;l++){var s=a[l],d=s.VIDEO_DURATION,c=Math.floor(d/3600),p=Math.floor((d-3600*c)/60),u=Math.floor(d-3600*c-60*p);n="",c>0&&(n+=c+"h "),n+=p+" min ",n+=u+" sec ",r+="<div class='ui-videoitem'>",r+="<div class='ui-videoitem-top'>",r+="\t<div id='videoCont'>",r+="\t\t<img class='ui-videoitem-img ui-videoitem-cont' src='"+window.location.protocol+"//i.ytimg.com/vi/"+s.VIDEO_ID+"/hqdefault.jpg'/>",r+="\t</div>",r+="\t<div class='ui-videoitem-act ui-videoitem-play ui-play-ins'>",r+="\t\t<div class='ui-videoitem-act-cont'>",r+="\t\t<button class='ui-btn-blue ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only' noi18n='true' ctype='zbutton' onclick=Widget.loadCurVid('"+s.VIDEO_ID+"',this) class='ui-btn-blue'><span class='ui-button-text'>Play</span></button>",r+="\t\t<button class='ui-btn-blue ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only' onclick=Widget.insertVideo('"+s.VIDEO_ID+"','"+s.VIDEO_BIGIMAGE+"') ctype='zbutton' role='button' aria-disabled='false' autocomplete='off'><span class='ui-button-text'>Insert</span></button>",r+="\t</div>",r+="</div>",r+="</div>",r+="<div class='ui-videoitem-bottom'>",r+="\t<div noi18n='true' class='ui-videoitem-title'></div>",r+="\t<div noi18n='true' class='ui-videoitem-info'>"+n+" | "+s.VIDEO_UPLOADED+"</div>",r+="\t<div class='ui-videoitem-act ui-videoitem-insert'><div class='ui-videoitem-act-cont' >",r+="   \t<button class='ui-btn-blue ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only' onclick=Widget.insertVideo('"+s.VIDEO_ID+"','"+s.VIDEO_BIGIMAGE+"') ctype='zbutton' role='button' aria-disabled='false' autocomplete='off'>",r+="   \t<span class='ui-button-text'>Insert</span></button></div>",r+="\t</div>",r+="\t</div>",r+="</div>",r+="</div>",t.html(r),J(J(".ui-videoitem-title")[l]).text(s.VIDEO_NAME),r=t.html()}t.html(r),J("#yterrormsg").hide(),J("#ytvidscontainer").show()}else J("#ytvidscontainer").hide(),J("#yterrormsg").fadeIn("fast",function(){J("#yterrormsg .ui-video-errmsg-cont").text('" '+J("#searchSnippet").val()+' "')})}catch(e){i=!1}})}},s=function(){J.ZContextMenu.hideMenu();var e=J("#embed-url").text();if(e.length>0){var t={};t=f(e),d(t)}},d=function(e){var t=p(e);return t[ATTR_WIDGET.SRC].match(ATTR_WIDGET.VIDEO_REGEX)&&!t[ATTR_WIDGET.THUMBNAIL]?void u(t):void(void 0==t&&null==t||(editor.doc.execCmd("insobj",t),Utils.addToStatistics("widgetInsrt")))},c=function(e){var o=p(e);if(o.thumbnail||(o[ATTR_WIDGET.THUMBNAIL]=""),void 0!=o||null!=o){var r=editor.doc.getSelection().getStart(),n=(editor.doc.getFormats()[r],i.map[t]);n&&(editor.doc.execCmd("applyStyle",[n,o,"updateIframe"]),Utils.addToStatistics("updateWidget"))}},p=function(e){var t=editor.doc.getPaperWidth(),i=t/2,o=(e[ATTR_WIDGET.SRC].trim(),editor.doc.getBodyFormat().ph.convertor().pixels),r=editor.doc.getBodyFormat().mt.convertor().pixels+editor.doc.getBodyFormat().mb.convertor().pixels,n=o-r,a=e[ATTR_WIDGET.HT]?e[ATTR_WIDGET.HT]:i,l=e[ATTR_WIDGET.WID]?e[ATTR_WIDGET.WID]:t;return a>n&&(a=n),l>t&&(l=t),e[ATTR_WIDGET.HT]=a,e[ATTR_WIDGET.WID]=l,e},u=function(e){var t=J.ZVideoLibrary.PublicVideos.youtube,i=e[ATTR_WIDGET.SRC].match(ATTR_WIDGET.VIDEO_REGEX)[4],o=(ViewManager.getColumnWidth(),{startIndex:0,limit:1,keyword:i,nextPageToken:"",contextPath:"/writer/fcomponents/"});t.load(void 0,o,function(t,i){var o="string"==typeof i?JSON.parse(i):i;o&&o.TOTALCOUNT>0&&(e[ATTR_WIDGET.THUMBNAIL]=o.VIDEOS[0].VIDEO_BIGIMAGE,e[ATTR_WIDGET.SRC]=o.VIDEOS[0].VIDEO_URL,editor.doc.execCmd("insobj",e))})},f=function(e){var t={};if(0==e.indexOf("<iframe")){var i=/(src)=["']([^"']*)["']/,o=i.exec(e);o&&o[2]&&(o=o[2],t[ATTR_WIDGET.SRC]=o)}if(e.includes("height")){var i=/(height)=["']([^"']*)["']/,r=i.exec(e)[2];t[ATTR_WIDGET.HT]=r}if(e.includes("width")){var i=/(width)=["']([^"']*)["']/,n=i.exec(e)[2];t[ATTR_WIDGET.WID]=n}return t},g=function(){PubSub.unsubscribe(["Cursor/Collapsed","Cursor/Selected"],Widget.widgetSelect),J(".zw-iframe").removeClass("ui-frm-actv"),J(".ui-edit-icon-btn").css("display","none"),J(".zw-ifr-msg-div").removeClass("ui-iframe-hover-div"),J(".zw-ifr-div").removeClass("ui-actv"),J("#microandparaVCContainer").css("display","block")},m=function(e){if(e){var t={};return e.ht&&(t.height=e.ht),e.wid&&(t.width=e.wid),e.src&&(t.src=e.src),e.thumbnail&&(t.thumbnail=e.thumbnail),e.customdata&&(t.customdata=e.customdata),t}},h=function(){var e=editor.doc.getSelection().getStart(),o=editor.doc.getFormats()[e];m(o);if(o.customdata){var r=editor.doc.getParents(NODE_TYPE.IFRAME,e);editor.doc.getSelection(),new DocOpBuilder;i=new XFormMap,i.enableAutoUpdate(),t=Utils.randomString(),i.putOp(r,t)}},T=function(e,t){LeftPanel.closeSubPanel();var i=ViewManager.getColumnWidth(),o=i,r=i/2,n={width:o,height:r,thumbnail:t,widgetSrc:"https://www.youtube.com/embed/"+e};Widget.insert(n),Utils.addToStatistics("Insert_Youtube_Video")},E=function(t,i){t&&J(t.target).is("#embedObject")?(J("#embedobjecterrormsg").hide(),J("#embed_url_btn").zbutton("disable"),J("#embed-url").val("")):(J("#searchSnippet").val(""),J("div.ui-video-listcont").html(""),J("#yterrormsg").hide()),e||n()},R=function(){Widget.isIframeLoaded&&(J("div.ifCont").remove(),Widget.isIframeLoaded=!1)};return PubSub.subscribe("Editor/MouseUp",R),{insertWidget:s,loadVideos:l,insert:d,insertVideo:T,update:c,loadCurVid:a,clearFields:E,isIframeLoaded:o,getWidgetProperty:h,isTargetWidget:r,widgetSelect:g}}();!function(){var e=1,t=2,i=t,o=1,r=o/10,n=J("#ui-reader-popup"),a=J(".ui-reader-overlay"),l={"font-family":"Lato","font-size":"14pt","line-height":"1.5"},s=function(){UIUtils.showLoadingMsg(J.i18n("writer.common.LOADING")),ViewManager.renderAllpages(),o=1,m(),i==t&&g(),n.addClass("ui-dialogopen-anim"),a.addClass("ui-overlayopen-anim");var e=J("#ui-reader-view").empty();R(J(".zw-contentpane"),e);var r,l=e.find("table .zw-cell-container").each(function(){r=J(this),R(r,r.parent())}).end().find(".shape_box");l.find("#textcontainer").andSelf().css({display:"inline-block",position:"initial"}).find(".selectedArea").remove(),UIUtils.hideLoadingMsg(),n.show(),a.show();var s;l.find("svg").each(function(){r=J(this),s=r.find("g")[0].getBoundingClientRect(),r.parent().css("display","inline-block").end().css("position","initial").attr({width:s.width,height:s.height}),this.setAttribute("viewBox","0, 0, "+s.width+", "+s.height)}),Utils.addToStatistics("ReaderView")},d=function(){n=J("#ui-reader-popup"),a=J(".ui-reader-overlay")},c=function(){n.removeClass("ui-dialogclose-anim").hide(),a.removeClass("ui-overlayclose-anim").hide()},p=function(){J("#ui-reader-font-size, #ui-reader-line-height").on("zsliderchange",function(e,t){var i,o=J(this).metadata(),r=o.appData;if(i=r.action){var n=Utils.getAsFunction(i);n.callable([r.params,t.value+(o.componentOptions&&o.componentOptions.unit||"")])}}),AnimationEndEvent&&n[0].addEventListener(AnimationEndEvent,function(e){"ui-dialogopen-effect"==e.animationName?a.removeClass("ui-overlayopen-anim").css({opacity:".75"}):"ui-dialogclose-effect"==e.animationName&&c()}),PubSub.subscribe("DOM/ESCKeyPressed",u)},u=function(){n.addClass("ui-dialogclose-anim"),a.addClass("ui-overlayclose-anim")},f=function(e){if(e){var t=e[0],i=e[1];if(l.hasOwnProperty(t)&&l[t]!==i){l[t]=i;var o,r="#ui-reader-view div{";for(o in l)r+="font-family"===o?o+": '"+l[o]+"', sans-serif;":o+": "+l[o]+";";r+="}",J(document.getElementById("ui-reader-style")).text(r)}}},g=function(){i==e?(J(".ui-modal-content").addClass("ui-nightModal").removeClass("ui-brightModal"),J("#night-mode").addClass("ui-button-focus"),J("#day-mode").removeClass("ui-button-focus"),J("#ui-reader-popup table").css("color","#ffffff"),i=t):i==t&&(J(".ui-modal-content").addClass("ui-brightModal").removeClass("ui-nightModal"),J("#day-mode").addClass("ui-button-focus"),J("#night-mode").removeClass("ui-button-focus"),J("#ui-reader-popup table").css("color","#000000"),i=e)},m=function(){J(".ui-content-anim").animate({zoom:o})},h=function(){o+=r,m()},T=function(){o=1,m()},E=function(){o-=r,m()},R=function(e,t){var i;e.children().children().children().children().each(function(){i=J(this),i.is(".heading1")?t.append("<h1>"+S(i)+"</h1>"):i.is(".heading2")?t.append("<h2>"+S(i)+"</h2>"):i.is(".heading3")?t.append("<h3>"+S(i)+"</h3>"):i.is(".heading4")?t.append("<h4>"+S(i)+"</h4>"):i.is(".heading5")?t.append("<h5>"+S(i)+"</h5>"):i.is(".heading6")?t.append("<h6>"+S(i)+"</h6>"):i.is(".zw-table")?t.append('<table class="zw-table">'+i.find(".zw-tr").removeAttr("style").end().html()+"</table>"):i.is(".zw-hr:not(.pgbrk)")?t.append(i.prop("outerHTML")):i.is(".zw-paragraph")&&t.append("<div>"+S(i)+"</div>")}),e.find(".zw-column").find(".zw-endnotecontainer .zw-paragraph").each(function(e){0==e&&t.append('<div class="endnotestyl"></div>'),t.append("<div>"+S(J(this))+"</div>")}),t.find("table").each(function(){i=J(this).find("td").css({"background-color":"",cursor:"auto"}).end(),i.next(":first").is(".zw-table")&&i.find("tbody").append(i.next(":first").children(":first").contents().unwrap())}).end().find(".tab").replaceWith(" ").end().find(".zw-br-portion").replaceWith("<br/>").end().find(".zw-portion").each(function(){i=J(this).children(".zw-space").replaceWith(" ").end(),i.is(".link")?i.contents().unwrap().wrap(J(document.createElement("a")).attr({href:i.attr("data-href"),target:"_blank",title:i.attr("data-title")})):i.attr("style",function(e,t){var o={"font-variant":"","font-weight":"","font-style":"","text-decoration":"","vertical-align":""};for(var r in o)o[r]=i.css(r);i.removeAttr("style").css(o)})}).attr("class","zw-portion").end().find(".zw-bullet").each(function(){i=J(this),i.parent().css("margin-left",i.attr("data-para-margin-left")),i.removeAttr("style").css({"margin-left":i.attr("data-margin-left"),"padding-right":i.attr("data-padding-right")}).removeAttr("data-para-margin-left").removeAttr("data-margin-left").removeAttr("data-padding-right")}).end().find(".cursor, .overlay, .replace-overlay, .spell-error, .ui-comment-indication-new").remove()},S=function(e){var t,i="";return e.find(".inner_shape, .zw-line-content, .zw-float").each(function(){t=J(this),JfirstChild=t.children(":first"),JfirstChild.is(".zw-bullet")&&(JfirstChild.attr("data-para-margin-left",e.css("margin-left")),JfirstChild.attr("data-margin-left",t.parent().css("margin-left")),JfirstChild.attr("data-padding-right",JfirstChild.css("padding-right"))),i+=t.html().replace(/&nbsp;/g," "),JfirstChild.removeAttr("data-para-margin-left").removeAttr("data-margin-left").removeAttr("data-padding-right")}).end().find(".EOP").removeClass("EOP-readonly"),i};PubSub.subscribe("Document/FirstTimeComponentReady",p),window.ReaderPopup={show:s,close:u,initDomElements:d,saveSettings:f,toggleLightMode:g,zoomOut:h,zoomToNormal:T,zoomIn:E}}(),function(){var e={timeOut:5e3,timerId:void 0,close:!1,container:"body",type:"info"},t=function(t){U.each(U.keys(t),function(i){U.has(e,i)&&(e[i]=t[i])})},i=function(t){t=t||{},U.defaults(t,{setTimer:!0,close:!0,type:"success",container:e.container,className:t.container?"":"ui-notify-globe-container"}),"string"==typeof t.message?t.message=J.i18n(t.message):t.message=J.i18n(t.message.key,t.message.args),t.close=!t.setTimer||t.close,t.btnText=!!t.btnText&&J.i18n(t.btnText),t.title&&(t.title=J.i18n(t.title)),t.url&&(t.linkText=J.i18n(t.linkText||"writer.common.CLICK_HERE")),o(t),t.btnText&&J("#js-btn-callback").bind("click",t.callback),t.setTimer&&n()},o=function(e){var t=Handlebars.compile($("#notification-template").html()),i=$.parseHTML(t(e).trim());J("#js-notify").remove(),J(e.container).append(i)},r=function(){e.timerId&&(clearTimeout(e.timerId),e.timerId=void 0)},n=function(){r(),e.timerId||(e.timerId=setTimeout(a,e.timeOut))},a=function(){J("#js-notify").remove(),r()};window.Notification={show:i,hide:a,configure:t}}();var DocNotificationManager=function(){var e=function(){var e=[],t={},i=0,o=function(){e=[],i=0,Z("notification-dropdown").find(".ui-comment-notify-list").remove(),Z("ui-docnotification").find(".ui-colab-user-count").hide()},r=function(o){var r="notification_"+("x"+Math.random()).replace(/\D/g,"");o.id=r,e.splice(0,0,o),i++;var n=a(o.id,o.zuid,o.text,o.time,o.click),s=J(n);return s.css("background-color","rgba(243, 243, 243, 0.48)"),Z("notification-dropdown").find(".ui-comment-notify-inner-div").prepend(n),Z("ui-docnotification").find(".ui-colab-user-count").show().text(i),t[r]=s,l(),r},n=function(o){for(var r=-1,n=0,a=e.length;n<a;n++){var l=e[n];if(l.id===o){r=n;break}}r!==-1&&(e.splice(r,1),t[o].remove()),i>0?(i--,Z("ui-docnotification").find(".ui-colab-user-count").show().text(i)):Z("ui-docnotification").find(".ui-colab-user-count").hide()},a=function(e,t,i,o,r){var n=J("<div class='ui-comment-notify-list'>  <div class='ui-fr ui-comment-notify-list-content'> <div class='content'> </div> <div class='ui-comment-notify-list-time' style='width:50%'> </div> </div>  <div class='ui-fl ui-right-margin-medium'> <img width='30' id='topband-userimg' height='30'> </div>  </div>");n.find(".content").html(i);var a=n.find(".ui-comment-notify-list-time"),l=moment(o).format("h:mm a MMM D,YYYY");a.attr("data-dynamic-time",o),a.addClass("dynamic-time"),a.attr("title",l),a.text(Utils.getTimeFromNow(o)),n.find(".ui-comment-notify-list-time");var s=Utils.getUserImageURL(t);return n.find("#topband-userimg").attr("src",s),n.unbind().bind({click:function(e){return r(),DocNotificationManager.close(),Utils.stopEvent(e),!1}}),n},l=function(){e.length?Z("notification-dropdown").find(".ui-no-notifications").hide():Z("notification-dropdown").find(".ui-no-notifications").show()},s=function(){return e.length},d=function(){i&&(i=0,Z("ui-docnotification").find(".ui-colab-user-count").hide(),Z("notification-dropdown").find(".ui-comment-notify-list").css("background-color","#fff"))},c=function(){var t,i,o,r=[];for(t=0,i=e.length;t<i;t++)o=nodes[t],r.push(o);return r};return{init:o,add:r,remove:n,displayNoNotificationMsg:l,length:s,makeAllRead:d,toJson:c}}(),t=function(){e.init(),Z("ui-docnotification").on("click",function(e){DocNotificationManager.toggle(e)})},i=function(t){return e.add(t)},o=function(t){e.remove(t)},r=function(e){e&&e>0?(Z("notification-total-count").show().find(".js-comments-count-anchor").show(),Z("notification-dropdown").find(".comments-count").text(e)):Z("notification-total-count").find(".js-comments-count-anchor").hide()},n=function(e){e&&e>0?(Z("notification-total-count").show().find(".js-changes-count-anchor").show(),Z("notification-dropdown").find(".changes-count").text(e)):Z("notification-total-count").find(".js-changes-count-anchor").hide()},a=function(){var t=$.ZContextMenu.currentMenu;t&&t.zmenu&&t.zmenu("hide"),Z("ui-docnotification").find("button").addClass("ui-state-highlight"),Z("notification-dropdown").show(),e.displayNoNotificationMsg(),Z("notification-total-count").hide();var i=CommentModels.commentPane.get("nosAll");r(i);var o=TcManager.getCollection().getVisibleNodesCountDetails().all;n(),i&&i>0&&o&&o>0?Z("notification-total-count").find(".js-comments-count-anchor").css("border-color","#e8e8e8"):Z("notification-total-count").find(".js-comments-count-anchor").css("border-color","transparent")},l=function(){Z("ui-docnotification").find("button").removeClass("ui-state-highlight"),e.makeAllRead(),Z("notification-dropdown").hide()},s=function(e){return Z("notification-dropdown").is(":visible")?(l(),Utils.stopEvent(e),!1):(a(),Utils.stopEvent(e),!1)};return PubSub.subscribe("Document/FirstTimeComponentReady",function(){DocNotificationManager.init()}),J(document).bind("click",function(){Z("notification-dropdown").is(":visible")&&DocNotificationManager.close()}),{init:t,add:i,remove:o,toggle:s,close:l}}();!function(){var e={},t=void 0,i=function(t){U.each(t,function(t,i){e[t.email]=t})},o=function(e){return U.map(e,function(e,t){var i=U.clone(e);return i.id=e.zuid,i.type="user",i.name=e.fullName,i.encodeName=e.fullName,i.label=e.fullName+e.email,i})},r=function(t){return U.isEmpty(e)?n(t):o(e)},n=function(e){var i={};e=e||{},i.limit=e.limit,i.startsFrom=e.startsFrom,t=e.callback,J.ajax({url:Utils.getContextUrl("v1/web/user/contacts"),dataType:"json",type:"GET",success:l,error:s})},a=function(e){var i={};t=e.callback,i.limit=e.limit,i.queryStr=e.queryStr,i.startsFrom=e.startsFrom;var o=e.success,r=e.error;Utils.setCsrfParam(i),J.ajax({data:i,type:"POST",dataType:"json",url:Utils.getContextUrl("v1/web/user/contacts/search"),success:o||l,error:r||s})},l=function(e){i(e.contactsList),t&&(t(o(e.contactsList)),t=void 0)},s=function(){t&&(t([]),t=void 0)};window.Contacts={getContacts:r,searchContacts:a}}(),TabStopDlg=function(){},TabStopDlg.insertTabDlg=function(){J.dialogutil.open("tabdialog",J("#tabsettingbutton"),TabStopDlg.info)},TabStopDlg.info={set:function(e,t,i){},beforeFillValues:function(e){var t,i,o,r,n,a,l,s,d,c,p=Conversions.toGlobalUnit(editor.doc.getBodyFormat()[ATTR_BODY.DS_TPS]),u=editor.doc.getSelection().parents(NODE_TYPE.PARAGRAPH);a=Conversions.step;var f=editor.jeditorPane.width();l=parseFloat(f)/Conversions.globalUnitInPx,s=parseFloat(f)/2/Conversions.globalUnitInPx,c=Conversions.step,a-=a%c,l-=l%c,d=Conversions.showUnit,J("input#defaulttab").zspinner("setMinValue",a),J("input#defaulttab").zspinner("setMaxValue",s),J("input#defaulttab").zspinner("setStepValue",c),J("input#defaulttab").zspinner("setUnit",d),J("input#defaulttab").zspinner("setValue",p);var g=u.attr(ATTR_PARAGRAPH.PS_TPS);if(g)for(t=g,i=t.length,o=0;o<i;o++){for(r=i-1;r>o;r--)t[r]&&parseFloat(t[r-1].point)>parseFloat(t[r].point)&&(n=t[r-1],t[r-1]=t[r],t[r]=n);if(t[o+1]&&parseFloat(t[o+1].point)==parseFloat(t[o].point)&&t.splice(o,1),t[o]&&isNaN(parseFloat(t[o].point))&&t.splice(o,1),t[o]){var m=Conversions.toGlobalUnit(t[o].point),h=t[o].align,T=t[o].leader;newManualPtRow=TabStopDlg.newRow(o,m),J("div#manualPts").append(newManualPtRow),J("select#pos_"+o).val(h),J("select#leader_"+o).val(T),J("input#percent_"+o).zspinner({unit:Conversions.showUnit,decimalAllowed:!0,floatLength:3}),J("input#percent_"+o).zspinner("setMinValue",a),J("input#percent_"+o).zspinner("setMaxValue",l),J("input#percent_"+o).zspinner("setStepValue",c),J("input#percent_"+o).zspinner("setUnit",d),J("input#percent_"+o).zspinner("setValue",m),J("select#pos_"+o).zcombo({type:"text_only"}),J("select#leader_"+o).zcombo({type:"text_only"})}u.attr(ATTR_PARAGRAPH.PS_TPS)[o]=t[o]}else TabStopDlg.newRow(1,""),TabStopDlg.addManualPtRow()}},TabStopDlg.applyTabs=function(){editor.doc.execCmd("applyTab","")},TabStopDlg.applyValues=function(e){var t,i,o,r,n,a,l,s,d,c,p,u,f,g=[];for(t=0;t<=20;t++)0!=J("div#manualtabrow_"+t).length&&(i="percent_"+t,o="pos_"+t,r="leader_"+t,n=parseFloat(J("#"+i).zspinner("getValue")),0!=n.length&&0!=n&&(isNaN(n)||(a=J("#"+o).zcombo("getValue"),l=J("#"+r).zcombo("getValue"),s=t<10?"0"+t:t,d={id:s,point:n+Conversions.globalUnit,align:a,leader:l},g.push(d))));for(c=0;c<e.length;c++){p=e[c];var m={};m[ATTR_PARAGRAPH.PS_TPS]=g,p.attr(m)}u=Conversions.toGlobalUnit(J("#defaulttab").zspinner("getValue")+Conversions.globalUnit),f=editor.doc.getSelection().parents(NODE_TYPE.BODY),u!==Conversions.toGlobalUnit(f.attr(ATTR_BODY.DS_TPS))&&(m={},m[ATTR_BODY.DS_TPS]=u+Conversions.globalUnit,f.attr(m)),J.dialogutil.close("tabdialog")},TabStopDlg.newRow=function(e,t){var i="manualtabrow_"+e,o="pos_"+e,r="percent_"+e,n="leader_"+e,a="del_"+e,l="<div id='"+i+'\' class="ui-bottom-margin-medium ui-pop-2c-variable ui-tabset-spinner"><span class="tkHeadDistance ui-fl"><input  id=\''+r+'\' style="width:105px"  min="0" max="1000" step="1" data="{appData:{action:\'props.stroke.width\'}}"/></span><span class="tkHeadalignLeader1 ui-fl"><select id=\''+o+"'    data=\"{type: 'text_only',appData:{action : 'props.transform.pos.left',associatedUIData: ['#horizontposValue'],associatedActions: ['props.transform.pos.left']}}\"><option value='0'  type=\"localweb\" data=\"{'icon': 'ui-icon-script'}\">"+J.i18n("writer.common.LEFT")+"</option><%--No I18N--%><%--No I18N--%><option value='1' type=\"localweb\" data=\"{'icon': 'ui-icon-home'}\">"+J.i18n("writer.common.CENTER")+"</option><%--No I18N--%><%--No I18N--%><option value='2' type=\"localweb\" data=\"{'icon': 'ui-icon-home'}\">"+J.i18n("writer.common.RIGHT")+'</option><%--No I18N--%><%--No I18N--%></select></span><span class="tkHeadalignLeader2 ui-fl"><select id=\''+n+"' style=\"width:60px;\"    data=\"{type: 'icon_only', appData:{action:'props.stroke.type'}}\" ><option value='0' data=\"{'icon': 'ui-zlinestyle-stroketype ui-zstroketype-solid'}\">"+J.i18n("writer.common.NONE")+"</option><%--No I18N--%><option noattri18n=\"true\" value='1' data=\"{'icon': 'ui-zlinestyle-stroketype ui-zstroketype-solid'}\">.........</option><%--No I18N--%><option noattri18n=\"true\" value='2' data=\"{'icon': 'ui-zlinestyle-stroketype ui-zstroketype-squaredot'}\">--------</option><%--No I18N--%><option noattri18n=\"true\" value='3' data=\"{'icon': 'ui-zlinestyle-stroketype ui-zstroketype-dash'}\">_______</option><%--No I18N--%></select></span><span class=\"tkclose\"><span class=\"ui-button-icon-primary ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-delete-sm ui-ms-pointer\"  onclick=\"TabStopDlg.removeManualPtRow(event);\" id='"+a+"'></span></span></div>";return l},TabStopDlg.addManualPtRow=function(){var e,t,i,o,r,n="";t=Conversions.step,i=parseFloat(editor.jeditorPane.width())/Conversions.globalUnitInPx,o=Conversions.step,r=Conversions.showUnit,t-=t%o,i-=i%o;var a=new Array;if(a=J('[id^="manualtabrow"]'),0==a.length)e=1;else{var l=a.length;e=l+1}var s="";n=TabStopDlg.newRow(e,s),J("div#manualPts").append(n),J("input#percent_"+e).zspinner({unit:Conversions.showUnit,decimalAllowed:!0,floatLength:3}),J("input#percent_"+e).zspinner("setMinValue",t),J("input#percent_"+e).zspinner("setMaxValue",i),J("input#percent_"+e).zspinner("setStepValue",o),J("input#percent_"+e).zspinner("setUnit",r),J("select#pos_"+e).zcombo({type:"text_only"}),J("select#leader_"+e).zcombo({type:"text_only"})},TabStopDlg.removeAllRow=function(){J("span#errmsg").hide(),J('[id^="manualtabrow"]').remove()},TabStopDlg.removeManualPtRow=function(e){var t=editor.browserInfo.is_ie?e.srcElement:e.target,i=t.id;i="manualtabrow_"+parseInt(i.substring(i.indexOf("_")+1,i.length)),J('[id^="'+i+'"]').remove(),J("#"+i).remove()},ColumnDlg.prototype={colInfo:{init:function(){var e=(editor.doc.getBodyFormat(),ViewManager.getColumnFormat());if(ColumnDlg.columnCount=e.count||1,ColumnDlg.colSpace=e.defaultspace||Conversions.toGlobalValue("0.5in"),ColumnDlg.columnWidth=e.width||[],ColumnDlg.columnSpace=e.space||[],ColumnDlg.columnSeperator=e.seperator||"0",ColumnDlg.colIsEqWid=void 0==e.iseqwidth||e.iseqwidth,ColumnDlg.globalUnit=Conversions.isInInches?"in":"mm",ColumnDlg.colIsEqWid){var t=editor.doc.getPaperWidth()-PAGE_BORDER_WIDTH;t-=(ColumnDlg.columnCount-1)*ColumnDlg.colSpace.convertor().pixels,ColumnDlg.columnWidth=[],ColumnDlg.columnSpace=[],t/=ColumnDlg.columnCount,t=Conversions.toGlobalValue(t+"px");for(var i=1;i<=ColumnDlg.columnCount;i++)ColumnDlg.columnWidth.push(t),i!=ColumnDlg.columnCount&&ColumnDlg.columnSpace.push(ColumnDlg.colSpace)}ColumnDlg.setMaxValueForColCount(),ColumnDlg.updatePreview()},get:function(e,t){if("columnPreset"==e){if(2==ColumnDlg.columnCount&&!ColumnDlg.colIsEqWid){var i=parseInt(ColumnDlg.columnWidth[0].convertor().pixels),o=parseInt(ColumnDlg.columnWidth[1].convertor().pixels);if(2*i==o)return 100;if(i==2*o)return 101}return ColumnDlg.columnCount}if("columnCount"==e){var r=J("#columnSeperator"),n=J("#isEqWid");if(ColumnDlg.columnCount>1?(r.enable(),n.enable()):(r.disable(),n.disable()),ColumnDlg.removeAllColRow(),ColumnDlg.addManualColRow(),ColumnDlg.colIsEqWid)1==ColumnDlg.columnCount?J("#presets1").zstatebutton("checked",!0):2==ColumnDlg.columnCount?J("#presets2").zstatebutton("checked",!0):3==ColumnDlg.columnCount&&J("#presets3").zstatebutton("checked",!0);else if(2==ColumnDlg.columnCount){var i=parseInt(ColumnDlg.columnWidth[0].convertor().pixels),o=parseInt(ColumnDlg.columnWidth[1].convertor().pixels);2*i==o?J("#presets4").zstatebutton("checked",!0):i==2*o&&J("#presets5").zstatebutton("checked",!0)}return parseInt(ColumnDlg.columnCount,10)}if("columnSeperator"==e)return 1==ColumnDlg.columnSeperator;if("columnWidth"==e)for(var a,l=0;l<ColumnDlg.columnCount;l++)a=Conversions.toGlobalValue(ColumnDlg.columnWidth[l]),J("input#colWidth_"+(l+1)).zspinner("setValue",a+ColumnDlg.globalUnit);else if("columnSpace"==e){var s;if(ColumnDlg.columnCount>1)for(var l=0;l<ColumnDlg.columnCount-1;l++)s=ColumnDlg.colIsEqWid?Conversions.toGlobalValue(ColumnDlg.colSpace):Conversions.toGlobalValue(ColumnDlg.columnSpace[l]),J("input#colSpace_"+(l+1)).zspinner("setValue",s+ColumnDlg.globalUnit)}else if("colIsEqWid"==e)return!!ColumnDlg.colIsEqWid&&(ColumnDlg.disableAllColRow(),!0)},set:function(e,t,i){editor.doc.getBodyFormat();if("columnPreset"==e.action){var o,r=parseInt(i.val(),10),n="0.5in".convertor().pixels;if(ColumnDlg.columnWidth=[],ColumnDlg.columnSpace=[],ColumnDlg.removeAllColRow(),o=editor.doc.getPaperWidth()-PAGE_BORDER_WIDTH,100==r||101==r)ColumnDlg.columnCount=2,o-=(ColumnDlg.columnCount-1)*n,o/=ColumnDlg.columnCount+1,100==r&&(ColumnDlg.columnWidth.push(Conversions.toGlobalValue(o+"px")),ColumnDlg.columnWidth.push(Conversions.toGlobalValue(2*o+"px"))),101==r&&(ColumnDlg.columnWidth.push(Conversions.toGlobalValue(2*o+"px")),ColumnDlg.columnWidth.push(Conversions.toGlobalValue(o+"px"))),ColumnDlg.columnSpace.push(Conversions.toGlobalValue(n+"px")),ColumnDlg.colIsEqWid=!1,J("#isEqWid").zstatebutton("checked",!1);else if(1==r||2==r||3==r){o-=(r-1)*n.convertor().pixels,o/=r;for(var a=0;a<r;a++)ColumnDlg.columnWidth.push(Conversions.toGlobalValue(o+"px")),a<r-1&&ColumnDlg.columnSpace.push(Conversions.toGlobalValue(n+"px"));1==r?(J("#isEqWid").disable(),J("#columnSeperator").disable()):(J("#isEqWid").enable(),J("#isEqWid").zstatebutton("checked",!0),J("#columnSeperator").enable()),ColumnDlg.columnCount=r,ColumnDlg.colSpace=Conversions.toGlobalValue(n+"px"),ColumnDlg.colIsEqWid=!0}J("input#columnCount").zspinner("setValue",ColumnDlg.columnCount),ColumnDlg.addManualColRow(),ColumnDlg.updatePreview(!0)}else if("columnCount"==e.action){var l=J("#columnSeperator"),s=J("#isEqWid"),d=ColumnDlg.getMaxColCount();1==ColumnDlg.columnCount?J("#presets1").zstatebutton("checked",!1):2==ColumnDlg.columnCount?J("#presets2").zstatebutton("checked",!1):3==ColumnDlg.columnCount&&J("#presets3").zstatebutton("checked",!1),t>d&&(t=d,J("input#columnCount").zspinner("setValue",t)),l.enable(),s.enable(),ColumnDlg.columnCount=parseInt(t,10),1==t&&ColumnDlg.colIsEqWid?(l.disable(),s.disable(),J("#presets1").zstatebutton("checked",!0)):2==t&&ColumnDlg.colIsEqWid?J("#presets2").zstatebutton("checked",!0):3==t&&ColumnDlg.colIsEqWid&&J("#presets3").zstatebutton("checked",!0),ColumnDlg.addEqualColumn(),ColumnDlg.updatePreview(!0)}else if("columnSeperator"==e.action){var c=(editor.doc.getBodyFormat(),ColumnDlg.columnCount);if(c>1)return t?(ColumnDlg.columnSeperator="1",ColumnDlg.updatePreview(),!0):(ColumnDlg.columnSeperator="0",ColumnDlg.updatePreview(),!1)}else{if("columnWidth"==e.action){var n,p,u=ColumnDlg.colIsEqWid,f=ColumnDlg.columnCount,g=(editor.doc.getPaperWidth()-2+"px").convertor().inches.toFixed(2),m=i[0].id.split("colWidth_")[1]-1,h=parseFloat(ColumnDlg.columnWidth[m]),T=t,E=T-h,R=E/(f-(m+1));if(u){var S=f*t+ColumnDlg.globalUnit;if(p=(g-S.convertor().inches)/(f-1),p<0)return ColumnDlg.updatePreview(!0),!1;p=Conversions.toGlobalUnit(p+"in"),ColumnDlg.enableAllColRow();for(var a=1;a<=f;a++)J("input#colWidth_"+a).zspinner("setValue",t+ColumnDlg.globalUnit),ColumnDlg.columnWidth[a-1]=t+ColumnDlg.globalUnit,a<f&&(J("input#colSpace_"+a).zspinner("setValue",p+ColumnDlg.globalUnit),ColumnDlg.columnSpace[a-1]=p+ColumnDlg.globalUnit);ColumnDlg.disableAllColRow(),ColumnDlg.updatePreview(!0)}else{for(var a=m+1;a<f;a++){var o=parseFloat(ColumnDlg.columnWidth[a]);(o-R+ColumnDlg.globalUnit).convertor().centimeters>1.27&&(ColumnDlg.columnWidth[a]=o-R+ColumnDlg.globalUnit,J("input#colWidth_"+(a+1)).zspinner("setValue",ColumnDlg.columnWidth[a]),ColumnDlg.columnWidth[m]=parseFloat(ColumnDlg.columnWidth[m])+R+ColumnDlg.globalUnit,E-=R)}if(0!=E&&0!=m){R=E/m;for(var a=m-1;a>=0;a--){var o=parseFloat(ColumnDlg.columnWidth[a]);(o-R+ColumnDlg.globalUnit).convertor().centimeters>1.27&&(ColumnDlg.columnWidth[a]=o-R+ColumnDlg.globalUnit,J("input#colWidth_"+(a+1)).zspinner("setValue",ColumnDlg.columnWidth[a]),ColumnDlg.columnWidth[m]=parseFloat(ColumnDlg.columnWidth[m])+R+ColumnDlg.globalUnit,E-=R)}}if(0!=E){R=E/(f-1);for(var a=0;a<f;a++){var n=parseFloat(ColumnDlg.columnSpace[a]);if(!((n-R+ColumnDlg.globalUnit).convertor().millimeters>0))return ColumnDlg.updatePreview(),!1;ColumnDlg.columnSpace[a]=n-R+ColumnDlg.globalUnit,J("input#colSpace_"+(a+1)).zspinner("setValue",ColumnDlg.columnSpace[a]),ColumnDlg.columnWidth[m]=parseFloat(ColumnDlg.columnWidth[m])+R+ColumnDlg.globalUnit,E-=R}}}return ColumnDlg.updatePreview(!0),!0}if("columnSpace"==e.action){var n,p,u=ColumnDlg.colIsEqWid,f=J("input#columnCount").zspinner("getValue"),g=(editor.doc.getPaperWidth()-2+"px").convertor().inches.toFixed(2);if(t<0)return!1;var m=i[0].id.split("colSpace_")[1]-1,h=parseFloat(ColumnDlg.columnSpace[m]),T=t,E=T-h,R=E/(f-(m+1));if(u){var O=(f-1)*t+ColumnDlg.globalUnit,v=(g-O.convertor().inches)/f;if(t<0)return ColumnDlg.updatePreview(!0),!1;v=Conversions.toGlobalValue(v+"in"),ColumnDlg.enableAllColRow();for(var a=1;a<=f&&v.convertor().centimeters>1.27;a++)J("input#colWidth_"+a).zspinner("setValue",v+ColumnDlg.globalUnit),ColumnDlg.columnWidth[a-1]=v+ColumnDlg.globalUnit,a!=f&&(J("input#colSpace_"+a).zspinner("setValue",t+ColumnDlg.globalUnit),ColumnDlg.columnSpace[a-1]=t+ColumnDlg.globalUnit);ColumnDlg.colSpace=t+ColumnDlg.globalUnit,ColumnDlg.disableAllColRow(),ColumnDlg.updatePreview(!0)}else{for(var a=m+1;a<f;a++){var o=parseFloat(ColumnDlg.columnWidth[a]);(o-R+ColumnDlg.globalUnit).convertor().centimeters>1.27&&(ColumnDlg.columnWidth[a]=o-R+ColumnDlg.globalUnit,J("input#colWidth_"+(a+1)).zspinner("setValue",ColumnDlg.columnWidth[a]),ColumnDlg.columnSpace[m]=parseFloat(ColumnDlg.columnSpace[m])+R+ColumnDlg.globalUnit,E-=R)}if(E>0){R=E/(m+1);for(var a=m;a>=0;a--){var o=parseFloat(ColumnDlg.columnWidth[a]);(o-R+ColumnDlg.globalUnit).convertor().centimeters>1.27&&(ColumnDlg.columnWidth[a]=o-R+ColumnDlg.globalUnit,J("input#colWidth_"+(a+1)).zspinner("setValue",ColumnDlg.columnWidth[a]),ColumnDlg.columnSpace[m]=parseFloat(ColumnDlg.columnSpace[m])+R+ColumnDlg.globalUnit,E-=R)}}if(0!=E){R=E/(f-2);for(var a=0;a<f;a++)if(a!=m){var n=parseFloat(ColumnDlg.columnSpace[a]);if(!((n-R+ColumnDlg.globalUnit).convertor().millimeters>0))return ColumnDlg.updatePreview(!0),!1;ColumnDlg.columnSpace[a]=n-R+ColumnDlg.globalUnit,J("input#colSpace_"+(a+1)).zspinner("setValue",ColumnDlg.columnSpace[a]),ColumnDlg.columnSpace[m]=parseFloat(ColumnDlg.columnSpace[m])+R+ColumnDlg.globalUnit,E-=R}}}return ColumnDlg.updatePreview(!0),!0}if("colIsEqWid"==e.action)return t?(ColumnDlg.colIsEqWid=!0,ColumnDlg.addEqualColumn(),ColumnDlg.updatePreview(),ColumnDlg.colIsEqWid):(ColumnDlg.enableAllColRow(),ColumnDlg.colIsEqWid=!1,ColumnDlg.updatePreview(),ColumnDlg.colIsEqWid=!1)}}},addEqualColumn:function(){var e=editor.doc.getPaperWidth()-PAGE_BORDER_WIDTH,t=ColumnDlg.colSpace?ColumnDlg.colSpace.convertor().pixels:"0.5in".convertor().pixels;ColumnDlg.columnCount>1&&(colWidth=e-(ColumnDlg.columnCount-1)*t,colWidth/=ColumnDlg.columnCount,colWidth<"0.5in".convertor().pixels&&t>0&&(colWidth="0.5in".convertor().pixels,t=e-ColumnDlg.columnCount*colWidth,t/=ColumnDlg.columnCount-1)),ColumnDlg.removeAllColRow(),ColumnDlg.columnWidth=[],ColumnDlg.columnSpace=[];for(var i=0;i<ColumnDlg.columnCount;i++)ColumnDlg.columnWidth[i]=Conversions.toGlobalValue(colWidth+"px"),i<ColumnDlg.columnCount-1&&(ColumnDlg.columnSpace[i]=Conversions.toGlobalValue(t+"px"));ColumnDlg.addManualColRow()},apply:function(){Utils.addToStatistics("Multi_Column");var e=J("#columnPopup").zvalidation("validateAllFields",J("#columnPopup")),t=!1;if(e){var i=editor.doc.getBodyFormat(),o=editor.doc.getSelection().parents(NODE_TYPE.BODY),r={};r.cols={},r[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLCOUNT]=ColumnDlg.columnCount,ColumnDlg.colIsEqWid?(r[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLWID]=[],r[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLSPACE]=[]):(r[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLWID]=ColumnDlg.columnWidth,r[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLSPACE]=ColumnDlg.columnSpace),r[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLSEP]=ColumnDlg.columnSeperator,r[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_DEFAULTSPACE]=ColumnDlg.colSpace,r[ATTR_BODY.DS_COLCOLS][ATTR_BODY.DS_COLISEQWID]=ColumnDlg.colIsEqWid;for(var n in ViewManager.getColumnFormat())if(t||"undefined"==typeof r[ATTR_BODY.DS_COLCOLS][n]||r[ATTR_BODY.DS_COLCOLS][n]==i[n]){if(t)break}else t=!0;t&&editor.doc.execCmd("applyStyle",[o,r]),PageLayoutPanel.updatePanel(),J.dialogutil.close("columndialog")}},openColDlg:function(){J.dialogutil.open("columndialog",void 0,this.colInfo)},newColRow:function(e){var t="manualcolrow_"+e,i="col_"+e,o="colWidth_"+e,r="colSpace_"+e,n="<div id='"+t+"' class='ui-multicol-table-row'><div id='"+i+'\' class="ui-multicol-table-cell"><div class="ui-with-space-numberspan">'+e+'</div></div><div class="ui-multicol-table-cell"><div class="ui-pop-2c-variable"><input ctype=\'zspinner\' id=\''+o+'\' min="0.5" max="100" step="0.1" data="{\'appData\':{\'action\':\'columnWidth\'}}" style="width:90px;"/></div></div><div class="ui-multicol-table-cell"><div class="ui-pop-2c-variable"><input ctype=\'zspinner\' id=\''+r+'\' min="0" max="100" step="0.1" data="{appData:{action:\'columnSpace\'}}" style="width:90px;"/></div></div></div>';return n},updatePreview:function(e){var t=120,i=ColumnDlg.columnCount,o=editor.doc.getPaperWidth()-2,r=ColumnDlg.columnWidth,n=ColumnDlg.columnSpace,a=(r.length,0),l=0;J('[id^="coldiv"]').hide();for(var s=0;s<i-1;s++){a+=parseInt(r[s].convertor().pixels/o*t),l=parseInt(n[s].convertor().pixels/o*t);var d=J("#coldiv"+(s+1));d.css({left:a+"px",display:"block",width:l+"px"}),d.children().css("margin-left",l/2+"px"),a+=l}"1"==ColumnDlg.columnSeperator?J(".colLineDiv").show():J(".colLineDiv").hide()},getMaxGapAndWidth:function(){var e=ColumnDlg.globalUnit,t=(editor.doc.getPaperWidth()-2+"px").convertor().inches.toFixed(2),i=bodyFormat.ml.convertor().inches,o=(J('#columnCount li [class $="_selected"]'),ColumnDlg.columnCount),r=bodyFormat.mr.convertor().inches,n="12.7mm".convertor().inches,a=t-(i+n*o-1+r),l=a;l="mm"==e?25.4*l:l;var s=t-(n*o-1);return s="mm"==e?25.4*s:s,{maxGap:l,maxWid:s}},addManualColRow:function(){for(var e="",t=ColumnDlg.columnCount,i=Conversions.step,o=ColumnDlg.colIsEqWid,r=ColumnDlg.getMaxGapAndWidth(),n=1;n<=t;n++)e=ColumnDlg.newColRow(n),J("div#widthAndSpacing").append(e),J("input#col_"+n).zspinner("setValue",n),J("input#colWidth_"+n).zspinner({unit:ColumnDlg.globalUnit,decimalAllowed:!0,floatLength:2}),J("input#colWidth_"+n).zspinner("setStepValue",i),J("input#colWidth_"+n).zspinner("setUnit",ColumnDlg.globalUnit),J("input#colWidth_"+n).zspinner("setValue",ColumnDlg.columnWidth[n-1]+ColumnDlg.globalUnit),J("input#colWidth_"+n).zspinner("setMinValue",Conversions.toGlobalUnit("12.7mm")),J("input#colWidth_"+n).zspinner("setMaxValue",r.maxWid),J("#columndialogzdialog").zdialog("initSetEvents",J("input#colWidth_"+n)),J("#columndialogzdialog").zdialog("initSetEvents",J("input#colSpace_"+n)),J("input#colSpace_"+n).zspinner({unit:ColumnDlg.globalUnit,decimalAllowed:!0,floatLength:2}),J("input#colSpace_"+n).zspinner("setStepValue",i),J("input#colSpace_"+n).zspinner("setUnit",ColumnDlg.globalUnit),J("input#colSpace_"+n).zspinner("setMinValue",0),J("input#colSpace_"+n).zspinner("setMaxValue",r.maxGap),n<t&&J("input#colSpace_"+n).zspinner("setValue",ColumnDlg.columnSpace[n-1]+ColumnDlg.globalUnit);o?(ColumnDlg.disableAllColRow(),ColumnDlg.colIsEqWid=!0):(ColumnDlg.enableAllColRow(),ColumnDlg.colIsEqWid=!1)},removeAllColRow:function(){J('[id^="manualcolrow"]').remove()},setMaxValueForColCount:function(){var e=editor.doc.getPaperWidth()-PAGE_BORDER_WIDTH,t=1,i="0.5in".convertor().pixels;t=parseInt(e/i)-1,J("input#columnCount").zspinner("setMaxValue",parseInt(t,10))},getMaxColCount:function(){var e=editor.doc.getPaperWidth()-PAGE_BORDER_WIDTH,t=1,i="0.5in".convertor().pixels;return t=parseInt(e/i)-1},enableAllColRow:function(){J('[id^="manualcolrow"]').enable(),J('[id^="colWidth_"]').zspinner().enable(),J('[id^="colSpace_"]').zspinner().enable()},disableAllColRow:function(){J('[id^="manualcolrow"]').disable(),J('[id^="manualcolrow_1"]').enable(),J('[id^="colWidth_"]').zspinner().disable(),J('[id^="colWidth_1"]').zspinner().enable(),J('[id^="colSpace_"]').zspinner().disable(),J('[id^="colSpace_1"]').zspinner().enable()}},ColumnDlg=new ColumnDlg;var StickerUI=function(){var e,t={gap:0,top:0,bottom:0},i={},o=null,r=null;return{init:function(n,a,l){i=$.extend({},t,l),o=n,r=$(n),e=a,this.changePosition(i)},changePosition:function(e){i.top=e.top,i.left=e.left,i.bottom=e.bottom,i.gap=e.gap,r.css({position:"absolute",top:i.top+"px",left:i.left})},handleScroll:function(t){var o=t,n=r.outerHeight(),a=e.offsetLeft;o>=i.top&&o+n<=i.bottom?r.css({position:"fixed",top:i.gap+"px",left:i.left+a}):o<i.top?r.css({position:"absolute",top:i.top+"px",left:i.left}):o+n>i.bottom?r.css({position:"absolute",top:i.bottom-n+"px",left:i.left}):r.css({position:"absolute",top:i.top+"px",left:i.left})}}};LockDlg=function(){var e,t,i,o=[],r={},n=/([\w\.\+-]+)@([\w-]+)\.([a-z]{2,6}(\.[a-z]{2})?)/g,a=function(){var e,t,o,n=editor.doc.getSelection();if(oldAttr={},r={},i=Lock.getLock(n.getStart()+1),i&&i.length>0&&!n.isCollapsed()){var a=Lock.getLock(n.getEnd());if(a){var l=i.getDocOps(),s=a.getDocOps(),c=editorProps.deployment.zohowriter;if(!l[0].isRetain()||!s[0].isRetain()||l[0].length()!==s[0].length())return void MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,null,c,"Edit Lock is Not allowed");e=l[0].length(),t=e+l[1].length(),o=editor.doc.createRange(e,t),n.removeAllRanges().addRange(o)}}else if(i){var l=i.getDocOps();e=l[0].length(),t=e+l[1].length(),o=editor.doc.createRange(e,t),n.removeAllRanges().addRange(o)}else n.isCollapsed()&&n.selectWord();J.dialogutil.open("lockdialog",J("#lockDialog"),d),r=DocUtil.copyStyle(oldAttr)},l=function(){e=f({callback:s});for(var t=e.length,i=[],o=0;o<t;o++)i[o]={},i[o].email=e[o].emailid,i[o].encodeName=e[o].fullname,i[o].id=parseInt(e[o].user_zuid),i[o].label=e[o].fullname+e[o].emailid,i[o].name=e[o].fullname,i[o].type="user";e=i,s(e),J("#text-area input").off("focus.writer")},s=function(e){var t=J("#text-area");t.zautosuggest("option","imageURL",window.contactServer),t.zautosuggest("setSource",e)},d={init:function(){J("#lockDialog").find("#text-area input").on("focus.writer",l),o=[]},get:function(e,t){if("LOCK-SELECT-CONT"==e)return"selection";if("REDACT"==e){if(i){var n,a=i.getDocOps(),n=a[1].lock_data.data.allowed_zuids;return n=n?n.split(","):[],J("#lockDialog").find("#allowed_lock").val(u(n)),oldAttr.redact=r.redact=a[1].lock_data.data.redact,a[1].lock_data.data.redact}}else if("recipients"==e&&i){var n,a=i.getDocOps(),n=a[1].lock_data.data.allowed_zuids;n=n?n.split(","):[];var l=u(n);return o=l,oldAttr.recipients=r.recipients=o,o}},set:function(e,t,i){"LOCK-SELECT-CONT"==e.action?(r["apply-lock"]=t,r["apply-lock-rev"]=!1):"LOCK-UNSELECT-CONT"==e.action?(r["apply-lock-rev"]=t,r["apply-lock"]=!1):"REDACT"==e.action?r.redact=1==i.is(":checked"):"recipients"==e.action&&(r.recipients=t,o=t)}},c=function(){J.dialogutil.close("lockdialog")},p=function(e){return e.sort(function(e,t){return e-t}),e},u=function(e){var t,i,o,r,n,a=[];n=Utils.getDocumentSharedUsers(),e=e||[];var l=-1;for(l=e.indexOf(editor.zuid),l>-1&&e.splice(l,1),t=0,i=e.length;t<i;t++)for(o=0,r=n.length;o<r;o++)e[t]==n[o].user_zuid&&a.push(n[o].emailid);return a.join(",")},f=function(){return e=Utils.getDocumentSharedUsers()},g=function(){var t,i,r,n,a=[],l=[],s=[],d=0;for(t=o.toString(),t&&(a=U.uniq(t.match(LockDlg.emailRegEx))),d=0,i=a.length;d<i;d++)for(r=0,n=e.length;r<n;r++)a[d]==e[r].email&&(e[r].id?l.push(e[r].id):s.push(a[d]));return l=p(l)},m=function(){var e={},t=g();e=DocUtil.copyStyle(r),e.allowed_zuids=editor.zuid+",",e.allowed_zuids+=t.join(","),jQuery.isEmptyObject(e)||1==e["apply-lock-rev"]?e["apply-lock-rev"]&&editor.doc.execCmd("lock_nonselction",e):editor.doc.execCmd("lock",e),editor.setEditable(!0),c(),editor.setEditable(!1)},h=function(){return t},T=function(e,t){var i=editor.doc.getSelection().isUnlockAllowed();J("#lockmenu").zmenu(i?"showMenuItem":"hideMenuItem","menu-unlock-selection").zmenu(i?"hideMenuItems":"showMenuItems",["menu-lock-selection","menu-lock-nonselection"])};return{applyLock:m,emailRegEx:n,openLockDlg:a,getList:h,closeLockDlg:c,updateMenu:T}}(),GoToDialogue.Headings=[],GoToDialogue.currentHeadingIdx=-1,GoToDialogue.selectedItem="page",GoToDialogue.setSelectedElement=function(e){GoToDialogue.selectedItem=e,GoToDialogue.toggleUI()},GoToDialogue.closeDialogue=function(){J(".ui-widget-overlay").show(),GoToDialogue.currentHeadingIdx=-1,J.dialogutil.close("gotodialog")},GoToDialogue.findElement=function(e,t){var i=-1,o=UNICODE.RANGE_START,r=GoToDialogue.selectedItem,n="pre"==e?-1:1,t=t+n;if("table"==GoToDialogue.selectedItem)return t="pre"==e?editor.doc.findPreviousIndexOf(UNICODE.TABLE,t):editor.doc.findNextIndexOf(UNICODE.TABLE,t),t=t!=-1?t+1:t;if("heading"==GoToDialogue.selectedItem){var a=GoToDialogue.currentHeadingIdx;if(a>=0)return GoToDialogue.Headings[a+n]?(GoToDialogue.currentHeadingIdx=a+n,GoToDialogue.Headings[a+n].getStart()):-1;for(var l=GoToDialogue.Headings.length,s=0;s<l;s++){var d=GoToDialogue.Headings[s].getStart();if("pre"==e){if(d<t)return GoToDialogue.currentHeadingIdx=s,d}else if(d>t)return GoToDialogue.currentHeadingIdx=s,d}return-1}return"pre"==e?newEle=editor.doc.getSelection().findPrevious(o,"",null,t,r):newEle=editor.doc.getSelection().findNext(o,"",null,t,r),null!=newEle&&(i=newEle.getStart()),i},GoToDialogue.toggleUI=function(){var e=J("#goToInputBox"),t=J("#goToSelectBox"),i=J("#goToElementLabel");if(J("#invalid-page-error-box , #elment-not-found-error-box").html("").hide(),"bookmark"==GoToDialogue.selectedItem){e.hide(),J("#goPrevious").button("disable","disable"),J("#goNext").zbutton("changeLabel","Go To"),i.text(J.i18n("writer.common.GOTOBOOKMARK"));var o=editor.doc.getElement("bookmark"),r=J("#goToCombo");r.empty();for(var n=o.length,a=0;a<n;a++)o[a].id.indexOf("toc_")==-1&&r.append(J("<option></option>").attr("value",o[a].id).text(o[a].name)).zcombo("refresh");J("#tabs_page").hide(),J("#tabs_gotoelement").hide(),t.show(),J("#tabs_bookmark").show()}else"page"==GoToDialogue.selectedItem?(setTimeout(function(){J("#goToIndex").focus()},100),t.hide(),e.show(),J("#goPrevious").button("disable","disable"),J("#goNext").zbutton("changeLabel","Go To"),J("#tabs_gotoelement").hide(),J("#tabs_bookmark").hide(),J("#tabs_page").show(),e.css("top","70px"),i.text(J.i18n("writer.common.GOTOGIVENPAGE"))):(J("#goToIncrementVal").val("1").focus(),i.text(J.i18n("writer.common.GOTOGIVENELEMENT")),t.hide(),e.show(),e.css("top","95px"),J("#goNext").zbutton("changeLabel","Next"),J("#goPrevious").button("enable","enable"),J("#tabs_bookmark").hide(),J("#tabs_page").hide(),J("#tabs_gotoelement").show())},GoToDialogue.goToElement=function(e){var t,o,r,n=J("#goToIndex"),a=RegExp(/^[0-9]{1,}$/),l=editor.doc.getSelection().getStart();if("page"==GoToDialogue.selectedItem){if(o=n.val(),r=a.test(o),!r)return void J("#invalid-page-error-box").html(J.i18n("writer.gotodialogue.INVALID_PAGE_NO")).show();J("#invalid-page-error-box").html("").hide(),t=""!=o?parseInt(o):1,GoToDialogue.moveToElement("page",t)}else if("bookmark"==GoToDialogue.selectedItem)o=J("#goToCombo").val(),GoToDialogue.moveToElement("bookmark",o);else{if(o=J("#goToIncrementVal").val(),r=a.test(o),!r)return;for(t=parseInt(o),delta="pre"==e?-1:1,i=0;i<t;i++){if("table"==GoToDialogue.selectedItem){var s=TableUtil.getTableStart(l)!=-1;s&&(l="pre"==e?TableUtil.getTableStart(l)-1:TableUtil.getTableEnd(l)+1),l=GoToDialogue.findElement(e,l)}else l=GoToDialogue.findElement(e,l+delta);if(l==-1){J("#elment-not-found-error-box").html("No "+GoToDialogue.selectedItem+" Found").show();break}J("#elment-not-found-error-box").html("").hide()}GoToDialogue.moveToElement(GoToDialogue.selectedItem,l)}},GoToDialogue.openGoToDialogue=function(){J.dialogutil.open("gotodialog",void 0,GoToDialogue.dialogInfo),Utils.addToStatistics("gotopage")},GoToDialogue.dialogInfo={init:function(){J(".ui-widget-overlay").hide(),J("#tabs_page").parent().css("border","none"),J("#goToDialogueCombo").bind("combochange",function(e,t){GoToDialogue.setSelectedElement(t.value)}),GoToDialogue.selectedItem="page",GoToDialogue.toggleUI(),GoToDialogue.Headings=editor.doc.getSelection().getAllHeadings()}},GoToDialogue.handleKeyDown=function(e,t){13==e.keyCode&&t&&(e.shiftKey?GoToDialogue.goToElement("pre"):GoToDialogue.goToElement("next"))},GoToDialogue.moveToElement=function(e,t){if("page"==e)UIUtils.gotoPage(t,!1);else if("bookmark"==e)t!=-1&&Utils.moveToBookmark(t);else if(t!=-1){var i=editor.doc.createRange(t);editor.doc.getSelection().removeAllRanges().addRange(i),Utils.scrollElementIntoView(editor.doc.getDomCursorNode(editor.uuid,editor.zuid,"start")[0])}},CustomHdrFtr=function(){"use strict";var e={All:0,Odd:1,Even:2},t=function(e,t){var i=Utils.randomString(),o=editor.doc.getDocInfo().DOCUMENT_NAME_HTML,r=editor.doc.getDocInfo().CREATOR,n=Utils.randomString(),a=editor.doc.getPaperWidth()/Conversions.globalUnitInPx,l=(a/3).toFixed(3)+Conversions.globalUnit,s=(a/2).toFixed(3)+Conversions.globalUnit,d=a.toFixed(3)+Conversions.globalUnit,c={1:[[{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{cls:"placeholder",type:"text"}}},{is:"[TYPE HERE]"},{as:{end:["cls","type"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}}],[{as:{start:{type:"paragraph",ps_null:!0}}},{r:1},{as:{end:["type"]}}]],2:[[{as:{start:{type:"paragraph"}}},{is:UNICODE.PARA},{as:{end:["type"]}},{as:{start:{theme:"tblthme1",type:"table",wid:d,cols:[{wt:l},{wt:l},{wt:l}]}}},{is:""},{as:{end:["theme","type","wid","cols"]}},{as:{start:{ht:"auto",type:"row"}}},{is:""},{as:{end:["ht","type"]}},{as:{start:{wid:l,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","border"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{cls:"placeholder",type:"text"}}},{is:"[TYPE HERE]"},{as:{end:["cls","type"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"}}}},{is:UNICODE.PARA},{as:{end:["type","ts"]}},{as:{start:{wid:l,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",va:"middle",txtal:"center",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","va","txtal","border"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{cls:"placeholder",type:"text"}}},{is:"[TYPE HERE]"},{as:{end:["cls","type"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"},al:"1"}}},{is:UNICODE.PARA},{as:{end:["type","ts","al"]}},{as:{start:{wid:l,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",va:"middle",txtal:"right",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","va","txtal","border"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{cls:"placeholder",type:"text"}}},{is:"[TYPE HERE]"},{as:{end:["cls","type"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"},al:"2"}}},{is:UNICODE.PARA},{as:{end:["type","ts","al"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"}}}},{is:""},{as:{end:["type","ts"]}}],[{as:{start:{type:"paragraph",ps_null:!0}}},{r:1},{as:{end:["type"]}}]],3:[[{as:{start:{type:"paragraph"}}},{is:UNICODE.PARA},{as:{end:["type"]}},{as:{start:{theme:"tblthme1",type:"table",wid:d,cols:[{wt:l},{wt:l},{wt:l}]}}},{is:""},{as:{end:["theme","type","wid","cols"]}},{as:{start:{ht:"auto",type:"row"}}},{is:""},{as:{end:["ht","type"]}},{as:{start:{wid:l,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",z_td_bgc:"zwdark2",va:"middle",txtal:"center",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","z_td_bgc","va","txtal","border"]}},{as:{start:{type:"autofield",id:i,ftype:"autodocname",isauto:0,val:o}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autodocname",fieldinfo:i,fgc:"zwlight1"}}},{is:"#"},{as:{end:["type","cls","fieldinfo"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"},al:"1"}}},{is:UNICODE.PARA},{as:{end:["type","ts","al"]}},{as:{start:{wid:l,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","border"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"}}}},{is:UNICODE.PARA},{as:{end:["type","ts"]}},{as:{start:{wid:l,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","border"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"}}}},{is:UNICODE.PARA},{as:{end:["type","ts"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"}}}},{is:""},{as:{end:["type","ts"]}}],[{as:{start:{type:"paragraph",ps_null:!0}}},{r:1},{as:{end:["type"]}}]],4:[[{as:{start:{type:"autofield",id:i,ftype:"autodocname",isauto:0,val:o}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autodocname",fieldinfo:i}}},{is:"#"},{as:{end:["type","cls","fieldinfo"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}}],[{as:{start:{type:"paragraph",ps_null:!0,ts:{type:"text"},al:2}}},{r:1},{as:{end:["type","ts","al"]}}]],5:[[{as:{start:{type:"autofield",id:i,ftype:"autodocname",isauto:0,val:o}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autodocname",fieldinfo:i,fgc:"rgb(255, 255, 255)"}}},{is:"#"},{as:{end:["type","cls","fieldinfo","fgc"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}}],[{as:{start:{type:"paragraph",ps_null:!0,ts:{type:"text"},bgc:"zwaccent2/60",al:2}}},{r:1},{as:{end:["type","ts","bgc","al"]}}]],6:[[{as:{start:{type:"paragraph"}}},{is:UNICODE.PARA},{as:{end:["type"]}},{as:{start:{theme:"tblthme1",type:"table",wid:d,cols:[{wt:a.toFixed(3)-1+Conversions.globalUnit},{wt:1+Conversions.globalUnit}]}}},{is:""},{as:{end:["theme","type","wid","cols"]}},{as:{start:{ht:"auto",type:"row"}}},{is:""},{as:{end:["ht","type"]}},{as:{start:{wid:a.toFixed(3)-1+Conversions.globalUnit,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","border"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"}}}},{is:UNICODE.PARA},{as:{end:["type","ts"]}},{as:{start:{wid:"1in",pl:"0.070in",pt:"0.250in",pr:"0.03in",pb:"0.100in",type:"cell",z_td_bgc:"zwaccent3",va:"middle",txtal:"center",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","z_td_bgc","va","txtal","border"]}},{as:{start:{type:"text"}}},{is:"Page No : "},{as:{end:["type"]}},{as:{start:{type:"autofield",id:i,ftype:"autopno",isauto:0}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autopno",fieldinfo:i,fgc:"zwlight1"}}},{is:"#"},{as:{end:["type","cls","fieldinfo","fgc"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"},al:"1"}}},{is:UNICODE.PARA},{as:{end:["type","ts","al"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"}}}},{is:""},{as:{end:["type","ts"]}}],[{as:{start:{type:"paragraph",ps_null:!0}}},{r:1},{as:{end:["type"]}}]],7:[[{as:{start:{type:"paragraph"}}},{is:UNICODE.PARA},{as:{end:["type"]}},{as:{start:{theme:"tblthme1",type:"table",wid:d,cols:[{wt:l},{wt:l},{wt:l}]}}},{is:""},{as:{end:["theme","type","wid","cols"]}},{as:{start:{ht:"auto",type:"row"}}},{is:""},{as:{end:["ht","type"]}},{as:{start:{wid:l,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",z_td_bgc:"zwdark2",va:"middle",txtal:"center",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(255,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(255,0,0)",space:"0px"},"border-bottom":{width:"1px",type:"solid",color:"rgb(255,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","z_td_bgc","va","txtal","border"]}},{as:{start:{type:"text",fgc:"zwlight1"}}},{is:"[TYPE HERE]"},{as:{end:["type","fgc"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text",fgc:"Theme.color.light1"},al:"1"}}},{is:UNICODE.PARA},{as:{end:["type","ts","al"]}},{as:{start:{wid:l,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(255,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(255,0,0)",space:"0px"},"border-bottom":{width:"1px",type:"solid",color:"rgb(255,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","border"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"}}}},{is:UNICODE.PARA},{as:{end:["type","ts"]}},{as:{start:{wid:l,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(255,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(255,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(255,0,0)",space:"0px"},"border-bottom":{width:"1px",type:"solid",color:"rgb(255,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","border"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"}}}},{is:UNICODE.PARA},{as:{end:["type","ts"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"}}}},{is:""},{as:{end:["type","ts"]}}],[{as:{start:{type:"paragraph",ps_null:!0}}},{r:1},{as:{end:["type"]}}]],8:[[{as:{start:{type:"autofield",id:i,ftype:"autodocname",isauto:0,val:o}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autodocname",fieldinfo:i}}},{is:"#"},{as:{end:["type","cls","fieldinfo"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}}],[{as:{start:{type:"paragraph",ps_null:!0,ts:{type:"text"},al:1}}},{r:1},{as:{end:["type","ts","al"]}}]],9:[[{as:{start:{type:"paragraph"}}},{is:UNICODE.PARA},{as:{end:["type"]}},{as:{start:{theme:"tblthme1",type:"table",wid:d,cols:[{wt:s},{wt:s}]}}},{is:""},{as:{end:["theme","type","wid","cols"]}},{as:{start:{ht:"auto",type:"row"}}},{is:""},{as:{end:["ht","type"]}},{as:{start:{wid:s,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",z_td_bgc:"zwaccent6",borders:{"border-top":{width:"0px",type:"solid",color:"zwaccent6*50",space:"0px"},"border-right":{width:"0px",type:"solid",color:"zwaccent6*50",space:"0px"},"border-left":{width:"0px",type:"solid",color:"zwaccent6*50",space:"0px"},"border-bottom":{width:"3px",type:"solid",color:"zwaccent6*50",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","z_td_bgc","border"]}},{as:{start:{type:"autofield",id:i,ftype:"autodocname",isauto:0,val:o}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autodocname",fieldinfo:i,fgc:"zwlight1"}}},{is:"#"},{as:{end:["type","cls","fieldinfo","fgc"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}},{as:{start:{type:"paragraph"}}},{is:UNICODE.PARA},{as:{end:["type"]}},{as:{start:{wid:s,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",va:"middle",txtal:"right",z_td_bgc:"zwaccent6",borders:{"border-top":{width:"0px",type:"solid",color:"zwaccent6*50",space:"0px"},"border-right":{width:"0px",type:"solid",color:"zwaccent6*50",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"3px",type:"solid",color:"zwaccent6*50",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","va","txtal","z_td_bgc","border"]}},{as:{start:{type:"autofield",id:n,ftype:"autopno",isauto:0}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autopno",fieldinfo:n,fgc:"zwlight1"}}},{is:"#"},{as:{end:["type","cls","fieldinfo","fgc"]}},{as:{start:{type:"autofield",id:n}}},{is:""},{as:{end:["type","id"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",al:"2"}}},{is:UNICODE.PARA},{as:{end:["type","al"]}},{as:{start:{type:"paragraph"}}},{is:""},{as:{end:["type"]}}],[{as:{start:{type:"paragraph",ps_null:!0,sb:"0pt",sa:"0pt",ts:{type:"text"}}}},{r:1},{as:{end:["type","ts"]}}]],10:[[{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{cls:"placeholder",type:"text"}}},{is:"[TYPE HERE]"},{as:{end:["cls","type"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}}],[{as:{start:{type:"paragraph",ps_null:!0,sb:"0pt",sa:"0pt",al:1,ts:{}}}},{r:1},{as:{end:["type","al","ts"]}}]],11:[[{as:{start:{type:"autofield",id:i,ftype:"autodocname",isauto:0,val:o}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autodocname",fieldinfo:i,fgc:"zwaccent3/60"}}},{is:"#"},{as:{end:["type","cls","fieldinfo","fgc"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",al:"0",ts:{type:"text"}}}},{is:UNICODE.PARA},{as:{end:["type","al","ts"]}},{as:{start:{type:"autofield",id:n,ftype:"autoauthor",isauto:0,val:r}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autoauthor",fieldinfo:n}}},{is:"#"},{as:{end:["type","cls","fieldinfo"]}},{as:{start:{type:"autofield",id:n}}},{is:""},{as:{end:["type","id"]}}],[{as:{start:{type:"paragraph",ps_null:!0}}},{r:1},{as:{end:["type"]}}]],12:[[{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{cls:"placeholder",type:"text"}}},{is:"[TYPE HERE]"},{as:{end:["cls","type"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}}],[{as:{start:{type:"paragraph",ps_null:!0,ts:{type:"text"},al:2}}},{r:1},{as:{end:["type","ts","al"]}}]],16:[null,[{as:{start:{type:"paragraph",ps_null:!0}}},{r:1},{as:{end:["type"]}}]]},p={1:[[{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{cls:"placeholder",type:"text"}}},{is:"[TYPE HERE]"},{as:{end:["cls","type"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}}],[{as:{start:{type:"paragraph",ps_null:!0}}},{r:1},{as:{end:["type"]}}]],2:[[{as:{start:{type:"paragraph"}}},{is:UNICODE.PARA},{as:{end:["type"]}},{as:{start:{theme:"tblthme1",type:"table",wid:d,cols:[{wt:l},{wt:l},{wt:l}]}}},{is:""},{as:{end:["theme","type","wid","cols"]}},{as:{start:{ht:"auto",type:"row"}}},{is:""},{as:{end:["ht","type"]}},{as:{start:{wid:l,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","border"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{cls:"placeholder",type:"text"}}},{is:"[TYPE HERE]"},{as:{end:["cls","type"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"}}}},{is:UNICODE.PARA},{as:{end:["type","ts"]}},{as:{start:{wid:l,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",va:"middle",txtal:"center",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","va","txtal","border"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{cls:"placeholder",type:"text"}}},{is:"[TYPE HERE]"},{as:{end:["cls","type"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"},al:"1"}}},{is:UNICODE.PARA},{as:{end:["type","ts","al"]}},{as:{start:{wid:l,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",va:"middle",txtal:"right",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","va","txtal","border"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{cls:"placeholder",type:"text"}}},{is:"[TYPE HERE]"},{as:{end:["cls","type"]}},{as:{start:{id:i,type:"placeholder"}}},{is:""},{as:{end:["id","type"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"},al:"2"}}},{is:UNICODE.PARA},{as:{end:["type","ts","al"]}},{as:{start:{type:"paragraph",sb:"0pt",sa:"0pt",ts:{type:"text"}}}},{is:""},{as:{end:["type","ts"]}}],[{as:{start:{type:"paragraph",ps_null:!0,sb:"0pt",sa:"0pt",ts:{type:"text"}}}},{r:1},{as:{end:["type","ts"]}}]],3:[[{as:{start:{type:"text",fgc:"zwdark2"}}},{is:"Page No : "},{as:{end:["type","fgc"]}},{as:{start:{type:"autofield",id:i,ftype:"autopno",isauto:0}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autopno",fieldinfo:i,fgc:"zwdark2"}}},{is:"#"},{as:{end:["fgc","type","cls","fieldinfo"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}}],[{as:{start:{ts:{type:"text"},type:"paragraph",ps_null:!0,sb:"0pt",sa:"0pt",al:2}}},{r:1},{as:{end:["ts","type","al"]}}]],4:[[{as:{start:{type:"autofield",id:i,ftype:"autopno",isauto:0}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autopno",fieldinfo:i}}},{is:"#"},{as:{end:["type","cls","fieldinfo"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}}],[{as:{start:{type:"paragraph",ps_null:!0,ts:{type:"text"}}}},{r:1},{as:{end:["type","ts"]}}]],5:[[{as:{start:{type:"paragraph"}}},{is:UNICODE.PARA},{as:{end:["type"]}},{as:{start:{theme:"tblthme1",type:"table",wid:d,cols:[{wt:"1.042in"},{wt:"5.458in"}]}}},{is:""},{as:{end:["theme","type","wid","cols"]}},{as:{start:{ht:"auto",type:"row"}}},{is:""},{as:{end:["ht","type"]}},{as:{start:{wid:"1.042in",pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",z_td_bgc:"rgb(255, 192, 0)",va:"middle",txtal:"center",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","z_td_bgc","va","txtal","border"]}},{as:{start:{type:"autofield",id:i,ftype:"autopno",isauto:0}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autopno",fieldinfo:i,fgc:"zwlight1"}}},{is:"#"},{as:{end:["fgc","type","cls","fieldinfo"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}},{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"1"}}},{is:UNICODE.PARA},{as:{end:["ts","type","al"]}},{as:{start:{wid:"5.458in",pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","border"]}},{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"0"}}},{is:UNICODE.PARA},{as:{end:["ts","type","al"]}},{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"0"}}},{is:""},{as:{end:["ts","type","al"]}}],[{as:{start:{ts:{type:"text"},type:"paragraph",ps_null:!0,sb:"0pt",sa:"0pt",al:"0"}}},{r:1},{as:{end:["ts","type","al"]}}]],6:[[{as:{start:{type:"paragraph"}}},{is:UNICODE.PARA},{as:{end:["type"]}},{as:{start:{theme:"tblthme1",type:"table",wid:d,cols:[{wt:s},{wt:s}]}}},{is:""},{as:{end:["theme","type","wid","cols"]}},{as:{start:{ht:"auto",type:"row"}}},{is:""},{as:{end:["ht","type"]}},{as:{start:{wid:s,pl:"0.010in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",ht:"0.2708333333333333in",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(85,142,213)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(85,142,213)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(85,142,213)",space:"0px"},"border-bottom":{width:"3px",type:"solid",color:"rgb(85,142,213)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","ht","border"]}},{as:{start:{type:"autofield",id:i,ftype:"autodocname",isauto:0,val:o}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autodocname",fieldinfo:i}}},{is:"#"},{as:{end:["type","cls","fieldinfo"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}},{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"0"}}},{is:UNICODE.PARA},{as:{end:["ts","type","al"]}},{as:{start:{wid:s,pl:"0.070in",pt:"0.03in",pr:"0.000in",pb:"0.03in",type:"cell",va:"middle",txtal:"right",ht:"0.2708333333333333in",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(85,142,213)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(85,142,213)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"3px",type:"solid",color:"rgb(85,142,213)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","va","txtal","ht","border"]}},{as:{start:{type:"autofield",id:n,ftype:"autoauthor",isauto:0,val:r}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autoauthor",fieldinfo:n,fgc:"#zwaccent3/40"}}},{is:"#"},{as:{end:["fgc","type","cls","fieldinfo"]}},{as:{start:{type:"autofield",id:n}}},{is:""},{as:{end:["type","id"]}},{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"2"}}},{is:UNICODE.PARA},{as:{end:["ts","type","al"]}},{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"0"}}},{is:""},{as:{end:["ts","type","al"]}}],[{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"0"}}},{r:1},{as:{end:["ts","type","al"]}}]],7:[[{as:{start:{type:"paragraph"}}},{is:UNICODE.PARA},{as:{end:["type"]}},{as:{start:{theme:"tblthme1",type:"table",wid:d,cols:[{wt:"5.521in"},{wt:"0.979in"}]}}},{is:""},{as:{end:["theme","type","wid","cols"]}},{as:{start:{ht:"auto",type:"row"}}},{is:""},{as:{end:["ht","type"]}},{as:{start:{wid:"5.521in",pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","border"]}},{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"0"}}},{is:UNICODE.PARA},{as:{end:["ts","type","al"]}},{as:{start:{wid:"0.979in",pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",z_td_bgc:"rgb(255, 0, 0)",va:"middle",txtal:"center",borders:{"border-top":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-right":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","z_td_bgc","va","txtal","border"]}},{as:{start:{type:"autofield",id:i,ftype:"autopno",isauto:0}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autopno",fieldinfo:i,fgc:"zwlight1"}}},{is:"#"},{as:{end:["fgc","type","cls","fieldinfo"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}},{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"1"}}},{is:UNICODE.PARA},{as:{end:["ts","type","al"]}},{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"0"}}},{is:""},{as:{end:["ts","type","al"]}}],[{as:{start:{ts:{type:"text"},type:"paragraph",ps_null:!0,sb:"0pt",sa:"0pt",al:"0"}}},{r:1},{as:{end:["ts","type","al"]}}]],8:[[{as:{start:{type:"paragraph"}}},{is:UNICODE.PARA},{as:{end:["type"]}},{as:{start:{theme:"tblthme1",type:"table",wid:d,cols:[{wt:s},{wt:s}]}}},{is:""},{as:{end:["theme","type","wid","cols"]}},{as:{start:{ht:"auto",type:"row"}}},{is:""},{as:{end:["ht","type"]}},{as:{start:{wid:s,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",borders:{"border-top":{width:"1px",type:"solid",color:"zwaccent5",space:"0px"},"border-right":{width:"0px",type:"solid",color:"zwaccent5",space:"0px"},"border-left":{width:"0px",type:"solid",color:"zwaccent5",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"zwaccent5",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","border"]}},{as:{start:{type:"autofield",id:i,ftype:"autopno",isauto:0}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autopno",fieldinfo:i,fgc:"zwaccent5"}}},{is:"#"},{as:{end:["type","cls","fieldinfo","fgc"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}},{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"0"}}},{is:UNICODE.PARA},{as:{end:["ts","type","al"]}},{as:{start:{wid:s,pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",va:"middle",txtal:"right",borders:{"border-top":{width:"1px",type:"solid",color:"zwaccent5",space:"0px"},"border-right":{width:"0px",type:"solid",color:"zwaccent5",space:"0px"},"border-left":{width:"0px",type:"solid",color:"rgb(0,0,0)",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"rgb(255,0,0)",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","va","txtal","border"]}},{as:{start:{type:"autofield",id:n,ftype:"autoauthor",isauto:0,val:r}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autoauthor",fieldinfo:n,fgc:"zwaccent5"}}},{is:"#"},{as:{end:["type","cls","fieldinfo","fgc"]}},{as:{start:{type:"autofield",id:n}}},{is:""},{as:{end:["type","id"]}},{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"2"}}},{is:UNICODE.PARA},{as:{end:["ts","type","al"]}},{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"0"}}},{is:""},{as:{end:["ts","type","al"]}}],[{as:{start:{ts:{type:"text"},type:"paragraph",ps_null:!0,sb:"0pt",sa:"0pt",al:"0"}}},{r:1},{as:{end:["ts","type","al"]}}]],9:[[{as:{start:{type:"paragraph"}}},{is:UNICODE.PARA},{as:{end:["type"]}},{as:{start:{theme:"tblthme1",type:"table",wid:d,cols:[{wt:"5.490in"},{wt:"1.010in"}]}}},{is:""},{as:{end:["theme","type","wid","cols"]}},{as:{start:{ht:"auto",type:"row"}}},{is:""},{as:{end:["ht","type"]}},{as:{start:{wid:"5.490in",pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",borders:{"border-top":{width:"0px",type:"solid",color:"zwdark1",space:"0px"},"border-right":{width:"0px",type:"solid",color:"zwdark1",space:"0px"},"border-left":{width:"0px",type:"solid",color:"zwdark1",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"zwdark1",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","border"]}},{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"0"}}},{is:UNICODE.PARA},{as:{end:["ts","type","al"]}},{as:{start:{wid:"1.010in",pl:"0.07in",pt:"0.03in",pr:"0.03in",pb:"0.03in",type:"cell",z_td_bgc:"zwlight2/75",va:"middle",txtal:"center",borders:{"border-top":{width:"0px",type:"solid",color:"zwlight2/75",space:"0px"},"border-right":{width:"0px",type:"solid",color:"zwlight2/75",space:"0px"},"border-left":{width:"0px",type:"solid",color:"zwlight2/75",space:"0px"},"border-bottom":{width:"0px",type:"solid",color:"zwlight2/75",space:"0px"}}}}},{is:""},{as:{end:["wid","pl","pt","pr","pb","type","z_td_bgc","va","txtal","border"]}},{as:{start:{type:"autofield",id:i,ftype:"autodate",isauto:0,datefmt:"M/d/yy",val:(new Date).getTime()}}},{is:""},{as:{end:["type","id","ftype","isauto","datefmt","val"]}},{as:{start:{type:"text",cls:"autodate",fieldinfo:i,fgc:"zwlight1"}}},{is:"#"},{as:{end:["type","cls","fieldinfo","fgc"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}},{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"1"}}},{is:UNICODE.PARA},{as:{end:["ts","type","al"]}},{as:{start:{ts:{type:"text"},type:"paragraph",sb:"0pt",sa:"0pt",al:"0"}}},{is:""},{as:{end:["ts","type","al"]}}],[{as:{start:{ts:{type:"text"},type:"paragraph",ps_null:!0,sb:"0pt",sa:"0pt",al:"0"}}},{r:1},{as:{end:["ts","type","al"]}}]],10:[[{as:{start:{type:"autofield",id:i,ftype:"autopno",isauto:0}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autopno",fieldinfo:i,fgc:"zwaccent3"}}},{is:"#"},{as:{end:["type","cls","fieldinfo","fgc"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}}],[{as:{start:{ts:{type:"text"},type:"paragraph",ps_null:!0,sb:"0pt",sa:"0pt",al:2}}},{r:1},{as:{end:["ts","type","al"]}}]],11:[[{as:{start:{type:"autofield",id:i,ftype:"autopno",isauto:0}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autopno",fieldinfo:i,fgc:"zwaccent2"}}},{is:"#"},{as:{end:["type","cls","fieldinfo","fgc"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}}],[{as:{start:{ts:{type:"text"},type:"paragraph",ps_null:!0,sb:"0pt",sa:"0pt",al:0}}},{r:1},{as:{end:["ts","type","al"]}}]],12:[[{as:{start:{type:"autofield",id:i,ftype:"autopno",isauto:0}}},{is:""},{as:{end:["type","id","ftype","isauto","val"]}},{as:{start:{type:"text",cls:"autopno",fieldinfo:i,fgc:"zwaccent2"}}},{is:"#"},{as:{end:["type","cls","fieldinfo","fgc"]}},{as:{start:{type:"autofield",id:i}}},{is:""},{as:{end:["type","id"]}}],[{as:{start:{ts:{type:"text"},type:"paragraph",ps_null:!0,sb:"0pt",sa:"0pt",al:1}}},{r:1},{as:{end:["ts","type","al"]}}]],16:[null,[{as:{start:{type:"paragraph",ps_null:!0}}},{r:1},{as:{end:["type"]}}]]};return"HEADER"===e?c[t]:p[t]},i=function(e){for(var t,i=DocTreeManager.doc.sections,o=0;o<i.length;o++){var r=editor.doc.getRawFormatAt(i[o].start);if(r.hasOwnProperty("hftype")&&r.hftype==e){t=i[o];break}}return t},o=function(e){var t=e.start,i=e.end;t+UNICODE.SECTION_START.length!=i-1&&editor.doc.getSelection().deleteContents(t+1,i-1)},r=function(e,r,n){var a=i(r);if(a){Op.fillCursorPos(a.start+1,a.start+1),o(a);var l=t(e,n);Op.processMsg([{r:a.end-1}].concat(l[1])),l[0]&&(Op.sendMsg(),Op.processMsg([{r:a.start+1}].concat(l[0])))}},n=function(t,i){var o={hf_type:e.All,styleId:i,type:t};a(o),EventHandler.toggleSection()},a=function(e){var t=editor.doc.getBodyFormat(),i=e.type,o=t[ATTR_BODY.DS_HF_TYPE],n=editor.doc.getSelection().parents(NODE_TYPE.BODY);if(0===parseFloat(t[ATTR_BODY.DS_MT])&&"HEADER"===i||0===parseFloat(t[ATTR_BODY.DS_MB])&&"FOOTER"===i){var a={};a["HEADER"===i&&0===parseFloat(t[ATTR_BODY.DS_MT])?ATTR_BODY.DS_MT:ATTR_BODY.DS_MB]="1in",n.attr(a)}var l=editor.getViewPortInfo().pageNo,s="PRIMARY";1!=l||o!=HEADER_FOOTER_TYPE.DIFF_FIRST_PAGE&&o!=HEADER_FOOTER_TYPE.DIFF_FIRST_ODD_EVEN_PAGE?l%2!=1||o!=HEADER_FOOTER_TYPE.DIFF_FIRST_ODD_EVEN_PAGE&&o!=HEADER_FOOTER_TYPE.DIFF_ODD_EVEN_PAGE?l%2!=0||o!=HEADER_FOOTER_TYPE.DIFF_FIRST_ODD_EVEN_PAGE&&o!=HEADER_FOOTER_TYPE.DIFF_ODD_EVEN_PAGE||(s="EVEN"):s="PRIMARY":s="FIRST",r(i,CONST[e.type+"_"+s],e.styleId),Op.sendMsg()},l=function(){var e=J("#hTop"),t=J("#fBot"),i=editor.doc.getSelection().parents(NODE_TYPE.BODY).attr("*");PageLayoutPanel.updateHFMaxValue(i[ATTR_BODY.DS_MT],e),PageLayoutPanel.updateHFMaxValue(i[ATTR_BODY.DS_MB],t);var o=Conversions.toGlobalUnit(i[ATTR_BODY.DS_HT]),r=Conversions.toGlobalUnit(i[ATTR_BODY.DS_FB]);e.zspinner("setValue",o),t.zspinner("setValue",r);var n=i[ATTR_BODY.DS_HF_TYPE];n="undefined"==typeof n?HEADER_FOOTER_TYPE.PRIMARY:n,J("#menu_firstpage,#menu_evenodd").zstatebutton("checked",!1),n!=HEADER_FOOTER_TYPE.DIFF_FIRST_PAGE&&n!=HEADER_FOOTER_TYPE.DIFF_FIRST_ODD_EVEN_PAGE||J("#menu_firstpage").zstatebutton("checked",!0),n!=HEADER_FOOTER_TYPE.DIFF_ODD_EVEN_PAGE&&n!=HEADER_FOOTER_TYPE.DIFF_FIRST_ODD_EVEN_PAGE||J("#menu_evenodd").zstatebutton("checked",!0)},s=function(){var e=parseFloat(editor.doc.bodyFormat[ATTR_BODY.DS_FB]),t=parseFloat(J("#fBot").zspinner("getValue"));if(e!=t){var i={};i[ATTR_BODY.DS_FB]=t+Conversions.globalUnit;var o=editor.doc.getSelection(),r=o.parents(NODE_TYPE.BODY);editor.doc.execCmd("applyStyle",[r,i,"updateFooterMargin"])}},d=function(){var e=parseFloat(editor.doc.bodyFormat[ATTR_BODY.DS_HT]),t=parseFloat(J("#hTop").zspinner("getValue"));if(e!=t){var i={};i[ATTR_BODY.DS_HT]=t+Conversions.globalUnit;var o=editor.doc.getSelection(),r=o.parents(NODE_TYPE.BODY);editor.doc.execCmd("applyStyle",[r,i,"updateHeaderMargin"])}},c=function(){var e=editor.doc.getBodyFormat()[ATTR_BODY.DS_HF_TYPE];e="undefined"==typeof e?HEADER_FOOTER_TYPE.PRIMARY:e;var t=J("#menu_firstpage").is(":checked"),i=J("#menu_evenodd").is(":checked"),o=HEADER_FOOTER_TYPE.PRIMARY;t&&!i?o=HEADER_FOOTER_TYPE.DIFF_FIRST_PAGE:!t&&i?o=HEADER_FOOTER_TYPE.DIFF_ODD_EVEN_PAGE:t&&i&&(o=HEADER_FOOTER_TYPE.DIFF_FIRST_ODD_EVEN_PAGE),editor.doc.execCmd("changeHdrFtr",o)};return{applyStyle:a,clearSectionContent:o,getSectionByHfType:i,changeHeaderFooterType:c,changeHeaderMargin:d,changeFooterMargin:s,applyPreHeaderFooterStyle:n,updateHeaderFooterPanel:l}}(),carousel.init=function(){function e(){J("#carousel-parent ul").animate({left:+o},200,function(){J("#carousel-parent ul li:last-child").prependTo("#carousel-parent ul"),J("#carousel-parent ul").css("left","")})}function t(){J("#carousel-parent ul").animate({left:-o},200,function(){J("#carousel-parent ul li:first-child").appendTo("#carousel-parent ul"),J("#carousel-parent ul").css("left","")})}var i=J("#carousel-parent ul li").length,o=J("#carousel-parent ul li").width(),r=J("#carousel-parent ul li").height(),n=i*o;J("#carousel-parent").css({width:o,height:r}),J("#carousel-parent ul").css({width:n,marginLeft:-o}),J("#carousel-parent ul li:last-child").prependTo("#carousel-parent ul"),J("a.carousel-ctrl-prev").click(function(){e()}),J("a.carousel-ctrl-next").click(function(){t()})},CollabListHandler={},CollabListHandler.userStatus={},CollabListHandler.updateAddedUserStatus=function(e){var t=CollabListHandler.userStatus[e];t||(t=CollabListHandler.userStatus[e]={}),t.WMSSTATUS="1",t.LASTACCESSTIME="0",CollabListHandler.updateCollabMenu(e)},CollabListHandler.updateRemovedUserStatus=function(e){var t=CollabListHandler.userStatus[e];t||(t=CollabListHandler.userStatus[e]={}),t.WMSSTATUS="0",CollabListHandler.updateCollabMenu(e)},CollabListHandler.updateCollabMenu=function(e){var t=J("#collablistmenu");if(t[0]){var i=t.find('li[id="'+e+'"]'),o=CollabListHandler.userStatus[e];i?(i.find(".ui-access-status").addClass("ui-icon-read-sm").removeClass("ui-icon-unread-sm"),"0"===o.WMSSTATUS?i.find(".ui-wms-status").addClass("ui-wms-offline").text(J.i18n("writer.collaboratorpanel.status.VIEWED")):i.find(".ui-wms-status").removeClass("ui-wms-offline").text(J.i18n("writer.collaboratorpanel.status.VIEWING_NOW"))):(t.empty(),CollabListHandler.openCollabMenu())}},CollabListHandler.getListByStatus=function(){var e={"On&Ac":[],"Off&Ac":[],"Off&NA":[]};for(var t in CollabListHandler.userStatus){var i=CollabListHandler.userStatus[t];editor.zuid!=editor.doc.docInfo.CREATOR_ZUID&&editor.zuid==i.ZUID||("1"==i.WMSSTATUS?e["On&Ac"].push(i):"0"==i.WMSSTATUS&&"-1"!=i.LASTACCESSTIME?e["Off&Ac"].push(i):"0"==i.WMSSTATUS&&"-1"==i.LASTACCESSTIME&&e["Off&NA"].push(i))}return e},CollabListHandler.getDialogContent=function(){var e=CollabListHandler.getListByStatus(),t=0,i=editor.doc.getDocInfo(),o=e["On&Ac"].concat(e["Off&Ac"].concat(e["Off&NA"]));if(U.find(o,function(e){return t++,e.ZUID==i.CREATOR_ZUID}),t-=1,0!=t&&t!=o.length){var r=o[t];o[t]=o[0],o[0]=r}var n=function(e){var t=e.last_closed_time==-1?J.i18n("writer.collaboratorpanel.status.VIEWED"):J.i18n("writer.collaboratorpanel.status.LAST_VIEWED")+" "+moment(e.last_closed_time).fromNow(),o='<div class="ui-colab-memberslist '+(e.ZUID==i.CREATOR_ZUID?"ui-doc-owner":"")+' "><div class="ui-colab-listitem"><a class="ui-corner-all" tabindex="-1"><img src='+Utils.getUserImageURL(e.ZUID)+">"+(e.ZUID!=i.CREATOR_ZUID?'<em class="ui-fr ui-right-margin-small ui-top-margin-small ui-access-status '+("-1"===e.LASTACCESSTIME?"ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-unread-sm":"ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-read-sm")+'"></em>':"")+'<span class="">'+e.FULLNAME+'<br><span class="ui-wms-status '+("0"===e.WMSSTATUS?"ui-wms-offline":"")+'">'+(e.ZUID==i.CREATOR_ZUID?'<span class="ui-collab-owner-label">'+J.i18n("writer.collaboratorpanel.DOCUMENT_OWNER")+"</span>":"")+(e.ZUID==i.CREATOR_ZUID&&"0"!=e.WMSSTATUS?'<span class="ui-collab-owner-label">-</span>':"")+("-1"===e.LASTACCESSTIME?J.i18n("writer.collaboratorpanel.status.YET_TO_VIEW"):"0"===e.WMSSTATUS?e.ZUID!=i.CREATOR_ZUID?t:"":J.i18n("writer.collaboratorpanel.status.VIEWING_NOW"))+"</span></span></a></div></div>";return o},a="";for(t=0;t<o.length;t++){var e=o[t];e.FULLNAME&&(a+=n(e))}return a},CollabListHandler.openCollabDialog=function(){var e={init:function(){J("#container").empty();var e=CollabListHandler.getDialogContent(),t=J(e);t.appendTo(J("#container"))}};J.dialogutil.open("collablistdialog",null,e)},CollabListHandler.openCollabMenu=function(){var e=J("#collablistmenu"),t=0,i=editor.doc.getDocInfo();if(0==e.find("li").length){Utils.getSharedUserStatus();var o=function(o){var r=o.last_closed_time==-1?J.i18n("writer.collaboratorpanel.status.VIEWED"):J.i18n("writer.collaboratorpanel.status.LAST_VIEWED")+" "+moment(o.last_closed_time).fromNow(),n='<div class="ui-colab-memberslist"><div class="ui-colab-listitem"><a class="ui-corner-all" tabindex="-1"><img src='+Utils.getUserImageURL(o.ZUID)+">"+(o.ZUID!=i.CREATOR_ZUID?'<em class="ui-fr ui-right-margin-small ui-top-margin-small ui-access-status '+("-1"===o.LASTACCESSTIME?"ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-unread-sm":"ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-read-sm")+'"></em>':"")+'<span class="">'+o.FULLNAME+'<br><span class="ui-wms-status '+("0"===o.WMSSTATUS?"ui-wms-offline":"")+'">'+(o.ZUID==i.CREATOR_ZUID?'<span class="ui-collab-owner-label">'+J.i18n("writer.collaboratorpanel.DOCUMENT_OWNER")+"</span>":"")+(o.ZUID==i.CREATOR_ZUID&&"0"!=o.WMSSTATUS?'<span class="ui-collab-owner-label">-</span>':"")+("-1"===o.LASTACCESSTIME?J.i18n("writer.collaboratorpanel.status.YET_TO_VIEW"):"0"===o.WMSSTATUS?o.ZUID!=i.CREATOR_ZUID?r:"":J.i18n("writer.collaboratorpanel.status.VIEWING_NOW"))+"</span></span></a></div></div>",a={data:"{}",html:{content:n,replaceWithText:!0},id:o.ZUID};e.zmenu("addMenuItem",a),o.ZUID==i.CREATOR_ZUID&&J("#collablistmenu").find("li:eq("+t+")").addClass("ui-doc-owner")},r=function(t){var i='<div class="ui-colab-memberslist ui-collab-listitem-hover" onclick="CollabListHandler.openCollabDialog()"><div class="ui-colab-listitem"><a class="ui-corner-all" tabindex="-1"><span class="ui-colab-user-total">+'+(t-7)+'</span><a class="ui-colab-view-all" href="#">'+J.i18n("writer.common.VIEW_All")+"</a></a></div></div>",o={html:{content:i,replaceWithText:!0}};e.zmenu("addMenuItem",o)},n=CollabListHandler.getListByStatus(),a=n["On&Ac"].concat(n["Off&Ac"].concat(n["Off&NA"]));if(U.find(a,function(e){return t++,e.ZUID==i.CREATOR_ZUID}),t-=1,0!=t&&t!=a.length){var l=a[t];a[t]=a[0],a[0]=l}for(t=0;t<a.length&&t<7;t++){var n=a[t];n.FULLNAME&&o(n)}a.length>7&&r(a.length),e.zmenu("addMenuItem",{mtype:"separator"});var s=(ZWSelection.isCollabCursorShown(),'<div class="ui-colab-memberslist ui-top-margin-small"><span class="ui-fl ui-icon ui-live-cursor-icon ui-zmenu-icon-inner ui-button-icon-primary ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-live-cursor-sm"></span><div class="ui-fl">'+J.i18n("writer.common.VIEW_LIVE_CURSORS")+'</div><div class="onoffswitch ui-live-cursor-switch ui-fr" onClick="CollabListHandler.toggleCollabCursors();"><input id="live-cursor-status" type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="view-cursor-switch" checked><label class="onoffswitch-label" for="view-cursor-switch"><span class="onoffswitch-inner"></span><span class="onoffswitch-switch"></span></label></div></div>'),d='<div class="ui-colab-memberslist ui-collab-listitem-hover" onClick="WebUtil.notifyCollaborators()"><span class="ui-fl ui-icon ui-live-cursor-icon ui-zmenu-icon-inner ui-button-icon-primary ui-writer-menu-icons ui-icon-sprit-fast ui-icon-mail-sm"></span><div class="ui-fl">'+J.i18n("writer.common.NOTIFY_COLLABORATORS")+"</div></div>",c='<div class="ui-colab-memberslist ui-collab-listitem-hover" onClick="Settings.showNotificationDialog()"><span class="ui-fl ui-icon ui-live-cursor-icon ui-zmenu-icon-inner ui-button-icon-primary ui-writer-menu-icons ui-icon-sprit-fast ui-icon-follow-sm"></span><div class="ui-fl">'+J.i18n("writer.common.FOLLOW_CHANGES")+"</div></div>";e.zmenu("addMenuItem",{html:{content:d,replaceWithText:!0}}),e.zmenu("addMenuItem",{html:{content:c,replaceWithText:!0}}),e.zmenu("addMenuItem",{mtype:"separator"}),e.zmenu("addMenuItem",{html:{content:s,replaceWithText:!0}}),J("#collablistmenu .ui-collab-listitem-hover").parents("li").addClass("ui-collab-listitem-hover-li")}},CollabListHandler.toggleCollabCursors=function(){JliveCurState=J("#live-cursor-status"),ZWSelection.isCollabCursorShown()?(ZWSelection.hideCollabCursors(),JliveCurState.removeAttr("checked")):(ZWSelection.showCollabCursors(),JliveCurState.prop("checked",!0))},CollabListHandler.addSubscribers=function(){PubSub.subscribe("Collaboration/UserAdded",CollabListHandler.updateAddedUserStatus),PubSub.subscribe("Collaboration/UserRemoved",CollabListHandler.updateRemovedUserStatus)}(),function(){var e=[],t=0,i=void 0,o=!0,r=void 0,n={PRIVATE:0,ORG:1,PUBLIC:2},a=function(){i=editor.getBaseURL()+"/published/"+Utils.getDocumentId()},l=function(){return i||a(),i},s=function(e){1==e?t=n.ORG:2==e&&(t=n.PUBLIC),d()},d=function(){var e=editor.doc.getDocInfo();!editor.orgPolicyData.publish_document&&!editor.orgPolicyData.publish_policy||e.CREATOR_ZUID!=editor.zuid&&"COOWNER"!=editor.doc.getRole()?MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_WARNING,J.i18n("writer.common.WARNING"),J.i18n("writer.common.PUBLISH_NOT_ALLOWED")):e.PUBLISH_SCOPE?m():c()},c=function(){J.dialogutil.open("publishnow",void 0,p)},p={init:function(){""!=editor.orgName?editor.orgName:J.i18n("writer.common.Organisation");t==n.ORG?(r=n.ORG,J(".publish-external").hide()):t==n.PUBLIC&&(r=n.PUBLIC,J(".publish-organization").hide()),o=!0},set:function(e,t,i){"autoPublish"==e.action&&(o=i.is(":checked"))},get:function(e,t){if("autoPublish"==e)return o}},u=function(){var e={},t=J("#btn-publish");t.disable(),t.button("option","label",J.i18n("writer.common.PUBLISHING")),e.successCallback=f,e.failureCallback=g,U(e)},f=function(e,t,i){var o=e.data;k(e.data),o.PUBLISH_SCOPE&&(J.dialogutil.close("publishnow"),m())},g=function(e,t,i){J.dialogutil.close("publishnow"),MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_ERROR,J.i18n("writer.common.ERROR"),J.i18n(e.responseJSON.message))},m=function(){J.dialogutil.open("publishdetail",void 0,h)},h={init:function(){var e=J("#publish_ui"),t=editor.doc.getDocInfo();r=t.PUBLISH_SCOPE,o=!!t.AUTO_PUBLISH,("-1"==editor.zoid||"COOWNER"==editor.doc.getRole()&&editor.zoid!=t.ORG_ZOID||!editor.orgPolicyData.publish_document)&&e.find("#change_publish").hide(),e.find("#btn-mail-public-url").bind("click",H),e.find("#publishmenutabs").bind("tabselect",T),e.find("#emailPublishLink input").on("focus.writer",E),S(),V()},set:function(t,i,n){"recipients"==t.action?e=i:"autoPublish"==t.action?(o=n.is(":checked"),D()):"publishMode"==t.action&&(r=n.val(),b())},get:function(t,i){return"shareableLink"==t?l():"embedURL"==t?'<iframe width="500" height="400" frameborder="0" scrolling="no" src="'+l()+'?mode=embed"></iframe>':"recipients"==t?e:"autoPublish"==t?o:"publishMode"==t?r:void 0}},T=function(e,t){"email_tab_div"===t.relatedPaneId?J("#emailPublishLink").trigger("click"):O&&J("#btn-select-embed-url span, #btn-select-public-url span").text(J.i18n("writer.common.COPY"))},E=function(){contacts=Contacts.getContacts({callback:R}),R(contacts),J("#emailPublishLink input").off("focus.writer")},R=function(e){var t=J("#emailPublishLink");t.zautosuggest("option","imageURL",window.contactServer),t.zautosuggest("setSource",e)},S=function(){if(O())v("#btn-select-public-url","#publicURL","writer.common.COPIED"),v("#btn-select-embed-url","#txt-embed-url","writer.common.COPIED");else{var e=J("#btn-select-public-url, #btn-select-embed-url");e.text(J.i18n("writer.common.SELECT")),e.attr("title",J.i18n("writer.common.SELECT"))}},O=function(){var e=(/chrom(e|ium)/.test(navigator.userAgent.toLowerCase()),navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./));return!!(e&&parseInt(e[2])>=42)},v=function(e,t,i){var o=document.querySelector(e);o.addEventListener("click",function(e){var r=document.querySelector(t);successful=!1,r.select(),successful=document.execCommand("copy"),successful&&J(o).find("span").text(J.i18n(i))})},b=function(e){var t={},i=editor.doc.getDocInfo(),o=i.PUBLISH_SCOPE;e&&(r=e),r!=o&&(t.successCallback=A,t.failureCallback=y,U(t))},A=function(e,t,i){J("#btn-republish").remove(),k(e.data),V(),m()},y=function(e){V(),MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_ERROR,J.i18n("writer.common.ERROR"),J.i18n(e.responseJSON.message))},D=function(){var e={},t=editor.doc.getDocInfo();o!=t.AUTO_PUBLISH&&(J("#autoPublish").disable(),r=t.PUBLISH_SCOPE,e.successCallback=C,e.failureCallback=I,U(e))},C=function(e,t,i){var r="";J("#autoPublish").enable(),r=o?"writer.common.ENABLING_AUTO_PUBLISH_SUCCESS":"writer.common.DISABLING_AUTO_PUBLISH_SUCCESS",k(e.data),Y()},I=function(e){var t=o?"writer.common.ENABLING_AUTO_PUBLISH_FAILURE":"writer.common.DISABLING_AUTO_PUBLISH_FAILURE";J("#autoPublish").enable(),Y(),MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_ERROR,J.i18n("writer.common.ERROR"),J.i18n(t))},P=function(){var e={},t=editor.doc.getDocInfo(),i=J("#btn-republish");i.disable(),i.find(".ui-button-text").text(J.i18n("writer.common.REPUBLISHING")),r=t.PUBLISH_SCOPE,o=t.AUTO_PUBLISH,e.successCallback=_,e.failureCallback=N,U(e)},_=function(e,t,i){var o=J("#btn-republish");o.disable(),o.find(".ui-button-text").text(J.i18n("writer.common.REPUBLISH")),k(e.data),Y()},N=function(e){Y(),MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_ERROR,J.i18n("writer.common.ERROR"),J.i18n("writer.common.REPUBLISH_FAILURE"))},L=function(){var e={},t=(editor.doc.getDocInfo(),J("#btn-remove-publish"));t.disable(),t.find(".ui-button-text").text(J.i18n("writer.common.REMOVING")),r=0,o=!1,e.successCallback=w,e.failureCallback=M,U(e)},w=function(e,t,i){var o=J("#btn-remove-publish");o.disable(),o.find(".ui-button-text").text(J.i18n("writer.common.REMOVE_PUBLISH")),k(e.data),Y(),J.dialogutil.close("publishdetail")},M=function(e){Y(),MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_ERROR,J.i18n("writer.common.ERROR"),J.i18n("writer.common.REMOVE_PUBLISH_FAILURE"))},U=function(e){var t,i={};t=Utils.getContextUrl("v1/web/"+editor.doc.getDocInfo().RID+"/publish"),e=e||{},i.publishScope=r,i.autoPublish=o,Utils.setCsrfParam(i),J("#publish_settings_tab_div input").prop("disable",!0),J.ajax({url:t,data:i,type:"POST",dataType:"json",success:e.successCallback||x,error:e.failureCallback||F})},x=function(e,t,i){k(e.data),e.data.PUBLISH_SCOPE||J.dialogutil.close("publishdetail"),e.data.PUBLISH_SCOPE&&(J.dialogutil.close("publishnow"),m()),MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_INFO,J.i18n("writer.common.SUCCESS"),J.i18n(e.message))},F=function(e,t,i){k(editor.doc.getDocInfo()),MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_ERROR,J.i18n("writer.common.ERROR"),J.i18n(e.message))},k=function(e){var t={};t.AUTO_PUBLISH=o=!e.PUBLISH_SCOPE||e.AUTO_PUBLISH,t.PUBLISH_SCOPE=r=e.PUBLISH_SCOPE,editor.doc.setDocInfo(t),UIUtils.showDocStatusIcon(),UIUtils.docStatushyperlink()},B=function(e){var t=editor.doc.getDocInfo(),i=e?J(e.target).attr("id"):void 0;if(t.PUBLISH_SCOPE&&("facebook"==i||"twitter"==i||"linkedin"==i)){var o="twitter.com/intent/tweet?hashtags=ZohoWriter&text=";"fuji"!==editorProps.deployment.customername&&"facebook"!==editorProps.deployment.customername||(o="twitter.com/intent/tweet?text=");var r={facebook:"www.facebook.com/sharer/sharer.php?u=",twitter:o,linkedin:"www.linkedin.com/cws/share?url="},n=editor.scheme+"://"+r[i],a=encodeURIComponent(l()),s=window.open("about:blank","","width=500, height=300,left=200,top=200,scrollbars=1");return n+="twitter"==i?encodeURIComponent(editor.doc.getDocInfo().DOCUMENT_NAME)+":&url="+a:a,s.document.write("<script>window.open('"+n+"', '_self');</script>"),s.document.close(),!1}},H=function(){var t,i={},o=editor.doc.getDocInfo(),r=J("#btn-mail-public-url");return e.length?o.PUBLISH_SCOPE?(r.disable(),r.text(J.i18n("writer.common.SENDING")),i.recipients=e.toString(),Utils.setCsrfParam(i),t=Utils.getContextUrl("v1/web/"+o.RID+"/publish/email"),void J.ajax({url:t,data:i,type:"POST",dataType:"json",success:G,error:z})):void Notification.show({container:"#publish-errormsg-container",message:"writer.common.PUBLISH_BEFORE_EMAIL",close:!1,setTimer:!0,type:"warning"}):void Notification.show({container:"#publish-errormsg-container",message:"writer.common.ENTER_PROPER_EMAILID",close:!1,setTimer:!0,type:"warning"})},G=function(t,i,o){var r=J("#btn-mail-public-url");r.enable(),r.text(J.i18n("writer.common.SEND")),e=[],J("#emailPublishLink .ui-zautosuggest div").remove(),Notification.show({container:"#publish-errormsg-container",message:t.message,close:!1,setTimer:!0,type:"success"}),J("#emailPublishLink").trigger("click")},z=function(e,t,i){Notification.show({container:"#publish-errormsg-container",message:e.responseJSON.message,close:!1,setTimer:!0,type:"error"})},V=function(){Y(),W()},Y=function(){var e=J("#publish_ui"),t=editor.doc.getDocInfo();e.find("#publish_settings_tab_div input").prop("enable",!0),e.find("#autoPublish").prop("checked",!!t.AUTO_PUBLISH),t.PUBLISH_SCOPE==n.ORG?e.find("#js-publish-status-txt").text(J.i18n("writer.publish.PUBLISHED_WITHIN_ORG")):t.PUBLISH_SCOPE==n.PUBLIC&&e.find("#js-publish-status-txt").text(J.i18n("writer.publish.PUBLISHED_EXTERNAL")),!t.PUBLISH_SCOPE||t.AUTO_PUBLISH?e.find("#btn-republish, .js-update-txt").hide():e.find("#btn-republish").length?e.find("#btn-republish").show():e.find(".js-update-txt").show()},W=function(){var e=J("#share-socialmedia"),t=editor.doc.getDocInfo();e.unbind("click"),2==t.PUBLISH_SCOPE?(e.prop("enable",!0),e.removeClass("ui-opacity"),e.bind("click",B)):(e.prop("disable",!0),e.addClass("ui-opacity"))},j=function(e){var t,i=editor.doc.getDocInfo();if(e.PUBLISH_SCOPE!=i.PUBLISH_SCOPE||e.AUTO_PUBLISH!=i.AUTO_PUBLISH)if(k(e),J("#publishNow").is(":visible")&&e.PUBLISH_SCOPE)J.dialogutil.close("publishnow"),J.dialogutil.open("publishdetail",void 0,h),t="writer.common.PUBLISHED_INSESSION";else if(J("#publish_ui").is(":visible"))e.PUBLISH_SCOPE?(V(),t="writer.common.PUBLISH_UPDATED_INSESSION"):(J.dialogutil.close("publishdetail"),t="writer.common.REMOVED_PUBLISH_INSESSION",MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_INFO,J.i18n("writer.common.REMOVED_PUBLISH_INSESSION_TITLE_MSG"),J.i18n(t)));else if(J("#publishMenu").is(":visible"))return void Z()},Z=function(){var e=[],t=!1,i=J("#publishMenu"),o=editor.doc.getDocInfo(),r=o.PUBLISH_SCOPE==n.ORG,a=editor.orgPolicyData.publish_document,l=o.PUBLISH_SCOPE==n.PUBLIC,s=(editor.orgPolicyData.publish_policy||editor.orgPolicyData.publish_document)&&editor.zoid!=-1,d=editor.zuid==o.CREATOR_ZUID||"COOWNER"==editor.doc.getRole()&&editor.zoid==o.ORG_ZOID;if(s||a){var c={id:"publish_external",label:J.i18n("writer.publish.TOEXTERNALWORLD"),icon:"ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-outside-world-sm",data:"{ appData: { action: 'Publish.publishInitialSelection', params: '2' } }"},p={id:"publish_organization",label:J.i18n("writer.publish.WITHINORGANIZATION"),icon:"ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-with-in-organization-sm",data:"{ appData: { action: 'Publish.publishInitialSelection', params: '1' } }"},u={id:"js-published-details",label:J.i18n("writer.publish.PUBLISH_DETAILS_SETTINGS"),icon:"ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-publish-settings-sm",data:"{ appData: { action: 'Publish.openDialog' } }"},f={label:J.i18n("writer.common.REPUBLISH"),icon:"ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-republish-sm",data:"{ appData: { action: 'Publish.republishClicked' } }"},g={label:J.i18n("writer.publish.TOEXTERNALWORLD"),icon:"ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-outside-world-sm",data:"{ appData: { action: 'Publish.changePublishMode', params: '2' } }"},m={id:"js-publish-remove",label:J.i18n("writer.common.REMOVE_PUBLISH"),icon:"ui-icon ui-writer-menu-icons ui-icon-sprit-image-blue ui-icon-publish-stop-sm",data:"{ appData: { action:'Publish.removePublish' } }"};o.PUBLISH_SCOPE?l||d||!a?(r&&a&&e.push(g),(l&&(a||s)||r&&s)&&(!a&&l&&(t=!0),o.AUTO_PUBLISH||e.push(f),e.push(u),e.push(m))):e.push(c):(s&&d&&e.push(p),a&&e.push(c))}return e.length?(i.zmenu("removeAllMenuItems"),i.zmenu("addMenuItems",e),void(t&&i.zmenu("disable"))):(MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_WARNING,J.i18n("writer.common.WARNING"),J.i18n("writer.common.PUBLISH_NOT_ALLOWED")),!1)},X=function(e){var t=editor.doc.getDocInfo();t.PUBLISH_SCOPE!=e&&(r=e,b())},K=function(){var e=editor.doc.getDocInfo();if(e.PUBLISH_SCOPE){var t=J("#changePublishTypeMenu");return e.PUBLISH_SCOPE==Publish.PUBLISH_TYPE.ORG?(t.find("#publish_external").removeClass("ui-opacity"),t.find("#publish_organization").addClass("ui-opacity")):(t.find("#publish_organization").removeClass("ui-opacity"),t.find("#publish_external").addClass("ui-opacity")),!0}return!1},$=function(){var e="-1"!=editor.zuid?n.ORG:n.PUBLIC;J.dialogutil.close("documentpropertiesdlg"),s(e)};window.Publish={setURL:a,getURL:l,openDialog:d,publishMode:X,PUBLISH_TYPE:n,wmsMsgHandler:j,removePublish:L,republishClicked:P,changePublishMode:b,updatePublishMenu:Z,publishNowClicked:u,openFromPropertyDlg:$,publishInitialSelection:s,updateChangePublishMenuUI:K}}(),function(){var e=function(){var e,t={};return TcManager.isEmpty()?(e=Utils.getContextUrl("v1/web/"+editor.doc.getDocInfo().RID+"/markfinal"),Utils.setCsrfParam(t),J("#complete-tb-markasfinal").disable(),void J.ajax({url:e,data:t,type:"POST",dataType:"json",success:function(e,t,i){editor.doc.getSelection().collapseToStart(),CurUtil.setCursorVisiblity(!1),PubSub.publish("QuickSeek/hideAllBar"),editor.doc.setDocInfo({FINAL_INFO:{STATUS:!0,zuid:editor.zuid}}),o(),LayoutManager.isRichEditActive()&&LayoutManager.toggleRichEdit(),MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_SUCCESS,J.i18n("writer.common.FINAL_SUCCESS_OWNER_TITLE_MSG"),J.i18n("writer.common.FINAL_SUCCESS_OWNER_MSG")),Utils.addToStatistics("MarkAsFinal"),J("#complete-tb-markasfinal").enable(),ModeManager.switchMode(LAYOUTS.COMPLETE)},error:function(){MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_ERROR,J.i18n("writer.error.OOPS"),J.i18n("writer.common.MARK_AS_FINAL_FAILURE")),J("#complete-tb-markasfinal").enable()}})):void MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_INFO,J.i18n("writer.common.FINAL_TRACK_CHNAGES_TITLE_MSG"),J.i18n("writer.common.FINAL_TRACK_CHNAGES_PENDING"))},t=function(){var e=function(e,t,i){CurUtil.blinkCursor(),editor.doc.setDocInfo({FINAL_INFO:{STATUS:!1,zuid:editor.zuid}}),o(),Notification.hide(),J("#btn-revert-final").enable(),J("#btn-edit-container").enable(),MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_SUCCESS,J.i18n("writer.common.REVERT_FINAL_SUCCESS_TITLE_MSG"),J.i18n("writer.common.REVERT_FINAL_SUCCESS_OWNER_MSG"))},t=function(){Notification.hide(),J("#btn-revert-final").enable(),J("#btn-edit-container").enable(),MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_ERROR,J.i18n("writer.error.OOPS"),J.i18n("writer.common.REVERT_FINAL_FAILURE"))};J("#btn-revert-final").disable(),J("#btn-edit-container").disable(),i(e,t)},i=function(e,t){var i,o={};i=Utils.getContextUrl("v1/web/"+editor.doc.getDocInfo().RID+"/revertfinal"),Utils.setCsrfParam(o),J.ajax({url:i,data:o,type:"POST",dataType:"json",success:e,error:t})},o=function(){var e=editor.doc.getDocInfo();if(e.FINAL_INFO){if(e.FINAL_INFO.STATUS)ViewManager.renderAllpages(),editor.setEditable(!1);else{var t=editor.doc.getRole();"ANYONELINK_SHAREDREADCOMMENT"!=t&&"SHAREDREAD"!=t&&"SHAREDREADCOMMENT"!=t&&(!e.CHECKEDOUT||e.CHECKEDOUT&&e.CHECKEDOUTBY_ZUID==editor.zuid)&&editor.setEditable(!0)}r()}},r=function(){var e=editor.doc.getDocInfo(),t=J("#complete-tb-markasfinal"),i=J("#complete-tb");"COOWNER"==editor.doc.getRole()||editor.zuid==e.CREATOR_ZUID?e.FINAL_INFO.STATUS?(J("#btn-edit-container").attr({title:J.i18n("writer.common.MARK_AS_FINAL_TOOLTIP",[d()])}),e.FINAL_INFO.zuid==editor.zuid||editor.zuid==e.CREATOR_ZUID?(i.find("#txt-marked-final").removeClass("ui-top-margin-medium"),i.find("#final-doc-border, #btn-edit-container, #btn-revert-final").show(),t.hide()):(i.find("#txt-marked-final").addClass("ui-top-margin-medium"),i.find("#final-doc-border, #btn-edit-container").show(),i.find("#btn-revert-final").hide(),t.hide())):(i.find("#final-doc-border, #btn-edit-container").hide(),t.show()):e.FINAL_INFO.STATUS?(J("#btn-edit-container").attr({title:J.i18n("writer.common.MARK_AS_FINAL_TOOLTIP",[d()])}),i.find("#txt-marked-final").addClass("ui-top-margin-medium"),i.find("#final-doc-border, #btn-edit-container").show(),i.find("#btn-revert-final").hide()):(i.find("#final-doc-border, #btn-edit-container").hide(),t.hide()),e.FINAL_INFO.STATUS?(UIUtils.toggleElemState(["topband-compose","topband-collaborate","topband-complete"],"disable"),J("#topband-hamburger").disable(),J("#filemenu-pagelayout").disable()):e.FINAL_INFO.hasOwnProperty("STATUS")&&(UIUtils.toggleElemState(["topband-compose","topband-collaborate","topband-complete"],"enable"),J("#topband-hamburger").enable(),J("#filemenu-pagelayout").enable()),CommentModels.commentCollection.each(function(e){e.set("inFocus",!1)})},n=function(e){var t,i,r;e.STATUS!=editor.doc.getDocInfo().FINAL_INFO.STATUS&&editor.doc.docInfo.WRITE_PERMISSION&&(editor.doc.setDocInfo({FINAL_INFO:e}),e.STATUS?editor.zuid==e.zuid?(r=CONST.SEVERITY_SUCCESS,t="writer.common.FINAL_SUCCESS_OWNER_TITLE_MSG",i=J.i18n("writer.common.FINAL_SUCCESS_OWNER_MSG")):(r=CONST.SEVERITY_INFO,t="writer.common.CHECKEDOUTBY_TITLE_MSG",i=J.i18n("writer.common.FINAL_SUCCESS_WMS_MSG",[d()])):(r=CONST.SEVERITY_INFO,t="writer.common.REVERT_FINAL_SUCCESS_TITLE_MSG",i=editor.zuid==e.zuid?J.i18n("writer.common.REVERT_FINAL_SUCCESS_OWNER_MSG"):J.i18n("writer.common.REVERT_FINAL_SUCCESS_WMS_MSG",[d()])),o(),e.STATUS&&(LayoutManager.isRichEditActive()&&LayoutManager.toggleRichEdit(),ModeManager.switchMode(LAYOUTS.COMPLETE)),Notification.hide(),MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,r,J.i18n(t),i))},a=function(){if(o(),editor.isFinalDocument()){var e={},t=editor.doc.getDocInfo(),i={close:!0,setTimer:!1};e.key="writer.common.MARK_AS_FINALE_BANNER",e.args=[d()],i.message=e,("COOWNER"==editor.doc.getRole()&&t.FINAL_INFO.zuid==editor.zuid||editor.zuid==t.CREATOR_ZUID)&&(i.callback=MarkAsFinal.revertFinal,i.btnText="writer.common.ENABLE_EDITING"),Notification.show(i)}},l=function(e){e===LAYOUTS.COMPLETE&&o()},s=function(){var e=editor.doc.getDocInfo(),t=editor.doc.getUserData()||{},i=t[e.FINAL_INFO.zuid];return i},d=function(){var e=s();return c(e.fname)},c=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},p=function(e){if(!U.isEmpty(e)){n(e);var t=editor.doc.getDocInfo();PubSub.publish("Document/SaveStatus",!0,void 0,t.LASTMODIFIEDBY_ZUID,t.LAST_MODIFIED_TIME_LONG)}};window.MarkAsFinal={makeFinal:e,revertFinal:t,checkForEdit:a,wmsMsgHandler:n,updateFinalState:o},PubSub.subscribe("Document/ModeOpened",l),PubSub.subscribe("Document/FinalStateUpdated",p)}(),function(){var e=[],t=!0,i=function(){var e=600,t=900,i=screen.width/2-t/2,o=screen.height/2-e/2,r={left:i,top:o,width:t,height:e,scrollbars:1};Utils.safeWindowOpen(editor.options.wordpressOauthUrl,r)},o=function(t,i){return U.clone(U.find(e,function(e){return e.domain_id==i&&e.tp_user_id==t}))},r=function(t,i){return!!o(t,i)&&(e=U.reject(e,function(e){return e.domain_id==i&&e.tp_user_id==t}),!0)},n=function(){if(!t)return void l();var e=Utils.getContextUrl("v1/web/blogs/wordpress/accounts");J.ajax({url:e,type:"GET",dataType:"json",success:a,error:function(e){l()}})},a=function(i,o,r){t=!1,e=i.accounts||[],l()},l=function(){var t=editor.doc.getRole(),i=J("#wordpress-subpanel");i.find("#wp-tab-container");if("SHAREDREAD"!=t&&"SHAREDREADCOMMENT"!=t&&editor.isEditable()){var o={panelId:ELEM_ID.WORDPRESSPANEL,animationType:ANIMATIONS.FLIPIN,parentPanels:[ELEM_ID.TOOLSPANEL]};LeftPanel.showAdvancedPanel(o)}else LeftPanel.showSubPanel(ELEM_ID.WORDPRESSPANEL,ANIMATIONS.FLIPIN);Utils.addToStatistics("WordPress"),s(),p(),e.length?(i.find("#wp-acc-empty-view, #wp-publish-empty-view").hide(),i.find("#wp-publish-form-view").show()):(i.find("#wp-publish-form-view").hide(),i.find("#wp-acc-empty-view, #wp-publish-empty-view").show());var r=i.find("#wp-post-title"),n=r.val();n||r.val(editor.doc.getDocInfo().DOCUMENT_NAME),r.focus()},s=function(){var t=J.i18n("writer.common.REMOVE"),i=J.i18n("writer.common.REMOVING"),o=J("#wp-acc-container"),r=Handlebars.compile($("#wordpress-acc-list-template").html());o.empty();for(var n=0;n<e.length;n++){var a=U.clone(e[n]);a.removeIconTitle=t,a.removingTxt=i,o.append($.parseHTML(r(a).trim()))}c()},d=function(e){var t=J(e.target).data("url");return t&&Utils.safeWindowOpen(t),!1},c=function(){var e=J("#wp-acc-container");e.find(".js-wp-acc-link-open, .js-wp-acc-remove").off("click"),e.find(".js-wp-acc-link-open").on("click",d),e.find(".js-wp-acc-remove").on("click",h)},p=function(){var t=J("#wordpress-sites"),i=Handlebars.compile($("#wordpress-acc-list-template").html());t.zcombo("removeAllOptions");for(var o=0;o<e.length;o++){var r={},n=document.createElement("option"),a=J("<div>",{class:"ui-combo-opt"});r.html={},r.html.replaceWithText=!0,a.append($.parseHTML(i(e[o]).trim())),r.html.content=a.html(),t.append(n),J(n).attr({data:JSON.stringify(r),value:e[o].tp_user_id+"-"+e[o].domain_id})}t.zcombo("refresh")},u=function(e){var t=function(){var t={},i=J("#wordpress-subpanel"),o="publish"==e.trim(),r=i.find("select#wordpress-sites option:selected").val().split("-");t.isPublish=o,t.title=i.find("#wp-post-title").val().trim()||editor.doc.getDocInfo().DOCUMENT_NAME,t.categories=i.find("#wp-post-categories").val().trim(),t.tp_user_id=r[0],t.domain_id=r[1];var n=J(o?"#btn-wordpress-publish":"#btn-wordpress-draft");J("#btn-wordpress-publish, #btn-wordpress-draft").disable(),n.find("span").text(J.i18n(o?"writer.common.PUBLISHING":"writer.editor.SAVING")),f(t)};UIUtils.showRedactWarningMsg(t)},f=function(e){var t=editor.doc.getDocInfo(),i=Utils.getContextUrl("v1/web/"+t.RID+"/blogs/wordpress/post");Utils.setCsrfParam(e),J.ajax({url:i,data:e,type:"POST",dataType:"json",success:g,error:function(e){Notification.show({message:"writer.common.WORDPRESS_POST_FAILURE",type:"error",close:!0,setTimer:!1}),m()}})},g=function(e,t,i){if(e=e||{},m(),e.STATUS){var o="publish"==e.status,r=J.i18n("writer.common."+(o?"VIEW_POST":"VIEW_DRAFT")),n=J.i18n("writer.common."+(o?"WORDPRESS_POST_SUCCESS":"WORDPRESS_DRAFT_SUCCESS"));MsgDialog.showMessage([r,J.i18n("writer.common.CLOSE")],CONST.SEVERITY_SUCCESS,J.i18n("writer.common.SUCCESS"),n,null,function(t){switch(t){case CONST.BUTTON_1_CLICKED:Utils.safeWindowOpen(e.URL)}})}},m=function(){var e=J("#btn-wordpress-draft"),t=J("#btn-wordpress-publish");e.enable(),t.enable(),e.find("span").text(J.i18n("writer.common.DRAFT")),t.find("span").text(J.i18n("writer.common.PUBLISH"))},h=function(e){var t=J(e.target).data();U.isEmpty(t)||(J("#wp-acc-"+t.tp_user_id+"-"+t.domain_id).find(".ui-wordpress-acc-delete-loading").show(),T(t.tp_user_id,t.domain_id))},T=function(e,t){var i={},o=Utils.getContextUrl("v1/web/blogs/wordpress/accounts/delete");i.domain_id=t,i.tp_user_id=e,Utils.setCsrfParam(i),J.ajax({url:o,data:i,type:"POST",dataType:"json",success:E,error:function(e){s(),Notification.show({message:"writer.common.WORDPRESS_REMOVE_ACC_FAILURE",close:!1,type:"error"})}})},E=function(e,t,i){var o=r(e.tp_user_id,e.domain_id);o&&S(e.tp_user_id,e.domain_id,!1)},R=function(t){switch(t.ACTION){case"LOGIN":if(o(t.accountInfo.tp_user_id,t.accountInfo.domain_id))return;e.push(t.accountInfo);break;case"LOGOUT":var i=r(t.accountInfo.tp_user_id,t.accountInfo.domain_id);if(!i)return}J("#wordpress-subpanel").is(":visible")&&S(t.accountInfo.tp_user_id,t.accountInfo.domain_id,"LOGIN"==t.ACTION)},S=function(t,i,r){if(r){var n=J("#wp-acc-container"),a=Handlebars.compile($("#wordpress-acc-list-template").html()),l=J.parseHTML(a(U.defaults(o(t,i),{removeIconTitle:J.i18n("writer.common.REMOVE"),removingTxt:J.i18n("writer.common.REMOVING")})).trim());Wordpress.updateEmptyView(r),1==e.length?(J("#wp-publish-empty-view").slideUp(350,function(){J("#wp-publish-form-view").slideDown()}),J(l).hide().appendTo(n).delay(350).slideDown(350)):J(l).hide().appendTo(n).slideDown(400),c()}else Wordpress.updateEmptyView(r),e.length||J("#wp-publish-form-view").slideUp(350,function(){J("#wp-publish-empty-view").slideDown()}),J("#wp-acc-"+t+"-"+i).slideUp(350,function(){J(this).remove()});p()},O=function(){1==e.length?J("#wp-acc-empty-view").slideUp(350):0==e.length&&J("#wp-acc-empty-view").delay(350).slideDown()};window.Wordpress={addNewSite:i,wmsMsgHandler:R,deleteAccount:T,showWordpressUI:n,updateEmptyView:O,postToWordpressClicked:u}}();var QuickSearch=function(){"use strict";var e,t,o,r,n,a,l,s={},d={},c={},p={},u={},f={},g={},m={},h=[],T="",E="",R={1:u,2:f,3:g,shape:d,table:c},S=function(){e=m,O(J("#bottombar,#topband-default,#topband-printpreview"),["li","input","button"]),e=u;var t=J("#subpanel-container").children();t.each(function(e){O(J(t[e]),["li","input","button"])}),O(J("#pagelayout-container"),["li","input","button"]),QuickSearch.restrictDuplicated=[],e=f,O(J("#review-tb"),["li","input","button"]),QuickSearch.restrictDuplicated=[],e=g,O(J("#complete-tb"),["li","input","button"]),QuickSearch.restrictDuplicated=[],e=d,O(J("#menuShapes"),["li","button","input"]),QuickSearch.restrictDuplicated=[],e=c,O(J("#subpanel-table"),["li","button","input"]),e=p,O(J("#subpanel-img"),["li","button","input"]),v()},O=function(e,t,i){for(var o=0;o<t.length;o++){var r=e.find(t[o]),n=r.length;if(1==t.length&&!r.length)return!1;for(var a=0;a<n;a++)I(r[a],i)}return!0},v=function(){var e={tags:"writer.quicksearch.TAGS_TRACKCHANGES",label:J.i18n("quicksearch","TRACKCHANGES_ONOFF"),skipshortcutregister:!0,elementId:"review-tb-tcswitch-outer",executeAppdatas:{action:"TrackChangeUI.toggleState"},toolbarName:"",navigateActions:{menuId:"#review-tb",elementId:"review-tb-tcswitch-outer",modeType:2,parentId:""}};e.appData={action:"QuickSearch.executeActions",params:[e]},u[J.i18n("quicksearch","TAGS_TRACKCHANGES")]=e;var t={tags:"writer.quicksearch.TAGS_TRACKCHANGES",label:J.i18n("quicksearch","TAGS_PAUSECOLLAB"),skipshortcutregister:!0,elementId:"review-tb-pausecollab",executeAppdatas:{action:"WebUtil.checkOutDocument"},toolbarName:"",navigateActions:{menuId:"#review-tb",elementId:"review-tb-pausecollab",modeType:2,parentId:""}};t.appData={action:"QuickSearch.executeActions",params:[t]},u[J.i18n("quicksearch","TAG_PAUSECOLLAB")]=t;var i={tags:"writer.quicksearch.TAGS_DOCUMENTTHEMES",label:J.i18n("quicksearch","DOCUMENTTHEMES"),skipshortcutregister:!0,elementId:"fmt-lpnl-designmenubtn",executeAppdatas:{action:"HandleTheme.openDesignDialog"},toolbarName:"",navigateActions:{menuId:"menuFormat",elementId:"fmt-lpnl-designmenubtn",modeType:1,parentId:""}};i.appData={action:"QuickSearch.executeActions",params:[i]},u[J.i18n("quicksearch","TAGS_DOCUMENTTHEMES")]=i;var o={tags:"writer.quicksearch.TAGS_TABLE",label:J.i18n("quicksearch","TABLE"),skipshortcutregister:!0,elementId:"ins-lpnl-table",executeAppdatas:{action:"TableInsertDlg.openTablePopup"},toolbarName:"",navigateActions:{menuId:"menuInsert",elementId:"ins-lpnl-table",modeType:1,parentId:""}};o.appData={action:"QuickSearch.executeActions",params:[o]},u[J.i18n("quicksearch","TAGS_TABLE")]=o;var r={tags:"writer.quicksearch.TAGS_RULER",label:J.i18n("quicksearch","RULER"),skipshortcutregister:!0,elementId:"hruler-container",executeAppdatas:{action:"LeftPanel.toggleLeftPanel"},toolbarName:"",navigateActions:{menuId:"menuFormat",elementId:"hruler-container",modeType:1,parentId:""}};r.appData={action:"QuickSearch.executeActions",params:[r]},u[J.i18n("quicksearch","TAGS_RULER")]=r},b=function(e){if(!e||e.length<1)return!1;var e=e.toLowerCase().trim().replace(" ","").replace("insert ","").replace("add ","").replace("as ","");return QuickSearch.restrictDuplicated.indexOf(e)!=-1||(QuickSearch.restrictDuplicated.push(e),!1)},A=function(e,t){if(E.indexOf("locate")!=-1&&(t=!0),Utils.addToStatistics("qs_"+E),L(),t){var i=JSON.parse(J(e).attr("data"));if(!i)return;y(i),t.preventDefault(),t.stopPropagation()}else{var i=e[0];if(i.executeAppdatas){var o=i.executeAppdatas.action;if(o){var r=i.executeAppdatas.params,n=Utils.getAsFunction(o);n.callable(r)}}else i.elementId&&y(i)}},y=function(e){var t=e.elementId;e.modeType&&ModeManager.switchMode(e.modeType),1==e.modeType&&(LayoutManager.isRichEditActive()||LeftPanel.toggleLeftPanel(),LeftPanel.isContainerVisible(ELEM_ID.MAINPANELCONTAINER)&&LeftPanel.showSubPanel(e.menuId,ANIMATIONS.FADEIN)),e.tabId&&J("a[href="+e.tabId+"]").click(),D(t,e.parentId)},D=function(e,t){J("#helpDiv").css({top:-1e3,left:-1e3});var i=J("#"+e).attr("data")&&JSON.parse(J("#"+e).attr("data")).label||J.i18n("quicksearch","HERE");J("#helpTxt").text(i),QuickSearch.currentElementId=e,setTimeout(function(){t&&J("#"+t).delay(1e3).click();var e=J("#"+QuickSearch.currentElementId),i=0,o=e.offset();0==o.top&&"LABEL"==e.parent()[0].nodeName&&(o=e.parent().offset()),i="LI"==e[0].nodename?o.left+e.find(".ui-zmenu-text").width()/2-J("#helpDiv").width()/2:o.left+e.width()/2-J("#helpDiv").width()/2,i>0&&(J("#helpDiv").css({top:o.top+e.height()+12,left:i}),J("#helpDiv").show(),J("#helpTxt").effect("bounce",500),setTimeout(C,3e3))},1e3)},C=function(){J("#helpDiv").hide(),J.ZContextMenu.hideMenu(),J.ZContextMenu._isMenuShowing=!1},I=function(t,o){try{var r=t.getAttribute("data")?JSON.parse(t.getAttribute("data")):void 0;if(!r||"More"==r.label)return;var n={},a="",l="",s="",d=J(t),c=t.id,p="",u="",f=t.nodeName,g=r.quicksearch;if(g&&g.skipLoading)return;if(r.label&&(s+=r.label),d.attr("title")){var m=d.attr("title");m.indexOf("componentOptions")!=-1&&(m=JSON.parse(m).componentOptions.title),s+=m,r.label||(r.label=m)}if("INPUT"===f&&c){var h=J("label[for="+c+"]");if(h&&h.attr("title")){var m=h.attr("title");m.indexOf("component")!=-1&&(m=JSON.parse(m).componentOptions.title),s+=m,r.label||(r.label=m)}}if(r.componentOptions&&r.componentOptions.label){var T=r.componentOptions.label;s+=T,r.label||(r.label=T)}if(b(r.label))return!0;if(r.icons&&r.icons.primary?r.icon=r.icons.primary+" ui-components-toolbar-icon":r.componentOptions&&r.componentOptions.icon&&(r.icon="ui-icon "+r.componentOptions.icon),r.icon){var E=r.icon.split(" "),R=E[E.length-2];R.indexOf("-lg")!=-1&&delete r.icon}if(r.submenu&&O(J(r.submenu),["li"],d),t.getAttribute("onclick")){var S=t.getAttribute("onclick");if(S=S.replace(/[()]/g," ").trim().split(" "),r.appData={action:S},S.length>0){var v=S[1].replace(/[""]/g,"").split(",");r.appData.params=v}}var A=J(t).parents("div.ui-vertical-sub-nav").attr("id");if(A?(a=A,l=1,A.toLowerCase().indexOf("table")!=-1?u="table":A.toLowerCase().indexOf("shape")!=-1?u="shape":A.toLowerCase().indexOf("digisign")!=-1&&(u="digisign")):d.parents("#complete-tb").length?(a="#complete-tb",l=3):d.parents("#review-tb").length?(a="#review-tb",l=2):d.parents("#topband").length?a="#topband":d.parents("#bottombar").length&&(a="#bottombar"),d.attr("popup")){O(J("#"+d.attr("popup")),["li"]);r.submenu="#"+d.attr("popup")}if(d.parents(".ui-tabs-panel")[0]){var y=d.parents("div.ui-vertical-sub-nav").find("a");for(i=0;i<y.length;i++){var D=J(y[i]).attr("href"),C=J(D).find("#"+c);if(C[0]){n.tabId=D;break}}}if("LI"===f){if(d.attr("popup")&&(r.submenu="#"+d.attr("popup")),o){if(r.appData&&r.appData.shapeObjType)return;p=P(o),c=o.attr("id")}else{p=P(d);var I=J("#"+p),_=J("#"+p).parents("div.ui-vertical-sub-nav").attr("id");_?(a=_,l=1,_.toLowerCase().indexOf("table")!=-1?u="table":_.toLowerCase().indexOf("shape")!=-1?u="shape":_.toLowerCase().indexOf("digisign")!=-1&&(u="digisign")):I.parents("#complete-tb").length?(a="#complete-tb",l=3):I.parents("#review-tb").length?(a="#review-tb",l=2):I.parents("#topband").length?a="#topband":I.parents("#bottombar").length&&(a="#bottombar");}if(!a&&!o){var N=P(d);a=J("#"+N).parents("div.ui-vertical-sub-nav").attr("id"),a&&(l=1)}}r.tags&&(s+=r.tags),!r.label&&r.icon&&(r.label=J("#"+c).text(),s+=r.label),n.menuId=a,n.elementId=c,n.modeType=l,n.parentId=p,r.toolbarName=u,r.elementId=c||"",r.executeAppdatas=r.appData?J.extend({},r.appData):void 0,r.appData={action:"QuickSearch.executeActions",params:[r]},r.navigateActions=n,r.skipshortcutregister=!0,e[s.replace(/[&\/\\#,+()$~%.'":*?<>{} ]/g,"").toLowerCase()]=r}catch(e){}},P=function(e){var t=e.parents("ul"),o=void 0;if(t.length>1){for(i=0;i<t.length;i++)if(!J(t[i]).attr("mtype")&&!J(t[i]).hasClass("ui-icon-borderbox-small")){o=J(t[i]).attr("id");break}}else o=e.parents("ul").attr("id");var r=o&&J("*[popup="+o+"]"),n="";if(r.length>1)for(i=0;i<r.length;i++)try{var a=J(r[i]).attr("data")&&JSON.parse(J(r[i]).attr("data"));if(a&&a.quicksearch&&a.quicksearch.skipLoading)continue;n=J(r[i]);break}catch(e){}else n=r;if(n.length){var l=n.parents("div.ui-vertical-sub-nav").attr("id");return l&&(l.toLowerCase().indexOf("table")!=-1?toolbarName="table":l.toLowerCase().indexOf("shape")!=-1?toolbarName="shape":l.toLowerCase().indexOf("digisign")!=-1&&(toolbarName="digisign")),n.attr("id")}},_=function(){t.focus()},N=function(){Utils.addToStatistics("FeatureFinder");var e=editor.doc.getRole();"OWNER"!=e&&"COOWNER"!=e&&"SHAREDREADWRITE"!=e||(J(".ui-qs-placeholder").hide(),CurUtil.stopBlinking(),PopupHandler.closeAllPopup(),J("#helpDiv").hide(),J(".ui-qs-overlay,#quicksearchcontainer").fadeIn(100),J("input#quicksearchinput").focus(),t.val(""),Utils.addToStatistics("FeatureFinder"))},L=function(){J(".ui-qs-overlay,#quicksearchcontainer").fadeOut(100),J.ZContextMenu.hideMenu(),J.ZContextMenu._isMenuShowing=!1,CurUtil.blinkCursor(),EditorUtil.focusMultiByteSpan()},w=function(){t=J("input#quicksearchinput"),o=J("ul#quicksearchmenu"),o.zmenu(),t[0].addEventListener("keydown",function(e){var i=e.keyCode;if(i==KEYS.ESC)return J.ZContextMenu._isMenuShowing?(M(),t.val("")):(t.val("").focusout(),L()),e.preventDefault(),void e.stopPropagation()},!1),J("div.ui-qs-overlay").bind("click",function(e){L()}),o.bind("click",function(e){Utils.addToStatistics("slsearch"),J("#quicksearchinput").val("")}),t.one("focus",function(){QuickSearch._generateMenus()}).on("focusin",function(t){l=editor.doc.getSelection();var i=l.isTableSelected();r=l.isCollapsed()&&!!J(editor.doc.getCursorPortionNode(editor.uuid,"start")).parents("td:first")[0]||i,n=InsertShape.selectedShape();var o=ModeManager.getCurrentMode();r?o="table":n&&(o="shape"),e=R[o]}).bind("click",function(e){CurUtil.stopBlinking(),e.preventDefault()}).bind("keyup",function(e){var i=e.keyCode;if(i==KEYS.NAV_DOWN)return void J.ZContextMenu.currentMenu.zmenu("hoverNextMenuItem");if(i==KEYS.NAV_UP)return void J.ZContextMenu.currentMenu.zmenu("hoverPreviousMenuItem");if(i==KEYS.SPACE||i==KEYS.ESC)return void e.preventDefault();if(i==KEYS.ENTER)return t.val(""),void(J.ZContextMenu.currentMenu&&J.ZContextMenu.currentMenu.zmenu("handleKeyCode",i,e));var o=t.val().toString().replace(/[&\/\\#,+()$~%.'":*?<>{} ]/g,"").toLowerCase();return o.length<=1?void M():(J(".ui-qs-placeholder").show(),clearTimeout(a),a=setTimeout(function(){B(e)},300),void 0)})},M=function(){clearTimeout(a),J.ZContextMenu.hideMenu(),J.ZContextMenu._isMenuShowing=!1,t.focus(),J(".ui-qs-placeholder").hide()},U=function(e,t){var i=[],o={},r={};return J(e).each(function(i){var n=e[i];if(n){var a=n.label.toLowerCase(),l=a.indexOf(t);l=l!=-1?l:"extra",r[a]=n,l!=-1&&(void 0!=o[l]?o[l].push(a):o[l]=[a])}}),J.each(o,function(e,t){J.each(t,function(e,t){i.push(r[t])})}),i},x=function(){var i=[],o={};return E=t.val().toString().replace(/[&\/\\#,+()$~%.'":*?<>{} ]/g,"").toLowerCase(),E.length<1?i:(QuickSearch.restrictDuplicated=[],i=k(E,i,e),i=k(E,i,m),editor.isFinalDocument()||n||r||(J.extend(o,u),i=k(E,i,o),J.extend(o,f),i=k(E,i,o),J.extend(o,g),i=k(E,i,o)),U(i,E))},F=function(e){var t;if(e.elementId)return t=J("#"+e.elementId).parent("ul")[0]?e.navigateActions&&e.navigateActions.parentId&&J("#"+e.navigateActions.parentId):J("#"+e.elementId),!!t&&(!(!l.isListItemSelection||"menuInsert"!=J(t).parents("div.ui-vertical-sub-nav").attr("id"))||!(!t.attr("disabled")&&!t.hasClass("ui-button-state-disable")&&"disabled"!=e.disabled))},k=function(e,t,i){var o;for(var a in i){var l=a.toLowerCase();if(o=l.indexOf(e),o!=-1){var s=i[a];if(10==t.length)break;if(b(s.label))continue;if(F(s))continue;if(s.toolbarName){var d=s.toolbarName;if(d.indexOf("table")!=-1&&!r||d.indexOf("shape")!=-1&&!n)continue}s.elementId&&(s.html={content:"<div>"+s.label+'</div><div class="ui-locate-button" data='+JSON.stringify(s.navigateActions)+" onclick=QuickSearch.executeActions(this,event);>"+J.i18n("writer.quicksearch.LOCATE")+"</div></div>",replaceWithText:!0}),t.push(s)}}return t},B=function(e){J.ZContextMenu.currentMenu=o;var i=x();i.length>0?(o.empty(),o.css({top:t.offset().top+t.height()+1,left:t.offset().left-1,width:J("input#quicksearchinput").css("width")}).show().zmenu("addMenuItems",i),J.ZContextMenu.currentMenu.zmenu("hoverNextMenuItem"),J.ZContextMenu._isMenuShowing=!0):(clearTimeout(a),t.focus())};return PubSub.subscribe("Document/FirstTimeComponentReady",w),{_generateMenus:S,_constructMenus:I,_createMenu:O,takeMeTo:y,menus:s,restrictDuplicated:h,executeActions:A,showMenu:N,currentElementId:T,focusInput:_,_showNavigator:D,searchCase:E,hideSearchBar:L}}();!function(){var e,t=0,i=[],o=!1,r=!1,n=[{text:"MSG1",leftText:"writer.survey.MSG6",rightText:"writer.survey.MSG7",type:"rating"},{text:"MSG2",leftText:"writer.survey.MSG8",rightText:"writer.survey.MSG9",type:"rating"},{text:"MSG3",leftText:"writer.survey.MSG10",rightText:"writer.survey.MSG11",type:"rating"},{text:"MSG4",leftText:"writer.common.NO",rightText:"writer.common.YES",type:"conformation"}],a={init:function(n){S(),t=0,o=!0,i={},e=n,m(t),r=!1,e.find("input").on("click",p)},get:function(){},set:function(){}},l=function(){P()&&I()&&(J("#menu-survey-open-btn").css("display","table-cell"),C()&&editor.options.ZWSURVEY_AUTO_ENABLE&&d())},s=function(){I()&&d()},d=function(){J.dialogutil.open("zwsurvey","",a)},c=function(){r&&O(),o=!1,J.dialogutil.close("zwsurvey")},p=function(e){i[t]=e.target.value,f()},u=function(e){i[t]=J(e).val(),f()},f=function(){h(++t),R()},g=function(){t<1||(h(--t),R())},m=function(i){var o=n[t];e.find("#survey-question-continer").text(J.i18n("writer.survey."+o.text)),e.find("#survey-rating-left-txt").text(J.i18n(o.leftText)),e.find("#survey-rating-right-txt").text(J.i18n(o.rightText)),e.find(".ui-survey-progress").animate({width:100/n.length+"%"}),R()},h=function(){t<n.length?(e.find("#survey-rating-right-txt, #survey-rating-left-txt, #survey-rating-container, #survey-button-container, #survey-page-back-btn").fadeOut(),e.find("#survey-question-continer").fadeOut(function(){var i=J.i18n(n[t].leftText),o=J.i18n(n[t].rightText);e.find("#survey-question-continer").text(J.i18n("writer.survey."+n[t].text)).fadeIn(),"rating"==n[t].type?(e.find("#survey-rating-container").fadeIn(),e.find("#survey-rating-left-txt").text(i).fadeIn(),e.find("#survey-rating-right-txt").text(o).fadeIn()):(e.find("#survey-button-container").fadeIn(),T("#btn-survey-left-submit",i),T("#btn-survey-right-submit",o)),t>=1&&e.find("#survey-page-back-btn").fadeIn()}),e.find("input").prop("checked",!1),e.find(".ui-survey-progress").animate({width:(t+1)/n.length*100+"%"})):t==n.length?E():c()},T=function(t,i){var o=e.find(t);o.val(i).find(".ui-button-text").text(i)},E=function(){r=!0,e.find(".ui-survey-ques-cont").fadeOut(function(){e.find("#survey-title-hint").text(J.i18n("writer.survey.MSG5")),e.find(".ui-survey-feedback").fadeIn(),e.find("#survey-feedback-message").focus()})},R=function(){e.find("#survey-page-index").text(t+1),e.find("#survey-page-count").text(n.length)},S=function(){var e={},t=function(e,t,i){e.STATUS&&(editor.options.ZWSURVEY_USERDATA.access_time=e.access_time,editor.options.ZWSURVEY_USERDATA.system_time=e.system_time)};Utils.setCsrfParam(e),v({params:e,successHandler:t})},O=function(){var t={},o=e.find("#btn-survey-submit");o.disable(),o.button("option","label",J.i18n("writer.common.SENDING")),t.id=editor.options.ZWSURVEY_ID,t.survey_data=JSON.stringify(i),t.feedback=e.find("#survey-feedback-message").val().substring(0,2500),t.rating_html=D(t),Utils.setCsrfParam(t),r=!1,v({params:t,successHandler:b,errorHandler:A})},v=function(e){J.ajax({async:!0,type:"POST",data:e.params,dataType:"json",url:Utils.getNiceUrlPrefix("survey"),success:e.successHandler||function(){},error:e.errorHandler||function(){}})},b=function(e,t,i){e.STATUS&&(editor.options.ZWSURVEY_USERDATA.id=e.id,editor.options.ZWSURVEY_USERDATA.access_time=e.access_time,editor.options.ZWSURVEY_USERDATA.system_time=e.system_time,ZWSurvey.showThanksMsg())},A=function(e,t,i){ZWSurvey.closeDialog()},y=function(){o&&(e.find("#survey-feedback-container").slideUp(),e.find("#survey-title").text(J.i18n("writer.survey.THANKS")),e.find("#survey-title-hint").addClass("ui-bottom-margin-large").text(J.i18n("writer.survey.THANKS_MESSAGE")),setTimeout(c,2e3))},D=function(e){for(var t,o={},r=[],a=editor.doc.getDocInfo(),l=Handlebars.compile(J("#survey-mail-template").html()),s=0,d=n.length;s<d;s++)t={},t.key=J.i18n("writer.survey."+n[s].text),t.value=i[s],r.push(t);return o.id=e.id,o.rid=a.RID,o.feedback=e.feedback,o.role=editor.doc.getRole(),o.surveyDataArray=r,l(o).trim()},C=function(){var e=editor.options.ZWSURVEY_USERDATA,t=e.system_time-e.access_time;return!!(I()&&P()&&e.id<editor.options.ZWSURVEY_ID&&t>864e5)},I=function(){var e=["OWNER","COOWNER","SHAREDREAD","SHAREDREADWRITE","EXTERNAL_SHAREDREADWRITE","STOREAGE_SERVICE_WRITER","SHAREDREADCOMMENT","MAC_APP","WORKSPACE_CRMLIB_READER","WORKSPACE_CRMLIB_EDITOR"];return U.contains(e,editor.doc.getRole())},P=function(){return!!editor.options.ZWSURVEY_ORGIDS&&U.contains(editor.options.ZWSURVEY_ORGIDS.split(","),editor.zoid+"")};window.ZWSurvey={closeDialog:c,showThanksMsg:y,sendSurveyData:O,showNextOptions:f,checkForShowSurvey:C,openDialogFromMenu:s,showPreviousOptions:g,buttonClickHanlder:u},PubSub.subscribe("Document/FirstTimeComponentReady",l)}(),function(){var e="docx",t={init:function(){$("<iframe>",{id:"cloudUploadIframe",src:n(),frameborder:"0",width:"100%",height:"82%"}).appendTo("#cloudUploadIframeContainer")}},i=function(i){e=i,J.dialogutil.open("cloudupload","",t)},o=function(){J.dialogutil.close("cloudupload")},r=function(){var e=editor.cloudUploadServices,t=e.split(","),i=w_usersettings.cloudupload_recent;if("STOREAGE_SERVICE_WRITER"!=editor.doc.getRole()){var o=t.indexOf("zohodocs");o!=-1&&t.splice(o,1)}var r=t.indexOf(i);return r!=-1&&(t.splice(r,1),t.unshift(i)),t},n=function(){var t;return t="//"+editorProps.urls.gadgetServerURL+"/CloudUploader?zservice=writer",t+="&sources="+r(),t+="&fileName="+a(),t+="&customCss="+jsStaticURL+"styles/cloudupload.css",t+="&serURL="+editorProps.urls.base_url+"/v1/web/cloudupload/format/"+e+"/callback"},a=function(){var e=editor.doc.getDocInfo().DOCUMENT_NAME;e=e.replace(/[\*\:\/\\\|\"\']/g,"_");var t=encodeURIComponent(e);return t},l=function(e){o(),UIUtils.showMessage("info",J.i18n("writer.image.UPLOADING_MSG"),!1,"normalfont");var t={};t.fileName=e.fileName,t.folderId=e.folderId,t.source=e.source,"dropbox"===e.source&&e.accountId&&(t.accountId=e.accountId),Utils.setCsrfParam(t),w_usersettings.cloudupload_recent=e.source,J.ajax({type:"POST",global:!1,url:Utils.getNiceUrlPrefix("cloudupload")+"/"+editor.doc.getDocInfo().RID+"/format/"+e.format+"/upload",data:t,async:!0,success:function(e){UIUtils.hideMessage(),"SUCCESS"===e.STATUS?UIUtils.showMessage("info",J.i18n("writer.cloudupload.DOCUMENT_UPLOAD_SUCCESS_MESSAGE"),"showclose","normalfont",5e3):UIUtils.showMessage("error",J.i18n("writer.cloudupload.DOCUMENT_UPLOAD_FAILED_MESSAGE"),"showclose","normalfont",5e3)},error:function(e,t,i){UIUtils.showMessage("error",J.i18n("writer.cloudupload.DOCUMENT_UPLOAD_FAILED_MESSAGE"),"showclose","normalfont",5e3)}})};window.cloudUpload={uploadDocToCloud:l,openCloudUploadDialog:i,closeCloudUploadDialog:o}}(),function(){var e=function(){var e=J("#zwGShareIframe")[0];void 0==e&&(e=document.createElement("iframe"),e.id="zwGShareIframe",document.body.appendChild(e))},t=function(){e(),J("#zwGShareIframe").attr("src",o())},i=function(){J("#zwGShareIframe").remove(),EditorUtil.focusMultiByteSpan()},o=function(){var e;return e="//"+editorProps.urls.gadgetServerURL+"/driveshare?zservice=writer",e+="&docId="+encodeURIComponent('["'+editor.doc.docInfo.GDRIVE_DOCUMENT_ID+'"]'),e+="&serURL="+editorProps.urls.base_url+"/v1/web/gdriveshare/"+editor.doc.getDocInfo().RID+"/callback"};window.gdriveShare={openDialog:t,closeDialog:i}}(),HTMLUtil=function(){"use strict";var e={},t={},i=" ",o=new RegExp("^("+CONT_REGEXP.AUTOFIELD+")$"),r=new RegExp("^("+NODE_TYPE.RUN+"|"+NODE_TYPE.FIELD_START+"|"+NODE_TYPE.FIELD_END+"|"+NODE_TYPE.IMAGE+")$"),n=["a","abbr","acronym","b","bdo","big","br","cite","code","dfn","em","i","input","kbd","label","q","samp","select","small","span","strong","sub","sup","textarea","tt","var","#text","img","map","object","font","aside","comment"],a=["table","hr","p","div","center","li","ol","ul","blockquote","h1","h2","h3","h4","h5","h6","address","pre","dl","td","th","tr"],l=function(e,t){for(var o=editor.doc.getContent(e,t),r=o.length,n="",a=0;a<r;a++){var l=o.substr(a,1);l=Utils.encodeHTMLChars(l),n+=l}var s=/(\s)+$/g,d=s.exec(o);if(d){var c=d[0].length;for(o=o.substring(0,d.index);c>0;)o+=i,c--}return o},s=function(e){var t=e&&e.match(o)||[];return t[0]},d=function(e){var i,o,r=e.parent,n=r.getIndex(),a=n+e.start,d=n+e.end,c=editor.doc.getComputedFormatAt(a,NODE_TYPE.TEXT),u=c.type;switch(u){case NODE_TYPE.TEXT:var f={cls:null,cont:null,attr:null},g=l(a,d),m=DocUtil.getComputedTextFormat(a);if(c.st&&"tab"==c.st){var h={leader:c.leader,class:"Apple-tab-span",st:NODE_TYPE.TAB,type:NODE_TYPE.TEXT};f.cont="\t",f.attr={"data-text-info":JSON.stringify(h)}}else if(!c.cls||"footnote"!=c.cls&&"endnote"!=c.cls)if(c.cls&&(c.cls.indexOf(CONST.MERGEFIELD)!=-1||c.cls.indexOf(CONST.NEXTRECORD))!=-1){if(f.cont=g,i={class:c.cls},c.cls.indexOf(CONST.NEXTRECORD)!=-1||c.cls.indexOf(CONST.MERGEFIELD)!=-1){var T="nextrecord"==c.cls||"mergeField"==c.cls?"mergeField":"";f.attr={"data-mergefield-info":t[T],"data-text-info":JSON.stringify(i)}}}else if(c.cls&&s(c.cls)){var E,R=c.fieldinfo,S=s(c.cls);if("autopcnt"===S)E=ViewManager.getPageCount();else if("autopno"===S){var O=ViewManager.getViews(r)[0];E=O&&O.page?O.page.pageNumber:1}else E=r.paraProperties.fields[R];f.cont=E,i={class:S},f.attr={"data-autofield-info":t[c.fieldinfo],"data-text-info":JSON.stringify(i)}}else t&&"comment"==c.type?(i={class:"comment-node"},f.cont=g,f.attr={"data-comment-info":t[c.type],"data-text-info":JSON.stringify(i)}):f.cont=g;else;o=DomUtil.createSpan(m),o.removeAttribute("class"),o.textContent=f.cont,f.attr&&J(o).attr(f.attr),c.st&&"tab"==c.st&&J(o).css({"white-space":"pre"}),e.parent.isCode()&&o.setAttribute("data-format-attr",JSON.stringify(Object.keys(m)));break;case"iframe":o=DomUtil.createIframe(c);break;case"image":if(delete c[ATTR_IMAGE.I_ID],o=DomUtil.createImage(c),c.src&&(0===c.src.indexOf("image.do")||0===c.src.indexOf("remoteImage.do"))){var v=p(c.src);o.src=v}if(c.hasOwnProperty(ATTR_WIDGET.SERVICE)&&"YOUTUBE"==c[ATTR_WIDGET.SERVICE]&&J(o).attr("data-video-data",JSON.stringify(c)).addClass("zw-video-image"),c.hasOwnProperty(ATTR_IMAGE.I_SHAPEDATA)){J(o).attr({"data-shapedata":JSON.stringify(c[ATTR_IMAGE.I_SHAPEDATA])}).addClass("zw-shape-image");var b=J("#"+c.shapeData.nvOProps.nvDProps.id).find("svg")[0],A=(new XMLSerializer).serializeToString(b),y=window.btoa(A);o.src="data:image/svg+xml;base64,"+y,o.style.width=c.shapeData.props.transform.dim.width+"px",o.style.height=c.shapeData.props.transform.dim.height+"px"}c.hasOwnProperty("mminfo")&&J(o).attr("data-mminfo",JSON.stringify(c)).addClass("zw-mminfo-image");break;case NODE_TYPE.BR:o=DomUtil.createBR();break;case"mergeField":editor.doc.getCharAt(a)==UNICODE.RANGE_START?t[c.type]=JSON.stringify(c):t={};break;case"comment":o=document.createElement("span");var D=editor.doc.getCharAt(a);J(o).attr({"data-range-char-type":D===UNICODE.RANGE_START?"start":"end","data-comment-info":JSON.stringify(c)}),o.innerHTML="&nbsp;";break;case"autofield":editor.doc.getCharAt(a)==UNICODE.RANGE_START?t[c.id]=JSON.stringify(c):t={};break;case NODE_TYPE.LINK:if(editor.doc.getCharAt(a)==UNICODE.RANGE_START){var o=document.createElement("a"),C=c.lnktype==LINK_TYPES.BOOKMARK?location.href+"#bookmark="+c.url:c.url;o.setAttribute("href",C)}break;case NODE_TYPE.FOOTNOTE:case NODE_TYPE.ENDNOTE:case NODE_TYPE.WIDGET:o=DomUtil.createWidget(c)}return o},c=function(e){var t=(e.segments,e.getEndIndex()),i=editor.doc.getComputedFormatAt(t,NODE_TYPE.PARAGRAPH),o=i[ATTR_PARAGRAPH.PS_HD]||0,r="p",n={},a=DocUtil.isList(i);a&&(r="li"),o&&o>0&&o<7&&(r="h"+o);var l,s=document.createElement(r),l={margin:"0px"};if(o&&(n["data-hd-info"]=o),i.hasOwnProperty(ATTR_PARAGRAPH.LS_DATA)){delete i[ATTR_PARAGRAPH.PS_ML],delete i[ATTR_PARAGRAPH.PS_TI];var d=i[ATTR_PARAGRAPH.LS_DATA];n["data-list-info"]=JSON.stringify(d),o<=9&&d&&d.id==editor.doc.getHeadingListId()&&(n["data-hlist-type"]=editor.doc.bodyFormat.listFormat[0].level0.htype)}if(DomUtil.setStyle(s,l),i.hasOwnProperty(ATTR_PARAGRAPH.PS_TPS)&&(n["data-tab-info"]=JSON.stringify(i[ATTR_PARAGRAPH.PS_TPS])),i[ATTR_PARAGRAPH.EN_BL]&&(n["data-keep-line-info"]="true"),i[ATTR_PARAGRAPH.EN_PB]&&(n["data-page-break-info"]="true"),i[ATTR_PARAGRAPH.EN_WO]&&(n["data-window-control-info"]="true"),i[ATTR_PARAGRAPH.PS_TS]&&(n.data_styles=JSON.stringify(i[ATTR_PARAGRAPH.PS_TS])),i[ATTR_PARAGRAPH.PS_CODE]){var c=i[ATTR_PARAGRAPH.PS_CODE];n["data-codeformat"]=JSON.stringify(c),J(s).attr(n)}else J(s).attr(n),DomUtil.setParaStyle(s,i,null,!0);var p=document.createElement("span");return J(p).addClass("EOP"),p.innerHTML="&nbsp;",s.appendChild(p),s.setAttribute("class","zw-paragraph"),s},p=function(e){var t=document.createElement("img");t.src=Utils.getContextUrl(e);var i=document.getElementById("copyImage");i.width=t.naturalWidth,i.height=t.naturalHeight;var o=i.getContext("2d");return o.drawImage(t,0,0),i.toDataURL("image/png")},u=function(e){var t,i={},o=e.getFormat(),r=document.createElement("table"),n=e.getIndex(),a=editor.doc.getThemeStyleFormatAt(n);t=a[ATTR_TABLE.TBLS_BGIMG],!t||t.indexOf("image.do")==-1&&t.indexOf("remoteImage.do")==-1||(t=p(t)),i={backgroundColor:a[ATTR_TABLE.TBLS_TBL_BGC],width:a[ATTR_TABLE.TBLS_WID]};var l=a[ATTR_TABLE.TBLS_WID];return J(r).attr({"data-theme":JSON.stringify(a[ATTR_TABLE.TBLS_THEME]),"data-cols":JSON.stringify(a.cols),"data-width":l}).addClass("zw-table"),t&&extend(i,{backgroundImage:"url("+t+")"}),J(r).css(i),r.setAttribute("data-format-attr",JSON.stringify(Object.keys(o))),r},f=function(e){var t=document.createElement("tr"),i=e.getIndex();editor.doc.getThemeStyleFormatAt(i);return t},g=function(e){var t,i=e.getIndex(),o=e.getFormat(),r=e.getMatrixPosition()[1],n=editor.doc.getThemeStyleFormatAt(i);n=DocUtil.copyStyle(n),DocUtil.constructRenderingFormat(n);var a=DomUtil.createTD(n);if(n[ATTR_CELL.TDS_BGIMG]&&(n[ATTR_CELL.TDS_BGIMG].indexOf("image.do")!=-1||n[ATTR_CELL.TDS_BGIMG].indexOf("remoteImage.do")!=-1)){var l=p(n[ATTR_CELL.TDS_BGIMG]),s={backgroundImage:"url("+l+")"};J(a).css(s)}var d=T(e,NODE_TYPE.CELL),c=d.parentNode(),u=(c.parentNode(),TableUtil.findColIdx(d),TableUtil.findRowIdx(c),BorderUtils.getTdBdrDomStyle(d)),f={};for(key in u){var g=u[key];f[key]=g}return f&&J(a).css(f).addClass("zw-td"),J(a).css(f).addClass("zw-td"),n[ATTR_CELL.TDS_MRG]&&"fc"!=n[ATTR_CELL.TDS_MRG]&&J(a).hide(),t={"data-format-attr":JSON.stringify(Object.keys(o)),"col-index":r},J(a).attr(t),a.setAttribute("data-format-attr",JSON.stringify(Object.keys(o))),a},m=function(e,t,i,o){var r;null==i&&(i=-1,o=null!=o?o:0,r=JSON.stringify(editor.doc.getListObj(t)));var n,a,l=i;do{l++;var s=document.createElement(e?"ol":"ul"),d=editor.doc.getListType(t,l);s.style.listStyle=List.getHTMLListType(d),n?n.appendChild(s):a=s,n=s}while(l<o);return r&&J(a).attr({"data-list-format":r,"data-list-id":t}),a},h=function(e){var t=DomUtil.createHR();return DomUtil.setHRStyle(t,editor.doc.getRawFormatAt(e.getEndIndex())),t},T=function(e,t){var i=editor.doc.createElement(t,e);return i.setStart(e.getIndex()),i.setEnd(e.getEndIndex()),i},E=function(e){var t,i,o,n,a,l=document.createDocumentFragment(),s=[],p=function(e,t){var i;return i="para"==t||"hr"==t?editor.doc.getRawFormatAt(e.getEndIndex()):editor.doc.getComputedFormatAt(e.getIndex(),NODE_TYPE.TEXT),!TcUtil.canCopy(i)},T=function(e){var l=e.type;if(!p(e,l)){switch(l){case NODE_TYPE.PARA:t=c(e),i=e.paraProperties.listData;break;case NODE_TYPE.TABLE:t=u(e);break;case NODE_TYPE.ROW:t=f(e);break;case NODE_TYPE.CELL:t=g(e);break;case NODE_TYPE.HR:t=h(e);break;case NODE_TYPE.FIELD_START:case NODE_TYPE.FIELD_END:case NODE_TYPE.IMAGE:case NODE_TYPE.RUN:t=d(e)}if(!t)return void(e.format&&e.format.type&&e.format.type==NODE_TYPE.LINK&&s.pop());var T=E();if("para"!=l||U.isEmpty(i)||e.paraProperties.isHeading)if("para"==l&&e.paraProperties.isCode){var R,S,O=e.getEndIndex(),v=a,b="pre",A=n,y=editor.doc.getRawFormatAt(O);v&&v[ATTR_PARAGRAPH.PS_CODE]&&Utils.compareJSON(v[ATTR_PARAGRAPH.PS_CODE],y[ATTR_PARAGRAPH.PS_CODE])?J(t).insertAfter(A):(R=document.createElement(b),DomUtil.setParaStyle(R,y,null,!0),R.hasAttribute("data-codeformat")&&J(R).removeAttr("data-codeformat"),S=y[ATTR_PARAGRAPH.PS_CODE].t_fgc&&{color:y[ATTR_PARAGRAPH.PS_CODE].t_fgc},S&&J(R).css(S),R.appendChild(t),T.appendChild(R))}else T.appendChild(t);else{var D=editor.doc.getListType(i.id,i.listLevel),C=!(D>5&&D<9),I=i.listLevel,P="level"+I,_=e.paraProperties.listData.levelInfo[P];if(o&&"para"==o.type&&o.paraProperties.listData&&o.paraProperties.listData.id==i.id){if(o.paraProperties.listData&&o.paraProperties.listData.id==i.id){var N=o.paraProperties.listData,L=N.listLevel,w=n;if(I==L)J(t).insertAfter(w);else if(I<L){var M=J(w).parents()[L-I];M.appendChild(t)}else if(I>L){var x=m(C,i.id,L,I),F=I-L,M=x;F>1&&(M=J(x).find(C?"ol":"ul")[F-2]),1!=_&&M.setAttribute("start",e.paraProperties.listData.levelInfo[P]),M.appendChild(t),J(x).insertAfter(w)}}}else{var x=m(C,i.id,null,I),M=x;0!=I&&(M=J(x).find(C?"ol":"ul")[I-1]),1!=_&&M.setAttribute("start",e.paraProperties.listData.levelInfo[P]),M.appendChild(t),T.appendChild(x)}}r.test(l)&&Utils.nodeNameEquals(T,"li|p|h1|h2|h3|h4|h5|h6")&&J(T).find("span.EOP").remove(),r.test(l)?Utils.nodeNameEquals(t,"a")&&s.push(t):(s.push(t),o=e,a=y)}},E=function(){var e=l,t=s.length;return t&&(e=s[t-1]),e},R=function(e){var t=e.type;p(e,t)||r.test(t)||(n=s.pop(),o=e)},S={nodeStartHandler:T,nodeEndHandler:R};e.visitAllNodesInRange(S);var O=document.createElement("div");return O.appendChild(l),J(O.firstChild).attr("data-doc-rid",editor.doc.docInfo.RID),O.innerHTML},R=function(e){if(n.indexOf(e.nodeName.toLowerCase())!=-1)return"inline";if(a.indexOf(e.nodeName.toLowerCase())!=-1)return"block";var t="inline";try{var i=document.createElement(e.nodeName.toLowerCase()),o="getComputedStyle"in window;document.body.appendChild(i),t=(o?window.getComputedStyle(i,""):i.currentStyle).display,document.body.removeChild(i)}catch(e){}return t.toLowerCase()},S=function(e){var t,i,o=UIUtils.dataURItoBlob(e),r=editor.doc.getDocInfo(),n=editor.uuid.replace(/[\/\\_\-%]/gi,""),a=n+Utils.randomString(),l=new FormData;l.append("imagecontent",o.imageFile),l.append("sid",editor.uuid),l.append("imgid",a),"REMOTE"==editor.getEditorType()?(i="d-"+r.DOCUMENT_ID+"-"+a,l.append("docId",r.DOCUMENT_ID),l.append("rsid",RemoteEditor.rsid),t="remoteImage.do?imgurl="+i):(i="r-"+r.RID+"-"+a,l.append("rid",r.RID),t="image.do?imgurl="+i),l.append("imageURLValue",i),l.append(csrfParamName,getcsrf());var s=Utils.getUrl("copyImageFile");return J.ajax({type:"POST",dataType:"json",url:s,data:l,enctype:"multipart/form-data; "+o.type,contentType:!1,processData:!1,success:function(e){"success"==e.validation?DomUtil.updateImageSrc(t):UIUtils.showImageFailedMsg()},error:function(e,t,i){UIUtils.showImageFailedMsg()}}),t},O=function(e){return"block"==R(e)},v=function(e){return"inline"==R(e)};return{getParagraph:c,getTable:u,getCell:g,getHTML:E,isBlockElement:O,isInlineElement:v,storeImageInFileStore:S}}(),PastePreProcess=function(){"use strict";var e=[],t=!1,i={"alpha-lower":LIST_TYPE.LOWER_ALPHA,"alpha-upper":LIST_TYPE.UPPER_ALPHA,"roman-lower":LIST_TYPE.LOWER_ROMAN,"roman-upper":LIST_TYPE.UPPER_ROMAN,bullet:LIST_TYPE.DISC},o=["#text","br","hr","img","iframe"],r=function(e){var t,i=e.getAttribute("data-list-format");if(i)t=JSON.parse(i);else{var o=PasteUtil.getListType(e),r=e.getAttribute("start"),t=DocUtil.copyStyle(LIST_STYLE_OBJECT[o]),n=J(e).find("ol,ul");t.level0.startsWith=r?parseInt(r):1;for(var a=1;a<=8;a++){var l,s=n[a-1];if(void 0==s)break;l=s.getAttribute("start"),t["level"+a].type=PasteUtil.getListType(s),t["level"+a].startsWith=l?parseInt(l):1}}return t},n=function(e){var t=e.trim().charCodeAt(0),i=LIST_TYPE.DECIMAL;return 183==t?i=LIST_TYPE.DISC:111==t?i=LIST_TYPE.CIRCLE:167==t?i=LIST_TYPE.BOX:t>=48&&t<=57?i=LIST_TYPE.DECIMAL:t>=97&&t<=122?i=LIST_TYPE.LOWER_ALPHA:t>=65&&t<=90&&(i=LIST_TYPE.UPPER_ALPHA),i},a=function(){for(var e,t={},o=frames.pasteFrame,r=J(o.document).find("style"),n=0,a=r.length;n<a&&(e=r[n],e.innerText.indexOf("List Definitions")==-1);n++);for(var l=e.innerText.replace(/\s+/g," "),s=/@list\s+l[0-9]+:level[0-9]\s+{+/g,d=s.exec(l);null!=d;){var c=l.indexOf("}",d.index),p=l.substr(d.index,c-d.index+"}".length),u=p.match(/l(\d+?):/)[1],f=p.match(/level(.+?)\s+/)[1],g=p.match(/{(.+?)}+/)[1];g=g.replace(/\s+/g,"");for(var m=/(.+?):(.+?);/g,h=m.exec(g),T={},E={type:LIST_TYPE.DECIMAL,startsWith:1,c:ListLevelNo[f-1]+"."};null!=h;)T[h[1]]=h[2],h=m.exec(g);if(T.hasOwnProperty("mso-level-start-at")&&(E.startsWith=parseInt(T["mso-level-start-at"])),T.hasOwnProperty("mso-level-number-format")&&(E.type=i[T["mso-level-number-format"]]),T.hasOwnProperty("mso-level-text")&&E.type<=5){var R=T["mso-level-text"],S=/(%\d+?)/g,O=S.exec(R),v=parseInt(O[1].substr(1))-1;R=R.replace(/\"/g,""),R=R.replace(/\\/g,""),R=R.replace(S,ListLevelNo[v]),E.c=R}t[u]||(t[u]={}),t[u]["level"+f]=E,d=s.exec(l)}return t},l=function(e,t,i){a();for(var o={},r=J(e).find("p"),l=/mso-list:\s*l\d+\s+level\d+\s+lfo\d+/g,o={},s=t.listFormatJSON,d=0,c=r.length;d<c;d++){var p=r[d],u=p.getAttribute("style");if(u){var f=u.match(l);if(f){for(var g,m=f[0],h=m.match(/level(.+?)\s+/)[1],T=m.match(/l(\d+?)\s+/)[1],E=!1,R=Array.from(p.childNodes),S=0,O=R.length;S<O;){if(!E&&8!=R[S].nodeType){var v=R[S].textContent,g=n(v);E=!0}if(R[S].parentNode.removeChild(R[S]),R[S].textContent.indexOf("endif")!=-1)break;S++}o.hasOwnProperty(T)||(o[T]=i,s[i]=g,i++),J(p).attr({"data-list-info":JSON.stringify({id:o[T],l:parseInt(h)-1}),class:"ms-list"})}}}return t},s=function(e){for(var t={},i={},o=J(e).find("ol,ul"),n=o.length,a=[],s=0;s<n;s++){var d=o[s];Utils.nodeNameEquals(d.parentNode,"ol|ul")||a.push(d)}var c=editor.doc.getNewListId();n=a.length;for(var s=0;s<n;s++){var d=a[s],p=J(d).attr("data-list-id");p&&J(d).find("li").attr("data-continue-list-id",p),J(d).attr("data-list-id",c),J(d).find("ol,ul").attr("data-list-id",c),i[c]=r(d),c++}var u=J(e).find("[data-hlist-type]");if(u.length&&"undefined"==typeof editor.doc.getHeadingListId()){var f=parseInt(J(u[0]).attr("data-hlist-type"));i[0]=HLIST_TYPE[f];var g=DocUtil.updateStylesForHeadingList(f,0);t.paraStyles=g}t.listFormatJSON=i;var m=Paste.getPasteInfo(),h=Boolean(m.HTML&&m.HTML.match(/mso-list:\s*l\d+\s+level\d+\s+lfo\d+/));return h&&l(e,t,c),t},d=function(e){for(var t=J(e).find("li"),i=t.length,o=0;o<i;o++){var r=t[o];if(!Utils.nodeNameEquals(r.parentNode,"ol|ul")){var n=document.createElement("p"),a=r.children;J(a).appendTo(n),J(n).insertAfter(r),r.parentNode.removeChild(r)}}},c=function(e){for(var t=J(e).find("a"),i=0,o=t.length;i<o;i++){var r=t[i];r.setAttribute("id",Utils.randomString())}},p=function(e,t){for(var i=0,o=function(e){return 1==e.hasAttribute("colspan")},r=TableUtil.findNodesInTable(e,"tr"),n=r.length,a=0;a<n;a++){var l=r[a],s=TableUtil.findNodesInTable(l,"td,th");if(0!=s.length){var d=U.filter(s,o);if(0==d.length){i=a;break}}}var c=TableUtil.findNodesInTable(r[i],"td,th"),p=[],u=J(e).width();return U.each(c,function(e,i){var r=o(e),n=1;r&&(n=parseInt(e.getAttribute("colspan")));var a=J(e).innerWidth();a=t?(a/u/n*100).toFixed(2)+"%":Conversions.toGlobalValue(a/n+UNITS.PIXELS);for(var l=0;l<n;l++)p.push({wt:a})}),p},u=function(e){var t=e.childNodes,i=t.length;if(!i)return void e.appendChild(T("p").appendChild(document.createElement("br")));for(var o=0;o<i;o++){var r=t[o];if(HTMLUtil.isInlineElement(r)){for(var n=document.createElement("p");e.firstChild;)n.appendChild(e.firstChild);e.appendChild(n);break}}},f=function(e){for(var t=TableUtil.findNodesInTable(e,"tr"),i=t.length,o=g(e),r=0;r<i;r++){var n=t[r],a=TableUtil.findNodesInTable(t[r],"td,th"),l=a.length;0==l&&n.parentNode.removeChild(n);for(var s=0;s<l;s++){var d=a[s],c=J(d),p=s==l-1,f=c.attr("colspan"),m={};if(f>1){for(var h=0;h<f-1;h++){var E=T("td"),R=J(E),S=T("p");S.appendChild(document.createElement("br")),E.appendChild(S),R.attr({merge:"hmp"}).css("display","none"),c.after(E)}m.merge="fc"}var O=c.attr("rowspan");if(O>1){for(var v=r+parseInt(O),h=r+1;h<v;h++){var b=TableUtil.findNodesInTable(t[h],"td,th");f=f?f:1;for(var A=0;A<f;A++){var E=T("td"),R=J(E),y={},S=T("p");S.appendChild(document.createElement("br")),E.appendChild(S),0==A?y.merge="vmp":y.merge="hmp",R.attr(y).css("display","none"),b[s]?J(b[s]).before(E):J(t[h]).append(E)}}m.merge="fc"}u(d),c.attr(m)}if(p)for(var D=t[r].cells.length;D<o;){var C=T("td"),S=T("p");S.appendChild(document.createElement("br")),C.appendChild(S),n.appendChild(C),D++}}},g=function(e){for(var t=0,i=TableUtil.findNodesInTable(e,"tr"),o=i.length,r=0;r<o;r++){for(var n=0,a=i[r].childNodes,l=0,s=a.length;l<s;l++){var d=a[l];Utils.nodeNameEquals(d,"td|th")&&(n+=parseInt(J(d).attr("colspan"))||1)}t=Math.max(t,n)}return t},m=function(e){for(var t=function(e){var t=e.parentNode;if(Utils.nodeNameEquals(t,"body")){var i=e.nextSibling;if(i&&Utils.nodeNameEquals(i,"table")){var o=T("p");J(e).after(o)}}else if(Utils.nodeNameEquals(t,"td|th")){var i=e.nextSibling;if(!i||i&&Utils.nodeNameEquals(i,"table")){var o=T("p");J(e).after(o)}}},i=function(e){var t=e.parentNode;if(Utils.nodeNameEquals(t,"body")){var i=e.previousSibling;if(!i){var o=T("p");J(o).attr("data-para-info",JSON.stringify(r)),J(e).before(o)}}else if(Utils.nodeNameEquals(t,"td|th")){var i=e.previousSibling;if(!i){var o=T("p");J(e).before(o)}}},o=editor.doc.getSelection().parents(NODE_TYPE.PARAGRAPH),r=o.attr("*"),n=J(e).find("table"),a=0,l=n.length;a<l;a++)t(n[a]);for(var a=0,l=n.length;a<l;a++)i(n[a])},h=function(e){for(var t=J(e).find("table"),i={},o=t.length,r=function(e){J(e);if(e.setAttribute("id","tb-"+Utils.randomString(4)),e.hasAttribute("data-cols")){var t,o,r,n,a=[],l=0,s=J(e).find("tr"),d=JSON.parse(e.getAttribute("data-cols"));t=J(s[0]).find("td","th"),n=d[t[0].getAttribute("col-index")],r=n.wt.indexOf("mm")!=-1?"mm":"in";for(var c=0,u=t.length;c<u;c++){var g,m=t[c],h=m.getAttribute("col-index");g=d[h],a.push(g),l+=parseFloat(g.wt)}return l=l.toFixed(2)+r,o={"data-width":l,"data-cols":JSON.stringify(a)},void J(e).attr(o)}var T=TableUtil.findNodesInTable(e,"caption");J(T).remove();var E=!1,R=J(e).innerWidth(),S=TableUtil.getMaxTableWidth(editor.doc.getSelection().getStart()).convertor().pixels;R>S?(E=!0,i["data-width"]="100%"):i["data-width"]=(R+"px").convertor().inches+"in",f(e);var O=p(e,E);i["data-cols"]=JSON.stringify(O),J(e).attr(i)},n=0;n<o;n++){var a=t[n];r(a)}},T=function(e){var t=document.createElement(e);if("p"===e)J(t).attr("data-para-info",JSON.stringify({type:NODE_TYPE.PARAGRAPH}));else if("tr"===e){t.setAttribute("id","rw-"+Utils.randomString(4));var i=document.createElement("td");i.setAttribute("id","cl-"+Utils.randomString(4)),t.appendChild(i)}else"td"===e?t.setAttribute("id","cl-"+Utils.randomString(4)):"table"===e&&t.setAttribute("id","tb-"+Utils.randomString(4));return t},E=function(e){for(var t=J(e).find("td,th"),i=t.length,o=0;o<i;o++){var r=t[o];if(r.setAttribute("id","cl-"+Utils.randomString(4)),!Utils.nodeNameEquals(r.parentNode,"tr")){var n=T("table"),a=T("tr");n.appendChild(a),J(n).insertAfter(r),a.appendChild(r)}}for(var l=J(e).find("tr"),i=l.length,o=0;o<i;o++){var s=l[o];if(s.setAttribute("id","rw-"+Utils.randomString(4)),!s.childNodes.length){var r=T("td");s.appendChild(r)}if(!Utils.nodeNameEquals(s.parentNode,"table|tbody|thead")){var n=T("table");J(n).insertAfter(s),n.appendChild(s)}}},R=function(e){var t=e.textContent;t=t.replace(/[\u0020\r\u00a0]/g," ").replace(/[\u200b\u0010\u0012\u001c\u0011\u0013\u000e\u000f\u0003\u000d\ueeff\ueefe]/g,""),e.textContent=t},S=function(e){return e.textContent&&e.textContent.length},O=function(t){if(t.nodeType==Node.ELEMENT_NODE){var i=["whiteSpace"],r=HtmlStyleParser.getComputedStylesFromBrowser(t,i).whiteSpace,n=t.innerHTML;if(r.indexOf("pre")!=-1&&(n.match(/\n/g)||n.match(/\t/g))&&n.indexOf("data-text-info")==-1){n=n.replace(/[\n]/g,"<br>");var a=document.createElement("span"),l={st:NODE_TYPE.TAB,type:NODE_TYPE.TEXT,leader:"0"};a.innerText="\t",a.setAttribute("data-text-info",JSON.stringify(l)),a.setAttribute("data-tab",JSON.stringify({class:"Apple-tab-span"})),n=n.replace(/[\t]/g,a.outerHTML),t.innerHTML=n}}for(var s=0,d=t.childNodes,c=t.childNodes.length;s<c;s++){var p=d[s];if(p.nodeType==Node.COMMENT_NODE||Utils.nodeNameEquals(p,"style")){if("EndFragment"==p.nodeValue)break}else if(o.indexOf(p.nodeName.toLowerCase())!=-1)if(p.nodeType==Node.TEXT_NODE){var u=p.textContent;if(u=u.replace(/ *(\n+) */g,""),u=u.replace(/ *(\t+) */g,""),!u.length)continue;u=p.textContent,u=u.replace(/ *(\n+) */g," "),u=u.replace(/ *(\t+) */g," "),u=PasteUtil.removeDocUniCodes(u),p.textContent=u,R(p),S(p)?e.push(p):""}else e.push(p);else p.hasAttribute("data-tab")?e.push(p):O(p)}},v=function(e){var t=e.parentNode;do{if(t&&HTMLUtil.isBlockElement(t))break;t=t.parentNode}while(t);return t},b=function(e){var t=y(e,"a");return!(!t||!t.hasAttribute("href"))},A=function(e,t){var i=[],o=e.parentNode;if(Utils.nodeNameEquals(e,"body"))return i;do{if(Utils.nodeNameEquals(o,t)||Utils.nodeNameEquals(o,"body"))break;i.push(o),o=o.parentNode}while(o);return i},y=function(e,t){t=Array.isArray(t)?t.join("|"):t;var i=e.parentNode,o=null;do{if(Utils.nodeNameEquals(i,t)){o=i;break}i=i.parentNode}while(i);return o},D=function(e){for(var t=J(e).find("img"),i=0,o=t.length;i<o;i++){var r=t[i],n=J(r),a=null;if(r.hasAttribute("data-shapedata")?r.removeAttribute("src"):a=n.attr("src"),a){var l="";if(a.indexOf("data:image")!=-1&&a.indexOf("base64")>-1)l=HTMLUtil.storeImageInFileStore(a);else if(a.indexOf("image.do?")!=-1)l=a.substring(a.indexOf("image.do"));else if("data:,"==a||a.indexOf("file://")!=-1){UIUtils.showImageFailedMsg();continue}l&&(n.attr("data-zw-imagesrc",l),n.attr("src",Utils.getContextUrl(l)))}n.attr({"data-img-info":JSON.stringify(HtmlStyleParser.getImageStyles(r))})}},C=function(e){for(var t=J(e).find("iframe"),i=0,o=t.length;i<o;i++){var r=t[i],n=r.getAttribute("src"),a=new RegExp(ATTR_WIDGET.URL_REGEX);a.test(n)?J(r).attr({"data-iframe-info":JSON.stringify(HtmlStyleParser.getIframeStyles(r))}):J(r).remove()}},I=function(e){return J(e).find("[data-doc-rid]").length},P=function(i){e=[];var o=document.getElementById("pasteFrame"),r=o.contentWindow.document.body;i&&(r.innerHTML=i.innerHTML);var n=frames.pasteFrame.document.body,a=document.createElement("body");t=I(n),E(n),h(n),c(n),d(n);var l=s(n);D(n),C(n),O(n),J.isEmptyObject(l.listFormatJSON)||(a.setAttribute("data-list-info",JSON.stringify(l.listFormatJSON)),J.isEmptyObject(l.paraStyles)||a.setAttribute("data-para-info",JSON.stringify(l.paraStyles)));for(var p,u=e.length,f=0;f<u;){var g,T=e[f],R=[T],S=v(T),A=document.createElement("p");for(g=Utils.nodeNameEquals(S,"td|th|body")?{type:NODE_TYPE.PARAGRAPH}:S.hasAttribute("data-para-info")?JSON.parse(S.getAttribute("data-para-info")):HtmlStyleParser.getParagraphStylesOfBlockEle(S),g.hasOwnProperty("continue-id")&&J(A).attr("data-continue-list-id",g["continue-id"]),J(A).attr({"data-para-info":JSON.stringify(g)});f+1<u&&!Utils.nodeNameEquals(e[f+1],"hr")&&S==v(e[f+1]);)R.push(e[f+1]),f++;var P=!1;f+1==u&&Utils.nodeNameEquals(v(R[0]),"body")&&(P=!0);for(var L,w,M=y(T,["td","th","body"]),U=0;U<R.length;U++){var x=R[U],F=!1;if(w=x,!J(w.parentNode).hasClass("EOP")){try{F=!!x.hasAttribute("data-tab")}catch(e){F=!1}if(w.nodeType!=Node.TEXT_NODE)w=w.cloneNode(F);else{var p=HtmlStyleParser.getTextStylesOfTextNode(w),k=t?w.parentNode.cloneNode():document.createElement("span");k.hasAttribute("data-text-info")&&extend(p,JSON.parse(k.getAttribute("data-text-info"))),k.innerText=w.textContent,J(k).attr("data-text-info",JSON.stringify(p)),w=k}if(b(x)){var B=y(x,"a");if((L&&L.id!=B.id||!L)&&(L=y(x,"a").cloneNode()),w.hasAttribute("data-text-info")){var H=JSON.parse(w.getAttribute("data-text-info")),G=extend(H,{class:"link"});w.setAttribute("data-text-info",JSON.stringify(G))}else w.setAttribute("data-text-info",JSON.stringify({calss:"link"}));L.appendChild(w),w=L}P?a.appendChild(w):A.appendChild(w)}}if(P)break;if(Utils.nodeNameEquals(M,"body"))a.appendChild(A);else if(Utils.nodeNameEquals(M,"td|th")){var z=J(a).find("#"+M.getAttribute("id"));if(!z[0]){for(var V=J(M).parents("table"),Y=V.length,W=Y-1;W>=0;W--){var j=J(a).find("#"+V[W].id);if(!j[0]){var Z=N(V[W]),X=y(V[W],["td","th","body"]);Utils.nodeNameEquals(X,"body")?J(a).append(Z):J(a).find("#"+X.id).append(Z)}}z=J(a).find("#"+M.getAttribute("id"))}z.append(A)}f++}return m(a),_(a),a},_=function(e){for(var t=J(e).find("br"),i=0,o=t.length;i<o;i++){var r=t[i];!r.nextSibling&&J(r).remove()}},N=function(e){var t=e.cloneNode(),i=TableUtil.findNodesInTable(e,"tr");J(t).attr({"data-table-info":JSON.stringify(HtmlStyleParser.getTableStyles(e))});for(var o=0,r=i.length;o<r;o++){var n=i[o].cloneNode();t.appendChild(n),J(n).attr({"data-row-info":JSON.stringify(HtmlStyleParser.getRowStyles(i[o]))});for(var a=TableUtil.findNodesInTable(i[o],"td,th"),l=0,s=a.length;l<s;l++){var d=a[l].cloneNode();n.appendChild(d),J(d).attr({"data-cell-info":JSON.stringify(HtmlStyleParser.getCellStyles(a[l]))})}}return t},L=function(e){var t=J(e).find("[data-doc-rid]"),i=!1,o=!1,r=!1,n=J(e).children("ol,ul"),a=_listNodes.length;if(t.length>0&&(i=t.attr("data-doc-rid")==editor.doc.docInfo.RID),i&&1==a){var l=(editor.doc.getSelection().parents(NODE_TYPE.PARAGRAPH).targetParaAttr=_targetPara.attr("*"),DocUtil.isList(_targetParaAttr)),s=(n[0],Jnode.attr("data-list-id"));l?targetParaAttr[ATTR_PARAGRAPH.LS_DATA].id==s?o=!0:r=!0:isSameDocListPaste=!0}return{isSameDocumentPaste:i,isSameListPaste:o,isSameDocDiffListPaste:r,isSameDocListPaste:_isSameDocListPaste}};return{getProcessedHTML:P,getPasteInfo:L,getParentNode:y,getParentsUntil:A,isInsideAnchor:b,processTD:u}}(),HtmlStyleParser=function(){"use strict";var e={fontWeight:ATTR_TEXT.TS_FW,fontSize:ATTR_TEXT.TS_SIZE,fontFamily:ATTR_TEXT.TS_FF,fontStyle:ATTR_TEXT.TS_FS,color:ATTR_TEXT.TS_FGC,"text-decoration":ATTR_TEXT.TS_TD,backgroundColor:ATTR_TEXT.TS_BGC,verticalAlign:ATTR_TEXT.TS_VA,"letter-spacing":ATTR_TEXT.TS_CS,fontVariant:ATTR_TEXT.TS_FV},t={fw:"fontWeight",size:"fontSize",ff:"fontFamily",fs:"fontStyle",fgc:"color",td:"text-decoration",bgc:"backgroundColor",va:"verticalAlign",cs:"letter-spacing",fv:"fontVariant"},i={textAlign:ATTR_PARAGRAPH.PS_AL,textIndent:ATTR_PARAGRAPH.PS_TI,backgroundColor:ATTR_PARAGRAPH.PS_BGC,marginLeft:ATTR_PARAGRAPH.PS_ML,marginRight:ATTR_PARAGRAPH.PS_MR,marginBottom:ATTR_PARAGRAPH.PS_SA,marginTop:ATTR_PARAGRAPH.PS_SB,lineHeight:ATTR_PARAGRAPH.PS_LS,borders:ATTR_COMMON.BORDERS},o=["fontFamily","fontSize","fontWeight","fontStyle","fontVariant","color","text-decoration","letter-spacing","backgroundColor","verticalAlign"],r=["textIndent","textAlign","lineHeight","direction","backgroundColor","marginRight","marginLeft","marginTop","marginBottom"],n=["backgroundColor","backgroundImage"],a=["backgroundColor","text-align","vertical-align","paddingLeft","backgroundImage"],s=function(){return window.getComputedStyle?function(e,t){for(var i,o=getComputedStyle(e,null),r={},n=0,a=t.length;n<a;n++)i=t[n],r[i]=o[i];return r}:function(e,t){var i,o={},r=0;for(t.length;r<l;r++)i=t[r],o[i]=e.currentStyle[i];return o}}(),d=function(e,i){var l,s=e.getAttribute("data-format-attr");switch(s=s&&JSON.parse(s),i){case NODE_TYPE.PARAGRAPH:l=r;break;case NODE_TYPE.TABLE:l=n;break;case NODE_TYPE.CELL:l=a;break;case NODE_TYPE.TEXT:if(l=o,s)for(var d=0,c=s.length;d<c;d++)s[d]=t[s[d]]}return s?s:l},c=function(e){var t=e.getAttribute("href"),i=LINK_TYPES.WEBURL;return t.indexOf("mailto:")!=-1?i=LINK_TYPES.MAILTO:t.indexOf("#bookmark")!=-1&&(i=LINK_TYPES.BOOKMARK),i},p=function(e){var t=e.getAttribute("href"),i=e.getAttribute("target");i||(i="new");var o=(J(e).attr("title"),c(e));o===LINK_TYPES.BOOKMARK&&(t=t.substr(t.indexOf("#bookmark=")+"#bookmark=".length));var r={};return r[ATTR_LINK.LINK_TYPE]=o,r[ATTR_LINK.LINK_URL]=t,r[ATTR_COMMON.ID]=e.getAttribute("id"),r[ATTR_COMMON.TYPE]=NODE_TYPE.LINK,r},u=function(e,t){if(!Utils.nodeNameEquals(e,"li")){var i=PastePreProcess.getParentNode(e,"li");if(!i)return null;e=i}var o=PastePreProcess.getParentNode(e,["ol","ul"]),r=J(o).attr("data-list-id"),n=J(e).attr("data-continue-list-id");"undefined"!=typeof n&&(t["continue-id"]=n);var a=J(e).parents("ol,ul").length-1;a=a>8?8:a;var l={id:r,l:a};t[ATTR_PARAGRAPH.LS_DATA]=l,t[ATTR_PARAGRAPH.PS_TI]="-0.25in",t[ATTR_PARAGRAPH.PS_TYPE]="list",t[ATTR_PARAGRAPH.PS_ML]=.5*(a+1)+"in"},f=function(e){return{type:NODE_TYPE.ROW,id:e.getAttribute("id")}},g=function(e,t){HtmlStyleParser.getBorderStyles(e,t);var i=PastePreProcess.getParentsUntil(e,"body|td|th"),o=["marginLeft","marginRight","marginTop","marginBottom"],r=["backgroundColor"],n={},a=function(e){for(var t=0,i=o.length;t<i;t++)if("0px"!=e[o[t]])return!0;return!1},l=function(e){return!(!e||"rgba(0, 0, 0, 0)"==e||"transparent"==e)},s=i.length,d=0;do{if(!e)break;var c,p=[];if(n.hasOwnProperty("marginTop")||(p=p.concat(o)),n.hasOwnProperty("backgroundColor")||(p=p.concat(r)),0==p.length)break;var c=HtmlStyleParser.getComputedStylesFromBrowser(e,p);if(a(c))for(var u=0,s=o.length;u<s;u++)n[o[u]]=c[o[u]];l(c.backgroundColor)&&(n.backgroundColor=c.backgroundColor),e=i[d]}while(d++<s);return n},m=function(e,t){var i,o=["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle"],r=(t.type==NODE_TYPE.PARAGRAPH,t.type==NODE_TYPE.PARAGRAPH?NODE_TYPE.PARAGRAPH:t.type==NODE_TYPE.CELL?NODE_TYPE.CELL:null),n=function(e){var t={},i=HtmlStyleParser.getComputedStylesFromBrowser(e,o),r=parseInt(i.borderTopWidth)||0,n=parseInt(i.borderRightWidth)||0,a=parseInt(i.borderLeftWidth)||0,l=parseInt(i.borderBottomWidth)||0;return t[ATTR_COMMON.BORDERS]={},r&&(t[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_TOP]={type:i.borderTopStyle||"none",width:r+"px",color:i.borderTopColor||"rgb(0, 0, 0)",space:"0px"}),n&&(t[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_RIGHT]={type:i.borderRightStyle||"none",width:n+"px",color:i.borderRightColor||"rgb(0, 0, 0)",space:"0px"}),a&&(t[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_LEFT]={type:i.borderLeftStyle||"none",width:a+"px",color:i.borderLeftColor||"rgb(0, 0, 0)",space:"0px"}),l&&(t[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM]={type:i.borderBottomStyle||"none",width:l+"px",color:i.borderBottomColor||"rgb(0, 0, 0)",space:"0px"}),jQuery.isEmptyObject(t[ATTR_COMMON.BORDERS])&&delete t[ATTR_COMMON.BORDERS],t},a=function(e,t,i){var o;i==NODE_TYPE.PARAGRAPH?o={paddingTop:ATTR_BORDERS.BORDER_TOP,paddingBottom:ATTR_BORDERS.BORDER_BOTTOM,paddingRight:ATTR_BORDERS.BORDER_RIGHT,paddingLeft:ATTR_BORDERS.BORDER_LEFT}:i==NODE_TYPE.CELL&&(o={paddingTop:ATTR_CELL.TDS_PT,paddingBottom:ATTR_CELL.TDS_PB,paddingRight:ATTR_CELL.TDS_PR,paddingLeft:ATTR_CELL.TDS_PL});var r,n=["paddingTop","paddingBottom","paddingRight","paddingLeft"],a=PastePreProcess.getParentsUntil(e,"body|td|th"),l=function(){for(var e in o){var n=e,a=r[e];a=parseFloat(a.convertor().pixels.toFixed(2))+"px",i==NODE_TYPE.PARAGRAPH?(t[ATTR_COMMON.BORDERS]=t[ATTR_COMMON.BORDERS]||{},t[ATTR_COMMON.BORDERS][o[n]]=t[ATTR_COMMON.BORDERS][o[n]]||{},t[ATTR_COMMON.BORDERS][o[n]][ATTR_BORDERS.SPACE]=a):t[o[n]]=a}},s=function(){for(var e=0,t=n.length;e<t;e++)if("0px"!=r[n[e]])return!0;return!1},d=0,c=a.length;do{if(r=HtmlStyleParser.getComputedStylesFromBrowser(e,n),s()){l();break}e=a[d]}while(d++<c)},l=e;if(r==NODE_TYPE.PARAGRAPH){var s={};s[ATTR_COMMON.BORDERS]={};var d="0px",c="none",p="rgb(0,0,0)";s[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_TOP]={type:c,width:d,color:p},s[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_RIGHT]={type:c,width:d,color:p},s[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM]={type:c,width:d,color:p},s[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_LEFT]={type:c,width:d,color:p};var u=PastePreProcess.getParentsUntil(e,"body|td|th");if(i=n(e),J.isEmptyObject(i))for(var f=u.length,g=f-1;g>=0;g--)if(i=n(u[g]),!J.isEmptyObject(i)){l=u[g];break}J.isEmptyObject(i)&&(i=s)}else i=n(e);r&&a(l,i,r),extend(t,i)},h=function(e){if(!e)return"";e=e.replace(/'|"/g,"");for(var t=e.toLowerCase().split(","),i=t.length,o=editor.defaultFonts,r=[],n=0;n<i;n++){var a=t[n].trim();o.contains(a)&&r.push(a)}return r.join(",")},T=function(e){var t,i,o=J(e),r=d(e,NODE_TYPE.CELL),n=HtmlStyleParser.getComputedStylesFromBrowser(e,r),l={type:NODE_TYPE.CELL},s=o.attr("merge"),c=e.getAttribute("colspan"),p=e.getAttribute("rowspan"),u=a.length;l[ATTR_COMMON.ID]=e.getAttribute("id"),c&&(l.cspan=parseInt(c),p||(l.rspan=1),l.merge="fc"),p&&(l.rspan=parseInt(p),c||(l.cspan=1),l.merge="fc"),s&&(l.merge=s),HtmlStyleParser.getBorderStyles(e,l),n.backgroundImage=v(n);for(var f=0;f<u;f++)t=a[f],i=n[t],"text-align"!=t||"left"!=i&&"right"!=i&&"center"!=i&&"justify"!=i?"vertical-align"==t&&"baseline"!=i?l[ATTR_CELL.TDS_VA]=i:"paddingLeft"==t?l[ATTR_CELL.TDS_PL]=l[ATTR_CELL.TDS_PR]=Conversions.defaultCellPadding:"backgroundColor"==t&&"transparent"!=i&&"rgba(0, 0, 0, 0)"!=i?l[ATTR_CELL.Z_TD_BGC]=i:"backgroundImage"==t&&"none"!=i&&(l[ATTR_CELL.TDS_BGIMG]=i):l[ATTR_CELL.TDS_TXTAL]=i;return l},E=function(e){var t=J(e),i={type:NODE_TYPE.TABLE};if(!e)return i;HtmlStyleParser.getBorderStyles(e,i);var o=e.getAttribute("cellpadding");o&&(i[ATTR_TABLE.TBLS_CP]=o),i[ATTR_TABLE.TBLS_WID]=t.attr("data-width"),i[ATTR_COMMON.ID]=e.getAttribute("id");for(var r=JSON.parse(t.attr("data-cols")),a=!0,l=0;l<r.length;l++)if(0==Object.keys(r[l]).length||isNaN(parseFloat(r[l].wt))){Utils.sendErrorDetails("EmptyColsFromGetTableStyles<ZWERROR>"+editor.doc.getDocInfo().VERSION+"."+editor.doc.getDocInfo().REVISION+"."+editor.doc.getDocInfo().RID+"<ZWERROR>\n Error Log Start \n buildLabel: "+buildLabel+"\n Error Log End \n <ZWERROR>#### EmptyColsFromGetTableStyles: \n\n AditionalInfo: EmptyColsFromGetTableStyles #####"),a=!1;break}i[ATTR_TABLE.TBLS_COLS]=r,a&&i[ATTR_TABLE.TBLS_COLS]&&(i[ATTR_TABLE.TBLS_VER]="4.0",i[ATTR_TABLE.TBLS_COLS]=r);var s=t.attr("data-theme");s?i[ATTR_TABLE.TBLS_THEME]=JSON.parse(s):(i[ATTR_TABLE.TBLS_THEME]={},i[ATTR_TABLE.TBLS_THEME][ATTR_TABLE.TBLS_THEME_OBJECT]=TableLeftPanelTheme.TableNewThemeInfo.theme2,i[ATTR_TABLE.TBLS_THEME][ATTR_TABLE.TBLS_THEMENAME]="theme2");var c=n.length,p={},u=d(e,NODE_TYPE.TABLE);p=HtmlStyleParser.getComputedStylesFromBrowser(e,u),p.backgroundImage=v(p);for(var f=0;f<c;f++){var g=n[f],m=p[g];"backgroundColor"==g&&"transparent"!=m&&"rgba(0, 0, 0, 0)"!=m?i[ATTR_TABLE.TBLS_TBL_BGC]=m:"backgroundImage"==g&&"none"!=m&&(i[ATTR_TABLE.TBLS_BGIMG]=m)}var h=t.attr("align");return h&&(i[ATTR_TABLE.TBLS_AL]=h),i},R=function(e){var t={type:NODE_TYPE.PARAGRAPH},o=d(e,NODE_TYPE.PARAGRAPH),n=HtmlStyleParser.getComputedStylesFromBrowser(e,o),a=PastePreProcess.getParentNode(e,["h1","h2","h3","h4","h5","h6"]),l=0;Utils.nodeNameEquals(e,"h1|h2|h3|h4|h5|h6")&&(a=e),a&&(l=a.nodeName.substr(1));var s=C(l);extend(n,g(e,t));var c=[ATTR_BORDERS.BORDER_TOP,ATTR_BORDERS.BORDER_RIGHT,ATTR_BORDERS.BORDER_LEFT,ATTR_BORDERS.BORDER_BOTTOM],p=!0;for(var u in c){var f=c[u];t[ATTR_COMMON.BORDERS][f]!=s[ATTR_COMMON.BORDERS][f]&&(p=!1)}if(p)for(var u in c)delete t[u];HtmlStyleParser.getListStyles(e,t);for(var m=0,h=r.length;m<h;m++){var T=r[m],E=n[T],R=i[T];if(R&&E&&"normal"!=E){if("textAlign"==T)E=E.indexOf("center")!=-1?1:"left"==E?0:"right"==E?2:"justify"==E?3:0;else if("marginRight"==T||"marginLeft"==T)E=E.convertor().inches,E<0&&(E=0),E=parseFloat(E.toFixed(3))+"in";else if("marginTop"==T||"marginBottom"==T)E=E.convertor().points,E<0&&(E=0),E=parseFloat(E.toFixed(2))+"pt";else if("textIndent"==T)E=parseFloat(E.convertor().inches.toFixed(2))+"in";else if("lineHeight"==T){var S=HtmlStyleParser.getComputedStylesFromBrowser(e,["font-size"])["font-size"],O=E.convertor().pixels,v=S.convertor().pixels;E=O/v,E=parseFloat(E.toFixed(1))}else"backgroundColor"==T&&"transparent"==E&&(E=null);R&&null!=E&&s[T]!=E&&(t[R]=E)}}var b=J(e);try{b.hasClass("zw-paragraph")&&(E=b.attr("data-tab-info"),E&&(t[ATTR_PARAGRAPH.PS_TPS]=JSON.parse(E)),E=b.attr("data-keep-line-info"),E&&(t[ATTR_PARAGRAPH.EN_BL]=E),E=b.attr("data-page-break-info"),E&&(t[ATTR_PARAGRAPH.EN_PB]=E),E=b.attr("data-page-break-info"),E&&(t[ATTR_PARAGRAPH.EN_WO]=E),E=b.attr("data-hd-info"),E&&(t[ATTR_PARAGRAPH.PS_HD]=E),E=b.attr("data-textformat"),E&&(t[ATTR_PARAGRAPH.PS_TS]=JSON.parse(E)),E=b.attr("data-codeformat"),E&&(t[ATTR_PARAGRAPH.PS_CODE]=JSON.parse(E)),E=b.attr("data_styles"),E&&(t[ATTR_PARAGRAPH.PS_TS]=JSON.parse(E)))}catch(e){}if(t[ATTR_PARAGRAPH.PS_HD]=l,b.attr("data-hlist-type")){var A=parseInt(b.attr("data-hd-info"));t[ATTR_PARAGRAPH.LS_DATA]={l:A-1,id:0}}if(J(e).hasClass("ms-list")){var y=JSON.parse(J(e).attr("data-list-info"));t[ATTR_PARAGRAPH.LS_DATA]=y,t[ATTR_PARAGRAPH.PS_TI]="-0.25in",t[ATTR_PARAGRAPH.PS_ML]=.5*(y.l+1)+"in",t[ATTR_PARAGRAPH.PS_TYPE]="list"}return e.hasAttribute("data-custom_data")&&(t.customdata=e.getAttribute("data-custom_data")),t},S=function(t,i){if(3!=t.nodeType)return null;var r={type:NODE_TYPE.TEXT},n=PastePreProcess.getParentNode(t,["h1","h2","h3","h4","h5","h6"]),a=0;n&&(a=n.nodeName.substr(1));var l=A(t);if(3==t.nodeType&&(t=t.parentNode,!t))return r;var s=1==HTMLUtil.isBlockElement(t)?b(t):null;i=i?i:o;var c=i.length,p=d(t,NODE_TYPE.TEXT),u=HtmlStyleParser.getComputedStylesFromBrowser(t,p),f=P(a);l&&(u["text-decoration"]=l),u.backgroundColor=u.backgroundColor?u.backgroundColor:s,u.verticalAlign=O(t);for(var g=0;g<c;g++){var m=i[g],T=u[m],E=e[m];if(T){if("fontWeight"==m)isNaN(parseInt(T))||(T=parseInt(T)>400?"bold":"normal");else if("fontSize"==m)T=Math.round(DomUtil.getFontSize(T));else if("fontFamily"==m){T=T.replace(/\s{2,}/g," ");var R=T.replace(/["]{1}/gi,"'");T=h(R)}else if("color"==m)(Utils.nodeNameEquals(t,"a")||PastePreProcess.isInsideAnchor(t))&&"#0000EE"==Utils.rgbToHex(T).toUpperCase()&&(T=null);else if("verticalAlign"!==m||"super"!==T&&"sub"!==T)"letter-spacing"==m?(T="normal"==T?"0pt":T,T=Math.round(T.convertor().points)+"pt"):"backgroundColor"==m&&"transparent"==T&&(T=null);else{var S=DomUtil.getFontSize(i.fontSize);S=parseInt(S*(1/.7)),r[ATTR_TEXT.TS_SIZE]=S}E&&null!=T&&f[m]!=T&&(r[E]=T)}}return t.hasAttribute("data-custom_data")&&(r.customdata=t.getAttribute("data-custom_data")),r},O=function(e){var t=PastePreProcess.getParentsUntil(e,"body|td|th"),i=HtmlStyleParser.getComputedStylesFromBrowser(e,["verticalAlign"]).verticalAlign;if("super"==i||"sub"==i)return i;for(var o=0,r=t.length;o<r&&(i=HtmlStyleParser.getComputedStylesFromBrowser(t[o],["verticalAlign"]).verticalAlign,"super"!=i&&"sub"!=i);o++);return i},v=function(e){var t;t=e.backgroundImage;try{t&&t.indexOf("url")!=-1&&(t=t.replace(/url\(("|)|((|")\))/g,""))}catch(e){t="none"}return t&&t.indexOf("data:image")!=-1&&t.indexOf("base64")!=-1&&(t=HTMLUtil.storeImageInFileStore(t)),t},b=function(e){var t=PastePreProcess.getParentsUntil(e,"body|td|th"),i=HtmlStyleParser.getComputedStylesFromBrowser(e,["backgroundColor"]).backgroundColor||"rgba(0, 0, 0, 0)";if("rgba(0, 0, 0, 0)"!=i&&"transparent"!=i)return i;for(var o=0,r=t.length;o<r&&(i=t[o].style.backgroundColor||"rgba(0, 0, 0, 0)","rgba(0, 0, 0, 0)"==i);o++);return i},A=function(e){for(var t=PastePreProcess.getParentsUntil(e,"body"),i=!1,o=!1,r=0,n=t.length;r<n;r++){var a=["textDecoration"],l=HtmlStyleParser.getComputedStylesFromBrowser(t[r],a).textDecoration;l.indexOf("none")==-1&&(i||l.indexOf("underline")==-1||(i=!0),o||l.indexOf("line-through")==-1||(o=!0))}var s=i?"underline ":"";return s+=o?"line-through":"",s.trim()},y=function(e){var t={type:NODE_TYPE.IMAGE},i=(e.getAttribute("data-format"),s(e,["width","height","transform"]));if(HtmlStyleParser.getBorderStyles(e,t),J(e).hasClass("zw-shape-image")){var o=J(e).attr("data-shapedata");return t[ATTR_IMAGE.I_SHAPEDATA]=JSON.parse(o),InsertShape.processBeforeShapePaste(t),t}if(J(e).hasClass("zw-video-image"))return t=JSON.parse(J(e).attr("data-video-data")),t[ATTR_COMMON.ID]=Utils.randomString(),t;if(J(e).hasClass("zw-mminfo-image"))return t=JSON.parse(J(e).attr("data-mminfo")),t[ATTR_COMMON.ID]=Utils.randomString(),t;var r=J(e),n=e.getAttribute("src"),a=r.attr("data-zw-imagesrc");a&&(n=a),t[ATTR_IMAGE.I_SRC]=n;var l=i.transform;if("none"!=l){var d=l.match(/matrix\((.+?)\)/);if(d[1]){var c=d[1].split(","),p=c[0],u=c[1],f=Math.round(Math.atan2(u,p)*(180/Math.PI));f<0&&(f+=360),t[ATTR_IMAGE.I_ROTATE]=f}}var g=e.getAttribute("latexexpression");g&&(t[ATTR_IMAGE.I_LATEXEXP]=g,t[ATTR_IMAGE.I_IMGSIZE]=e.getAttribute("imagesize"));var m,h,m=parseInt(i.width),h=parseInt(i.height);m||h||(m=250,h=150);var T,E,R,S,O=e.style,v=parseInt(O.top,10),b=parseInt(O.left,10),A=e.getAttribute("align")||O.float,y=e.getAttribute("vspace"),C=e.getAttribute("hspace");return y?T=E=y+"px":(T=r.css("margin-Top"),E=r.css("margin-Bottom")),C?R=S=C+"px":(R=r.css("margin-Left"),S=r.css("margin-Right")),"mm"==Conversions.globalUnit?(T=T.convertor().millimeters+Conversions.globalUnit,E=E.convertor().millimeters+Conversions.globalUnit,R=R.convertor().millimeters+Conversions.globalUnit,S=S.convertor().millimeters+Conversions.globalUnit):(T=T.convertor().inches+Conversions.globalUnit,E=E.convertor().inches+Conversions.globalUnit,R=R.convertor().inches+Conversions.globalUnit,S=S.convertor().inches+Conversions.globalUnit),A&&(t[ATTR_IMAGE.I_AL]=A),b&&(t[ATTR_IMAGE.I_LEFT]=b),v&&(t[ATTR_IMAGE.I_TOP]=v),t[ATTR_IMAGE.I_WID]=m,t[ATTR_IMAGE.I_WID_UN]="px",t[ATTR_IMAGE.I_HT]=h,t[ATTR_IMAGE.I_HT_UN]="px",t[ATTR_IMAGE.I_MT]=T,t[ATTR_IMAGE.I_MB]=E,t[ATTR_IMAGE.I_ML]=R,t[ATTR_IMAGE.I_MR]=S,t[ATTR_IMAGE.I_ORGINALWID]=m,t[ATTR_IMAGE.I_ORGINALHT]=h,!e.naturalWidth||t.al&&"bottom"!=t.al||D(t),t},D=function(e){var t,i,o,r;o=i=e[ATTR_IMAGE.I_WID],r=t=e[ATTR_IMAGE.I_HT];var n=editor.doc.getPaperWidth(),a=PageLayout.getBodyHeight();i>n&&(t=t/i*n,i=n),t>a&&(i=i/t*a,t=a),e[ATTR_IMAGE.I_ORGINALWID]=e[ATTR_IMAGE.I_WID]=i,e[ATTR_IMAGE.I_ORGINALHT]=e[ATTR_IMAGE.I_HT]=t},C=function(e){var t=DocStyleObject.para.h0;e&&(t=Utils.mergeObjs([t,DocStyleObject.para["h"+e]]));var i={};return i[ATTR_COMMON.BORDERS]={},i[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_TOP]={type:"none",width:"0px",color:"rgb(0, 0, 0)",space:"0px"},i[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_LEFT]={type:"none",width:"0px",color:"rgb(0, 0, 0)",space:"0px"},i[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_RIGHT]={type:"none",width:"0px",color:"rgb(0, 0, 0)",space:"0px"},i[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM]={type:"none",width:"0px",color:"rgb(0, 0, 0)",space:"0px"},{borders:t[ATTR_COMMON.BORDERS]||i,textAlign:t[ATTR_PARAGRAPH.PS_AL]||0,marginRight:t[ATTR_PARAGRAPH.PS_MR]||"0in",marginTop:t[ATTR_PARAGRAPH.PS_SB]||"0pt",marginBottom:t[ATTR_PARAGRAPH.PS_SA]||"0pt",marginLeft:t[ATTR_PARAGRAPH.PS_ML]||"0in",paddingLeft:t[ATTR_PARAGRAPH.PS_PL]||"0in",paddingRight:t[ATTR_PARAGRAPH.PS_PR]||"0in",paddingTop:t[ATTR_PARAGRAPH.PS_PT]||"0in",paddingBottom:t[ATTR_PARAGRAPH.PS_PB]||"0in",backgroundColor:t[ATTR_PARAGRAPH.PS_BGC]||"rgba(0, 0, 0, 0)",textIndent:t[ATTR_PARAGRAPH.PS_TI]||"0in",lineHeight:parseFloat(t[ATTR_PARAGRAPH.PS_LS])||1.2}},I=function(e){var t={type:NODE_TYPE.WIDGET},i=s(e,["width","height"]),o=parseInt(i.width),r=parseInt(i.height);return t[ATTR_WIDGET.WID]=o?o:"400",t[ATTR_WIDGET.HT]=r?r:"400",t[ATTR_WIDGET.SRC]=e.getAttribute("src"),e.hasAttribute("data-thumbnail")&&(t[ATTR_WIDGET.THUMBNAIL]=e.getAttribute("data-thumbnail")),t},P=function(e){var t=DocStyleObject.para.h0.textFormat;return e&&(t=Utils.mergeObjs([t,DocStyleObject.para["h"+e].textFormat])),{fontWeight:t[ATTR_TEXT.TS_FW]||"normal",fontSize:t[ATTR_TEXT.TS_SIZE],fontFamily:t[ATTR_TEXT.TS_FF],fontStyle:t[ATTR_TEXT.TS_FS]||"normal",color:t[ATTR_TEXT.TS_FGC]||"rgb(0, 0, 0)","text-decoration":t[ATTR_TEXT.TS_TD]||"none",backgroundColor:t[ATTR_TEXT.TS_BGC]||"rgba(0, 0, 0, 0)",verticalAlign:t[ATTR_TEXT.TS_VA]||"baseline","letter-spacing":t[ATTR_TEXT.TS_CS]||"0pt",fontVariant:t[ATTR_TEXT.TS_FV]||"normal"}};return{getComputedStylesFromBrowser:s,getListStyles:u,getRowStyles:f,getBorderStyles:m,getNonInheritedStyles:g,getCellStyles:T,getTableStyles:E,getParagraphStylesOfBlockEle:R,getTextStylesOfTextNode:S,getBackgroundColor:b,getTextDecorationInfo:A,getImageStyles:y,getIframeStyles:I,getLinkStyles:p,getImageWidthHeightAccordingToPage:D}}();var Events=function(){var e=function(e){return e.target||e.srcElement},t=function(){J("body").bind("mousemove",function(e){PubSub.publish("Document/MouseMove",e)}),J(document).bind("mouseup",function(e){PubSub.publish("Document/MouseUp",e)}),J(".header_primary").bind("mouseenter",function(e){PubSub.publish("Document/HeaderMouseEnter",e)}),J(".footer_primary").bind("mouseenter",function(e){PubSub.publish("Document/FooterMouseEnter",e)}),J(".header_primary").bind("mouseleave",function(e){PubSub.publish("Document/HeaderMouseLeave",e)}),J(".footer_primary").bind("mouseleave",function(e){PubSub.publish("Document/FooterMouseLeave",e)}),Z(ELEM_ID.EDITOROUTERDIV)[0].addEventListener(MouseWheelEvent,function(e){PubSub.publish("Editor/WheelEvent")},!1),document.addEventListener("keydown",function(e){27==e.keyCode&&PubSub.publish("DOM/ESCKeyPressed")},!1)};return{bindEvents:t,getTarget:e}}(),LeftPanel=function(){"use strict";var e={HAMBURGERICON:"topband-hamburger",PANELCONTAINER:"panel-container",MAINPANELCONTAINER:"mainpanel-container",SUBPANELCONTAINER:"subpanel-container",FORMATPANEL:"menuFormat",INSERTPANEL:"menuInsert",VIEWPANEL:"menuView",PAGELAYOUTPANEL:"subpanel-pagelayout",TOOLSPANEL:"menuTools",IMAGEOPTIONSPANEL:"subpanel-img",TABLEOPTIONSPANEL:"subpanel-table",HEADEROPTIONSPANEL:"menuHeaderFooter",IMPORTPANEL:"importtoolbar",MAILMERGEPANEL:"ui-mailmergemenu",WORDPRESSPANEL:"wordpress-subpanel",PARAGRAPHOPTIONPANEL:"subpanel-para",EMBEDOPTIONPANEL:"embedOptions",SHAPESPANEL:"menuShapes",TOCPANEL:"subpanel-toc",WATERMARKPANEL:"subpanel-watermark",POSTTOBLOG:"menuposttoblog",MMCONTACTSPANEL:"mm-subpanel-contactscontainer",MMSHEETPANEL:"mm-subpanel-sheetcontainer",MMFORMPANEL:"mm-subpanel-formcontainer",DROPCAPPANEL:"dropcap-panel",TABLETHEMEPANEL:"subpanel-tabletheme",PAGENUMBERPANEL:"subpanel-pagenumber",NOTEPANEL:"subpanel-note"},t={menuFormat:"#menu-fmt",menuInsert:"#menu-insert","subpanel-pagelayout":"#menu-pagelayout",menuTools:"#menu-tools","subpanel-img":"#menu-img","subpanel-table":"#menu-table",menuHeaderFooter:"#menu-headerfooter",menuShapes:"#menu-shape",menuView:"#menu-view"},i={};i[ANIMATIONS.SLIDEIN]="ui-panelslidein-anim",i[ANIMATIONS.SLIDEOUT]="ui-panelslideout-anim",i[ANIMATIONS.FLIPIN]="ui-panelflipin-anim",i[ANIMATIONS.FLIPOUT]="ui-panelflipout-anim",i[ANIMATIONS.FADEIN]="ui-panelfadein-anim",i[ANIMATIONS.FADEOUT]="ui-panelfadeout-anim";var o={},r=[],n={},a={},l=function(){jQuery.extend(ELEM_ID,e),o[ELEM_ID.PANELCONTAINER]=o[ELEM_ID.MAINPANELCONTAINER]=o[ELEM_ID.SUBPANELCONTAINER]=!1,_()},s=function(e){var t=d(e);return t>=0?{index:t,panelObj:r[t]}:null},d=function(e){for(var t=0,i=u();t<i;t++)if(r[t].panelId==e)return t;return-1},c=function(e,t){t>=0?r.splice(t,0,e):r.push(e),PubSub.publish("BeforePanelOpen",e.panelId)},p=function(e){var t=d(e);r.splice(t,1),PubSub.publish("BeforePanelClose",e)},u=function(){return r.length},f=function(){var e=r.length;return e>0?r[e-1]:null},g=function(){for(var e=u(),t=0;t<e;t++){var i=f();z(i.panelId)}},m=function(){var e=0;return h(ELEM_ID.PANELCONTAINER)&&(e=Z(ELEM_ID.PANELCONTAINER)[0].offsetWidth),e},h=function(e){return o[e]},T=function(e,t){o[e]=t},E=function(e){return!!t[e]},R=function(){var e=f();return e?e.zIndex+1:101},S=function(e){var t=Z(e).find("button.ui-icon-close");E(e)?t.hide():(t.show(),t.hasClass("js-panel-close-btn")&&t.bind("click",LeftPanel.closeSubPanel))},O=function(e){var t=Z(e).find("button.ui-icon-close");t.unbind("click",LeftPanel.closeSubPanel)},v=function(e){var i=t[e];i&&J(i).removeClass("ui-active-mnpanel")},b=function(e){var i=t[e];i&&J(i).addClass("ui-active-mnpanel")},A=function(e){var t=Z(ELEM_ID.HAMBURGERICON);"active"==e?t.addClass("ui-blue-bg"):t.removeClass("ui-blue-bg")},y=function(){LayoutManager.isRichEditActive()?LayoutManager.toggleRichEdit("close"):(UIUtils.initComponent("menuInsert"),UIUtils.initComponent("embedObject"),UIUtils.initComponent("menuTools"),editor.doc.getDocInfo().newDoc&&J("#tools-lpnl-mm,#tools-lpnl-digi,#tools-lpnl-posttoblog,#ins-lpnl-version").each(function(){J(this).disable()}),UIUtils.initComponent("ui-mailmergemenu"),LayoutManager.toggleRichEdit("open"),Utils.addToStatistics("Hamburger"))},D={FADEOUT:function(e){M(e.target.id)},FADEIN:function(e){Z(ELEM_ID.SUBPANELCONTAINER).removeClass("ui-subpanel-bg")},FLIPOUT:function(e){M(e.target.id),!h(ELEM_ID.MAINPANELCONTAINER)&&u()<=0&&($(ELEM_ID.SUBPANELCONTAINER),$(ELEM_ID.PANELCONTAINER))}},C={SLIDEOUT:function(e){g(),$(ELEM_ID.MAINPANELCONTAINER),$(ELEM_ID.SUBPANELCONTAINER),M(ELEM_ID.PANELCONTAINER),Z(ELEM_ID.SUBPANELCONTAINER)[0].style.marginTop=""}},I=function(){LayoutManager.isRichEditActive()||LeftPanel.closeSubPanel()},P=function(){var e=document.getElementById("wmstoolbar"),t=e&&e.offsetHeight,i=Z(ELEM_ID.PANELCONTAINER)[0],o=Z(ELEM_ID.SUBPANELCONTAINER)[0],r=window.innerHeight-(i.offsetTop+t);i.style.height=r+"px",LayoutManager.isRichEditActive()||(r+=i.offsetTop),o.style.height=r+"px"},_=function(){PubSub.subscribe("DOM/ESCKeyPressed",I),PubSub.subscribe("Document/Resize",P),PubSub.subscribe("Document/FirstTimeComponentReady",L),PubSub.subscribe("Document/CursorPositionChanged",N),Z(ELEM_ID.PANELCONTAINER).bind(MouseWheelEvent,function(e){var t=J(".ui-vertical-sub-nav").getNiceScroll(),i=t[0].wheelprevented;if(i)for(var o=0,r=t.length;o<r;o++)t[o].wheelprevented=!1})},N=function(){try{UIUtils.toggleTableTabAndButtons(editor.zuid),ConvertTextToTable.canConvert()?J("#tools-lpnl-txttotbl").zbutton("enable"):J("#tools-lpnl-txttotbl").zbutton("disable")}catch(e){}},L=function(){J(".ui-vertical-sub-nav").niceScroll({cursorborder:"",cursorcolor:"#bdbdbd",boxzoom:!1}),J("#mainpanel-container").niceScroll({cursorborder:"",cursorcolor:"#bdbdbd",boxzoom:!1,cursoropacitymax:0})},n={FADEIN:function(e){Z(ELEM_ID.SUBPANELCONTAINER).addClass("ui-subpanel-bg"),e.addClass("ui-panelfadein-anim"),e.show()},FADEOUT:function(e){e.addClass("ui-panelfadeout-anim")},FLIPIN:function(e){e.addClass("ui-panelflipin-anim"),e.show()},FLIPOUT:function(e){e.addClass("ui-panelflipout-anim")},SLIDEIN:function(e){e.addClass("ui-panelslidein-anim"),e.show()},SLIDEOUT:function(e){e.addClass("ui-panelslideout-anim")}},w=function(e){var t=Z(e);t.show()},M=function(e){var t=Z(e);t[0].style.zIndex="",t.hide()},U=function(e){return i[e]},x=function(e,t){a[e]=t},F=function(e){return a[e]},k=function(e){delete a[e]},B=function(e,t,i){var o=Z(e),r=F(e);r&&(o.unbind(AnimationEndEvent),o.removeClass(U(r)),k(e)),AnimationEndEvent&&o.bind(AnimationEndEvent,function(e){o.unbind(AnimationEndEvent),i&&i(e);var r=U(t);o.removeClass(r)}),x(e,t),n[t](o)},H=function(e,t){var i=e.index,o=e.panelObj;z(o.panelId),UIUtils.initComponent(t),b(t),o.panelId=t,Z(t)[0].style.zIndex=o.zIndex,c(o,i),S(t),w(t)},G=function(e,t,i){UIUtils.initComponent(e),b(e),i=i||R(),Z(e)[0].style.zIndex=i,c({panelId:e,animationType:t,zIndex:i}),S(e),t?B(e,t,D[t]):w(e)},z=function(e,t){v(e),p(e),O(e),t?B(e,t,D[t]):M(e)},V=function(e,t){var i=f();"menuShapes"==e&&UIUtils.initComponent("menuShapes"),"menuInsert"==e&&UIUtils.initComponent("menuInsert"),"menuHeaderFooter"==e&&UIUtils.initComponent("menuHeaderFooter"),i&&i.panelId==e||(h(ELEM_ID.PANELCONTAINER)||K(ELEM_ID.PANELCONTAINER),!h(ELEM_ID.MAINPANELCONTAINER),h(ELEM_ID.SUBPANELCONTAINER)||K(ELEM_ID.SUBPANELCONTAINER),E(e)&&h(ELEM_ID.MAINPANELCONTAINER)&&(t&&(t=ANIMATIONS.FADEIN),g()),G(e,t))},Y=function(){var e=f();e&&(E(e.panelId)&&h(ELEM_ID.MAINPANELCONTAINER)?X(ANIMATIONS.SLIDEOUT):z(e.panelId,ANIMATIONS.FLIPOUT))},W=function(e){var t=s(e);t&&t.panelObj&&(t.index<u()-1?LeftPanel.isContainerVisible(ELEM_ID.MAINPANELCONTAINER)?H(t,ELEM_ID.FORMATPANEL):z(e):LeftPanel.isContainerVisible(ELEM_ID.MAINPANELCONTAINER)?LeftPanel.showSubPanel(ELEM_ID.FORMATPANEL,ANIMATIONS.FADEIN):LeftPanel.closeSubPanel())},j=function(e,t){A("active"),t=t||ELEM_ID.FORMATPANEL,b(t),G(t),K(ELEM_ID.MAINPANELCONTAINER),K(ELEM_ID.SUBPANELCONTAINER),K(ELEM_ID.PANELCONTAINER,e)},X=function(e){h(ELEM_ID.PANELCONTAINER)&&(A("inactive"),$(ELEM_ID.PANELCONTAINER,e))},K=function(e,t){T(e,!0),t?B(e,t):w(e)},$=function(e,t){T(e,!1),t?B(e,t,C[t]):M(e)},q=function(e){var t=f();if(!t||t.panelId!=e.panelId)if(h(ELEM_ID.PANELCONTAINER))LeftPanel.showSubPanel(e.panelId,e.animationType);else{for(var i=e.parentPanels||[],o=0,r=i.length;o<r;o++){var n=i[o];ee(n),G(n)}ee(e.panelId),LayoutManager.toggleRichEdit("open",e.panelId)}},Q=function(e){if(!e)return!1;var t=f()||{};return t.panelId==e},ee=function(e){E(e)&&g()};return{init:l,closeSubPanel:Y,showSubPanel:V,closeDynamicPanel:W,findPanelObj:d,getPanelDetails:s,toggleLeftPanel:y,showPanelContainer:j,hidePanelContainer:X,getCurrentPanel:f,isContainerVisible:h,getPanelWidth:m,showAdvancedPanel:q,isPanelVisible:Q}}(),PanelUtil=function(){var e={"subpanel-para":["fmt-sub-pnl-layout","fmt-lpnl-borderoptions"],"subpanel-pagelayout":["subpanel-pagelayout"],"subpanel-img":["subpanel-img"],"subpanel-table":["table_properties","tbl-prop-bdr-container"]},t=function(){LayoutManager.isRichEditActive()&&(LeftPanel.showSubPanel(ELEM_ID.HEADEROPTIONSPANEL,ANIMATIONS.FADEIN),CustomHdrFtr.updateHeaderFooterPanel()),J("#menu-headerfooter-parent").css("display","block")},i=function(){if(!editor.isFinalDocument()){UIUtils.initComponent("menuHeaderFooter");LeftPanel.getCurrentPanel();LeftPanel.findPanelObj(ELEM_ID.HEADEROPTIONSPANEL)>=0?LeftPanel.closeDynamicPanel(ELEM_ID.HEADEROPTIONSPANEL):(LayoutManager.isRichEditActive()?LeftPanel.showSubPanel(ELEM_ID.HEADEROPTIONSPANEL,ANIMATIONS.FADEIN):LayoutManager.toggleRichEdit("open",ELEM_ID.HEADEROPTIONSPANEL),CustomHdrFtr.updateHeaderFooterPanel())}},o=function(e,t){if(e){var i,o=t||window.event,r=J(o.srcElement||o.target);i=r.parents(".header_primary").next()[0]||r.parents(".footer_primary").prev()[0],i=J(i),EventHandler.setActivePageAndSection(J(i),o.x,o.y);var n=EventHandler.getIndex(o,editor.clientActiveSection,o.x,o.y),a=editor.doc.createRange(n);editor.doc.getSelection().removeAllRanges().addRange(a),EventHandler.toggleSection(),editor.prevClientActiveSection=editor.clientActiveSection,PubSub.publish("Document/SwitchSection")}LeftPanel.closeDynamicPanel(ELEM_ID.HEADEROPTIONSPANEL),J("#menu-headerfooter-parent").css("display","none")},r=function(){var e=editor.doc.getSelection(),t=editor.doc.getParents(NODE_TYPE.TABLE,e.getTargetRange().start),i=editor.doc.getParents(NODE_TYPE.IMAGE,e.getLastRange().start);t&&t.attr().theme&&!t.attr().theme.themeName?J("#micro-tool-theme-clr").hide():J("#micro-tool-theme-clr").show(),editor.isEditable()&&t&&!i||e.isTableSelected()?(J("#menu-table-parent, #tablePropWrapper").show(),n(),TableResize.updateTableResizeIcon(t)):(J("#menu-table-parent, #tablePropWrapper, #tableResizeIconDiv, #tableResizeGridDiv").hide(),TablePanel.close(),LeftPanel.closeDynamicPanel(ELEM_ID.TABLETHEMEPANEL))},n=function(){var e=editor.doc.getSelection(),t=editor.doc.getParents(NODE_TYPE.TABLE,e.getTargetRange().start);if(t){var i=ViewManager.getViewElements(t.dtNode,editor.getPageID());if(i){var o=J(i).offset()||ZERO_RECT,r=o.left-editor.editorOffset.left-Z("tablePropWrapper").width()-26,n=o.top-editor.editorOffset.top;Z("tablePropWrapper").css({left:r,top:n})}}},a=function(){LeftPanel.findPanelObj(ELEM_ID.TABLEOPTIONSPANEL)>=0?TablePanel.close():TablePanel.open()},l=function(){Widget.clearFields();var e={panelId:ELEM_ID.EMBEDOPTIONPANEL,animationType:ANIMATIONS.FLIPIN,parentPanels:[ELEM_ID.INSERTPANEL]};LeftPanel.showAdvancedPanel(e)},s=function(){J("#dragdropDiv").fadeIn(function(){J("#dragDiv").effect("bounce",{times:2},1e3)})},d=function(){var e={panelId:ELEM_ID.TABLETHEMEPANEL,animationType:ANIMATIONS.FLIPIN,parentPanels:[ELEM_ID.TABLEOPTIONSPANEL]};LeftPanel.showAdvancedPanel(e)},c=function(){return e},p=null,u=null,f=function(e){clearTimeout(u),p=e,u=setTimeout(function(){p=null},3e3)};return{toggleHeaderFooter:i,openHeaderFooter:t,closeHeaderFooter:o,toggleTableOptions:r,showEmbedOptions:l,handleTablePropWrapper:a,updateTablePropWrapperPos:n,showDragAndDropContainer:s,getRefreshPanel:c,activeLeftPanelSpinner:p,setActiveLeftPanelSpinner:f,showMoreTableThemes:d}}(),TopbandHandler=function(){"use strict";var e,t={},i={TOPBANDCONTAINER:"topband",DEFAULTTOPBANDCONTAINER:"topband-default",HISTORYTOPBANDCONTAINER:"topband-history",HISTORYDIFFTOPBANDCONTAINER:"topband-history-compare",MAILMERGETOPBANDCONTAINER:"topband-mailmerge",PRINTPREVIEWTOPBANDCONTAINER:"topband-printpreview",TOOLBARCONTAINER:"toolbar-container",REVIEWTOOLBARCONTAINER:"review-tb",FINISHMODETOOLBARCONTAINER:"complete-tb",PREVIEWTOOLBARCONTAINER:"previewToolbar_container",VERSIONHISTORYCONTAINER:"history-versionpane",MMPREVIEWCONTAINER:"mmpreview-toolbarcontainer",READONLYTOOLBARCONTAINER:"readonly-tb",READCOMMENTTOOLBARCONTAINER:"readcomment-tb",TOOLBARTOGGLEBTN:"toolbar-toggle-div",VERSIONVIEWTOPBANDCONTAINER:"topband-versionview",VERSIONVIEWTOOLBARCONTAINER:"toolbar-versionview"},o=function(){jQuery.extend(ELEM_ID,i)},r=function(e){var i=t[e];return i&&i.visible},n=function(e,i){t[e]||(t[e]={}),t[e].visible=i},a=function(e){var t=Z(ELEM_ID.TOPBANDWRAPPER)[0];r(ELEM_ID.TOPBANDWRAPPER)||(t.style.display="block",n(ELEM_ID.TOPBANDWRAPPER,!0)),Z(e).css("display","block"),n(e,!0),R(t.offsetHeight)},l=function(e){r(ELEM_ID.TOPBANDCONTAINER)||a(ELEM_ID.TOPBANDCONTAINER),a(e)},s=function(e){r(ELEM_ID.TOOLBARCONTAINER)||a(ELEM_ID.TOOLBARCONTAINER),a(e)},d=function(e){Z(e).css("display","none"),n(e,!1);var t=0;0!=Z(ELEM_ID.TOPBANDWRAPPER).length&&(t=Z(ELEM_ID.TOPBANDWRAPPER)[0].offsetHeight),R(t)},c=function(e){d(ELEM_ID.TOPBANDCONTAINER),d(e)},p=function(e){r(ELEM_ID.TOOLBARTOGGLEBTN)||d(ELEM_ID.TOOLBARCONTAINER),d(e)},u=function(){r(ELEM_ID.TOOLBARCONTAINER)||a(ELEM_ID.TOOLBARCONTAINER),a(ELEM_ID.TOOLBARTOGGLEBTN)},f=function(){d(ELEM_ID.TOOLBARTOGGLEBTN)},g=function(e){e?Z(ELEM_ID.TOOLBARTOGGLEBTN).removeClass("ui-toolbarhide-btn-hide").addClass("ui-toolbarhide-btn-show"):Z(ELEM_ID.TOOLBARTOGGLEBTN).removeClass("ui-toolbarhide-btn-show").addClass("ui-toolbarhide-btn-hide")},m=function(e,i){t[e]||(t[e]={}),t[e].hiddenByUser=i,g(i)},h=function(e){var e=t[e];return e&&e.hiddenByUser},T=function(){var e=LayoutManager.getCurrentToolbar(),t=e&&h(e);t?s(e):p(e),m(e,!t),editor.onResize()},E=function(){return e},R=function(t){e=t};return{init:o,getBandHeight:E,showToolbar:s,hideToolbar:p,showTopband:l,hideTopband:c,isElemVisible:r,toggleToolbar:T,getToolbarState:h,updateHideBtnState:g,showToolbarHideBtn:u,hideToolbarHideBtn:f}}(),ModeManager=function(){var e="",t=["topband-compose","topband-collaborate","topband-complete"],i=function(){return e},o=function(t){var i=editor.doc.getRole();"STOREAGE_SERVICE_READER"!=i&&"ANYONELINK_SHAREDREADCOMMENT"!=i&&"SHAREDREAD"!=i&&"SHAREDREADCOMMENT"!=i&&"REMOTEVIEW"!=i&&"REMOTECOLLABVIEW"!=i&&"REMOTECOLLABEDIT"!=i&&"REMOTEEDIT"!=i&&"TEMPLATE_USER"!=i&&"MAILMERGE_LIBRARY"!=i&&"CRM_VERTICAL_MAILMERGE_LIBRARY"!=i&&"ZFORMS_TEMPLATE"!=i&&n(e,t),e=t},r=function(){var e=editor.doc.getUserData(),t=e[editor.zuid].editor_mode;o(t),LayoutManager.loadLayout(LayoutManager.getLayoutType())},n=function(e,i){e&&Z(t[e-1]).removeClass("ui-topband-mode-seleted");var o=Z(t[i-1])[0].offsetLeft,r=Math.ceil(Z(t[i-1])[0].getBoundingClientRect().width);Z(t[i-1]).css("width",r),Z("topband-activemode").css({left:o,width:r}),Z(t[i-1]).addClass("ui-topband-mode-seleted")},a=function(e){var t=i();e!=t&&(o(e),LayoutManager.loadLayout(e),l(e))},l=function(e){if(!("REMOTE"==editor.getEditorType()||ZWOffline.isOfflineSetupDone&&(ZWOffline.handleEditorModeChange(e),editor.isOffline()))){var t=editor.doc.getDocInfo(),i={};i.rid=t.RID,i.mode=e,Utils.setCsrfParam(i),J.ajax({type:"POST",url:Utils.getNiceUrlPrefix("user/settings/switchmode"),data:i,success:function(e){},error:function(e){}})}};return{getCurrentMode:i,setCurrentMode:o,loadUserEditorMode:r,switchMode:a}}();PopupHandler=function(){"use strict";var e={},t=function(e){for(var t=0,i=e.length;t<i;t++)o(e[t].elemId,e[t].obj)},i=function(t){t=t||e;var i;for(i in t)r(i)},o=function(t,i){t&&i&&(e[t]={open:i.open,close:i.close,beforeOpen:i.beforeOpen,togglePin:i.togglePin,openMoreOptions:i.openMoreOptions,visible:i.visible||!1,pinned:i.pinned||!1,timeDelay:i.timeDelay||1,popupTimer:null})},r=function(t){delete e[t]},n=function(){return Object.keys(e).length},a=function(t,i){e[t].visible=i},l=function(t,i){e[t].pinned=i,e[t].togglePin(i)},s=function(t){l(t,!e[t].pinned)},d=function(t){return e[t]&&e[t].visible},c=function(t){return e[t]&&e[t].pinned},p=function(t){e[t].popupTimer&&clearTimeout(e[t].popupTimer)},u=function(t,i){e[t]&&(e[t].visible?f(t):(clearTimeout(e[t].popupTimer),m(),e[t].beforeOpen(),e[t].popupTimer=setTimeout(function(){var o=e[t].open(i);a(t,o),"smartToolbar"!=t&&Utils.addToStatistics("4.0_tools_"+t)},e[t].timeDelay)))},f=function(t){if(e[t])return!(!e[t].visible||e[t].pinned)&&(clearTimeout(e[t].popupTimer),e[t].close(),a(t,!1),!0)},g=function(t){e[t]&&e[t].visible&&(clearTimeout(e[t].popupTimer),l(t,!1),e[t].close(),a(t,!1))},m=function(){var t;for(t in e)f(t)},h=function(t){PopupHandler.closeAllPopup(),e[t].openMoreOptions(),Utils.addToStatistics("4_0_"+t+"_moreoptions")};return{addPopup:o,removePopup:r,getNumberOfPopups:n,setVisibleStatus:a,setPinnedStatus:l,togglePinnedStatus:s,initialize:t,destroy:i,isVisible:d,isPinned:c,openPopup:u,closePopup:f,forceClosePopup:g,closeAllPopup:m,openMoreOptions:h,clearTimeOut:p}}();var SmartToolbar=function(){var e,t,i,o,r,n,a,l,s=!1,d="",c={SMARTTOOLBAR:"smartToolbar"},p={text:{hideList:["smartTableOption"],disableList:[]},table:{hideList:["smart-cmt-link-set"],disableList:[]},list:{hideList:["smartTableOption","smart-cmt-link-set"],disableList:[]},tableCollaped:{hideList:[],disableList:["smart_cell_merge"]}},u=function(){var i=editor.doc.getRole();return"ANYONELINK_SHAREDREADCOMMENT"==i||"SHAREDREAD"==i||"SHAREDREADCOMMENT"==i||"REMOTEVIEW"==i||"REMOTECOLLABVIEW"==i||!editor.isEditable()||editor.subAction&&editor.subAction.version||(PopupHandler.addPopup(c.SMARTTOOLBAR,{open:m,close:h,destroy:f,beforeOpen:g,togglePin:T,openMoreOptions:E,visible:!1,pinned:!1,timeDelay:150,popupTimer:null}),l=!0,s=!0,e=Z(c.SMARTTOOLBAR),t=Z("smart_pin"),Toolbar.addToolsetToCollection(c.SMARTTOOLBAR,p),R()),s},f=function(){return PopupHandler.forceClosePopup(c.SMARTTOOLBAR),Toolbar.removeToolsetFromCollection(c.SMARTTOOLBAR),S(),s=!1,PopupHandler.removePopup(c.SMARTTOOLBAR),s},g=function(){},m=function(t){var i=editor.doc.getSelection();if(i.isCollapsed()||J(".ui-vertical-sub-nav").hasClass("ui-show-menu")||EventHandler.isOnlyCtrlKeyPressed)return!1;var o=i.getTargetRange(),r=editor.doc.getRawFormatAt(o.start),n=editor.doc.getRawFormatAt(o.end-UNICODE.RANGE_END.length),a=r&&r.type,s=n&&n.type;return(a!=NODE_TYPE.PLACEHOLDER||s!=NODE_TYPE.PLACEHOLDER)&&(e.zpopover("open",N(t)),Toolbar.updateToolbar(),l=i.selectionType!==SEL_KEYBOARD,e.css({opacity:"1.0"}),L(),!0)},h=function(){e.zpopover("close")},T=function(e){e?t.removeClass("ui-icon-context-pin-sm").addClass("ui-icon-context-unpin-sm"):t.removeClass("ui-icon-context-unpin-sm").addClass("ui-icon-context-pin-sm")},E=function(){LayoutManager.isRichEditActive()?LeftPanel.showSubPanel(ELEM_ID.FORMATPANEL,ANIMATIONS.FADEIN):LayoutManager.toggleRichEdit("open",ELEM_ID.FORMATPANEL)},R=function(){e.draggable({containment:"#mainOuterDiv",enable:"enable",start:function(e){l=!1},stop:function(e){l=!0,L()}}),PubSub.subscribe("Editor/WheelEvent",P),PubSub.subscribe("Document/MouseMove",_),PubSub.subscribe("Cursor/Selected",y,{async:!0,timeout:100}),PubSub.subscribe("Cursor/Collapsed",O,{async:!0,timeout:100}),e.bind("click",C),e.bind("zpopoverbeforeclose",D),Z("smart_cell_merge").bind("click",I)},S=function(){e.draggable("destroy"),PubSub.unsubscribe("Editor/WheelEvent",P),PubSub.unsubscribe("Document/MouseMove",_),PubSub.unsubscribe("Cursor/Selected",y,{async:!0}),PubSub.unsubscribe("Cursor/Collapsed",O,{async:!0}),e.unbind("click",C),e.unbind("zpopoverbeforeclose",D),Z("smart_cell_merge").unbind("click",I)},O=function(){PopupHandler.isVisible(c.SMARTTOOLBAR)&&(v(),A())},v=function(){var t=editor.doc.getSelection();if(t.selectionType===SEL_AUTO_GEN||t.selectionType===SEL_OP_GEN)return!0;var i="text";if(!t.isMultipleSelection)if(t.isListItemSelection)i="list";else if(t.isTableSelected()&&!t.isCellSelection)i="table";else{var o=editor.doc.getParents(NODE_TYPE.TABLE,t.getTargetRange().start);o&&(i="tableCollaped")}Toolbar.updateToolset(c.SMARTTOOLBAR,d,i),d=i,e.css({width:"auto"}),e.css({width:e.outerWidth()})},b=function(t,i){var o=parseFloat(e.css("left")),r=e.outerWidth(),n=o+r,a=J(window).width(),l=J("#"+i),s=l.outerWidth(!0),d=l.css("display");if("show"==t&&"none"==d){if(n+=s,n>a){var c=n-a;o-=c}Z(i).show()}else"hide"==t&&"block"==d&&(n==a&&(o+=s),Z(i).hide());var p=o+"px";e.css({left:p,width:"auto"}),e.css({width:e.outerWidth()})},A=function(){var e=editor.doc.getSelection().parents(NODE_TYPE.CELL);if(e){var t=e.attr(),i=t[ATTR_CELL.TDS_TXTAL];i=i?i:"left";var o=t[ATTR_CELL.TDS_VA];o=o?o:"middle";var r=o+i;Z("smart-table_cellalignment").zcombo("setValue",r)}},y=function(){v()||PopupHandler.isVisible(c.SMARTTOOLBAR)||PopupHandler.openPopup(c.SMARTTOOLBAR)},D=function(e){return!PopupHandler.isPinned(c.SMARTTOOLBAR)},C=function(e){l=!1},I=function(e){PopupHandler.closePopup(c.SMARTTOOLBAR)},P=function(){PopupHandler.closePopup(c.SMARTTOOLBAR)},_=function(e){var t=editor.doc.getRole();"ANYONELINK_SHAREDREADCOMMENT"!=t&&"SHAREDREAD"!=t&&"SHAREDREADCOMMENT"!=t&&"REMOTEVIEW"!=t&&"REMOTECOLLABVIEW"!=t&&editor.isEditable()&&PopupHandler.isVisible(c.SMARTTOOLBAR)&&!PopupHandler.isPinned(c.SMARTTOOLBAR)&&SmartToolbar.addSmartness(e)},N=function(t){var i=0,o=0,r=e.outerWidth(),n=e.outerHeight(),a=65,l=20,s={},d={};t?(s.rects=t,d.rects=t):(s=CurUtil.offset.start,d=CurUtil.offset.end);var c=Z(ELEM_ID.EDITOROUTERDIV),p=c.offset(),u={};u.top=p.top,u.bottom=u.top+c.height(),u.bottom-d.rects.bottom>n+l&&d.rects.bottom>u.top?(o=d.rects.bottom+l,i=d.rects.right):s.rects.top-u.top>n+l&&s.rects.top<u.bottom?(o=s.rects.top-n-l,i=s.rects.left):(o=p.top,i=p.left);var f=window.innerWidth-(i+a);return f<r&&(i=window.innerWidth-(r+a)),{position:{left:i,top:o},width:0,height:0}},L=function(){i=e[0].getBoundingClientRect(),o=i.left,r=i.right,n=i.top,a=i.bottom},w=function(t){if(l){var i=t.clientX,s=t.clientY;e.stop(),i>=o-40&&i<=r+40&&s>=n-40&&s<=a+40?e.css({opacity:"1.0"}):i>=o-200&&i<=r+200&&s>=n-200&&s<=a+200?e.animate({opacity:"0.5"},"speed"):i>=o-300&&i<=r+300&&s>=n-300&&s<=a+300&&e.animate({opacity:"0.0"},"speed",function(){PopupHandler.closePopup(c.SMARTTOOLBAR)})}},M=function(){UserPreferences.isPrefered("smarttoolbar")?s||u():s&&f()};return PubSub.subscribe("UIEvents/UserPreferenceUpdated",M),{init:u,open:m,destroy:f,beforeOpen:g,close:h,togglePin:T,openMoreOptions:E,addSmartness:w,updateSmartToolbarPositionIfPinned:b}}(),ParaPropertiesMenu=function(){var e=function(){PopupHandler.addPopup("paraPropMenu",{open:i,close:o,beforeOpen:r,togglePin:d,openMoreOptions:c,visible:!1,pinned:!1,timeDelay:1,popupTimer:null}),l()},t=function(){PopupHandler.forceClosePopup("paraPropMenu"),s(),PopupHandler.removePopup("paraPropMenu")},i=function(){Z("microandparaVCContainer").addClass("ui-paraoption-active");var e=Z("paraPropMenu").outerWidth(),t=Z("parapropbtndiv").outerWidth(),i=(Z("microandparaVCContainer").outerWidth(),editor.editorPaneContainer.outerHeight()+editor.editorPaneContainer.scrollTop()-(Z("microandparaVCContainer")[0].offsetTop+Z("paraPropMenu").outerHeight()+t)),o={left:t/2,top:t/2};return editor.widthVariant>e&&(o.left-=e),i<0&&(o.top=i),Z("paraPropMenu").css(o),!0},o=function(){Z("microandparaVCContainer").removeClass("ui-paraoption-active")},r=function(){},n=function(){},a=function(){},l=function(){},s=function(){},d=function(e){},c=function(){ParagraphPanel.open()};return{init:e,open:i,close:o,destroy:t,beforeOpen:r,togglePin:d,openMoreOptions:c,changePosition:n,handleScroll:a}}(),InlineInsertMenu=function(){var e,t,i=function(){PopupHandler.addPopup("inlineInsert",{open:r,close:n,beforeOpen:a,togglePin:d,openMoreOptions:u,visible:!1,pinned:!1,timeDelay:500,popupTimer:null}),e=document.getElementById("inlineInsert"),t=J(e),PubSub.subscribe("Document/CharInserted",o)},o=function(e){"@"==e?PopupHandler.openPopup("inlineInsert"):PopupHandler.clearTimeOut("inlineInsert")},r=function(){var i=l();return e.style.display="block",t.off("keydown.run").on("keydown.run",function(e){var i=e&&(e.target||e.srcElement),o=e.keyCode;o!=$.ui.keyCode.LEFT&&o!=$.ui.keyCode.UP&&o!=$.ui.keyCode.RIGHT&&o!=$.ui.keyCode.DOWN&&o!=$.ui.keyCode.ENTER||(t.zmenu("handleKeyCode",o,i),e.preventDefault(),e.stopPropagation())}),t.off("keypress").on("keypress",function(e){var t=(e&&(e.target||e.srcElement),e.keyCode);PopupHandler.closePopup("inlineInsert");var i=jQuery.Event("keypress");i.which=t,i.keyCode=t,J(editor.jMbSpan_editableSpan).trigger(i),e.preventDefault(),e.stopPropagation()}),e.style.top=i.top+"px",e.style.left=i.left+"px",t.focus(),!0},n=function(){e.style.display="none",EditorUtil.focusMultiByteSpan()},a=function(){},l=function(){var e=editor.doc.getDomCursorNode(editor.uuid,editor.zuid,"start"),t=s(e);return t.top=t.top+t.height,t},s=function(e){var t=editor.jeditorPane.offset(),i=e.offset(),o=e.height(),r=i.left-t.left,n=i.top-t.top;return{left:r,top:n,height:o}},d=function(e){},c=function(e){p(),"image"==e?Imagelibrary.openInsertImgDlg():"table"==e?TableInsertDlg.openTablePopup():"link"==e?LinkDialog.openLinkPopup():"bookmark"==e?BookmarkDialog.openBookmarkPopup():"comment"==e&&CommentManager.newComment()},p=function(){var e=[{r:editor.doc.getSelection().getStart()-1},{ds:editor.doc.getCharAt(editor.doc.getSelection().getStart()-1)}];Op.processMsg(e),Op.sendMsg()},u=function(){p(),UIUtils.initComponent("menuInsert"),LayoutManager.isRichEditActive()?LeftPanel.showSubPanel(ELEM_ID.INSERTPANEL,ANIMATIONS.FADEIN):LayoutManager.toggleRichEdit("open",ELEM_ID.INSERTPANEL)};return{init:i,open:r,close:n,beforeOpen:a,togglePin:d,openMoreOptions:u,handleInsert:c}}(),MicroToolbar=function(){var e,t=!1,i=function(){var e=editor.doc.getRole();return"ANYONELINK_SHAREDREADCOMMENT"!=e&&"SHAREDREAD"!=e&&"SHAREDREADCOMMENT"!=e&&"REMOTEVIEW"!=e&&"REMOTECOLLABVIEW"!=e&&editor.isEditable()&&(PopupHandler.addPopup("microtoolbardialog",{open:c,close:p,destroy:o,beforeOpen:u,togglePin:m,openMoreOptions:h,visible:!1,pinned:!1,timeDelay:1,popupTimer:null}),t=!0,Z("microandparaVCContainer").show(),Z("microandparaVCContainer").on("mouseover",function(){J(this).css({opacity:1})}).on("mouseout",function(){J(this).css({opacity:.2})}),g(),r(),ParaPropertiesMenu.init()),t},o=function(){return PopupHandler.forceClosePopup("microtoolbardialog"),Z("microandparaVCContainer").hide(),n(),t=!1,PopupHandler.removePopup("microtoolbardialog"),ParaPropertiesMenu.destroy(),t},r=function(){Z("microtoolbar").bind("menuitemclicked",a),PubSub.subscribe("Document/ScrollEvent",T),PubSub.subscribe("Cursor/LineChanged",s),PubSub.subscribe(["UiEvents/EditorParentOffsetChanged","Document/view/changed"],g),PubSub.subscribe("Cursor/Selected",d,{async:!0,timeout:100}),PubSub.subscribe("Document/EditPermissionChanged",l)},n=function(){Z("microtoolbar").unbind("menuitemclicked",a),PubSub.unsubscribe("Document/ScrollEvent",T),PubSub.unsubscribe("Cursor/LineChanged",s),PubSub.unsubscribe(["UiEvents/EditorParentOffsetChanged","Document/view/changed"],g),PubSub.unsubscribe("Cursor/Selected",d,{async:!0}),PubSub.unsubscribe("Document/EditPermissionChanged",l)},a=function(e){PopupHandler.closePopup("microtoolbardialog")},l=function(e){UIUtils.hideWrappers(!e)},s=function(){setTimeout(function(){g()},10)},d=function(){editor.doc.getSelection().selectionType&&!editor.doc.getSelection().isMultipleSelection&&g(!0)},c=function(){Z("microandparaVCContainer").addClass("ui-microtool-active");var e=Z("microtoolbar").outerWidth(),t=Z("microtoolbarbtndiv").outerWidth(),i=editor.editorPaneContainer.outerHeight()+editor.editorPaneContainer.scrollTop()-(Z("microandparaVCContainer")[0].offsetTop+Z("microtoolbar").outerHeight()+t),o={left:t/2,top:t/2};return editor.widthVariant>e&&(o.left-=e),i<0&&(o.top=i),Z("microtoolbardialog").css(o),!0},p=function(){Z("microandparaVCContainer").removeClass("ui-microtool-active")},u=function(){},f=function(){var e=Conversions.toPixels(PUtil.getMargin().left)*editor.zoomFactor-4*Z("microtoolbarbtndiv").outerWidth(),t=CurUtil.offset.start.top*editor.zoomFactor,i=editor.doc.getSelection();try{var o=i.getNodesInSelection(NODE_TYPE.PARAGRAPH)[0].parentNode();"cell"==o.type&&(e-=Z("tablePropWrapper").width())}catch(e){}return{top:t,left:e}},g=function(i){if(t){var o=f();i&&(o.top=UIUtils.getVisibleAreaTop()),clearTimeout(e),e=setTimeout(function(){Z("microandparaVCContainer").css(o)},500)}},m=function(e){},h=function(){UIUtils.initComponent("menuInsert"),LayoutManager.isRichEditActive()?LeftPanel.showSubPanel(ELEM_ID.INSERTPANEL,ANIMATIONS.FADEIN):LayoutManager.toggleRichEdit("open",ELEM_ID.INSERTPANEL)},T=function(){},E=function(){UserPreferences.isPrefered("para_microtoolbar")?t||i():t&&o()};return PubSub.subscribe("UIEvents/UserPreferenceUpdated",E),{init:i,open:c,close:p,destroy:o,beforeOpen:u,togglePin:m,openMoreOptions:h,changePosition:g}}(),UserPreferences=function(){var e,t={smarttoolbar:{val:1,isAllowed:!0,storeWhenDisabled:!0},para_microtoolbar:{val:2,isAllowed:!0,storeWhenDisabled:!0},ruler:{val:4,isAllowed:!1,storeWhenDisabled:!1}},i=function(){e=parseInt(w_usersettings.disabled_tools);for(var i in t){var o=t[i],r=e&o.val;o.isAllowed=o.storeWhenDisabled?!r:!!r}PubSub.publish("UIEvents/UserPreferenceUpdated")},o=function(){return t},r=function(){return e},n=function(e){return t[e].isAllowed},a=function(i,o){var r=t[i].storeWhenDisabled,n=t[i].val;r?1==o?e-=n:e+=n:1==o?e+=n:e-=n,t[i].isAllowed=o},l=function(e){for(var i in e){var o=e[i];if(t[i].isAllowed!=o){var n=o===!0?"_enabled":"_disabled";Utils.addToStatistics(i+n),a(i,o)}}return r()};return PubSub.subscribe(["Document/FirstTimeComponentReady","Settings/Saved"],i),{getDecodedPreferences:o,isPrefered:n,handleUserPrefChange:l}}(),OBController=function(){"use strict";var e,t,i,o,r,n={},a={},l={},s=0,d=!1,c=!1,p=function(){e=Handlebars.compile(J("#onboard-help").html()),t=Handlebars.compile(J("#onboard-help-mini").html()),i=Handlebars.compile(J("#onboard-help-event").html())},u=function(){var e=editorProps.userInfo.settings.tourInfo;if(e&&e.length){var t={},i=Utils.getContextUrl("jsp/help/onboardhelptemplates.jsp");J.ajax({type:"GET",url:i,data:t,success:function(e,t,i){var o=document.createElement("div");o.innerHTML=e.trim(),J("body").append(J(o)),OBController.initViews()},error:function(){}})}},f=function(){var e=editorProps.userInfo.settings.tourInfo;e&&e.length&&(p(),r=J("#onboardoverlay"),J.each(editorProps.userInfo.settings.tourInfo,function(e,t){editorProps.tourInfo[t]&&(n[t]=editorProps.tourInfo[t])}),J.isEmptyObject(n)||(jQuery.extend(a,n),g(),r.show().css("background","rgba(0, 0, 0, 0)")))},g=function(){J.each(n,function(e,t){this.callBacks.beforeOpen.action&&("hamburger"==this.name&&(Z(ELEM_ID.MAINOUTERDIV).bind(TransitionEndEvent,b),c=!0),E(this))}),c||setTimeout(m,10)},m=function(){J.each(n,function(e,t){h(e)}),s<1?r.hide():r.css("background","rgba(0, 0, 0, 0.4)"),J(".ui-wtour-btn").off("click").on("click",S)},h=function(a){l=editorProps.tourInfo[a];var d,c="select"==l.data.eleType?J("div[popup=combo_"+l.associatedEleId.parent+"Menu]"):"#"+l.associatedEleId.parent;if(l.type&&"otg"==l.type)o=t(l),d=J(o).data("id",a),J("body").append(d),J(c).append(d.css({width:d.width()+1,position:"absolute"})),d.hide(),J("#"+l.callBacks.bind.element).on(l.callBacks.bind.event,function(e){var t=d.data("id"),i=editorProps.tourInfo[t];d.show().position({of:c,at:i.position.parent,my:i.position.self}),setTimeout(function(){O(d)},4e3),J(this).off(e.type)});else if(l.type&&"otg-event"==l.type){o=i(l),d=J(o).data("id",a);var p=J(c);void 0==l.callBacks.bind.open?(p.append(d.css({position:"absolute","pointer-events":"none"})),d.position({of:c,at:l.position.parent,my:l.position.self})):J("#"+l.callBacks.bind.open.element).on(l.callBacks.bind.open.event,function(e){setTimeout(function(){var e=d.data("id");if(void 0!=n[e]){var t=editorProps.tourInfo[e];p.append(d.css({position:"absolute","pointer-events":"none"})),d.position({of:c,at:t.position.parent,my:t.position.self})}},1e3)}),p.on(l.callBacks.bind.close.event,function(e){O(d)})}else if(l.type&&"tour-event"==l.type){var u=J("#onboard-tour-container"),f=u.find(l.callBacks.bind.close.element);f.data({id:a,tourContainer:u.attr("id")}),J(l.associatedEleId.parent).append(u.show()),v(a),f.on(l.callBacks.bind.close.event,function(e){var t=J(e.target||e.srcElement),i=t.data("tourContainer"),o=J("#"+i);o.remove()})}else s++,o=e(l),J(c).length>0&&(d=J(o).data("id",a),r.append(d),d.position({of:c,at:l.position.parent,my:l.position.self}))},T=function(e){l=editorProps.tourInfo[e[0]],setTimeout(function(){h(e[0])},10),r.show()},E=function(e){if(e.callBacks.beforeOpen.action){var t=e.callBacks.beforeOpen.params,i=Utils.getAsFunction(e.callBacks.beforeOpen.action);i.callable(t)}},R=function(){J.each(a,function(e,t){if(this.callBacks.beforeOpen.action){var i=this.callBacks.beforeOpen.params,o=Utils.getAsFunction(this.callBacks.beforeOpen.action);o.callable(i)}})},S=function(){var e=J(this).parent().parent(),t=e.data().id;delete n[t],e.remove(),s--,s<=0&&(R(),r.hide(),d=!1,s=0),v(t)},O=function(e){var t=J(e),i=t.data().id;delete n[i],t.remove(),v(i)},v=function(e){var t={id:e};"REMOTE"==editor.getEditorType()&&(t.rsid=RemoteEditor.rsid),t.rid=editor.doc.docInfo.RID,J.ajax({type:"POST",url:Utils.getContextUrl("tour/gotit"),data:t,error:function(e){if(500===e.status){var t=jQuery.parseJSON(J.trim(e.responseText));t&&t.errorCode&&"I5003"===t.errorCode&&(hipurl=t.parameterName,Utils.handleCaptcha(hipurl))}}})},b=function(e){LayoutManager.isRichEditActive()&&(m(),Z(ELEM_ID.MAINOUTERDIV).unbind(TransitionEndEvent,b))};return{initViews:f,initialize:u,createHelp:h,initializeOB:b,createContextHelp:T}}(),FetchHTML=function(){"use strict";var e={},t=function(t){var o=t.requestName,r=e[o];if(r){if(r.isRequestPending)return!1;r.isFetched?r.callback&&r.callback():i(o)}else e[o]={isFetched:!1,isRequestPending:!1,target:t.target||document,callback:t.callback},i(o)},i=function(t){e[t].isRequestPending=!0,J.ajax({type:"get",url:Utils.getNiceUrlPrefix("popup/"+t),data:UIUtils.getHTMLRequestParam(),error:function(){e[t].isRequestPending=!1},success:function(i){J(e[t].target).append(i),e[t].isRequestPending=!1,e[t].isFetched=!0,e[t].callback&&e[t].callback()}})};return{get:t}}();UIEventHandler=function(){var e=function(){PopupHandler.closeAllPopup(),PubSub.publish("UIEvent/PopupClosed")},t=function(){e(),EditorUtil.focusMultiByteSpan(),CurUtil.blinkCursor()},i=function(){LayoutManager.isRichEditActive()&&TablePanel.open()},o=function(){var e=editor.doc.getRole();"ANYONELINK_SHAREDREADCOMMENT"!=e&&"SHAREDREAD"!=e&&"SHAREDREADCOMMENT"!=e&&"REMOTEVIEW"!=e&&"REMOTECOLLABVIEW"!=e&&editor.isEditable()&&(HandleTheme.updateColorPalete(),LeftPanel.init(),InlineInsertMenu.init(),MarkAsFinal.checkForEdit(),Dates.bindevents(),HandleTheme.updateCombos()),"SHAREDREAD"!=e&&"SHAREDREADCOMMENT"!=e||LeftPanel.init(),TopbandHandler.init(),EditorLayout.init(),editor.subAction&&editor.subAction.version?(LayoutManager.loadLayout(LAYOUTS.VERSIONVIEW),HistoryUI.loadVersionView(editor.subAction.version)):editor.subAction&&editor.subAction.compare?HistoryUI.loadVersionDiffPage(editor.subAction.compare.source,editor.subAction.compare.target):editor.subAction&&editor.subAction.comments&&!editor.isFinalDocument()?(ModeManager.setCurrentMode(EDITOR_MODES.COLLABORATE),LayoutManager.loadLayout(LayoutManager.getLayoutType())):ModeManager.loadUserEditorMode(),"WORKSPACE_CRMLIB_EDITOR"!=e&&"ANYONELINK_SHAREDREADWRITE"!=e&&"MAILMERGE_LIBRARY"!=e&&"CRM_VERTICAL_MAILMERGE_LIBRARY"!=e&&"ZFORMS_MAILMERGE"!=e&&"ANYONELINK_SHAREDREADCOMMENT"!=e&&"SHAREDREAD"!=e&&"SHAREDREADCOMMENT"!=e&&"REMOTEVIEW"!=e&&"REMOTECOLLABVIEW"!=e&&editor.isEditable()&&!editor.isOffline()&&OBController.initialize(),"REMOTEPUBLICUSER"===e&&UIUtils.openSignupWelcome(),"MAILMERGE_LIBRARY"!=e&&"CRM_VERTICAL_MAILMERGE_LIBRARY"!=e&&"ZFORMS_TEMPLATE"!=e||MailMerge.init(),Events.bindEvents(),editor.isEditable()&&TrackChangeUI.initUI(),CommentManager.initViews()},r=function(e,t){if(e===ATTR_BODY.DS_PS){var i=EditorLayout.getPageWidth(t,null);EditorLayout.updateEditorParentOffset(i)}},n=function(e,t){var i=EditorLayout.getPageWidth(null,e);EditorLayout.updateEditorParentOffset(i),PageLayoutPanel.updatePgOrientationLabel()},a=function(){var e=PanelUtil.getRefreshPanel(),t=LeftPanel.getCurrentPanel(),i=t&&t.panelId;i&&e[i]&&J.each(e[i],function(e,t){jContainer=J("#"+t),jContainer.ZCtrackObjects("refreshValues")})},l=function(){PubSub.subscribe("Document/or/changed",n),PubSub.subscribe("Document/papersize/changed",r),PubSub.subscribe("Document/ModeClosed",e),PubSub.subscribe("Document/FirstTimeComponentReady",o);var l=editor.doc.getRole();"ANYONELINK_SHAREDREADCOMMENT"!=l&&"SHAREDREAD"!=l&&"SHAREDREADCOMMENT"!=l&&"REMOTEVIEW"!=l&&"REMOTECOLLABVIEW"!=l&&(PubSub.subscribe("Editor/MouseDown",e),PubSub.subscribe("Editor/KeyDown",e),PubSub.subscribe("DOM/ESCKeyPressed",t),PubSub.subscribe("Document/BeforeMouseDown",e),PubSub.subscribe("Document/TableInserted",i),PubSub.subscribe(["Cursor/Collapsed","Cursor/Selected"],PanelUtil.toggleTableOptions,{async:!0,timeout:100}),PubSub.subscribe("Settings/Saved",a,{async:!0,timeout:100}))};return{addSubscribers:l}}(),ImageLink=function(e){var t,i,o=(J("#link-popup"),J("#link-text"),J("#link-bookmark-conatiner"),function(){t=editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart()),i=t.attr();var o=J("#link-url").val(),r=e.getLinkType(o);if(r===LINK_TYPES.WEBURL){var n=/^((ht|f)tp(s?)\:\/\/){0,1}[-.\w]*(\/?)([a-zA-Z0-9\|\(\)~\-\.\!\?\,\:\'\/\\\+=&amp;%\$#_@\P{InBasicLatin}]*)?$/,a=encodeURI(o.trim());if(valid=n.test(a),!valid)return void J("#linkErrorMsg").show()}if(r===LINK_TYPES.WEBURL&&o.indexOf("http")===-1&&(o=editor.scheme+"://"+o),r===LINK_TYPES.MAILTO&&o.indexOf("mailto:")===-1&&(o="mailto:"+o),r===LINK_TYPES.BOOKMARK){var l=J("#link-url").attr("data-bookname");l&&(o=l)}i.linkData={url:o,type:r},editor.doc.execCmd("applyStyle",[t,i,"applyImgLink"]),J("#link-popup").hide(),Resize.selectImg()}),r=function(){t=editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart()),i=t.attr();var e=i.linkData;if(e){var o=e.type;if(o===LINK_TYPES.BOOKMARK){var r=e.url,n=/^http(s)?:\/\/.*\..*/i,a=/^www\..*\..*/i;if(n.test(r)||a.test(r))a.test(r)&&(r=editor.scheme+"://"+r),Utils.safeWindowOpen(decodeURI(r));else{var l=!0;Utils.moveToBookmark(r,l)}}else{var s=e.url;Utils.safeWindowOpen(decodeURI(s))}}},n=function(){t=editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart()),i=t.attr(),delete i.linkData.url,delete i.linkData.type,editor.doc.execCmd("applyStyle",[t,i,"removeImageLink"]);var e=editor.doc.createRange(t.getStart(),t.getEnd()),o=editor.doc.getSelection();o.removeAllRanges().addRange(e),Resize.selectImg(),ImagePanel.updateValues()};return{insert:o,goToLink:r,removeLink:n}}(LinkDialog),function(){function e(){var e=a.val().trim();e&&e!=J.i18n("writer.common.UNTITLED_DOCUMENT")?n.enable():n.disable()}function t(){function e(){J.dialogutil.close("renamedialog")}var t=J("#renamedlg").zvalidation("validateAllFields",J("#renamedlg"));if(t){var i=a.val().trim();i&&i!=J.i18n("writer.common.UNTITLED_DOCUMENT")&&Utils.renamedocument(i,e)}}function i(){J.dialogutil.close("renamedialog")}function o(){this.callback&&this.callback()}function r(e){this.callback=e,J.dialogutil.open("renamedialog",null,s),PubSub.subscribe("Dialog/BeforeClose",l)}var n,a,l=function(e){e&&e.target&&"renamedialogzdialog"==e.target.id&&(editor.doc.docInfo.newDoc&&editor.doc.getDocInfo().DOCUMENT_NAME==J.i18n("writer.common.UNTITLED_DOCUMENT")||RenameDialog.executecallback(),PubSub.unsubscribe("Dialog/BeforeClose",l))},s={init:function(t){n=J("#rename-dlg-rename"),a=J("#newDocumentNameInput"),editor.doc.docInfo.newDoc&&J("#rename-dlg-skip").hide(),n.disable(),a.off("keyup",e).on("keyup",e),setTimeout(function(){a.select()},10)},get:function(e){if("document_name"==e)return editor.doc.getDocInfo().DOCUMENT_NAME},set:function(e,t,i){if("document_name"==e.action){var o=function(){RenameDialog.rename()};UIUtils.enterKey(a,o)}}};window.RenameDialog={rename:t,skip:i,open:r,executecallback:o}}(),function(){var e=function(){var e=["OWNER","COOWNER","SHAREDREAD","SHAREDREADWRITE","EXTERNAL_SHAREDREADWRITE","STOREAGE_SERVICE_WRITER","SHAREDREADCOMMENT","WORKSPACE_CRMLIB_READER","WORKSPACE_CRMLIB_EDITOR"];return U.contains(e,editor.doc.getRole())},t=function(){var e=document.createElement("a");return void 0!==e.download},i=function(e,t,i){var o=e,r=null;for(o;o<=t;o++){var n=editor.doc.getRawFormatAt(o);!n||"image"!=n.type&&"widget"!=n.type||"bottom"!=n.al||(null==r&&(r=-1),r++)}return null==r?-1:r},o=function(e,t){if(editor.isFloatingImage(t)){var i=J(editor.clientActiveSection).find("div[fid="+t.fid+"]");d=i.find("image")[0]}else{var o,r=DocTreeManager.getTreeNodeAtIndex(e),n=ImageUtils.getDomSourceIndexOfInlineImage(r.getIndex(),e,UNICODE.IMAGE);if(J(editor.clientActiveSection).hasClass("zw-contentpane"))o=ViewManager.getViews(r);else{var a=DocUtil.getDOMSourceIndex(e,UNICODE.PARA)+1;o=[],o[0]={},o[0]={el:DomUtil.getElementAt("div.zw-paragraph",a,editor.clientActiveSection)}}var l,s=0,d=null,c=o.length;for(s=0;s<c;s++){var p=J(o[s].el).clone();p.find(".zw-float").remove(),l="widget"==t.type?p.find("div.zw-ifr-div"):p.find("image.zw-image");var u=l.length;if(n<=u-1&&(void 0!=J(o[s].el).find("image.zw-image")[n]?d=J(o[s].el).find("image.zw-image")[n]:void 0!=J(o[s].el).find(".zw-ifr-div")[n]&&(d=J(o[s].el).find(".zw-ifr-div")[n])),d)return d;n-=u}}return d};window.ImageUtils={isUserRoleDownloadAllowed:e,getDomSourceIndexOfInlineImage:i,getDomImage:o,isDownloadSupported:t}}(),function(){var e=function(){Imagelibrary.openInsertImgDlg(),J("#imagelibrary").zimagehandler("option","multiselect",!1)},t=function(){var e=editor.doc.getSelection().getLastRange();e&&e.setEnd(e.start+1),EventHandler.onCopy(),document.execCommand("copy",!1,null)},i=function(){var e=editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart()),t=e.attr("src"),i=t&&0==t.indexOf("image.do?imgurl=");return ImageUtils.isDownloadSupported()&&editor.browserInfo.is_chrome?(i&&(t=editorProps.urls.base_url+"/"+t),void o(t)):(i&&(t=editorProps.urls.base_url+"/image/"+t.replace("image.do?imgurl=","")+"/download"),void r(t))},o=function(e){var t=J("<a>").attr({href:e,download:"download.png",rel:"noreferrer",target:"_new"}).appendTo("body");t[0].click(),t[0].remove()},r=function(e){J("iframe#image-download-container").remove(),J("<iframe>",{src:e,id:"image-download-container",frameborder:"0",width:"100%",height:"100%"}).appendTo("body")},n=function(){var e,t,i={},o=editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart());if(o&&(e=o.attr().src,e.indexOf("image.do?imgurl=")!=-1)){var r=o.attr("tooltip");r&&(i.name=r),Utils.setCsrfParam(i),t=Utils.getContextUrl("image/"+e.replace("image.do?imgurl=","")+"/addtolibrary"),J.ajax({url:t,data:i,type:"POST",dataType:"json",success:a,error:l})}},a=function(e,t,i){e.STATUS?Notification.show({message:"writer.image.ADD_TO_MY_LIBRARY_SUCCESS",close:!1,setTimer:!0,type:"success"}):l(reponse)},l=function(e,t,i){Notification.show({message:"writer.image.ADD_TO_MY_LIBRARY_FAILURE",close:!1,setTimer:!0,type:"error"})},s=function(){var e,t=editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart());t&&(e=t.attr().src,e&&(0!=e.indexOf("image.do?imgurl=")&&0!=e.indexOf("remoteImage.do?imgurl=")||(e=editorProps.urls.base_url+"/"+e),Utils.safeWindowOpen(e)))},d=function(){var e=editor.doc.getParents(NODE_TYPE.IMAGE,editor.doc.getSelection().getStart());e&&(Resize.removeResizeDiv(),editor.doc.execCmd("delete",e),PubSub.publish("Document/ImageDeleted"))};window.ImageHandler={changeImage:e,copyImage:t,downloadImage:i,addToImageLibrary:n,openInNewTab:s,removeImage:d}}(),function(e){var t,i,o,r,n,a="ZW_ANNOUNCEMNENT",l={INIT:0,SEEN:1,VISITED:2},s={THUMBNAIL_LOGO:"LOGO",THUMBNAIL_VIDEO:"VIDEO",THUMBNAIL_URL:"URL"},d=!1,c=!1,p=!1,u=void 0,f=void 0,g=void 0,m=void 0,h={TIPS:{background:"ui-nalert-icontype-tips",icon:"ui-icon-tips-lg"},COMMON:{background:"ui-nalert-icontype-common",icon:"ui-icon-tips-lg"},IMAGE:{background:"ui-nalert-icontype-dynamic-image",icon:"ui-menu-dynamic-image-wt-lg"},SHAPE:{background:"ui-nalert-icontype-dynamic-shapes",icon:"ui-menu-dynamic-shapes-wt-lg"},TABLE:{background:"ui-nalert-icontype-dynamic-table",icon:"ui-menu-dynamic-table-wt-lg"},HEADER_FOOTER:{background:"ui-nalert-icontype-dynamic-headerfooter",icon:"ui-menu-dynamic-headerfooter-wt-lg"}},T=function(){return U.once(function(){ZWAnnouncement.AnnouncementModel=t=e.Model.extend({defaults:{thumbnailType:"COMMON",icon:"ui-icon-tips-lg",background:"ui-nalert-icontype-common"},initialize:function(){var e=this.toJSON();e=U.extend(e,h[e.thumbnailType]),e.time=parseInt(e.time),e.isVideo=e.thumbnailType===s.THUMBNAIL_VIDEO,this.set(e)}}),i=e.Collection.extend({model:t,comparator:function(e,t){return e.get("time")>t.get("time")?-1:1}}),o=e.View.extend({tagName:"div",el:"#announcementmenu",compiledTemplate:Handlebars.compile(J("#announcement-container-template").html()),events:{"click #announcement-more-link":"handleClick"},handleClick:function(){Utils.safeWindowOpen(UIUtils.whatsNewURL,{})},initialize:function(){this.collection.on("add reset remove",this.render,this)},render:function(){m&&m.remove(),this.$el.html(this.compiledTemplate(this.collection));for(var e=0,t=this.collection.length;e<t&&e<3;e++){var i=new r({model:this.collection.models[e]});this.$el.find("#announcement-list-container").append(i.render().el)}return this}}),ZWAnnouncement.AnnouncementItemView=r=e.View.extend({tagName:"div",compiledTemplate:Handlebars.compile(J("#announcement-item-template").html()),initialize:function(){this.model.on("change",this.render,this)},events:{click:"onItemClick","click .js-announce-close":"onCloseClicked"},onItemClick:function(e){this.model.get("isHighlight")&&(this.model.set("isHighlight",!1),ZWLocalStore.setJSONValue(a,{}),ZWAnnouncement.hideNotificationIcons(this.model),WebMessanger.closeAnnBanner()),Utils.safeWindowOpen(this.model.get("link"),{})},onCloseClicked:function(e){ZWLocalStore.setJSONValue(a,{id:this.model.get("id"),state:l.INIT}),this.remove(),e.stopPropagation()},handleImage:function(e){var t=this.model.toJSON(),i=J(e.target);i.parent().find(".ui-loading-gif").hide(),t.thumbnailType==s.THUMBNAIL_LOGO?i.width("90%"):t.thumbnailType!=s.THUMBNAIL_VIDEO&&t.thumbnailType!=s.THUMBNAIL_URL||(i.height()>i.width()?i.width("100%"):i.height("100%"),t.thumbnailType==s.THUMBNAIL_VIDEO&&J("#video-play-icon").show()),i.show()},handleImgLoadFailure:function(e){var t=J(e.target);t.attr("src",commonimgStaticURL+"images/common/OfflineImage.png")},handleRendering:function(e){return this.$el.html(this.compiledTemplate(e)),this.$el.find("img.js-img-announment").on("load",this.handleImage.bind(this)),this.$el.find("img.js-img-announment").on("error",this.handleImgLoadFailure.bind(this)),this},render:function(){return this.handleRendering(this.model.toJSON())}}),n=r.extend({tagName:"div",container:"#announcement-quick-view-container",className:"ui-nalert-imp-notifier ui-nalert-uparrow",events:{click:"handleOnClick","click .js-announce-close":"onCloseClicked"},handleOnClick:function(e){this.onItemClick(e),this.remove()},render:function(){return this.handleRendering(U.extend(this.model.toJSON(),{isClose:!0,isNew:!1,isHighlight:!1}))}})}())},E=function(){if(g){var e=g.where({isNew:!0});U.forEach(e,function(e){ZWAnnouncement.hideNotificationIcons(e)})}},R=function(){return T(),g=new i,f=new o({collection:g})},S=function(){return f||R()},O=function(){var e=[],t=J("#announcementmenu"),i={mtype:"custom",html:'<div class="ui-loading-cont"><div>'+J.i18n("writer.common.LOADING")+'</div><div class="ui-loading-gif"> </div></div>'};return e.push(i),t.zmenu("removeAllMenuItems"),t.zmenu("addMenuItems",e),v(),!0},v=function(){var e=A();J.when(e).done(b)},b=function(){var e=S(),t=g.where({isNew:!0});t.length>0&&(setTimeout(function(){ZWAnnouncement.hideNotificationIcons(t[0])},3e3),ZWLocalStore.setJSONValue(a,{id:t[0].get("id"),state:l.SEEN})),J("#announcementmenu").append(e.render().el)},A=function(){if(c)return u;if(!p)return c=!0,p=!0,u=J.ajax({type:"GET",dataType:"json",url:Utils.getNiceUrlPrefix("announcements"),success:function(e,t,i){var o=y(e.data)||[];c=!1,u=void 0,S(),g.add(o)},error:function(e,t,i){c=!1,p=!1,u=void 0}})},y=function(e){return U.filter(e,function(e){return D(e)})},D=function(e){var t=!e.allowedOrgZoids||e.allowedOrgZoids.split(",").indexOf(editor.zoid.toString())!=-1,i=!e.allowedRoles||e.allowedRoles.split(",").indexOf(editor.doc.role)!=-1;return t&&i},C=function(e){var t=J("#infomenu");t.is(":visible")?I():(t.off("menushow").on("menushow",I),$.ZContextMenu.showMenu(t,J("#topband-info"),void 0,e)),e.preventDefault(),e.stopPropagation()},I=function(e,t){setTimeout(function(){var e=jQuery.Event("mouseover");e.originalEvent=!0,J("#settin_whatsnew").trigger(e),J("#infomenu").off("menushow")},20)},P=function(e,i){var o,r=J("#infomenu");if(editorProps.browserInfo.is_macApp||!D(e))return!0;if(e=L(e),S(),g.get(e.id)?(o=g.get(e.id),o.set(e)):(e=U.defaults(e,h[e.thumbnailType]),o=new t(e),g.add(o)),e.isNew&&_(),!e.isInit)return!0;if(!r.is(":visible")){var a=J("#announcement-quick-view-container");if("high"==e.priority)m=new n({model:o}),a.empty().append(m.render().el).show();else{var l=J("#announcement-quick-view-small").show();a.hide(),l.off("click").on("click",function(e){J("#announcement-quick-view-small").hide(),ZWAnnouncement.onNotifyIconClick(e)}),setTimeout(function(){J("#announcement-quick-view-small").fadeOut()},1e4)}}},_=function(){Z("settin_whatsnew").addClass("ui-nalert-label"),Z("announce-notification-icon").show(),Z("infomenu-announce-icon").show()},N=function(e){e.set({isNew:!1,isInit:!1}),Z("settin_whatsnew").removeClass("ui-nalert-label"),Z("announce-notification-icon").hide(),Z("infomenu-announce-icon").hide()},L=function(e){var t=ZWLocalStore.getJSONValue(a);return t.id!=e.id||t.state!=l.INIT&&t.state!=l.SEEN?(e.isNew=!0,e.isInit=!0,e.isHighlight=!0):t.state===l.INIT?(e.isNew=!0,e.isHighlight=!0):t.state===l.SEEN&&(e.isHighlight=!0),e},w=function(e,t){d?P(e,t):PubSub.subscribe("Document/FirstTimeComponentReady",function(){return P(e,t)})},M=function(){d=!0};window.ZWAnnouncement={fetchData:A,onMsgReceived:w,formatSourceData:y,handleGetDataReq:v,handleBeforeShow:O,onNotifyIconClick:C,AnnouncementModel:t,getAnnouncementView:S,AnnouncementItemView:r,removeNewAnnouncement:E,hideNotificationIcons:N},PubSub.subscribe("Document/FirstTimeComponentReady",M)}(Backbone),function(){var e=function(e,t){var i=!1;try{window.localStorage.setItem(e,JSON.stringify(t)),i=!0}catch(e){}return i},t=function(e,t){var i=!1;try{var o=getUserStats(e)||{};U.extend(o,t),window.localStorage.setItem(e,JSON.stringify(t)),i=!0}catch(e){}return i},i=function(e){var t={};try{var i=window.localStorage.getItem(e);t=i?JSON.parse(i):{}}catch(e){}return t};window.ZWLocalStore={setJSONValue:e,getJSONValue:i,updateJSONValue:t}}(),function(e,t,i,o){e.EsignModel=function(e){e||(e={}),this.uploadedDocUrl=void 0,this.emailId=e.emailId,this.userName=e.userName,this.init(e)},EsignModel.prototype={init:function(e){var t=this;U.each(U.keys(e),function(i){t[i]=e[i]}),this.serviceName=J.i18n(e.serviceName)},setUploadedDocUrl:function(e){this.uploadedDocUrl=e},getUploadedDocUrl:function(){return this.uploadedDocUrl},setServiceType:function(e){this.serviceType=e},getServiceType:function(){return this.serviceType},isLoggedIn:function(){return!!this.userName},getUserName:function(){return this.userName},setUserName:function(e){this.userName=e},getEmailId:function(){return this.emailId},setEmailId:function(e){this.emailId=e},getServiceName:function(){return this.serviceName},getAccountDetails:function(){return{username:this.getUserName(),emailId:this.getEmailId()}},fetchAccountDetails:function(){if(this.isLoggedIn())return this.getAccountDetails();var e={},t=this,r=J.Deferred(),n=this.getServiceType(),a=i.getNiceUrlPrefix("esign/account");return e.service=n,i.setCsrfParam(e),J.ajax({url:a,data:e,type:"POST",success:function(e,i,n){e.STATUS&&(t.setEmailId(e.emailId),t.setUserName(e.username)),o.publish("Esign/get/account/success",e),r.resolve()},error:function(e,t,i){o.publish("Esign/get/account/failed",e.responseJSON),r.resolve()}}),r.promise()},uploadDocument:function(e){var r=this,n=t.isPreviewMode(),a=this.getServiceType(),l=i.getNiceUrlPrefix("esign/"+editor.doc.getDocInfo().RID+"/uploadDocument");if(e=e||{},e.service=a,i.setCsrfParam(e),n){var s=t.getCurrentRecordIdx(),d={isMailMerge:!0,operation:"download",from:s,to:s};e.isMailMerge=n,e.mailmergeinfo=JSON.stringify(d)}e.timeZone=moment().zone(),J.ajax({url:l,data:e,type:"POST",success:function(e,t,i){e.STATUS&&r.setUploadedDocUrl(e.uploadedUrl),o.publish("Esign/upload/success",a,e)},error:function(e,t,i){o.publish("Esign/upload/failed",a,e)}})},logout:function(){var e=this,t={},r=this.getServiceType();url=i.getNiceUrlPrefix("esign/logout"),t.service=r,i.setCsrfParam(t),J.ajax({url:url,data:t,type:"POST",success:function(t,i,n){t.STATUS&&e.setUserName(),o.publish("Esign/logout/success",r,t)},error:function(e,t,i){o.publish("Esign/logout/failed",r,e)}})}}}(window,MailMerge,Utils,PubSub),function(e,t){var i='<li id = "digisign-service-{{ serviceType }}" onclick = "EsignController.switchInManageDlg(\'{{ serviceType }}\')" ><span class = "ui-icon ui-writer-menu-icons ui-icon-sprit-crazy {{ icon }}" ></span></li>',o=t.compile(i),r="#esign_send_dlg",n="#esign_login_dlg",a="#esign_manage_dlg",l="digisignDropdownMenu",s=function(e){var t=Z(l),i=d(e);return t.zmenu("removeAllMenuItems"),t.zmenu("addMenuItems",i),!0},d=function(e){var t,i={},o=[],r=J.i18n("writer.common.LOADING"),n=EsignController.getAllServiceInstance(),a=J.i18n("writer.digisign.YOU_NEED_TO_SIGNIN"),l={label:J.i18n("writer.digisign.MANAGE_ACCOUNTS"),class:"ui-dsign-manageac",data:"{ appData: { action: 'EsignController.handleEsignSelection', params: 'manage' } }"},s={label:J.i18n("writer.esign.LEARN_MORE"),class:"ui-dsign-manageac",data:"{ appData: { action: 'EsignController.openHelpLink' } }"},d={mtype:"separator"};return U.forEach(n,function(n){t=n.isLoggedIn()?n.getUserName():e?r:a,i={id:"ds-switch-service-"+n.serviceType,data:"{ appData: { action: 'EsignController.handleEsignSelection', params: '"+n.serviceType+"' } }",icon:"ui-icon ui-writer-menu-icons ui-icon-sprit-crazy "+n.iconClassName,label:t},o.push(i),o.push(d)}),o.push(l,d,s),o},c=function(){J.dialogutil.open("esignmanagedialog","",p)},p={init:function(){u()},get:function(e,t){},set:function(e,t,i){}},u=function(){var e=J(a).parent(),t=e.parent(),i=t.find("#ds-login-form"),o=t.find("#btn-ds-acc-remove"),r=t.find("#ds-login-acc-info"),n=EsignController.getCurrentServiceType(),l=EsignController.getServiceInstance();if(f(t.find("#ul-digisign-servicelist")),t.find(".js-esign-title").hide(),t.find("#esign-title-info-"+n).show(),t.find("#digisign-service-"+n).addClass("ui-active"),E(e,!0,"btn-ds-acc-remove","writer.common.REMOVE"),l.isLoggedIn()){var s=l.getAccountDetails(),d=n==ESIGN.ZOHOSIGN;i.hide(),r.show(),d?o.hide():o.show(),t.find("#ds-username-txt").text(s.username),t.find("#ds-emailid-txt").text(s.emailId)}else{var c=n==ESIGN.ADOBESIGN,p=t.find("#ds-adobe-note-txt");o.hide(),r.hide(),i.show(),c?p.show():p.hide()}},f=function(e){var t=EsignController.getAllServiceInstance();e.empty(),U.forEach(t,function(t){e.append(J(o({serviceType:t.serviceType,icon:t.iconClassName})))})},g=function(){J.dialogutil.open("esignsenddialog","",m)},m={init:function(){h()},get:function(e,t){},set:function(e,t,i){}},h=function(){var e=EsignController.getServiceInstance(),t=e.getServiceName(),i=J(r).parent(),o=i.parent(),n=(o.find("#ds-send-service-icon"),J.i18n("writer.esign.SEND_VIA",[t])),a=J.i18n("writer.esign.UPLOAD_MSG",[t]);o.find(".ui-dialog-title").text(n),i.find("#lbl-esign-upload-txt").text(a),o.find("#lbl-esign-upload, #btn-ds-upload").show(),o.find("#btn-ds-upload-success, #lbl-esign-uploading, #lbl-esign-uploaded").hide(),E(i,!0,"btn-ds-upload","writer.common.UPLOAD"),E(i,!0,"btn-ds-send-cancel","writer.common.CANCEL")},T=function(){var e=J(a).parent();E(e,!1,"btn-ds-acc-remove","writer.common.REMOVING")},E=function(e,t,i,o){var r=t?"enableButton":"disableButton";e.zdialog(r,i),e.zdialog("changeButtonLabel",i,J.i18n(o))},R=function(e,t){var i=EsignController.getCurrentServiceType();return i==e&&t.STATUS?(u(),void b("writer.esign.REMOVE_ACCOUNT_SUCCESS","success","ui-docusign-notify-cls")):void S(e,t)},S=function(e,t){var i=EsignController.getCurrentServiceType();i==e&&u(),b("writer.esign."+(t.MESSAGE||"REMOVE_ACCOUNT_FAILED"),"error","ui-docusign-notify-cls")},O=function(){var e=J(r).parent(),t=e.parent();t.find("#lbl-esign-uploading").show(),t.find("#lbl-esign-upload, #lbl-esign-uploaded").hide(),E(e,!1,"btn-ds-upload","writer.image.UPLOADING_MSG")},v=function(e,t){var i=EsignController.getServiceInstance(),o=i.getServiceType();if(o==e){var n=J(r).parent(),a=n.parent();if(!t.STATUS)return void A(e,t);var l=J.i18n("writer.esign.UPLOADED_SUCCESS_MSG",[i.getServiceName()]);a.find("#btn-ds-upload, #lbl-esign-upload, #lbl-esign-uploading").hide(),a.find("#lbl-esign-uploaded-txt").text(l),a.find("#btn-ds-upload-success, #lbl-esign-uploaded").show(),n.zdialog("changeButtonLabel","btn-ds-send-cancel",J.i18n("writer.common.LATER"))}b("writer.esign."+t.MESSAGE,"success","ui-docusign-notify-cls")},b=function(e,t,i){var o={close:!0,setTimer:!0,type:t,message:e,timeOut:1e4};J(r).is(":visible")?(o.className=i,o.container="#ds-errormsg-container"):J(a).is(":visible")&&(o.className=i,o.container="#digierrormsg"),Notification.show(o)},A=function(e,t){var i=EsignController.getCurrentServiceType();i==e&&h(),b("writer.esign."+(t.MESSAGE||"UPLOAD_FAILED"),"error","ui-docusign-notify-cls")},y={init:function(){var e=EsignController.getServiceInstance(),t=J.i18n("writer.esign.LOGIN_DIALOG_MSG",[e.getServiceName()]),i=J(n),o=i.find("#esign_login_dlg_logo"),r=i.find("#esign_login_adobe_note");i.find("#esign_login_dlg_msg").text(t),e.getServiceType()==ESIGN.ADOBESIGN?r.show():r.hide(),o.removeClass("ui-icon-echosignservices-lg, ui-icon-docusign-lg").addClass(e.iconClassName)},get:function(e,t){},set:function(e,t,i){}},D=function(){J.dialogutil.open("esignlogindialog","",y)},C=function(){J.dialogutil.close("esignlogindialog"),g()},I=function(){J.dialogutil.close("esignsenddialog"),c()},P=function(e){if(Z(l).is(":visible"))return void _(e.SERVICE);var t=EsignController.getCurrentServiceType();t==e.SERVICE&&(J(a).is(":visible")?u():e.username&&J(n).is(":visible")?C():!e.username&&J(r).is(":visible")&&I())},_=function(e){var t=EsignController.getServiceInstance(e),i=t.isLoggedIn()?t.getUserName():J.i18n("writer.digisign.YOU_NEED_TO_SIGNIN");Z(l).zmenu("changeLabel","#ds-switch-service-"+e,i)};e.EsignView={openSendDialog:g,showUploadingUI:O,showDropdownMenu:s,showLogoutLoader:T,updateUIOnWmsMsg:P,openManageDialog:c,openLoginAlertDlg:D,updateSendDialogUI:h,updateManageDialogUI:u},PubSub.subscribe("Esign/logout/success",R),PubSub.subscribe("Esign/logout/failed",S),PubSub.subscribe("Esign/upload/success",v),PubSub.subscribe("Esign/upload/failed",A),PubSub.subscribe(["Esign/get/account/success","Esign/get/account/failed"],P)}(window,Handlebars),function(e,t,i,o){var r,n={},a=!0,l={adobesign:{serviceType:o.ADOBESIGN,serviceName:"writer.esign.ADOBE_SIGN",iconClassName:"ui-icon-echosignservices-lg"},docusign:{serviceType:o.DOCUSIGN,serviceName:"writer.esign.DOCUSIGN",iconClassName:"ui-icon-docusign-lg"},signeasy:{serviceType:o.SIGNEASY,serviceName:"writer.esign.SIGNEASY",iconClassName:"ui-icon-signeasy-lg"},zohosign:{serviceType:o.ZOHOSIGN,serviceName:"writer.esign.ZOHOSIGN",iconClassName:"ui-icon-zohosign-lg"}},s=function(){var e={},t=[],i=editor.options.allowedEsignServices;return i&&i.length&&(t=i.split(",")),U.forEach(t,function(t){U.has(l,t)&&(e[t]=l[t])}),e},d=function(){var t=s();U.forEach(t,function(t){n[t.serviceType]=new e.EsignModel(t)})},c=function(){return n},p=function(e){g(e)},u=function(){return r||f()},f=function(){var e=U.keys(n)[0];return g(e),r},g=function(e){switch(e){case o.ADOBESIGN:case o.DOCUSIGN:case o.ZOHOSIGN:case o.SIGNEASY:r=e,serviceInstance=n[e]}},m=function(e){return n[e||r]||h()},h=function(){return p(o.ADOBESIGN),serviceInstance},T=function(){i.showDropdownMenu(!0),a=!1,U.forEach(n,function(e){e.fetchAccountDetails()})},E=function(){return a?T():i.showDropdownMenu(),!0},R=function(e){if("manage"===e)u(),i.openManageDialog();else{p(e);var t=m();t.isLoggedIn()?i.openSendDialog():i.openLoginAlertDlg()}},S=function(e){p(e),i.updateManageDialogUI()},O=function(){m().uploadDocument(),i.showUploadingUI()},v=function(){var e,t=600,i=900,r=m(),n=r.getServiceType(),l=screen.width/2-i/2,s=screen.height/2-t/2,d={left:l,top:s,width:i,height:t,scrollbars:1};switch(a=!0,n){case o.SIGNEASY:e=editor.options.easySignLoginUrl;break;case o.ZOHOSIGN:e=editor.options.zohoSignLoginUrl;break;default:e=editor.options.esignLoginDocsUrl+"?service="+n}Utils.safeWindowOpen(e,d),J("#esign-login-btn").disable()},b=function(){m().logout(),i.showLogoutLoader()},A=function(e){switch(e.ACTION){case"LOGIN_LOGOUT":switch(e.SERVICE){case o.ADOBESIGN:case o.DOCUSIGN:case o.ZOHOSIGN:case o.SIGNEASY:var t=m(e.SERVICE);t.setUserName(e.username),t.setEmailId(e.emailId)}i.updateUIOnWmsMsg({SERVICE:e.SERVICE,username:e.username})}},y=function(){var e=m(o.ZOHOSIGN),t=e.fetchAccountDetails();J.when(t).done(i.updateUIOnWmsMsg)},D=function(){Utils.safeWindowOpen(m().getUploadedDocUrl()),J.dialogutil.close("esignsenddialog")},C=function(){Utils.safeWindowOpen(editorProps.urls.helpPageURL+"e-signature.html")};e.EsignController={openHelpLink:C,wmsMsgHandler:A,handleLoginClick:v,handleLogoutClick:b,switchInManageDlg:S,getServiceInstance:m,openDropdownClicked:E,handleEsignSelection:R,handleUploadBtnClick:O,showUploadedDocument:D,getAllServiceInstance:c,getCurrentServiceType:u},PubSub.subscribe("Document/FirstTimeComponentReady",d),PubSub.subscribe("Esign/ZohoSign/Account/Added",y)}(window,EsignModel,EsignView,ESIGN);var TextBoxTemplates={box1:{themeRef:{strokeRef:{ref:"THEME",color:{tweaks:{shade:.5},type:"A1"}},fillRef:{ref:"THEME",color:{type:"A1"}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},nvOProps:{nvDProps:{id:"FC20B5F3-ABD8-4F22-816A-C5578DE60F89"}},shapes:[{nvOProps:{nvDProps:{id:"79471652-749A-419E-BDDE-E1A7B4059B47"}},props:{transform:{rotate:180,pos:{zindex:0,top:141.1759289637195,left:455.5},flipv:!1,dim:{width:1.1409874655394075e-13,height:191.1131602749059},fliph:!1},geom:{preset:{type:"LINE",modifiers:[.5]},type:"PRESET"},fill:{solid:{color:{type:"A1",rgb:[137,191,74]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:6,type:"SOLID",fill:{solid:{color:{type:"A1",rgb:["245"," 194"," 1"]}},type:"SOLID"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{top:-368.1759289637195,left:-551.5,width:816,height:1054}},{nvOProps:{nvDProps:{id:"87884C60-E53C-4E25-ABAE-5889CF963CE4"}},props:{transform:{rotate:0,pos:{zindex:1,top:140.9443,left:22},flipv:!1,dim:{width:411.99999999999994,height:190.0557},fliph:!1},geom:{preset:{type:"RECT"},type:"PRESET"},fill:{type:"NONE"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{paras:[{listNum:!1,style:{margin:{left:0},listStyle:{bullet:{type:"NONE",status:"enabled"}},spacing:{line:{type:"PERCENT",percent:"1.0"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"LEFT",dir:"LTR"},unmerged:{style:{margin:{left:0},spacing:{line:{type:"PERCENT",percent:"1.0"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"LEFT",dir:"LTR"}},portions:[{t:"HEADING",unmerged:{props:{"":"",size:"20",bold:!0,fill:{solid:{color:{type:"A1",rgb:["245"," 194"," 1"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!1,font:{fontFamily:{name:"open sans"}}}},props:{"":"",size:"20",bold:!0,fill:{solid:{color:{type:"A1",rgb:["245"," 194"," 1"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!1,font:{fontFamily:{name:"open sans"}}}}]},{listNum:!1,style:{margin:{left:0},spacing:{line:{type:"PERCENT",percent:"1.0"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"LEFT",dir:"LTR",listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{margin:{left:0},spacing:{line:{type:"PERCENT",percent:"1.0"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"LEFT",dir:"LTR"}},portions:[{unmerged:{props:{"":"",size:"8",bold:!0,fill:{solid:{color:{type:"A1",rgb:["245"," 194"," 1"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!1,font:{fontFamily:{name:"open sans"}}}},props:{"":"",size:"8",bold:!0,fill:{solid:{color:{type:"A1",rgb:["245"," 194"," 1"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!1,font:{fontFamily:{name:"open sans"}}}}]},{listNum:!1,style:{margin:{left:0},listStyle:{bullet:{type:"NONE",status:"enabled"}},spacing:{line:{type:"PERCENT",percent:"1.2"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"LEFT",dir:"LTR"},unmerged:{style:{margin:{left:0},spacing:{line:{type:"PERCENT",percent:"1.2"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"LEFT",dir:"LTR"}},portions:[{t:"CONTENT",unmerged:{props:{"":"",size:"12",fill:{solid:{color:{type:"A1",rgb:["128"," 128"," 128"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!0,font:{fontFamily:{name:"open sans"}}}},props:{"":"",size:"12",fill:{solid:{color:{type:"A1",rgb:["128"," 128"," 128"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!0,font:{fontFamily:{name:"open sans"}}}},{t:" ",unmerged:{props:{"":"",size:"12",fill:{solid:{color:{type:"A1",rgb:["128"," 128"," 128"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!0,font:{fontFamily:{name:"open sans"}}}},props:{"":"",size:"12",fill:{solid:{color:{type:"A1",rgb:["128"," 128"," 128"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!0,font:{fontFamily:{name:"open sans"}}}}]},{listNum:!1,style:{margin:{left:0},listStyle:{bullet:{type:"NONE",status:"enabled"}},spacing:{line:{type:"PERCENT",percent:"1.2"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"CENTER",dir:"LTR"},unmerged:{style:{margin:{left:0},spacing:{line:{type:"PERCENT",percent:"1.2"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"CENTER",dir:"LTR"}},portions:[{t:" ",unmerged:{props:{"":"",size:18,fill:{solid:{color:{type:"A1",rgb:["128"," 128"," 128"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!0,font:{fontFamily:{name:"open sans"}}}},props:{"":"",size:11,fill:{solid:{color:{type:"A1",rgb:["128"," 128"," 128"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!0,font:{fontFamily:{name:"open sans"}}}}]}],id:"textcontainer",props:{inset:{top:0,left:0,bottom:0,right:0},column:{num:1,gap:0},valign:"TOP",autoFit:{type:"NONE"},wrap:"NONE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{top:-367.9443,left:-118,width:816,height:1054}}],type:"GROUPSHAPE",props:{transform:{chDim:{width:433.5000000000001,height:191.34478923862542},rotate:0,pos:{top:98,left:250.5},flipv:!1,dim:{width:451.00000000000006,height:164.0557},fliph:!1,chPos:{top:140.9443,left:22}}},mr:"0.125in",ml:"0.125in",mb:"0.125in",mt:"0.125in",wrapType:"square",textboxTemplate:"box1",fitModeData:{left:-96,width:818,height:1054,top:-97}},box2:{nvOProps:{nvDProps:{id:""}},props:{transform:{fliph:!1,flipv:!1,dim:{width:446.7560553633216,height:156.05570000000003},pos:{top:98,left:250.5},chDim:{width:446.7560553633216,height:191.34476027490592},chPos:{left:10.5,top:155.9443},rotate:0}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"GROUPSHAPE",shapes:[{nvOProps:{nvDProps:{id:"10E422E9-C0A3-4FBE-B7C3-B40B14BBF373"}},props:{transform:{rotate:0,pos:{zindex:0,top:155.9443,left:31},flipv:!1,dim:{width:426.2560553633216,height:190.0557},fliph:!1},geom:{preset:{type:"RECT"},type:"PRESET"},fill:{type:"NONE"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{paras:[{listNum:!1,style:{margin:{left:0},listStyle:{bullet:{type:"NONE",status:"enabled"}},spacing:{line:{type:"PERCENT",percent:"1.0"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"LEFT",dir:"LTR"},unmerged:{style:{margin:{left:0},spacing:{line:{type:"PERCENT",percent:"1.0"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"LEFT",dir:"LTR"}},portions:[{t:"HEADING",unmerged:{props:{"":"",size:"20",bold:!0,fill:{solid:{color:{type:"A1",rgb:["82"," 109"," 176"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!1,font:{fontFamily:{name:"open sans"}}}},props:{"":"",size:"20",bold:!0,fill:{solid:{color:{type:"A1",rgb:["82"," 109"," 176"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!1,font:{fontFamily:{name:"open sans"}}}}]},{listNum:!1,style:{margin:{left:0},spacing:{line:{type:"PERCENT",percent:"1.0"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"LEFT",dir:"LTR",listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{margin:{left:0},spacing:{line:{type:"PERCENT",percent:"1.0"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"LEFT",dir:"LTR"}},portions:[{unmerged:{props:{"":"",size:"8",bold:!0,fill:{solid:{color:{type:"A1",rgb:["82"," 109"," 176"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!1,font:{fontFamily:{name:"open sans"}}}},props:{"":"",size:"8",bold:!0,fill:{solid:{color:{type:"A1",rgb:["82"," 109"," 176"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!1,font:{fontFamily:{name:"open sans"}}}}]},{listNum:!1,style:{margin:{left:0},listStyle:{bullet:{type:"NONE",status:"enabled"}},spacing:{line:{type:"PERCENT",percent:"1.2"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"LEFT",dir:"LTR"},unmerged:{style:{margin:{left:0},spacing:{line:{type:"PERCENT",percent:"1.2"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"LEFT",dir:"LTR"}},portions:[{t:"CONTENT ",unmerged:{props:{"":"",size:"12",fill:{solid:{color:{type:"A1",rgb:["128"," 128"," 128"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!0,font:{fontFamily:{name:"open sans"}}}},props:{"":"",size:"12",fill:{solid:{color:{type:"A1",rgb:["128"," 128"," 128"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!0,font:{fontFamily:{name:"open sans"}}}}]},{listNum:!1,style:{margin:{left:0},listStyle:{bullet:{type:"NONE",status:"enabled"}},spacing:{line:{type:"PERCENT",percent:"1.2"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"CENTER",dir:"LTR"},unmerged:{style:{margin:{left:0},spacing:{line:{type:"PERCENT",percent:"1.2"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"CENTER",dir:"LTR"}},portions:[{t:" ",unmerged:{props:{"":"",size:18,fill:{solid:{color:{type:"A1",rgb:["128"," 128"," 128"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!0,font:{fontFamily:{name:"open sans"}}}},props:{"":"",size:11,fill:{solid:{color:{type:"A1",rgb:["128"," 128"," 128"]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},italic:!0,font:{fontFamily:{name:"open sans"}}}}]}],id:"textcontainer",props:{inset:{top:0,left:0,bottom:0,right:0},column:{num:1,gap:0},valign:"TOP",autoFit:{type:"NONE"},wrap:"NONE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-127,width:816,height:1054,top:-295.9443}},{nvOProps:{nvDProps:{id:"6B392604-DB14-4B8B-AC41-9A23F5B578B5"}},props:{transform:{rotate:180,pos:{zindex:1,top:156.1759,left:10.5},flipv:!1,dim:{width:1.180468000679179e-13,height:191.1131602749059},fliph:!1},geom:{preset:{type:"LINE",modifiers:[.5]},type:"PRESET"},fill:{solid:{color:{type:"A1",rgb:[137,191,74]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:10,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",rgb:["82"," 109"," 176"]}}}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-106.5,width:816,height:1054,top:-296.1759}}],mr:"0.125in",ml:"0.125in",mb:"0.125in",mt:"0.125in",wrapType:"square",textboxTemplate:"box2",fitModeData:{left:-96,width:818,height:1054,top:-97}},box3:{nvOProps:{nvDProps:{id:"A2DC1D80-2A27-455E-ACAD-DAFA5E0A0219"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:376.5,height:194},pos:{top:98,left:251.5},chDim:{width:376.5,height:194},chPos:{left:41.8333740234375,top:-6},rotate:0}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"GROUPSHAPE",shapes:[{nvOProps:{nvDProps:{id:"EEDB8E93-F9D8-4B0E-8D78-8D3F15890935"}},props:{stroke:{jointype:"ROUND",captype:"FLAT",fill:{solid:{color:{rgb:["6"," 143"," 201"],type:"A1"}},type:"SOLID"},width:1,type:"SOLID"},transform:{dim:{height:35,width:374},rotate:0,flipv:!1,fliph:!1,pos:{left:41.8333740234375,top:-6,zindex:1}},fill:{solid:{color:{rgb:["6"," 143"," 201"],type:"A1"}},type:"SOLID"},geom:{preset:{type:"RECT"},type:"PRESET"}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{id:"textcontainer",element:"",paras:[{portions:[{t:"HEADING",unmerged:{props:{stroke:{jointype:"ROUND",captype:"FLAT",fill:{type:"NONE"},width:1,type:"SOLID"},font:{fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:[255,255,255],type:"A1"}},type:"SOLID"},size:11}},props:{stroke:{jointype:"ROUND",captype:"FLAT",fill:{type:"NONE"},width:1,type:"SOLID"},font:{fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:[255,255,255],type:"A1"}},type:"SOLID"},size:11}}],style:{halign:"LEFT",level:1,dir:"LTR",defPrProps:{stroke:{captype:"FLAT",fill:{solid:{color:{tweaks:{shade:.5},rgb:[56,93,138],type:"A1"}},type:"SOLID"},width:2.6666667,type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:{0:0,1:0,2:0},type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:"1",type:"PERCENT"}},listStyle:{bullet:{status:"enabled",type:"NONE"}}},listNum:!1,unmerged:{style:{halign:"LEFT",level:1,dir:"LTR",defPrProps:{stroke:{captype:"FLAT",fill:{solid:{color:{tweaks:{shade:.5},rgb:[56,93,138],type:"A1"}},type:"SOLID"},width:2.6666667,type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:{0:0,1:0,2:0},type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:"1",type:"PERCENT"}}}}}],props:{wrap:"NONE",autoFit:{type:"NONE"},inset:{bottom:0,left:0,right:0,top:0},column:{num:1,gap:0},valign:"MIDDLE"}},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-137.8333740234375,width:816,height:1054,top:-91}},{nvOProps:{nvDProps:{id:"B6C8B55D-1765-455B-AB6B-16E84DF8BB3D"}},props:{stroke:{jointype:"ROUND",captype:"FLAT",fill:{solid:{color:{rgb:["242"," 242"," 242"],type:"A1"}},type:"SOLID"},width:0,type:"SOLID"},transform:{dim:{height:148,width:376},rotate:0,flipv:!1,fliph:!1,pos:{left:42.3333740234375,top:40,zindex:1}},fill:{solid:{color:{rgb:["255"," 255"," 255"],type:"A1"}},type:"SOLID"},geom:{preset:{type:"RECT"},type:"PRESET"}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{id:"textcontainer",element:"",paras:[{portions:[{t:"CONTENT",unmerged:{props:{"":"",stroke:{jointype:"ROUND",captype:"FLAT",fill:{type:"NONE"},width:1,type:"SOLID"},font:{fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:["128"," 128"," 128"],type:"A1"}},type:"SOLID"},italic:!1,size:18}},props:{"":"",stroke:{jointype:"ROUND",captype:"FLAT",fill:{type:"NONE"},width:1,type:"SOLID"},font:{fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:["128"," 128"," 128"],type:"A1"}},type:"SOLID"},italic:!1,size:11}}],style:{halign:"LEFT",level:1,dir:"LTR",defPrProps:{stroke:{captype:"FLAT",fill:{solid:{color:{tweaks:{shade:.5},rgb:[56,93,138],type:"A1"}},type:"SOLID"},width:2.6666667,type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:{0:0,1:0,2:0},type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:"1.2",type:"PERCENT"}},listStyle:{bullet:{status:"enabled",type:"NONE"}}},listNum:!1,unmerged:{style:{halign:"LEFT",level:1,dir:"LTR",defPrProps:{stroke:{captype:"FLAT",fill:{solid:{color:{tweaks:{shade:.5},rgb:[56,93,138],type:"A1"}},type:"SOLID"},width:2.6666667,type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:{0:0,1:0,2:0},type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:"1.2",type:"PERCENT"}}}}}],props:{wrap:"NONE",autoFit:{type:"NONE"},inset:{bottom:0,left:0,right:0,top:0},column:{num:1,gap:0},valign:"MIDDLE"}},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-138.3333740234375,width:816,height:1054,top:-137}}],mr:"0.125in",ml:"0.125in",mb:"0.125in",mt:"0.125in",wrapType:"square",textboxTemplate:"box3",fitModeData:{left:-96,width:818,height:1054,top:-97}},box4:{nvOProps:{nvDProps:{id:""}},props:{transform:{fliph:!1,flipv:!1,dim:{width:214,height:240.28840248003007},pos:{top:98,left:250.5},chDim:{width:214,height:240.28840248003007},chPos:{left:40.95003571111488,top:44},rotate:0}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"GROUPSHAPE",shapes:[{nvOProps:{nvDProps:{id:"D0752113-EBBD-462A-96FB-739863ED2324"}},props:{stroke:{jointype:"ROUND",captype:"FLAT",fill:{solid:{color:{rgb:[112,154,63],type:"A1"}},type:"SOLID"},width:0,type:"SOLID"},transform:{dim:{height:234.23544694211003,width:214},rotate:349,flipv:!1,fliph:!1,pos:{left:40.95003571111488,top:50.05295553792007,zindex:1}},fill:{solid:{color:{rgb:["255"," 233"," 150"],type:"A1"}},type:"SOLID"},geom:{preset:{type:"RECT"},type:"PRESET"},effects:{shadow:{distance:{radius:10,angle:"135"},color:{tweaks:{alpha:.6},rgb:[91,91,91],type:"CUSTOM"},preset:"PRESET1",blur:{radius:4},type:"OUTER"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{id:"textcontainer",element:"",paras:[{portions:[{unmerged:{props:{"":"",stroke:{jointype:"ROUND",captype:"FLAT",fill:{type:"NONE"},width:1,type:"SOLID"},font:{fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:["128"," 128"," 128"],type:"A1"}},type:"SOLID"},size:18}},props:{"":"",stroke:{jointype:"ROUND",captype:"FLAT",fill:{type:"NONE"},width:1,type:"SOLID"},font:{fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:["128"," 128"," 128"],type:"A1"}},type:"SOLID"},size:11},t:"CONTENT"}],style:{halign:"CENTER",level:1,dir:"LTR",defPrProps:{stroke:{captype:"FLAT",fill:{solid:{color:{tweaks:{shade:.5},rgb:[56,93,138],type:"A1"}},type:"SOLID"},width:2.6666667,type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:{0:0,1:0,2:0},type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:"1.2",type:"PERCENT"}},listStyle:{bullet:{status:"enabled",type:"NONE"}}},listNum:!1,unmerged:{style:{halign:"CENTER",level:1,dir:"LTR",defPrProps:{stroke:{captype:"FLAT",fill:{solid:{color:{tweaks:{shade:.5},rgb:[56,93,138],type:"A1"}},type:"SOLID"},width:2.6666667,type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:{0:0,1:0,2:0},type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:"1.2",type:"PERCENT"}}}}}],props:{wrap:"NONE",autoFit:{type:"NONE"},inset:{bottom:0,left:0,right:0,top:0},column:{num:1,gap:0},valign:"MIDDLE"}},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-136.95003571111488,width:816,height:1074,top:-147.05295553792007}},{nvOProps:{nvDProps:{id:"9B206168-A978-4022-AEAB-154472FE5CB6"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:28,height:32},pos:{left:118.50006103515625,top:44,zindex:2},rotate:0},geom:{type:"PRESET",preset:{type:"RECT"}},fill:{type:"PICT",pict:{type:{type:"FRAME"},value:{id:"9B206168-A978-4022-AEAB-154472FE5CB6",type:"USERDEFINED",pictureName:"Image9B206168-A978-4022-AEAB-154472FE5CB6.jpg",serverUrl:"",url:"",dim:{width:32,height:28},width:32,height:28}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{paras:[{portions:[{t:"",props:{size:11,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:[255,255,255]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"Arial"}}},unmerged:{props:{size:11,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:[255,255,255]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"Arial"}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}},listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}}}},listNum:!1}],props:{column:{num:1,gap:0},valign:"MIDDLE",inset:{left:0,right:0,top:0,bottom:0},autoFit:{type:"NONE"},wrap:"NONE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-214.50006103515625,width:816,height:1054,top:-141}}],mr:"0.125in",ml:"0.125in",mb:"0.125in",mt:"0.125in",wrapType:"square",textboxTemplate:"box4",fitModeData:{left:-96,width:818,height:1054,top:-97}},box5:{textBody:{id:"textcontainer",element:"",paras:[{portions:[{unmerged:{props:{"":"",stroke:{jointype:"ROUND",captype:"FLAT",fill:{type:"NONE"},width:1,type:"SOLID"},font:{fontFamily:{name:"open sans"}},fill:{solid:{color:{rgb:["89"," 89"," 89"],type:"A1"}},type:"SOLID"},italic:!0,size:"11"}},props:{"":"",stroke:{jointype:"ROUND",captype:"FLAT",fill:{type:"NONE"},width:1,type:"SOLID"},font:{fontFamily:{name:"open sans"}},fill:{solid:{color:{rgb:["89"," 89"," 89"],type:"A1"}},type:"SOLID"},italic:!0,size:"11"},t:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam vel convallis ex, quis aliquam risus. Cras iaculis ornare scelerisque. Pellentesque a mattis urna. Cras convallis accumsan mi, ac consequat erat consequat ac. Quisque venenatis augue metus, eu rutrum elit pulvinar sit amet."}],style:{halign:"CENTER",level:1,dir:"LTR",defPrProps:{stroke:{captype:"FLAT",fill:{solid:{color:{tweaks:{shade:.5},rgb:[56,93,138],type:"A1"}},type:"SOLID"},width:2.6666667,type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:{0:0,1:0,2:0},type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:"1.2",type:"PERCENT"}},listStyle:{bullet:{status:"disabled",type:"NONE"}}},listNum:!1,unmerged:{style:{halign:"CENTER",level:1,dir:"LTR",defPrProps:{stroke:{captype:"FLAT",fill:{solid:{color:{tweaks:{shade:.5},rgb:[56,93,138],type:"A1"}},type:"SOLID"},width:2.6666667,type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:{0:0,1:0,2:0},type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:"1.2",type:"PERCENT"}}}}}],props:{column:{num:1,gap:0},wrap:"NONE",autoFit:{type:"NONE"},inset:{left:0,right:0,top:0,bottom:0},valign:"MIDDLE"}},nvOProps:{nvDProps:{id:"188A15EA-2CD1-4274-8675-42D289285909"}},type:"SHAPE",containerDim:{height:"1000",width:"1000"},props:{stroke:{jointype:"ROUND",captype:"FLAT",fill:{solid:{color:{rgb:["0"," 112"," 192"],type:"A1"}},type:"SOLID"},width:6,type:"SOLID"},transform:{dim:{height:127,width:676},rotate:0,flipv:!1,fliph:!1,pos:{left:252.5,top:99}},fill:{type:"NONE"},geom:{preset:{type:"DOUBLE_BRACKET"},type:"PRESET"}},editable:!0,themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},fontRef:{ref:"MINOR",color:{rgb:[255,255,255],type:"CUSTOM"}},strokeRef:{ref:"THEME",color:{tweaks:{shade:.5},type:"A1"}}},mr:"0.125in",ml:"0.125in",mb:"0.125in",mt:"0.125in",wrapType:"square",textboxTemplate:"box5",fitModeData:{left:-98,width:818,height:1054,top:-98}},box6:{textBody:{id:"textcontainer",element:{0:{},length:1,prevObject:{0:{"sizzle-1485859071333":{parentNode:[77878,4693,!1]}},length:1},selector:"#textcontainer"},paras:[{portions:[{unmerged:{props:{"":"",stroke:{jointype:"ROUND",captype:"FLAT",fill:{type:"NONE"},width:1,type:"SOLID"},font:{fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:["89"," 89"," 89"],type:"A1"}},type:"SOLID"},size:18}},props:{"":"",stroke:{jointype:"ROUND",captype:"FLAT",fill:{type:"NONE"},width:1,type:"SOLID"},font:{fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:["89"," 89"," 89"],type:"A1"}},type:"SOLID"},size:11},t:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam vel convallis ex, quis aliquam risus. Cras iaculis ornare scelerisque. Pellentesque a mattis urna. Cras convallis accumsan mi, ac consequat erat consequat ac. Quisque venenatis augue metus, eu rutrum elit pulvinar sit amet."}],style:{halign:"CENTER",level:1,dir:"LTR",defPrProps:{stroke:{captype:"FLAT",fill:{solid:{color:{tweaks:{shade:.5},rgb:[56,93,138],type:"A1"}},type:"SOLID"},width:2.6666667,type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:{0:0,1:0,2:0},type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:"1.2",type:"PERCENT"}},listStyle:{bullet:{status:"disabled",type:"NONE"}}},listNum:!1,unmerged:{style:{halign:"CENTER",level:1,dir:"LTR",defPrProps:{stroke:{captype:"FLAT",fill:{solid:{color:{tweaks:{shade:.5},rgb:[56,93,138],type:"A1"}},type:"SOLID"},width:2.6666667,type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Arial"}},fill:{solid:{color:{rgb:{0:0,1:0,2:0},type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:"1.2",type:"PERCENT"}}}}}],props:{column:{num:1,gap:0},wrap:"NONE",autoFit:{type:"NONE"},inset:{left:0,right:0,top:0,bottom:0},valign:"MIDDLE"}},nvOProps:{nvDProps:{id:"99155976-D975-4763-8511-4D56D40E97EA"}},type:"SHAPE",containerDim:{height:"1000",width:"1000"},props:{stroke:{jointype:"ROUND",captype:"FLAT",fill:{solid:{color:{rgb:[112,154,63],type:"A1"}},type:"SOLID"},width:6,type:"SOLID"},transform:{dim:{height:173,width:376.5},rotate:0,flipv:!1,fliph:!1,pos:{top:98,left:250.5}},fill:{type:"NONE"},geom:{preset:{type:"DOUBLE_BRACE"},type:"PRESET"}},editable:!0,themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},fontRef:{ref:"MINOR",color:{rgb:[255,255,255],type:"CUSTOM"}},strokeRef:{ref:"THEME",color:{tweaks:{shade:.5},type:"A1"}}},mr:"0.125in",ml:"0.125in",mb:"0.125in",mt:"0.125in",wrapType:"square",textboxTemplate:"box6",fitModeData:{left:-96,width:818,height:1054,top:-97}},box7:{containerDim:{width:"1000",height:"1000"},nvOProps:{nvDProps:{id:"8D1E0B63-BFD9-48DD-9C57-B871CC21C6BD"}},mr:"0.125in",editable:!0,mt:"0.125in",textBody:{paras:[{listNum:!1,style:{margin:{left:10},listStyle:{bullet:{type:"NONE",status:"enabled"}},spacing:{line:{type:"PERCENT",percent:"1.2"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"LEFT",dir:"LTR"},unmerged:{style:{margin:{left:10},spacing:{line:{type:"PERCENT",percent:"1.2"}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}},type:"SOLID"},stroke:{captype:"FLAT",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[56,93,138]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Arial"}}},halign:"LEFT",dir:"LTR"}},portions:[{t:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam vel convallis ex, quis aliquam risus. Cras iaculis ornare scelerisque. Pellentesque a mattis urna. ",unmerged:{props:{size:"12",fill:{solid:{color:{type:"A1",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},font:{fontFamily:{name:"lato"}}}},props:{size:"12",fill:{solid:{color:{type:"A1",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:1,type:"SOLID",fill:{type:"NONE"}},font:{fontFamily:{name:"lato"}}}}]}],id:"textcontainer",props:{inset:{top:0,left:0,bottom:0,right:0},column:{num:1,gap:0},valign:"MIDDLE",autoFit:{type:"NONE"},wrap:"NONE"},element:""},type:"SHAPE",wrapType:"square",props:{transform:{rotate:0,pos:{top:98,left:250.5},dim:{width:487,height:148},flipv:!1,fliph:!1},fill:{type:"SOLID",solid:{color:{type:"A1",rgb:["0"," 176"," 156"]}}},geom:{preset:{type:"CHEVRON"},type:"PRESET"},stroke:{captype:"FLAT",jointype:"ROUND",width:0,fill:{solid:{color:{rgb:[112,154,63],type:"A1"}},type:"SOLID"},type:"SOLID"}},themeRef:{strokeRef:{ref:"THEME",color:{tweaks:{shade:.5},type:"A1"}},fillRef:{ref:"THEME",color:{type:"A1"}},fontRef:{ref:"MINOR",color:{rgb:[255,255,255],type:"CUSTOM"}}},mb:"0.125in",textboxTemplate:"box7",ml:"0.125in",fitModeData:{left:-96,width:818,height:1054,top:-97}},box8:{nvOProps:{nvDProps:{id:"F281A9D1-C2EF-40D0-83F0-02FD6A508FD2"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:282.70493,height:458},pos:{left:251,top:97},chDim:{width:282.70493,height:458},chPos:{left:2,top:0},rotate:0}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"GROUPSHAPE",shapes:[{nvOProps:{nvDProps:{id:"FC7FA4AE-FE25-43CB-9D0D-D67769AECA30"}},props:{transform:{rotate:0,fliph:!1,flipv:!1,dim:{width:280.7049,height:458},pos:{left:2,top:0,zindex:0}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[239,161,76]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:3,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[239,161,76]}}}},geom:{type:"PRESET",preset:{type:"RECT"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"TOP",autoFit:{type:"NONE"}},paras:[{portions:[{t:"",props:{font:{fontFamily:{name:"Open Sans"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"A3",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.2},{mode:"OFFSET",value:.8}]}},rgb:[253,235,207]}}},size:18,fontweight:"BOLD",chk:{state:"PROCESSED",lang:"en-US"},stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},unmerged:{props:{font:{fontFamily:{name:"Open Sans"}},fill:{type:"SOLID",solid:{color:{type:"A3",rgb:[255,255,255],tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.2},{mode:"OFFSET",value:.8}]}}}}},fontweight:"BOLD",chk:{state:"PROCESSED",lang:"en-US"}}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1.25}}},unmerged:{style:{halign:"LEFT",spacing:{line:{type:"PERCENT",percent:1.25}}}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-98,width:816,height:1054,top:-97}},{nvOProps:{nvDProps:{id:"AEF95567-C351-4E8D-9C75-184D1529A511"}},props:{transform:{rotate:0,fliph:!1,flipv:!1,dim:{width:276.45932,height:412.32224},pos:{left:4.264599999999973,top:37.8561,zindex:1}},fill:{type:"SOLID",solid:{color:{type:"BG1",rgb:[255,255,255]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}},geom:{type:"PRESET",preset:{type:"RECT"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-100.26459999999997,width:816,height:1054,top:-134.8561}},{nvOProps:{nvDProps:{id:"A7E3F7F7-E3D6-466D-86CB-2E44FE585D15"}},props:{transform:{rotate:0,fliph:!1,flipv:!1,dim:{width:278.19583,height:76.1439},pos:{left:6.5090999999999894,top:37.8561,zindex:2}},geom:{type:"PRESET",preset:{type:"RECT"}},stroke:{fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{inset:{left:10,top:5,right:10,bottom:5},autoFit:{type:"SHAPE"}},paras:[{portions:[{t:"Lorem ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[235,138,53]}}},size:20,fontweight:"BOLD",chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[235,138,53]}}},size:20,fontweight:"BOLD",chk:{state:"PROCESSED",lang:"en-US"}}}},{t:"ipsum",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[235,138,53]}}},size:20,fontweight:"BOLD",chk:{state:"ERROR",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[235,138,53]}}},size:20,fontweight:"BOLD",chk:{state:"ERROR",lang:"en-US"}}}},{t:" dolor sit ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[235,138,53]}}},size:20,fontweight:"BOLD",chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[235,138,53]}}},size:20,fontweight:"BOLD",chk:{state:"PROCESSED",lang:"en-US"}}}},{t:"aamet",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[235,138,53]}}},size:20,fontweight:"BOLD",chk:{state:"ERROR",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[235,138,53]}}},size:20,fontweight:"BOLD",chk:{state:"ERROR",lang:"en-US"}}}},{t:".",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[235,138,53]}}},size:20,fontweight:"BOLD",stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[235,138,53]}}},size:20,fontweight:"BOLD"}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-102.50909999999999,width:816,height:1054,top:-134.8561}},{nvOProps:{nvDProps:{id:"79326B4C-C96F-4054-87E3-A03890F41394"}},props:{transform:{rotate:0,fliph:!1,flipv:!1,dim:{width:274.56082,height:319.4706},pos:{left:5.421199999999999,top:120.91220000000001,zindex:3}},geom:{type:"PRESET",preset:{type:"RECT"}},stroke:{fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{inset:{left:10,top:5,right:10,bottom:5},autoFit:{type:"SHAPE"}},paras:[{portions:[{t:"Lorem ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"PROCESSED",lang:"en-US"}}}},{t:"Ipsum",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"ERROR",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"ERROR",lang:"en-US"}}}},{t:" is simply dummy text of the printing and ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"PROCESSED",lang:"en-US"}}}},{t:"typeset",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"PROCESSED",lang:"en-US"}}}},{t:"  an industry. Lorem ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"PROCESSED",lang:"en-US"}}}},{t:"Ipsum",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"ERROR",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"ERROR",lang:"en-US"}}}},{t:" has been a the industry's standard dum when an un printer took.",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"PROCESSED",lang:"en-US"}}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1.5},after:{type:"ABSOLUTE",absolute:12}}},unmerged:{style:{spacing:{line:{type:"PERCENT",percent:1.5},after:{type:"ABSOLUTE",absolute:12}}}}},{portions:[{t:"Lorem ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"PROCESSED",lang:"en-US"}}}},{t:"Ipsum",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"ERROR",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"ERROR",lang:"en-US"}}}},{t:" has been the ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1}}},{t:"indust's",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"ERROR",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,chk:{state:"ERROR",lang:"en-US"}}}},{t:" standard dummy text  t when an unknown printer took",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1}}},{t:".",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1,stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"TX1",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.95},{mode:"OFFSET",value:.05}]}},rgb:[13,13,13]}}},size:12,italic:!1}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1.5},after:{type:"ABSOLUTE",absolute:12}}},unmerged:{style:{spacing:{line:{type:"PERCENT",percent:1.5},after:{type:"ABSOLUTE",absolute:12}}}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-101.4212,width:816,height:1054,top:-217.9122}}],fitModeData:{left:-98,width:816,height:1054,top:-97}},box9:{containerDim:{width:"1000",height:"1000"},themeRef:{strokeRef:{ref:"THEME",color:{tweaks:{shade:.5},type:"A1"}},fillRef:{ref:"THEME",color:{type:"A1"}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},nvOProps:{nvDProps:{id:"A45A6BC8-3D5B-4D6D-A135-1F8C2D5DD596"},nvODProps:{locks:{noAspectChange:!0}}},editable:!0,textBody:{listStyles:[{margin:{left:0},spacing:{line:{type:"PERCENT",percent:1}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}},halign:"LEFT",dir:"LTR"},{margin:{left:48},spacing:{line:{type:"PERCENT",percent:1}},level:2,defPrProps:{size:18,fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}},halign:"LEFT",dir:"LTR"},{margin:{left:96},spacing:{line:{type:"PERCENT",percent:1}},level:3,defPrProps:{size:18,fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}},halign:"LEFT",dir:"LTR"},{margin:{left:144},spacing:{line:{type:"PERCENT",percent:1}},level:4,defPrProps:{size:18,fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}},halign:"LEFT",dir:"LTR"},{margin:{left:192},spacing:{line:{type:"PERCENT",percent:1}},level:5,defPrProps:{size:18,fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}},halign:"LEFT",dir:"LTR"},{margin:{left:240},spacing:{line:{type:"PERCENT",percent:1}},level:6,defPrProps:{size:18,fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}},halign:"LEFT",dir:"LTR"},{margin:{left:288},spacing:{line:{type:"PERCENT",percent:1}},level:7,defPrProps:{size:18,fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}},halign:"LEFT",dir:"LTR"},{margin:{left:336},spacing:{line:{type:"PERCENT",percent:1}},level:8,defPrProps:{size:18,fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}},halign:"LEFT",dir:"LTR"},{margin:{left:384},spacing:{line:{type:"PERCENT",percent:1}},level:9,defPrProps:{size:18,fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}},halign:"LEFT",dir:"LTR"}],paras:[{style:{margin:{left:0},spacing:{line:{type:"PERCENT",percent:1}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}},halign:"RIGHT",dir:"LTR",listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{halign:"RIGHT"}},portions:[{t:"Lorem ipsum",unmerged:{props:{fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},font:{fontFamily:{name:"Roboto"}},bold:!0,size:"18"}},props:{size:"18",fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},bold:!0}}]},{style:{margin:{left:0},spacing:{line:{type:"PERCENT",percent:1}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}},halign:"RIGHT",dir:"LTR",listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{halign:"RIGHT"}},portions:[{t:"dolor sit ketp amet",unmerged:{props:{fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},font:{fontFamily:{name:"Roboto"}},bold:!0,size:"18"}},props:{size:"18",fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},bold:!0}}]},{style:{margin:{left:0},spacing:{line:{type:"PERCENT",percent:1}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}},halign:"RIGHT",dir:"LTR",listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{halign:"RIGHT"}},portions:[{t:"adipis lit",unmerged:{props:{fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},font:{fontFamily:{name:"Roboto"}},bold:!0,size:"18"}},props:{size:"18",fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},bold:!0}}]},{style:{margin:{left:0},spacing:{line:{type:"PERCENT",percent:1}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}},halign:"RIGHT",dir:"LTR",listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{halign:"RIGHT"}},portions:[{unmerged:{props:{fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},font:{fontFamily:{name:"Roboto"}}}},props:{size:18,fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}}}]},{style:{margin:{left:0},spacing:{line:{type:"PERCENT",percent:1}},level:1,defPrProps:{size:18,fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}},halign:"LEFT",dir:"LTR",listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{halign:"LEFT"}},portions:[{unmerged:{props:{fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},font:{fontFamily:{name:"Roboto"}},size:"12"}},props:{size:"12",fill:{solid:{color:{type:"CUSTOM",rgb:[255,255,255]}},type:"SOLID"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"SOLID"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}}},t:"Consectetur adipiscing elit. In sit amet viverra sem. Vivamus in an tellus. Aenean mu sem, convallias eget viverra quis blandit tortor are enim"}]}],linkProps:{underline:"SINGLE",fill:{solid:{color:{rgb:[79,191,201]}},type:"SOLID"}},props:{valign:"TOP",autoFit:{type:"NONE"},inset:{left:9.6,right:9.6,top:4.8,bottom:4.8},column:{num:1,gap:0}},element:"",id:"textcontainer"},type:"SHAPE",props:{transform:{rotate:0,pos:{left:251,top:97},flipv:!1,dim:{width:320.99999999999994,height:336.0857634058236},fliph:!1},fill:{solid:{color:{type:"CUSTOM",rgb:[250,135,152]}},type:"SOLID"},geom:{preset:{type:"TEARDROP"},type:"PRESET"},stroke:{captype:"FLAT",jointype:"ROUND",width:2.6666667,type:"SOLID",fill:{solid:{color:{tweaks:{shade:.5},type:"A1",rgb:[116,149,49]}},type:"NONE"}}},mr:"0.125in",ml:"0.125in",mb:"0.125in",mt:"0.125in",wrapType:"square",textboxTemplate:"boxtype9",fitModeData:{left:-97,width:816,height:1054,top:-97}},box10:{nvOProps:{nvDProps:{id:""}},props:{transform:{fliph:!1,flipv:!1,dim:{width:419.88661,height:445.36727499999995},pos:{top:98,left:250.5},chDim:{width:419.88661,height:445.36727499999995},chPos:{left:2,top:0},rotate:0}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"GROUPSHAPE",shapes:[{nvOProps:{nvDProps:{id:"8BA1A192-C268-4131-89B3-778DBC5842A6"}},props:{transform:{rotate:341,fliph:!1,flipv:!1,dim:{width:54.97507,height:50.569717},pos:{left:363.89419999999996,top:74.91990000000001,zindex:0}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[252,205,25]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:3,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}},geom:{type:"PRESET",preset:{type:"RIGHT_TRIANGLE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-459.89419999999996,width:816,height:1054,top:-171.9199}},{nvOProps:{nvDProps:{id:"B2B5BE20-7A6B-4FD7-AD4B-61A6ABC8C592"}},props:{transform:{rotate:327,fliph:!1,flipv:!1,dim:{width:36.00941,height:19.788202},pos:{left:385.8772,top:285.5625,zindex:1}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[252,205,25]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:3,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}},geom:{type:"PRESET",preset:{type:"RIGHT_TRIANGLE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-481.8772,width:816,height:1054,top:-382.5625}},{nvOProps:{nvDProps:{id:"16CF6D7E-6FBF-4D9D-8909-3DFFA8478B31"}},props:{transform:{rotate:174,fliph:!1,flipv:!1,dim:{width:76.229,height:50.36185},pos:{left:16.69769999999994,top:328.3199,zindex:5}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[253,129,60]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:3,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}},geom:{type:"PRESET",preset:{type:"RIGHT_TRIANGLE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-112.69769999999994,width:816,height:1054,top:-425.3199}},{nvOProps:{nvDProps:{id:"D24DF26E-D007-4BA8-802B-B72F5F29DB29"}},props:{transform:{rotate:118,fliph:!1,flipv:!1,dim:{width:79.99627,height:63.94979},pos:{left:8.556299999999965,top:362.4987,zindex:6}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,159,53]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:3,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}},geom:{type:"PRESET",preset:{type:"RIGHT_TRIANGLE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-104.55629999999996,width:816,height:1054,top:-459.4987}},{nvOProps:{nvDProps:{id:"F4F8E3A2-C1D0-4C29-A60B-204B2DF42201"}},props:{transform:{rotate:65,fliph:!1,flipv:!1,dim:{width:43.915348,height:32.635975},pos:{left:2,top:412.7313,zindex:7}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[253,129,60]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:3,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}},geom:{type:"PRESET",preset:{type:"RIGHT_TRIANGLE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-98,width:816,height:1054,top:-509.7313}},{nvOProps:{nvDProps:{id:"2DFA8226-7B37-4E16-95E5-71C6CE5AE55C"}},props:{transform:{rotate:90,fliph:!1,flipv:!1,dim:{width:256.70544,height:407.73193},pos:{left:91.07770000000005,top:0,zindex:2}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[252,168,45]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:3,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}},geom:{type:"PRESET",preset:{type:"TRAPEZOID",modifiers:[.14652406]}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-187.07770000000005,width:816,height:1054,top:-97}},{nvOProps:{nvDProps:{id:"84CC8916-5D99-4012-8E53-1AF9CA1EBB37"}},props:{transform:{rotate:0,fliph:!1,flipv:!1,dim:{width:365.10123,height:50},pos:{left:36.01610000000005,top:121.15889999999999,zindex:3}},geom:{type:"PRESET",preset:{type:"RECT"}},stroke:{fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{inset:{left:10,top:5,right:10,bottom:5},autoFit:{type:"SHAPE"}},paras:[{portions:[{t:"HEADING",props:{font:{fontFamily:{name:"Open Sans"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"BG1",rgb:[255,255,255]}}},size:14,fontweight:"BOLD",chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{font:{fontFamily:{name:"Open Sans"}},size:14,fontweight:"BOLD",chk:{state:"PROCESSED",lang:"en-US"},fill:{type:"SOLID",solid:{color:{type:"BG1",rgb:[255,255,255]}}}}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-132.01610000000005,width:816,height:1054,top:-218.1589}},{nvOProps:{nvDProps:{id:"4F4127AF-EBC8-4FAA-A119-4E3E14FD8BF9"}},props:{transform:{rotate:0,fliph:!1,flipv:!1,dim:{width:354.17102,height:125.8411},pos:{left:38.34490000000005,top:155.1589,zindex:4}},geom:{type:"PRESET",preset:{type:"RECT"}},stroke:{fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{inset:{left:10,top:5,right:10,bottom:5},autoFit:{type:"SHAPE"}},paras:[{portions:[{t:"CONTENT",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"BG1",rgb:[255,255,255]}}},size:12,chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"PROCESSED",lang:"en-US"},fill:{type:"SOLID",solid:{color:{type:"BG1",rgb:[255,255,255]}}}}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1.25}}},unmerged:{style:{spacing:{line:{type:"PERCENT",percent:1.25}}}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-134.34490000000005,width:816,height:1054,top:-252.1589}}],mr:"0.125in",ml:"0.125in",mb:"0.125in",mt:"0.125in",wrapType:"square",textboxTemplate:"box10",fitModeData:{left:-96,width:818,height:1054,top:-97}},box11:{nvOProps:{nvDProps:{id:"21DBA433-845F-4800-AA7C-380BB83783D4"},nvODProps:{locks:{noAspectChange:!0}}},props:{transform:{fliph:!1,flipv:!1,dim:{width:528.2356199999999,height:421.03037500000005},pos:{top:98,left:250.5},chDim:{width:528.2356199999999,height:421.03037500000005},chPos:{left:-29.403840000000002,top:-12.594025000000002},rotate:0}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"GROUPSHAPE",shapes:[{nvOProps:{nvDProps:{id:"739ECB2C-1779-432D-82AB-0D2D52F5823D"}},props:{transform:{rotate:66,fliph:!1,flipv:!1,dim:{width:64.790276,height:74.35381},pos:{left:-27.60913298828126,top:10.760345000000001,zindex:2}},fill:{type:"SOLID",solid:{color:{type:"TX2",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.75},{mode:"OFFSET",value:.25}]}},rgb:[132,42,79]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}},geom:{type:"PRESET",preset:{type:"MERGE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-68.39086701171874,width:816,height:5350,top:-107.760345}},{nvOProps:{nvDProps:{id:"BBEBC899-3B4D-41B0-8548-2403F4CBB10B"}},props:{transform:{rotate:28,fliph:!1,flipv:!1,dim:{width:69.27676,height:77.375916},pos:{left:351.36350000000004,top:100.38611,zindex:1}},fill:{type:"SOLID",solid:{color:{type:"TX2",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.75},{mode:"OFFSET",value:.25}]}},rgb:[132,42,79]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}},geom:{type:"PRESET",preset:{type:"MERGE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-447.36350000000004,width:816,height:5350,top:-197.38611}},{nvOProps:{nvDProps:{id:"3EB20907-6E10-4077-9E00-9B3ECC931203"}},props:{transform:{rotate:356,fliph:!0,flipv:!1,dim:{width:254.49324,height:399.6603},pos:{left:21.215030000000013,top:-12.594025000000002,zindex:4}},fill:{type:"SOLID",solid:{color:{type:"A5",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.6},{mode:"OFFSET",value:.4}]}},rgb:[218,135,169]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}},geom:{type:"PRESET",preset:{type:"MANUAL_INPUT"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-117.21503000000001,width:816,height:5350,top:-84.405975}},{nvOProps:{nvDProps:{id:"944579CF-A4E0-493F-9507-D217183FFBA9"}},props:{transform:{rotate:326,fliph:!1,flipv:!1,dim:{width:246.01312,height:244.40385},pos:{left:252.81866000000002,top:81.37935999999999,zindex:6}},fill:{type:"SOLID",solid:{color:{type:"A5",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.6},{mode:"OFFSET",value:.4}]}},rgb:[218,135,169]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:3,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}},geom:{type:"PRESET",preset:{type:"DIAGONAL_STRIPE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-348.81866,width:816,height:5350,top:-178.37936}},{nvOProps:{nvDProps:{id:"B73B2C90-4F86-4B43-AED4-656A997E4F4F"}},props:{transform:{rotate:5,fliph:!1,flipv:!1,dim:{width:405.97302,height:342.3368},pos:{left:-7.964499999999987,top:12.47448,zindex:3}},fill:{type:"SOLID",solid:{color:{type:"A5",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.6},{mode:"OFFSET",value:.4}]}},rgb:[218,135,169]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}},geom:{type:"PRESET",preset:{type:"MANUAL_OPERATION"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-88.03550000000001,width:816,height:5350,top:-109.47448}},{nvOProps:{nvDProps:{id:"F117FFF3-8305-453D-AE11-F172764D8A64"}},props:{transform:{rotate:183,fliph:!1,flipv:!1,dim:{width:305.33813,height:219.04015},pos:{left:40.52956999999998,top:189.39620000000002,zindex:5}},fill:{type:"SOLID",solid:{color:{type:"A5",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.6},{mode:"OFFSET",value:.4}]}},rgb:[218,135,169]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}},geom:{type:"PRESET",preset:{type:"MANUAL_INPUT"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-136.52956999999998,width:816,height:5350,top:-286.3962}},{nvOProps:{nvDProps:{id:"16C587D1-5E5F-465E-9DB6-D286D9B71CCD"}},props:{transform:{rotate:0,fliph:!1,flipv:!1,dim:{width:314.78198,height:234.42567},pos:{left:36.608299999999986,top:137.42567,zindex:9}},geom:{type:"PRESET",preset:{type:"RECT"}},stroke:{fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{inset:{left:10,top:5,right:10,bottom:5},autoFit:{type:"SHAPE"}},paras:[{portions:[{props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"BG1",rgb:[255,255,255]}}},size:11,fontweight:"LIGHT",stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"BG1",rgb:[255,255,255]}}},size:11,fontweight:"LIGHT"}},t:"CONTENT"}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1.5},after:{type:"ABSOLUTE",absolute:12}}},unmerged:{style:{spacing:{line:{type:"PERCENT",percent:1.5},after:{type:"ABSOLUTE",absolute:12}}}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-132.60829999999999,width:816,height:5350,top:-234.42567}},{nvOProps:{nvDProps:{id:"55426ECA-BD50-41A7-8567-8718CC81D92F"}},props:{transform:{rotate:0,fliph:!1,flipv:!1,dim:{width:464.29053,height:61.114864},pos:{left:-29.403840000000002,top:60.79732000000001,zindex:7}},fill:{type:"SOLID",solid:{color:{type:"TX2",tweaks:{hsl:{luminance:[{mode:"MODIFY",value:.5},{mode:"OFFSET",value:.5}]}},rgb:[201,85,132]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}},geom:{type:"PRESET",preset:{type:"RECT"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-66.59616,width:816,height:5350,top:-157.79732}},{nvOProps:{nvDProps:{id:"66880854-8B1A-4A87-BA47-AA756A8BF6F9"}},props:{transform:{rotate:0,fliph:!1,flipv:!1,dim:{width:464.1525,height:61.114864},pos:{left:-29.403840000000002,top:60.79732000000001,zindex:8}},geom:{type:"PRESET",preset:{type:"RECT"}},stroke:{fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",inset:{left:10,top:5,right:10,bottom:5},autoFit:{type:"SHAPE"}},paras:[{portions:[{t:"HEADING",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"BG1",rgb:[255,255,255]}}},size:20,stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"BG1",rgb:[255,255,255]}}},size:20}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-66.59616,width:816,height:5350,top:-157.79732}}],mr:"0.125in",ml:"0.125in",mb:"0.125in",mt:"0.125in",wrapType:"square",textboxTemplate:"box11",fitModeData:{left:-96,width:818,height:1054,top:-97}},quotes1:{nvOProps:{nvDProps:{id:"A8C93025-92AA-48A0-8377-CD3536837EF5"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:300,height:300},pos:{top:98,left:250.5},chDim:{width:300,height:300},chPos:{left:40,top:36},rotate:0}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"GROUPSHAPE",shapes:[{nvOProps:{nvDProps:{id:"B897E10E-4DB4-4FEB-9FD9-428D54F91442"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:300,height:300},pos:{left:40,top:36,zindex:1},rotate:0},geom:{type:"PRESET",preset:{type:"RECT"}},fill:{type:"PICT",pict:{type:{type:"FRAME"},value:{id:"B897E10E-4DB4-4FEB-9FD9-428D54F91442",type:"USERDEFINED",pictureName:"ImageB897E10E-4DB4-4FEB-9FD9-428D54F91442.jpg",serverUrl:"",url:"",dim:{width:300,height:300},width:300,height:300}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{paras:[{portions:[{t:"",props:{size:11,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:[255,255,255]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"Arial"}}},unmerged:{props:{size:11,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:[255,255,255]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"Arial"}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}},listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}}}},listNum:!1}],props:{column:{num:1,gap:0},valign:"MIDDLE",inset:{left:0,right:0,top:0,bottom:0},autoFit:{type:"NONE"},wrap:"NONE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-136,width:816,height:1054,top:-133}},{nvOProps:{nvDProps:{id:"E642364E-916F-4AAB-A728-5A2D21FBA34E"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:217,height:203},pos:{left:83,top:94,zindex:2},rotate:0},geom:{type:"PRESET",preset:{type:"RECT"}},fill:{type:"NONE"},stroke:{type:"DASH",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{paras:[{portions:[{t:"CONTENT",props:{size:12,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:["64"," 64"," 64"]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"open sans"}},"":"",italic:!0},unmerged:{props:{size:12,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:["64"," 64"," 64"]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"open sans"}},"":"",italic:!0}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}}}},listNum:!1}],props:{column:{num:1,gap:0},valign:"MIDDLE",inset:{left:0,right:0,top:0,bottom:0},autoFit:{type:"NONE"},wrap:"NONE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-179,width:816,height:1054,top:-191}}],mr:"0.125in",ml:"0.125in",mb:"0.125in",mt:"0.125in",wrapType:"square",textboxTemplate:"quotes1",fitModeData:{left:-96,width:818,height:1054,top:-97}},quotes2:{nvOProps:{nvDProps:{id:"12DB8123-424D-4D22-85ED-9BDA4C2FB41F"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:300,height:300},pos:{top:98,left:250.5},chDim:{width:300,height:300},chPos:{left:40,top:36},rotate:0}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"GROUPSHAPE",shapes:[{nvOProps:{nvDProps:{id:"896AE1AC-B241-4F7F-9412-11FDF40175C1"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:300,height:300},pos:{left:40,top:36,zindex:1},rotate:0},geom:{type:"PRESET",preset:{type:"RECT"}},fill:{type:"PICT",pict:{type:{type:"FRAME"},value:{id:"896AE1AC-B241-4F7F-9412-11FDF40175C1",type:"USERDEFINED",pictureName:"Image896AE1AC-B241-4F7F-9412-11FDF40175C1.jpg",serverUrl:"",url:"",dim:{width:300,height:300},width:300,height:300}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{paras:[{portions:[{t:"",props:{size:11,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:[255,255,255]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"Arial"}}},unmerged:{props:{size:11,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:[255,255,255]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"Arial"}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}},listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}}}},listNum:!1}],props:{column:{num:1,gap:0},valign:"MIDDLE",inset:{left:0,right:0,top:0,bottom:0},autoFit:{type:"NONE"},wrap:"NONE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-136,width:816,height:1054,top:-133}},{nvOProps:{nvDProps:{id:"601632BC-8953-4011-9DC9-E6E5C1AF5F01"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:217,height:203},pos:{left:83,top:94,zindex:2},rotate:0},geom:{type:"PRESET",preset:{type:"RECT"}},fill:{type:"NONE"},stroke:{type:"DASH",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{paras:[{portions:[{t:"CONTENT",props:{size:12,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:["64"," 64"," 64"]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"open sans"}},"":"",italic:!0},unmerged:{props:{size:12,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:["64"," 64"," 64"]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"open sans"}},"":"",italic:!0}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}}}},listNum:!1}],props:{column:{num:1,gap:0},valign:"MIDDLE",inset:{left:0,right:0,top:0,bottom:0},autoFit:{type:"NONE"},wrap:"NONE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-179,width:816,height:1054,top:-191}}],mr:"0.125in",ml:"0.125in",mb:"0.125in",mt:"0.125in",wrapType:"square",textboxTemplate:"quotes2",fitModeData:{left:-96,width:818,height:1054,top:-97}},quotes3:{nvOProps:{nvDProps:{id:"4815069D-E797-4A30-8F2F-804DD34E7558"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:300,height:300},pos:{top:98,left:250.5},chDim:{width:300,height:300},chPos:{left:40,top:36},rotate:0}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"GROUPSHAPE",shapes:[{nvOProps:{nvDProps:{id:"7E64A8E0-17B1-4426-931A-B0DC116CA144"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:300,height:300},pos:{left:40,top:36,zindex:1},rotate:0},geom:{type:"PRESET",preset:{type:"RECT"}},fill:{type:"PICT",pict:{type:{type:"FRAME"},value:{id:"7E64A8E0-17B1-4426-931A-B0DC116CA144",type:"USERDEFINED",pictureName:"Image7E64A8E0-17B1-4426-931A-B0DC116CA144.jpg",serverUrl:"",url:"",dim:{width:300,height:300},width:300,height:300}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{paras:[{portions:[{t:"",props:{size:11,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:[255,255,255]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"Arial"}}},unmerged:{props:{size:11,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:[255,255,255]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"Arial"}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}},listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}}}},listNum:!1}],props:{column:{num:1,gap:0},valign:"MIDDLE",inset:{left:0,right:0,top:0,bottom:0},autoFit:{type:"NONE"},wrap:"NONE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-136,width:816,height:1054,top:-133}},{nvOProps:{nvDProps:{id:"B404F037-DDB2-44CD-9FFE-29638F847F66"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:217,height:203},pos:{left:83,top:94,zindex:2},rotate:0},geom:{type:"PRESET",preset:{type:"RECT"}},fill:{type:"NONE"},stroke:{type:"DASH",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{paras:[{portions:[{t:"CONTENT",props:{size:12,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:["64"," 64"," 64"]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"open sans"}},"":"",italic:!0},unmerged:{props:{size:12,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:["64"," 64"," 64"]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"open sans"}},"":"",italic:!0}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}}}},listNum:!1}],props:{column:{num:1,gap:0},valign:"MIDDLE",inset:{left:0,right:0,top:0,bottom:0},autoFit:{type:"NONE"},wrap:"NONE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-179,width:816,height:1054,top:-191}}],mr:"0.125in",ml:"0.125in",mb:"0.125in",mt:"0.125in",wrapType:"square",textboxTemplate:"quotes3",fitModeData:{left:-96,width:818,height:1054,top:-97}},quotes4:{nvOProps:{nvDProps:{id:"BF5C91C2-8EC3-495B-AE21-31139F91519E"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:300,height:300},pos:{top:98,left:250.5},chDim:{width:300,height:300},chPos:{left:40,top:36},rotate:0}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"GROUPSHAPE",shapes:[{nvOProps:{nvDProps:{id:"4D804144-D3A8-4EC5-887F-EABD9E029E04"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:300,height:300},pos:{left:40,top:36,zindex:1},rotate:0},geom:{type:"PRESET",preset:{type:"RECT"}},fill:{type:"PICT",pict:{type:{type:"FRAME"},value:{id:"4D804144-D3A8-4EC5-887F-EABD9E029E04",type:"USERDEFINED",pictureName:"Image4D804144-D3A8-4EC5-887F-EABD9E029E04.jpg",serverUrl:"",url:"",dim:{width:300,height:300},width:300,height:300}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{paras:[{portions:[{t:"",props:{size:11,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:[255,255,255]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"Arial"}}},unmerged:{props:{size:11,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:[255,255,255]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"Arial"}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}},listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}}}},listNum:!1}],props:{column:{num:1,gap:0},valign:"MIDDLE",inset:{left:0,right:0,top:0,bottom:0},autoFit:{type:"NONE"},wrap:"NONE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-136,width:816,height:1054,top:-133}},{nvOProps:{nvDProps:{id:"26FBFE11-AADE-43C9-AFBA-6DBC4B7FFD54"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:217,height:203},pos:{left:83,top:94,zindex:2},rotate:0},geom:{type:"PRESET",preset:{type:"RECT"}},fill:{type:"NONE"},stroke:{type:"DASH",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{paras:[{portions:[{t:"CONTENT",props:{size:12,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:["64"," 64"," 64"]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"open sans"}},"":"",italic:!0},unmerged:{props:{size:12,fill:{type:"SOLID",solid:{color:{type:"A1",rgb:["64"," 64"," 64"]}}},stroke:{type:"SOLID",captype:"FLAT",jointype:"ROUND",width:1,fill:{type:"NONE"}},font:{fontFamily:{name:"open sans"}},"":"",italic:!0}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Arial"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:{0:0,1:0,2:0}}}},size:18,stroke:{type:"SOLID",width:2.6666667,fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[56,93,138]}}},captype:"FLAT"}},spacing:{line:{type:"PERCENT",percent:"1"}}}},listNum:!1}],props:{column:{num:1,gap:0},valign:"MIDDLE",inset:{left:0,right:0,top:0,bottom:0},autoFit:{type:"NONE"},wrap:"NONE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-179,width:816,height:1054,top:-191}}],mr:"0.125in",ml:"0.125in",mb:"0.125in",mt:"0.125in",wrapType:"square",textboxTemplate:"quotes4",fitModeData:{left:-96,width:818,height:1054,top:-97}},col1:{nvOProps:{nvDProps:{id:"6D8AB100-FBB2-468E-9609-5A47BD6390D8"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:249.99999999999994,height:789},pos:{left:160,top:97},chDim:{width:249.99999999999994,height:789},chPos:{left:-89,top:0},rotate:0}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"GROUPSHAPE",shapes:[{nvOProps:{nvDProps:{id:"1E15F380-E52F-45BA-B298-D8C3B1A196D1"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:249.99999999999994,height:789},pos:{left:-89,top:0,zindex:0},rotate:0},geom:{type:"PRESET",preset:{type:"RECT"}},fill:{type:"PICT",pict:{type:{type:"FRAME"},value:{id:"1E15F380-E52F-45BA-B298-D8C3B1A196D1",type:"USERDEFINED",pictureName:"Image1E15F380-E52F-45BA-B298-D8C3B1A196D1.jpg",serverUrl:"",url:"",dim:{width:789,height:271.3333333333333},width:789,height:271.3333333333333}}},stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{column:{num:1,gap:0},valign:"MIDDLE",autoFit:{type:"NONE"},inset:{left:9.6,right:9.6,top:4.8,bottom:4.8}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}},listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{halign:"CENTER"}},listNum:!1}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-7,width:816,height:1054,top:-97}},{nvOProps:{nvDProps:{id:"7BD51CEE-E077-4FD4-AC06-ECF37630E1C7"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:184.16370106761562,height:135.20422535211267},pos:{left:-88.2054,top:36.72989999999999,zindex:1},rotate:0},geom:{type:"PRESET",preset:{type:"RECT"}},stroke:{fill:{type:"NONE"},jointype:"ROUND",width:0}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{column:{num:1,gap:0},inset:{left:10,right:10,top:5,bottom:5},autoFit:{type:"SHAPE"},valign:"top"},paras:[{portions:[{t:"Lorem ",props:{font:{fontFamily:{name:"arial black,avant garde"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:28,fontweight:"BOLD",chk:{lang:"en-US",state:"PROCESSED"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fontweight:"BOLD",font:{fontFamily:{name:"arial black,avant garde"}},size:28,chk:{lang:"en-US",state:"PROCESSED"}}}},{t:"Ipsum",props:{font:{fontFamily:{name:"arial black,avant garde"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:28,fontweight:"BOLD",chk:{lang:"en-US",state:"ERROR"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fontweight:"BOLD",font:{fontFamily:{name:"arial black,avant garde"}},size:28,chk:{lang:"en-US",state:"ERROR"}}}},{t:" ",props:{font:{fontFamily:{name:"arial black,avant garde"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:28,fontweight:"BOLD",chk:{lang:"en-US",state:"PROCESSED"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fontweight:"BOLD",font:{fontFamily:{name:"arial black,avant garde"}},size:28,chk:{lang:"en-US",state:"PROCESSED"}}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{}},listNum:!1},{portions:[{t:"dolor.",props:{font:{fontFamily:{name:"arial black,avant garde"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:28,fontweight:"BOLD",chk:{lang:"en-US",state:"PROCESSED"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fontweight:"BOLD",font:{fontFamily:{name:"arial black,avant garde"}},size:28,chk:{lang:"en-US",state:"PROCESSED"}}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{}},listNum:!1}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-7.794600000000003,width:816,height:1054,top:-133.7299}},{nvOProps:{nvDProps:{id:"B017E25C-B199-4058-91B9-F3D79B3CE407"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:208.2472470949097,height:507.0000000000001},pos:{left:-88.88570000000004,top:196,zindex:2},rotate:0},geom:{type:"PRESET",preset:{type:"RECT"}},stroke:{fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{inset:{left:10,top:5,right:10,bottom:5},autoFit:{type:"SHAPE"}},paras:[{portions:[{props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",chk:{lang:"en-US",state:"PROCESSED"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{chk:{lang:"en-US",state:"PROCESSED"},size:"12"}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:"1.2"}},listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{spacing:{line:{percent:"1.2",type:"PERCENT"}}}}},{portions:[{t:"Lorem ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",chk:{lang:"en-US",state:"PROCESSED"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{chk:{lang:"en-US",state:"PROCESSED"},size:"12"}}},{t:"Ipsum",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",chk:{lang:"en-US",state:"ERROR"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{chk:{lang:"en-US",state:"ERROR"},size:"12"}}},{t:" is simply dummy text of the printing and typesetting industry. Lorem ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",chk:{lang:"en-US",state:"PROCESSED"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{chk:{lang:"en-US",state:"PROCESSED"},size:"12"}}},{t:"Ipsum",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",chk:{lang:"en-US",state:"ERROR"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{chk:{lang:"en-US",state:"ERROR"},size:"12"}}},{t:" has been the industry's standard dummy text ever since the  specimen book. ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:"12"}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:"1.2"}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{spacing:{line:{percent:"1.2",type:"PERCENT"}}}}},{portions:[{props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:"12"}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:"1.2"}},listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{spacing:{line:{percent:"1.2",type:"PERCENT"}}}}},{portions:[{props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:"12"}},t:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:"1.2"}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{spacing:{line:{percent:"1.2",type:"PERCENT"}}}}},{portions:[{props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:"12"}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:"1.2"}},listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{spacing:{line:{percent:"1.2",type:"PERCENT"}}}}},{portions:[{props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:"12"}},t:"Ut enim ad minim veniam, quis nostrud exercitation ullamoc laboris"}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:"1.2"}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{spacing:{line:{percent:"1.2",type:"PERCENT"}}}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-7.114299999999957,width:816,height:1054,top:-293}}],fitModeData:{left:-7,width:816,height:1054,top:-97},maintainLayout:!0},col2:{nvOProps:{nvDProps:{id:"2B8533EF-1177-4A40-980D-27856A3922C4"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:246.99999999999997,height:789},pos:{left:160,top:97},chDim:{width:246.99999999999997,height:789},chPos:{left:-89,top:0},rotate:0}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"GROUPSHAPE",shapes:[{nvOProps:{nvDProps:{id:"7C66DFD0-95DD-4DE6-A92B-19EF1D45B095"}},props:{transform:{rotate:0,fliph:!1,flipv:!1,dim:{width:246.99999999999997,height:789},pos:{left:-89,top:0,zindex:0}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,252,233]}}},stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}},geom:{type:"PRESET",preset:{type:"RECT"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-7,width:816,height:1054,top:-97}},{nvOProps:{nvDProps:{id:"1E21B894-5B6D-44DC-97F3-4A86D7891D13"}},props:{transform:{rotate:180,fliph:!0,flipv:!0,dim:{width:.701197113804547,height:786.1821186568379},pos:{left:-85.51840000000004,top:0,zindex:1}},stroke:{jointype:"ROUND",captype:"FLAT",width:10,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[251,188,65]}}}},geom:{type:"PRESET",preset:{type:"LINE",modifiers:[.5]}},fill:{type:"SOLID",solid:{color:{type:"A1",rgb:[160,203,70]}}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-10.481599999999958,width:816,height:1054,top:-97}},{nvOProps:{nvDProps:{id:"2A4915F5-7059-41F8-A84B-259FD4DA1487"}},props:{transform:{rotate:0,fliph:!1,flipv:!1,dim:{width:222.23481881989204,height:85.8696},pos:{left:-71.48410000000001,top:52.13040000000001,zindex:2}},geom:{type:"PRESET",preset:{type:"RECT"}},stroke:{fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{inset:{left:10,top:5,right:10,bottom:5},autoFit:{type:"SHAPE"}},paras:[{portions:[{t:"Lorem",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[253,188,77]}}},size:"20",fontweight:"BOLD",chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[253,188,77]}}},fontweight:"BOLD",chk:{state:"PROCESSED",lang:"en-US"},size:"20"}}},{t:" ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[253,188,77]}}},size:"20",fontweight:"BOLD",chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[253,188,77]}}},fontweight:"BOLD",chk:{state:"PROCESSED",lang:"en-US"},size:"20"}}},{t:"Ipsum",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[253,188,77]}}},size:"20",fontweight:"BOLD",chk:{state:"ERROR",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[253,188,77]}}},fontweight:"BOLD",chk:{state:"ERROR",lang:"en-US"},size:"20"}}},{t:" is simply dummy.",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[253,188,77]}}},size:"20",fontweight:"BOLD",stroke:{fill:{type:"NONE"}}},unmerged:{props:{fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[253,188,77]}}},fontweight:"BOLD",size:"20"}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-24.515899999999988,width:816,height:1054,top:-149.1304}},{nvOProps:{nvDProps:{id:"6575E9E1-0C67-49C1-B8C4-B16CB7DC1D8B"}},props:{transform:{rotate:0,fliph:!1,flipv:!1,dim:{width:215.06595482763282,height:619.9285443588791},pos:{left:-72.7876,top:143.07139999999998,zindex:3}},geom:{type:"PRESET",preset:{type:"RECT"}},stroke:{fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{inset:{left:10,top:5,right:10,bottom:5},autoFit:{type:"SHAPE"}},paras:[{portions:[{t:"Lorem",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,chk:{state:"ERROR",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"ERROR",lang:"en-US"}}}},{t:" ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"PROCESSED",lang:"en-US"}}}},{t:"Ipsum",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,chk:{state:"ERROR",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"ERROR",lang:"en-US"}}}},{t:" is simply dummy text of the printing and typesetting industry. ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"PROCESSED",lang:"en-US"}}}},{t:"Lorem",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,chk:{state:"ERROR",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"ERROR",lang:"en-US"}}}},{t:" ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"PROCESSED",lang:"en-US"}}}},{t:"Ipsum",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,chk:{state:"ERROR",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"ERROR",lang:"en-US"}}}},{t:" has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged.",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"PROCESSED",lang:"en-US"}}}},{t:"Lorem",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,chk:{state:"ERROR",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"ERROR",lang:"en-US"}}}},{t:" ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"PROCESSED",lang:"en-US"}}}},{t:"Ipsum",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,chk:{state:"ERROR",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"ERROR",lang:"en-US"}}}},{t:" is simply dummy text of the printing and typesetting industry. ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"PROCESSED",lang:"en-US"}}}},{t:"Lorem",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,chk:{state:"ERROR",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"ERROR",lang:"en-US"}}}},{t:" ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,chk:{state:"PROCESSED",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"PROCESSED",lang:"en-US"}}}},{t:"Ipsum",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,chk:{state:"ERROR",lang:"en-US"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12,chk:{state:"ERROR",lang:"en-US"}}}},{t:" has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.   ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:12,stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:12}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:"1.2"}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{spacing:{line:{percent:"1.2",type:"PERCENT"}}}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-23.212400000000002,width:816,height:1054,top:-240.07139999999998}}],fitModeData:{left:-7,width:816,height:1054,top:-97},maintainLayout:!0},col3:{nvOProps:{nvDProps:{id:"18B2138A-2C7C-4301-A720-2BD9563E9634"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:243.99996178490608,height:789},pos:{left:160,top:97},chDim:{width:243.99996178490608,height:789},chPos:{left:-89,top:0},rotate:0}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"GROUPSHAPE",shapes:[{nvOProps:{nvDProps:{id:"EFCF3CE2-58AB-4704-9434-E3386855E34E"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:64.07253134490031,height:789},pos:{left:-89,top:0,zindex:1},rotate:0},geom:{type:"PRESET",preset:{type:"RECT"}},fill:{type:"PICT",pict:{type:{type:"FRAME"},value:{id:"EFCF3CE2-58AB-4704-9434-E3386855E34E",type:"USERDEFINED",pictureName:"ImageEFCF3CE2-58AB-4704-9434-E3386855E34E.jpg",serverUrl:"",url:"",dim:{width:803,height:74},width:803,height:74}}},stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"NONE",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{valign:"MIDDLE",autoFit:{type:"NONE"}},paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}}}},props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}}}],style:{halign:"CENTER",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{halign:"CENTER"}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"CUSTOM",rgb:[255,255,255]}}},size:18,stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,type:"SOLID",fill:{type:"SOLID",solid:{color:{type:"A1",tweaks:{shade:.5},rgb:[116,149,49]}}}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:""},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-7,width:816,height:1054,top:-97}},{nvOProps:{nvDProps:{id:"09F4F21B-988F-4D53-AD04-2D8B8EB6C813"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:179.22991876208602,height:135.20422535211267},pos:{left:-50.90280000000001,top:35.72989999999999,zindex:0},rotate:0},geom:{type:"PRESET",preset:{type:"RECT"}},stroke:{fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{inset:{left:10,right:10,top:5,bottom:5},autoFit:{type:"SHAPE"},valign:"top",column:{num:1,gap:0}},paras:[{portions:[{t:"Lorem ",props:{font:{fontFamily:{name:"arial black,avant garde"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:["94"," 196"," 208"]}}},size:28,fontweight:"BOLD",chk:{lang:"en-US",state:"PROCESSED"},stroke:{fill:{type:"NONE"}},"":""},unmerged:{props:{fontweight:"BOLD",font:{fontFamily:{name:"arial black,avant garde"}},size:28,chk:{lang:"en-US",state:"PROCESSED"},fill:{type:"SOLID",solid:{color:{rgb:["94"," 196"," 208"]}}},"":""}}},{t:"Ipsum",props:{font:{fontFamily:{name:"arial black,avant garde"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:["94"," 196"," 208"]}}},size:28,fontweight:"BOLD",chk:{lang:"en-US",state:"ERROR"},stroke:{fill:{type:"NONE"}},"":""},unmerged:{props:{fontweight:"BOLD",font:{fontFamily:{name:"arial black,avant garde"}},size:28,chk:{lang:"en-US",state:"ERROR"},fill:{type:"SOLID",solid:{color:{rgb:["94"," 196"," 208"]}}},"":""}}},{t:" ",props:{font:{fontFamily:{name:"arial black,avant garde"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:["94"," 196"," 208"]}}},size:28,fontweight:"BOLD",chk:{lang:"en-US",state:"PROCESSED"},stroke:{fill:{type:"NONE"}},"":""},unmerged:{props:{fontweight:"BOLD",font:{fontFamily:{name:"arial black,avant garde"}},size:28,chk:{lang:"en-US",state:"PROCESSED"},fill:{type:"SOLID",solid:{color:{rgb:["94"," 196"," 208"]}}},"":""}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{}}},{portions:[{t:"dolor.",props:{font:{fontFamily:{name:"arial black,avant garde"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:["94"," 196"," 208"]}}},size:28,fontweight:"BOLD",chk:{lang:"en-US",state:"PROCESSED"},stroke:{fill:{type:"NONE"}},"":""},unmerged:{props:{fontweight:"BOLD",font:{fontFamily:{name:"arial black,avant garde"}},size:28,chk:{lang:"en-US",state:"PROCESSED"},fill:{type:"SOLID",solid:{color:{rgb:["94"," 196"," 208"]}}},"":""}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},unmerged:{style:{}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-45.09719999999999,width:816,height:1054,top:-132.7299}},{nvOProps:{nvDProps:{id:"175AD4B5-8775-4AC9-83C0-BE75544241C6"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:202.66826178490612,height:520},pos:{left:-47.668300000000045,top:180,zindex:2},rotate:0},geom:{type:"PRESET",preset:{type:"RECT"}},stroke:{fill:{type:"NONE"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{props:{inset:{left:10,right:10,top:5,bottom:5},autoFit:{type:"SHAPE"},valign:"top",column:{num:1,gap:0}},paras:[{portions:[{props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",chk:{lang:"en-US",state:"PROCESSED"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{chk:{lang:"en-US",state:"PROCESSED"},size:"12"}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:"1.2"}},listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{spacing:{line:{percent:"1.2",type:"PERCENT"}}}}},{portions:[{t:"Lorem ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",chk:{lang:"en-US",state:"PROCESSED"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{chk:{lang:"en-US",state:"PROCESSED"},size:"12"}}},{t:"Ipsum",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",chk:{lang:"en-US",state:"ERROR"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{chk:{lang:"en-US",state:"ERROR"},size:"12"}}},{t:" is simply dummy text of the printing and typesetting industry. Lorem ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",chk:{lang:"en-US",state:"PROCESSED"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{chk:{lang:"en-US",state:"PROCESSED"},size:"12"}}},{t:"Ipsum",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",chk:{lang:"en-US",state:"ERROR"},stroke:{fill:{type:"NONE"}}},unmerged:{props:{chk:{lang:"en-US",state:"ERROR"},size:"12"}}},{t:" has been the industry's standard dummy text ever since the  specimen book. ",props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:"12"}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:"1.2"}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{spacing:{line:{percent:"1.2",type:"PERCENT"}}}}},{portions:[{props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:"12"}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:"1.2"}},listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{spacing:{line:{percent:"1.2",type:"PERCENT"}}}}},{portions:[{props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:"12"}},t:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:"1.2"}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{spacing:{line:{percent:"1.2",type:"PERCENT"}}}}},{portions:[{props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:"12"}}}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:"1.2"}},listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{spacing:{line:{percent:"1.2",type:"PERCENT"}}}}},{portions:[{props:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:"12",stroke:{fill:{type:"NONE"}}},unmerged:{props:{size:"12"}},t:"Ut enim ad minim veniam, quis nostrud exercitation ullamoc laboris"}],style:{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:"1.2"}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{spacing:{line:{percent:"1.2",type:"PERCENT"}}}}}],listStyles:[{halign:"LEFT",level:1,margin:{left:0},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:2,margin:{left:48},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:3,margin:{left:96},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:4,margin:{left:144},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:5,margin:{left:192},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:6,margin:{left:240},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:7,margin:{left:288},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:8,margin:{left:336},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}},{halign:"LEFT",level:9,margin:{left:384},dir:"LTR",defPrProps:{font:{fontFamily:{name:"Roboto"},ref:"MINOR"},fill:{type:"SOLID",solid:{color:{type:"TX1",rgb:[0,0,0]}}},size:18,stroke:{fill:{type:"NONE"}}},spacing:{line:{type:"PERCENT",percent:1}}}],linkProps:{fill:{type:"SOLID",solid:{color:{rgb:[79,191,201]}}},underline:"SINGLE"},element:"",id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-48.331699999999955,width:816,height:1054,top:-277}}],fitModeData:{left:-7,width:816,height:1054,top:-97},maintainLayout:!0},col4:{nvOProps:{nvDProps:{id:"7821BC0D-70CB-4695-84E7-9FC6E5420F1C"}},props:{transform:{fliph:!1,flipv:!1,dim:{width:266.98877155550207,height:789},pos:{left:164.3446,top:97},chDim:{width:266.98877155550207,height:789},chPos:{left:-84.65539999999999,top:0},rotate:0}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},type:"GROUPSHAPE",shapes:[{nvOProps:{nvDProps:{id:"EB05D78C-5B72-4A98-AB95-E564C33FDF76"}},props:{transform:{dim:{width:19.137079454997757,height:27.06972529638011},rotate:180,flipv:!1,fliph:!1,pos:{left:-84,top:94.6659,zindex:0}},stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"NONE"},type:"SOLID"},fill:{solid:{color:{rgb:[227,24,20],type:"CUSTOM"}},type:"SOLID"},geom:{preset:{type:"RIGHT_TRIANGLE"},type:"PRESET"}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{element:"",listStyles:[{halign:"LEFT",level:1,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:2,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:48},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:3,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:96},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:4,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:144},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:5,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:192},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:6,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:240},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:7,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:288},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:8,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:336},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:9,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:384},spacing:{line:{percent:1,type:"PERCENT"}}}],paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"}}},props:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18}}],style:{halign:"CENTER",level:1,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:1,type:"PERCENT"}}},unmerged:{style:{halign:"CENTER"}}}],linkProps:{fill:{solid:{color:{rgb:[79,191,201]}},type:"SOLID"},underline:"SINGLE"},props:{autoFit:{type:"NONE"},valign:"MIDDLE"}},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-12,width:816,height:1054,top:-191.6659}},{nvOProps:{nvDProps:{id:"A02AE498-97D4-461B-87D2-F7F01A5454A8"}},props:{transform:{dim:{height:789,width:252.19627155550205},rotate:0,flipv:!1,fliph:!1,pos:{left:-69.86289999999997,top:0,zindex:1}},stroke:{jointype:"ROUND",captype:"FLAT",width:1,fill:{solid:{color:{tweaks:{hsl:{luminance:[{value:.85,mode:"MODIFY"}]}},rgb:[217,217,217],type:"BG1"}},type:"SOLID"},type:"SOLID"},fill:{solid:{color:{rgb:[255,255,255],type:"BG1"}},type:"SOLID"},geom:{preset:{type:"RECT"},type:"PRESET"},effects:{shadow:{distance:{radius:10,angle:45},color:{tweaks:{alpha:.81},rgb:[63,63,63],type:"CUSTOM"},blur:{radius:4},type:"OUTER"}}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{element:"",listStyles:[{halign:"LEFT",level:1,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:2,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:48},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:3,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:96},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:4,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:144},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:5,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:192},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:6,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:240},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:7,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:288},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:8,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:336},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:9,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:384},spacing:{line:{percent:1,type:"PERCENT"}}}],paras:[{portions:[{unmerged:{props:{font:{fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"}}},props:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18}}],style:{halign:"CENTER",level:1,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:1,type:"PERCENT"}}},unmerged:{style:{halign:"CENTER"}}}],linkProps:{fill:{solid:{color:{rgb:[79,191,201]}},type:"SOLID"},underline:"SINGLE"},props:{autoFit:{type:"NONE"},valign:"MIDDLE"}},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-26.137100000000032,width:816,height:1054,top:-97}},{nvOProps:{nvDProps:{id:"40D62247-0E54-49CC-A634-4C514E12A640"}},props:{transform:{dim:{width:207.93918726816636,height:50.166799999999995},rotate:0,flipv:!1,fliph:!1,pos:{left:-84.65539999999999,top:44.833200000000005,zindex:2}},stroke:{jointype:"ROUND",captype:"FLAT",width:3,fill:{solid:{color:{rgb:[239,161,76],type:"CUSTOM"}},type:"NONE"},type:"SOLID"},fill:{solid:{color:{rgb:[245,111,93],type:"CUSTOM"}},type:"SOLID"},geom:{preset:{type:"PENTAGON_ARROW",modifiers:[.59800947]},type:"PRESET"}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{element:"",listStyles:[{halign:"LEFT",level:1,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:2,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:48},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:3,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:96},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:4,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:144},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:5,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:192},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:6,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:240},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:7,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:288},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:8,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:336},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:9,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:384},spacing:{line:{percent:1,type:"PERCENT"}}}],paras:[{portions:[{t:"Lorem",unmerged:{props:{fontweight:"BOLD",chk:{state:"ERROR",lang:"en-US"},font:{fontFamily:{name:"Open Sans"}},fill:{solid:{color:{rgb:[255,255,255],type:"BG1"}},type:"SOLID"},size:"18"}},props:{fontweight:"BOLD",stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},chk:{state:"ERROR",lang:"en-US"},font:{ref:"MINOR",fontFamily:{name:"Open Sans"}},fill:{solid:{color:{rgb:[255,255,255],type:"BG1"}},type:"SOLID"},size:"18"}},{t:" ",unmerged:{props:{fontweight:"BOLD",chk:{state:"PROCESSED",lang:"en-US"},font:{fontFamily:{name:"Open Sans"}},fill:{solid:{color:{rgb:[255,255,255],type:"BG1"}},type:"SOLID"},size:"18"}},props:{fontweight:"BOLD",stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},chk:{state:"PROCESSED",lang:"en-US"},font:{ref:"MINOR",fontFamily:{name:"Open Sans"}},fill:{solid:{color:{rgb:[255,255,255],type:"BG1"}},type:"SOLID"},size:"18"}},{t:"Ipsum",unmerged:{props:{fontweight:"BOLD",chk:{state:"ERROR",lang:"en-US"},font:{fontFamily:{name:"Open Sans"}},fill:{solid:{color:{rgb:[255,255,255],type:"BG1"}},type:"SOLID"},size:"18"}},props:{fontweight:"BOLD",stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},chk:{state:"ERROR",lang:"en-US"},font:{ref:"MINOR",fontFamily:{name:"Open Sans"}},fill:{solid:{color:{rgb:[255,255,255],type:"BG1"}},type:"SOLID"},size:"18"}}],style:{halign:"CENTER",level:1,dir:"LTR",defPrProps:{stroke:{jointype:"ROUND",captype:"FLAT",width:2.6666667,fill:{solid:{color:{tweaks:{shade:.5},rgb:[116,149,49],type:"A1"}},type:"SOLID"},type:"SOLID"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[255,255,255],type:"CUSTOM"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:1,type:"PERCENT"}}},unmerged:{style:{halign:"CENTER"}}}],linkProps:{fill:{solid:{color:{rgb:[79,191,201]}},type:"SOLID"},underline:"SINGLE"},props:{autoFit:{type:"NONE"},valign:"MIDDLE"},id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-11.344600000000014,width:816,height:1054,top:-141.8332}},{nvOProps:{nvDProps:{id:"F9B630D8-ADB7-48AC-9F12-1009E9B6083C"}},props:{transform:{dim:{width:232.16011373671324,height:631.3568},rotate:0,flipv:!1,fliph:!1,pos:{left:-57.4341,top:122.32159999999999,zindex:3}},stroke:{fill:{type:"NONE"}},geom:{preset:{type:"RECT"},type:"PRESET"}},themeRef:{fillRef:{ref:"THEME",color:{type:"A1"}},strokeRef:{ref:"THEME",color:{type:"A1",tweaks:{shade:.5}}},fontRef:{ref:"MINOR",color:{type:"CUSTOM",rgb:[255,255,255]}}},textBody:{element:"",listStyles:[{halign:"LEFT",level:1,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:2,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:48},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:3,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:96},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:4,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:144},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:5,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:192},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:6,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:240},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:7,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:288},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:8,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:336},spacing:{line:{percent:1,type:"PERCENT"}}},{halign:"LEFT",level:9,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:384},spacing:{line:{percent:1,type:"PERCENT"}}}],paras:[{portions:[{t:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla quam tortor, lacinia non viverra ac, aliquam at risus. Vivamus auctor tempus tellus, eget consectetur nulla maximus eu. Sed egestas aliquam enim vitae malesuada. ",unmerged:{props:{chk:{state:"ERROR",lang:"en-US"},fill:{solid:{color:{tweaks:{hsl:{luminance:[{value:.5,mode:"MODIFY"},{value:.5,mode:"OFFSET"}]}},rgb:[128,128,128],type:"TX1"}},type:"SOLID"},size:10}},props:{stroke:{fill:{type:"NONE"}},chk:{state:"ERROR",lang:"en-US"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{tweaks:{hsl:{luminance:[{value:.5,mode:"MODIFY"},{value:.5,mode:"OFFSET"}]}},rgb:[128,128,128],type:"TX1"}},type:"SOLID"},size:10}}],style:{halign:"LEFT",level:1,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:1.25,type:"PERCENT"}}},unmerged:{style:{spacing:{line:{percent:1.25,type:"PERCENT"}}}}},{portions:[{unmerged:{props:{chk:{state:"ERROR",lang:"en-US"},fill:{solid:{color:{tweaks:{hsl:{luminance:[{value:.5,mode:"MODIFY"},{value:.5,mode:"OFFSET"}]}},rgb:[128,128,128],type:"TX1"}},type:"SOLID"},size:10}},props:{stroke:{fill:{type:"NONE"}},chk:{state:"ERROR",lang:"en-US"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{tweaks:{hsl:{luminance:[{value:.5,mode:"MODIFY"},{value:.5,mode:"OFFSET"}]}},rgb:[128,128,128],type:"TX1"}},type:"SOLID"},size:10}}],style:{halign:"LEFT",level:1,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:1.25,type:"PERCENT"}},listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{spacing:{line:{percent:1.25,type:"PERCENT"}}}}},{portions:[{t:"Ut viverra, augue auctor aliquam malesuada, nunc erat volutpat massa, id laoreet velit nisl vel lectus. Nunc vitae dolor quis dolor posuere egestas eget ut lacus. Nulla condimentum finibus aliquam.",unmerged:{props:{chk:{state:"ERROR",lang:"en-US"},fill:{solid:{color:{tweaks:{hsl:{luminance:[{value:.5,mode:"MODIFY"},{value:.5,mode:"OFFSET"}]}},rgb:[128,128,128],type:"TX1"}},type:"SOLID"},size:10}},props:{stroke:{fill:{type:"NONE"}},chk:{state:"ERROR",lang:"en-US"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{tweaks:{hsl:{luminance:[{value:.5,mode:"MODIFY"},{value:.5,mode:"OFFSET"}]}},rgb:[128,128,128],type:"TX1"}},type:"SOLID"},size:10}}],style:{halign:"LEFT",level:1,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:1.25,type:"PERCENT"}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{spacing:{line:{percent:1.25,type:"PERCENT"}}}}},{portions:[{unmerged:{props:{chk:{state:"ERROR",lang:"en-US"},fill:{solid:{color:{tweaks:{hsl:{luminance:[{value:.5,mode:"MODIFY"},{value:.5,mode:"OFFSET"}]}},rgb:[128,128,128],type:"TX1"}},type:"SOLID"},size:10}},props:{stroke:{fill:{type:"NONE"}},chk:{state:"ERROR",lang:"en-US"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{tweaks:{hsl:{luminance:[{value:.5,mode:"MODIFY"},{value:.5,mode:"OFFSET"}]}},rgb:[128,128,128],type:"TX1"}},type:"SOLID"},size:10}}],style:{halign:"LEFT",level:1,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:1.25,type:"PERCENT"}},listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{spacing:{line:{percent:1.25,type:"PERCENT"}}}}},{portions:[{t:" Maecenas dignissim lorem dui, vel pulvinar sem fringilla sed. Vestibulum a rutrum urna. Mauris ligula turpis, vehicula at arcu in, efficitur laoreet est. Morbi fermentum est et tellus porta, non dignissim felis ultricies. ",unmerged:{props:{chk:{state:"ERROR",lang:"en-US"},fill:{solid:{color:{tweaks:{hsl:{luminance:[{value:.5,mode:"MODIFY"},{value:.5,mode:"OFFSET"}]}},rgb:[128,128,128],type:"TX1"}},type:"SOLID"},size:10}},props:{stroke:{fill:{type:"NONE"}},chk:{state:"ERROR",lang:"en-US"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{tweaks:{hsl:{luminance:[{value:.5,mode:"MODIFY"},{value:.5,mode:"OFFSET"}]}},rgb:[128,128,128],type:"TX1"}},type:"SOLID"},size:10}}],style:{halign:"LEFT",level:1,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:1.25,type:"PERCENT"}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{spacing:{line:{percent:1.25,type:"PERCENT"}}}}},{portions:[{unmerged:{props:{chk:{state:"ERROR",lang:"en-US"},fill:{solid:{color:{tweaks:{hsl:{luminance:[{value:.5,mode:"MODIFY"},{value:.5,mode:"OFFSET"}]}},rgb:[128,128,128],type:"TX1"}},type:"SOLID"},size:10}},props:{stroke:{fill:{type:"NONE"}},chk:{state:"ERROR",lang:"en-US"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{tweaks:{hsl:{luminance:[{value:.5,mode:"MODIFY"},{value:.5,mode:"OFFSET"}]}},rgb:[128,128,128],type:"TX1"}},type:"SOLID"},size:10}}],style:{halign:"LEFT",level:1,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:1.25,type:"PERCENT"}},listStyle:{bullet:{type:"NONE",status:"disabled"}}},unmerged:{style:{spacing:{line:{percent:1.25,type:"PERCENT"}}}}},{portions:[{t:"Proin id ante vitae arcu lacinia cursus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut in laoreet turpis. ",unmerged:{props:{chk:{state:"ERROR",lang:"en-US"},fill:{solid:{color:{tweaks:{hsl:{luminance:[{value:.5,mode:"MODIFY"},{value:.5,mode:"OFFSET"}]}},rgb:[128,128,128],type:"TX1"}},type:"SOLID"},size:10}},props:{stroke:{fill:{type:"NONE"}},chk:{state:"ERROR",lang:"en-US"},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{tweaks:{hsl:{luminance:[{value:.5,mode:"MODIFY"},{value:.5,mode:"OFFSET"}]}},rgb:[128,128,128],type:"TX1"}},type:"SOLID"},size:10}}],style:{halign:"LEFT",level:1,dir:"LTR",defPrProps:{stroke:{fill:{type:"NONE"}},font:{ref:"MINOR",fontFamily:{name:"Roboto"}},fill:{solid:{color:{rgb:[0,0,0],type:"TX1"}},type:"SOLID"},size:18},margin:{left:0},spacing:{line:{percent:1.25,type:"PERCENT"}},listStyle:{bullet:{type:"NONE",status:"enabled"}}},unmerged:{style:{spacing:{line:{percent:1.25,type:"PERCENT"}}}}}],linkProps:{fill:{solid:{color:{rgb:[79,191,201]}},type:"SOLID"},underline:"SINGLE"},props:{autoFit:{type:"SHAPE"},inset:{bottom:5,left:10,right:10,top:5}},id:"textcontainer"},type:"SHAPE",editable:!0,containerDim:{width:"1000",height:"1000"},fitModeData:{left:-38.5659,width:816,height:1054,top:-219.3216}}],fitModeData:{left:-11.344600000000014,width:816,height:1054,top:-97},maintainLayout:!0}};HistoryUtils=function(){var e={};e[UNICODE.BR]=NODE_TYPE.BR,e[UNICODE.HR]=NODE_TYPE.HR,e[UNICODE.TAB]=NODE_TYPE.TEXT,e[UNICODE.CELL]=NODE_TYPE.CELL,e[UNICODE.PARA]=NODE_TYPE.PARAGRAPH,e[UNICODE.TOCSTART]=NODE_TYPE.TOC,e[UNICODE.IMAGE]=NODE_TYPE.IMAGE,e[UNICODE.TABLE]=NODE_TYPE.TABLE,e[UNICODE.MERGEFIELD_START]=NODE_TYPE.MAILMERGEFIELD,e[UNICODE.MERGEFIELD_END]=NODE_TYPE.MAILMERGEFIELD;var t=UNICODE.BR+UNICODE.HR+UNICODE.TAB+UNICODE.TABLE+UNICODE.CELL+UNICODE.PARA+UNICODE.TOCSTART+UNICODE.IMAGE+UNICODE.MERGEFIELD_START+UNICODE.MERGEFIELD_END,i=UNICODE.RANGE_START+UNICODE.RANGE_END+UNICODE.SECTION_START+UNICODE.ROW+UNICODE.TABLEEND+UNICODE.TOCEND+UNICODE.MULTIBYTE_SPACE,o=new RegExp("["+t+"]"),r=t+i,n=new RegExp("([^"+r+"]+){1}|(["+r+"]+){1}","g"),a="2px",l={};l[HISTORY_CONST.ACTION_INS]="#CEF5CE",l[HISTORY_CONST.ACTION_DEL]="#FFE5E5";var s=function(e){return o.lastIndex=0,o.test(e)},d=function(t){return e[t]||NODE_TYPE.TEXT},c=function(e){e[ATTR_COMMON.BORDERS]&&e[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_TOP]&&0!=e[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_TOP][ATTR_BORDERS.WIDTH]||(e[ATTR_COMMON.BORDERS]={},e[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_TOP]={type:"solid",width:a},e[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_RIGHT]={type:"solid",width:a},e[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_LEFT]={type:"solid",width:a},e[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM]={type:"solid",width:a})},p=function(e,t){e&&t&&(e.className=e.className+" icon-pilcrow",e.style.color=ReviewUtil.getUserColour(t[HISTORY_CONST.ZUID]),t[HISTORY_CONST.ACTION]===HISTORY_CONST.ACTION_DEL&&(e.className=e.className+" icon-pilcrow-strike-through"))},u=function(e){if("undefined"!=typeof HistoryUI&&HistoryUI.isQuickDiffView())return f(e);switch(e.type){case NODE_TYPE.CELL:e.z_td_bgc=ReviewUtil.getUserLightColour(e.history_zuid);break;case NODE_TYPE.PARAGRAPH:e.cls=e.cls?e.cls+" icon-pilcrow":"icon-pilcrow";break;case NODE_TYPE.IMAGE:c(e);for(var t in e[ATTR_COMMON.BORDERS])e[ATTR_COMMON.BORDERS][t][ATTR_BORDERS.COLOR]=ReviewUtil.getUserColour(e.history_zuid);break;case NODE_TYPE.TEXT:e[ATTR_TEXT.TS_BGC]=ReviewUtil.getUserLightColour(e.history_zuid),e[ATTR_TEXT.TS_FGC]=ReviewUtil.getUserColour(e.history_zuid);break;case NODE_TYPE.TOC:e[ATTR_TEXT.TS_BGC]=ReviewUtil.getUserLightColour(e.history_zuid)}var i=ReviewUtil.removeSplCharsInZuid(e.history_zuid),o="history_"+e.history_action+"_"+i;return e[ATTR_TEXT.CLS]=e[ATTR_TEXT.CLS]+" "+o,e},f=function(e){var t={};switch(e.type){case NODE_TYPE.TEXT:t.bgc=l[e.history_action],e.history_action===HISTORY_CONST.ACTION_DEL&&(t.td="line-through");break;case NODE_TYPE.IMAGE:c(t);for(var i in e[ATTR_COMMON.BORDERS])e[ATTR_COMMON.BORDERS][i][ATTR_BORDERS.COLOR]=l[e.history_action];break;case NODE_TYPE.TABLE:t.z_tbl_bgc=l[e.history_action];break;case NODE_TYPE.ROW:t[ATTR_ROW.TRS_BGC]=l[e.history_action];break;case NODE_TYPE.CELL:t.z_td_bgc=l[e.history_action];break;case NODE_TYPE.TOC:t.bgc=l[e.history_action]}var o=ReviewUtil.removeSplCharsInZuid(editor.zuid),r="history_"+e.history_action+"_"+o;return e[ATTR_TEXT.CLS]=e[ATTR_TEXT.CLS]+" "+r,extend(e,t)},g=function(e){return moment(e).format("hh:mm A, ddd, MMM DD, YYYY")},m=function(e){return l[e]},h=function(e){var t=editor.getBaseURL()+"/open/"+e;window.open(t,"_blank")},T=function(){h(editor.doc.getDocInfo().RID)},E=function(e){return e.docOps=e.docOps.map(function(e){return e.styles&&e.styles.begin&&e.styles.begin.cols&&e.styles.begin.type===NODE_TYPE.BODY&&(e.styles.begin.cols={count:1,space:[],width:[],iseqwidth:!0,col_space:Conversions.toGlobalValue("0.5in"),left_or_right:"",seperator:"0"}),e}),e},R=function(e){e.cols={count:1,space:[],width:[],iseqwidth:!0,col_space:Conversions.toGlobalValue("0.5in"),left_or_right:"",seperator:"0"}};return{DIFF_REGEX:n,isSupportedDataType:s,getDataType:d,getDiffFormat:u,getFormatedTime:g,getQuickDiffColor:m,setPilcrowStyle:p,openDocument:h,openCurrentDoc:T,makeSingleColumn:R,discardColumnChangeOps:E}}();var HistoryDiffUI=function(e,t){var i=!1,o=!1,r={},n=!1,a={};changesIdxDetails={};var l={TOPBAND_DOCNAME:"topband-history-compare-docname",TOPBAND_BACKTOEDITOR:"topband-history-compare-backtoeditor",TOPBAND_CLOSE:"history-compare-topband-close",BULLETIN:"history-bulletindiv",BULLETINCONT:"history-bulletin-cont",DIFF_TOPBAND:"topband-history-compare",FILTER:"history-changesfilter",FILTER_CONTAINER:"history-changesfilter-cont",NAVIGATION_TXT:"history-changes-navtxt",NAVIGATION_PREV:"history-changes-nav-prev",NAVIGATION_NEXT:"history-changes-nav-next",NAVIGATION_CONT:"history-changes-nav-cont",CHANGES_BETWEEN_TXT:"history-changesbetween-txt",DETAIL_DIFF_LINK:"history-comapare-detaildiff"},s=function(){i=!1,o=!1,n=!1,a={},changesIdxDetails={},r={}},d=function(e){return"table"==e.type||"cell"==e.type||"toc"==e.type||"row"==e.type},c=function(e,t){return!(!e.history_action||e.history_action==t.history_action&&e.history_zuid==t.history_zuid)},p=function(e,t,i){var o={contStr:e.contStr.substring(t,i+1),styles:e.styles.slice(t,i+1)},r=t,n=o.styles[0],a=QuickDiff.getRows(o);U.each(a,function(e){var t={contStr:o.contStr.substring(e.start,e.end+2),styles:o.styles.slice(e.start,e.end+2)};e.cells=QuickDiff.getCells(t)});var l=[];U.each(a,function(i){var o=i.cells;U.each(o,function(o){l=l.concat(g(e,t+i.start+o.start+1,t+i.start+o.end+1))})});var s=[];return U.each(a,function(e){var t=e.styles[0];c(t,n)&&s.push({start:r+e.start,end:r+e.end+1,action:t.history_action,zuid:t.history_zuid,type:"row"}),U.each(e.cells,function(i){var o=i.styles[0];c(o,t.history_action?t:n)&&s.push({start:r+e.start+i.start,end:r+e.start+i.end+1,action:o.history_action,zuid:o.history_zuid,type:"cell"})})}),s.concat(l)},u=function(e,t,i){var o=t.styles[i],r=i,n=QuickDiff.getBlockEnd(t,i);if("table"===o.type||"row"===o.type)var a=p(t,r,n);else var a=g(t,r+1,n);var l={start:r,end:n,type:o.type,zuid:o.history_zuid,action:o.history_action};return o.history_action&&e.push(l),Array.prototype.push.apply(e,a),l},f=function(e,t,i,o,r,n){e.push({start:i,end:o,zuid:r,action:n})},g=function(e,t,i){t=t||0,i=i||e.contStr.length;for(var o,r,n,a=[],l=t;l<i;l++){var s=e.styles[l];if(s&&s.history_action)if(d(s)){o&&(f(a,s,o,l,r,n),o=null,n=null,r=null);var c=u(a,e,l);l=c.end}else o?r==s.history_zuid&&n==s.history_action||(f(a,s,o,l,r,n),o=l,r=s.history_zuid,n=s.history_action):(o=l,r=s.history_zuid,n=s.history_action);else if(s&&!s.history_action&&o&&(f(a,s,o,l,r,n),o=null,n=null,n=null,d(s))){var c=u(a,e,l);l=c.end}l==i-1&&o&&f(a,s,o,i,r,n)}return a},m=function(e){var o=Z(l.FILTER);o.zcombo("removeAllOptions");var r={};i||U.each(e,function(e){r[e]=t.getUserName(e)}),o.zcombo("addOption",{value:"all",label:J.i18n("writer.history.EVERYONE")}),U.each(r,function(e,i){var r={value:t.removeSplCharsInZuid(i),label:e};o.zcombo("addOption",r)})},h=function(){var e=-1,t="all";return{init:function(i){t=i,e=-1,this.updateTotalChange()},changeFocus:function(){k(changesIdxDetails[t][e])},canProceed:function(){return!(!changesIdxDetails[t]||changesIdxDetails[t].length<=0)},getActiveFilter:function(){return t},updateTotalChange:function(){var e,i=changesIdxDetails[t].length;e=i<=1?J.i18n("writer.common.CHANGE",[i]):J.i18n("writer.common.CHANGES",[i]),Z(l.NAVIGATION_TXT).text(e)},updateCount:function(){var i=changesIdxDetails[t].length,o=e+1+" of "+J.i18n("writer.common.CHANGES",[i]);Z(l.NAVIGATION_TXT).text(o)},prev:function(){if(this.canProceed()){if(e==-1)return e=0,this.changeFocus(),void this.updateCount();var i=changesIdxDetails[t].length;0!=e?e--:e=i-1,this.changeFocus(),this.updateCount()}},next:function(){if(this.canProceed()){if(e==-1)return e=0,this.changeFocus(),void this.updateCount();var i=changesIdxDetails[t].length;e!=i-1?e++:e=0,this.changeFocus(),this.updateCount()}}}}(),T=function(e){e=e[0],D(),h.init(e),I(),"all"==e?w():M()},E=function(e){return i?e.action:t.removeSplCharsInZuid(e.zuid)},R=function(e){changesIdxDetails.all=[],U.each(e,function(e){var t=E(e);changesIdxDetails[t]||(changesIdxDetails[t]=[]),changesIdxDetails[t].push(e),changesIdxDetails.all.push(e)})},S=function(e){U.each(e,function(e){e=t.removeSplCharsInZuid(e),a[e]=J(".history_"+HISTORY_CONST.ACTION_INS+"_"+e).toArray(),a[e]=a[e].concat(J(".history_"+HISTORY_CONST.ACTION_DEL+"_"+e).toArray())})},O=function(e,t){return e.filter(function(e){return e.end-e.start!=1||!t.contStr[e.start].match(UNICODE.RANGE_START+"|"+UNICODE.RANGE_END)})},v=function(){var e={contStr:editor.doc.contStr,styles:editor.doc.getFormats()},o=g(e);o=O(o,e);var r=[];if(!i){for(var n=0,a=o.length;n<a;n++)!r.contains(o[n].zuid)&&r.push(o[n].zuid);t.addUsersInUserListPanel(r),t.positionUserListPanel()}m(r),R(o),S(r),h.init("all"),Z(l.FILTER).enable(),Z(l.NAVIGATION_CONT).show(),F(o)},b=function(){var e={contStr:editor.doc.contStr,styles:editor.doc.getFormats()},i=g(e);i=O(i,e);for(var o=[],r=0,n=i.length;r<n;r++)!o.contains(i[r].zuid)&&o.push(i[r].zuid);t.addUsersInUserListPanel(o),t.positionUserListPanel(),m(o),R(i),S(o),Z(l.FILTER).enable()},A=function(){h.prev()},y=function(){h.next()},D=function(){var e=[];"all"==h.getActiveFilter()?U.each(a,function(t){e=e.concat(t)}):e=a[h.getActiveFilter()];for(var t=0,i=e.length;t<i;t++){var o=e[t];if(o&&o.tagName){var r=o.tagName.toLowerCase();switch(r){case NODE_NAME.SPAN:DomUtil.setSpanBg(J(o),"transparent"),o.style.color="black";break;case NODE_NAME.TD:o.style.backgroundColor="transparent";break;case NODE_NAME.IMAGE:o.style.borderColor="black"}}}},C=function(e,i){for(var o=t.getUserColour(i),r=t.getUserLightColour(i),n=0,a=e.length;n<a;n++){var l=e[n];if(l&&l.tagName){var s=l.tagName.toLowerCase();switch(s){case NODE_NAME.SPAN:DomUtil.setSpanBg(J(l),r),l.style.color=o;break;case NODE_NAME.TD:l.style.backgroundColor=r;break;case NODE_NAME.IMAGE:l.style.borderColor=o}}}},I=function(){"all"==h.getActiveFilter()?U.each(a,function(e,t){C(e,t)}):C(a[h.getActiveFilter()],h.getActiveFilter())},P=function(){B(),s(),t.removeUsersInUserListPanel(),Z(l.TOPBAND_BACKTOEDITOR).hide(),Z(l.TOPBAND_CLOSE).hide(),Z(l.DETAIL_DIFF_LINK).hide(),Z(l.FILTER_CONTAINER).hide(),Z(l.NAVIGATION_CONT).hide()},_=function(e){Z(l.TOPBAND_DOCNAME).text(editor.doc.getDocInfo().DOCUMENT_NAME);var t;if(i)t=1==e.quickDiffType?J.i18n("history","DISPLAYING_TODAYS_CHANGES_MSG"):J.i18n("history","DISPLAYING_CHANGES_BY_TIME_MSG",[moment(e.source.time).format("MMM DD, YYYY"),moment(e.target.time).format("MMM DD, YYYY")]);else if(o)t=J.i18n("history","DISPLAYING_CHANGES_SINCE_VISIT_MSG");else{var r=e.source.docs_version,n=e.target.docs_version;parseFloat(r)>parseFloat(n)&&(r=e.target.docs_version,n=e.source.docs_version),t=J.i18n("history","DISPLAYING_CHANGES_BETWEEN_MSG",[r,n])}Z(l.CHANGES_BETWEEN_TXT).text(t),Z(l.FILTER).disable()},N=function(e){e.isQuickDiff?(i=e.isQuickDiff,e.showDetailDiffLink&&(r.source=e.source,r.target=e.target,Z(l.DETAIL_DIFF_LINK).show())):Z(l.FILTER_CONTAINER).show(),e.isShowChanges&&(o=e.isShowChanges),e.showCloseButton&&Z(l.TOPBAND_CLOSE).show(),e.showBackToEditor&&Z(l.TOPBAND_BACKTOEDITOR).show(),_(e),LayoutManager.loadLayout(LAYOUTS.HISTORYDIFFVIEW)},L=function(){HistoryUI.compareVersions(r.source,r.target),P(),Z(l.TOPBAND_CLOSE).show()},w=function(){Z(l.BULLETINCONT).find(".diff-bulletin").show()},M=function(){var e=Z(l.BULLETINCONT).find(".diff-bulletin"),t=h.getActiveFilter();U.each(e,function(e){t!=e.getAttribute("data_filter")?J(e).hide():J(e).show()})},x=function(e,t,i){for(var o=3,r=5,n=t;n<i;n=n+o+r)if(!e[n])return n;return t},F=function(e){var t={},i=(ViewManager.pages.last.el.offsetTop+ViewManager.pages.last.el.offsetHeight-editor.editorPaneContainer[0].offsetTop)*editor.zoomFactor,o=editor.editorPaneContainerHt,r=Z(l.BULLETIN);r.find(".diff-bulletin").remove(),r.css({height:o+"px"});var n=r.offset(),a=Math.ceil(n.top),s=(Math.ceil(n.left),Utils.createElement("span",{class:"diff-bulletin",style:"float:left;background-color: #FFF500; border:1px solid #FFAD00; width:10px; height:3px; cursor:pointer; "}));U.each(e,function(e,r){var n=editor.doc.getPortionData(e.start+1).node,d=PUtil.offset(n),c=s.cloneNode(!1),p=J(c);p.attr("id",r),p.attr("data_filter",E(e));var u=d.top/i*o,f=x(t,u,o);t[f]=!0,p.on("click",function(){k(e)}),Z(l.BULLETINCONT).append(c),p.css({top:Math.ceil(f+a+20),position:"absolute",left:"0px"})});var d=e.length||0,c="Total Changes: "+d;r.find("#history_bulletin_title").attr("title",c),r.show()},k=function(e){if(e.type){var t=DocTreeManager.getNodeAtIndex(e.start),i=(Utils.scrollElementIntoView(t,100),J(t));"table"!==e.type&&"row"!==e.type||(i=i.find("td")),i.removeClass("ui-vhistory-highlight-anim"),setTimeout(function(){i.addClass("ui-vhistory-highlight-anim")},100)}else{var o=editor.doc.createRange(e.start,e.end);o.class="ui-vhistory-highlight-anim",o.type=ZWRange.TYPE.HISTORY_HIGHLIGHT,editor.doc.getSelection().removeAllRanges().setSelectionType(SEL_AUTO_GEN).addRange(o)}},B=function(){Z(l.BULLETINCONT).empty(),Z(l.BULLETIN).hide()},H=function(){P(),LayoutManager.loadLayout(LAYOUTS.VERSIONHISTORY),HistoryUI.loadVersionListPage()},G=function(){P(),HistoryUI.backToEditor()};return{loadHistoryDiffPage:N,updateTopband:_,initChangesNavigation:v,moveToPreChange:A,moveToNextChange:y,filterChanges:T,getDetailDiff:L,backToEditor:G,closeTopband:H,initFilter:b,focusDiff:k,showBulletins:F,getChanges:g,getTableChanges:p,changesDetails:a,changesIdxDetails:changesIdxDetails}}(HistoryUtils,ReviewUtil),HistoryUI=function(e,t){var i,o,r=editorProps.deployment.zohowriter,n={},a={},l={},s={VERSIONS:1,DIFF:2,QUICKDIFF:3,SHOWCHANGES:4,VERSIONNICEURL:5},d={ALL:1,NAMED:2,TODAY:3,CURRENT_WEEK:4,CURRENT_MONTH:5},c={TODAY:1,THIS_WEEK:2,THIS_MONTH:3,CUSTOM:4},p={MAJOR:-1,REVERTED:1,UPLOADED:2,CHECKOUT:3,HIDDEN:101};n.versionDetails={},n.source,n.target,n.activeNavigationPage=1,n.latestVersion=0,n.totalVersion=0,n.activeVersionInfo,n.activeView=s.VERSIONS,n.activeFilter=d.ALL,n.excludeVersionList,n.diffData={},n.compareBetween={fromDate:new Date,toDate:new Date},a.isCompareContVisible=!1,a.versionsElem={},a.visibleUserList,a.versionTimeIndicatorElm,a.notesCharLimit=35,l={TOPBAND:"topband-history",TOPBAND_VERSION_INFO:"topband-history-versionview",TOPBAND_DOCNAME:"topband-history-docname",VERSIONS_CONTAINER:"versionpane-versionlist",VERSION_RIGHTPANE:"history-versionpane",SOURCE_VERSION:"versionpane-source",TARGET_VERSION:"versionpane-target",COMPARE_BUTTON:"versionpane-compare",CLEAR_BUTTON:"versionpane-clear",REVERT:"history-revert",VERSION_PAGINATION:"versionpane-pagination",OVERLAY:"history-overlay",BACK_TO_EDITOR:"topband-history-backtoeditor",COMPARE_CONTAINER:"versionpane-compare-cont",COMPARE_CONT_CANCEL:"versionpane-cancel",SELECT_TO_COMPARE:"versionpane-select-tocompare",QUICKDIFF:"history-quickdiff",FILTER_BUTTON:"versionpane-filter",FILTER_UL:"version-filter",RIGHTPANE_TITLE:"versionpane-title",VERSIONPANE_HEADER:"versionpane-header",VERSIONPANE_FOOTER:"versionpane-footer",DATE_PICKER:"historycustomrange",VERSIONVIEW_DOCNAME:"topband-versionview-docname",VERSIONVIEW_VERSION:"topband-versionview-version",VERSIONVIEW_DOCLINK:"topband-versionview-doclink"};var u=function(){i||O(),ke(),UIUtils.initComponent(l.TOPBAND),v(),editor.setView(EDITOR_VIEWS.HISTORY),LayoutManager.loadLayout(LAYOUTS.VERSIONHISTORY)},f=function(){n.versionDetails={},n.activeNavigationPage=1,n.latestVersion=0,n.totalVersion=0,n.source=void 0,n.target=void 0,n.diffData={},n.excludeVersionList=void 0,n.activeVersionInfo=void 0,n.activeFilter=d.ALL,n.activeView=s.VERSIONS,a.isCompareContVisible=!1,a.versionsElem={},a.visibleUserList=void 0,a.versionTimeIndicatorElm=void 0},g=function(e){n.activeView=s.VERSIONNICEURL,n.activeVersionInfo=e,ie(l.VERSIONVIEW_DOCNAME),Z(l.VERSIONVIEW_VERSION).text(J.i18n("writer.common.VERSION")+" - "+e.docs_version).css("display","inline-block"),editor.setView(EDITOR_VIEWS.VERSIONVIEW)},m=function(i,o){T(s.DIFF),editor.setView(EDITOR_VIEWS.HISTORY),v(),n.diffData={},n.diffData.source=i,n.diffData.target=o,t.loadHistoryDiffPage(n.diffData),Z("topband-history-compare-docname").show(),Z("history-changes-doclink-cont").show();var r=HistoryDiffManager.getDiff(parseFloat(i.writer_version),parseFloat(o.writer_version));r.done(function(t){try{e.makeSingleColumn(t.docContent.content.defaults),editor.loadDocument(t.docContent),e.discardColumnChangeOps(t.diffOps),editor.doc.snapShotManager&&editor.doc.snapShotManager.setSkipSnapShot(!0),t.diffOps.applyTo(),PubSub.subscribe("DocOperation/CommandComplete",G),e.discardColumnChangeOps(t.diffStyleOps),t.diffStyleOps.applyTo(),editor.doc.snapShotManager&&editor.doc.snapShotManager.setSkipSnapShot(!1)}catch(e){ze(ZWCollaboration.HISTORY_COMPARE_ERROR,n.diffData.source.writer_version,n.diffData.target.writer_version,e),UIUtils.showMessage("warning",J.i18n("writer.history.UNABLE_TO_COMPARE_VERSION"),"showclose","normalfont")}}),r.fail(function(e){e||(e=J.i18n("writer.history.UNABLE_TO_COMPARE_VERSION")),UIUtils.showMessage("warning",e,"showclose","normalfont")})},h=function(){var e=moment(editor.doc.getDocInfo().CREATED_DATE_LONG).diff(new Date,"months"),t=Math.abs(e)<=3;J("body").click(function(e){var t=J(e.target);t.parents("#historycustomrange").length||t.parents("#history-quickdiff-menu").length||t.parents(".ui-datepicker-header").length||Z(l.DATE_PICKER).hide()}),Z(l.DATE_PICKER).find("#historydatepicker-close").on("click",function(e){Z(l.DATE_PICKER).hide()}),Z(l.DATE_PICKER).find("#historydatepicker-from,#historydatepicker-to").datepicker({onSelect:function(e,t){if("historydatepicker-from"===t.id){var i=new Date(e);n.compareBetween.fromDate=i,Z(l.DATE_PICKER).find("#historydatepicker-to").datepicker("option",{minDate:i})}else{var o=new Date(e);n.compareBetween.toDate=o,Z(l.DATE_PICKER).find("#historydatepicker-from").datepicker("option",{maxDate:o})}},changeMonth:!1,changeYear:!1,minDate:t?new Date(editor.doc.getDocInfo().CREATED_DATE_LONG):"-3M",maxDate:new Date})},T=function(e){n.activeView=e},E=function(){return n.activeView===s.SHOWCHANGES},R=function(){return n.activeView!=s.VERSIONS},S=function(){return n.activeView===s.QUICKDIFF},O=function(){i=Handlebars.compile(J("#history-version-view").html()),o=Handlebars.compile(J("#history-miniband-view").html())},v=function(){if(EditorView.isFullView()&&EditorView.exitFullView(),EventHandler.isDialogOpened&&CollabPanelHandler.collabPanel&&CollabPanelHandler.collabPanel.is(":visible")){var e=J("#collaboratorPanelDiv, button#Collaborators_btn");J("#collabdialog").zcollaborator("close"),EventHandler.isDialogOpened=!1,e.removeClass("visible")}editor.setEditable(!1),UIUtils.setZoomFactor(100),UIUtils.disableDocumentShortcuts(),editor.doc.getSelection().collapse(!0)},b=function(){u(),Oe(),D(!0)},A=function(e){n.latestVersion=e.latest_version,n.totalVersion=e.total_version,n.versionDetails={},e.exclude_version_list&&(n.excludeVersionList=e.exclude_version_list),U.each(e.version_details,function(e){n.versionDetails[e.writer_version]=e})},y=function(e){n.activeFilter!==e&&(n.activeNavigationPage=1,D(!0,e))},D=function(e,t){ne();var i=t?t:n.activeFilter,o=n.activeNavigationPage>0?20*n.activeNavigationPage-20:0,r=20,a={};a.sid=editor.uuid,a.chid=editor.doc.getDocInfo().COLLAB_ID,a.from=o,a.to=r,a.filter_by=i,void 0==n.excludeVersionList&&(a.fill_exclude_versions=!0),Utils.setCsrfParam(a),J.ajax({type:"POST",dataType:"json",url:Utils.getNiceUrlPrefix(editor.doc.getDocInfo().RID+"/version/details"),data:a,success:function(o){"SUCCESS"==o.RESPONSE&&o.version_details&&o.version_details.length?(t&&(n.activeFilter=t),A(o),x(),Oe(),ae(),o.total_version>1?F():k(),e&&P(o.version_details[0].writer_version)):(C(i),ae())},error:function(e,t,o){C(i),ae()}})},C=function(e){var t=J.i18n("writer.common.NO_VERSION_FOUND");switch(e){case d.NAMED:t=J.i18n("writer.common.NO_NAMED_VERSION_FOUND");break;case d.TODAY:t=J.i18n("writer.common.NO_VERSION_CREATED_IN_RANGE",[J.i18n("writer.common.TODAY")]);break;case d.CURRENT_WEEK:t=J.i18n("writer.common.NO_VERSION_CREATED_IN_RANGE",[J.i18n("writer.common.THIS_WEEK")]);break;case d.CURRENT_MONTH:t=J.i18n("writer.common.NO_VERSION_CREATED_IN_RANGE",[J.i18n("writer.common.THIS_MONTH")])}UIUtils.showMessage("error",t,"showclose","normalfont",3e3)},I=function(){ae(),le(),de(),a.isCompareContVisible||(ve(),Ue()),editor.editorPaneContainer[0].scrollTop=0,PubSub.unsubscribe("Document/LoadingStart",I)},P=function(e){ne(!0),e=e?e:n.latestVersion,n.activeVersionInfo=n.versionDetails[e]?n.versionDetails[e]:n.activeVersionInfo,PubSub.subscribe("Document/LoadingStart",I),editor.fetchDocument(editor.doc.getDocInfo().RID,n.activeVersionInfo.writer_version)},_=function(e){var t=J(e),i=t.attr("class");i.indexOf("ui-vhistory-miniband")>-1&&(i.indexOf("ui-vhistory-miniband-selected")==-1?t.addClass("ui-vhistory-miniband-selected"):t.removeClass("ui-vhistory-miniband-selected"),t.parent().find("#version-miniband-more").slideToggle())},N=function(e){e.find("#version-miniband").on("click",function(){_(this)})},L=function(e,t){if(e.target.parentElement){var i=e.target.parentElement.id;if("version-moreoption"==i||"version-addnotes"==i)return}if(!t.getAttribute("data-disable")||"true"!=t.getAttribute("data-disable")){var o=t.getAttribute("data-version");if(a.isCompareContVisible){ee(o);var r=Q(o);Y(o,r)}else n.activeVersionInfo.writer_version!=o&&(be(),P(o))}},w=function(e){e.on("click",function(e){L(e,this)})},M=function(e){var t;return e.notes?(t=e.notes,e.notes.length>a.notesCharLimit&&(t=e.notes.substr(0,a.notesCharLimit)+"..."),t):(e.version_type==p.REVERTED?t=J.i18n("writer.history.REVERTED"):e.version_type==p.UPLOADED&&(t=J.i18n("writer.history.UPLOADED")),t)},x=function(){Z(l.VERSIONS_CONTAINER).empty(),a.versionsElem={};var e,t,r=!1;t=J(Utils.createElement("ul",{class:"ui-vhistory-nav"})),n.activeFilter==d.ALL&&(r=!0),U.each(n.versionDetails,function(n,s){for(var d=n.zuids,c=[],u=0;u<d.length;u++){var f=d[u],g={};g.name=ReviewUtil.getUserName(f,n.writer_version),g.color=ReviewUtil.getUserColour(f,n.writer_version),g.imgurl=Utils.getUserImageURL(f),c[u]=g}var m={};m.version=n.writer_version,m.docs_version=n.docs_version,c.length>2?(m.participants=[c[0]],c.shift(),m.view_more={count:c.length,participants:c}):m.participants=c,n.version_type==p.HIDDEN?m.time=moment(n.time).format("hh:mm A"):m.time=moment(n.time).format("h.mm A - ddd, MMM D, YYYY"),m.tooltipTime=moment(n.time).format("h.mm A - ddd, MMM D, YYYY");var h=M(n);h?(m.notes=h,m.notesTitle="EDIT_DESCRIPTION"):m.notesTitle="ADD_DESCRIPTION";var T=J(i(m));n.notes&&n.notes.length>a.notesCharLimit&&T.find("#version-notes").attr("title",n.notes),r&&n.version_type==p.HIDDEN?(e||(Z(l.VERSIONS_CONTAINER).append(t),t=J(Utils.createElement("ul",{class:"ui-vhistory-nav"})),e=J(o())),w(T),e.find("ul#version-miniband-more").append(T)):(r&&e&&(N(e),Z(l.VERSIONS_CONTAINER).append(e),e=void 0),w(T),t.append(T)),a.versionsElem[s]=T}),t.find("li:first")&&Z(l.VERSIONS_CONTAINER).append(t),e&&N(e),Z(l.VERSIONS_CONTAINER).append(e);var s=Z(l.VERSIONS_CONTAINER).find(".ui-vhistory-changes-info"),c=Math.max.apply(null,s.find(".ui-vhistory-count").map(function(){return J(this).outerWidth()}));s.find(".ui-vhistory-count").css("width",c+"px"),J.ui.utils.initComponents(Z(l.VERSION_RIGHTPANE)),Z(l.VERSIONS_CONTAINER).find(".ui-vhistory-mini ul").addClass("ui-no-display"),n.activeVersionInfo&&!a.isCompareContVisible&&ve(),a.isCompareContVisible&&(U.each(a.versionsElem,function(e){e.find(".ui-vhistory-checkbox").show()}),n.source&&(K(),a.versionsElem[n.source.writer_version]&&ee(n.source.writer_version),n.target&&a.versionsElem[n.target.writer_version]&&ee(n.target.writer_version)))},F=function(){a.isCompareContVisible||(Z(l.QUICKDIFF).show(),Z(l.SELECT_TO_COMPARE).show())},k=function(){a.isCompareContVisible||(n.activeFilter==d.ALL&&Z(l.QUICKDIFF).hide(),Z(l.SELECT_TO_COMPARE).hide())},B=function(e){var t={};return t.version=e,Utils.setCsrfParam(t),J.ajax({type:"POST",dataType:"json",url:Utils.getNiceUrlPrefix(editor.doc.getDocInfo().RID+"/version/getversioncontent"),data:t,success:function(e){if("SUCCESS"==e.RESPONSE)return e.docContent},error:function(e,t,i){}})},H=function(){T(s.QUICKDIFF);var e=parseFloat(n.source.writer_version),t=parseFloat(n.target.writer_version);B(e).done(function(e){var i=JSON.parse(JSON.stringify(e.docContent));B(t).done(function(e){var t=JSON.parse(JSON.stringify(e.docContent));i.versionInfo=n.source,t.versionInfo=n.target,De(i,t,1)})})},G=function(){t.initChangesNavigation(),PubSub.unsubscribe("DocOperation/CommandComplete",G)},z=function(i,o){n.diffData.source=i||n.source,n.diffData.target=o||n.target;var r=parseFloat(n.diffData.source.writer_version),a=parseFloat(n.diffData.target.writer_version);r>a&&(r=parseFloat(n.diffData.target.writer_version),a=parseFloat(n.diffData.source.writer_version)),ne();var l=HistoryDiffManager.getDiff(r,a);l.done(function(i){n.activeView!=s.SHOWCHANGES&&T(s.DIFF);var o={source:n.diffData.source,target:n.diffData.target};E()?(o.showBackToEditor=!0,o.isShowChanges=!0,v(),editor.setView(EDITOR_VIEWS.HISTORY)):o.showCloseButton=!0,t.loadHistoryDiffPage(o);try{e.makeSingleColumn(i.docContent.content.defaults),editor.loadDocument(i.docContent),e.discardColumnChangeOps(i.diffOps),editor.doc.snapShotManager&&editor.doc.snapShotManager.setSkipSnapShot(!0),i.diffOps.applyTo(),PubSub.subscribe("DocOperation/CommandComplete",G),e.discardColumnChangeOps(i.diffStyleOps),i.diffStyleOps.applyTo(),editor.doc.snapShotManager&&editor.doc.snapShotManager.setSkipSnapShot(!1)}catch(e){ze(ZWCollaboration.HISTORY_COMPARE_ERROR,n.diffData.source.writer_version,n.diffData.target.writer_version,e);var r=E()?t.backToEditor:t.closeTopband;UIUtils.showMessagePopup(J.i18n("error","MSG_VERSION_COMPARE_ERROR"),J.i18n("error","TITLE_VERSION_COMPARE_ERROR"),"error",r,!1,!1)}ae(),n.diffData={}}),l.fail(function(e){ae(),n.diffData={},e||(e=J.i18n("writer.history.UNABLE_TO_COMPARE_VERSION")),E()&&T(s.VERSIONS),UIUtils.showMessage("warning",e,"showclose","normalfont",3e3)})},V=function(e,t){var i=J(e).find(".ui-vhistory-changes-grp-list");a.visibleUserList&&a.visibleUserList[0]==i[0]?(a.visibleUserList.fadeOut(),a.visibleUserList=void 0):(a.visibleUserList&&a.visibleUserList.fadeOut(),i.fadeIn(),a.visibleUserList=i),Utils.stopEvent(t)},Y=function(t,i){if(i)if(n.source){if(n.target)return MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_WARNING,r,J.i18n("writer.styles.CANT_SELECT_MORE_THAN_TWO_VERSIONS"),null,null),ee(t),!1;n.target=n.versionDetails[t],Z(l.TARGET_VERSION).text(e.getFormatedTime(n.target.time)),Z(l.COMPARE_BUTTON).enable()}else n.source=n.versionDetails[t],Z(l.SOURCE_VERSION).text(e.getFormatedTime(n.source.time)),Z(l.TARGET_VERSION).text(J.i18n("history","SELECT_ANOTHER_VERSION")),Z(l.VERSION_RIGHTPANE).find(".ui-vhistory-compare-overlay").hide(),Z(l.CLEAR_BUTTON).enable(),K();else n.source&&n.target?(n.source.writer_version==t&&(n.source=n.target,Z(l.SOURCE_VERSION).text(Z(l.TARGET_VERSION).text())),Z(l.TARGET_VERSION).text(J.i18n("history","SELECT_ANOTHER_VERSION")),n.target=void 0,Z(l.COMPARE_BUTTON).disable()):W()},W=function(){n.source&&(ee(n.source.writer_version,!0),n.source=void 0),n.target&&(ee(n.target.writer_version,!0),n.target=void 0),Z(l.SOURCE_VERSION).text(""),Z(l.TARGET_VERSION).text(""),Z(l.CLEAR_BUTTON).disable(),Z(l.COMPARE_BUTTON).disable(),Z(l.VERSION_RIGHTPANE).find(".ui-vhistory-compare-overlay").show(),K()},j=function(e,t){if(e=parseFloat(e),t=parseFloat(t),n.excludeVersionList.indexOf(t)!=-1)return!0;for(var i=0,o=n.excludeVersionList.length;i<o;i++)if(X(e,t,n.excludeVersionList[i]))return!0;return!1},X=function(e,t,i){if(e>t){var o=e;e=t,t=o}return e<i&&i<t},K=function(){if(!n.source)return void U.each(n.versionDetails,function(e){q(e.writer_version)});for(var e,t,i,o=parseFloat(n.source.writer_version),r=0,a=n.excludeVersionList.length;r<a;r++){e=n.excludeVersionList[r],t&&(i=X(t,e,o));for(var l in n.versionDetails){var s=n.versionDetails[l],d=parseFloat(s.writer_version);i?X(t,e,d)?q(s.writer_version):$(s.writer_version):(d>=e&&d>o&&e>o&&$(s.writer_version),d<=e&&d<o&&e<o&&$(s.writer_version),e==o&&d<e&&$(s.writer_version)),d==o&&q(s.writer_version)}t=e}},$=function(e){a.versionsElem[e].attr("data-disable",!0).css("opacity","0.3")},q=function(e){a.versionsElem[e].attr("data-disable",!1).css("opacity","1")},Q=function(e){var t=a.versionsElem[e].find(".unique-checkbox").attr("data-selected");return!(!t||"true"!=t)},ee=function(e,t){if(a.versionsElem[e]){var i=a.versionsElem[e].find(".unique-checkbox");return t?(i.attr("data-selected",!1).removeClass("ui-label-selected"),void a.versionsElem[e].find(".ui-vhistory-br").removeClass("ui-selected-version")):void(i.attr("data-selected")&&"false"!=i.attr("data-selected")?(i.attr("data-selected",!1).removeClass("ui-label-selected"),a.versionsElem[e].find(".ui-vhistory-br").removeClass("ui-selected-version")):(i.attr("data-selected",!0).addClass("ui-label-selected"),a.versionsElem[e].find(".ui-vhistory-br").addClass("ui-selected-version")))}},te=function(e){Z(l.RIGHTPANE_TITLE).text(e)},ie=function(e){var t=editor.doc.getDocInfo().DOCUMENT_NAME;Z(e).text(t).attr("title",t)},oe=function(){var e=[Z(l.TOPBAND_VERSION_INFO),Z(l.SELECT_TO_COMPARE),Z(l.FILTER_BUTTON),Z(l.QUICKDIFF),Z(l.REVERT)];U.each(e,function(e){e.hide()}),U.each(a.versionsElem,function(e){e.find(".ui-vhistory-checkbox").show()}),be(),a.isCompareContVisible=!0;var t=Z(l.COMPARE_CONTAINER).outerHeight();Z(l.COMPARE_BUTTON).disable(),Z(l.CLEAR_BUTTON).disable(),Z(l.COMPARE_CONT_CANCEL).show(),Z(l.COMPARE_CONTAINER).slideDown(),te(J.i18n("history","COMPARE_VERSIONS")),Ae(t)},re=function(){var e=[Z(l.TOPBAND_VERSION_INFO),Z(l.SELECT_TO_COMPARE),Z(l.QUICKDIFF),Z(l.FILTER_BUTTON)];U.each(e,function(e){e.show()}),U.each(a.versionsElem,function(e){e.find(".ui-vhistory-checkbox").hide()}),a.isCompareContVisible=!1,de(),W(),ve(),te(J.i18n("history","VERSIONS")),Z(l.COMPARE_CONT_CANCEL).hide(),Z(l.COMPARE_CONTAINER).slideUp(),Ae()},ne=function(e){if(E())return void UIUtils.showLoadingMsg(J.i18n("writer.common.LOADING"));UIUtils.showLoadingMsg(J.i18n("writer.common.LOADING")),Z(l.OVERLAY).show();var t=[Z(l.BACK_TO_EDITOR),Z(l.QUICKDIFF)];if(U.each(t,function(e){e.zbutton("disable")}),Z(l.REVERT).hide(),editor.editorPaneContainer.scrollTop("0px"),e){var i=J(ViewManager.getElements("page")),o=i.first();i[0]=J("<span></span>"),i.remove(),o.find(".zw-paragraph,table").hide(),editor.jeditorPaneWrapper.height(o.height()+"px")}},ae=function(){if(E())return void UIUtils.hideLoadingMsg();UIUtils.hideLoadingMsg(),Z(l.OVERLAY).hide();var e=[Z(l.BACK_TO_EDITOR),Z(l.QUICKDIFF)];U.each(e,function(e){e.zbutton("enable")})},le=function(){DomUtil.removeCursorNode(editor.uuid,"start"),DomUtil.removeCursorNode(editor.uuid,"end")},se=function(){var e="vfilter_"+n.activeFilter;Z(l.FILTER_UL).zmenu("check",e)},de=function(){n.activeVersionInfo.writer_version==n.latestVersion||editor.isFinalDocument()||a.isCompareContVisible||a.isCompareContVisible?Z(l.REVERT).hide():Z(l.REVERT).show()},ce=function(){var e=n.activeVersionInfo.writer_version;MsgDialog.showMessage(CONST.MSG_TYPE_YESNO,CONST.SEVERITY_WARNING,r,J.i18n("writer.common.SURE_WANT_TO_REVERT_VERSION"),null,function(t){switch(t){case CONST.BUTTON_YES_CLICKED:pe(e)}})},pe=function(e){ne(!0);var t={};t.rid=editor.doc.getDocInfo().RID,t.viewVersion=e,t.sid=editor.uuid,t.docsFolderId=docsFolderId,t.tstamp=(new Date).getTime(),Utils.setCsrfParam(t),InsertShape.shapeCache={};var i=Utils.getUrl("revert");J.ajax({type:"POST",global:!1,dataType:"json",url:i,data:t,success:function(e){"SUCCESS"==e.RESPONSE?Te():MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_ERROR,J.i18n("common","ERROR"),J.i18n("common","VERSION_REVERT_ERROR"),null,null)},error:function(e,t,i){ZWCollaboration.handleSendMutationError(e,t,i)}})},ue=function(e){n.activeVersionInfo.notes=e;var t=a.versionsElem[n.activeVersionInfo.writer_version];if(t){var i=t.find("#version-notes");i.removeAttr("title"),n.activeVersionInfo.notes.length>a.notesCharLimit&&(e=n.activeVersionInfo.notes.substr(0,a.notesCharLimit)+"...",i.attr("title",n.activeVersionInfo.notes));var o=Utils.createElement("span",{class:"ui-vhistory-desc ui-more"},e);i.html(o),t.find("#version-addnotes").attr("title",J.i18n("writer.history.EDIT_DESCRIPTION"))}},fe=function(){var e=J("#add_version_desc_input"),t=J("#add_version_desc_dlg").zvalidation("validateAllFields",J("#add_version_desc_dlg"));if(t){var i=me(e.val(),Ee());i.done(function(e){UIUtils.showMessage("info",J.i18n("history","VERSION_DESCRIPTION_ADDED"),"showclose","normalfont",3e3),ue(e)}),i.fail(function(){UIUtils.showMessage("warning",J.i18n("history","UNABLE_TO_ADD_DESCRIPTION"),"showclose","normalfont",3e3)}),J.dialogutil.close("addversiondesc")}},ge=function(e){var t={init:function(e){var t=e.find("#add_version_desc_input");n.activeVersionInfo.notes&&t.val(n.activeVersionInfo.notes),t.focus()}};J.dialogutil.open("addversiondesc",J("#add_version_desc_dlg"),t),e&&Utils.stopEvent(e)},me=function(e,t){var i=J.Deferred(),o={};return t&&(o.docs_version=t),o.description=e,Utils.setCsrfParam(o),J.ajax({type:"POST",async:!1,dataType:"json",url:Utils.getNiceUrlPrefix(editor.doc.getDocInfo().RID+"/version/description"),data:o,success:function(t){"SUCCESS"==t.RESPONSE?i.resolve(e):i.reject()},error:function(e,t,o){i.reject(),ZWCollaboration.handleSendMutationError(e,t,o)}}),i.promise()},he=function(){ae(),J('div[id^="z-cursor"]').show(),UIUtils.enableDocumentShortcuts(),Resize.setTargetImg(null),InsertShape.shapeCache={},LayoutManager.loadLayout(ModeManager.getCurrentMode());var e=editor.doc.getParents(NODE_TYPE.PARAGRAPH,1);editor.doc.getSelection().removeAllRanges().moveTo(e,!0),PubSub.unsubscribe("Document/LoadingStart",he)},Te=function(){a.isCompareContVisible&&re(),ne(!0),editor.setEditable(!0),Z(l.VERSIONS_CONTAINER).empty(),f(),Be(),editor.setView(EDITOR_VIEWS.EDITOR),PubSub.subscribe("Document/LoadingStart",he),editor.fetchDocument(editor.doc.getDocInfo().RID,"")},Ee=function(){return n.activeVersionInfo.docs_version},Re=function(){return n.activeVersionInfo.writer_version},Se=function(e){n.activeNavigationPage=e,D()},Oe=function(){Z(l.VERSION_PAGINATION).off().on("paginationchange",function(e,t){Se(t.value)}).zpagination("updateTotalItems",n.totalVersion,n.activeNavigationPage)},ve=function(){if(a.versionsElem[n.activeVersionInfo.writer_version]){var e=a.versionsElem[n.activeVersionInfo.writer_version].find("div.ui-vhistory-br");e.addClass("ui-vhistory-br-selected")}},be=function(){if(a.versionsElem[n.activeVersionInfo.writer_version]){var e=a.versionsElem[n.activeVersionInfo.writer_version].find("div.ui-vhistory-br");e.removeClass("ui-vhistory-br-selected")}},Ae=function(e){e=e||0;var t=e+Z(l.VERSIONPANE_HEADER).outerHeight()+Z(l.VERSIONPANE_FOOTER).outerHeight();a.isCompareContVisible&&(t+=Z(l.COMPARE_CONTAINER).outerHeight()),t=window.innerHeight-t,Z(l.VERSIONS_CONTAINER).height(t+"px")},ye=function(){UIUtils.showLoadingMsg(J.i18n("writer.common.LOADING"));var e={};Utils.setCsrfParam(e),J.ajax({type:"POST",dataType:"json",url:Utils.getNiceUrlPrefix(editor.doc.getDocInfo().RID+"/version/showchanges"),data:e,success:function(e){e&&"SUCCESS"===e.RESPONSE?(T(s.SHOWCHANGES),z(e.source_version_info,e.target_version_info)):(UIUtils.hideViewChangesLink(),UIUtils.showMessage("warning",J.i18n("writer.history.UNABLE_TO_COMPARE_VERSION"),"showclose","normalfont",5e3)),UIUtils.hideLoadingMsg()},error:function(e,t,i){UIUtils.hideLoadingMsg(),UIUtils.hideViewChangesLink(),UIUtils.showMessage("warning",J.i18n("writer.history.UNABLE_TO_COMPARE_VERSION"),"showclose","normalfont",5e3)}})},De=function(i,o,r){T(s.QUICKDIFF);var a=new QuickDiff;try{dv=a.quickdiff(i,o)}catch(e){return void He(e,i.versionInfo.writer_version,o.versionInfo.writer_version)}e.makeSingleColumn(dv.defaults),a.renderDiff(dv,function(){ae();var e={};e.isQuickDiff=!0,e.showCloseButton=!0,e.source=i.versionInfo,e.target=o.versionInfo,1==r?e.quickDiffType=1:(e.source.time=n.compareBetween.fromDate.getTime(),e.target.time=n.compareBetween.toDate.getTime()),n.excludeVersionList&&j(parseFloat(e.source.writer_version),parseFloat(e.target.writer_version))?e.showDetailDiffLink=!1:e.showDetailDiffLink=!0,t.loadHistoryDiffPage(e),t.initChangesNavigation()})},Ce=function(e){var t={};t.COMPARE_LIST_TYPE=e,Utils.setCsrfParam(t);var i=Utils.getNiceUrlPrefix(editor.doc.getDocInfo().RID+"/version/quickcompare");switch(e){case c.CUSTOM:var o=n.compareBetween.fromDate,r=n.compareBetween.toDate;t.from=o.getTime(),t.to=moment(r).add(1,"day").toDate().getTime();break;case c.THIS_MONTH:n.compareBetween.fromDate=moment(new Date).set("date",1).toDate(),n.compareBetween.toDate=new Date;break;case c.THIS_WEEK:n.compareBetween.fromDate=moment(new Date).startOf("week").toDate(),n.compareBetween.toDate=new Date;break;case c.TODAY:n.compareBetween.fromDate=n.compareBetween.toDate=new Date}ne(),J.ajax({type:"POST",dataType:"json",url:i,data:t,success:function(t){t&&"SUCCESS"===t.RESPONSE&&"diff"==t.STATUS?(Z(l.DATE_PICKER).hide(),De(t.sourceVersion,t.targetVersion,e)):(ae(),Ie(e))},error:function(t,i,o){ae(),Z(l.DATE_PICKER).hide(),Ie(e)}})},Ie=function(e){var t=J.i18n("writer.history.VERSIONS_NOT_FOUND_IN_RANGE");switch(e){case c.TODAY:t=J.i18n("writer.history.QUICKDIFF_NOTHING_CHANGED_MSG",[J.i18n("writer.common.TODAY")]);break;case c.THIS_WEEK:t=J.i18n("writer.history.QUICKDIFF_NOTHING_CHANGED_MSG",[J.i18n("writer.common.THIS_WEEK")]);break;case c.THIS_MONTH:t=J.i18n("writer.history.QUICKDIFF_NOTHING_CHANGED_MSG",[J.i18n("writer.common.THIS_MONTH")])}UIUtils.showMessage("error",t,"showclose","normalfont",3e3)},Pe=function(){Z(l.DATE_PICKER).show()},_e=function(){var e=editor.doc.getDocInfo();if(!(/REMOTE|ANYONEWITHLINK/.test(editor.getEditorType())||editor.doc.getDocInfo().newDoc||is_wkhtmltopdf_browser||editor.isOffline()||e.CHECKEDOUT||1==e.VERSION&&0==e.REVISION||!editor.isEditable()||Utils.isNonEditableView())){var t={};Utils.setCsrfParam(t),J.ajax({type:"POST",dataType:"json",url:Utils.getNiceUrlPrefix(editor.doc.getDocInfo().RID+"/version/candisplaychangeslink"),data:t,success:function(e){"SUCCESS"==e.RESPONSE&&"diff"==e.VERSION&&UIUtils.showViewChangesLink()},error:function(e,t,i){}})}},Ne=function(){var t=J("#cfv-open-doc").data("rid");e.openDocument(t)},Le=function(){var e=J("#createfromversionzdialog"),t=e.find("#createfromversion_input").val();J("#cfv-create-doc,#cfv-create-doc-cancel,#cfv-input-container,#cfv-hint").hide(),e.find("#cfv-loader").show(),we(t).done(function(t){if(e.find("#cfv-loader").hide(),"SUCCESS"==t.STATUS){J("#cfv-open-doc,#cfv-open-doc-cancel,#cfv-success-msg").show();var i=t.RID;J("#cfv-open-doc").data("rid",i)}else e.find("#cfv-server-error,#cfv-create-doc,#cfv-create-doc-cancel,#cfv-input-container,#cfv-hint").show()}).fail(function(){e.find("#cfv-loader").hide(),e.find("#cfv-server-error,#cfv-create-doc,#cfv-create-doc-cancel,#cfv-input-container,#cfv-hint").show()})},we=function(e){var t=n.activeVersionInfo.writer_version,i={};return i.sid=editor.uuid,i.rid=editor.doc.getDocInfo().RID,i.versionId=t,i.docName=e||"Untitled Document",Utils.setCsrfParam(i),J.ajax({type:"POST",dataType:"json",url:Utils.getUrl("createfromversion"),data:i,success:function(e){},error:function(e,t,i){}})},Me=function(){J.dialogutil.open("createfromversion",null,{init:function(e){setTimeout(function(){J("#cfv-create-doc,#cfv-create-doc-cancel,#cfv-input-container").show(),J("#cfv-server-error,#cfv-open-doc,#cfv-open-doc-cancel,#cfv-loader,#cfv-success-msg").hide(),e.find("input:first").val(editor.doc.getDocInfo().DOCUMENT_NAME+"_v"+n.activeVersionInfo.docs_version).select().focus()},1)},set:function(e,t,i){if("createfromversion"==e.action){var o=function(){HistoryUI.createFromVersion()};UIUtils.enterKey(J("#createfromversion_input"),o)}}})},Ue=function(){a.visibleUserList&&(a.visibleUserList.fadeOut(),a.visibleUserList=void 0)},xe=function(){return a.versionsElem[n.activeVersionInfo.writer_version]},Fe=function(){BookmarkDialog.showLink([n.activeVersionInfo.writer_version_encrypted,"version"])},ke=function(){Z(l.VERSIONS_CONTAINER).on("scroll",Ue),PubSub.subscribe("Document/Resize",Ae)},Be=function(){Z(l.VERSIONS_CONTAINER).off("scroll",Ue),PubSub.unsubscribe("Document/Resize",Ae)},Je=function(){T(s.VERSIONS),P(n.activeVersionInfo.writer_version)},He=function(e,t,i){ze(ZWCollaboration.HISTORY_QUICK_COMPARE_ERROR,t,i,e),UIUtils.showMessagePopup(J.i18n("error","MSG_VERSION_COMPARE_ERROR"),J.i18n("error","TITLE_QUICKDIFF_ERROR"),"error",Je,!1,!1)},Ge=function(e){if(S()){var t=editor.doc.getDocInfo().SOURCE_VERSION,i=editor.doc.getDocInfo().TARGET_VERSION;He(e,t,i)}else PubSub.publish("Document/Warning",WARNING_MSG.UNABLE_TO_LOAD_VERSION_IN_HISTORY)},ze=function(e,t,i,o){Utils.log("\nERROR CODE: "+e+"\nSTACK TRACE : "+o.stack),Utils.sendErrorDetails(e+"<ZWERROR>"+editor.doc.getDocInfo().VERSION+"."+editor.doc.getDocInfo().REVISION+"<ZWERROR>\n Error Log Start \n"+ZWCollaboration.clientInfo+"\n Err No ="+e+" DOC len ="+editor.doc.getDocumentLength()+" buildLabel::: "+buildLabel+"\nError Log End \n<ZWERROR>SOURCE_VERSION : "+t+"\nTARGET_VERSION : "+i+"\nSTACK TRACE : "+o.stack,{SOURCE_VERSION:t,TARGET_VERSION:i})};return PubSub.subscribe("Document/FirstTimeComponentReady",_e),PubSub.subscribe("Document/FirstTimeComponentReady",h),PubSub.subscribe("Document/HistoryLoadError",Ge),{isChangesView:E,isDiffView:R,isQuickDiffView:S,loadHistoryPage:b,showCompareContainer:oe,hideCompareContainer:re,compareVersions:z,compareWithQuickDiff:H,clearSelectedVersions:W,getSelectedDocsVersion:Ee,getSelectedVersion:Re,listVersions:y,loadVersionListPage:Je,openRevertIconConfirmMsg:ce,openAddVerDescriptionDlg:ge,addDescription:fe,selectVersionFilter:se,backToEditor:Te,toggleUserList:V,addVersionDescription:me,showChangesSinceLastVisit:ye,showChangesSince:Ce,pickCustomDates:Pe,data:n,createFromVersion:Le,openVersionForkDialog:Me,openForkedVersion:Ne,loadVersionView:g,loadVersionDiffPage:m,getSelectedVersionItemDOM:xe,displayVersionLink:Fe,HISTORY_VIEWS:s,setView:T,onQuickDiffError:He}}(HistoryUtils,HistoryDiffUI),HistoryDiffManager=function(e){var t={};t.versionsOps={},t.versionsContent={};var i,o,r,n,a,l,s,d=5,c=99,p=100,u=function(e,t){i=e,o=t,s=J.Deferred(),l=[],n=new DocOpBuilder,a=new DocOpBuilder},f=function(e){var i=[],o=!1;U.each(r,function(e){var r=!!t.versionsOps[e],n=i.length;(o!=r&&0!=n||!r&&n===d)&&(l.push({isOpsFilled:o,versions:i}),i=[]),i.push(e),o=r}),0!=i.length&&l.push({isOpsFilled:o,versions:i})},g=function(){i=void 0,o=void 0,r=[],n=void 0,a=void 0,l=[],s=void 0},m=function(e){var t=r.indexOf(e);return t>0?r[t-1]:i},h=function(e){e=parseFloat(e);var t=Math.round((e-Math.floor(e))*p);return t},T=function(e){for(var t=0,i=e.length;t<i;t++){var o=e[t];if(o.isDelete()){var r=new DocOp;r.skipChars(o.delete_characters.length),e[t]=r}}},E=function(e){for(var t=0,i=e.length;t<i;t++){var o=e[t];if(o.isInsert()){var r=new DocOp;r.skipChars(o.characters.length),e[t]=r}}},R=function(e,t,i,o){var r=[],n=S(t,i,o),a=new DocOp;a.changeStyles([],n);var l=new DocOp;return l.changeStyles(U.keys(n),[]),r.push(a),r.push(O(i,e)),r.push(l),r},S=function(e,t,i){var o={};return o[HISTORY_CONST.ZUID]=e,o[HISTORY_CONST.ACTION]=t,o.type=i,t==HISTORY_CONST.ACTION_INS?o.cls="history_diff":o.cls="history_diff history_del",o},O=function(e,t){var i=new DocOp;return e==HISTORY_CONST.ACTION_INS?i.newCharacters(t):i.deleteCharacters(t),i},v=function(e){for(var t=0,i=e.length;t<i;t++){var o=e[t],r=b(o);if(!r)break}},b=function(i){try{var o,r,l,d,c,p,u,f,g,m,h,T,E,S,v=t.versionsOps[i];for(var b in v){if(o=v[b],!o)return s.resolve(),!1;for(r=o.op,"string"==typeof r&&(r=jQuery.parseJSON(o.op)),l=DocOpBuilder.build(r),d=new DocOpBuilder,c=l.docOps,p=[],u=[],g=0,m=c.length;g<m;g++)if(h=c[g],f=o.zuid,!h.isLock()){if(h.isInsert()||h.isDelete()){var A,y;for(h.isInsert()?(A=h.characters,y=HISTORY_CONST.ACTION_INS):(A=h.delete_characters,y=HISTORY_CONST.ACTION_DEL),e.DIFF_REGEX.lastIndex=0,T=e.DIFF_REGEX.exec(A);T;){if(E=T[1],S=T[2],E){var D=R(E,f,y,NODE_TYPE.TEXT);u=u.concat(D)}if(S)for(var C=0,I=S.length;C<I;C++){var P=S.charAt(C);if(e.isSupportedDataType(P)){var D=R(P,f,y,e.getDataType(P));u=u.concat(D)}else u.push(O(y,P))}T=e.DIFF_REGEX.exec(A)}}else u.push(h);p.push(h)}d.docOps=u,l.docOps=p,a=DocOpBuilder.compose(a,d),a=DocOpBuilder.concise(a),n=DocOpBuilder.compose(n,l),n=DocOpBuilder.concise(n)}}catch(e){var N;return"Lock error in compose"===e?(s.reject(J.i18n("writer.history.UNABLE_TO_COMPARE_DUE_TO_LOCK")),N="Lock error in compose"):(s.reject(),N=e.stack),_("EXECPTION WHILE COMPOSING OPS IN HISTORY DIFF RID : "+editor.doc.rid+" VERSION : "+i+" EXECPTION : "+N),!1}return!0},A=function(){var e={};return e.diffOps=n,e.diffStyleOps=a,T(e.diffStyleOps.docOps),E(e.diffStyleOps.docOps),T(e.diffOps.docOps),e},y=function(e,i){var o=J.Deferred();return u(e,i),s.done(function(){var i=A();i.docContent={content:t.versionsContent[e]},o.resolve(i),g()}),s.fail(function(e){g(),o.reject(e)}),t.versionsContent[e]?D():I(D),o.promise()},D=function(){var e={};e.source=i,e.target=o,Utils.setCsrfParam(e),J.ajax({type:"POST",dataType:"json",url:Utils.getNiceUrlPrefix(editor.doc.getDocInfo().RID+"/version/getlistofversion"),data:e,success:function(e){(e.RESPONSE="SUCCESS")?(e.versionlist.push(o),r=e.versionlist,f(e.versionlist),P()):(s.reject(),_("UNABLE TO GET VERSION LIST BETWEEN VERSIONS RID : "+editor.doc.rid+"  SOURCE : "+i+" TARGET : "+o))},error:function(e,t,r){s.reject(),_("EXECPTION WHILE GETTING VERSIONS LIST BETWEEN VERSIONS IN HISTORY DIFF RID : "+editor.doc.rid+"  SOURCE :"+i+" TARGET : "+o)}})},C=function(e){var i={};i.versionlist=e.join(","),Utils.setCsrfParam(i),J.ajax({type:"POST",dataType:"json",url:Utils.getNiceUrlPrefix(editor.doc.getDocInfo().RID+"/version/getversionops"),data:i,success:function(i){if(i.RESPONSE="SUCCESS"){for(var o=i.version_ops,r=0,n=e.length;r<n;r++){var a=e[r],d=parseInt(a),p=m(a),u=h(p),f=h(a);if(u!=c&&parseInt(p)==d||(u=0),o[d]){t.versionsOps[a]={};for(var g=u+1;g<=f;g++)t.versionsOps[a][g]=o[d][g]}}if(o.FAILURE)return s.reject(),void _("UNABLE TO GET VERSION OPS RID :"+editor.doc.rid+" VERSIONLIST : "+e+" FAILURE_IDS : "+JSON.stringify(o.FAILURE));l[0].isOpsFilled=!0,P()}else s.reject(),_("EXECPTION WHILE GETTING VERSIONS OPS IN HISTORY DIFF RID : "+editor.doc.rid+" VERSIONLIST : "+e)},error:function(t,i,o){s.reject(),_("EXECPTION WHILE GETTING VERSIONS OPS IN HISTORY DIFF RID : "+editor.doc.rid+" VERSIONLIST : "+e)}})},I=function(e){var o={};o.version=i,Utils.setCsrfParam(o),J.ajax({type:"POST",dataType:"json",url:Utils.getNiceUrlPrefix(editor.doc.getDocInfo().RID+"/version/getversioncontent"),data:o,success:function(o){(o.RESPONSE="SUCCESS")?(t.versionsContent[i]=o.docContent,e&&e()):(s.reject(),_("UNABLE TO GET VERSION CONTENT RID : "+editor.doc.rid+" VERSION : "+i))},error:function(e,t,o){s.reject(),_("EXECPTION WHILE GETTING VERSION CONTENT IN HISTORY DIFF RID : "+editor.doc.rid+" VERSION : "+i)}})},P=function(){if(!l||!l.length)return void(s&&s.resolve());var e=l[0];e.isOpsFilled?(v(e.versions),l.shift(),P()):C(e.versions)},_=function(e){var t=ZWCollaboration.HISTORY_COMPARE_ERROR;Utils.log(e),Utils.sendErrorDetails(t+"<ZWERROR>"+editor.doc.getDocInfo().VERSION+"."+editor.doc.getDocInfo().REVISION+"<ZWERROR>\n Error Log Start \n"+ZWCollaboration.clientInfo+"\n Err No ="+t+" DOC len ="+editor.doc.getDocumentLength()+" buildLabel::: "+buildLabel+"\n Error Log End \n<ZWERROR>Exception : \n"+e)};return{getDiff:y,data:t}}(HistoryUtils),TwoWayHashMap=function(){this.map={},this.revMap={}};extend(TwoWayHashMap.prototype,{set:function(e,t){if(void 0===e||void 0===t)throw"Invalid input: Key or Value can't be undefined";this.map[e]=t,this.revMap[t]=e},getVal:function(e){return this.map[e]},getKey:function(e){try{return JSON.parse(this.revMap[e])}catch(t){return this.revMap[e]}}});var QuickDiff=function(e){e=e||{};var t=44032,i={},o=new TwoWayHashMap,r=new RegExp(UNICODE.TABLE+"|"+UNICODE.TABLEEND,"g"),n=new RegExp(UNICODE.TOCSTART+"|"+UNICODE.TOCEND,"g"),a=(new RegExp(UNICODE.MERGEFIELD_START+"|"+UNICODE.MERGEFIELD_END,"g"),new RegExp(UNICODE.RANGE_START+"|"+UNICODE.RANGE_END,"g")),l=new RegExp(UNICODE.SECTION_START,"g"),s=0,d=-1,c=1,p={INS:"ins",DEL:"del"},u=e.cleanupSemantic||!0,f=function(e,t){return e.styles[t]},g=function(){var e={};return e[UNICODE.HR]=NODE_TYPE.HR,e[UNICODE.TABLE]=NODE_TYPE.TABLE,e[UNICODE.ROW]=NODE_TYPE.ROW,e[UNICODE.CELL]=NODE_TYPE.CELL,e[UNICODE.TABLEEND]=NODE_TYPE.TABLEEND,e[UNICODE.BR]=NODE_TYPE.BR,e[UNICODE.PARA]=NODE_TYPE.PARAGRAPH,e[UNICODE.SECTION_START]=NODE_TYPE.HEADER,function(t,i){var o=f(t,i);return o&&o.type||e[t.contStr[i]]||NODE_TYPE.TEXT}}(),m=function(e,t){for(var i=g(e,t);t>=0;){for(;null==f(e,t)&&t>0;)t--;if(i==g(e,t))break;t--}return t>=0?f(e,t):null},h=function(e){e=JSON.stringify(e);var i=o.getVal(e);return i||(i=String.fromCharCode(t++),o.set(e,i)),i},T=function(){i={},o=new TwoWayHashMap},E=function(e,t){var i=y(e,t);return i=D(i,t),i=C(i,t),i=I(i,t)},R=function(e,t,i){var o=e.substring(0,t),r=e.substring(t+1,e.length);return o+i+r},S=function(e,t,i){var o=e.slice(0,t),r=e.slice(t+1);return o.concat(i).concat(r)},O=function(e,t,i){var o=e.filter(function(e){return e.start<=t&&e.end>t}),r=e.filter(function(e){return e.start<t&&e.end<=t}),n=e.filter(function(e){return e.start>t&&e.end>t});return o=o.map(function(e){return e.end+=i-1,e}),n=n.map(function(e){return e.start+=i-1,e.end+=i-1,e}),r.concat(o).concat(n)},v=function(e,t,i){var o=i.filter(function(e){return e[0]==c}),r=i.filter(function(e){return e[0]==d}),n=t[0]==c?r:o,a=n.filter(function(t,i){var o=t[1];return o.indexOf(e)>-1}).length;return a},b=function(e,t,o){U.each(t,function(t){i[t.hashKey]=i[t.hashKey]||{},i[t.hashKey][o]={contStr:e.contStr.substring(t.start,t.end+1),styles:e.styles.slice(t.start,t.end+1)}})},A=function(e,t,i){var o={contStr:"",styles:[]};if(!t.length)return JSON.parse(JSON.stringify(e));var r=0;return U.each(t,function(i,n){o.contStr+=e.contStr.substring(r,i.start),o.styles=o.styles.concat(e.styles.slice(r,i.start)),o.contStr+=i.hashKey,o.styles.push({chartype:i.type});var a=t[n+1]?t[n+1].start:e.contStr.length;o.contStr+=e.contStr.substring(i.end+1,a),o.styles=o.styles.concat(e.styles.slice(i.end+1,a)),r=a}),o},y=function(e,t){for(var i=[],o=[],n=r.exec(e.contStr);n;){var a=e.contStr[n.index];if(a==UNICODE.TABLE)o.push(n.index);else if(a==UNICODE.TABLEEND){var l=o.pop();if(!o.length){var s=e.styles[l].id||"auto"+Utils.randomString(),d=h({type:"table",id:s});e.styles[l].id=s,i.push({start:l,end:n.index,hashKey:d,type:"table"})}}n=r.exec(e.contStr)}return b(e,i,t),A(e,i,t)},D=function(e,t){for(var i=[],o=[],r=n.exec(e.contStr);r;){var a=e.contStr[r.index];if(a==UNICODE.TOCSTART)o.push(r.index);else if(a==UNICODE.TOCEND){var l=o.pop(),s=h({type:"toc"});i.push({start:l,end:r.index,hashKey:s,type:"toc"})}r=n.exec(e.contStr)}return b(e,i,t),A(e,i,t)},C=function(e,t){for(var i=[],o=a.exec(e.contStr);o;){var r=e.contStr[o.index];if(r==UNICODE.RANGE_START){var n=e.styles[o.index],l=h({type:"rangestart",id:n.id});i.push({start:o.index,end:o.index,hashKey:l,type:"rangestart"})}else if(r==UNICODE.RANGE_END){var n=e.styles[o.index],l=h({type:"rangeend",id:n.id});i.push({start:o.index,end:o.index,hashKey:l,type:"rangeend"})}o=a.exec(e.contStr)}return b(e,i,t),A(e,i,t)},I=function(e,t){for(var i=[],o=l.exec(e.contStr);o;){var r=e.contStr[o.index];if(r==UNICODE.SECTION_START){var n=e.styles[o.index],a=h({type:"section",id:n.sid});i.push({start:o.index,end:o.index,hashKey:a,type:"section"})}o=l.exec(e.contStr)}return b(e,i,t),A(e,i,t)},P=function(e,t){if(!t.length)return JSON.parse(JSON.stringify(e));for(var o,r=new RegExp(t.join("|"),"g");null!=(o=r.exec(e.contStr));){var n=o[0],a=i[n].source&&!i[n].target,l=a?"source":"target";e.contStr=R(e.contStr,o.index,i[n][l].contStr),e.styles=S(e.styles,o.index,i[n][l].styles),e.dels=O(e.dels,o.index,i[n][l].contStr.length),e.ins=O(e.ins,o.index,i[n][l].contStr.length)}return e},_=function(e){var t=U.keys(i),r=t.filter(function(e){return"rangestart"===o.getKey(e).type||"rangeend"===o.getKey(e).type});return P(e,r)},N=function(e){var t=U.keys(i),r=t.filter(function(e){return"section"===o.getKey(e).type});return P(e,r)},L=function(e){var t=U.keys(i),r=t.filter(function(e){return"mergefield"===o.getKey(e).type});return P(e,r)},w=function(e){var t=U.keys(i),r=t.filter(function(e){return"toc"===o.getKey(e).type});return P(e,r)},M=function(e,t){return"contents"==t?i[e]:new F(e)},x=function(e){var t=U.keys(i),r=t.filter(function(e){return"table"===o.getKey(e).type});return U.each(r,function(t){var o,r,n;switch(o=i[t].target&&!i[t].source,r=i[t].source&&!i[t].target,n=void 0!=(i[t].source&&i[t].target),!0){case o:var a=M(t,"contents"),l=e.contStr.indexOf(t);e.contStr=R(e.contStr,l,a.target.contStr),e.styles=S(e.styles,l,a.target.styles),e.dels=O(e.dels,l,a.target.contStr.length),e.ins=O(e.ins,l,a.target.contStr.length);break;case r:var a=M(t,"contents"),l=e.contStr.indexOf(t);e.contStr=R(e.contStr,l,a.source.contStr),e.styles=S(e.styles,l,a.source.styles),e.dels=O(e.dels,l,a.source.contStr.length),e.ins=O(e.ins,l,a.source.contStr.length);break;case n:var s=M(t,"structure"),a=s.decode(),l=e.contStr.indexOf(t);e.contStr=R(e.contStr,l,a.diffed.contStr),e.styles=S(e.styles,l,a.diffed.styles),e.dels=O(e.dels,l,a.target.contStr.length),e.ins=O(e.ins,l,a.target.contStr.length),U.each(a.diffed.ins,function(e){e.start+=l,e.end+=l}),U.each(a.diffed.dels,function(e){e.start+=l,e.end+=l}),e.ins=e.ins.concat(a.diffed.ins),e.dels=e.dels.concat(a.diffed.dels)}}),JSON.parse(JSON.stringify(e))},F=function(e){this.hashKey=e,this.source=i[e].source,this.target=i[e].target,this.diffed={},this.diffed.ins=[],this.diffed.dels=[],this._cellContentHash={},this._charHash=new TwoWayHashMap,this.rows={source:{},target:{},diffed:{}},this.cells={source:[],target:[]},this.init()};extend(F.prototype,{hash:function(e){e=JSON.stringify(e);var i=this._charHash.getVal(e);return i||(i=String.fromCharCode(t++),this._charHash.set(e,i)),i},init:function(){var e=this.cells,t=this._cellContentHash;if(this.source){e.source=QuickDiff.getCells(this.source),U.each(e.source,function(e){var i=e.styles[0].id=e.styles[0].id||Utils.randomString(),o=this.hash({type:"cell",id:i});e.hashKey=o,t[o]=t[o]||{},t[o].source={contStr:e.contStr,styles:e.styles}},this);var i=QuickDiff.getRows(this.source);U.each(i,function(e){var t=e.styles[0].id=e.styles[0].id||Utils.randomString();this.rows.source[t]=e},this)}if(this.target){e.target=QuickDiff.getCells(this.target),U.each(e.target,function(e){var i=e.styles[0].id=e.styles[0].id||Utils.randomString(),o=this.hash({type:"cell",id:i});e.hashKey=o,t[o]=t[o]||{},t[o].target={contStr:e.contStr,styles:e.styles}},this);var i=QuickDiff.getRows(this.target);U.each(i,function(e){var t=e.styles[0].id=e.styles[0].id||Utils.randomString();this.rows.target[t]=e},this)}extend(this.diffed,JSON.parse(JSON.stringify(this.target))),e.diffed=QuickDiff.getCells(this.diffed),U.each(e.diffed,function(e){var i=e.styles[0].id,o=this.hash({type:"cell",id:i});t[o]=t[o]||{},t[o].diffed={contStr:e.contStr,styles:e.styles}},this);var i=QuickDiff.getRows(this.diffed);U.each(i,function(e){var t=e.styles[0].id;this.rows.diffed[t]=e},this)},getCellDiff:function(e){var t=this.rows.source[e],i=QuickDiff.getCells(t).map(function(e){var t=e.styles[0].id=e.styles[0].id||Utils.randomString();return this.hash({type:"cell",id:t})},this).join(""),o=this.rows.target[e],r=QuickDiff.getCells(o).map(function(e){var t=e.styles[0].id=e.styles[0].id||Utils.randomString();return this.hash({type:"cell",id:t})},this).join(""),n=QuickDiff.dmp.diff_main(i,r);return n},getRowDiff:function(){var e=U.keys(this.rows.target).filter(function(e){return!this.rows.source[e]},this),t=U.keys(this.rows.source).filter(function(e){return!this.rows.target[e]},this),i=U.keys(this.rows.target).filter(function(e){return this.rows.source[e]},this);return{insertions:e,deletions:t,retains:i}},getCellIdx:function(e,t,i){for(var o=new RegExp(UNICODE.CELL,"g"),r=o.exec(this[i].contStr);null!=r;){var n=this[i].styles[r.index];if(this._charHash.getKey(t).id===n.id)return{start:e+r.index,end:e+r.index+this._cellContentHash[t][i].contStr.length};r=o.exec(this[i].contStr)}},getRowIdx:function(e,t){for(var i=new RegExp(UNICODE.ROW,"g"),o=i.exec(this[t].contStr);null!=o;){var r=this[t].styles[o.index];if(e===r.id)return{start:o.index,end:o.index+this.rows[t][e].contStr.length};o=i.exec(this[t].contStr)}},diffCell:function(e){var t=new QuickDiff;return t.diff({contStr:this._cellContentHash[e].source.contStr,styles:this._cellContentHash[e].source.styles},{contStr:this._cellContentHash[e].target.contStr,styles:this._cellContentHash[e].target.styles})},addDiffedCell:function(e,t){var i=this.diffed;if(t.ins.length||t.dels.length){var o=this.getCellIdx(0,e,"diffed");i.contStr=i.contStr.substring(0,o.start)+t.contStr+i.contStr.substring(o.end),i.styles=i.styles.slice(0,o.start).concat(t.styles).concat(i.styles.slice(o.end)),i.ins=i.ins.concat(t.ins.map(function(e){return{start:o.start+e.start,end:o.start+e.end,str:e.str}})),i.dels=i.dels.concat(t.dels.map(function(e){return{start:o.start+e.start,end:o.start+e.end,str:e.str}}))}},diff:function(){var e=this.getRowDiff();return U.each(e.insertions,function(e){var t=this.getRowIdx(e,"diffed");this.diffed.ins.push({start:t.start,end:t.end,str:this.rows.diffed[e].contStr})},this),U.each(e.retains,function(e){var t=this.getCellDiff(e);U.each(t,function(e){var t=e[1];e[0]===c?U.each(t,function(e){var t=this.getCellIdx(0,e,"diffed");this.diffed.ins.push({start:t.start,end:t.end,str:this._cellContentHash[e].target.contStr})},this):e[0]===s&&U.each(t,function(e){var t=this.diffCell(e);this.addDiffedCell(e,t)},this)},this)},this),this.diffed},decode:function(){return this.diffed=this.diff(),U.extend(i[this.hashKey],{diffed:{contStr:this.diffed.contStr,styles:this.diffed.styles,ins:this.diffed.ins,dels:this.diffed.dels}})}});var k=function(e,t,r){return U.filter(e,function(e,n){if(i[e]){var a=o.getKey(e);if("rangestart"==a.type||"rangeend"==a.type||"table"==a.type||"toc"==a.type||"section"==a.type)return v(e,t,r)}}).map(function(t){return{ch:t,index:e.indexOf(t)}})},B=function(e,t){return e.source.contStr===t.target.contStr?100:0},J=function(e){return U.reduce(e,function(e,t,i){var o=U.reduce(t,function(e,i,o){var r=e?t[e]:0;return i>r?o:e},0),o=o&&t[o]>99&&!U.contains(U.values(e),o)?o:0;return e[i]=o,e},{})},H=function(e,t,r){var n=U.keys(i),a=n.filter(function(e){var t=o.getKey(e);return"table"===t.type&&i[e].source&&!i[e].target&&t.id.startsWith("auto")}),l=n.filter(function(e){var t=o.getKey(e);return"table"===t.type&&!i[e].source&&i[e].target&&t.id.startsWith("auto")}),s=U.reduce(a,function(e,t){var i=o.getKey(t),r=M(t,"contents");return e[i.id]=U.reduce(l,function(e,t){var i=o.getKey(t),n=M(t,"contents");return e[i.id]=B(r,n),e},{}),e},{});s=J(s),U.each(s,function(e,o){if(e){var r=h({type:"table",id:o}),n=h({type:"table",id:e}),a=QuickDiff.getRows(i[r].source),l=QuickDiff.getCells(i[r].source);U.each(a,function(e){e.styles[0].id=Utils.randomString()}),U.each(l,function(e){e.styles[0].id=Utils.randomString()}),i[r].target={},i[r].target.contStr=i[r].source.contStr,i[r].target.styles=JSON.parse(JSON.stringify(i[r].source.styles));var s=t.contStr.indexOf(n);t.contStr=R(t.contStr,s,r),delete i[n]}})},G=function(e){var t=new RegExp(UNICODE.SECTION_START,"g");t.lastIndex=1;for(var i=t.exec(e.content),o=[],r=0;i;)o.push({contStr:e.content.substring(r,i.index),styles:e.styles.slice(r,i.index)}),r=i.index,i=t.exec(e.content);return o.push({contStr:e.content.substring(r),styles:e.styles.slice(r)}),o},z=function(e){return e.filter(function(e){var t=e.styles[0];return"main"==t.sid&&!t.st&&!t.hftype})[0]},V=function(e){return e.filter(function(e){return U.contains([CONST.HEADER_EVEN,CONST.HEADER_PRIMARY,CONST.HEADER_FIRST],parseInt(e.styles[0].hftype))})},Y=function(e){return e.filter(function(e){return U.contains([CONST.FOOTER_EVEN,CONST.FOOTER_PRIMARY,CONST.FOOTER_FIRST],parseInt(e.styles[0].hftype))})},W=function(e){return e.filter(function(e){var t=e.styles[0];return"endnote"===t.st||"footnote"===t.st})},j=function(e){return e.reduce(function(e,t){return e.contStr+=t.contStr,e.styles=e.styles.concat(t.styles),e},{contStr:"",styles:[]})},Z=function(e,t){for(var i=0;i<t.length;i++){var o=t[i];if(e.sid===o.styles[0].sid)return!0}return!1},X=function(e,t){return e.filter(function(e){var i=e.styles[0];return Z(i,t)})},K=function(e,t){return t.filter(function(t){var i=t.styles[0];return!Z(i,e)})},$=function(e,t){return e.filter(function(e){var i=e.styles[0];return!Z(i,t)})},q=function(e,t){return{additions:K(e,t),deletions:$(e,t),retains:X(e,t)}},Q=function(e,t){return e.history_zuid=editor.zuid,e.history_action=t,e},ee=function(e,t,i){if(t.start!==t.end)for(var o=t.start;o<=t.end;o++){if(o==t.start){var r=m(e,o);r=Q(r,i),e.styles[o]=r,o=QuickDiff.getBlockEnd(e,o)}else if(o==t.end){var r=e.styles[o];r||(r=m(e,o),e.styles[o]=r)}else{var r=e.styles[o];r&&(r=Q(r,i)),e.styles[o]=r,o=QuickDiff.getBlockEnd(e,o)}if(o<0)return}},te=function(e){U.each(e.ins,function(t){ee(e,t,p.INS)}),U.each(e.dels,function(t){ee(e,t,p.DEL)})},ie=function(e,t){var i=JSON.parse(JSON.stringify(t));i.contStr="",i.styles=[],i.ins=[],i.dels=[];var o=G(e),r=G(t),n=z(o),a=z(r),l=j(V(r)),s=j(Y(r)),d=W(o),c=W(r),p=q(d,c),u=j(p.additions),f=j(p.retains),g=j(p.deletions),m=oe(n,a);return i.contStr+=m.contStr+l.contStr+s.contStr+f.contStr+u.contStr+g.contStr,i.styles=i.styles.concat(m.styles).concat(l.styles).concat(s.styles).concat(f.styles).concat(u.styles).concat(g.styles),i.ins=m.ins,i.dels=m.dels,i.SOURCE_VERSION=e.versionInfo&&e.versionInfo.writer_version,i.TARGET_VERSION=t.versionInfo&&t.versionInfo.writer_version,U.defaults(i.defaults,e.defaults),i.content=i.contStr,i},oe=function(e,t){T(),encodedSource=E({contStr:e.contStr,styles:e.styles},"source"),encodedTarget=E({contStr:t.contStr,styles:t.styles},"target"),e.contStr=encodedSource.contStr,e.styles=encodedSource.styles,t.contStr=encodedTarget.contStr,t.styles=encodedTarget.styles,H(e,t);var i=QuickDiff.dmp.diff_main(e.contStr,t.contStr);u&&QuickDiff.dmp.diff_cleanupSemantic(i);var o={};o.contStr="",o.styles=[],o.ins=[],o.dels=[];var r=0,n=0,a=0,l=o.ins,p=o.dels,f=[];U.each(i,function(u,g){var h=u[0],T=u[1];if(h==s){if(o.contStr+=T,f[0]==d){var E=m(t,n);t.styles[n]=E}o.styles=o.styles.concat(t.styles.slice(n,n+T.length)),r+=T.length,n+=T.length,a+=T.length}else if(h==c){if(f[0]==d){var E=m(t,n);t.styles[n]=E}o.contStr+=T,o.styles=o.styles.concat(t.styles.slice(n,n+T.length));var R=k(T,u,i),S=0;U.each(R,function(e){l.push({start:a+S,end:a+S+e.index,str:T.substring(S,e.index)}),S=e.index+1}),l.push({start:a+S,end:a+S+T.substring(S).length,str:T.substring(S)}),n+=T.length,a+=T.length}else if(h==d){var E=m(e,r);e.styles[r]=E;var R=k(T,u,i),O="",v=[],S=0;U.each(R,function(t){var i=T.substring(S,t.index);O+=i,v=v.concat(e.styles.slice(r,r+i.length)),S=t.index+1,r=r+i.length+1});var b=T.substring(S);O+=b,v=v.concat(e.styles.slice(r,r+b.length)),r+=b.length,o.contStr+=O,o.styles=o.styles.concat(v),p.push({start:a,end:a+O.length,str:O}),a+=O.length}f=u});var g=x(o);return g=w(g),g=L(g),g=_(g),g=N(g),o.contStr=g.contStr,o.styles=g.styles,o.ins=g.ins,o.dels=g.dels,o},re=function(e,t){var i=function(){t&&t(),PubSub.unsubscribe("Document/LoadingComplete",i)},o=function(){PubSub.unsubscribe("Document/LoadingComplete",i)};PubSub.subscribe("Document/LoadingComplete",i),PubSub.subscribe("Document/HistoryLoadError",o),te(e),editor.loadDocument({content:e,info:U.extend(editor.doc.docInfo,{SOURCE_VERSION:e.SOURCE_VERSION,TARGET_VERSION:e.TARGET_VERSION})})};return{quickdiff:ie,diff:oe,renderDiff:re}};QuickDiff.dmp=new diff_match_patch,QuickDiff.getTableEnd=function(e,t){var i=new RegExp(UNICODE.TABLE+"|"+UNICODE.TABLEEND,"g");t=e[t]===UNICODE.TABLE?t+1:t,i.lastIndex=t;for(var o=i.exec(e);null!=o;){var r=o[0];if(r!==UNICODE.TABLE)return o.index;i.lastIndex=QuickDiff.getTableEnd(e,o.index+1)+1,o=i.exec(e)}throw new Error("TABLE-END cannot be found for start: ",t)},QuickDiff.getTocEnd=function(e,t){var i=new RegExp(UNICODE.TOCSTART+"|"+UNICODE.TOCEND,"g");t=e[t]===UNICODE.TOCSTART?t+1:t,i.lastIndex=t;for(var o=i.exec(e);null!=o;){var r=o[0];if(r===UNICODE.TOCEND)return o.index}throw new Error("TOC-END cannot be found for start: ",t)},QuickDiff.getCellEnd=function(e,t){var i=new RegExp(UNICODE.CELL+"|"+UNICODE.ROW+"|"+UNICODE.TABLEEND+"|"+UNICODE.TABLE,"g");t=e[t]===UNICODE.CELL?t+1:t,i.lastIndex=t;for(var o=i.exec(e);null!=o;){var r=o[0];if(r!==UNICODE.TABLE)return o.index;i.lastIndex=QuickDiff.getTableEnd(e,o.index+1)+1}throw new Error("CELL-END cannot be found for start: ",t)},QuickDiff.getRowEnd=function(e,t){var i=new RegExp(UNICODE.ROW+"|"+UNICODE.TABLEEND+"|"+UNICODE.TABLE,"g");t=e[t]===UNICODE.ROW?t+1:t,i.lastIndex=t;for(var o=i.exec(e);null!=o;){var r=o[0];if(r!==UNICODE.TABLE)return o.index;i.lastIndex=QuickDiff.getTableEnd(e,o.index+1)+1}throw new Error("ROW-END cannot be found for start: ",t)},QuickDiff.getBlockEnd=function(e,t){var i=e.styles[t]||{};return"table"===i.type?QuickDiff.getTableEnd(e.contStr,t):"toc"==i.type?QuickDiff.getTocEnd(e.contStr,t):"cell"==i.type?QuickDiff.getCellEnd(e.contStr,t):"row"==i.type?QuickDiff.getRowEnd(e.contStr,t):t},QuickDiff.getRows=function(e){for(var t=[],i=null,o=1,r=e.contStr.length;o<r;){var n=e.contStr[o];if(n==UNICODE.ROW||n==UNICODE.TABLEEND){if(i){var a={};e.styles[i];a.contStr=e.contStr.substring(i,o),a.styles=e.styles.slice(i,o),a.start=i,a.end=o-1,t.push(a),i=null}n==UNICODE.ROW&&(i=o),o++}else n==UNICODE.TABLE?o=QuickDiff.getTableEnd(e.contStr,o+1)+1:o++}return t},QuickDiff.getCells=function(e){for(var t=[],i=null,o=1,r=e.contStr.length;o<r;){var n=e.contStr[o];if(n==UNICODE.CELL||n==UNICODE.ROW||n==UNICODE.TABLEEND||o==r-1){if(i){var a={};e.styles[i];a.contStr=e.contStr.substring(i,o),a.styles=e.styles.slice(i,o),a.start=i,a.end=o-1,t.push(a),i=null}n==UNICODE.CELL&&(i=o),o++}else n==UNICODE.TABLE?o=QuickDiff.getTableEnd(e.contStr,o+1)+1:o++}return t},function(){"use strict";var e={allBar:{}},t=function(e){this._={id:"QSB-"+e};var t;Object.defineProperties(this._,{JbarElem:{get:function(){return t&&t.length&&t.parent()||(t=J(document.createElement("div")).attr("id",this.id).html('<span class="quickSeekBarTitle" style="border-bottom:1px solid red; display:inline-block;"><span style="float:left; margin-top:2px; margin-bottom:2px; width:10px; height:10px;"> </span></span>'),J("#quickSeekBarDiv").append(t)),t}},JbulletinElems:{get:function(){return this.JbarElem.find(".quick-bulletin")}},JtitleElem:{get:function(){return this.JbarElem.find(".quickSeekBarTitle")}}})};t.prototype.addBulletins=function(){var e=this,t=0,i=[],o=ViewManager.pages.last.el.getBoundingClientRect().height*ViewManager.pages.length;U.each(this.ranges,function(r,n){var a=J.Deferred();a.done(function(){var i,a,l=DocTreeManager.lineAtIndex(r.start,editor.getPageID()),s=l&&l.el;s&&(i=PUtil.offset(s),a=i.top);var d;if(!s||a<=0){var c=ViewManager.getPageAtIndex(r.start),p=J(c.el).position().top;d=p*editor.zoomFactor*editor.editorPaneContainerHt/o,d+=6*++t}else d=a*editor.zoomFactor*editor.editorPaneContainerHt/o;var u=e.createNewBulletinSpan(r);u.style.top=d+e._.JtitleElem.outerHeight()+"px",u.onclick=function(t){EditorUtil.focusMultiByteSpan(),e.spotSelection(r,n)},J(u).addClass(e.selectedBulletinIndex===n?"bulletin-selected":"").appendTo(e._.JbarElem)}),i.push(a)});var r=0;clearInterval(e.addBulletinInterval),e.addBulletinInterval=setInterval(function(){i[r++].resolve(),r>=i.length&&clearInterval(e.addBulletinInterval)},0),J.when.apply(J,i).then(function(){e.callback&&e.callback()})},t.prototype.createNewBulletinSpan=function(e){return Utils.createElement("span",{style:"background-color: "+(e&&e.buttonBGColor||this.buttonBGColor)+"; border: 1px solid "+(e&&e.buttonBRColor||this.buttonBRColor),class:"quick-bulletin"})},t.prototype.drawQuickSeekBar=function(e){return e&&!J.isEmptyObject(e)&&e.ranges&&e.ranges.length?(this.initQuickSeekBar(e),this.addBulletins(),void this.showQuickSeekBar()):this.hideQuickSeekBar()},t.prototype.hideQuickSeekBar=function(){this._.JbarElem.length&&(this.removeAllBulletins(),this._.JbarElem.hide())},t.prototype.initQuickSeekBar=function(e){extend(this,e),this.selectedBulletinIndex=-1,this.removeAllBulletins(),this.setBarHeight(),this.setBarTitle(J.i18n("writer.common.NUMBER_OF_RESULTS")+" "+this.ranges.length)},t.prototype.removeAllBulletins=function(){this._.JbulletinElems.remove()},t.prototype.setBarHeight=function(){this._.JbarElem.css({height:editor.editorPaneContainerHt})},t.prototype.setBarTitle=function(e){this._.JtitleElem.attr("title",e).find("span").css({"background-color":this.buttonBGColor,border:"1px solid "+this.buttonBRColor})},t.prototype.showQuickSeekBar=function(){this._.JbarElem.show()},t.prototype.spotSelection=function(e,t){var i=DocTreeManager.lineAtIndex(e.start,editor.getPageID());if(i){Utils.addToStatistics("Selection Bulletin"),J(this.overlayToBeAnimated).removeClass(this.focusClass||""),this.selectedBulletinIndex=t;var o=ViewManager.getPageAtIndex(e.start)||ViewManager.pages.first;o&&!o.isPageRendered&&(editor.visiblePageNumbers.push(o.pageNumber),o.forceToRender(),o.content&&o.content.el&&(o.content.el.style.display="block")),Utils.scrollElementIntoView(i.el);var r=this;U.each(DocTreeManager.linesBetween(e.start,e.end),function(e){r._.JbulletinElems.removeClass("bulletin-selected").eq(t).addClass("bulletin-selected"),J(e.el).children(r.overlayToBeAnimated).addClass(r.focusClass||"").addTimerClass("bounceIn",800)})}};var i=function(i){var o=new t(i);return e.allBar[i]=o,o},o=function(t){return e.allBar[t]};PubSub.subscribe("QuickSeek/showBarWithObj",function(e){if(e&&e.id){var t=o(e.id)||i(e.id);t.drawQuickSeekBar(e)}}),PubSub.subscribe("QuickSeek/hideBarWithID",function(e){var t=o(e);t&&t.hideQuickSeekBar()}),PubSub.subscribe("QuickSeek/hideAllBar",function(){for(var t in e.allBar){var i=o(e.allBar[t]);i&&i.hideQuickSeekBar()}})}(),function(){var e=!1,t=!1,i="t3",o=/^\s*</,r="default-code",n=new RegExp(/=code\((.*)\)/),a="courier new, courier, monospace",l={t1:{ml:"0.125in",mr:"0.125in",bgc:"rgb(32, 39, 70)",borders:{"border-left":{type:"solid",width:"5px",color:"rgb(187,166,69)",space:"0.2in"},"border-right":{type:"solid",width:"0px",color:"rgb(187,166,69)",space:"0.1in"},"border-top":{type:"solid",width:"0px",color:"rgb(187,166,69)",space:"0.1in"},"border-bottom":{type:"solid",width:"0px",color:"rgb(187,166,69)",space:"0.1in"}},t_fgc:"rgb(255, 255, 255)"},t2:{ml:"0.125in",mr:"0.125in",bgc:"rgb(245, 245, 245)",borders:{"border-left":{type:"solid",width:"5px",color:"rgb(255,143,104)",space:"0.2in"},"border-right":{type:"solid",width:"0px",color:"rgb(255,143,104)",space:"0.1in"},"border-top":{type:"solid",width:"0px",color:"rgb(255,143,104)",space:"0.1in"},"border-bottom":{type:"solid",width:"0px",color:"rgb(255,143,104)",space:"0.1in"}},t_fgc:"rgb(0, 0, 0)"},t3:{ml:"0.125in",mr:"0.125in",bgc:"rgb(255, 255, 255)",borders:{"border-left":{type:"solid",width:"5px",color:"rgb(55,174,243)",space:"0.2in"},"border-right":{type:"solid",width:"1px",color:"rgb(225,225,225)",space:"0.1in"},"border-top":{type:"solid",width:"1px",color:"rgb(225,225,225)",space:"0.1in"},"border-bottom":{type:"solid",width:"1px",color:"rgb(225,225,225)",space:"0.1in"}},t_fgc:"rgb(0, 0, 0)"},t4:{ml:"0.125in",mr:"0.125in",bgc:"rgb(29, 31, 33)",borders:{"border-left":{type:"solid",width:"5px",color:"rgb(179,199,70)",space:"0.2in"},"border-right":{type:"solid",width:"0px",color:"rgb(179,199,70)",space:"0.1in"},"border-top":{type:"solid",width:"0px",color:"rgb(179,199,70)",space:"0.1in"},"border-bottom":{type:"solid",width:"0px",color:"rgb(179,199,70)",space:"0.1in"}},t_fgc:"rgb(255, 255, 255)"}},s={coffee:"Coffee Script",ruby:"Ruby",bash:"BASH",perl:"PERL","default-code":"Auto","default-markup":"Auto",c:"C",cpp:"C++",cs:"C#",java:"Java",js:"JavaScript",python:"Python",html:"HTML",xml:"XML",css:"CSS",json:"JSON",swift:"Swift",go:"GO",sql:"SQL"},d={},c={type:"text"};c[ATTR_TEXT.TS_FF]="",d[ATTR_COMMON.BORDERS]="",d[ATTR_PARAGRAPH.PS_CODE]="",d[ATTR_PARAGRAPH.PS_BGC]="",d[ATTR_PARAGRAPH.PS_ML]="",d[ATTR_PARAGRAPH.PS_MR]="",d[ATTR_COMMON.TYPE]=NODE_TYPE.PARAGRAPH,d[ATTR_PARAGRAPH.PS_TS]=c;var p=function(e){return o.test(e)?"default-markup":"default-code"},u=function(e){return e=e.toLowerCase()||r,e=s[e]?e:r},f=function(){if(e&&(w(),t&&editor.doc.getSelection().selectionType!==SEL_AUTO_GEN)){var i=N();if(i&&i.isCode()){var o=h(i),r=o.node.getCodeLanguage(),n=g(o);"default-code"!=r&&"default-markup"!=r||(r="auto"),Z("code-menu-container").css(n).show(),Z("code-lang-dropdown").zcombo("setValue",r),Z("code-theme-dropdown").zcombo("setValue",o.node.getCodeTheme()),EditorUtil.focusMultiByteSpan(),CurUtil.blinkCursor()}}},g=function(e){var t,i=10,o=editor.currentPageIndex;ViewManager.getPageAtPageNumber(o+1);if(e.node.section.name.indexOf("header")!=-1||e.node.section.name.indexOf("footer")!=-1){var r=DocTreeManager.lineAtIndex(editor.doc.getSelection()[0].start,editor.getPageID()).parent;t=PUtil.offset(ViewManager.getViewElements(h(r).node,editor.getPageID())[0])}else t=PUtil.offset(e.el);var n=e.node.paraProperties?e.node.paraProperties.paraFormat.ml:"0in",a=e.node.paraProperties?e.node.paraProperties.paraFormat.mr:"0in",l=n.convertUnitTo("px"),s=a.convertUnitTo("px"),d=e.node.paraProperties.paraFormat.borders||{},c=d[ATTR_BORDERS.BORDER_LEFT]?d[ATTR_BORDERS.BORDER_LEFT].space.convertor().pixels:0,p=d[ATTR_BORDERS.BORDER_RIGHT]?d[ATTR_BORDERS.BORDER_RIGHT].space.convertor().pixels:0,u=Math.max(p,10);return t.top+=i,t.left=t.left+e.width-s-l+u+c-(editor.editorOffset.left+editor.editorPaneContainer.scrollLeft()),{top:t.top*editor.zoomFactor,right:editor.jeditorPaneWrapper.width()-t.left*editor.zoomFactor}},m=function(e){var t=N(),i=t.getCodeLanguage(),o=t.getCodeTheme();o!=e&&editor.doc.execCmd("updatecode",[i,e])},h=function(e){var t=T(e);if(t){for(var i=ViewManager.getPageNumber(t),o=t,r=o.prev,n=o.node.getCodeProperties();r&&v(r.node)&&i==ViewManager.getPageNumber(r)&&O(n,r.node.getCodeProperties());)o=r,r=o.prev;return o}},T=function(e){var t=ViewManager.getViews(e);if(t){var i=t.length;if(1==i)return t[0];if(i>1)for(var o,r,n,a,l=editor.doc.getSelection(),s=l.getStart(),d=0;d<i;d++)if(o=t[d],a=o.nodeLines,r=o.node.start+a[0].start,n=o.node.start+a[a.length-1].end,s>=r&&s<=n)return o}},E=function(e,t){var i=S(),o=i.length;if(o){var r=i[0],n=i[0].getIndex(),a=i[o-1].getEndIndex()+1;"auto"==e&&(e=p(r.content())),t=t||r.getCodeTheme(),A(e,t,n,a)}},R=function(e){var t=[],i=e,o=e.getCodeProperties();if(e.isCode()){for(;i.prev&&O(o,i.prev.getCodeProperties());)t.unshift(i.prev),i=i.prev;for(t.push(e),i=e;i.next&&O(o,i.next.getCodeProperties());)t.push(i.next),i=i.next}return t},S=function(){var e,t=[],i=editor.doc.getSelection(),o=i.getNodesInSelection(NODE_TYPE.PARAGRAPH),r=o.length;if(e=o[0].dtNode,i.isCollapsed())t=R(e);else for(var n=0;n<r;n++)t.push(o[n].dtNode);return t},O=function(e,t){return Utils.compareJSON(e,t)},v=function(e){return"para"==e.type&&e.isCode()},b=function(e,t){var o=editor.doc.getSelection(),r=o.getNodesInSelection(NODE_TYPE.PARAGRAPH),n=r.length,a=r[0];if("auto"==e&&(e=p(a.dtNode.content())),a.dtNode.isCode())return void Command.exec("uncode",!0);var l=r[0].getStart(),s=r[n-1].getEnd();t=t||i,e=e||p(a.dtNode.content()),A(e,t,l,s,r)},A=function(e,t,o,r,n){var s={},d=editor.doc.getSelection(),c=l[t||i],u=DocUtil.formatGenerator.getParaFormat("ParaBackColor",c.bgc),f=(DocUtil.getKeys(u),d.getTargetRange()),g=f.cloneRange();f.setStart(o),f.setEnd(r),s=DocUtil.formatGenerator.getTextFormat(u,"FontName",a),s[ATTR_TEXT.TS_FGC]="",s[ATTR_TEXT.TS_BGC]="",d.applyFormat(s),d=editor.doc.getSelection(),n=n||d.getNodesInSelection(NODE_TYPE.PARAGRAPH),u[ATTR_PARAGRAPH.PS_TS]=s,u[ATTR_PARAGRAPH.PS_ML]=c.ml,u[ATTR_PARAGRAPH.PS_MR]=c.mr,u[ATTR_COMMON.BORDERS]=c.borders,u[ATTR_PARAGRAPH.PS_CODE]={lg:e||p(n[0].dtNode.content()),theme:t,t_fgc:c.t_fgc,p_bgc:c.bgc},D(n,u),d.removeAllRanges().addRange(g)},y=function(e){var t=editor.doc.getSelection(),i=editor.doc.getNodesInSelection(NODE_TYPE.PARAGRAPH,t.getStart(),t.getEnd()),o=i.length;if(o){var r,n;if(e){var a=i[0];if(i=R(a.dtNode),o=i.length,!o)return;var l=i[0].getIndex(),s=i[o-1].getEndIndex()+1;r=t.getTargetRange(),n=r.cloneRange(),r.setStart(l),r.setEnd(s),i=t.getNodesInSelection(NODE_TYPE.PARAGRAPH)}t.applyFormat(c);for(var p=0,o=i.length;p<o;p++)i[p].attr(DocUtil.copyStyle(d));e&&t.removeAllRanges().addRange(n)}},D=function(e,t){var i,o;for(i=0;i<e.length;i++)o=e[i],o.attr(t)},C=function(e){var t=e.text(),o=n.exec(t)[1];o=u(o),editor.doc.execCmd("code",[o,i]),editor.doc.getSelection().deleteContents(e.getStart(),e.getEnd()-1)},I=function(){var e=N();if(e){var t=R(e),i=t.length;if(i){var o=t[0].getIndex(),r=t[i-1].getEndIndex()+1,n=editor.doc.createRange(o,r);editor.doc.getSelection().removeAllRanges().addRange(n)}}},P=function(){if(L()){UIUtils.initComponent("code-menu-container"),e=!0;var t=Z("code-menu-container");t.on("comboshow",function(){t.addClass("ui-focused")}),t.on("combohide",function(){t.removeClass("ui-focused")})}},_=function(){var e=N();return e&&e.isCode()},N=function(){var e=editor.doc.getSelection(),t=editor.doc.getParents(NODE_TYPE.PARAGRAPH,e[0].start);if(t)return t.dtNode},L=function(){var e=editor.doc.getRole();return editor.isEditable()&&"SHAREDREADCOMMENT"!=e&&"ANYONELINK_SHAREDREADCOMMENT"!=e},w=function(){var e=Z("code-menu-container");e.hide()},M=function(e){if(e=e||[],!e.length)return!1;for(var t=0;t<e.length;t++)if(!e[0].dtNode.isCode())return!1;return!0},U=function(){L()&&(t=!0,PubSub.subscribe("Document/Command/Code/Insert",b),PubSub.subscribe("Document/Command/Code/Update",E),PubSub.subscribe("Document/Command/Code/Remove",y),PubSub.subscribe("Document/Command/Code/InsertRandomCode",C),PubSub.subscribe(["Cursor/Selected","Cursor/Collapsed"],f,{async:!0,timeout:500}),PubSub.subscribe("Document/Resize",f,{async:!0,timeout:30}))},x=function(){t=!1,w(),PubSub.unsubscribe("Document/Command/Code/Insert",b),PubSub.unsubscribe("Document/Command/Code/Update",E),PubSub.unsubscribe("Document/Command/Code/Remove",y),PubSub.unsubscribe("Document/Command/Code/InsertRandomCode",C),PubSub.unsubscribe(["Cursor/Selected","Cursor/Collapsed"],f,{async:!0}),PubSub.unsubscribe("Document/Resize",f,{async:!0})};PubSub.subscribe("Document/readonlyview",x),PubSub.subscribe("Document/ComponentReady",U),PubSub.subscribe("Document/FirstTimeComponentReady",P),window.ZWCode={isCodePara:_,selectCodeBlock:I,isOnlyCodeParas:M,handleSwitchThemeBtnClick:m}}();var TableVisualCueHandler=function(){var e=null,t=null,i=null,o=null,r=!1,n=!1,a={},l=null,s=null,d=null,c=null,p=null,u=0,f=!0,g=void 0,m=!1,e=null,h=!0,T=1,E=J(".ui-tbl-vc-tp-popup"),R=J(".ui-tbl-vc-lt-popup"),S=J("#tableMove"),O=J("#table-bubble"),v=null,b=!1,A=!1,y=null,D=null,C=J("#insert-dummy-container"),I=J("#insert-dummy-div"),P=J("#dummyRowDiv"),_=J("#dummyColDiv"),N={},L=15,w=15,M=[],U=!1,x=!1,F=!1,k=function(e,t){clearTimeout(g);var i=J(e);DocUtil.getDocElement(i[0]);if((!l||i[0]!=v[0])&&J(e).parents("."+editor.clientActiveSection.className.split(" ")[0])[0])return l&&W(),t?void B(e):void(g=setTimeout(function(){B(e)},300))},B=function(r){v=J(r);var n=DocUtil.getDocElement(v[0]);i=n,e=i.getStart(),t=i.getEnd(),je(),o=i.dtNode,tableHeight=parseInt(v.height()),currentTableOffset=v.offset(),H(),K()},H=function(){l=J(Handlebars.compile(J("#table-visualcue-menu").html())()),s=J(l[0]).children(),D=J(s[0]),y=J(s[1]),G(),z(),Y(),n=!0,X("0.5")},G=function(){var e=editor.doc.getRawFormatAt(i.getStart()),t=TableUtil.getCols(i),o=[];if(e.wid.indexOf("%")!=-1){var r=0;if(TableUtil.isInnerTable(i)){var n=i.parentNode().getStart(),a=parseInt(getComputedStyle(DocTreeManager.getNodeAtIndex(n+1)).width);r=parseFloat(e.wid)/100*a}else r=parseFloat(e.wid)/100*J(v).parent("div.zw-column").width();for(var l=0;l<t.length;l++){var s=parseFloat(t[l].wt),d=s/100*r;o[l]={},o[l].wt=d}}else{var r=e.wid.convertor().pixels;o=t}r*=editor.zoomFactor;var l,c=o.length,p=D.find(".ui-tbl-vc-tp-cell").clone();D.children().remove();var u=i.attr();for(l=0;l<c;l++){var d=0;d=u.dir&&"rtl"==u.dir?o[c-1-l].wt.convertor().pixels*editor.zoomFactor:o[l].wt.convertor().pixels*editor.zoomFactor,p[0].style.width=d+"px",p[0].setAttribute("id","cell-column-"+(l+1));var f=p.find(".ui-tbl-hd-content");f[0].style.width=d-1+"px",D.append(p),p=p.clone()}var g=J(document.createElement("div"));g.addClass("clearfix"),D[0].style.width=r+15+"px",D.append(g)},z=function(){for(var e=ViewManager.getView(v),t=e.node,i=ViewManager.getViews(t),o=!1,r=0,n=0;!o;){var a=i[r];if(a==e)o=!0;else{var l=!!(a.views&&a.views.last&&ViewManager.getViews(a.views.last.node).length>1);n+=l?a.views.length-1:a.views.length}r++}y[0].style["counter-reset"]="numberIncreament "+n;var s=y.find(".ui-tbl-vc-lt-cell").clone();y.children().remove();var d=v.children("tbody").children("tr.zw-tr"),c=d.length;for(r=0;r<c;r++){var p=J(d[r]).height()*editor.zoomFactor;s[0].setAttribute("id","cell-row-"+(r+1));var u=s.find(".ui-tbl-vc-lt-content");u[0].style.height=p-1+"px",n+r+1>99?w=25:n+r+1>9&&(w=20),y.append(s),s=s.clone()}y.find(".ui-tbl-vc-lt-content").css("width",w+"px")},V=function(){if(v){var e=v.offset();editor.jeditorPane.offset();a.top=e.top-L,a.left=e.left-w,a.right=e.left+w+v.width()*editor.zoomFactor,a.bottom=e.top+L+v.height()*editor.zoomFactor}},Y=function(){var e=Z("popup-menu-container");V();var t=v.offset(),i=ViewManager.getView(v),o=editor.jeditorPane.offset(),r=t.top-o.top,n=t.left-o.left,a=2;s[0].style.top=r-L-a+"px",s[0].style.left=n+"px",s[1].style.top=r+"px",s[1].style.left=n-w-a+"px",S[0].style.top=r-L-a+"px",S[0].style.left=n-w-a+"px",e.append(l),D.show(),y.show(),0==i.rowStart&&S.show()},W=function(i,o){if(i){var r=i.clientX,s=i.clientY;r>=a.left-30&&s<=a.top+30&&s>=a.top-30||r<=a.left+30&&s<=a.bottom+30&&r>editor.editorOffset.left?(X("1",100),h=!0):f&&X("0.5")}else clearTimeout(g),n&&(n=!1,l.remove(),M=[],S.hide(),E.hide(),R.hide(),O.hide(),e=t=0,J("#insert-dummy-container").hide(),J("#insert-dummy-div").hide(),J("#table-visual-cue-popups")[0].style.opacity="1",l=null,v=null,Ae(),A=!1,b=!1,F=!1,x=!1,N={})},j=function(e){if(1==e){var t=parseInt(J(ViewManager.getViewElements(o,editor.getPageID())).height());if(tableHeight!=t)return ye(),void TableResize.updateTableResizeIcon(i);J(l.children()[1]).children().show();var r={width:"0px",height:"0px","background-color":"none"};J(l.children()[1]).css(r)}else if(!h){J(l.children()[1]).children().hide();var r={width:w+"px",height:v.height()*editor.zoomFactor+"px","background-color":"#efefef"};J(l.children()[1]).css(r)}},X=function(e,t){n&&(e||(e=T),T=e,clearTimeout(g),t?g=setTimeout(function(){j(e),"0.1"==!J("#tablePropWrapper")[0].style.opacity&&(J("#tablePropWrapper")[0].style.opacity=e),J("#table-visual-cue-popups").children().css("opacity",e),l.children().css("opacity",e),Z("tableResizeIconDiv").css("opacity",e)},t):(j(e),"0.1"==!J("#tablePropWrapper")[0].style.opacity&&(J("#tablePropWrapper")[0].style.opacity=e),J("#table-visual-cue-popups").children().css("opacity",e),l.children().css("opacity",e),Z("tableResizeIconDiv").css("opacity",e)))},K=function(){r||(J("#table-bubble").unbind().on("click",function(e){return e.stopPropagation(),q(),!1}),PubSub.subscribe(["Document/TableDeleted"],W),PubSub.subscribe(["Document/TableStructureModified","Document/Zoom","Document/UndoRedo"],ye,!0),PubSub.subscribe(["Document/TableStructureModified"],function(e){try{e||(e=DocUtil.getDocElement(TableVisualCueHandler.getTargetElement())),PanelUtil.updateTablePropWrapperPos(),TableResize.updateTableResizeIcon(e)}catch(e){}}),PubSub.subscribe(["Document/Resize"],V),J("#tableMove").on("mousedown",function(e){PubSub.publish("Document/Table/MouseDown",v)}),J("#tableMove").on("mousemove",function(e){EventHandler.isTableDrag&&(J("#tableMove").hide(),X("0")),PubSub.publish("Document/Table/DragInProgress",null,v)}),J("#tableMove").on("mouseup",function(e){return e.stopPropagation(),PubSub.publish("Document/Table/DragStopped",e,o),ye(),!1}),PubSub.subscribe("Document/BeforeKeyDown",We),TableMoveHandler.bindEvents(),r=!0),J(".ui-tbl-vc-tp-cell").on("click",function(e){b=!1,U=!1,x=!1,F=!1,N={};var t=e.ctrlKey;return m=!e.altKey&&!e.shiftKey&&(editor.browserInfo.is_mac?!t&&e.metaKey:t),f=!1,Q(this),e.stopPropagation(),!1}),J(".ui-tbl-vc-lt-cell").on("click",function(e){A=!1,U=!1,x=!1,F=!1,N={};var t=e.ctrlKey;return m=!e.altKey&&!e.shiftKey&&(editor.browserInfo.is_mac?!t&&e.metaKey:t),f=!1,te(this),e.stopPropagation(),!1}),J(".ui-tbl-vc-tp-cell").on("mouseover",function(e){J(J(this).children()[1]).hasClass("ui-active")&&!U&&re(this)}),J(".ui-tbl-vc-lt-cell").on("mouseover",function(e){J(J(this).children()[1]).hasClass("ui-active")&&!U&&oe(this)}),J(".ui-tbl-vc-tp-cell").on("mousedown",function(e){return J(this).find("div.ui-tbl-hd-content").hasClass("drag-ui-tbl-hd-content")?de(e,this):(U=!0,x=!0,F=!1,b=!1),N.x=e.clientX,N.y=e.clientY,N.max={},N.max.x=e.clientX,N.max.y=e.clientY,N.min={},N.min.x=e.clientX,N.min.y=e.clientY,N.currentCell=d,N.currentColIndex=u,e.stopPropagation(),!1}),J(".ui-tbl-vc-tp-cell").on("mousemove",function(e){return ce(e,this),e.stopPropagation(),!1}),J(".ui-tbl-vc-tp-cell").on("mouseup",function(e){U=!1,x=!1,F=!1,m=!1,b&&pe(e,this),b=!1,A=!1,N={}}),J(".ui-tbl-vc-lt-cell").on("mousedown",function(e){return J(this).find("div.ui-tbl-vc-lt-content").hasClass("drag-ui-tbl-hd-content")?ne(e,this):(U=!0,F=!0,x=!1,A=!1),N.x=e.clientX,N.y=e.clientY,N.max={},N.max.x=e.clientX,N.max.y=e.clientY,N.min={},N.min.x=e.clientX,N.min.y=e.clientY,N.currentCell=d,N.currentColIndex=u,e.stopPropagation(),!1}),J(".ui-tbl-vc-lt-cell").on("mousemove",function(e){return ae(e,this),e.stopPropagation(),!1}),J(".ui-tbl-vc-lt-cell").on("mouseup",function(e){U=!1,x=!1,F=!1,m=!1,A&&le(e,this),A=!1,b=!1,N={}})},$=function(){var t=editor.doc.getRole();if(!editor.isEditable()||"SHAREDREADCOMMENT"==t||"ANYONELINK_SHAREDREADCOMMENT"==t)return!1;var i=editor.doc.getSelection(),o=i.getStart(),r=editor.doc.getParents(NODE_TYPE.TABLE,o),n=J(DocTreeManager.getNodeAtIndex(o)).parents("table.zw-table");return n&&v&&n[0]==v[0]&&i._.SELECTION_TYPE!=SEL_AUTO_GEN&&i._.SELECTION_TYPE!=SEL_OP_GEN?(TableMoveHandler.setTableSelected(!1),i[0]._.isPartialTableSelected?void W():(setTimeout(function(){je()},100),be(),void(n.offset().top!=currentTableOffset.top&&ye()))):void(n&&r&&!i[0]._.isPartialTableSelected?i._.SELECTION_TYPE!=SEL_AUTO_GEN&&i._.SELECTION_TYPE!=SEL_OP_GEN||r.getStart()!=e?k(n):Ae():(TableMoveHandler.setTableSelected(!1),W()))};PubSub.subscribe(["Cursor/Collapsed","Cursor/Selected"],$);var q=function(){var e=editor.doc.getSelection(),t=o?o.firstChild().firstChild().getIndex()+1:1,i=editor.doc.createRange(t,t);e.removeAllRanges().setSelectionType(SEL_AUTO_GEN).addRange(i),O.hasClass("col-bubble")?Ie(d):_e(d),ye()},Q=function(e,t){Re(e,!1);var i=editor.doc.getSelection();if(m)Ve(["drag-ui-tbl-hd-content"]);else{var o=d.getStart()+1,r=editor.doc.createRange(o,o);i.removeAllRanges().setSelectionType(SEL_AUTO_GEN).addRange(r),Ve(["ui-active","drag-ui-tbl-hd-content"]),M=[]}i.selectColumn(c).setSelectionType(SEL_AUTO_GEN).select(),M.push(p),Ge("ui-active"),Se(p,!1),t||re(e),setTimeout(function(){je(),Oe(J(e),!1)},100)},ee=function(e,t){var i=editor.doc.getSelection(),o=J(v.children("tbody").children("tr.zw-tr")[0]).children("td.zw-td"),r=parseInt(e.id.split("cell-column-")[1]);if(t.clientX<N.max.x&&t.clientX>N.x){var n=J("#cell-column-"+(r+1));if(Utils.arrayContains(M,n[0])){var a=o[r-1];i.selectColumn(a).setSelectionType(SEL_AUTO_GEN).select(),J(n.children()[1]).removeClass("ui-active"),J(n.children()[1]).removeClass("drag-ui-tbl-hd-content"),ze(n[0])}}else if(t.clientX<N.x&&t.clientX>N.min.x){var l=J("#cell-column-"+(r-1));if(Utils.arrayContains(M,l[0])){var a=o[r-1];i.selectColumn(a).setSelectionType(SEL_AUTO_GEN).select(),J(l.children()[1]).removeClass("ui-active"),J(l.children()[1]).removeClass("drag-ui-tbl-hd-content"),ze(l[0])}}setTimeout(function(){je()},100)},te=function(e,t){Re(e,!0);var i=editor.doc.getSelection();if(EventHandler.isOnlyCtrlKeyPressed||m){var o=d.getStart()+1,r=editor.doc.createRange(o,o);i.isCtrlSelection=!0,i.showCaret(r),Ve(["drag-ui-tbl-hd-content"])}else{i.isCtrlSelection=!1;var o=d.getStart()+1,r=editor.doc.createRange(o,o);i.removeAllRanges().setSelectionType(SEL_AUTO_GEN).addRange(r),Ve(["ui-active","drag-ui-tbl-hd-content"]),M=[]}M.push(p),Se(p,!0),Ge("ui-active"),i.selectRow(J(c).parents("tr.zw-tr")[0]).setSelectionType(SEL_AUTO_GEN).select(),t||oe(e),setTimeout(function(){je(),Oe(J(p),!0)},100)},ie=function(e,t){var i=editor.doc.getSelection(),o=(J(v.children("tbody").children("tr.zw-tr")[0]).children("td.zw-td"),parseInt(e.id.split("cell-row-")[1]));if(t.clientY<N.max.y&&t.clientY>N.y){var r=J("#cell-row-"+(o+1));if(Utils.arrayContains(M,r[0])){var i=editor.doc.getSelection(),n=i.getLastRange();i.removeRange(n),J(r.children()[1]).removeClass("ui-active"),J(r.children()[1]).removeClass("drag-ui-tbl-hd-content"),ze(r[0])}}else if(t.clientY<N.y&&t.clientY>N.min.y){var a=J("#cell-row-"+(o-1));if(Utils.arrayContains(M,a[0])){var i=editor.doc.getSelection(),n=i.getLastRange();i.removeRange(n),J(a.children()[1]).removeClass("ui-active"),J(a.children()[1]).removeClass("drag-ui-tbl-hd-content"),ze(a[0])}}setTimeout(function(){je()},100)},oe=function(e){if(!b&&!A){var t=J(e).offset(),i=editor.jeditorPane.offset(),o=t.top-i.top-R.height()/2+J(e).height()/2,r=t.left-i.left-R.width()-10;R[0].style.top=o+"px",R[0].style.left=r+"px",R.parent()[0].style.opacity="1",R.show(),J("#tablePropWrapper").css("opacity","0.1")}},re=function(e){if(!b&&!A){var t=J(e).offset(),i=editor.jeditorPane.offset(),o=t.top-i.top-E.height()-10,r=t.left-i.left-E.width()/2+J(e).width()/2;E[0].style.top=o+"px",E[0].style.left=r+"px",E.parent()[0].style.opacity="1",J("#tablePropWrapper").css("opacity","0.1"),E.show()}},ne=function(e,t){var i=d,o=c,r=u;Ae(),Oe(J(t),!0);var n=d.parentNode();return TableUtil.isVerticalMergedRow(n)?(d=i,c=o,void(u=r)):void P.hide()},ae=function(e,t){if(U)x||(0!=M.length&&(m=!0),Utils.arrayContains(M,t)?ie(t,e):te(t,!0),N.max.y<e.clientY&&(N.max.x=e.clientX,N.max.y=e.clientY),N.min.y>e.clientY&&(N.min.x=e.clientX,N.min.y=e.clientY));else{if(N.x){if(b)return;A=!0}if(!A)return void(N={});P.is(":visible")?se(e):(Ae(),Ee(),P[0].style.display="block")}},le=function(e,t){if(A){var i=N.currentCell;N.currentColIndex,{x:e.clientX,y:e.clientY};if(t&&J(t).hasClass("ui-tbl-vc-lt-cell")?Oe(J(t),!0):ve(e,!0),P.hide(),A=!1,N={},i.getStart()==d.getStart())return;currentRow=i.parentNode(),moveToRow=d.parentNode(),Ue(currentRow,moveToRow)}ye(),e.stopPropagation(),setTimeout(function(){var e=editor.doc.getParents("cell",editor.doc.getSelection().getStart());if(e&&"cell"==e.type){var t=e.parentNode(),i=t.parentNode().nodeCountBefore(t),o=J("#cell-row-"+(i+1))[0];o&&(Ve(["ui-active","drag-ui-tbl-hd-content"]),M=[],M.push(o),Re(o,!0),Se(o,!0)),je(),Oe(J(o),!0)}},800)},se=function(e){var t=e.clientY-N.y,i=P.offset();dummyDivLeft=i.left,P[0].style.top=t+N.element.y+"px";var o=J(c).offset(),r=J(c).height()*editor.zoomFactor;if(e.clientY>N.max.y){var o=J(c).parent().next().children().offset(),r=J(c).parent().next().children().height()*editor.zoomFactor,n=i.top+P.height();if(o&&n>o.top+r/2){var a=J(e.target).parents(".ui-tbl-vc-lt-cell"),l=!1;a[0]?(l=!0,Oe(a,!0)):l=ve(e,!0),l&&(he("ins-row-before",!0),N.max.x=e.clientX,N.max.y=e.clientY)}}else{var o=J(c).parent().prev().children().offset(),r=J(c).parent().prev().children().height()*editor.zoomFactor,n=i.top;if(o&&n<o.top+r/2){var a=J(e.target).parents(".ui-tbl-vc-lt-cell"),l=!1;a[0]?(l=!0,Oe(a,!0)):l=ve(e,!0),l&&(he("ins-row-before",!0),N.max.x=e.clientX,N.max.y=e.clientY)}}e.stopPropagation()},de=function(e,t){var i=d,o=c,r=u;return Ae(),Oe(J(t),!1),TableUtil.isHorizontalyMergedColumn(d)?(d=i,c=o,void(u=r)):void _.hide()},ce=function(e,t){if(U)return void(F||(0!=M.length&&(m=!0),Utils.arrayContains(M,t)?ee(t,e):Q(t,!0),N.max.x<e.clientX&&(N.max.x=e.clientX,N.max.y=e.clientY),N.min.x>e.clientX&&(N.min.x=e.clientX,N.min.y=e.clientY)));var i=_;if(N.x){if(A)return;b=!0}var i=_;return b?void(i.is(":visible")?ue(e):(Ae(),Te(),i[0].style.display="block")):void(N={})},pe=function(e,t){if(b){var i=N.currentCell,o=N.currentColIndex;({x:e.clientX,y:e.clientY});_.hide(),b=!1;var r="ltr";e.clientX<N.x&&(r="rtl"),insertAfter=!1,"ltr"==r?insertAfter=!0:"rtl"==r&&(insertAfter=!1),N={};var n=editor.doc.getParents(NODE_TYPE.TABLE,editor.doc.getSelection().getStart()),a=n.children()[0],l=a.children();i=l[o];var s=l[u];if(i.getStart()==s.getStart()&&(o==u+1&&insertAfter||o==u-1&&!insertAfter||!insertAfter))return d=i,void(u=o);Me(s,o,i,insertAfter)}e.stopPropagation(),ye(),setTimeout(function(){var e=J("#cell-column-"+(u+1))[0];e&&(Ve(["ui-active","drag-ui-tbl-hd-content"]),M=[],M.push(e),Re(e,!1),Se(e,!1),je(),Oe(J(e),!1))},800)},ue=function(e){var t=_,i=e.clientX-N.x,o=t.offset();dummyDivLeft=o.left,t[0].style.left=i+N.element.x+"px";var r=J(c).offset(),n=J(c).width()*editor.zoomFactor;if(e.clientX>N.max.x){var r=J(c).next().offset(),n=J(c).next().width()*editor.zoomFactor,a=o.left+t.width();if(r&&a>r.left+n/2){var l=ve(e,!1);l&&(me(null,!0),N.max.x=e.clientX,N.max.y=e.clientY)}}else{var r=J(c).prev().offset(),n=J(c).prev().width()*editor.zoomFactor,a=o.left;if(r&&a<r.left+n/2){var l=ve(e,!1);l&&(me("ins-col-before",!0),N.max.x=e.clientX,N.max.y=e.clientY)}}},fe=function(e){var t=(J(e),e.id);"del-col"==t||"del-row"==t?(J(".overlay").addClass("ui-tbl-red-overlay"),Ge("ui-tbl-hd-content-red")):t.indexOf("ins-col")!=-1?me(t):t.indexOf("ins-row")!=-1&&he(t)},ge=function(e){var t=(J(e),e.id);"del-col"==t||"del-row"==t?(J(".overlay").removeClass("ui-tbl-red-overlay"),Ve("ui-tbl-hd-content-red")):t.indexOf("ins-")!=-1&&(I.hide(),C.hide())},me=function(e,t){var i=v.height()*editor.zoomFactor,o=I[0],r=C[0];o.style.height=i+"px",o.style.width="10px",r.style.width="10px",r.style.height=L+"px";var n=editor.jeditorPane.offset(),a=J(c).offset();tdLeft=a.left-n.left,tdTop=a.top-n.top;var l=2;"ins-col-before"==e?(o.style.top=tdTop+"px",o.style.left=tdLeft-4+"px",r.style.left=tdLeft-4+"px",r.style.top=tdTop-L-l+"px"):(o.style.top=tdTop+"px",o.style.left=tdLeft+J(c).width()*editor.zoomFactor+"px",r.style.left=tdLeft+J(c).width()*editor.zoomFactor+"px",r.style.top=tdTop-L-l+"px"),I.show(),t||C.show()},he=function(e,t){var i=v.width()*editor.zoomFactor,o=I[0],r=C[0];o.style.width=i+"px",o.style.height="10px",r.style.width=w+"px",r.style.height="10px";var n=2,a=editor.jeditorPane.offset(),l=J(c).offset();tdLeft=l.left-a.left,tdTop=l.top-a.top,"ins-row-before"==e?(o.style.top=tdTop-5+"px",o.style.left=tdLeft+"px",r.style.left=tdLeft-w-n+"px",r.style.top=tdTop-6+"px"):(o.style.top=tdTop+J(c).height()*editor.zoomFactor+"px",o.style.left=tdLeft+"px",r.style.left=tdLeft-w-n+"px",r.style.top=tdTop+J(c).height()*editor.zoomFactor+"px"),I.show(),t||C.show()},Te=function(){var e=v.height()*editor.zoomFactor,t=J(c).width()*editor.zoomFactor,i=editor.jeditorPane.offset(),o=J(c).offset(),r=_[0];r.style.width=t+"px",r.style.height=e+L+"px",r.style.top=o.top-i.top-L+"px",r.style.left=o.left-i.left+"px",r.style.border="1px solid grey",r.style.backgroundColor="#e9f3f8",J(r).css("opacity","0.5"),r.style.position="absolute",r.style.display="none",r.style["z-index"]="101",r.style["pointer-events"]="none",N.element={},N.element.x=parseInt(r.style.left),N.element.y=parseInt(r.style.top)},Ee=function(){var e=v.width()*editor.zoomFactor,t=J(c).height()*editor.zoomFactor,i=editor.jeditorPane.offset(),o=J(c).offset(),r=P[0];r.style.height=t+"px",r.style.width=e+w+"px",r.style.top=o.top-i.top+"px",r.style.left=o.left-i.left-w+"px",r.style.border="1px solid grey",r.style.backgroundColor="#e9f3f8",J(r).css("opacity","0.5"),r.style.position="absolute",r.style.display="none",r.style["z-index"]="101",r.style["pointer-events"]="none",N.element={},N.element.x=parseInt(r.style.left),N.element.y=parseInt(r.style.top)},Re=function(e,t){Oe(J(e),t)},Se=function(e,t){if(Ge("ui-active"),t){var i=d.parentNode();TableUtil.isVerticalMergedRow(i)||M.length>1||TableUtil.isCollabsInTable(i.parentNode())||!i.previousSibling()&&!i.nextSibling()||J(J(p).children()[1]).addClass("drag-ui-tbl-hd-content")}else TableUtil.isHorizontalyMergedColumn(d)||M.length>1||TableUtil.isCollabsInTable(d.parentNode().parentNode())||!d.previousSibling()&&!d.nextSibling()||J(J(p).children()[1]).addClass("drag-ui-tbl-hd-content")},Oe=function(e,t){if(t){var o=e[0].id.split("cell-row-")[1],r=0,n=i.attr();n.dir&&"rtl"==n.dir&&(r=n.cols.length-1-r);var a=J(J(J(v.children()[1])).children("tr.zw-tr")[o-1]).children("td.zw-td")[r]}else{var o=e[0].id.split("cell-column-")[1];o=parseInt(o-1),u=o;var n=i.attr();n.dir&&"rtl"==n.dir&&(o=n.cols.length-1-o);var a=J(J(J(v.children()[1])).children("tr.zw-tr")[0]).children("td.zw-td")[o]}var l=DocUtil.getDocElement(a);d=l,c=a,p=e[0]},ve=function(t,o){var r=(editor.jeditorPane.offset(),editor.doc.getParents("table",editor.doc.getSelection().getStart()));je();var n=v;if(o){var a=EventHandler.getIndex(t);if(a!=-1){var l=editor.doc.getParents("table",a);if(r&&"table"==r.type&&l.getStart()!=r.getStart()){var s=TableUtil.getCols(r),p=s.length,f=TableUtil.getCols(l),g=f.length;if(p!=g)return!1;if(r=l,editor.clientActiveSection&&editor.clientActiveSection.className.indexOf("zw-contentpane")==-1){var m=DocUtil.getDOMSourceIndex(r.getStart(),UNICODE.TABLE);v=J(DomUtil.getElementAt("table.zw-table",m,editor.clientActiveSection)),n=v}else n=J(DocTreeManager.getNodeAtIndex(l.getStart()))}}}var h=n.offset(),T=t.clientX-h.left,E=t.clientY-h.top;if(o){var R=ViewManager.getView(n),S=(R.getRowsHeight(),R.views?R.views.first:null),O=(t.clientY-N.y,d.parentNode()),b=(O.parentNode().nodeCountBefore(O),0),A=P.offset();E=A.top-h.top,t.clientY>N.y&&(E+=P.height());for(var y=0;S&&(b+=S.getHeight()*editor.zoomFactor,!(b>E))&&null!=S.next;)y++,S=S.next;var D=i.attr(),C=0;d=DocUtil.getDocElement(S.views.first.el),D.dir&&"rtl"==D.dir&&(C=D.cols.length-1-C,d=DocUtil.getDocElement(S.views.last.el)),c=J(n.children("tbody").children("tr.zw-tr")[y]).children("td.zw-td")[C]}else{var r=DocUtil.getDocElement(v[0]),I=TableUtil.getCols(r),f=[],L=editor.doc.getRawFormatAt(e);if(TableUtil.isTableWidthInPercentage(L)){var w=0;if(TableUtil.isInnerTable(i)){var C=i.parentNode().getStart(),M=parseInt(getComputedStyle(DocTreeManager.getNodeAtIndex(C+1)).width);w=parseFloat(L.wid)/100*M}else w=parseFloat(L.wid)/100*J(v).parent("div.zw-column").width();for(var y=0;y<I.length;y++){var U=parseFloat(I[y].wt),x=U/100*w;f[y]={},f[y].wt=x}}else f=I;var F=I.length,s=r.children()[0].children(),k=null,x=0,R=ViewManager.getView(n),B=_.offset();T=B.left-h.left,t.clientX>N.x&&(T+=_.width());var C=0,D=i.attr();if(D.dir&&"rtl"==D.dir){for(var y=F-1;y>=0&&(x+=f[y].wt.convertor().pixels*editor.zoomFactor,k=s[y],!(x>T));y--);var S=R.views?R.views.first:null;if(S){var H=f.length-1;for(k=S.views.last;y==H;)k=k.prev,H--}}else{for(var y=0;y<F&&(x+=f[y].wt.convertor().pixels*editor.zoomFactor,k=s[y],!(x>T));y++);var S=R.views?R.views.first:null;if(S){var H=1;for(k=S.views.first;y==H;)k=k.next,H++}}y==F&&(y-=1),d=DocUtil.getDocElement(k.el),c=J(n.children("tbody").children("tr.zw-tr")[0]).children("td.zw-td")[y],u=y}return!0},be=function(){var e=editor.doc.getSelection();e.selectionType!=SEL_AUTO_GEN&&(Ve(["ui-active","drag-ui-tbl-hd-content"]),M=[],d=null,c=null,u=null,Ae(),U=!1,x=!1,F=!1,m=!1)},Ae=function(){R.hide(),E.hide(),O.hide(),_.hide(),P.hide(),C.hide(),I.hide(),J("#tablePropWrapper").css("opacity",T)},ye=function(t){if(Ce()&&"0"!=T||t)try{if(editor.clientActiveSection&&editor.clientActiveSection.className.indexOf("zw-contentpane")==-1){var i=DocUtil.getDOMSourceIndex(e,UNICODE.TABLE);r=J(DomUtil.getElementAt("table.zw-table",i,editor.clientActiveSection))[0]}else var o=editor.doc.getParents(NODE_TYPE.TABLE,editor.doc.getSelection().getStart()),r=ViewManager.getViewElements(o.dtNode,editor.getPageID())[0];W(),f=!0,t?k(r,!0):k(r),X("1")}catch(e){}},De=function(){return v},Ce=function(){return n},Ie=function(e){e?editor.doc.execCmd("inscolbefore",e):editor.doc.execCmd("inscolbefore"),ye()},Pe=function(){editor.doc.execCmd("inscolafter"),ye()},_e=function(e){e?editor.doc.execCmd("insrowbefore",e):editor.doc.execCmd("insrowbefore"),ye()},Ne=function(){editor.doc.execCmd("insrowafter"),ye()},Le=function(){editor.doc.execCmd("delcolumn"),ye()},we=function(){editor.doc.execCmd("delrow"),ye()},Me=function(e,t,i,o){TableActions.moveColumn(e,o,1,t,i)},Ue=function(e,t){TableActions.moveRow(e,t)},xe=function(){return b||A||U},Fe=function(e){if(A)se(e);else if(b)ue(e);else if(U)if(x){var t=Je(e);ce(e,t)}else{var t=He(e);ae(e,t)}},ke=function(e){var t=!1;return"mouseup"==e.type?xe()?(Be(e),t=!0):EventHandler.isTableDrag&&(PubSub.publish("Document/Table/DragStopped",e),t=!0):"mousemove"==e.type&&(xe()?(Fe(e),t=!0):EventHandler.isTableDrag?(PubSub.publish("Document/Table/DragInProgress",e),t=!0):W(e)),t},Be=function(e){A?le(e):b?pe(e):(U=!1,x=!1,F=!1,A=!1,b=!1,N={},m=!1)},Je=function(e){for(var t=J(s[0]).children("div.ui-tbl-vc-tp-cell"),i=t.length,o=0;o<i;o++){var r=J(t[o]),n=r.offset(),a=r.width();if(e.clientX>n.left&&e.clientX<n.left+a)return r[0]}},He=function(e){for(var t=J(s[1]).children("div.ui-tbl-vc-lt-cell"),i=t.length,o=0;o<i;o++){var r=J(t[o]),n=r.offset(),a=r.height();if(e.clientY>n.top&&e.clientY<n.top+a)return r[0]}},Ge=function(e){for(var t=M.length,i=0;i<t;i++){var o=M[i],r=o.children[1],n=r.getAttribute("class");if("object"==typeof e)for(var a=0;a<e.length;a++)n.indexOf(e[a])==-1&&(r.setAttribute("class",n+" "+e),n=n+" "+e);else n.indexOf(e)==-1&&r.setAttribute("class",n+" "+e)}},ze=function(e){for(var t=0;t<M.length;t++){var i=M[t];if(e==i){M.splice(t,1);break}}},Ve=function(e){for(var t=M.length,i=0;i<t;i++){var o=M[i],r=o.children[1],n=r.getAttribute("class");if("object"==typeof e)for(var a=0;a<e.length;a++)n=n.replace(e[a],"");else n=n.replace(e,"");r.setAttribute("class",n)}},Ye=function(e){var t=J("#"+e)[0].getBoundingClientRect();Ae(),PopupHandler.openPopup("smartToolbar",t)},We=function(e){if(TableVisualCueHandler.isOpen()&&!EventHandler.isOnlyCtrlKeyPressed){if(parseFloat(l[0].style.opacity)<=.3)return void J(l.children()[1]).css("height",v.height()*editor.zooFactor+"px");X("0"),h=!1,setTimeout(function(){X("0")},300)}},je=function(){editor.doc.getParents(NODE_TYPE.TABLE,e);if(v=J(ViewManager.getViewElements(i.dtNode,editor.getPageID())),editor.clientActiveSection&&editor.clientActiveSection.className.indexOf("zw-contentpane")==-1){var t=DocUtil.getDOMSourceIndex(e,UNICODE.TABLE);v=J(DomUtil.getElementAt("table.zw-table",t,editor.clientActiveSection))}};return{init:k,isOpen:Ce,close:W,reinit:ye,getTargetElement:De,insertColumnBefore:Ie,insertColumnAfter:Pe,insertRowBefore:_e,insertRowAfter:Ne,deleteColumn:Le,deleteRow:we,handlePopupsMouseOver:fe,handlePopupsMouseOut:ge,handleMouseEvents:ke,changeElementVisibility:X,isColumOrRowDrag:xe,showSmartToolBar:Ye}}(),TableMoveHandler=function(){var e=!1,t=null,i=null,o=!1,r=function(t){e=!0},n=function(t,i){1==e&&(EventHandler.isTableDrag||(EventHandler.isTableDrag=!0,addDummyTable(i)),t&&moveTableDummyDiv(t))},a=function(t,i){if(i&&e&&!EventHandler.isTableDrag)return s(t,i),!1;if(e&&EventHandler.isTableDrag){if(EventHandler.isTableDrag=!1,e=!1,o=!1,t){try{var r=EventHandler.getIndex(t)}catch(e){return void removeDummyTable()}l(r,TableVisualCueHandler.getTargetElement())}removeDummyTable()}};removeDummyTable=function(){TableVisualCueHandler.close(),i&&J(i).remove()},moveTableDummyDiv=function(e){var t=e.clientY,o=e.clientX;i.style.top=t+"px",i.style.left=o+"px",i.style.display="block"},addDummyTable=function(e){i=document.createElement("div"),i.style.width=e.width()*editor.zoomFactor+"px",i.style.height=e.height()*editor.zoomFactor+"px",i.style.display="none",i.style.position="absolute",i.style.top=e.offset().top+"px",i.style.left=e.offset().left+"px",i.style.border="1px dotted black",i.style["pointer-events"]="none",J(document.body).append(i)},setTableSelected=function(e){o=e};var l=function(e,i){t=i,o=!1;var r=DocTreeManager.getNode(i[0]),n=r.getIndex(),a=r.getEndIndex();if(!(!e||e<0||e>n&&e<a||e<=editor.doc.getSectionStart(n)||e>=editor.doc.getSectionEnd(n))){var l=(editor.doc.getRawFormatAt(n),editor.doc.getSelection()),s=editor.doc.createRange(n,a+1).getSelectedOps();range=editor.doc.createRange(n,a),l.removeAllRanges().addRange(range),l.deleteContents(n,a+1);var d=editor.doc.getParents(NODE_TYPE.PARAGRAPH,e),c=e;d&&(c=d.getEnd()-1);var p=editor.doc.getRawFormatAt(c);p.hasOwnProperty(TCConstants.TC)&&delete p[TCConstants.TC],p[ATTR_PARAGRAPH.PS_TS]&&(p[ATTR_PARAGRAPH.PS_TS]=editor.doc.getSelection().textFormat,p[ATTR_PARAGRAPH.PS_TS].hasOwnProperty(TCConstants.TC)&&(p[ATTR_PARAGRAPH.PS_TS]=DocUtil.copyStyle(p[ATTR_PARAGRAPH.PS_TS]),delete p[ATTR_PARAGRAPH.PS_TS][TCConstants.TC]));var u=DocUtil.getKeys(p),f=DocUtil.copyStyle(p),g=Utils.randomString(),m=[];if(m.push({r:e},{as:{start:f,id:g}},{is:UNICODE.PARA},{as:{end:u,id:g}}),s=s.slice(1,s.length),m=m.concat(s),Op.resetCursorPos(),e<n)Op.fillCursorPos(e+4,e+4);else{var h=e-(a-n)+4;Op.fillCursorPos(h,h)}Op.processMsg(m),Op.sendMsg()}},s=function(e,t){o?(o=!1,c(e,t)):(o=!0,d(e,t))},d=function(t,i){e=!1,editor.doc.getSelection().setSelectionType(SEL_AUTO_GEN),editor.doc.execCmd("selectAllCells")},c=function(t,i){var o=editor.doc.getSelection();e=!1;var r=i?i.firstChild().firstChild().getIndex()+1:1,n=editor.doc.createRange(r,r);o.removeAllRanges().addRange(n)},p=function(){PubSub.subscribe("Document/Table/DragStopped",a),PubSub.subscribe("Document/Table/DragInProgress",n),PubSub.subscribe("Document/Table/MouseDown",r)};return{onMouseMove:n,onMouseDown:r,onMouseUp:a,bindEvents:p,moveTableToTheGivenIndex:l,setTableSelected:setTableSelected}}();!function(){var e=!1,t=function(t){if(!e){var o=t||{},r={},n={};r.type=o.docType,r.copy="published"===o.docType?o.copy:"true",r.onboard=o.onboard||"true",r.fromurl=encodeURIComponent(i()),"tryeditor"===o.docType?(r.rsid=o.rsid,n.titleTxt=o.titleText,n.descriptionTxt=o.descriptionText):r.rid=o.rid,n.action=o.action||"signup",n.refurl=JSON.stringify(r),e=!0;var a=Utils.getContextUrl("jsp/writersignup.jsp");J.ajax({type:"GET",url:a,data:n,success:function(t,i,o){var r=document.createElement("div");r.innerHTML=t.trim(),J("body").append(J(r)),UIUtils.preProcessForDialogOpen(),e=!0},error:function(){e=!1}})}},i=function(){var e=window.location.pathname+window.location.search;return e},o=function(){UIUtils.preProcessForDialogClose(),J("#writer-signup-container").remove(),e=!1};window.zwritersignup={openSignupDialog:t,closeSignupDialog:o}}();var Pagenumberdlg=function(){return this.pageNumberFormat={},this.alignMap={left:0,center:1,right:2,none:3},{pageNumberFormat:pageNumberFormat,alignMap:alignMap}}();Pagenumberdlg.dialogInfo={init:function(){var e=editor.doc.getBodyFormat();e[ATTR_BODY.DS_PAGENUMBER]=e[ATTR_BODY.DS_PAGENUMBER]?e[ATTR_BODY.DS_PAGENUMBER]:{},pageNumberFormat.format=e[ATTR_BODY.DS_PAGENUMBER][ATTR_BODY.DS_PAGENUMBER_FORMAT]||0,pageNumberFormat.startsAt=e[ATTR_BODY.DS_PAGENUMBER][ATTR_BODY.DS_PAGENUMBER_STARTS_AT]||1,pageNumberFormat.firstpage=e[ATTR_BODY.DS_HF_TYPE]||0;var t=Pagenumberdlg.getHdrFtrPageNumberIndex("header");Pagenumberdlg.setStyle("header",t);var t=Pagenumberdlg.getHdrFtrPageNumberIndex("footer");Pagenumberdlg.setStyle("footer",t)},get:function(e,t){e=e.action;var i=editor.doc.getBodyFormat(),o=Z("pageno_start");if("headerStyle"==e){var r;return r=pageNumberFormat&&pageNumberFormat.headerStyle?pageNumberFormat.headerStyle:"none"}if("footerStyle"==e){var n;return n=pageNumberFormat&&pageNumberFormat.footerStyle?pageNumberFormat.footerStyle:"none"}if("format"==e){var a=0;return pageNumberFormat&&"undefined"!=typeof pageNumberFormat.format&&!isNaN(pageNumberFormat.format)&&(a=pageNumberFormat.format),0!=a||1!=pageNumberFormat.firstpage&&3!=pageNumberFormat.firstpage?o.zspinner("setMinValue",1):o.zspinner("setMinValue",0),a}if("startsat"==e){var l=1;return pageNumberFormat&&pageNumberFormat.startsAt&&(l=pageNumberFormat.startsAt),l}if("firstpage"==e)return hdrFtrType=i[ATTR_BODY.DS_HF_TYPE]||0,hdrFtrType!=HEADER_FOOTER_TYPE.DIFF_FIRST_PAGE&&hdrFtrType!=HEADER_FOOTER_TYPE.DIFF_FIRST_ODD_EVEN_PAGE},set:function(e,t,i){var o=Z("pageno_start");if("headerStyle"==e.action)pageNumberFormat.position="header",pageNumberFormat.headerStyle="none",Utils.arrayContains(["left","center","right"],t)&&(pageNumberFormat.headerStyle=t);else if("footerStyle"==e.action)pageNumberFormat.position="footer",pageNumberFormat.footerStyle="none",Utils.arrayContains(["left","center","right"],t)&&(pageNumberFormat.footerStyle=t);else if("format"==e.action)if(pageNumberFormat.format=0,t>-1&&t<5&&(pageNumberFormat.format=t),0!=pageNumberFormat.format||1!=pageNumberFormat.firstpage&&3!=pageNumberFormat.firstpage){o.zspinner("setMinValue",1);var r=o.zspinner("getValue");r<1&&(o.zspinner("setValue",1),pageNumberFormat.startsAt=1)}else o.zspinner("setMinValue",0);else if("startsat"==e.action)t>-1?(0!=t||0==pageNumberFormat.format&&(0!=pageNumberFormat.format||0!=pageNumberFormat.firstpage&&2!=pageNumberFormat.firstpage)||(t=1,o.zspinner("setValue",t)),pageNumberFormat.startsAt=t):(pageNumberFormat.startsAt=1,o.zspinner("setValue",1));else if("firstpage"==e.action){var n=editor.doc.getBodyFormat(),a=n[ATTR_BODY.DS_HF_TYPE]||0;t?a==HEADER_FOOTER_TYPE.DIFF_FIRST_PAGE?pageNumberFormat.firstpage=HEADER_FOOTER_TYPE.PRIMARY:pageNumberFormat.firstpage=HEADER_FOOTER_TYPE.DIFF_ODD_EVEN_PAGE:a==HEADER_FOOTER_TYPE.PRIMARY?pageNumberFormat.firstpage=HEADER_FOOTER_TYPE.DIFF_FIRST_PAGE:pageNumberFormat.firstpage=HEADER_FOOTER_TYPE.DIFF_FIRST_ODD_EVEN_PAGE,0==pageNumberFormat.format&&(0==pageNumberFormat.firstpage||2==pageNumberFormat.firstpage?(o.zspinner("setMinValue",1),pageNumberFormat.startsAt<1&&(pageNumberFormat.startsAt=1,o.zspinner("setValue",1))):o.zspinner("setMinValue",0))}Pagenumberdlg.applyValues()}},Pagenumberdlg.applyValues=function(){var e,t,i,o=editor.doc.getBodyFormat(),r=editor.doc.getSelection().parents(NODE_TYPE.BODY),n=o[ATTR_BODY.DS_HF_TYPE]||0,a={};if(a[ATTR_BODY.DS_PAGENUMBER]={},e=pageNumberFormat.headerStyle,t=pageNumberFormat.footerStyle,i=pageNumberFormat.position,a[ATTR_BODY.DS_PAGENUMBER][ATTR_BODY.DS_PAGENUMBER_FORMAT]=parseInt(pageNumberFormat.format),a[ATTR_BODY.DS_PAGENUMBER][ATTR_BODY.DS_PAGENUMBER_STARTS_AT]=pageNumberFormat.startsAt,U.each(a,function(e,t){"object"==typeof e?Utils.compareJSON(e,o[t])&&delete a[t]:e&&e!==o[t]||delete a[t]}),U.isEmpty(a)||editor.doc.execCmd("applyStyle",[r,a]),n!=pageNumberFormat.firstpage)editor.doc.execCmd("changeHdrFtr",pageNumberFormat.firstpage);else{var l,s="header"==i?alignMap[e]:alignMap[t];n==HEADER_FOOTER_TYPE.PRIMARY||n==HEADER_FOOTER_TYPE.DIFF_FIRST_PAGE?l=[i]:n!=HEADER_FOOTER_TYPE.DIFF_ODD_EVEN_PAGE&&n!=HEADER_FOOTER_TYPE.DIFF_FIRST_ODD_EVEN_PAGE||(l=[i+"_odd",i+"_even"]),l.forEach(function(e){Pagenumberdlg.sendOpForSection(e,s)})}},Pagenumberdlg.sendOpForSection=function(e,t){var i,o,r=Pagenumberdlg.findPagenoFieldInSection(e);if(r==-1){if(3==t)return;if(r=Pagenumberdlg.findSectionEndIndex(e),r!=-1){i="autofield";var n=Pagenumberdlg.getParaAlignAtIndex(r),a=editor.doc.getParents(NODE_TYPE.PARAGRAPH,r);o=t!=n?["autopno",r,a,{al:t}]:["autopno",r]}}else if(3==t)i="removeAutoField",o=[r-1];else{var n=Pagenumberdlg.getParaAlignAtIndex(r),a=editor.doc.getParents(NODE_TYPE.PARAGRAPH,r);t!=n&&(i="formatAutoField",o=[a,{al:t}])}i&&o&&editor.doc.execCmd(i,o)},Pagenumberdlg.openPagenumberDlg=function(e){if(e){var t=e[0],i=e[1];t&&(pageNumberFormat.position=t,"header"==t?pageNumberFormat.headerStyle=i||"none":"footer"==t&&(pageNumberFormat.footerStyle=i||"none")),Pagenumberdlg.applyValues()}FetchHTML.get({requestName:"pagenumber",target:"#subpanel-pagenumber",callback:function(){var e=Z("subpanel-pagenumber");e.data("ztrackObject")?e.ZCtrackObjects("refreshValues"):e.ZCtrackObjects({callbacks:Pagenumberdlg.dialogInfo,fillVisible:!1,eventNameMapping:{zspinner:"spinnerblur"}});var t={panelId:ELEM_ID.PAGENUMBERPANEL,animationType:ANIMATIONS.FLIPIN,parentPanels:[ELEM_ID.INSERTPANEL]};LeftPanel.showAdvancedPanel(t)}}),e&&Pagenumberdlg.applyValues()},Pagenumberdlg.findSection=function(e){for(var t=DocTreeManager.doc.sections,i=0,o=t.length;i<o;i++)if(t[i].name===e)return t[i];return null},Pagenumberdlg.findPagenoFieldInSection=function(e){var t=Pagenumberdlg.findSection(e);return t?Pagenumberdlg.findPagenoFieldInBetweenIndex(t.start+1,t.end-1):-1},Pagenumberdlg.findSectionEndIndex=function(e){var t=Pagenumberdlg.findSection(e);return t?t.end-1:-1},Pagenumberdlg.findPagenoFieldInBetweenIndex=function(e,t){for(var i,o=e;o<t;o++)if(i=editor.doc.getRawFormatAt(o),i&&"autopno"==i.cls)return o;return-1},Pagenumberdlg.getHdrFtrSectionNameFromPageNumber=function(e){var t=editor.doc.getBodyFormat(),i=t[ATTR_BODY.DS_HF_TYPE]||0;if(i==HEADER_FOOTER_TYPE.PRIMARY)return{headerName:"header",footerName:"footer"};if(i==HEADER_FOOTER_TYPE.DIFF_FIRST_PAGE)return 1==e?{headerName:"header_first",footerName:"footer_first"}:{headerName:"header",footerName:"footer"};if(i==HEADER_FOOTER_TYPE.DIFF_ODD_EVEN_PAGE){if(1==e)return{headerName:"header_odd",footerName:"footer_odd"};var o=e%2;return 0==o?{headerName:"header_even",footerName:"footer_even"}:{headerName:"header_odd",footerName:"footer_odd"}}if(i==HEADER_FOOTER_TYPE.DIFF_FIRST_ODD_EVEN_PAGE){if(1==e)return{headerName:"header_first",footerName:"footer_first"};var o=e%2;return 0==o?{headerName:"header_even",footerName:"footer_even"}:{headerName:"header_odd",footerName:"footer_odd"}}},Pagenumberdlg.getHdrFtrPageNumberIndex=function(e){pageNumberFormat.pageNumber=(editor.currentPageIndex||0)+1;var t=Pagenumberdlg.getHdrFtrSectionNameFromPageNumber(pageNumberFormat.pageNumber);return"header"==e?Pagenumberdlg.findPagenoFieldInSection(t.headerName):"footer"==e?Pagenumberdlg.findPagenoFieldInSection(t.footerName):void 0},Pagenumberdlg.setStyle=function(e,t){if(t==-1)"header"==e?pageNumberFormat.headerStyle="none":pageNumberFormat.footerStyle="none";else{var i=DocTreeManager.lineAtIndex(t);if(i){var o=i.parent;align=o&&o.paraProperties&&o.paraProperties.align||0}"header"==e?0==align?pageNumberFormat.headerStyle="left":1==align?pageNumberFormat.headerStyle="center":pageNumberFormat.headerStyle="right":0==align?pageNumberFormat.footerStyle="left":1==align?pageNumberFormat.footerStyle="center":pageNumberFormat.footerStyle="right"}},Pagenumberdlg.initSubMenu=function(){Pagenumberdlg.dialogInfo.init(),pageNumberFormat.headerStyle?Z("pagenumbers-submenu").zmenu("check",Z("pagenumbers-submenu-header-"+pageNumberFormat.headerStyle)):Z("pagenumbers-submenu").zmenu("check",Z("pagenumbers-submenu-header-none")),pageNumberFormat.footerStyle?Z("pagenumbers-submenu").zmenu("check",Z("pagenumbers-submenu-footer-"+pageNumberFormat.footerStyle)):Z("pagenumbers-submenu").zmenu("check",Z("pagenumbers-submenu-footer-none"))},Pagenumberdlg.removePageNumbers=function(e){var t;t=e?e:["header","footer"];var i=editor.doc.getBodyFormat(),o=i[ATTR_BODY.DS_HF_TYPE]||0,r=3;t.forEach(function(e){o==HEADER_FOOTER_TYPE.PRIMARY||o==HEADER_FOOTER_TYPE.DIFF_FIRST_PAGE?Pagenumberdlg.sendOpForSection(e,r):o!=HEADER_FOOTER_TYPE.DIFF_ODD_EVEN_PAGE&&o!=HEADER_FOOTER_TYPE.DIFF_FIRST_ODD_EVEN_PAGE||(Pagenumberdlg.sendOpForSection(e+"_odd",r),Pagenumberdlg.sendOpForSection(e+"_even",r))}),pageNumberFormat.headerStyle="none",pageNumberFormat.footerStyle="none"},Pagenumberdlg.getParaAlignAtIndex=function(e){var t=DocTreeManager.lineAtIndex(e),i=editor.doc.getRawFormatAt(t.parent.getEndIndex());return i&&i[ATTR_PARAGRAPH.PS_AL]?i[ATTR_PARAGRAPH.PS_AL]:0};var ParaBorders=function(e){"use strict";var t={},i=!1,o=([ATTR_BORDERS.BORDER_TOP,ATTR_BORDERS.BORDER_LEFT,ATTR_BORDERS.BORDER_RIGHT,ATTR_BORDERS.BORDER_BOTTOM],ATTR_BORDERS.WIDTH),r=ATTR_BORDERS.COLOR,n=ATTR_BORDERS.TYPE,a={type:"solid",color:"zwdark1",width:"1px",space:"0px"},l={BDR_ALL:"para-bdr-all",BDR_TOP:"para-bdr-top",BDR_LEFT:"para-bdr-left",BDR_RIGHT:"para-bdr-right",BDR_BOTTOM:"para-bdr-bottom",BDR_WIDTH:"para-bdr-width",BDR_STYLE:"para-bdr-style",BDR_COLOR:"para-bdr-color",BG_COLOR:"para-panel-para-bgcolor"},s=({bdrWidthCombo:J("#combo_para-bdr-widthMenu .ui-borderstylebg"),bdrStyleCombo:J("#combo_para-bdr-styleMenu .ui-borderstylebg")},{PARA_BORDER_ALL:{get:function(e,o){return!(!t.sides||t.sides.indexOf(ATTR_BORDERS.BORDER_TOP)==-1||t.sides.indexOf(ATTR_BORDERS.BORDER_LEFT)==-1||t.sides.indexOf(ATTR_BORDERS.BORDER_BOTTOM)==-1||t.sides.indexOf(ATTR_BORDERS.BORDER_RIGHT)==-1)&&(i=!0,!0)},set:function(e,t,i){Z(l.BDR_ALL).zstatebutton("checked",t),Z(l.BDR_TOP).zstatebutton("checked",t),Z(l.BDR_RIGHT).zstatebutton("checked",t),Z(l.BDR_BOTTOM).zstatebutton("checked",t),Z(l.BDR_LEFT).zstatebutton("checked",t),g(e,i)}},PARA_BORDER_TOP:{get:function(e,i){return!(!t.sides||t.sides.indexOf(ATTR_BORDERS.BORDER_TOP)==-1)},set:function(e,t,i){g(e,i)}},PARA_BORDER_RIGHT:{get:function(e,i){return!(!t.sides||t.sides.indexOf(ATTR_BORDERS.BORDER_RIGHT)==-1)},set:function(e,t,i){g(e,i)}},PARA_BORDER_BOTTOM:{get:function(e,i){return!(!t.sides||t.sides.indexOf(ATTR_BORDERS.BORDER_BOTTOM)==-1)},set:function(e,t,i){g(e,i)}},PARA_BORDER_LEFT:{get:function(e,i){return!(!t.sides||t.sides.indexOf(ATTR_BORDERS.BORDER_LEFT)==-1)},set:function(e,t,i){g(e,i)}},PARA_BORDER_COLOR:{get:function(e,i){return 0==t.sides.length?Z(l.BDR_COLOR).disable():0!=t[ATTR_BORDERS.COLOR]?(T(t[ATTR_BORDERS.COLOR],!0),Z(l.BDR_COLOR).enable()):T("rgb(0, 0, 0)",!0),t[ATTR_BORDERS.COLOR]},set:function(e,t,i){T(Utils.rgbToHex(t),!0);var o={};return o[ATTR_COMMON.BORDERS]=c(r,Utils.getColorReference(arguments[4])),o}},PARA_BORDER_WIDTH:{get:function(e,i){return 0==t.sides.length?Z(l.BDR_WIDTH).disable():null!==t[ATTR_BORDERS.WIDTH]&&Z(l.BDR_WIDTH).enable(),t[ATTR_BORDERS.WIDTH]},set:function(e,t,i){var r={};return r[ATTR_COMMON.BORDERS]=c(o,parseFloat(t)+UNITS.PIXELS),r}},PARA_BORDER_TYPE:{get:function(e,i){return 0==t.sides.length?Z(l.BDR_STYLE).disable():null!==t[ATTR_BORDERS.TYPE]&&Z(l.BDR_STYLE).enable(),t[ATTR_BORDERS.TYPE]},set:function(e,t,i){var o={};return o[ATTR_COMMON.BORDERS]=c(n,t),o}},PARA_BG_COLOR:{get:function(e,i){var o=Utils.getColorValFromRefString(t.bgc),r=Utils.rgbToHex(o);return"transparent"==o?Z(l.BG_COLOR).text(""):Z(l.BG_COLOR).text(Utils.rgbToHex(r)),o},set:function(e,t,i){var o={};return o.bgc=Utils.getColorReference(arguments[4]),"transparent"==t?Z(l.BG_COLOR).text(""):Z(l.BG_COLOR).text(Utils.rgbToHex(t)),o}}}),d={beforeFillValues:function(){t={borders:null,bgc:null,width:null,type:null,color:null,sides:[]},t=u(t)},get:function(e,t){var i=s[e.action].get;if(i)return i(e,t)},set:function(e,i,o){arguments[5]&&arguments[5].keyCode==KEYS.TAB?EventHandler.isDialogFocused=!0:EventHandler.isDialogFocused=!1;var r=s[e.action].set,n=r&&r.apply(null,arguments);if(null!=n){for(var a in n)t[a]=n[a];f(n)}}},c=function(e,t,i){var o=editor.doc.getParents(NODE_TYPE.PARAGRAPH,editor.doc.getSelection().getStart()),r=o.attr()[ATTR_COMMON.BORDERS]||{};i=i?i:BorderUtils.getSelectedSides("para");for(var n=!1,s=0,d=i.length;s<d;s++){var c=i[s];if(r&&r[c])r[c][e]=t;else{var p=DocUtil.copyStyle(a);p[e]=t,r[c]=p,n=!0}e==ATTR_BORDERS.TYPE&&"double"==t&&parseInt(r[c][ATTR_BORDERS.WIDTH])<3&&(r[c][ATTR_BORDERS.WIDTH]="3px")}if(n&&LeftPanel.isPanelVisible("subpanel-para")){var u=m(r);Z(l.BDR_WIDTH).zcombo("setValue",u[ATTR_BORDERS.WIDTH]),Z(l.BDR_STYLE).zcombo("setValue",u[ATTR_BORDERS.TYPE]),Z(l.BDR_COLOR).zcolorfield("setColor",Utils.getColorValFromRefString(u.color))}return r},p={bgc:function(e,t,i){return e[ATTR_PARAGRAPH.PS_BGC]||"rgb(255,255,255)"},width:function(e,t,i){return i[ATTR_BORDERS.WIDTH]},type:function(e,t,i){return i[ATTR_BORDERS.TYPE]},color:function(e,t,i){return i[ATTR_BORDERS.COLOR]},sides:function(e,t,i){return i.sides}},u=function(e){var t=editor.doc.getSelection().parents(NODE_TYPE.PARAGRAPH),i=t.attr(),o=i[ATTR_COMMON.BORDERS]?i[ATTR_COMMON.BORDERS]:{};BorderUtils.convertZWColorToRGB(o),e[ATTR_COMMON.BORDERS]=o;var r={};for(var n in e[ATTR_COMMON.BORDERS])"0px"!=e[ATTR_COMMON.BORDERS][n][ATTR_BORDERS.WIDTH]&&(r[n]=e[ATTR_COMMON.BORDERS][n]);var a=BorderUtils.getBorderValuesForUpdateUI(r);for(n in e)n!=ATTR_COMMON.BORDERS&&(e[n]=p[n](i,t,a));return e},f=function(e){var t={bgc:ATTR_PARAGRAPH.PS_BGC,borders:ATTR_COMMON.BORDERS},i=editor.doc.getSelection().getNodesInSelection(NODE_TYPE.PARAGRAPH);for(var o in e)if(null!=e[o]){var r={};r[t[o]]=e[o],jQuery.isEmptyObject(r)||editor.doc.execCmd("applyStyle",[i,r,"applyParaStyle"])}},g=function(e,o){if(i&&(Z(l.BDR_ALL).zstatebutton("checked",!1),Z(l.BDR_TOP).zstatebutton("checked",!1),Z(l.BDR_LEFT).zstatebutton("checked",!1),Z(l.BDR_RIGHT).zstatebutton("checked",!1),Z(l.BDR_BOTTOM).zstatebutton("checked",!1),o.zstatebutton("checked",!0)),"PARA_BORDER_ALL"==e.action?(Z(l.BDR_ALL).zstatebutton("checked",!0),Z(l.BDR_TOP).zstatebutton("checked",!0),Z(l.BDR_LEFT).zstatebutton("checked",!0),Z(l.BDR_RIGHT).zstatebutton("checked",!0),Z(l.BDR_BOTTOM).zstatebutton("checked",!0),i=!0):i=!1,Z(l.BDR_TOP).prop("checked")&&Z(l.BDR_RIGHT).prop("checked")&&Z(l.BDR_BOTTOM).prop("checked")&&Z(l.BDR_LEFT).prop("checked")?Z(l.BDR_ALL).zstatebutton("checked",!0):Z(l.BDR_ALL).zstatebutton("checked",!1),Z(l.BDR_TOP).prop("checked")||Z(l.BDR_RIGHT).prop("checked")||Z(l.BDR_BOTTOM).prop("checked")||Z(l.BDR_LEFT).prop("checked")){Z(l.BDR_WIDTH).enable(),Z(l.BDR_COLOR).enable(),Z(l.BDR_STYLE).enable();var r=[];Z(l.BDR_TOP).prop("checked")&&r.push(ATTR_BORDERS.BORDER_TOP),Z(l.BDR_RIGHT).prop("checked")&&r.push(ATTR_BORDERS.BORDER_RIGHT),Z(l.BDR_BOTTOM).prop("checked")&&r.push(ATTR_BORDERS.BORDER_BOTTOM),Z(l.BDR_LEFT).prop("checked")&&r.push(ATTR_BORDERS.BORDER_LEFT);var n={};if(t[ATTR_COMMON.BORDERS])for(var a=0;a<r.length;a++)n[r[a]]=t[ATTR_COMMON.BORDERS][r[a]]?t[ATTR_COMMON.BORDERS][r[a]]:{};var s=m(n);Z(l.BDR_WIDTH).zcombo("setValue",s[ATTR_BORDERS.WIDTH]),Z(l.BDR_STYLE).zcombo("setValue",s[ATTR_BORDERS.TYPE]),Z(l.BDR_COLOR).zcolorfield("setColor",Utils.getColorValFromRefString(s[ATTR_BORDERS.COLOR])),0!=s[ATTR_BORDERS.COLOR]?T(s[ATTR_BORDERS.COLOR],!0):T("rgb(0, 0, 0)",!0)}else Z(l.BDR_WIDTH).disable(),Z(l.BDR_COLOR).disable(),Z(l.BDR_STYLE).disable()},m=function(e){var t={},i=[];for(var o in e){i.push(o);var r=e[o];"undefined"!=typeof r[ATTR_BORDERS.TYPE]&&("undefined"!=typeof t[ATTR_BORDERS.TYPE]&&t[ATTR_BORDERS.TYPE]!==r[ATTR_BORDERS.TYPE]?t[ATTR_BORDERS.TYPE]=null:t[ATTR_BORDERS.TYPE]=r[ATTR_BORDERS.TYPE]),"undefined"!=typeof r[ATTR_BORDERS.WIDTH]&&("undefined"!=typeof t[ATTR_BORDERS.WIDTH]&&t[ATTR_BORDERS.WIDTH]!==r[ATTR_BORDERS.WIDTH]?t[ATTR_BORDERS.WIDTH]=null:t[ATTR_BORDERS.WIDTH]=r[ATTR_BORDERS.WIDTH]),"undefined"!=typeof r[ATTR_BORDERS.COLOR]&&("undefined"!=typeof t[ATTR_BORDERS.COLOR]&&t[ATTR_BORDERS.COLOR]!==r[ATTR_BORDERS.COLOR]?t[ATTR_BORDERS.COLOR]=null:t[ATTR_BORDERS.COLOR]=r[ATTR_BORDERS.COLOR])}return t[ATTR_BORDERS.WIDTH]=t[ATTR_BORDERS.WIDTH]||null,t[ATTR_BORDERS.COLOR]=t[ATTR_BORDERS.COLOR]||null,t[ATTR_BORDERS.TYPE]=t[ATTR_BORDERS.TYPE]||null,t.sides=i,t},h=function(){Z(l.BDR_ALL).zstatebutton("checked",!1),Z(l.BDR_WIDTH).disable(),Z(l.BDR_STYLE).disable(),Z(l.BDR_COLOR).disable();var e=["top","left","right","bottom"];BorderUtils.getSelectedSides("para");var i={};i[ATTR_COMMON.BORDERS]=c(o,"0px"),t[ATTR_COMMON.BORDERS]=i[ATTR_COMMON.BORDERS],f(i);for(var r=0;r<=e.length;r++)Z("para-bdr-"+e[r]).prop("checked")&&Z("para-bdr-"+e[r]).zstatebutton("checked",!1)},T=function(e,t){var i=Z("combo_para-bdr-widthMenu").find(".ui-borderstylebg");if(i=i.add(Z("combo_para-bdr-styleMenu").find(".ui-borderstylebg")),i=i.add(Z(l.BDR_STYLE).next().find(".ui-borderstylebg")),i.css({"border-top-color":e}),t);},E=function(e){var t={};e||(e="rgb(255,0,0)"),t[ATTR_COMMON.BORDERS]=c(r,e,[ATTR_BORDERS.BORDER_TOP,ATTR_BORDERS.BORDER_RIGHT,ATTR_BORDERS.BORDER_BOTTOM,ATTR_BORDERS.BORDER_LEFT]),f(t),J("#pcm-bordercolor").children("span:first").css({border:"1px solid "+e})};return{panelInfo:d,clearBorders:h,updateColor:E}}(ELEM_ID),CellBorders=function(){"use strict";var e={},t=!1,o=ATTR_BORDERS.WIDTH,r=ATTR_BORDERS.COLOR,n=ATTR_BORDERS.TYPE,a={type:"solid",color:"zwdark1",width:"1px",space:"0px"},l={BDR_ALL:"td-bdr-all",BDR_TOP:"td-bdr-top",BDR_LEFT:"td-bdr-left",BDR_RIGHT:"td-bdr-right",BDR_BOTTOM:"td-bdr-bottom",BDR_WIDTH:"td-bdr-width",BDR_STYLE:"td-bdr-style",BDR_COLOR:"td-bdr-color",BG_COLOR:"td-bg-color",BG_IMG_FILE:"td-localimg-file",BG_IMG_SELECTED:"td-bgimg-selected",BG_IMG:"tdBgImg"},s=({bdrWidthCombo:J("#combo_td-bdr-widthMenu .ui-borderstylebg"),bdrStyleCombo:J("#combo_td-bdr-styleMenu .ui-borderstylebg")},{CELL_BORDER_ALL:{get:function(i,o){return!(!e.sides||e.sides.indexOf(ATTR_BORDERS.BORDER_TOP)==-1||e.sides.indexOf(ATTR_BORDERS.BORDER_LEFT)==-1||e.sides.indexOf(ATTR_BORDERS.BORDER_BOTTOM)==-1||e.sides.indexOf(ATTR_BORDERS.BORDER_RIGHT)==-1)&&(t=!0,!0)},set:function(e,t,i){Z(l.BDR_ALL).zstatebutton("checked",t),Z(l.BDR_TOP).zstatebutton("checked",t),Z(l.BDR_RIGHT).zstatebutton("checked",t),Z(l.BDR_BOTTOM).zstatebutton("checked",t),Z(l.BDR_LEFT).zstatebutton("checked",t),g(e,i)}},CELL_BORDER_TOP:{get:function(t,i){return!(!e.sides||e.sides.indexOf(ATTR_BORDERS.BORDER_TOP)==-1)},set:function(e,t,i){g(e,i)}},CELL_BORDER_RIGHT:{get:function(t,i){return!(!e.sides||e.sides.indexOf(ATTR_BORDERS.BORDER_RIGHT)==-1)},set:function(e,t,i){g(e,i)}},CELL_BORDER_BOTTOM:{get:function(t,i){return!(!e.sides||e.sides.indexOf(ATTR_BORDERS.BORDER_BOTTOM)==-1)},set:function(e,t,i){g(e,i)}},CELL_BORDER_LEFT:{get:function(t,i){return!(!e.sides||e.sides.indexOf(ATTR_BORDERS.BORDER_LEFT)==-1)},set:function(e,t,i){g(e,i)}},CELL_BORDER_COLOR:{get:function(t,i){return 0==e.sides.length?Z(l.BDR_COLOR).disable():0!=e[ATTR_BORDERS.COLOR]?(T(e[ATTR_BORDERS.COLOR],!0),Z(l.BDR_COLOR).enable()):T("rgb(0, 0, 0)",!0),e[ATTR_BORDERS.COLOR]},set:function(e,t,i){T(Utils.rgbToHex(t),!0);var o={};return o.borders=c(r,Utils.getColorReference(arguments[4])),o}},CELL_BORDER_WIDTH:{get:function(t,i){return 0==e.sides.length?Z(l.BDR_WIDTH).disable():null!==e[ATTR_BORDERS.WIDTH]&&Z(l.BDR_WIDTH).enable(),e[ATTR_BORDERS.WIDTH]},set:function(e,t,i){var r={};return r[ATTR_COMMON.BORDERS]=c(o,parseFloat(t)+UNITS.PIXELS),r}},CELL_BORDER_TYPE:{get:function(t,i){return 0==e.sides.length?Z(l.BDR_STYLE).disable():null!==e[ATTR_BORDERS.TYPE]&&Z(l.BDR_STYLE).enable(),e[ATTR_BORDERS.TYPE]},set:function(e,t,i){var o={};return o[ATTR_COMMON.BORDERS]=c(n,t),o}},CELL_BG_COLOR:{get:function(t,i){var o=Utils.getColorValFromRefString(e.bgc),r=Utils.rgbToHex(o);return"transparent"==o?Z(l.BG_COLOR).text(""):Z(l.BG_COLOR).text(Utils.rgbToHex(r)),o},set:function(e,t,i){var o={};return o.bgc=Utils.getColorReference(arguments[4]),"transparent"==t?Z(l.BG_COLOR).text(""):Z(l.BG_COLOR).text(Utils.rgbToHex(t)),o}},CELL_BG_IMG:{get:function(t,i){e.bgimg?h():m()},set:function(e,t,i){var o={};J("#errormsg1").hide();var r=Z(l.BG_IMG_FILE).val();return Utils.isValidImage(r)?BorderUtils.applyBGImgtoCell(o)?(Z(l.BG_IMG_SELECTED).show(),Z(l.BG_IMG).hide(),o):(J("#errormsg1").show().html(UIUtils.getErrorMsg("error",J.i18n("image","IMAGE_SIZE_EXCEED"))),void Z(l.BG_IMG_FILE).val("")):(J("#errormsg1").show().html(UIUtils.getErrorMsg("error",J.i18n("image","INVALID_IMG_EXT"))),null)}},CELL_BG_IMG_NONE:{get:function(t,i){e.bgimg?h():m()},set:function(e,t,i){var o={};return o.bgimg="",m(),o}}}),d={beforeFillValues:function(){e={borders:null,bgc:null,bgimg:null,width:null,type:null,color:null,sides:[],modifiedStyles:null},e=u(e)},get:function(e,t){var i=s[e.action].get;if(i)return i(e,t)},set:function(t,i,o){arguments[5]&&arguments[5].keyCode==KEYS.TAB?EventHandler.isDialogFocused=!0:EventHandler.isDialogFocused=!1;var r=s[t.action].set,n=r&&r.apply(null,arguments);if(null!=n)for(var a in n)e[a]=n[a];f(n)}},c=function(t,i){for(var o=(editor.doc.getParents(NODE_TYPE.CELL,editor.doc.getSelection().getStart()),DocUtil.copyStyle(e[ATTR_COMMON.BORDERS])),r=BorderUtils.getSelectedSides("td"),n=0,l=r.length;n<l;n++){var s=r[n];if(o&&o[s])o[s][t]=i,o[s][ATTR_BORDERS.SPACE]||(o[s][ATTR_BORDERS.SPACE]=0);else{var d=DocUtil.copyStyle(a);d[t]=i,o[s]=d}t==ATTR_BORDERS.TYPE&&"double"==i&&parseInt(o[s][ATTR_BORDERS.WIDTH])<3&&(o[s][ATTR_BORDERS.WIDTH]="3px")}return o},p={bgc:function(e,t,i){var o=e.z_td_bgc?e.z_td_bgc:v(t);return Utils.getColorValFromRefString(o)},bgimg:function(e){return e[ATTR_CELL.TDS_BGIMG]||null},width:function(e,t,i){return i[ATTR_BORDERS.WIDTH]},type:function(e,t,i){return i[ATTR_BORDERS.TYPE]},color:function(e,t,i){return i[ATTR_BORDERS.COLOR]},sides:function(e,t,i){return i.sides}},u=function(e){for(var t=editor.doc.getSelection().parents(NODE_TYPE.CELL),i=t.attr(),o=i[ATTR_COMMON.BORDERS],r=[ATTR_BORDERS.BORDER_TOP,ATTR_BORDERS.BORDER_BOTTOM,ATTR_BORDERS.BORDER_RIGHT,ATTR_BORDERS.BORDER_LEFT],n=0;n<r.length;n++){if(!o){o=O(t,r);break}o[r[n]]||(o[r[n]]=O(t,[r[n]])[r[n]])}o=BorderUtils.getBorderSidesForCell(o,t),BorderUtils.convertZWColorToRGB(o),e.borders=o?o:{};var a={};for(var l in e[ATTR_COMMON.BORDERS])"0px"!=e[ATTR_COMMON.BORDERS][l][ATTR_BORDERS.WIDTH]&&(a[l]=e[ATTR_COMMON.BORDERS][l]);var s=BorderUtils.getBorderValuesForUpdateUI(a);for(l in e)l!=[ATTR_COMMON.BORDERS]&&"modifiedStyles"!=l&&(e[l]=p[l](i,t,s));return e},f=function(e){var t,o={bgc:"z_td_bgc",borders:ATTR_COMMON.BORDERS,bgimg:ATTR_CELL.TDS_BGIMG},r=editor.doc.getSelection();t=r.isTableSelected()?r.getSelectedCells():editor.doc.getParents(NODE_TYPE.CELL,r.getStart());var n,a=t.length;for(var l in e)if(n={},n[o[l]]=e[l],null!=e[l]){if(l==ATTR_COMMON.BORDERS)if(a){var s=[],d=BorderUtils.getSelectedCellsInfo(t);for(i=0;i<a;i++){var c=d[i],p={};n[l][ATTR_BORDERS.BORDER_TOP]&&(p[ATTR_BORDERS.BORDER_TOP]=n[l][ATTR_BORDERS.BORDER_TOP],c.lr||(p[ATTR_BORDERS.BORDER_BOTTOM]=p[ATTR_BORDERS.BORDER_TOP])),n[l][ATTR_BORDERS.BORDER_BOTTOM]&&(p[ATTR_BORDERS.BORDER_BOTTOM]=n[l][ATTR_BORDERS.BORDER_BOTTOM],c.fr||(p[ATTR_BORDERS.BORDER_TOP]=p[ATTR_BORDERS.BORDER_BOTTOM])),n[l][ATTR_BORDERS.BORDER_LEFT]&&(p[ATTR_BORDERS.BORDER_LEFT]=n[l][ATTR_BORDERS.BORDER_LEFT],c.lc||(p[ATTR_BORDERS.BORDER_RIGHT]=p[ATTR_BORDERS.BORDER_LEFT])),n[l][ATTR_BORDERS.BORDER_RIGHT]&&(p[ATTR_BORDERS.BORDER_RIGHT]=n[l][ATTR_BORDERS.BORDER_RIGHT],c.fc||(p[ATTR_BORDERS.BORDER_LEFT]=p[ATTR_BORDERS.BORDER_RIGHT])),s.push({borders:p})}var u=BorderUtils.getBoundaryCellsOfSelection(t[0],t[a-1]);if(n[l][ATTR_BORDERS.BORDER_TOP]){var f,g=u.topBoundaryCells,m=g.length;for(f=0;f<m;f++){t.push(g[f]);var h;h=g[f].attr()[ATTR_COMMON.BORDERS]?g[f].attr()[ATTR_COMMON.BORDERS]:{},h[ATTR_BORDERS.BORDER_BOTTOM]=n[l][ATTR_BORDERS.BORDER_TOP],s.push({borders:h})}}if(n[l][ATTR_BORDERS.BORDER_RIGHT]){var f,T=u.rightBoundaryCells,E=T.length;for(f=0;f<E;f++){t.push(T[f]);var h;h=T[f].attr()[ATTR_COMMON.BORDERS]?T[f].attr()[ATTR_COMMON.BORDERS]:{},h[ATTR_BORDERS.BORDER_LEFT]=n[l][ATTR_BORDERS.BORDER_RIGHT],s.push({borders:h})}}if(n[l][ATTR_BORDERS.BORDER_BOTTOM]){var f,R=u.bottomBoundaryCells,O=R.length;for(f=0;f<O;f++){t.push(R[f]);var h;h=R[f].attr()[ATTR_COMMON.BORDERS]?R[f].attr()[ATTR_COMMON.BORDERS]:{},h[ATTR_BORDERS.BORDER_TOP]=n[l][ATTR_BORDERS.BORDER_BOTTOM],s.push({borders:h})}}if(n[l][ATTR_BORDERS.BORDER_LEFT]){var f,v=u.leftBoundaryCells,b=v.length;for(f=0;f<b;f++){i+=1,t.push(v[f]);var h;h=v[f].attr()[ATTR_COMMON.BORDERS]?v[f].attr()[ATTR_COMMON.BORDERS]:{},h[ATTR_BORDERS.BORDER_RIGHT]=n[l][ATTR_BORDERS.BORDER_LEFT],s.push({borders:h})}}n=s}else S(t,n[ATTR_COMMON.BORDERS]);jQuery.isEmptyObject(n)||editor.doc.execCmd("applyStyle",[t,n,"applyCellStyle"])}},g=function(i,o){if(t&&(Z(l.BDR_ALL).zstatebutton("checked",!1),Z(l.BDR_TOP).zstatebutton("checked",!1),Z(l.BDR_LEFT).zstatebutton("checked",!1),Z(l.BDR_RIGHT).zstatebutton("checked",!1),Z(l.BDR_BOTTOM).zstatebutton("checked",!1),o.zstatebutton("checked",!0)),"CELL_BORDER_ALL"==i.action?(Z(l.BDR_ALL).zstatebutton("checked",!0),Z(l.BDR_TOP).zstatebutton("checked",!0),Z(l.BDR_LEFT).zstatebutton("checked",!0),Z(l.BDR_RIGHT).zstatebutton("checked",!0),Z(l.BDR_BOTTOM).zstatebutton("checked",!0),t=!0):t=!1,Z(l.BDR_TOP).prop("checked")&&Z(l.BDR_RIGHT).prop("checked")&&Z(l.BDR_BOTTOM).prop("checked")&&Z(l.BDR_LEFT).prop("checked")?Z(l.BDR_ALL).zstatebutton("checked",!0):Z(l.BDR_ALL).zstatebutton("checked",!1),Z(l.BDR_TOP).prop("checked")||Z(l.BDR_RIGHT).prop("checked")||Z(l.BDR_BOTTOM).prop("checked")||Z(l.BDR_LEFT).prop("checked")){Z(l.BDR_WIDTH).enable(),Z(l.BDR_COLOR).enable(),Z(l.BDR_STYLE).enable();var r=BorderUtils.getSelectedSides("td"),n={};if(e[ATTR_COMMON.BORDERS])for(var a=0;a<r.length;a++)n[r[a]]=e[ATTR_COMMON.BORDERS][r[a]]?e[ATTR_COMMON.BORDERS][r[a]]:{};var s=BorderUtils.getBorderValuesForUpdateUI(n);Z(l.BDR_WIDTH).zcombo("setValue",s[ATTR_BORDERS.WIDTH]),Z(l.BDR_STYLE).zcombo("setValue",s[ATTR_BORDERS.TYPE]),Z(l.BDR_COLOR).zcolorfield("setColor",Utils.getColorValFromRefString(s[ATTR_BORDERS.COLOR])),0!=s[ATTR_BORDERS.COLOR]?T(s[ATTR_BORDERS.COLOR],!0):T("rgb(0, 0, 0)",!0)}else Z(l.BDR_WIDTH).disable(),Z(l.BDR_COLOR).disable(),Z(l.BDR_STYLE).disable()},m=function(){Z(l.BG_IMG_SELECTED).hide(),Z(l.BG_IMG).show()},h=function(){Z(l.BG_IMG_SELECTED).show(),Z(l.BG_IMG).hide()},T=function(e,t){var i=Z("combo_td-bdr-widthMenu").find(".ui-borderstylebg");if(i=i.add(Z("combo_td-bdr-styleMenu").find(".ui-borderstylebg")),i=i.add(Z(l.BDR_STYLE).next().find(".ui-borderstylebg")),i.css({"border-top-color":e}),t);},E=function(){Z(l.BDR_ALL).zstatebutton("checked",!1),Z(l.BDR_WIDTH).disable(),Z(l.BDR_STYLE).disable(),Z(l.BDR_COLOR).disable();var t=["top","left","right","bottom"],i={};i[ATTR_COMMON.BORDERS]=c(o,"0px"),e[ATTR_COMMON.BORDERS]=i[ATTR_COMMON.BORDERS],f(i);for(var r=0;r<=t.length;r++)Z("td-bdr-"+t[r]).prop("checked")&&Z("td-bdr-"+t[r]).zstatebutton("checked",!1)},R=function(){var e=Z("cell-bdr-container");e.data("ztrackObject")?e.ZCtrackObjects("refreshValues"):e.ZCtrackObjects({callbacks:CellBorders.panelInfo,fillVisible:!1,eventNameMapping:{zspinner:"spinnerblur"}})},S=function(e,t){var i=TableUtil.findColIdx(e)-1,o=e.parentNode().children(),r=o[i-1]?o[i-1]:void 0,n=o[i+1]?o[i+1]:void 0,a=e.parentNode().previousSibling(),l=a?a.children():[],s=l[i]?l[i]:void 0,d=e.parentNode().nextSibling(),c=d?d.children():[],p=c[i]?c[i]:void 0;if(t[ATTR_BORDERS.BORDER_TOP]&&s){var u=s.attr()[ATTR_COMMON.BORDERS]||{};u[ATTR_BORDERS.BORDER_BOTTOM]=t[ATTR_BORDERS.BORDER_TOP],s.attr({borders:u})}if(t[ATTR_BORDERS.BORDER_RIGHT]&&n){var u=n.attr()[ATTR_COMMON.BORDERS]||{};u[ATTR_BORDERS.BORDER_LEFT]=t[ATTR_BORDERS.BORDER_RIGHT],n.attr({borders:u})}if(t[ATTR_BORDERS.BORDER_BOTTOM]&&p){var u=p.attr()[ATTR_COMMON.BORDERS]||{};u[ATTR_BORDERS.BORDER_TOP]=t[ATTR_BORDERS.BORDER_BOTTOM],p.attr({borders:u})}if(t[ATTR_BORDERS.BORDER_LEFT]&&r){var u=r.attr()[ATTR_COMMON.BORDERS]||{};u[ATTR_BORDERS.BORDER_RIGHT]=t[ATTR_BORDERS.BORDER_LEFT],r.attr({borders:u})}},O=function(e,t){var i={"border-top":"top","border-left":"left","border-right":"right","border-bottom":"bottom"};e=DocTreeManager.getDOMnodeFromDTnode(e.dtNode);for(var o={},r=0;r<t.length;r++){var n=t[r],a=J(e).css("border-"+i[n]+"-color"),l=J(e).css("border-"+i[n]+"-width"),s=J(e).css("border-"+i[n]+"-style");"none"==s&&(s="solid"),o[n]={},o[n][ATTR_BORDERS.WIDTH]=l,o[n][ATTR_BORDERS.TYPE]=s,o[n][ATTR_BORDERS.COLOR]=a}return o},v=function(e){var t=DocTreeManager.getDOMnodeFromDTnode(e.dtNode);return J(t).css("background-color")};return{panelInfo:d,refreshValues:R,showFileUploadForCell:m,clearCellBorders:E,getBorderObj:O,getBackgroundColor:v}}(),TableBorders=function(){"use strict";var e={},t=!1,i=ATTR_BORDERS.WIDTH,o=ATTR_BORDERS.COLOR,r=ATTR_BORDERS.TYPE,n={type:"solid",color:"zwdark1",width:"1px",space:"0px"},a={BDR_ALL:"tbl-bdr-all",BDR_TOP:"tbl-bdr-top",BDR_LEFT:"tbl-bdr-left",BDR_RIGHT:"tbl-bdr-right",BDR_BOTTOM:"tbl-bdr-bottom",BDR_WIDTH:"tbl-bdr-width",BDR_STYLE:"tbl-bdr-style",BDR_COLOR:"tbl-bdr-color",BG_COLOR:"tbl-bg-color",BG_IMG_FILE:"tbl-localimg-file",BG_IMG_SELECTED:"tbl-bgimg-selected",BG_IMG:"tableBgImg"},l=({bdrWidthCombo:J("#combo_tbl-bdr-widthMenu .ui-borderstylebg"),bdrStyleCombo:J("#combo_tbl-bdr-styleMenu .ui-borderstylebg")},{TABLE_BORDER_ALL:{get:function(i,o){return!(!e.sides||e.sides.indexOf(ATTR_BORDERS.BORDER_TOP)==-1||e.sides.indexOf(ATTR_BORDERS.BORDER_LEFT)==-1||e.sides.indexOf(ATTR_BORDERS.BORDER_BOTTOM)==-1||e.sides.indexOf(ATTR_BORDERS.BORDER_RIGHT)==-1)&&(t=!0,!0)},set:function(e,t,i){Z(a.BDR_ALL).zstatebutton("checked",t),Z(a.BDR_TOP).zstatebutton("checked",t),Z(a.BDR_RIGHT).zstatebutton("checked",t),Z(a.BDR_BOTTOM).zstatebutton("checked",t),Z(a.BDR_LEFT).zstatebutton("checked",t),f(e,i)}},TABLE_BORDER_TOP:{get:function(t,i){return!(!e.sides||e.sides.indexOf(ATTR_BORDERS.BORDER_TOP)==-1)},set:function(e,t,i){f(e,i)}},TABLE_BORDER_RIGHT:{get:function(t,i){return!(!e.sides||e.sides.indexOf(ATTR_BORDERS.BORDER_RIGHT)==-1)},set:function(e,t,i){f(e,i)}},TABLE_BORDER_BOTTOM:{get:function(t,i){return!(!e.sides||e.sides.indexOf(ATTR_BORDERS.BORDER_BOTTOM)==-1)},set:function(e,t,i){f(e,i)}},TABLE_BORDER_LEFT:{get:function(t,i){return!(!e.sides||e.sides.indexOf(ATTR_BORDERS.BORDER_LEFT)==-1)},set:function(e,t,i){f(e,i)}},TABLE_BORDER_COLOR:{get:function(t,i){return 0==e.sides.length?Z(a.BDR_COLOR).disable():0!=e[ATTR_BORDERS.COLOR]?(h(e[ATTR_BORDERS.COLOR],!0),Z(a.BDR_COLOR).enable()):h("rgb(0, 0, 0)",!0),e[ATTR_BORDERS.COLOR]},set:function(e,t,i){h(Utils.rgbToHex(t),!0);var r={};return r[ATTR_COMMON.BORDERS]=d(o,Utils.getColorReference(arguments[4])),r}},TABLE_BORDER_WIDTH:{get:function(t,i){return 0==e.sides.length?Z(a.BDR_WIDTH).disable():null!==e[ATTR_BORDERS.WIDTH]&&Z(a.BDR_WIDTH).enable(),e[ATTR_BORDERS.WIDTH]},set:function(e,t,o){var r={};return r[ATTR_COMMON.BORDERS]=d(i,parseFloat(t)+UNITS.PIXELS),r}},TABLE_BORDER_TYPE:{get:function(t,i){return 0==e.sides.length?Z(a.BDR_STYLE).disable():null!==e[ATTR_BORDERS.TYPE]&&Z(a.BDR_STYLE).enable(),e[ATTR_BORDERS.TYPE]},set:function(e,t,i){var o={};return o[ATTR_COMMON.BORDERS]=d(r,t),o}},TABLE_BG_COLOR:{get:function(t,i){var o=Utils.getColorValFromRefString(e.bgc),r=Utils.rgbToHex(o);return"transparent"==o?Z(a.BG_COLOR).text(""):Z(a.BG_COLOR).text(Utils.rgbToHex(r)),o},set:function(e,t,i){var o={};return o.bgc=Utils.getColorReference(arguments[4]),"transparent"==t?Z(a.BG_COLOR).text(""):Z(a.BG_COLOR).text(Utils.rgbToHex(t)),o}},TABLE_BG_IMG:{get:function(t,i){e.bgimg?m():g()},set:function(e,t,i){var o={};J("#errormsg1").hide();var r=Z(a.BG_IMG_FILE).val();return Utils.isValidImage(r)?BorderUtils.applyBGImgtoTable(o)?(Z(a.BG_IMG_SELECTED).show(),Z(a.BG_IMG).hide(),o):(J("#errormsg1").show().html(UIUtils.getErrorMsg("error",J.i18n("image","IMAGE_SIZE_EXCEED"))),void Z(a.BG_IMG_FILE).val("")):(J("#errormsg1").show().html(UIUtils.getErrorMsg("error",J.i18n("image","INVALID_IMG_EXT"))),null)}},TABLE_BG_IMG_NONE:{get:function(t,i){e.bgimg?m():g()},set:function(e,t,i){var o={};return o.bgimg="",g(),o}}}),s={beforeFillValues:function(){e={borders:null,bgc:null,bgimg:null,width:null,type:null,color:null,sides:[],modifiedStyles:[]},e=p(e)},get:function(e,t){var i=l[e.action].get;if(i)return i(e,t)},set:function(t,i,o){arguments[5]&&arguments[5].keyCode==KEYS.TAB?EventHandler.isDialogFocused=!0:EventHandler.isDialogFocused=!1;var r=l[t.action].set,n=r&&r.apply(null,arguments);if(null!=n)for(var a in n)e[a]=n[a];u(n)}},d=function(t,i){for(var o=(editor.doc.getParents(NODE_TYPE.TABLE,editor.doc.getSelection().getStart()),DocUtil.copyStyle(e[ATTR_COMMON.BORDERS])),r=J("#tbl-bdr-color").zcolorfield("getColor"),a=BorderUtils.getSelectedSides("tbl"),l=0,s=a.length;l<s;l++){var d=a[l];if(o&&o[d])o[d][t]=i,r&&(r.indexOf("rgba")!=-1&&(r="rgb(0,0,0)"),o[d][ATTR_BORDERS.COLOR]=r),o[d][ATTR_BORDERS.SPACE]||(o[d][ATTR_BORDERS.SPACE]="0px");else{var c=DocUtil.copyStyle(n);c[t]=i,o[d]=c}t==ATTR_BORDERS.TYPE&&"double"==i&&parseInt(o[d][ATTR_BORDERS.WIDTH])<3&&(o[d][ATTR_BORDERS.WIDTH]="3px")}return o},c={bgc:function(e){return Utils.getColorValFromRefString(e.z_tbl_bgc)||"rgb(255,255,255)"},bgimg:function(e){return e[ATTR_TABLE.TBLS_BGIMG]||null},width:function(e,t,i){return i[ATTR_BORDERS.WIDTH]},type:function(e,t,i){return i[ATTR_BORDERS.TYPE]},color:function(e,t,i){return i[ATTR_BORDERS.COLOR]},sides:function(e,t,i){return i.sides}},p=function(e){var t=editor.doc.getSelection().parents(NODE_TYPE.TABLE),i=t.attr(),o=i[ATTR_COMMON.BORDERS];o||(o=S(t)),BorderUtils.convertZWColorToRGB(o),e[ATTR_COMMON.BORDERS]=o?o:{};var r={};for(var n in e[ATTR_COMMON.BORDERS])"0px"!=e[ATTR_COMMON.BORDERS][n][ATTR_BORDERS.WIDTH]&&(r[n]=e[ATTR_COMMON.BORDERS][n]);var a=BorderUtils.getBorderValuesForUpdateUI(r);for(n in e)n!=ATTR_COMMON.BORDERS&&(e[n]=c[n](i,t,a));return e},u=function(e){var t={bgc:"z_tbl_bgc",borders:ATTR_COMMON.BORDERS,bgimg:ATTR_TABLE.TBLS_BGIMG},i=editor.doc.getParents(NODE_TYPE.TABLE,editor.doc.getSelection().getStart()),o={};for(var r in e)o[t[r]]=e[r],null!=e[r]&&(r==ATTR_COMMON.BORDERS&&R(i,o[ATTR_COMMON.BORDERS]),jQuery.isEmptyObject(o)||editor.doc.execCmd("applyStyle",[i,o,"applyTableBorderStyle"]))},f=function(i,o){if(t&&(Z(a.BDR_ALL).zstatebutton("checked",!1),Z(a.BDR_TOP).zstatebutton("checked",!1),Z(a.BDR_LEFT).zstatebutton("checked",!1),Z(a.BDR_RIGHT).zstatebutton("checked",!1),Z(a.BDR_BOTTOM).zstatebutton("checked",!1),o.zstatebutton("checked",!0)),"TABLE_BORDER_ALL"==i.action?(Z(a.BDR_ALL).zstatebutton("checked",!0),Z(a.BDR_TOP).zstatebutton("checked",!0),Z(a.BDR_LEFT).zstatebutton("checked",!0),Z(a.BDR_RIGHT).zstatebutton("checked",!0),Z(a.BDR_BOTTOM).zstatebutton("checked",!0),t=!0):t=!1,Z(a.BDR_TOP).prop("checked")&&Z(a.BDR_RIGHT).prop("checked")&&Z(a.BDR_BOTTOM).prop("checked")&&Z(a.BDR_LEFT).prop("checked")?Z(a.BDR_ALL).zstatebutton("checked",!0):Z(a.BDR_ALL).zstatebutton("checked",!1),Z(a.BDR_TOP).prop("checked")||Z(a.BDR_RIGHT).prop("checked")||Z(a.BDR_BOTTOM).prop("checked")||Z(a.BDR_LEFT).prop("checked")){Z(a.BDR_WIDTH).enable(),Z(a.BDR_COLOR).enable(),Z(a.BDR_STYLE).enable();var r=[];Z(a.BDR_TOP).prop("checked")&&r.push(ATTR_BORDERS.BORDER_TOP),Z(a.BDR_RIGHT).prop("checked")&&r.push(ATTR_BORDERS.BORDER_RIGHT),Z(a.BDR_BOTTOM).prop("checked")&&r.push(ATTR_BORDERS.BORDER_BOTTOM),Z(a.BDR_LEFT).prop("checked")&&r.push(ATTR_BORDERS.BORDER_LEFT);var n={};if(e[ATTR_COMMON.BORDERS])for(var l=0;l<r.length;l++)n[r[l]]=e[ATTR_COMMON.BORDERS][r[l]]?e[ATTR_COMMON.BORDERS][r[l]]:{};var s=BorderUtils.getBorderValuesForUpdateUI(n);Z(a.BDR_WIDTH).zcombo("setValue",s[ATTR_BORDERS.WIDTH]),Z(a.BDR_STYLE).zcombo("setValue",s[ATTR_BORDERS.TYPE]),Z(a.BDR_COLOR).zcolorfield("setColor",s[ATTR_BORDERS.COLOR]),0!=s[ATTR_BORDERS.COLOR]?h(s[ATTR_BORDERS.COLOR],!0):h("rgb(0, 0, 0)",!0)}else Z(a.BDR_COLOR).disable(),Z(a.BDR_WIDTH).disable(),Z(a.BDR_STYLE).disable()},g=function(){Z(a.BG_IMG_SELECTED).hide(),Z(a.BG_IMG).show()},m=function(){Z(a.BG_IMG_SELECTED).show(),Z(a.BG_IMG).hide()},h=function(e,t){var i=Z("combo_tbl-bdr-widthMenu").find(".ui-borderstylebg");if(i=i.add(Z("combo_tbl-bdr-styleMenu").find(".ui-borderstylebg")),i=i.add(Z(a.BDR_STYLE).next().find(".ui-borderstylebg")),i.css({"border-top-color":e}),t);},T=function(){Z(a.BDR_ALL).zstatebutton("checked",!1),Z(a.BDR_WIDTH).disable(),Z(a.BDR_STYLE).disable(),Z(a.BDR_COLOR).disable();var t=["top","left","right","bottom"],o={};o[ATTR_COMMON.BORDERS]=d(i,"0px"),e[ATTR_COMMON.BORDERS]=o[ATTR_COMMON.BORDERS],u(o);for(var r=0;r<=t.length;r++)Z("tbl-bdr-"+t[r]).prop("checked")&&Z("tbl-bdr-"+t[r]).zstatebutton("checked",!1)},E=function(){var e=Z("tbl-bdr-container");if(0!=e.length&&LeftPanel.isPanelVisible(ELEM_ID.TABLEOPTIONSPANEL)){var t=Z("tablepanel-tabs").ztab("getSelectedTab").children().attr("href");"#tablepanel-design-tab"==t&&(e.data("ztrackObject")?e.ZCtrackObjects("refreshValues"):e.ZCtrackObjects({callbacks:TableBorders.panelInfo,fillVisible:!1,eventNameMapping:{zspinner:"spinnerblur"}}))}},R=function(e,t){var i,o=e.children(),r=o.length,n=o[0].children(),a=o[r-1].children(),l=[],s=[],d=n.length-1;for(i=0;i<r;i++)l.push(o[i].children()[0]),s.push(o[i].children()[d]);var c;if(1==n.length&&1==o.length)c=[{elem:n[0],side1:"border-top",side2:"border-left",side3:"border-right",side4:"border-bottom"}];else if(1==n.length){c=[{elem:n[0],side1:"border-top",side2:"border-left",side3:"border-right"},{elem:a[a.length-1],side1:"border-bottom",side2:"border-right",side3:"border-left"}];for(var i=1;i<l.length-1;i++){var p={};p.elem=l[i],p.side1="border-left",p.side2="border-right",c.push(p)}}else if(1==o.length){c=[{elem:n[0],side1:"border-top",side2:"border-left",side3:"border-bottom"},{elem:n[n.length-1],side1:"border-bottom",side2:"border-right",side3:"border-top"}];for(var i=1;i<n.length-1;i++){var p={};p.elem=n[i],p.side1="border-top",p.side2="border-bottom",c.push(p)}}else c=[{elem:n[0],side1:"border-top",side2:"border-left"},{elem:n[n.length-1],side1:"border-top",side2:"border-right"},{elem:a[0],side1:"border-bottom",side2:"border-left"},{elem:a[a.length-1],side1:"border-bottom",side2:"border-right"}];var u=[];if(n.length>1&&o.length>1){if(t[ATTR_BORDERS.BORDER_TOP]){var f=n.length;for(i=1;i<f-1;i++){var g=n[i].attr();g[ATTR_COMMON.BORDERS]?(g[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_TOP]=t[ATTR_BORDERS.BORDER_TOP],u.push(n[i]),n[i].attr({borders:g[ATTR_COMMON.BORDERS]})):n[i].attr({borders:{"border-top":t[ATTR_BORDERS.BORDER_TOP]}})}}if(t[ATTR_BORDERS.BORDER_RIGHT]){var f=s.length;for(i=1;i<f-1;i++){var g=s[i].attr();g[ATTR_COMMON.BORDERS]?(g[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_RIGHT]=t[ATTR_BORDERS.BORDER_RIGHT],s[i].attr({borders:g[ATTR_COMMON.BORDERS]})):s[i].attr({borders:{"border-right":t[ATTR_BORDERS.BORDER_RIGHT]}})}}if(t[ATTR_BORDERS.BORDER_BOTTOM]){var f=a.length;for(i=1;i<f-1;i++){var g=a[i].attr();g[ATTR_COMMON.BORDERS]?(g[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_BOTTOM]=t[ATTR_BORDERS.BORDER_BOTTOM],a[i].attr({borders:g[ATTR_COMMON.BORDERS]})):a[i].attr({borders:{"border-bottom":t[ATTR_BORDERS.BORDER_BOTTOM]}})}}if(t[ATTR_BORDERS.BORDER_LEFT]){var f=l.length;for(i=1;i<f-1;i++){var g=l[i].attr();g[ATTR_COMMON.BORDERS]?(g[ATTR_COMMON.BORDERS][ATTR_BORDERS.BORDER_LEFT]=t[ATTR_BORDERS.BORDER_LEFT],l[i].attr({borders:g[ATTR_COMMON.BORDERS]})):l[i].attr({borders:{"border-left":t[ATTR_BORDERS.BORDER_LEFT]}})}}}for(var i=0;i<=c.length-1;i++){var m=t[c[i].side1],h=t[c[i].side2],T=t[c[i].side3],E=t[c[i].side4],R=c[i].elem.attr()[ATTR_COMMON.BORDERS]||{};m&&(R[c[i].side1]=m),h&&(R[c[i].side2]=h),T&&(R[c[i].side3]=T),E&&(R[c[i].side4]=E),(m||h||T||E)&&c[i].elem.attr({borders:R})}},S=function(e){var t=DocTreeManager.getDOMnodeFromDTnode(e.dtNode),i=e.attr();if(i.theme&&!i.bt&&!i.bb&&!i.br&&!i.bl){var o={},r=J(J(t).children("tbody").children()[0]).children()[0],n=J(r).css("border-top").split(" ");o[ATTR_BORDERS.BORDER_TOP]={},o[ATTR_BORDERS.BORDER_TOP][ATTR_BORDERS.WIDTH]=n[0],o[ATTR_BORDERS.BORDER_TOP][ATTR_BORDERS.TYPE]=n[1],o[ATTR_BORDERS.BORDER_TOP][ATTR_BORDERS.COLOR]=Utils.getColorValFromRefString(n.slice(2,n.length).join(""));var n=J(r).css("border-left").split(" ");o[ATTR_BORDERS.BORDER_LEFT]={},o[ATTR_BORDERS.BORDER_LEFT][ATTR_BORDERS.WIDTH]=n[0],o[ATTR_BORDERS.BORDER_LEFT][ATTR_BORDERS.TYPE]=n[1],o[ATTR_BORDERS.BORDER_LEFT][ATTR_BORDERS.COLOR]=Utils.getColorValFromRefString(n.slice(2,n.length).join(""));var a=J(t).children("tbody").children(),l=a.length,s=J(a[l-1]).children(),d=s.length,c=s[d-1],n=J(c).css("border-right").split(" ");o[ATTR_BORDERS.BORDER_RIGHT]={},o[ATTR_BORDERS.BORDER_RIGHT][ATTR_BORDERS.WIDTH]=n[0],o[ATTR_BORDERS.BORDER_RIGHT][ATTR_BORDERS.TYPE]=n[1],o[ATTR_BORDERS.BORDER_RIGHT][ATTR_BORDERS.COLOR]=Utils.getColorValFromRefString(n.slice(2,n.length).join(""));var n=J(c).css("border-bottom").split(" ");return o[ATTR_BORDERS.BORDER_BOTTOM]={},o[ATTR_BORDERS.BORDER_BOTTOM][ATTR_BORDERS.WIDTH]=n[0],o[ATTR_BORDERS.BORDER_BOTTOM][ATTR_BORDERS.TYPE]=n[1],o[ATTR_BORDERS.BORDER_BOTTOM][ATTR_BORDERS.COLOR]=Utils.getColorValFromRefString(n.slice(2,n.length).join("")),o}};return{panelInfo:s,refreshValues:E,showFileUploadForTable:g,clearTableBorders:T}}(),BorderUtils=function(){var e=["top","right","bottom","left"],t=function(e){var t=!1;Z("tdBgImg").hide();var i={progress:function(e){},success:function(t){t=editor.browserInfo.is_ie?t:JSON.parse("["+t+"]")[0],e.bgimg=t.uploadedFileUrl,Z("td-localimg-file").val("")},fail:function(e){t=!0,Z("td-localimg-file").val("")}},o=(editor.doc.getDocInfo(),{imagefile:Z("td-localimg-file")[0],fileName:"copy.png"});"REMOTE"==editor.getEditorType()?o.docId=editor.doc.getDocInfo().DOCUMENT_ID:o.rid=editor.doc.getDocInfo().RID,Utils.setCsrfParam(o);var r=Utils.getUrl("uploadImageFile");return J.ajaxUpload(r,o,i,"json",!0),!t},i=function(e){var t=!1;Z("tableBgImg").hide();var i={progress:function(e){},success:function(t){t=editor.browserInfo.is_ie?t:JSON.parse("["+t+"]")[0],e.bgimg=t.uploadedFileUrl,Z("tbl-localimg-file").val("")},fail:function(e){t=!0,Z("tbl-localimg-file").val("")}},o=(editor.doc.getDocInfo(),{imagefile:Z("tbl-localimg-file")[0],fileName:"copy.png"});"REMOTE"==editor.getEditorType()?o.docId=editor.doc.getDocInfo().DOCUMENT_ID:o.rid=editor.doc.getDocInfo().RID,Utils.setCsrfParam(o);var r=Utils.getUrl("uploadImageFile");return J.ajaxUpload(r,o,i,"json",!0),!t},o=function(e,t){var i={"border-left":ATTR_BORDERS.BORDER_RIGHT,"border-top":ATTR_BORDERS.BORDER_BOTTOM,"border-right":ATTR_BORDERS.BORDER_LEFT,"border-bottom":ATTR_BORDERS.BORDER_TOP},o=TableUtil.getSurroundingCells(t),r={};for(var n in e){var a=e[n];if(r[n]=a,"0px"==a[ATTR_BORDERS.WIDTH]){var l=n.split("-"),s=o[l[1]+"Cell"],d=s&&CellBorders.getBorderObj(s,[i[n]])[i[n]];d&&"0px"!=d[ATTR_BORDERS.WIDTH]&&(r[n]=d)}}return r},r=function(e){var t=[],i=0,o=e.length,r=TableUtil.findRowIdx(e[0].parentNode()),n=TableUtil.findRowIdx(e[o-1].parentNode()),a=TableUtil.findColIdx(e[0]),l=TableUtil.findColIdx(e[o-1]);for(i=0;i<o;i++){var s=e[i],d={fc:!1,fr:!1,lc:!1,lr:!1},c=TableUtil.findRowIdx(s.parentNode()),p=TableUtil.findColIdx(s);c===r&&(d.fr=!0),c===n&&(d.lr=!0),p===a&&(d.fc=!0),p===l&&(d.lc=!0),t.push(d)}return t},n=function(e,t){var i,o,r,n,a=e.parentNode(),l=TableUtil.findRowIdx(a)-1,s=TableUtil.findRowIdx(t.parentNode())-1,d=TableUtil.findColIdx(e)-1,c=TableUtil.findColIdx(t)-1,p=[],u=[],f=[],g=[],m=0,h=a.parentNode().children(),T=h.length,E=a.children().length;for(i=l>=1?l-1:l,o=s<T-1?s+1:s,r=d>=1?d-1:d,n=c<E-1?c+1:c,m=i;m<=o;m++){var R,S=r,O=n,v=h[m].children();for(R=S;R<=O;R++)if(!(m===l-1&&R===d-1||m===l-1&&R===c+1||m===s+1&&R===d-1||m===s+1&&R===c+1)){var b=v[R];m==l-1&&i!=l&&p.push(b),m>=l&&m<=s&&(R===d-1&&f.push(b),R===c+1&&g.push(b)),m===s+1&&o!=s&&u.push(b)}}return{topBoundaryCells:p,rightBoundaryCells:g,bottomBoundaryCells:u,leftBoundaryCells:f}},a=function(t){for(var i=[],o=0,r=e.length;o<r;o++){var n=e[o];Z(t+"-bdr-"+n).prop("checked")&&i.push("border-"+n)}return i},l=function(e){var t={},i=[];for(var o in e){var r=e[o];"0px"!=r[ATTR_BORDERS.WIDTH]&&i.push(o),"undefined"==typeof r[ATTR_BORDERS.TYPE]||"undefined"!=typeof t[ATTR_BORDERS.TYPE]&&t[ATTR_BORDERS.TYPE]!==r[ATTR_BORDERS.TYPE]?t[ATTR_BORDERS.TYPE]=null:t[ATTR_BORDERS.TYPE]=r[ATTR_BORDERS.TYPE],"undefined"==typeof r[ATTR_BORDERS.WIDTH]||"undefined"!=typeof t[ATTR_BORDERS.WIDTH]&&t[ATTR_BORDERS.WIDTH]!==r[ATTR_BORDERS.WIDTH]?t[ATTR_BORDERS.WIDTH]=null:t[ATTR_BORDERS.WIDTH]=r[ATTR_BORDERS.WIDTH],"undefined"==typeof r[ATTR_BORDERS.COLOR]||"undefined"!=typeof t[ATTR_BORDERS.COLOR]&&t[ATTR_BORDERS.COLOR]!==r[ATTR_BORDERS.COLOR]?t[ATTR_BORDERS.COLOR]=null:t[ATTR_BORDERS.COLOR]=r[ATTR_BORDERS.COLOR]}return t[ATTR_BORDERS.WIDTH]=t[ATTR_BORDERS.WIDTH]||!1,t[ATTR_BORDERS.COLOR]=t[ATTR_BORDERS.COLOR]||!1,t[ATTR_BORDERS.TYPE]=t[ATTR_BORDERS.TYPE]||!1,t.sides=i,t},s=function(e){if(0!=Object.keys(e).length)for(var t in e){var i=Utils.getColorValFromRefString(e[t][ATTR_BORDERS.COLOR]);e[t][ATTR_BORDERS.COLOR]=i.replace(/ /g,"")}},d=function(e){var t={},i=[ATTR_BORDERS.BORDER_TOP,ATTR_BORDERS.BORDER_BOTTOM,ATTR_BORDERS.BORDER_RIGHT,ATTR_BORDERS.BORDER_LEFT],o={};return o[ATTR_COMMON.BORDERS]=CellBorders.getBorderObj(e,i),t=DomUtil.getBorderStyles(o),t["background-color"]=CellBorders.getBackgroundColor(e),t};return{applyBGImgtoCell:t,applyBGImgtoTable:i,getBorderSidesForCell:o,getSelectedCellsInfo:r,getBoundaryCellsOfSelection:n,getSelectedSides:a,getBorderValuesForUpdateUI:l,convertZWColorToRGB:s,getTdBdrDomStyle:d}}(),NotePanel=function(e){"use strict";var t={},i=!1,o={beforeFillValues:function(){t={TYPE:"",SID:"",START_NUM:1,NOTE_FORMAT:"num"},t=c(t)},get:function(e,t){var i=d[e.action].get;if(i)return i(e,t)},set:function(e,i,o){arguments[5]&&arguments[5].keyCode==KEYS.TAB?EventHandler.isDialogFocused=!0:EventHandler.isDialogFocused=!1;var r=d[e.action].set,n=r&&r(e,i,o);if(null!=n)for(var a in n)t[a]=n[a];s(n)}},r=function(){p(),"endnote"==t.TYPE?Z("note-lpnl-title")[0].innerText=J.i18n("writer.endnote.ENDNOTE_PROPERTIES"):"footnote"==t.TYPE&&(Z("note-lpnl-title")[0].innerText=J.i18n("writer.endnote.FOOTNOTE_PROPERTIES"))},n=function(){},a=function(){if(!LeftPanel.isPanelVisible(e.NOTEPANEL)){var t={panelId:e.NOTEPANEL,animationType:ANIMATIONS.FLIPIN,parentPanels:[e.INSERTPANEL]};LeftPanel.showAdvancedPanel(t)}r()},l=function(){var t=LeftPanel.getCurrentPanel();t&&t.panelId===e.NOTEPANEL&&(LeftPanel.closeSubPanel(),n())},s=function(e){var t,i;for(t in e)i=u[t],i&&i(e[t])},d={START_NUM:{get:function(e,i){return t.START_NUM},set:function(e,t,i){return{START_NUM:t}}},NOTE_FORMAT:{get:function(e,i){var o="#note-lpnl-"+t.NOTE_FORMAT;i.zmenu("check",o)},set:function(e,t,i){return{NOTE_FORMAT:t.attr("value")}}}},c=function(e){var t=editor.doc.getSelection(),i=DocTreeManager.getTreeNodeAtIndex(t.getStart()),o=i.section.name,r=editor.doc.getBodyFormat()[o];return e={TYPE:o,SID:i.section.sid,START_NUM:r.stnum,NOTE_FORMAT:r.fmt}},p=function(){var t=Z(e.NOTEPANEL);i?LeftPanel.isPanelVisible(e.NOTEPANEL)&&t.ZCtrackObjects("refreshValues"):(i=!0,t.ZCtrackObjects({callbacks:o,fillVisible:!1,eventNameMapping:{zspinner:"spinnerblur"}}))},u={START_NUM:function(e){editor.doc.execCmd("changenotestyle",[t.TYPE,{startNumber:e}])},NOTE_FORMAT:function(e){editor.doc.execCmd("changenotestyle",[t.TYPE,{format:e}])}},f=function(e){"notesectionpane"==e&&LayoutManager.isRichEditActive()?a():l()};return PubSub.subscribe("Document/SectionChanged",f),{open:a,close:l}}(ELEM_ID);ListingView=function(){var e=editor.getBaseURL()+"/thumbnail/",t=t||editor.docsServerURL,i={0:"OWNER",1:"READ_ONLY",2:"READ_WRITE",3:"CO_OWNER",4:"READ_COMMENT"},o=editor.getBaseURL()+"/templates",r={Jstickies:null,resources_type:{TEMPLATES:2004,DOCUMENTS:2001},signInPageUrl:window.location.protocol+"//"+document.domain+"/writer/signup",hometabRequired:!1,model:window.DASHDOCS,priotritize:{TEMPLATES:["FEATURED_TEMPLATES","MY_TEMPLATES","RESUMES","LETTERS_AND_COVERS","BUSINESS","MEETING_AND_AGENDA","POSTERS_AND_INVITATIONS","LABELS_AND_ENVELOPE","SEASONAL","CREATIVE_WRITING","EDUCATION","PERSONAL_USE"],DOCUMENTS:["ALL_DOCUMENTS","CREATED_BY_ME","SHARED_WITH_ME","PUBLISHED_BY_ME","OFFLINE"]},bindEvents:function(){J(document).on("focusout keydown",".doc-name-placeholer",function(e){if("keydown"!=e.type||13==(e.keycode||e.which)){var t=J(e.target).parents(".ui-lp-right-thump-cont").find(".thumbnail-boxes").attr("rid"),i=J(this).val();ThumbnailView.gridRename(t,i)}}),J("#template-close-btn").on("click",this.closeWindow),J("#topband-createnewdocument,.large-blank-document-btn").on("click",function(){ThumbnailView.createNewBlankDocument()}),J(".subcategories-menu-container-parent li[cname]").on("click",function(e){J(".ui-nav a").removeClass("ui-active"),J(this).find("a").addClass("ui-active");var t=l(e);CategoryViews.show(t),Utils.addToStatistics("db_cname_"+t)}),J("#template-close-btn").on("click",this.close),J("#home-views-container").on("keydown",function(e){var t=e.keycode||e.which,i=e.ctrlKey||e.metaKey;if(27==t){if(window.isOutSideEditor)return;r.closeWindow()}else if(40==t){var o=i?J("#thump-view")[0].scrollHeight:J("#thump-view").scrollTop()+150;J("#thump-view").animate({scrollTop:o+"px"},50)}else if(38==t){var o=i?0:J("#thump-view").scrollTop()-150;J("#thump-view").animate({scrollTop:o+"px"},50)}}),J("#dashboard-search").on("keydown",function(e){var t=e.keyCode;if(13==t){var i=J(this).val();if(0==i.length)return;var o={success:function(e){e.RESULTS?r.renderSearchedDocuments(e.RESULTS||[]):this.error()},error:function(e){r.renderSearchedDocuments([])}},n="dashboard/search",a={query:i};J("#topband-search-container").find(".ui-loader-container").show(),J.ajax({type:"POST",data:a,async:!0,global:!1,dataType:"json",url:Utils.getNiceUrlPrefix(n),error:function(e){J("#topband-search-container").find(".ui-loader-container").hide(),o.error(e)},success:function(e){J("#topband-search-container").find(".ui-loader-container").hide(),o.success(e)}})}}),J.ui.utils.initComponents(J("#home-views-container")),J.ui.utils.initComponents(J("#more-list-menu"))},initializeMoreoption:function(e){J.ui.utils.initComponents(e.find("#thumbnails-view-container"))},renderCategories:function(e){CategoryMenuViews.render(e),CategoryViews.render(e)},showWindow:function(){J("#home-views-container").show().animate({top:"0px"},function(){J(this).focus(),J(".ui-temp-close").css("position","fixed")})},closeWindow:function(){J("#home-views-container").hide().animate({top:"-500px"})},showLoadingMessage:function(){J("#template-loading-container").show()},hideLoadingMessage:function(){J("#template-loading-container").hide()},setModel:function(e){this.model=J.extend(!0,{},e)},getModel:function(){return this.model?J.extend(!0,{},this.model):null},initializeTopBand:function(){UIUtils.setProperties(editorProps),parseInt(editor.zuid)!=-1?UIUtils.initUserInfoDialog(editorProps.userInfo):J("#dashboard-topband-userinfo").hide(),J("#helpmenu-whatsnew,#infomenu_mid_seperator,#helpmenu-feedback").hide(),c()},render:function(e){this.renderStart(),this.setModel(e);var t=Object.keys(this.getModel());t.length>1&&(this.hometabRequired=!0,this.addHomeTab(),this.homeTabContigents={DOCUMENTS:{IS_COMPOSED_CATEGORY:!0,CATEGORY:"RECENT_DOCUMENTS",VIEW_FROM:"ALL_DOCUMENTS",VIEW_FROM_HTML:"All Documents",ROWS:4,VIEW_TYPE:"GRID",COLUMN:11,MORE:!0,MORE_CONFIG:{TEXT:J.i18n("writer.common.LIST_ALL_DOCUMENTS"),CLICK:function(){CategoryViews.show("ALL_DOCUMENTS")}}},TEMPLATES:{IS_COMPOSED_CATEGORY:!0,CATEGORY:"FEATURED_TEMPLATES",VIEW_FROM:"RESUMES",VIEW_FROM_HTML:"Resumes",TITLE:"FEATURED_TEMPLATES",ROWS:1,VIEW_TYPE:"GRID",COLUMN:11,MORE:!0,MORE_CONFIG:{TEXT:J.i18n("writer.common.VIEW_ALL_TEMPLATES"),CLICK:function(){CategoryViews.showAllViews()}}}},J(window).on("resize",CategoryViews.controlHomeViewLimit),this.renderHomeTab());for(var e=this.getModel(),i=0;i<t.length;i++){var o=t[i],r=CategoryMenuViews.renderCategoryTitle(o);CategoryMenuViews.initialize(r.find(".subcategories-menu-container-parent")),CategoryMenuViews.beforeRender(o),CategoryViews.beforeRender();for(var n=e[o],a=this.priotritize[o],l=this.priotritize[o].length,s=0;s<l;s++){var c=a[s],p=n[c];p&&(CategoryMenuViews.render(p),CategoryViews.storeModel(p),delete n[c])}for(var u=Object.keys(n),f=u.length,s=0;s<f;s++){var p=n[u[s]];p&&!p.RENDERED&&(CategoryMenuViews.render(p),CategoryViews.storeModel(p))}}window.isOutSideEditor?(this.initializeTopBand(),J(window).on("resize",d)):J("#dashboard-topband-info,#dashboard-topband-userinfo").remove();var g=Object.keys(this.model);1==g.length&&"TEMPLATES"==g[0]?J("#topband-search-container,#topband-createnewdocument,#goto-docs-cont").remove():this.initDocsLink(),d(),CategoryViews.afterRender&&CategoryViews.afterRender(),CategoryMenuViews.afterRender&&CategoryMenuViews.afterRender(),this.renderComplete()},addHomeTab:function(){var e=CategoryMenuViews.renderHomeCategoryTitle();e.on("click",this.renderHomeTab.bind(this))},renderHomeTab:function(){for(var e=Object.keys(this.homeTabContigents),t=[],i=this.getModel(),o=0;o<e.length;o++){var r=this.homeTabContigents[e[o]],n=i[e[o]][r.CATEGORY];if(n.VIEW_TYPE=r.VIEW_TYPE,!n.DOCUMENTS||n.DOCUMENTS&&0==n.DOCUMENTS.length){n.DOCUMENTS=i[e[o]][r.VIEW_FROM].DOCUMENTS;for(var o=0;o<n.DOCUMENTS.length;o++){var a=n.DOCUMENTS[o];if(a.ORG_CATEGORY=r.VIEW_FROM,a.ORG_CATEGORY_HTML=r.VIEW_FROM_HTML,6==o)break}}if(this.priotritize[n.TYPE].indexOf(n.CATEGORY)!=-1){var l=this.priotritize[n.TYPE].indexOf(n.CATEGORY);this.priotritize[n.TYPE].splice(l,1)}n.el||CategoryViews.createView(n),n.IS_COMPOSED_CATEGORY=r.IS_COMPOSED_CATEGORY;var s=n;if(n.DOCUMENTS&&n.DOCUMENTS.length>0)s=CategoryViews.render(n,r.ROWS*r.COLUMN);else if("DOCUMENTS"==n.TYPE&&0==n.DOCUMENTS.length&&n.el&&0==n.el.find(".dashboard-no-doc-msg").length){var d=J(".large-blank-document-btn");s.el.append(d),d.show(),n.RENDERED=!0,CategoryViews.updateView(n)}s&&s.DOCUMENTS.length&&!s.el.next().hasClass("list-more-documents")&&r.MORE_CONFIG&&ThumbnailView.renderMoreOpt(s,r.MORE_CONFIG),t.push(s)}CategoryViews.showHomeView(t),CategoryViews.controlHomeViewLimit(t)},renderStart:function(){this.showLoadingMessage(),this.showWindow(),this.initViews()},renderComplete:function(){this.bindEvents(),this.hometabRequired||CategoryMenuViews.showFirstView(),this.hideLoadingMessage()},initDocsLink:function(){J("#goto-docs-link").attr("href",window.location.protocol+"//"+t),J("#goto-docs-text").text(J.i18n("writer.common.GOTO")+" "+editorProps.deployment.zohodocs)},initViews:function(){CategoryViews.initialize(),ThumbnailView.initialize(),PreviewView.initialize()},preProcessingModel:function(e){if(e.DOCUMENTS){var t=n();e.DOCUMENTS[t.CATEGORY]=t}},renderSearchedDocuments:function(t){t.sort(function(e,t){return parseInt(e.last_modified_time_in_milliseconds)-parseInt(t.last_modified_time_in_milliseconds)}),t.sort();for(var o=[],r=t.length-1;r>=0;r--){var n=t[r];if("zw"==n.service_type){var l={};l.DOCUMENT_NAME=n.res_name,l.DOCUMENT_NAME_HTML=n.encattr_res_name,l.RESOURCE_ID=n.res_id,l.RESOURCE_TYPE=2001,l.CREATED_BY=n.author_name,l.CREATED_TIME=n.created_time_in_milliseconds,l.MODIFIED_BY=-1,l.MODIFIED_BY_NAME=n.last_modified_by_name,l.MODIFIED_BY_NAME_HTML=n.last_modified_by_encattr_author_name,l.MODIFIED_TIME=n.last_modified_time_in_milliseconds,l.PREVIEWURL=e+n.res_id,void 0!=n.permission&&(l.ROLE=i[n.permission]),n.shared_types.is_org_share?l.PUBLISHED_TYPE="ORG":n.shared_types.is_public_share&&(l.PUBLISHED_TYPE="WEB"),n.shared_types.is_group_share?l.SHARED_TYPE="SHARED":n.shared_types.is_personal_share&&(l.SHARED_TYPE="SHARED_WITH_ME"),o.push(l)}}var s=a("SEARCH_RESULTS","DOCUMENTS","DOCUMENTS",0,o.length,o.length,void 0,o);CategoryViews.createView(s);CategoryViews.render(s);CategoryViews.show(s.CATEGORY)},fetchAndRenderView:function(){if(this.showLoadingMessage(),this.getModel())this.showWindow(),this.hideLoadingMessage();else{var e="template/list",t={limit:100,fromIndex:0};J.ajax({type:"POST",data:t,async:!0,global:!1,dataType:"json",url:Utils.getNiceUrlPrefix(e),error:function(e){},success:function(e){delete e.RESPONSE,r.render(e)}})}},openSignupPopup:function(e){PreviewView.close();var t={docType:"template"};e&&(t.rid=e),zwritersignup.openSignupDialog(t)},openTemplatesGallery:function(){Utils.safeWindowOpen(decodeURI(o),{},"_blank")}},n=function(){var e=[];if(ZWOffline.isOfflineSetupDone){var t=Object.keys(ZWOffline.docMetaArray),i=t.length;if(i>0)for(var o=0;o<i;o++){var r=t[o],n={};n.DOCUMENT_NAME=r.docName,n.DOCUMENT_NAME_HTML=r.docName_html,n.RESOURCE_ID=r.RID,n.RESOURCE_TYPE=2001,n.CREATED_BY=r.creatorName,n.CREATED_TIME=r.modifiedDate,n.MODIFIED_BY=r.modifiedBy,n.MODIFIED_TIME=r.modifiedDate,n.PREVIEWURL=previewUrlStrl+r.RID,e.push(n)}}var l=a("OFFLINE","DOCUMENTS","DOCUMENTS",0,200,200,void 0,e);return l},a=function(e,t,i,o,r,n,a,l){var s={};return s.CATEGORY=e,s.CATEGORY_NAME=J.i18n("writer.common."+e),s.CATEGORY_NAME_HTML=J.i18n("writer.common."+e),s.TYPE=t,s.TITLE=J.i18n("writer.common."+i),s.FROM=o,s.TO=r,s.COUNT=n,s.SCOPE=a,s.DOCUMENTS=l,s},l=function(e){for(var t=J(e.target),i=t.attr("cname"),o=0;!(i||(t=t.parent(),i=t.attr("cname"),i||o>=5));)o++;return i},s=function(){"TEMPLATE_USER"===editor.doc.getRole()&&(J("#banner-div").show(),J("#banner-template-cont").show(),J("#template-startwith-container").show())},d=function(){var e=J(".ui-temp-scrl");if(e[0]){var t=J(".ui-lp-left").height(),i=J(".ui-lp-logo-container").innerHeight(),o=J("#menutab-home").innerHeight(),r=J(".category-title")[0],n=r.currentStyle||window.getComputedStyle(r),a=(parseFloat(n.marginTop)+parseFloat(n.marginBottom)+r.offsetHeight)*J(".category-title").length,l=J(".ui-temp-scrl").parent("#categories-menu-container-parent").siblings("#categories-menu-container-parent").find(".subcategories-menu-container-parent").innerHeight(),s=J(".ui-lp-goto-docs").innerHeight(),d=t-(o+l+s+i+a);J(".ui-temp-scrl")[0].style.height=d+"px"}},c=function(){return editor.zuid==-1?void J("#ztb-topband").remove():(ztopbar({userInfo:{userId:editorProps.userInfo.zuid,emailAddress:editorProps.userInfo.email,appsInUse:"/writer/allapps"}}),void J(".ztb-profile-container,#ztb-menu-container,#ztb-logo").remove())};return PubSub.subscribe("Document/FirstTimeComponentReady",s),r}(),CategoryViews=function(){var e,t,i,o=(window.location.protocol+"//",editor.getBaseURL()+"/open/template/",window.location.protocol+"//"+document.domain+"/writer/signup",40),r=50,n="https://www.zoho.com/writer/help/document-distribution.html#publish-documents",a="https://www.zoho.com/writer/help/edit-files-offline.html?ref=dashboard",l="https://www.zoho.com/writer/help/document-collaboration-and-sharing.html?ref=dashboard",s=editor.getBaseURL()+"/new",d="https://www.zoho.com/writer/help/document-templates.html#create-new-template",c={2004:"TEMPLATES",2001:"DOCUMENTS"},p=!1,u={PUBLISHED_TYPE:{ORG:{icon:"ui-icon-with-in-organization-sm",tooltip:"writer.common.PUBLISHED_WITHIN_YOUR_ORG"},WEB:{icon:"ui-icon-outside-world-blk-sm",tooltip:"writer.common.PUBLISHED_EXTERNAL"}},SHARED_TYPE:{SHARED:{icon:"ui-icon-collabuser-blk-sm",tooltip:"writer.common.SHARED_DOCUMENT"},SHARED_WITH_ME:{icon:"ui-icon-shr-with-me-sm",tooltip:"writer.common.SHARED_WITH_ME"}}},f={layoutcollections:{CATEGORY_MENU_CONT:"#template-categories-container",CATEGORY_VIEW_CONT:"#category-view-container",PREVIEW_CONTAINER:"#document-preview-container",HOME_VIEW_CONTAINER:"#home-views-container",THUMBNAIL_VIEW_CONTAINER:"#thumbnails-view-container"},placeHolderForEmptyCats:{SEARCH_RESULTS:{ILLUSTRATION:"ui-illus-no-search",TITLE:"Uh-oh! No match found",MESSAGE:"You can search by document name,<br>or by a keyword you think is present in it."},PUBLISHED_BY_ME:{ILLUSTRATION:"ui-illus-no-doc-pub",TITLE:"Take stories off your world",MESSAGE:"Documents published by you using Writer will appear here. <br> Learn about <a target='_blank' href='"+n+"'>publishing documents</a>"},ALL_DOCUMENTS:{ILLUSTRATION:"ui-illus-no-doc-owned",TITLE:"Put your creative hat on!",MESSAGE:"You've set things up neat and pretty.<br> Now click on <a target='_blank' href='"+s+"'>New Blank Document</a> and get started."},CREATED_BY_ME:{ILLUSTRATION:"ui-illus-no-doc-owned",TITLE:"Put your creative hat on!",MESSAGE:"You've set things up neat and pretty.<br> Now click on <a target='_blank' href='"+s+"'>New Blank Document</a> and get started."},SHARED_WITH_ME:{ILLUSTRATION:"ui-illus-no-doc-share",TITLE:"Bring your friends over",MESSAGE:"Documents shared with you by your friends will appear here.<br>Wondering how to bring them in? <a target='_blank' href='"+l+"'>Here are some tips</a>"},MY_TEMPLATES:{ILLUSTRATION:"ui-illus-no-doc-owned",TITLE:"Get a head start",MESSAGE:"Create custom templates to reuse formatting of a document for future projects.<br>Learn more about <a target='_blank' href='"+d+"'>creating a template</a>"},OFFLINE:{ILLUSTRATION:"ui-illus-off-doc",TITLE:"Nothing here, yet!",MESSAGE:"<a target='_blank' href='"+a+"'>Learn more about editing files offline.</a>"}},views:[],currentViewThumbnailCollection:[],isFilteredView:!1,currentViewIdx:0,currentViewType:0,clickActionHandler:{DOCUMENTS:"documentClickHandler",TEMPLATES:"templateClickHandler"},initialize:function(e){return this.template=Handlebars.compile(J("#category-view").html()),this.el=J("#category-view-container"),this.dateCategorizationTemplate=Handlebars.compile(J("#list-date-categorization").html()),this},storeModel:function(e){var t={};t[e.CATEGORY]=e,this.views.push(t);var i=this.createView(e);i&&(this.updateView(e),e.el.hide())},createView:function(e){if(e.SCOPE==-100&&(!e.DOCUMENTS||e.DOCUMENTS&&0==e.DOCUMENTS.length))return null;var t=J(this.template(e));return this.el.append(t),e.el=t,e.el.find("#thumbnails-view-container").attr("context","more-list-menu"),e},render:function(e,t){if(e.RENDERED&&0!=e.RENDERED_COUNT)return e;e=J.extend(!0,{},e);var i=null,r=e.DOCUMENTS;if(!e.el)return e;if(i=e.el,this.bindClickEvents(e),r&&r.length>0){"TEMPLATES"==e.TYPE&&(e.VIEW_TYPE="GRID"),e.VIEW_TYPE||(e.VIEW_TYPE="LIST");var n=i.find("#thumbnails-view-container");n.find(".document-view-item,.ui-list-table-day").parent().remove(),ThumbnailView.readyView(e,n);var a=0,l=r.length;a=l<=o?l:t?t:o;this.renderThumbnails(e,r.slice(0,a));e.RENDERED_COUNT=a,e.RENDERED=!0}else e.DOCUMENTS&&0!=e.DOCUMENTS.length||(e.RENDERED_COUNT=0,this.fetchAndRenderDocuments(e,"STATUS_CHANGE_TIME"));return e.RENDERED=!0,this.updateView(e),e},renderThumbnails:function(e,i){for(var o=[],r=i.length,n=0;n<r;n++){var a=i[n];(!e.VIEW_TYPE||e.VIEW_TYPE&&"LIST"==e.VIEW_TYPE)&&(A(e,a,e.el.find("#thumbnails-view-container")),b(a));var l=ThumbnailView.render(a);l.CATEGORY=e.ORG_CATEGORY||e.CATEGORY,l.CATEGORY_NAME_HTML=e.ORG_CATEGORY_HTML||e.CATEGORY_NAME_HTML,o.push(l)}if(!e.RENDERED_COUNT&&r>0&&(!e.VIEW_TYPE||e.VIEW_TYPE&&"LIST"==e.VIEW_TYPE)){var s=Handlebars.compile(J("#sort-options").html()),d=J(s(e));e.el.find("#thumbnails-view-container").prepend(d),t=e.el.find(".sort-options").removeClass("fixed"),ListingView.initializeMoreoption(e.el)}return o},bindClickEvents:function(e){if(e.DOCUMENTS){var t=c[e.RESOURCE_TYPE]||e.TYPE;e.el.off("click").on("click",this[this.clickActionHandler[t]])}},show:function(i){var o=this.getViewObj(i),r=o.view;this.currentViewIdx=o.index,this.currentViewType=r.VIEW_TYPE||"LIST",e="","TEMPLATES"!=r.TYPE&&"GRID"==r.VIEW_TYPE&&(this.flushViews(r),r.el.css("height","100%"),r.RENDERED=!1,r.VIEW_TYPE="LIST"),r.RENDERED||(r=this.render(r)),"LIST"==r.VIEW_TYPE&&r.el.find(".sort-options").show(),J(".ui-nav a").removeClass("ui-active"),J(".subcategories-menu-container-parent li[cname='"+i+"']").find("a").addClass("ui-active"),J(".category-view").hide();var n=r.el;n.show(),J(".ui-lp-listall-doc").hide(),this.currentViewThumbnailCollection=r.DOCUMENTS.slice(0,r.RENDERED_COUNT),this.isFilteredView=!0,0==r.RENDERED_COUNT&&0!=r.DOCUMENTS.length&&this.renderMoreThumbnails(r),t=r.el.find(".sort-options").removeClass("fixed"),J("#thump-view").scrollTop(0),R(r)},showAllViews:function(){J(".category-view").hide(),this.currentViewIdx=-1,this.currentViewType="GRID",this.isFilteredView=!1;for(var e=0;e<this.views.length;e++){var t=this.views[e],i=Object.keys(t)[0],o=t[i];"TEMPLATES"!=o.TYPE||o.IS_COMPOSED_CATEGORY||(o.RENDERED||(o=this.render(o)),o.el&&(!o.MESSAGE_ADDED&&o.el.show(),this.currentViewThumbnailCollection=this.currentViewThumbnailCollection.concat(o.DOCUMENTS.slice(0,o.RENDERED_COUNT))))}J(".ui-nav a").removeClass("ui-active"),J(".ui-lp-right").removeClass("ui-gray-bg"),J("#thump-view").scrollTop(0),J("#menutab-all").find("a").addClass("ui-active"),J(".ui-lp-listall-doc").hide()},showHomeView:function(e){J(".category-view").hide();for(var t=0;t<e.length;t++){var i=e[t];!i||i&&!i.el||(i.el.show(),i.el.find("h3").addClass("ui-show-title"),this.currentViewThumbnailCollection||(this.currentViewThumbnailCollection=[]),i.RENDERED_COUNT&&(this.currentViewThumbnailCollection=this.currentViewThumbnailCollection.concat(i.DOCUMENTS.slice(0,i.RENDERED_COUNT))),0==i.DOCUMENTS.length&&1==i.el.find(".large-blank-document-btn").length&&i.el.find(".large-blank-document-btn").show(),i.MESSAGE_ADDED&&(i.el.find(".ui-lp-right-title").show(),i.el.find(".dashboard-no-doc-msg").hide()))}J("#thump-view").scrollTop(0),J(".ui-nav a").removeClass("ui-active"),J("#menutab-home").find("a").addClass("ui-active"),J(".ui-lp-listall-doc").show(),this.currentViewIdx=-1,this.currentViewType="GRID"},controlHomeViewLimit:function(e){var t=f.currentViewIdx;if(t==-1||"LIST"!=f.getView(t).VIEW_TYPE){if(!e||e&&!e.length){e=[];for(var i=Object.keys(ListingView.homeTabContigents),o=ListingView.getModel(),r=0;r<i.length;r++){var n=ListingView.homeTabContigents[i[r]],a=o[i[r]][n.CATEGORY];e.push(a)}}if(e)for(var r=0;r<e.length;r++){var l=e[r].el;if(l&&(!l||l[0])){var s=m(e[r].el),d=h(e[r].el),c=J(".ui-lp-right-title").outerHeight(),p=s*s.width,u=(0==r?d.count-1:1)*d.height+c+"px";e[r].el.css({height:u,overflow:"hidden"}),e[r].el.css("width",p+"px")}}}},beforeRender:function(){},afterRender:function(){J("#thump-view").off("scroll").on("scroll",function(){if(S(),f.currentViewIdx!=-1){var e=J(this);if(e.scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight){var t=f.currentViewIdx,i=f.getView(t);f.renderMoreThumbnails(i)}}}),J("#template-scrolltop").on("click",function(){J("#thump-view").animate({scrollTop:"0px"},"slow"),setTimeout(function(){v()},1e3)})},deleteFromViewCollection:function(e){for(var t=this.getViewObj(e.CATEGORY),i=t.view,o=i.DOCUMENTS,r=0;r<o.length;r++){var n=o[r];n.RESOURCE_ID==e.RESOURCE_ID&&(o.splice(r,1),0==o.length&&(i.el.remove(),this.views.splice(t.index,1),CategoryMenuViews.deleteView(e),this.showAllViews(),this.setTitleForNextView()))}for(var a=i.DOCUMENTS,r=0;r<a.length;r++){var l=a[r];l.RESOURCE_ID==e.RESOURCE_ID&&a.splice(r,1)}this.updateView(i)},getViewObj:function(e){for(var t=0,i={},o=this.views.length,r=0;r<o;r++){var n=this.views[r];if(n[e]){t=r;break}}return i.index=t,i.view=this.views[t][e],J.extend(!0,{},i)},getView:function(e){var t=this.views[e];return t[Object.keys(t)[0]]},updateView:function(e){for(var t=e.CATEGORY,i=this.views.length,o=!1,r=-1,n=0;n<i;n++){var a=this.views[n];if(a[t]){this.views[n][t]=e,ListingView.model[e.TYPE][t]=e,o=!0,r=n;break}}if(!o){var l={};l[t]=e,ListingView.model[e.TYPE][t]=e,this.views.push(l),r=this.views.length}return{index:r,view:e}},setTitleForNextView:function(){var e=this.currentViewIdx+1,t=this.getView(e);t.el.next().find(".category-title").text(t.TITLE).removeClass("category-title-replicated").show()},renderMoreThumbnails:function(e){if(e||(e=f.getView(this.currentViewIdx)),e.DOCUMENTS.length==e.RENDERED_COUNT&&e.RENDERED_COUNT<e.COUNT){if(p)return;return void this.fetchAndRenderDocuments(e,"STATUS_CHANGE_TIME")}var t=e.RENDERED_COUNT,i=e.COUNT;if(e.COUNT!=-1&&t!=i){var r=e.el.find("#thumbnails-view-container");ThumbnailView.readyView(e,r);var n=t+o,a=e.DOCUMENTS.slice(t,n);t+=a.length;this.renderThumbnails(e,a);if(e.RENDERED_COUNT=t,this.currentViewIdx!=-1)this.currentViewThumbnailCollection=e.DOCUMENTS.slice(0,e.RENDERED_COUNT);else if(10==e.SCOPE){var l=e.DOCUMENTS.slice(0,e.RENDERED_COUNT).concat(this.currentViewThumbnailCollection);this.currentViewThumbnailCollection=l}e.DOCUMENTS.length==t&&t==e.COUNT&&this.deleteMoreView(e.CATEGORY),this.updateView(e),ListingView.initializeMoreoption(e.el)}},deleteMoreView:function(e){var t=f.getViewObj(e).view;t.el.find(".thumbnail-more-option").remove()},fetchAndRenderDocuments:function(e,t){if(e.DOCUMENTS.length==e.COUNT)return void C(e);e.el.find(".ui-lazy-doc-loading").show();var i={data:e,success:function(e){var t=this.data;if(0!=e.COUNT){var i=e.DOCUMENTS;t.DOCUMENTS=t.DOCUMENTS.concat(i),t.FROM+=i.length,t.COUNT=e.COUNT;f.updateView(t).index;f.renderMoreThumbnails(t)}else if(!t.DOCUMENTS||0==t.DOCUMENTS.length){C(t),J(".large-blank-document-btn").hide();f.updateView(t).index;f.currentViewIdx==-1&&t.el.hide()}t.el.find(".ui-lazy-doc-loading").hide()},error:function(e){}};D(r,e.DOCUMENTS.length?e.DOCUMENTS.length:0,t,e.SCOPE,i)},documentClickHandler:function(e){if(J(e.target).parents(".list-more-option")[0])return void e.preventDefault();if(J.ZContextMenu._isMenuShowing)return y(),e.preventDefault(),void e.stopPropagation();var t=g(e);if(t){e.metaKey||e.ctrlKey;ThumbnailView.openDocument(t,"_blank")}},templateClickHandler:function(e){var t=g(e);if(t){var i=ThumbnailView.getViewIndex(t),o=ThumbnailView.getView(i);PreviewView.show(o,ThumbnailView.duplicateTemplate)}},flushViews:function(e){e.el&&(e.el.find("#thumbnails-view-container").children().remove(),e.el.find(".list-more-documents").children().remove(),e.RENDERED_COUNT=0,e.FROM=1)}},g=function(e){for(var t=J(e.target),i=t.attr("rid"),o=0;!(i||(t=t.parent(),i=t.attr("rid"),i||o>=5));)o++;return i},m=function(e){var t=J(e).find(".ui-lp-right-thump-cont")[0],i=E(t);null==i&&(i=198);var o=J("#category-view-container").width(),r=parseInt(o/i);return r<=3&&(r=3),{count:r,width:i}},h=function(e){var t=J(e).find(".ui-lp-right-thump-cont")[0],i=T(t);null==i&&(i=247);var o=T(J(".ui-lp-right-title")[0])||58,r=J("#dashboard-right-container").height()-(J("#dashboard-topband").height()+2*o),n=parseInt(r/i);return n<=2&&(n=2),i-=10,{count:n,height:i}},T=function(e){if(!e)return null;var t=e.currentStyle||window.getComputedStyle(e),i=e.offsetHeight,o=parseFloat(t.marginTop)+parseFloat(t.marginBottom),r=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),n=parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth);return i+o-r+n},E=function(e){if(!e)return null;var t=e.currentStyle||window.getComputedStyle(e),i=e.offsetWidth,o=parseFloat(t.marginLeft)+parseFloat(t.marginRight),r=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),n=parseFloat(t.borderLeftWidth)+parseFloat(t.borderRightWidth);return i+o-r+n},R=function(e){i=e.el.find(".ui-list-table-day").removeClass("fixed"),i instanceof jQuery&&i.length>0&&i.each(function(){var e=J(this);e.parent().hasClass("wrapper")||(e.wrap('<div class="wrapper"/>'),e.parent().css("height",44))})},S=function(){var e=J("#thump-view").scrollTop();J(".ui-lp-right-top-nav")[e<1?"removeClass":"addClass"]("ui-clr-trans"),e>800?O():v(),y();var o=J(".ui-lp-right-title").innerHeight();"LIST"==f.currentViewType&&(e-o>0?t.addClass("fixed"):t.removeClass("fixed"),i.each(function(e){var t=J(this),i=t.parent().offset().top;return i-o<=0?void t.addClass("fixed"):i+o>=0?void t.removeClass("fixed"):void 0}))},O=function(){J("#template-scrolltop").css({opacity:"1",bottom:"30px"})},v=function(){J("#template-scrolltop").css({opacity:"0",bottom:"-40px"})},b=function(e){if(e.SHARED_TYPE){var t=u.SHARED_TYPE[e.SHARED_TYPE];e.SHARED_RESOURCE=!0,e.SHARED_ICON_CLASS=t.icon,e.SHARED_TYPE_TOOLTIP=J.i18n(t.tooltip)}if(e.PUBLISHED_TYPE){var t=u.PUBLISHED_TYPE[e.PUBLISHED_TYPE];e.PUBLISHED_RESOURCE=!0,e.PUBLISHED_ICON_CLASS=t.icon,e.PUBLISHED_TYPE_TOOLTIP=J.i18n(t.tooltip)}return e},A=function(t,i,o){var r=moment(new Date),n=moment(parseInt(i.MODIFIED_TIME)),a=r.diff(n,"days"),l="";if(l=0==a?J.i18n("writer.common.TODAY"):a>0&&a<=7?J.i18n("writer.common.PREVIOUS_WEEK"):a>7&&a<=30?J.i18n("writer.common.PREVIOUS_MONTH"):J.i18n("writer.common.EARLIER"),e!=l&&t.PREV_FETCHED_DATE_CAT!=l){e=l;var s=J(f.dateCategorizationTemplate({TEXT:l}));o.append(s),t.PREV_FETCHED_DATE_CAT=e,R(t)}},y=function(){J.ZContextMenu.currentMenu;J.ZContextMenu.hideMenu()._isMenuShowing=!1},D=function(e,t,i,o,r){if(void 0!=o){o==-1&&(o=void 0);var n="dashboard/fetchdocuments",a={limit:e,from:t,sortBy:i,scope:o};a||(a={}),p=!0,J.ajax({type:"POST",data:a,async:!0,global:!1,dataType:"json",url:Utils.getNiceUrlPrefix(n),error:function(e){r.error(e),p=!1},success:function(e){r.success(e),p=!1}})}},C=function(e){if(e.MESSAGE_ADDED)catView.MESSAGE_ADDED&&e.el.find(".dashboard-no-doc-msg").show();else{var t=f.placeHolderForEmptyCats[e.CATEGORY];t&&(e.el.find(".ui-lp-right-title").hide(),e.el.css("height",J(".ui-lp-right").height()),e.el.append("<div class='ui-lp-no-doc-placeholder'><span class= 'ui-illus-icon "+t.ILLUSTRATION+"'></span><p class='dashboard-no-doc-msg'>"+t.TITLE+"</p><p class='dashboard-no-doc-msg'>"+t.MESSAGE+"</p></div>")),e.COUNT=0,e.MESSAGE_ADDED=!0}};return f}(),CategoryMenuViews=function(){var e=(window.location.protocol+"//"+editor.docsServerURL,{views:[],titleView:[],beforeRender:function(e){"TEMPLATES"==e&&this.renderAllTab()},bindClickEvents:function(){J(".category-title").on("click",function(){J(this).next().find("li:first-child").click()})},initialize:function(e){return this.el=e,this.template=Handlebars.compile(J("#template-menu-view").html()),this},renderAllTab:function(){var e=this.render({CATEGORY:"ALL",CATEGORY_NAME:"all",CATEGORY_NAME_HTML:J.i18n("writer.common.ALL")}),t=e.removeAttr("cname").attr("id","menutab-all");t.parent("ul").addClass("ui-temp-scrl"),e.on("click",function(){CategoryViews.showAllViews()})},renderHomeCategoryTitle:function(){var e=J("#categories-container"),t=Handlebars.compile(J("#home-tab-template").html()),i=J(t({NAME:"Home"}));return e.prepend(i),i.attr("id","menutab-home"),i},renderCategoryTitle:function(e){var t=J("#categories-container"),i=Handlebars.compile(J("#template-main-category-view").html()),o=J(i({NAME:e}));return J(t).append(o),this.titleView.push(o),o},render:function(e){if(e.SCOPE!=-100||e.DOCUMENTS&&(!e.DOCUMENTS||0!=e.DOCUMENTS.length)){e=J.extend(!0,{},e);var t=J(this.template(e));J(this.el).append(t),e.el=t;var i={};return i[e.CATEGORY]=e,this.views.push(i),t}},deleteView:function(e){var t=this.getViewObj(e.CATEGORY),i=t.view;i.el.remove(),this.views.splice(t.index,1)},getViewObj:function(e){for(var t=0,i={},o=this.views.length,r=0;r<o;r++)if(this.views[r][e]){t=r;break}return i.index=t,i.view=this.views[t][e],i},afterRender:function(){J(".ui-lp-left").niceScroll({cursorborder:"",cursorcolor:"#33373a",boxzoom:!1}),J(".ui-nav").niceScroll({cursorborder:"",cursorcolor:"#bdbdbd",boxzoom:!1}),this.bindClickEvents()},showFirstView:function(){var e=Object.keys(this.views[0]);this.views[0][e].el.click()}});return e}(),ThumbnailView=function(){var e=(window.location.protocol+"//"+editor.docsServerURL,window.location.protocol+"//"+document.domain+"/writer/signup",editor.getBaseURL()+"/open/"),t=null,i={layoutcollections:{CATEGORY_MENU_CONT:"#template-categories-container",CATEGORY_VIEW_CONT:"#category-view-container",PREVIEW_CONTAINER:"#document-preview-container",HOME_VIEW_CONTAINER:"#home-views-container",THUMBNAIL_VIEW_CONTAINER:"#thumbnails-view-container",THUMBNAIL_BOX:"#thumbnail-box",CATEGORY_CONTAINER:".ui-lp-right"},allViews:[],previousDateSection:"",isSelectableState:!1,viewType:"LIST",initialize:function(){return this.listtemplate=Handlebars.compile(J("#thumbnail-list-view").html()),this.gridtemplate=Handlebars.compile(J("#thumbnail-grid-view").html()),this.moretemplate=Handlebars.compile(J("#more-lisitng-view").html()),this},readyView:function(e,t){this.el=t,this.setTemplateViewType(e)},setTemplateViewType:function(e){e.VIEW_TYPE||(e.VIEW_TYPE="TEMPLATES"==e.TYPE?"GRID":"LIST"),"GRID"==e.VIEW_TYPE?(this.template=this.gridtemplate,this.viewType="GRID"):(this.template=this.listtemplate,this.viewType="LIST"),this.RECOMMENDEDVIEW=e.VIEW_TYPE},render:function(e){var t=this.createView(e),i=e.RESOURCE_ID,o={};return this.allViews.push(o[i]=e),this.el.append(t),e},renderMoreOpt:function(e,t){var i=J(this.moretemplate(t));return e.el.parent("#category-view-container").append(i),i.click(t.CLICK),i},createView:function(e){var t;if(e.VIEW_ID=Math.floor(1e3*Math.random()+1),2004==e.RESOURCE_TYPE&&(e.NEED_RATINGS=!0),e.RENDERED&&e.VIEW==this.RECOMMENDEDVIEW)t=e.el;else{var i=!1;2001!=e.RESOURCE_TYPE||!e.ROLE||"COOWNER"!=e.ROLE&&"OWNER"!=e.ROLE||(i=!0),e.RENAME_ALLOWED=i,t=J(this.template(e)),this.bindLoadEvent(t),t.attr("view-id",e.VIEW_ID),e.el=t,e.RENDERED=!0,e.VIEW_TYPE=this.RECOMMENDEDVIEW}return e.NEED_RATINGS&&r(e),t},bindRenameComponent:function(e,t){var i=e.CREATED_BY==editor.zuid,o=t.find(".document-name-field"),r={fileId:e.RESOURCE_ID,displayLength:"138",saveToFolder:!1,canFavourite:!1,rename:i,fetchDataFromServer:!1};o.zfilefield(r)},getViewIndex:function(e){var t=-1,i=CategoryViews.currentViewThumbnailCollection;return J.each(i,function(i,o){if(o.RESOURCE_ID==e)return void(t=i)}),t},getView:function(e){var t=CategoryViews.currentViewThumbnailCollection[e];return t.index=e,t},getNextView:function(){var e=CategoryViews.currentViewThumbnailCollection,t=PreviewView.currentViewIdx,i=t>=e.length-1?t:t+1;if(i==t)return null;var o=e[i];return o.index=i,o},getPreviousView:function(){var e=CategoryViews.currentViewThumbnailCollection,t=PreviewView.currentViewIdx,i=t>0?t-1:t;if(i==t)return null;var o=e[i];return o.index=i,o},deleteResource:function(e){var o=CategoryViews.getViewObj(t.CATEGORY).view,r=J.i18n("writer.common."+o.TYPE.substring(0,o.TYPE.length-1)+"_SMALL"),a=J.i18n("writer.common."+o.TYPE.substring(0,o.TYPE.length-1)),l={templateId:e,trash:function(){var e={success:function(e){var t=e.TRASHED_RID;if("FAILED"==e.SAVEAS||"-1"==t)return void this.error();i.updateView(t,"delete");var o=i.getViewIndex(t);i.getView(o);MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_SUCCESS,J.i18n("writer.common.DELETE_RESOURCETYPE",[a]),J.i18n("writer.common.TEMPLATE.TRASH_SUCCESS",[r]),null,null)},error:function(){MsgDialog.showMessage(CONST.MSG_TYPE_ALERT,CONST.SEVERITY_ERROR,J.i18n("writer.common.DELETE_RESOURCETYPE",[a]),J.i18n("writer.common.TEMPLATE.TRASH_FAILED",[r]),null,null)}},t="template/"+this.templateId.toString()+"/trash";n({},!0,t,e,!0)}},s=l.trash.bind(l),d=J.i18n("writer.common.TEMPLATE.TRASH_WARNING_MSG",[r]);MsgDialog.showMessage([J.i18n("writer.common.MOVE_TO_TRASH"),J.i18n("writer.common.CANCEL")],CONST.SEVERITY_INFO,J.i18n("writer.common.DELETE_RESOURCETYPE",[a]),d,null,function(e){switch(e){case CONST.BUTTON_YES_CLICKED:s()}})},duplicateTemplate:function(e,t){var i=e.RESOURCE_ID;if(parseInt(editor.zuid)==-1)return void ListingView.openSignupPopup(i);var r=editor.getBaseURL()+"/template/"+i+"/copytemplate";PreviewView.close(),o(r,t)},rename:function(e){var t=this.getViewIndex(e),i=this.getView(t);i.VIEW_TYPE&&"LIST"!=i.VIEW_TYPE?a(i):this.showRenameDialog(i)},showRenameDialog:function(e){l.name=e.DOCUMENT_NAME,l.rid=e.RESOURCE_ID,J.dialogutil.open("documentrenamedialog",J("#expTemp"),l)},gridRename:function(e,t){var o=this.getViewIndex(e),r=this.getView(o);if(r.DOCUMENT_NAME!=t){r.el.find(".ui-loader-container").show();var a={newName:t},l=!0,s="dashboard/"+e+"/rename",d={view:r,success:function(e){this.view.el.find(".ui-loader-container").hide().end().find("input").focusout(),this.view.DOCUMENT_NAME=e.NAME,this.view.DOCUMENT_NAME_HTML=e.NAME_HTML,this.view.RENDERED=!1,i.updateView(this.view)},error:function(e){}};n(a,l,s,d,!0)}},listRename:function(){l.showProgress();var e=l.rid,t=l.newName,o={newName:t},r=!0,a="dashboard/"+e+"/rename",s={success:function(e){J.dialogutil.close("documentrenamedialog");var t=i.getViewIndex(e.RID),o=i.getView(t);o.DOCUMENT_NAME=e.NAME,o.DOCUMENT_NAME_HTML=e.NAME_HTML,o.RENDERED=!1,i.updateView(o),i.updateDocNameInEle(o)},error:function(e){J.dialogutil.close("documentrenamedialog")}};n(o,r,a,s,!0)},openDocument:function(t,i){var r=e+t;o(r,i)},createNewBlankDocument:function(){var e=editor.getBaseURL()+"/new";o(e,"_blank"),Utils.addToStatistics("db_createNew")},editTemplate:function(e){var t=editor.getBaseURL()+"/template/"+e;o(t,"_self")},bindLoadEvent:function(e){e.find(".thumbnail-img").error(function(){J(this).unbind("error");var e=J(this).hide().removeAttr("src"),t=e.parent("#thumbnail-box");t.find(".thumbnail-def-img").show()}).load(function(){var e=J(this).show(),t=e.parent("#thumbnail-box");t.find(".thumbnail-def-img").hide()})},fileAction:function(e){var o=t.RESOURCE_ID;i[e](o,"_blank")},moreMenuBeforeShow:function(e,i){var o=J(i.currentTarget).parents(".document-view-item").attr("rid");if(!o)return!1;var r=this.getViewIndex(o);if(r==-1)return!1;var n=this.getView(r);t=n;var a=J("#more-list-menu");return a.zmenu("showAllMenuItems"),"COOWNER"!=n.ROLE&&"OWNER"!=n.ROLE&&a.zmenu("hideMenuItems",["more-opt-resource-delete","more-opt-resource-rename"]),2004!=n.RESOURCE_TYPE||(a.zmenu("hideMenuItem","more-opt-resource-open"),!1)},updateView:function(e,t){for(var i="string"==typeof e?e:e.RESOURCE_ID,o=CategoryViews.views,n=o.length,a=0;a<n;a++){var l=o[a],s=l[Object.keys(l)[0]],d=s.DOCUMENTS;if(d)for(var c=0;c<d.length;c++){var p=d[c];if(p.RESOURCE_ID==i){"delete"==t?(p.el.remove(),d.splice(c,1)):d[c]=e,s.RENDERED=!1,CategoryViews.updateView(s);break}}}e.NEED_RATINGS&&r(e)},updateDocNameInEle:function(e){var t=e.el.find(".doc-name-placeholer");t["INPUT"==t.tagName?"val":"text"](Utils.unescapeHTML(e.DOCUMENT_NAME_HTML))}},o=function(e,t){var i=editor.doc.getDocInfo(),o=editor.doc.getRole();t||(!i||1==i.VERSION&&0==i.REVISION&&i.newDoc||o==USER_ROLE.TEMPLATE_USER||o==USER_ROLE.REMOTE_PUBLIC_USER)&&(t="_self"),ListingView.showLoadingMessage(),Utils.safeWindowOpen(decodeURI(e),{},"_blank"),"_self"!=t&&(window.isOutSideEditor||ListingView.closeWindow(),ListingView.hideLoadingMessage())},r=function(e){e.WHOLE_RATING?e.el.find("#"+e.VIEW_ID+"-star"+e.WHOLE_RATING).prop("checked",!0):e.el.find("input[type='radio']").prop("checked",!1)},n=function(e,t,i,o,r){e||(e={}),r&&setCsrfParam(e),J.ajax({type:"POST",data:e,async:t,global:!1,dataType:"json",url:Utils.getNiceUrlPrefix(i),error:function(e){o.error(e)},success:function(e){o.success(e)}})},a=function(e){J(e.el).find(".doc-name-placeholer").select().focus()},l={name:"",rid:"",newName:"",init:function(e){J("#rename-progressButton").button({icons:{primary:"ui-icon-loader-small-1"}}).addClass("ui-state-disabled").hide(),setTimeout(function(){e.find("input:first").select().focus()},1)},get:function(e){if("rename"==e)return this.name},set:function(e,t,o){"rename"==e.action&&(this.newName=t,UIUtils.enterKey(J(o),i.rename))},showProgress:function(){J("#rename-progressButton").show(),J("#rename-save-btn").hide()}};return i}(),PreviewView=function(){var e={success:{message:"writer.common.RATING_SUCCESS_MSG",icon:"ui-icon-checked-sm"},failure:{message:"writer.common.RATING_FAILURE_MSG",icon:"ui-icon-error-sm"}},t={currentView:void 0,currentViewIdx:0,initialize:function(){this.el=J("#document-preview-container"),this.usethisBtn=this.el.find(".template-preview-usethis-btn"),J("#document-preview-container").on("keydown",this.keyEventHandler),this.image=J("#preview-image-large"),this.image.load(this.load),J(".preview-close-btn").on("click",this.close),J(".ui-temp-preview-prev").on("click",function(e){t.previous(),e.stopPropagation(),e.preventDefault()}),J(".ui-temp-preview-next").on("click",function(e){t.next(),e.stopPropagation(),e.preventDefault()}),J(".rating-container").find("input[type='radio']").on("change",function(){if("-1"==editor.zuid)return void ListingView.openSignupPopup();var e=this.value;t.currentView.USER_RATING=e;var i=t.currentView,o=Utils.getNiceUrlPrefix("template/"+i.RESOURCE_ID+"/rating");J("#rating-user-stars").addClass("ui-state-disabled ui-pevents-none");var r={data:t.currentView,success:function(e){J("#rating-user-stars").removeClass("ui-state-disabled ui-pevents-none");var i=e.COUNT;t.showRatingStatusMsg("success"),t.currentView.WHOLE_RATING=i,ThumbnailView.updateView(this.data),t.updateWholeReview(i),Utils.addToStatistics("tmp_ratings")},error:function(e){t.showRatingStatusMsg("failure"),J("#rating-user-stars").removeClass("ui-state-disabled ui-pevents-none").find("input[type='radio']").prop("checked",!1)}},n={rating:e};setCsrfParam(n),J.ajax({type:"POST",data:n,async:!0,global:!1,dataType:"json",url:o,error:function(e){r.error(e)},success:function(e){r.success(e)}})})},keyEventHandler:function(e){var i=e.keyCode||e.which;27==i?t.close():39==i?t.next():37==i&&t.previous(),e.preventDefault(),e.stopPropagation()},showRatingStatusMsg:function(t){J("#rating-message").show().find("p").html(J.i18n(e[t].message)).end().find("span").removeClass("ui-icon-checked-sm ui-icon-error-sm").addClass(e[t].icon).end().fadeIn(function(){setTimeout(function(){J("#rating-message").fadeOut()},1e3)})},show:function(e,i){this.updateView(e),J("#document-preview-container").fadeIn(300,function(){J(this).focus()}),this.usethisBtn.off("click").on("click",function(e){e.metaKey||e.ctrlKey;i(t.currentView,"_blank")})},close:function(){J("#document-preview-container").fadeOut(300,function(){J("#home-views-container").focus()})},next:function(){var e=ThumbnailView.getNextView();this.updateView(e)},previous:function(){var e=ThumbnailView.getPreviousView();this.updateView(e)},updateView:function(e){if(J("#rating-message").hide(),e&&e.RESOURCE_TYPE==ListingView.resources_type.TEMPLATES){J(".preview-result-container").hide(),J("#default-preview-loader").show(),this.currentViewIdx=e.index,this.currentView=e;var t=window.location.protocol+"//"+e.PREVIEW_URL;this.image.attr("src","").attr("src",t),this.image.bind("error",this.error);var i=J("<textarea />");J("#preview-document-name-placeholder").text(i.html(e.DOCUMENT_NAME_HTML).text()),J("#preview-category-name").text(i.html(e.ORG_CATEGORY_HTML||e.CATEGORY_NAME_HTML).text()),e.DOWNLOAD_COUNT?(J("#use-count-container").show(),J("#use-count-box").text(e.DOWNLOAD_COUNT)):J("#use-count-container").hide(),J("#template-preview-description-cont").text(e.DESCRIPTION||""),e.USER_RATING?J("#rating-user-stars").find("#star"+e.USER_RATING).prop("checked",!0):J("#rating-user-stars").find("input[type='radio']").prop("checked",!1),e.WHOLE_RATING?J("#rating-overall-stars").find("#public-star"+e.WHOLE_RATING).prop("checked",!0):J("#rating-overall-stars").find("input[type='radio']").prop("checked",!1)}},updateWholeReview:function(e){J("#rating-overall-stars").find("#public-star"+e).prop("checked",!0)},error:function(){J("#default-preview-loader").hide(),J(this).unbind("error").attr("src",""),J("#preview-image-box").show()},load:function(){J("#default-preview-loader").hide(),J("#preview-image-box").show()}};return t}(),"undefined"==typeof PDFJS&&(("undefined"!=typeof window?window:this).PDFJS={}),function(){function e(e,t){return new i(this.slice(e,t))}function t(e,t){arguments.length<2&&(t=0);for(var i=0,o=e.length;i<o;++i,++t)this[t]=255&e[i]}function i(i){var o,r,n;if("number"==typeof i)for(o=[],r=0;r<i;++r)o[r]=0;else if("slice"in i)o=i.slice(0);else for(o=[],r=0,n=i.length;r<n;++r)o[r]=i[r];return o.subarray=e,o.buffer=o,o.byteLength=o.length,o.set=t,"object"==typeof i&&i.buffer&&(o.buffer=i.buffer),o}return"undefined"!=typeof Uint8Array?("undefined"==typeof Uint8Array.prototype.subarray&&(Uint8Array.prototype.subarray=function(e,t){return new Uint8Array(this.slice(e,t))},Float32Array.prototype.subarray=function(e,t){return new Float32Array(this.slice(e,t))}),void("undefined"==typeof Float64Array&&(window.Float64Array=Float32Array))):(window.Uint8Array=i,window.Int8Array=i,window.Uint32Array=i,window.Int32Array=i,window.Uint16Array=i,window.Float32Array=i,void(window.Float64Array=i))}(),function(){window.URL||(window.URL=window.webkitURL)}(),function(){if("undefined"!=typeof Object.defineProperty){var e=!0;try{Object.defineProperty(new Image,"id",{value:"test"});var t=function(){};t.prototype={get id(){}},Object.defineProperty(new t,"id",{value:"",configurable:!0,enumerable:!0,writable:!1})}catch(t){e=!1}if(e)return}Object.defineProperty=function(e,t,i){delete e[t],"get"in i&&e.__defineGetter__(t,i.get),"set"in i&&e.__defineSetter__(t,i.set),"value"in i&&(e.__defineSetter__(t,function(e){return this.__defineGetter__(t,function(){return e}),e}),e[t]=i.value)}}(),function(){var e=XMLHttpRequest.prototype,t=new XMLHttpRequest;if("overrideMimeType"in t||Object.defineProperty(e,"overrideMimeType",{value:function(e){}}),!("responseType"in t))return PDFJS.disableWorker=!0,Object.defineProperty(e,"responseType",{get:function(){return this._responseType||"text"},set:function(e){"text"!==e&&"arraybuffer"!==e||(this._responseType=e,"arraybuffer"===e&&"function"==typeof this.overrideMimeType&&this.overrideMimeType("text/plain; charset=x-user-defined"))}}),"undefined"!=typeof VBArray?void Object.defineProperty(e,"response",{get:function(){return"arraybuffer"===this.responseType?new Uint8Array(new VBArray(this.responseBody).toArray()):this.responseText}}):void Object.defineProperty(e,"response",{get:function(){if("arraybuffer"!==this.responseType)return this.responseText;var e,t=this.responseText,i=t.length,o=new Uint8Array(i);for(e=0;e<i;++e)o[e]=255&t.charCodeAt(e);return o.buffer}})}(),function(){if(!("btoa"in window)){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";window.btoa=function(t){var i,o,r="";for(i=0,o=t.length;i<o;i+=3){var n=255&t.charCodeAt(i),a=255&t.charCodeAt(i+1),l=255&t.charCodeAt(i+2),s=n>>2,d=(3&n)<<4|a>>4,c=i+1<o?(15&a)<<2|l>>6:64,p=i+2<o?63&l:64;r+=e.charAt(s)+e.charAt(d)+e.charAt(c)+e.charAt(p)}return r}}}(),function(){if(!("atob"in window)){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";window.atob=function(t){if(t=t.replace(/=+$/,""),t.length%4===1)throw new Error("bad atob input");for(var i,o,r=0,n=0,a="";o=t.charAt(n++);~o&&(i=r%4?64*i+o:o,r++%4)?a+=String.fromCharCode(255&i>>(-2*r&6)):0)o=e.indexOf(o);return a}}}(),function(){"undefined"==typeof Function.prototype.bind&&(Function.prototype.bind=function(e){var t=this,i=Array.prototype.slice.call(arguments,1),o=function(){var o=i.concat(Array.prototype.slice.call(arguments));return t.apply(e,o)};return o})}(),function(){var e=document.createElement("div");"dataset"in e||Object.defineProperty(HTMLElement.prototype,"dataset",{get:function(){if(this._dataset)return this._dataset;for(var e={},t=0,i=this.attributes.length;t<i;t++){var o=this.attributes[t];if("data-"===o.name.substring(0,5)){var r=o.name.substring(5).replace(/\-([a-z])/g,function(e,t){return t.toUpperCase()});e[r]=o.value}}return Object.defineProperty(this,"_dataset",{value:e,writable:!1,enumerable:!1}),e},enumerable:!0})}(),function(){function e(e,t,i,o){var r=e.className||"",n=r.split(/\s+/g);""===n[0]&&n.shift();var a=n.indexOf(t);return a<0&&i&&n.push(t),a>=0&&o&&n.splice(a,1),e.className=n.join(" "),a>=0}var t=document.createElement("div");if(!("classList"in t)){var i={add:function(t){e(this.element,t,!0,!1)},contains:function(t){return e(this.element,t,!1,!1)},remove:function(t){e(this.element,t,!1,!0)},toggle:function(t){e(this.element,t,!0,!0)}};Object.defineProperty(HTMLElement.prototype,"classList",{get:function(){if(this._classList)return this._classList;var e=Object.create(i,{element:{value:this,writable:!1,enumerable:!0}});return Object.defineProperty(this,"_classList",{value:e,writable:!1,enumerable:!1}),e},enumerable:!0})}}(),function(){"console"in window?"bind"in console.log||(console.log=function(e){return function(t){return e(t)}}(console.log),console.error=function(e){return function(t){return e(t)}}(console.error),console.warn=function(e){return function(t){return e(t)}}(console.warn)):window.console={log:function(){},error:function(){},warn:function(){}}}(),function(){function e(e){t(e.target)&&e.stopPropagation()}function t(e){return e.disabled||e.parentNode&&t(e.parentNode)}navigator.userAgent.indexOf("Opera")!==-1&&document.addEventListener("click",e,!0)}(),function(){navigator.userAgent.indexOf("Trident")>=0&&(PDFJS.disableCreateObjectURL=!0);}(),function(){"language"in navigator||(PDFJS.locale=navigator.userLanguage||"en-US")}(),function(){var e=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,t=/Android\s[0-2][^\d]/,i=t.test(navigator.userAgent),o=/Chrome\/(39|40)\./.test(navigator.userAgent);(e||i||o)&&(PDFJS.disableRange=!0,PDFJS.disableStream=!0)}(),function(){(!history.pushState||navigator.userAgent.indexOf("Android 2.")>=0)&&(PDFJS.disableHistory=!0)}(),function(){if(window.CanvasPixelArray)"function"!=typeof window.CanvasPixelArray.prototype.set&&(window.CanvasPixelArray.prototype.set=function(e){for(var t=0,i=this.length;t<i;t++)this[t]=e[t]});else{var e,t=!1;if(navigator.userAgent.indexOf("Chrom")>=0?(e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./),t=e&&parseInt(e[2])<21):navigator.userAgent.indexOf("Android")>=0?t=/Android\s[0-4][^\d]/g.test(navigator.userAgent):navigator.userAgent.indexOf("Safari")>=0&&(e=navigator.userAgent.match(/Version\/([0-9]+)\.([0-9]+)\.([0-9]+) Safari\//),t=e&&parseInt(e[1])<6),t){var i=window.CanvasRenderingContext2D.prototype;i._createImageData=i.createImageData,i.createImageData=function(e,t){var i=this._createImageData(e,t);return i.data.set=function(e){for(var t=0,i=this.length;t<i;t++)this[t]=e[t]},i}}}}(),function(){function e(e){window.setTimeout(e,20)}var t=/(iPad|iPhone|iPod)/g.test(navigator.userAgent);return t?void(window.requestAnimationFrame=e):void("requestAnimationFrame"in window||(window.requestAnimationFrame=window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||e))}(),function(){var e=/(iPad|iPhone|iPod)/g.test(navigator.userAgent),t=/Android/g.test(navigator.userAgent);(e||t)&&(PDFJS.maxCanvasPixels=5242880)}(),function(){var e=navigator.userAgent.indexOf("Trident")>=0&&window.parent!==window;e&&(PDFJS.disableFullscreen=!0)}(),"undefined"==typeof PDFJS&&(("undefined"!=typeof window?window:this).PDFJS={}),PDFJS.version="1.1.215",PDFJS.build="c9a7498",function(){"use strict";function e(e){PDFJS.verbosity>=PDFJS.VERBOSITY_LEVELS.infos&&console.log("Info: "+e)}function t(e){PDFJS.verbosity>=PDFJS.VERBOSITY_LEVELS.warnings&&console.log("Warning: "+e)}function i(e){throw PDFJS.verbosity>=PDFJS.VERBOSITY_LEVELS.errors&&(console.log("Error: "+e),console.log(o())),N.notify(_.unknown),new Error(e)}function o(){try{throw new Error}catch(e){return e.stack?e.stack.split("\n").slice(2).join("\n"):""}}function r(e,t){e||i(t)}function n(e,t){if(!t)return e;if(/^[a-z][a-z0-9+\-.]*:/i.test(t))return t;var i;if("/"===t.charAt(0))return i=e.indexOf("://"),"/"===t.charAt(1)?++i:i=e.indexOf("/",i+3),e.substring(0,i)+t;var o=e.length;i=e.lastIndexOf("#"),o=i>=0?i:o,i=e.lastIndexOf("?",o),o=i>=0?i:o;var r=e.lastIndexOf("/",o);return e.substring(0,r+1)+t}function a(e,t){if(!e)return!1;var i=/^[a-z][a-z0-9+\-.]*(?=:)/i.exec(e);if(!i)return t;switch(i=i[0].toLowerCase()){case"http":case"https":case"ftp":case"mailto":case"tel":return!0;default:return!1}}function l(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!1}),i}function s(e){r(null!==e&&"object"==typeof e&&void 0!==e.length,"Invalid argument for bytesToString");var t=e.length,i=8192;if(t<i)return String.fromCharCode.apply(null,e);for(var o=[],n=0;n<t;n+=i){var a=Math.min(n+i,t),l=e.subarray(n,a);o.push(String.fromCharCode.apply(null,l))}return o.join("")}function d(e){r("string"==typeof e,"Invalid argument for stringToBytes");for(var t=e.length,i=new Uint8Array(t),o=0;o<t;++o)i[o]=255&e.charCodeAt(o);return i}function c(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function p(){var e=new Uint8Array(2);e[0]=1;var t=new Uint16Array(e.buffer);return 1===t[0]}function u(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d"),i=t.createImageData(1,1);return"undefined"!=typeof i.data.buffer}function f(e){return"number"==typeof e}function g(e){return e instanceof Array}function m(e){return"object"==typeof e&&null!==e&&void 0!==e.byteLength}function h(){var e={};return e.promise=new Promise(function(t,i){e.resolve=t,e.reject=i}),e}function T(e,t){this.name=e,this.comObj=t,this.callbackIndex=1,this.postMessageTransfers=!0;var o=this.callbacksCapabilities={},r=this.actionHandler={};r.console_log=[function(e){console.log.apply(console,e)}],r.console_error=[function(e){console.error.apply(console,e)}],r._unsupported_feature=[function(e){N.notify(e)}],t.onmessage=function(e){var n=e.data;if(n.isReply){var a=n.callbackId;if(n.callbackId in o){var l=o[a];delete o[a],"error"in n?l.reject(n.error):l.resolve(n.data)}else i("Cannot resolve callback "+a)}else if(n.action in r){var s=r[n.action];n.callbackId?Promise.resolve().then(function(){return s[0].call(s[1],n.data)}).then(function(e){t.postMessage({isReply:!0,callbackId:n.callbackId,data:e})},function(e){t.postMessage({isReply:!0,callbackId:n.callbackId,error:e})}):s[0].call(s[1],n.data)}else i("Unknown action from worker: "+n.action)}}function E(e,i,o){var r=new Image;r.onload=function(){o.resolve(e,r)},r.onerror=function(){o.resolve(e,null),t("Error during JPEG image loading")},r.src=i}function R(e,t){var i=document.createElement("canvas");return i.width=e,i.height=t,i}function S(e){e.mozCurrentTransform||(e._originalSave=e.save,e._originalRestore=e.restore,e._originalRotate=e.rotate,e._originalScale=e.scale,e._originalTranslate=e.translate,e._originalTransform=e.transform,e._originalSetTransform=e.setTransform,e._transformMatrix=e._transformMatrix||[1,0,0,1,0,0],e._transformStack=[],Object.defineProperty(e,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(e,"mozCurrentTransformInverse",{get:function(){var e=this._transformMatrix,t=e[0],i=e[1],o=e[2],r=e[3],n=e[4],a=e[5],l=t*r-i*o,s=i*o-t*r;return[r/l,i/s,o/s,t/l,(r*n-o*a)/s,(i*n-t*a)/l]}}),e.save=function(){var e=this._transformMatrix;this._transformStack.push(e),this._transformMatrix=e.slice(0,6),this._originalSave()},e.restore=function(){var e=this._transformStack.pop();e&&(this._transformMatrix=e,this._originalRestore())},e.translate=function(e,t){var i=this._transformMatrix;i[4]=i[0]*e+i[2]*t+i[4],i[5]=i[1]*e+i[3]*t+i[5],this._originalTranslate(e,t)},e.scale=function(e,t){var i=this._transformMatrix;i[0]=i[0]*e,i[1]=i[1]*e,i[2]=i[2]*t,i[3]=i[3]*t,this._originalScale(e,t)},e.transform=function(t,i,o,r,n,a){var l=this._transformMatrix;this._transformMatrix=[l[0]*t+l[2]*i,l[1]*t+l[3]*i,l[0]*o+l[2]*r,l[1]*o+l[3]*r,l[0]*n+l[2]*a+l[4],l[1]*n+l[3]*a+l[5]],e._originalTransform(t,i,o,r,n,a)},e.setTransform=function(t,i,o,r,n,a){this._transformMatrix=[t,i,o,r,n,a],e._originalSetTransform(t,i,o,r,n,a)},e.rotate=function(e){var t=Math.cos(e),i=Math.sin(e),o=this._transformMatrix;this._transformMatrix=[o[0]*t+o[2]*i,o[1]*t+o[3]*i,o[0]*-i+o[2]*t,o[1]*-i+o[3]*t,o[4],o[5]],this._originalRotate(e)})}function O(e){var t,i,o,r,n=1e3,a=e.width,l=e.height,s=a+1,d=new Uint8Array(s*(l+1)),c=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),p=a+7&-8,u=e.data,f=new Uint8Array(p*l),g=0;for(t=0,r=u.length;t<r;t++)for(var m=128,h=u[t];m>0;)f[g++]=h&m?0:255,m>>=1;var T=0;for(g=0,0!==f[g]&&(d[0]=1,++T),i=1;i<a;i++)f[g]!==f[g+1]&&(d[i]=f[g]?2:1,++T),g++;for(0!==f[g]&&(d[i]=2,++T),t=1;t<l;t++){g=t*p,o=t*s,f[g-p]!==f[g]&&(d[o]=f[g]?1:8,++T);var E=(f[g]?4:0)+(f[g-p]?8:0);for(i=1;i<a;i++)E=(E>>2)+(f[g+1]?4:0)+(f[g-p+1]?8:0),c[E]&&(d[o+i]=c[E],++T),g++;if(f[g-p]!==f[g]&&(d[o+i]=f[g]?2:4,++T),T>n)return null}for(g=p*(l-1),o=t*s,0!==f[g]&&(d[o]=8,++T),i=1;i<a;i++)f[g]!==f[g+1]&&(d[o+i]=f[g]?4:8,++T),g++;if(0!==f[g]&&(d[o+i]=4,++T),T>n)return null;var R=new Int32Array([0,s,-1,0,-s,0,0,0,1]),S=[];for(t=0;T&&t<=l;t++){for(var O=t*s,v=O+a;O<v&&!d[O];)O++;if(O!==v){var b,A=[O%s,t],y=d[O],D=O;do{var C=R[y];do O+=C;while(!d[O]);b=d[O],5!==b&&10!==b?(y=b,d[O]=0):(y=b&51*y>>4,d[O]&=y>>2|y<<2),A.push(O%s),A.push(O/s|0),--T}while(D!==O);S.push(A),--t}}var I=function(e){e.save(),e.scale(1/a,-1/l),e.translate(0,-l),e.beginPath();for(var t=0,i=S.length;t<i;t++){var o=S[t];e.moveTo(o[0],o[1]);for(var r=2,n=o.length;r<n;r+=2)e.lineTo(o[r],o[r+1])}e.fill(),e.beginPath(),e.restore()};return I}function v(e){var t=le[e[0]];return t||i("Unknown IR type: "+e[0]),t.fromIR(e)}var b="undefined"==typeof window?this:window,A="undefined"==typeof window,y=[.001,0,0,.001,0,0],D={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},C={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},I={WIDGET:1,TEXT:2,LINK:3};b.PDFJS||(b.PDFJS={}),b.PDFJS.pdfBug=!1,PDFJS.VERBOSITY_LEVELS={errors:0,warnings:1,infos:5};var P=PDFJS.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},_=PDFJS.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font"},N=PDFJS.UnsupportedManager=function(){var e=[];return{listen:function(t){e.push(t)},notify:function(i){t('Unsupported feature "'+i+'"');for(var o=0,r=e.length;o<r;o++)e[o](i)}}}();PDFJS.isValidUrl=a,PDFJS.shadow=l;var L=PDFJS.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},w=function(){function e(e,t){this.name="PasswordException",this.message=e,this.code=t}return e.prototype=new Error,e.constructor=e,e}();PDFJS.PasswordException=w;var M=function(){function e(e,t){this.name="UnknownErrorException",this.message=e,this.details=t}return e.prototype=new Error,e.constructor=e,e}();PDFJS.UnknownErrorException=M;var U=function(){function e(e){this.name="InvalidPDFException",this.message=e}return e.prototype=new Error,e.constructor=e,e}();PDFJS.InvalidPDFException=U;var x=function(){function e(e){this.name="MissingPDFException",this.message=e}return e.prototype=new Error,e.constructor=e,e}();PDFJS.MissingPDFException=x;var F=function(){function e(e,t){this.name="UnexpectedResponseException",this.message=e,this.status=t}return e.prototype=new Error,e.constructor=e,e}();PDFJS.UnexpectedResponseException=F;(function(){function e(e){this.message=e}return e.prototype=new Error,e.prototype.name="NotImplementedException",e.constructor=e,e})(),function(){function e(e,t){this.begin=e,this.end=t,this.message="Missing data ["+e+", "+t+")"}return e.prototype=new Error,e.prototype.name="MissingDataException",e.constructor=e,e}(),function(){function e(e){this.message=e}return e.prototype=new Error,e.prototype.name="XRefParseException",e.constructor=e,e}();Object.defineProperty(PDFJS,"isLittleEndian",{configurable:!0,get:function(){return l(PDFJS,"isLittleEndian",p())}}),Object.defineProperty(PDFJS,"hasCanvasTypedArrays",{configurable:!0,get:function(){return l(PDFJS,"hasCanvasTypedArrays",u())}});var k=function(){function e(e,t){this.buffer=e,this.byteLength=e.length,this.length=void 0===t?this.byteLength>>2:t,i(this.length)}function t(e){return{get:function(){var t=this.buffer,i=e<<2;return(t[i]|t[i+1]<<8|t[i+2]<<16|t[i+3]<<24)>>>0},set:function(t){var i=this.buffer,o=e<<2;i[o]=255&t,i[o+1]=t>>8&255,i[o+2]=t>>16&255,i[o+3]=t>>>24&255}}}function i(i){for(;o<i;)Object.defineProperty(e.prototype,o,t(o)),o++}e.prototype=Object.create(null);var o=0;return e}(),B=[1,0,0,1,0,0],J=PDFJS.Util=function(){function e(){}var t=["rgb(",0,",",0,",",0,")"];return e.makeCssRgb=function(e,i,o){return t[1]=e,t[3]=i,t[5]=o,t.join("")},e.transform=function(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},e.applyTransform=function(e,t){var i=e[0]*t[0]+e[1]*t[2]+t[4],o=e[0]*t[1]+e[1]*t[3]+t[5];return[i,o]},e.applyInverseTransform=function(e,t){var i=t[0]*t[3]-t[1]*t[2],o=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/i,r=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/i;return[o,r]},e.getAxialAlignedBoundingBox=function(t,i){var o=e.applyTransform(t,i),r=e.applyTransform(t.slice(2,4),i),n=e.applyTransform([t[0],t[3]],i),a=e.applyTransform([t[2],t[1]],i);return[Math.min(o[0],r[0],n[0],a[0]),Math.min(o[1],r[1],n[1],a[1]),Math.max(o[0],r[0],n[0],a[0]),Math.max(o[1],r[1],n[1],a[1])]},e.inverseTransform=function(e){var t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]},e.apply3dTransform=function(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[3]*t[0]+e[4]*t[1]+e[5]*t[2],e[6]*t[0]+e[7]*t[1]+e[8]*t[2]]},e.singularValueDecompose2dScale=function(e){var t=[e[0],e[2],e[1],e[3]],i=e[0]*t[0]+e[1]*t[2],o=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],n=e[2]*t[1]+e[3]*t[3],a=(i+n)/2,l=Math.sqrt((i+n)*(i+n)-4*(i*n-r*o))/2,s=a+l||1,d=a-l||1;return[Math.sqrt(s),Math.sqrt(d)]},e.normalizeRect=function(e){var t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t},e.intersect=function(t,i){function o(e,t){return e-t}var r=[t[0],t[2],i[0],i[2]].sort(o),n=[t[1],t[3],i[1],i[3]].sort(o),a=[];return t=e.normalizeRect(t),i=e.normalizeRect(i),(r[0]===t[0]&&r[1]===i[0]||r[0]===i[0]&&r[1]===t[0])&&(a[0]=r[1],a[2]=r[2],(n[0]===t[1]&&n[1]===i[1]||n[0]===i[1]&&n[1]===t[1])&&(a[1]=n[1],a[3]=n[2],a))},e.sign=function(e){return e<0?-1:1},e.appendToArray=function(e,t){Array.prototype.push.apply(e,t)},e.prependToArray=function(e,t){Array.prototype.unshift.apply(e,t)},e.extendObj=function(e,t){for(var i in t)e[i]=t[i]},e.getInheritableProperty=function(e,t){for(;e&&!e.has(t);)e=e.get("Parent");return e?e.get(t):null},e.inherit=function(e,t,i){e.prototype=Object.create(t.prototype),e.prototype.constructor=e;for(var o in i)e.prototype[o]=i[o]},e.loadScript=function(e,t){var i=document.createElement("script"),o=!1;i.setAttribute("src",e),t&&(i.onload=function(){o||t(),o=!0}),document.getElementsByTagName("head")[0].appendChild(i)},e}();PDFJS.PageViewport=function(){function e(e,t,i,o,r,n){this.viewBox=e,this.scale=t,this.rotation=i,this.offsetX=o,this.offsetY=r;var a,l,s,d,c=(e[2]+e[0])/2,p=(e[3]+e[1])/2;switch(i%=360,i=i<0?i+360:i){case 180:a=-1,l=0,s=0,d=1;break;case 90:a=0,l=1,s=1,d=0;break;case 270:a=0,l=-1,s=-1,d=0;break;default:a=1,l=0,s=0,d=-1}n&&(s=-s,d=-d);var u,f,g,m;0===a?(u=Math.abs(p-e[1])*t+o,f=Math.abs(c-e[0])*t+r,g=Math.abs(e[3]-e[1])*t,m=Math.abs(e[2]-e[0])*t):(u=Math.abs(c-e[0])*t+o,f=Math.abs(p-e[1])*t+r,g=Math.abs(e[2]-e[0])*t,m=Math.abs(e[3]-e[1])*t),this.transform=[a*t,l*t,s*t,d*t,u-a*t*c-s*t*p,f-l*t*c-d*t*p],this.width=g,this.height=m,this.fontScale=t}return e.prototype={clone:function(t){t=t||{};var i="scale"in t?t.scale:this.scale,o="rotation"in t?t.rotation:this.rotation;return new e(this.viewBox.slice(),i,o,this.offsetX,this.offsetY,t.dontFlip)},convertToViewportPoint:function(e,t){return J.applyTransform([e,t],this.transform)},convertToViewportRectangle:function(e){var t=J.applyTransform([e[0],e[1]],this.transform),i=J.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],i[0],i[1]]},convertToPdfPoint:function(e,t){return J.applyInverseTransform([e,t],this.transform)}},e}();PDFJS.createPromiseCapability=h,function(){function e(e){this._status=i,this._handlers=[];try{e.call(this,this._resolve.bind(this),this._reject.bind(this))}catch(e){this._reject(e)}}if(b.Promise)return"function"!=typeof b.Promise.all&&(b.Promise.all=function(e){var t,i,o=0,r=[],n=new b.Promise(function(e,o){t=e,i=o});return e.forEach(function(e,n){o++,e.then(function(e){r[n]=e,o--,0===o&&t(r)},i)}),0===o&&t(r),n}),"function"!=typeof b.Promise.resolve&&(b.Promise.resolve=function(e){return new b.Promise(function(t){t(e)})}),"function"!=typeof b.Promise.reject&&(b.Promise.reject=function(e){return new b.Promise(function(t,i){i(e)})}),void("function"!=typeof b.Promise.prototype.catch&&(b.Promise.prototype.catch=function(e){return b.Promise.prototype.then(void 0,e)}));var i=0,o=1,r=2,n=500,a={handlers:[],running:!1,unhandledRejections:[],pendingRejectionCheck:!1,scheduleHandlers:function(e){e._status!==i&&(this.handlers=this.handlers.concat(e._handlers),e._handlers=[],this.running||(this.running=!0,setTimeout(this.runHandlers.bind(this),0)))},runHandlers:function(){for(var e=1,t=Date.now()+e;this.handlers.length>0;){var i=this.handlers.shift(),n=i.thisPromise._status,a=i.thisPromise._value;try{n===o?"function"==typeof i.onResolve&&(a=i.onResolve(a)):"function"==typeof i.onReject&&(a=i.onReject(a),n=o,i.thisPromise._unhandledRejection&&this.removeUnhandeledRejection(i.thisPromise))}catch(e){n=r,a=e}if(i.nextPromise._updateStatus(n,a),Date.now()>=t)break}return this.handlers.length>0?void setTimeout(this.runHandlers.bind(this),0):void(this.running=!1)},addUnhandledRejection:function(e){this.unhandledRejections.push({promise:e,time:Date.now()}),this.scheduleRejectionCheck()},removeUnhandeledRejection:function(e){e._unhandledRejection=!1;for(var t=0;t<this.unhandledRejections.length;t++)this.unhandledRejections[t].promise===e&&(this.unhandledRejections.splice(t),t--)},scheduleRejectionCheck:function(){this.pendingRejectionCheck||(this.pendingRejectionCheck=!0,setTimeout(function(){this.pendingRejectionCheck=!1;for(var e=Date.now(),i=0;i<this.unhandledRejections.length;i++)if(e-this.unhandledRejections[i].time>n){var o=this.unhandledRejections[i].promise._value,r="Unhandled rejection: "+o;o.stack&&(r+="\n"+o.stack),t(r),this.unhandledRejections.splice(i),i--}this.unhandledRejections.length&&this.scheduleRejectionCheck()}.bind(this),n))}};e.all=function(t){function i(e){a._status!==r&&(s=[],n(e))}var o,n,a=new e(function(e,t){o=e,n=t}),l=t.length,s=[];if(0===l)return o(s),a;for(var d=0,c=t.length;d<c;++d){var p=t[d],u=function(e){return function(t){a._status!==r&&(s[e]=t,l--,0===l&&o(s))}}(d);e.isPromise(p)?p.then(u,i):u(p)}return a},e.isPromise=function(e){return e&&"function"==typeof e.then},e.resolve=function(t){return new e(function(e){e(t)})},e.reject=function(t){return new e(function(e,i){i(t)})},e.prototype={_status:null,_value:null,_handlers:null,_unhandledRejection:null,_updateStatus:function(t,i){if(this._status!==o&&this._status!==r){if(t===o&&e.isPromise(i))return void i.then(this._updateStatus.bind(this,o),this._updateStatus.bind(this,r));this._status=t,this._value=i,t===r&&0===this._handlers.length&&(this._unhandledRejection=!0,a.addUnhandledRejection(this)),a.scheduleHandlers(this)}},_resolve:function(e){this._updateStatus(o,e)},_reject:function(e){this._updateStatus(r,e)},then:function(t,i){var o=new e(function(e,t){this.resolve=e,this.reject=t});return this._handlers.push({thisPromise:this,onResolve:t,onReject:i,nextPromise:o}),a.scheduleHandlers(this),o},catch:function(e){return this.then(void 0,e)}},b.Promise=e}();var H=function(){function e(e,t,i){for(;e.length<i;)e+=t;return e}function i(){this.started={},this.times=[],this.enabled=!0}return i.prototype={time:function(e){this.enabled&&(e in this.started&&t("Timer is already running for "+e),this.started[e]=Date.now())},timeEnd:function(e){this.enabled&&(e in this.started||t("Timer has not been started for "+e),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e])},toString:function(){var t,i,o=this.times,r="",n=0;for(t=0,i=o.length;t<i;++t){var a=o[t].name;a.length>n&&(n=a.length)}for(t=0,i=o.length;t<i;++t){var l=o[t],s=l.end-l.start;r+=e(l.name," ",n)+" "+s+"ms\n"}return r}},i}();PDFJS.createBlob=function(e,t){if("undefined"!=typeof Blob)return new Blob([e],{type:t});var i=new MozBlobBuilder;return i.append(e),i.getBlob(t)},PDFJS.createObjectURL=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return function(t,i){if(!PDFJS.disableCreateObjectURL&&"undefined"!=typeof URL&&URL.createObjectURL){var o=PDFJS.createBlob(t,i);return URL.createObjectURL(o)}for(var r="data:"+i+";base64,",n=0,a=t.length;n<a;n+=3){var l=255&t[n],s=255&t[n+1],d=255&t[n+2],c=l>>2,p=(3&l)<<4|s>>4,u=n+1<a?(15&s)<<2|d>>6:64,f=n+2<a?63&d:64;r+=e[c]+e[p]+e[u]+e[f]}return r}}(),T.prototype={on:function(e,t,o){var r=this.actionHandler;r[e]&&i('There is already an actionName called "'+e+'"'),r[e]=[t,o]},send:function(e,t,i){var o={action:e,data:t};this.postMessage(o,i)},sendWithPromise:function(e,t,i){var o=this.callbackIndex++,r={action:e,data:t,callbackId:o},n=h();this.callbacksCapabilities[o]=n;try{this.postMessage(r,i)}catch(e){n.reject(e)}return n.promise},postMessage:function(e,t){t&&this.postMessageTransfers?this.comObj.postMessage(e,t):this.comObj.postMessage(e)}},PDFJS.maxImageSize=void 0===PDFJS.maxImageSize?-1:PDFJS.maxImageSize,PDFJS.cMapUrl=void 0===PDFJS.cMapUrl?null:PDFJS.cMapUrl,PDFJS.cMapPacked=void 0!==PDFJS.cMapPacked&&PDFJS.cMapPacked,PDFJS.disableFontFace=void 0!==PDFJS.disableFontFace&&PDFJS.disableFontFace,PDFJS.imageResourcesPath=void 0===PDFJS.imageResourcesPath?"":PDFJS.imageResourcesPath,PDFJS.disableWorker=void 0!==PDFJS.disableWorker&&PDFJS.disableWorker,PDFJS.workerSrc=void 0===PDFJS.workerSrc?null:PDFJS.workerSrc,PDFJS.disableRange=void 0!==PDFJS.disableRange&&PDFJS.disableRange,PDFJS.disableStream=void 0!==PDFJS.disableStream&&PDFJS.disableStream,PDFJS.disableAutoFetch=void 0!==PDFJS.disableAutoFetch&&PDFJS.disableAutoFetch,PDFJS.pdfBug=void 0!==PDFJS.pdfBug&&PDFJS.pdfBug,PDFJS.postMessageTransfers=void 0===PDFJS.postMessageTransfers||PDFJS.postMessageTransfers,PDFJS.disableCreateObjectURL=void 0!==PDFJS.disableCreateObjectURL&&PDFJS.disableCreateObjectURL,PDFJS.disableWebGL=void 0===PDFJS.disableWebGL||PDFJS.disableWebGL,PDFJS.disableFullscreen=void 0!==PDFJS.disableFullscreen&&PDFJS.disableFullscreen,PDFJS.useOnlyCssZoom=void 0!==PDFJS.useOnlyCssZoom&&PDFJS.useOnlyCssZoom,PDFJS.verbosity=void 0===PDFJS.verbosity?PDFJS.VERBOSITY_LEVELS.warnings:PDFJS.verbosity,PDFJS.maxCanvasPixels=void 0===PDFJS.maxCanvasPixels?16777216:PDFJS.maxCanvasPixels,PDFJS.openExternalLinksInNewWindow=void 0!==PDFJS.openExternalLinksInNewWindow&&PDFJS.openExternalLinksInNewWindow,PDFJS.getDocument=function(e,t,o,r){var a=new G;t&&(t instanceof z||(t=Object.create(t),t.length=e.length,t.initialData=e.initialData),e=Object.create(e),e.range=t),a.onPassword=o||null,a.onProgress=r||null;var l,s,c;"string"==typeof e?c={url:e}:m(e)?c={data:e}:e instanceof z?c={range:e}:("object"!=typeof e&&i("Invalid parameter in getDocument, need either Uint8Array, string or a parameter object"),e.url||e.data||e.range||i("Invalid parameter object: need either .data, .range or .url"),c=e);var p={};for(var u in c)if("url"!==u||"undefined"==typeof window){if("range"!==u)if("data"!==u||c[u]instanceof Uint8Array)p[u]=c[u];else{var f=c[u];"string"==typeof f?p[u]=d(f):"object"!=typeof f||null===f||isNaN(f.length)?i("Invalid PDF binary data: either typed array, string or array-like object is expected in the data property."):p[u]=new Uint8Array(f)}}else p[u]=n(window.location.href,c[u]);return l=h(),s=new W(l,c.range),l.promise.then(function(){s.fetchDocument(a,p)}),a};var G=function(){function e(){this._capability=h(),this.onPassword=null,this.onProgress=null}return e.prototype={get promise(){return this._capability.promise},then:function(e,t){return this.promise.then.apply(this.promise,arguments)}},e}(),z=function(){function e(e,t){this.length=e,this.initialData=t,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._readyCapability=h()}return e.prototype={addRangeListener:function(e){this._rangeListeners.push(e)},addProgressListener:function(e){this._progressListeners.push(e)},addProgressiveReadListener:function(e){this._progressiveReadListeners.push(e)},onDataRange:function(e,t){for(var i=this._rangeListeners,o=0,r=i.length;o<r;++o)i[o](e,t)},onDataProgress:function(e){this._readyCapability.promise.then(function(){for(var t=this._progressListeners,i=0,o=t.length;i<o;++i)t[i](e)}.bind(this))},onDataProgressiveRead:function(e){this._readyCapability.promise.then(function(){for(var t=this._progressiveReadListeners,i=0,o=t.length;i<o;++i)t[i](e)}.bind(this))},transportReady:function(){this._readyCapability.resolve()},requestDataRange:function(e,t){throw new Error("Abstract method PDFDataRangeTransport.requestDataRange")}},e}();PDFJS.PDFDataRangeTransport=z;var V=function(){function e(e,t){this.pdfInfo=e,this.transport=t}return e.prototype={get numPages(){return this.pdfInfo.numPages},get fingerprint(){return this.pdfInfo.fingerprint},getPage:function(e){return this.transport.getPage(e)},getPageIndex:function(e){return this.transport.getPageIndex(e)},getDestinations:function(){return this.transport.getDestinations()},getDestination:function(e){return this.transport.getDestination(e)},getAttachments:function(){return this.transport.getAttachments()},getJavaScript:function(){return this.transport.getJavaScript()},getOutline:function(){return this.transport.getOutline()},getMetadata:function(){return this.transport.getMetadata()},getData:function(){return this.transport.getData()},getDownloadInfo:function(){return this.transport.downloadInfoCapability.promise},getStats:function(){return this.transport.getStats()},cleanup:function(){this.transport.startCleanup()},destroy:function(){this.transport.destroy()}},e}(),Y=function(){function e(e,t,i){this.pageIndex=e,this.pageInfo=t,this.transport=i,this.stats=new H,this.stats.enabled=!!b.PDFJS.enableStats,this.commonObjs=i.commonObjs,this.objs=new j,this.cleanupAfterRender=!1,this.pendingDestroy=!1,this.intentStates={}}return e.prototype={get pageNumber(){return this.pageIndex+1},get rotate(){return this.pageInfo.rotate},get ref(){return this.pageInfo.ref},get view(){return this.pageInfo.view},getViewport:function(e,t){return arguments.length<2&&(t=this.rotate),new PDFJS.PageViewport(this.view,e,t,0,0)},getAnnotations:function(){if(this.annotationsPromise)return this.annotationsPromise;var e=this.transport.getAnnotations(this.pageIndex);return this.annotationsPromise=e,e},render:function(e){function t(e){var t=r.renderTasks.indexOf(n);t>=0&&r.renderTasks.splice(t,1),l.cleanupAfterRender&&(l.pendingDestroy=!0),l._tryDestroy(),e?n.capability.reject(e):n.capability.resolve(),i.timeEnd("Rendering"),i.timeEnd("Overall")}var i=this.stats;i.time("Overall"),this.pendingDestroy=!1;var o="print"===e.intent?"print":"display";this.intentStates[o]||(this.intentStates[o]={});var r=this.intentStates[o];r.displayReadyCapability||(r.receivingOperatorList=!0,r.displayReadyCapability=h(),r.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this.stats.time("Page Request"),this.transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageNumber-1,intent:o}));var n=new X(t,e,this.objs,this.commonObjs,r.operatorList,this.pageNumber);n.useRequestAnimationFrame="print"!==o,r.renderTasks||(r.renderTasks=[]),r.renderTasks.push(n);var a=n.task;e.continueCallback&&(a.onContinue=e.continueCallback);var l=this;return r.displayReadyCapability.promise.then(function(e){return l.pendingDestroy?void t():(i.time("Rendering"),n.initalizeGraphics(e),void n.operatorListChanged())},function(e){t(e)}),a},getOperatorList:function(){function e(){i.operatorList.lastChunk&&i.opListReadCapability.resolve(i.operatorList)}var t="oplist";this.intentStates[t]||(this.intentStates[t]={});var i=this.intentStates[t];if(!i.opListReadCapability){var o={};o.operatorListChanged=e,i.receivingOperatorList=!0,i.opListReadCapability=h(),i.renderTasks=[],i.renderTasks.push(o),i.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this.transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageIndex,intent:t})}return i.opListReadCapability.promise},getTextContent:function(){return this.transport.messageHandler.sendWithPromise("GetTextContent",{pageIndex:this.pageNumber-1})},destroy:function(){this.pendingDestroy=!0,this._tryDestroy()},_tryDestroy:function(){this.pendingDestroy&&!Object.keys(this.intentStates).some(function(e){var t=this.intentStates[e];return 0!==t.renderTasks.length||t.receivingOperatorList},this)&&(Object.keys(this.intentStates).forEach(function(e){delete this.intentStates[e]},this),this.objs.clear(),this.annotationsPromise=null,this.pendingDestroy=!1)},_startRenderPage:function(e,t){var i=this.intentStates[t];i.displayReadyCapability&&i.displayReadyCapability.resolve(e)},_renderPageChunk:function(e,t){var i,o,r=this.intentStates[t];for(i=0,o=e.length;i<o;i++)r.operatorList.fnArray.push(e.fnArray[i]),r.operatorList.argsArray.push(e.argsArray[i]);for(r.operatorList.lastChunk=e.lastChunk,i=0;i<r.renderTasks.length;i++)r.renderTasks[i].operatorListChanged();e.lastChunk&&(r.receivingOperatorList=!1,this._tryDestroy())}},e}(),W=function(){function o(t,o){if(this.pdfDataRangeTransport=o,this.workerInitializedCapability=t,this.commonObjs=new j,this.loadingTask=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=h(),!b.PDFJS.disableWorker&&"undefined"!=typeof Worker){var r=PDFJS.workerSrc;r||i("No PDFJS.workerSrc specified");try{var n=new Worker(r),a=new T("main",n);this.messageHandler=a,a.on("test",function(e){var i=e&&e.supportTypedArray;i?(this.worker=n,e.supportTransfers||(PDFJS.postMessageTransfers=!1),this.setupMessageHandler(a),t.resolve()):this.setupFakeWorker()}.bind(this));var l=new Uint8Array([PDFJS.postMessageTransfers?255:0]);try{a.send("test",l,[l.buffer])}catch(t){e("Cannot use postMessage transfers"),l[0]=0,a.send("test",l)}return}catch(t){e("The worker has been disabled.")}}this.setupFakeWorker()}return o.prototype={destroy:function(){this.pageCache=[],this.pagePromises=[];var e=this;this.messageHandler.sendWithPromise("Terminate",null).then(function(){ce.clear(),e.worker&&e.worker.terminate()})},setupFakeWorker:function(){b.PDFJS.disableWorker=!0,PDFJS.fakeWorkerFilesLoadedCapability||(PDFJS.fakeWorkerFilesLoadedCapability=h(),J.loadScript(PDFJS.workerSrc,function(){PDFJS.fakeWorkerFilesLoadedCapability.resolve()})),PDFJS.fakeWorkerFilesLoadedCapability.promise.then(function(){t("Setting up fake worker.");var e={postMessage:function(t){e.onmessage({data:t})},terminate:function(){}},i=new T("main",e);this.setupMessageHandler(i),PDFJS.WorkerMessageHandler.setup(i),this.workerInitializedCapability.resolve()}.bind(this))},setupMessageHandler:function(e){function o(t){e.send("UpdatePassword",t)}this.messageHandler=e;var r=this.pdfDataRangeTransport;r&&(r.addRangeListener(function(t,i){e.send("OnDataRange",{begin:t,chunk:i})}),r.addProgressListener(function(t){e.send("OnDataProgress",{loaded:t})}),r.addProgressiveReadListener(function(t){e.send("OnDataRange",{chunk:t})}),e.on("RequestDataRange",function(e){r.requestDataRange(e.begin,e.end)},this)),e.on("GetDoc",function(e){var t=e.pdfInfo;this.numPages=e.pdfInfo.numPages;var i=new V(t,this);this.pdfDocument=i,this.loadingTask._capability.resolve(i)},this),e.on("NeedPassword",function(e){var t=this.loadingTask;return t.onPassword?t.onPassword(o,L.NEED_PASSWORD):void t._capability.reject(new w(e.message,e.code));},this),e.on("IncorrectPassword",function(e){var t=this.loadingTask;return t.onPassword?t.onPassword(o,L.INCORRECT_PASSWORD):void t._capability.reject(new w(e.message,e.code))},this),e.on("InvalidPDF",function(e){this.loadingTask._capability.reject(new U(e.message))},this),e.on("MissingPDF",function(e){this.loadingTask._capability.reject(new x(e.message))},this),e.on("UnexpectedResponse",function(e){this.loadingTask._capability.reject(new F(e.message,e.status))},this),e.on("UnknownError",function(e){this.loadingTask._capability.reject(new M(e.message,e.details))},this),e.on("DataLoaded",function(e){this.downloadInfoCapability.resolve(e)},this),e.on("PDFManagerReady",function(e){this.pdfDataRangeTransport&&this.pdfDataRangeTransport.transportReady()},this),e.on("StartRenderPage",function(e){var t=this.pageCache[e.pageIndex];t.stats.timeEnd("Page Request"),t._startRenderPage(e.transparency,e.intent)},this),e.on("RenderPageChunk",function(e){var t=this.pageCache[e.pageIndex];t._renderPageChunk(e.operatorList,e.intent)},this),e.on("commonobj",function(e){var i=e[0],o=e[1];if(!this.commonObjs.hasData(i))switch(o){case"Font":var r,n=e[2];if("error"in n){var a=n.error;t("Error during font loading: "+a),this.commonObjs.resolve(i,a);break}r=new pe(n),ce.bind([r],function(e){this.commonObjs.resolve(i,r)}.bind(this));break;case"FontPath":this.commonObjs.resolve(i,e[2]);break;default:a("Got unknown common object type "+o)}},this),e.on("obj",function(e){var t,o=e[0],r=e[1],n=e[2],a=this.pageCache[r];if(!a.objs.hasData(o))switch(n){case"JpegStream":t=e[3],E(o,t,a.objs);break;case"Image":t=e[3],a.objs.resolve(o,t);var l=8e6;t&&"data"in t&&t.data.length>l&&(a.cleanupAfterRender=!0);break;default:i("Got unknown object type "+n)}},this),e.on("DocProgress",function(e){var t=this.loadingTask;t.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})},this),e.on("PageError",function(e){var t=this.pageCache[e.pageNum-1],o=t.intentStates[e.intent];o.displayReadyCapability?o.displayReadyCapability.reject(e.error):i(e.error)},this),e.on("JpegDecode",function(e){var t=e[0],i=e[1];return 3!==i&&1!==i?Promise.reject(new Error("Only 3 components or 1 component can be returned")):new Promise(function(e,o){var r=new Image;r.onload=function(){var t=r.width,o=r.height,n=t*o,a=4*n,l=new Uint8Array(n*i),s=R(t,o),d=s.getContext("2d");d.drawImage(r,0,0);var c,p,u=d.getImageData(0,0,t,o).data;if(3===i)for(c=0,p=0;c<a;c+=4,p+=3)l[p]=u[c],l[p+1]=u[c+1],l[p+2]=u[c+2];else if(1===i)for(c=0,p=0;c<a;c+=4,p++)l[p]=u[c];e({data:l,width:t,height:o})},r.onerror=function(){o(new Error("JpegDecode failed to load image"))},r.src=t})})},fetchDocument:function(e,t){this.loadingTask=e,t.disableAutoFetch=PDFJS.disableAutoFetch,t.disableStream=PDFJS.disableStream,t.chunkedViewerLoading=!!this.pdfDataRangeTransport,this.pdfDataRangeTransport&&(t.length=this.pdfDataRangeTransport.length,t.initialData=this.pdfDataRangeTransport.initialData),this.messageHandler.send("GetDocRequest",{source:t,disableRange:PDFJS.disableRange,maxImageSize:PDFJS.maxImageSize,cMapUrl:PDFJS.cMapUrl,cMapPacked:PDFJS.cMapPacked,disableFontFace:PDFJS.disableFontFace,disableCreateObjectURL:PDFJS.disableCreateObjectURL,verbosity:PDFJS.verbosity})},getData:function(){return this.messageHandler.sendWithPromise("GetData",null)},getPage:function(e,t){if(e<=0||e>this.numPages||(0|e)!==e)return Promise.reject(new Error("Invalid page request"));var i=e-1;if(i in this.pagePromises)return this.pagePromises[i];var o=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(function(e){var t=new Y(i,e,this);return this.pageCache[i]=t,t}.bind(this));return this.pagePromises[i]=o,o},getPageIndex:function(e){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:e})},getAnnotations:function(e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e})},getDestinations:function(){return this.messageHandler.sendWithPromise("GetDestinations",null)},getDestination:function(e){return this.messageHandler.sendWithPromise("GetDestination",{id:e})},getAttachments:function(){return this.messageHandler.sendWithPromise("GetAttachments",null)},getJavaScript:function(){return this.messageHandler.sendWithPromise("GetJavaScript",null)},getOutline:function(){return this.messageHandler.sendWithPromise("GetOutline",null)},getMetadata:function(){return this.messageHandler.sendWithPromise("GetMetadata",null).then(function(e){return{info:e[0],metadata:e[1]?new PDFJS.Metadata(e[1]):null}})},getStats:function(){return this.messageHandler.sendWithPromise("GetStats",null)},startCleanup:function(){this.messageHandler.sendWithPromise("Cleanup",null).then(function(){for(var e=0,t=this.pageCache.length;e<t;e++){var i=this.pageCache[e];i&&i.destroy()}this.commonObjs.clear(),ce.clear()}.bind(this))}},o}(),j=function(){function e(){this.objs={}}return e.prototype={ensureObj:function(e){if(this.objs[e])return this.objs[e];var t={capability:h(),data:null,resolved:!1};return this.objs[e]=t,t},get:function(e,t){if(t)return this.ensureObj(e).capability.promise.then(t),null;var o=this.objs[e];return o&&o.resolved||i("Requesting object that isn't resolved yet "+e),o.data},resolve:function(e,t){var i=this.ensureObj(e);i.resolved=!0,i.data=t,i.capability.resolve(t)},isResolved:function(e){var t=this.objs;return!!t[e]&&t[e].resolved},hasData:function(e){return this.isResolved(e)},getData:function(e){var t=this.objs;return t[e]&&t[e].resolved?t[e].data:null},clear:function(){this.objs={}}},e}(),Z=function(){function e(e){this._internalRenderTask=e,this.onContinue=null}return e.prototype={get promise(){return this._internalRenderTask.capability.promise},cancel:function(){this._internalRenderTask.cancel()},then:function(e,t){return this.promise.then.apply(this.promise,arguments)}},e}(),X=function(){function e(e,t,i,o,r,n){this.callback=e,this.params=t,this.objs=i,this.commonObjs=o,this.operatorListIdx=null,this.operatorList=r,this.pageNumber=n,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this.useRequestAnimationFrame=!1,this.cancelled=!1,this.capability=h(),this.task=new Z(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this)}return e.prototype={initalizeGraphics:function(e){if(!this.cancelled){PDFJS.pdfBug&&"StepperManager"in b&&b.StepperManager.enabled&&(this.stepper=b.StepperManager.create(this.pageNumber-1),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());var t=this.params;this.gfx=new ne(t.canvasContext,this.commonObjs,this.objs,t.imageLayer),this.gfx.beginDrawing(t.viewport,e),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}},cancel:function(){this.running=!1,this.cancelled=!0,this.callback("cancelled")},operatorListChanged:function(){return this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),void(this.running||this._continue())):void(this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound))},_continue:function(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue.call(this.task,this._scheduleNextBound):this._scheduleNext())},_scheduleNext:function(){this.useRequestAnimationFrame?window.requestAnimationFrame(this._nextBound):Promise.resolve(void 0).then(this._nextBound)},_next:function(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this.callback())))}},e}(),K=(PDFJS.Metadata=function(){function e(e){return e.replace(/>\\376\\377([^<]+)/g,function(e,t){for(var i=t.replace(/\\([0-3])([0-7])([0-7])/g,function(e,t,i,o){return String.fromCharCode(64*t+8*i+1*o)}),o="",r=0;r<i.length;r+=2){var n=256*i.charCodeAt(r)+i.charCodeAt(r+1);o+="&#x"+(65536+n).toString(16).substring(1)+";"}return">"+o})}function t(t){if("string"==typeof t){t=e(t);var o=new DOMParser;t=o.parseFromString(t,"application/xml")}else t instanceof Document||i("Metadata: Invalid metadata object");this.metaDocument=t,this.metadata={},this.parse()}return t.prototype={parse:function(){var e=this.metaDocument,t=e.documentElement;if("rdf:rdf"!==t.nodeName.toLowerCase())for(t=t.firstChild;t&&"rdf:rdf"!==t.nodeName.toLowerCase();)t=t.nextSibling;var i=t?t.nodeName.toLowerCase():null;if(t&&"rdf:rdf"===i&&t.hasChildNodes()){var o,r,n,a,l,s,d,c=t.childNodes;for(a=0,s=c.length;a<s;a++)if(o=c[a],"rdf:description"===o.nodeName.toLowerCase())for(l=0,d=o.childNodes.length;l<d;l++)"#text"!==o.childNodes[l].nodeName.toLowerCase()&&(r=o.childNodes[l],n=r.nodeName.toLowerCase(),this.metadata[n]=r.textContent.trim())}},get:function(e){return this.metadata[e]||null},has:function(e){return"undefined"!=typeof this.metadata[e]}},t}(),16),$=100,q=4096,Q=.65,ee=!0,te=1e3,ie=16,oe=function(){var e={};return{getCanvas:function(t,i,o,r){var n;if(void 0!==e[t])n=e[t],n.canvas.width=i,n.canvas.height=o,n.context.setTransform(1,0,0,1,0,0);else{var a=R(i,o),l=a.getContext("2d");r&&S(l),e[t]=n={canvas:a,context:l}}return n},clear:function(){for(var t in e){var i=e[t];i.canvas.width=0,i.canvas.height=0,delete e[t]}}}}(),re=function(){function e(e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=B,this.textMatrixScale=1,this.fontMatrix=y,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=D.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.old=e}return e.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(e,t){this.x=e,this.y=t}},e}(),ne=function(){function o(e,t,i,o){this.ctx=e,this.current=new re,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.imageLayer=o,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,e&&S(e),this.cachedGetSinglePixelWidth=null}function n(e,t){if("undefined"!=typeof ImageData&&t instanceof ImageData)return void e.putImageData(t,0,0);var o,r,n,a,l,s=t.height,d=t.width,c=s%ie,p=(s-c)/ie,u=0===c?p:p+1,f=e.createImageData(d,ie),g=0,m=t.data,h=f.data;if(t.kind===C.GRAYSCALE_1BPP){var T=m.byteLength,E=PDFJS.hasCanvasTypedArrays?new Uint32Array(h.buffer):new k(h),R=E.length,S=d+7>>3,O=4294967295,v=PDFJS.isLittleEndian||!PDFJS.hasCanvasTypedArrays?4278190080:255;for(r=0;r<u;r++){for(a=r<p?ie:c,o=0,n=0;n<a;n++){for(var b=T-g,A=0,y=b>S?d:8*b-7,D=y&-8,I=0,P=0;A<D;A+=8)P=m[g++],E[o++]=128&P?O:v,E[o++]=64&P?O:v,E[o++]=32&P?O:v,E[o++]=16&P?O:v,E[o++]=8&P?O:v,E[o++]=4&P?O:v,E[o++]=2&P?O:v,E[o++]=1&P?O:v;for(;A<y;A++)0===I&&(P=m[g++],I=128),E[o++]=P&I?O:v,I>>=1}for(;o<R;)E[o++]=0;e.putImageData(f,0,r*ie)}}else if(t.kind===C.RGBA_32BPP){for(n=0,l=d*ie*4,r=0;r<p;r++)h.set(m.subarray(g,g+l)),g+=l,e.putImageData(f,0,n),n+=ie;r<u&&(l=d*c*4,h.set(m.subarray(g,g+l)),e.putImageData(f,0,n))}else if(t.kind===C.RGB_24BPP)for(a=ie,l=d*a,r=0;r<u;r++){for(r>=p&&(a=c,l=d*a),o=0,n=l;n--;)h[o++]=m[g++],h[o++]=m[g++],h[o++]=m[g++],h[o++]=255;e.putImageData(f,0,r*ie)}else i("bad image kind: "+t.kind)}function a(e,t){for(var i=t.height,o=t.width,r=i%ie,n=(i-r)/ie,a=0===r?n:n+1,l=e.createImageData(o,ie),s=0,d=t.data,c=l.data,p=0;p<a;p++){for(var u=p<n?ie:r,f=3,g=0;g<u;g++)for(var m=0,h=0;h<o;h++){if(!m){var T=d[s++];m=128}c[f]=T&m?0:255,f+=4,m>>=1}e.putImageData(l,0,p*ie)}}function s(e,t){for(var i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"],o=0,r=i.length;o<r;o++){var n=i[o];void 0!==e[n]&&(t[n]=e[n])}void 0!==e.setLineDash?(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset):void 0!==e.mozDashOffset&&(t.mozDash=e.mozDash,t.mozDashOffset=e.mozDashOffset)}function d(e,t,i,o){for(var r=e.length,n=3;n<r;n+=4){var a=e[n];if(0===a)e[n-3]=t,e[n-2]=i,e[n-1]=o;else if(a<255){var l=255-a;e[n-3]=e[n-3]*a+t*l>>8,e[n-2]=e[n-2]*a+i*l>>8,e[n-1]=e[n-1]*a+o*l>>8}}}function c(e,t){for(var i=e.length,o=1/255,r=3;r<i;r+=4){var n=e[r];t[r]=t[r]*n*o|0}}function p(e,t){for(var i=e.length,o=3;o<i;o+=4){var r=77*e[o-3]+152*e[o-2]+28*e[o-1];t[o]=t[o]*r>>16}}function u(e,t,i,o,r,n){var a,l=!!n,s=l?n[0]:0,u=l?n[1]:0,f=l?n[2]:0;a="Luminosity"===r?p:c;for(var g=1048576,m=Math.min(o,Math.ceil(g/i)),h=0;h<o;h+=m){var T=Math.min(m,o-h),E=e.getImageData(0,h,i,T),R=t.getImageData(0,h,i,T);l&&d(E.data,s,u,f),a(E.data,R.data),e.putImageData(R,0,h)}}function m(e,t,i){var o=t.canvas,r=t.context;e.setTransform(t.scaleX,0,0,t.scaleY,t.offsetX,t.offsetY);var n=t.backdrop||null;if(ae.isEnabled){var a=ae.composeSMask(i.canvas,o,{subtype:t.subtype,backdrop:n});return e.setTransform(1,0,0,1,0,0),void e.drawImage(a,t.offsetX,t.offsetY)}u(r,i,o.width,o.height,t.subtype,n),e.drawImage(o,0,0)}var h=15,T=10,E=["butt","round","square"],R=["miter","round","bevel"],b={},A={};o.prototype={beginDrawing:function(e,t){var i=this.ctx.canvas.width,o=this.ctx.canvas.height;t?this.ctx.clearRect(0,0,i,o):(this.ctx.mozOpaque=!0,this.ctx.save(),this.ctx.fillStyle="rgb(255, 255, 255)",this.ctx.fillRect(0,0,i,o),this.ctx.restore());var r=e.transform;this.ctx.save(),this.ctx.transform.apply(this.ctx,r),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()},executeOperatorList:function(e,t,i,o){var r=e.argsArray,n=e.fnArray,a=t||0,l=r.length;if(l===a)return a;for(var s,d=l-a>T&&"function"==typeof i,c=d?Date.now()+h:0,p=0,u=this.commonObjs,f=this.objs;;){if(void 0!==o&&a===o.nextBreakPoint)return o.breakIt(a,i),a;if(s=n[a],s!==P.dependency)this[s].apply(this,r[a]);else for(var g=r[a],m=0,E=g.length;m<E;m++){var R=g[m],S="g"===R[0]&&"_"===R[1],O=S?u:f;if(!O.isResolved(R))return O.get(R,i),a}if(a++,a===l)return a;if(d&&++p>T){if(Date.now()>c)return i(),a;p=0}}},endDrawing:function(){this.ctx.restore(),oe.clear(),ae.clear(),this.imageLayer&&this.imageLayer.endLayout()},setLineWidth:function(e){this.current.lineWidth=e,this.ctx.lineWidth=e},setLineCap:function(e){this.ctx.lineCap=E[e]},setLineJoin:function(e){this.ctx.lineJoin=R[e]},setMiterLimit:function(e){this.ctx.miterLimit=e},setDash:function(e,t){var i=this.ctx;void 0!==i.setLineDash?(i.setLineDash(e),i.lineDashOffset=t):(i.mozDash=e,i.mozDashOffset=t)},setRenderingIntent:function(e){},setFlatness:function(e){},setGState:function(e){for(var i=0,o=e.length;i<o;i++){var r=e[i],n=r[0],a=r[1];switch(n){case"LW":this.setLineWidth(a);break;case"LC":this.setLineCap(a);break;case"LJ":this.setLineJoin(a);break;case"ML":this.setMiterLimit(a);break;case"D":this.setDash(a[0],a[1]);break;case"RI":this.setRenderingIntent(a);break;case"FL":this.setFlatness(a);break;case"Font":this.setFont(a[0],a[1]);break;case"CA":this.current.strokeAlpha=r[1];break;case"ca":this.current.fillAlpha=r[1],this.ctx.globalAlpha=r[1];break;case"BM":if(a&&a.name&&"Normal"!==a.name){var l=a.name.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()}).substring(1);this.ctx.globalCompositeOperation=l,this.ctx.globalCompositeOperation!==l&&t('globalCompositeOperation "'+l+'" is not supported')}else this.ctx.globalCompositeOperation="source-over";break;case"SMask":this.current.activeSMask&&this.endSMaskGroup(),this.current.activeSMask=a?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null}}},beginSMaskGroup:function(){var e=this.current.activeSMask,t=e.canvas.width,i=e.canvas.height,o="smaskGroupAt"+this.groupLevel,r=oe.getCanvas(o,t,i,!0),n=this.ctx,a=n.mozCurrentTransform;this.ctx.save();var l=r.context;l.scale(1/e.scaleX,1/e.scaleY),l.translate(-e.offsetX,-e.offsetY),l.transform.apply(l,a),s(n,l),this.ctx=l,this.setGState([["BM","Normal"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++},endSMaskGroup:function(){var e=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),m(this.ctx,this.current.activeSMask,e),this.ctx.restore()},save:function(){this.ctx.save();var e=this.current;this.stateStack.push(e),this.current=e.clone(),this.current.activeSMask=null},restore:function(){0!==this.stateStack.length&&(null!==this.current.activeSMask&&this.endSMaskGroup(),this.current=this.stateStack.pop(),this.ctx.restore(),this.cachedGetSinglePixelWidth=null)},transform:function(e,t,i,o,r,n){this.ctx.transform(e,t,i,o,r,n),this.cachedGetSinglePixelWidth=null},constructPath:function(e,t){for(var i=this.ctx,o=this.current,r=o.x,n=o.y,a=0,l=0,s=e.length;a<s;a++)switch(0|e[a]){case P.rectangle:r=t[l++],n=t[l++];var d=t[l++],c=t[l++];0===d&&(d=this.getSinglePixelWidth()),0===c&&(c=this.getSinglePixelWidth());var p=r+d,u=n+c;this.ctx.moveTo(r,n),this.ctx.lineTo(p,n),this.ctx.lineTo(p,u),this.ctx.lineTo(r,u),this.ctx.lineTo(r,n),this.ctx.closePath();break;case P.moveTo:r=t[l++],n=t[l++],i.moveTo(r,n);break;case P.lineTo:r=t[l++],n=t[l++],i.lineTo(r,n);break;case P.curveTo:r=t[l+4],n=t[l+5],i.bezierCurveTo(t[l],t[l+1],t[l+2],t[l+3],r,n),l+=6;break;case P.curveTo2:i.bezierCurveTo(r,n,t[l],t[l+1],t[l+2],t[l+3]),r=t[l+2],n=t[l+3],l+=4;break;case P.curveTo3:r=t[l+2],n=t[l+3],i.bezierCurveTo(t[l],t[l+1],r,n,r,n),l+=4;break;case P.closePath:i.closePath()}o.setCurrentPoint(r,n)},closePath:function(){this.ctx.closePath()},stroke:function(e){e="undefined"==typeof e||e;var t=this.ctx,i=this.current.strokeColor;t.lineWidth=Math.max(this.getSinglePixelWidth()*Q,this.current.lineWidth),t.globalAlpha=this.current.strokeAlpha,i&&i.hasOwnProperty("type")&&"Pattern"===i.type?(t.save(),t.strokeStyle=i.getPattern(t,this),t.stroke(),t.restore()):t.stroke(),e&&this.consumePath(),t.globalAlpha=this.current.fillAlpha},closeStroke:function(){this.closePath(),this.stroke()},fill:function(e){e="undefined"==typeof e||e;var t=this.ctx,i=this.current.fillColor,o=this.current.patternFill,r=!1;if(o&&(t.save(),t.fillStyle=i.getPattern(t,this),r=!0),this.pendingEOFill){if(void 0!==t.mozFillRule)t.mozFillRule="evenodd",t.fill(),t.mozFillRule="nonzero";else try{t.fill("evenodd")}catch(e){t.fill()}this.pendingEOFill=!1}else t.fill();r&&t.restore(),e&&this.consumePath()},eoFill:function(){this.pendingEOFill=!0,this.fill()},fillStroke:function(){this.fill(!1),this.stroke(!1),this.consumePath()},eoFillStroke:function(){this.pendingEOFill=!0,this.fillStroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()},endPath:function(){this.consumePath()},clip:function(){this.pendingClip=b},eoClip:function(){this.pendingClip=A},beginText:function(){this.current.textMatrix=B,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},endText:function(){var e=this.pendingTextPaths,t=this.ctx;if(void 0===e)return void t.beginPath();t.save(),t.beginPath();for(var i=0;i<e.length;i++){var o=e[i];t.setTransform.apply(t,o.transform),t.translate(o.x,o.y),o.addToPath(t,o.fontSize)}t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths},setCharSpacing:function(e){this.current.charSpacing=e},setWordSpacing:function(e){this.current.wordSpacing=e},setHScale:function(e){this.current.textHScale=e/100},setLeading:function(e){this.current.leading=-e},setFont:function(e,o){var r=this.commonObjs.get(e),n=this.current;if(r||i("Can't find font for "+e),n.fontMatrix=r.fontMatrix?r.fontMatrix:y,0!==n.fontMatrix[0]&&0!==n.fontMatrix[3]||t("Invalid font matrix for font "+e),o<0?(o=-o,n.fontDirection=-1):n.fontDirection=1,this.current.font=r,this.current.fontSize=o,!r.isType3Font){var a=r.loadedName||"sans-serif",l=r.black?r.bold?"900":"bold":r.bold?"bold":"normal",s=r.italic?"italic":"normal",d='"'+a+'", '+r.fallbackName,c=o<K?K:o>$?$:o;this.current.fontSizeScale=o/c;var p=s+" "+l+" "+c+"px "+d;this.ctx.font=p}},setTextRenderingMode:function(e){this.current.textRenderingMode=e},setTextRise:function(e){this.current.textRise=e},moveText:function(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t},setLeadingMoveText:function(e,t){this.setLeading(-t),this.moveText(e,t)},setTextMatrix:function(e,t,i,o,r,n){this.current.textMatrix=[e,t,i,o,r,n],this.current.textMatrixScale=Math.sqrt(e*e+t*t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},nextLine:function(){this.moveText(0,this.current.leading)},paintChar:function(e,t,i){var o,r=this.ctx,n=this.current,a=n.font,l=n.textRenderingMode,s=n.fontSize/n.fontSizeScale,d=l&D.FILL_STROKE_MASK,c=!!(l&D.ADD_TO_PATH_FLAG);if((a.disableFontFace||c)&&(o=a.getPathGenerator(this.commonObjs,e)),a.disableFontFace?(r.save(),r.translate(t,i),r.beginPath(),o(r,s),d!==D.FILL&&d!==D.FILL_STROKE||r.fill(),d!==D.STROKE&&d!==D.FILL_STROKE||r.stroke(),r.restore()):(d!==D.FILL&&d!==D.FILL_STROKE||r.fillText(e,t,i),d!==D.STROKE&&d!==D.FILL_STROKE||r.strokeText(e,t,i)),c){var p=this.pendingTextPaths||(this.pendingTextPaths=[]);p.push({transform:r.mozCurrentTransform,x:t,y:i,fontSize:s,addToPath:o})}},get isFontSubpixelAAEnabled(){var e=document.createElement("canvas").getContext("2d");e.scale(1.5,1),e.fillText("I",0,10);for(var t=e.getImageData(0,0,10,10).data,i=!1,o=3;o<t.length;o+=4)if(t[o]>0&&t[o]<255){i=!0;break}return l(this,"isFontSubpixelAAEnabled",i)},showText:function(e){var t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);var o=t.fontSize;if(0!==o){var r=this.ctx,n=t.fontSizeScale,a=t.charSpacing,l=t.wordSpacing,s=t.fontDirection,d=t.textHScale*s,c=e.length,p=i.vertical,u=i.defaultVMetrics,g=o*t.fontMatrix[0],m=t.textRenderingMode===D.FILL&&!i.disableFontFace;r.save(),r.transform.apply(r,t.textMatrix),r.translate(t.x,t.y+t.textRise),s>0?r.scale(d,-1):r.scale(d,1);var h=t.lineWidth,T=t.textMatrixScale;if(0===T||0===h){var E=t.textRenderingMode&D.FILL_STROKE_MASK;E!==D.STROKE&&E!==D.FILL_STROKE||(this.cachedGetSinglePixelWidth=null,h=this.getSinglePixelWidth()*Q)}else h/=T;1!==n&&(r.scale(n,n),h/=n),r.lineWidth=h;var R,S=0;for(R=0;R<c;++R){var O=e[R];if(null!==O)if(f(O))S+=-O*o*.001;else{var v,b,A,y,C=!1,I=O.fontChar,P=O.accent,_=O.width;if(p){var N,L,w;N=O.vmetric||u,L=O.vmetric?N[1]:.5*_,L=-L*g,w=N[2]*g,_=N?-N[0]:_,v=L/n,b=(S+w)/n}else v=S/n,b=0;if(i.remeasure&&_>0&&this.isFontSubpixelAAEnabled){var M=1e3*r.measureText(I).width/o*n,U=_/M;C=!0,r.save(),r.scale(U,1),v/=U}m&&!P?r.fillText(I,v,b):(this.paintChar(I,v,b),P&&(A=v+P.offset.x/n,y=b-P.offset.y/n,this.paintChar(P.fontChar,A,y)));var x=_*g+a*s;S+=x,C&&r.restore()}else S+=s*l}p?t.y-=S*d:t.x+=S*d,r.restore()}},showType3Text:function(e){var i,o,r,n=this.ctx,a=this.current,l=a.font,s=a.fontSize,d=a.fontDirection,c=a.charSpacing,p=a.wordSpacing,u=a.textHScale*d,g=a.fontMatrix||y,m=e.length,h=a.textRenderingMode===D.INVISIBLE;if(!h&&0!==s){for(this.cachedGetSinglePixelWidth=null,n.save(),n.transform.apply(n,a.textMatrix),n.translate(a.x,a.y),n.scale(u,d),i=0;i<m;++i)if(o=e[i],null!==o)if(f(o)){var T=.001*-o*s;this.ctx.translate(T,0),a.x+=T*u}else{var E=l.charProcOperatorList[o.operatorListId];if(E){this.processingType3=o,this.save(),n.scale(s,s),n.transform.apply(n,g),this.executeOperatorList(E),this.restore();var R=J.applyTransform([o.width,0],g);r=R[0]*s+c,n.translate(r,0),a.x+=r*u}else t('Type3 character "'+o.operatorListId+'" is not available')}else this.ctx.translate(p,0),a.x+=p*u;n.restore(),this.processingType3=null}},setCharWidth:function(e,t){},setCharWidthAndBounds:function(e,t,i,o,r,n){this.ctx.rect(i,o,r-i,n-o),this.clip(),this.endPath()},getColorN_Pattern:function(e){var t;if("TilingPattern"===e[0]){var i=e[1];t=new de(e,i,this.ctx,this.objs,this.commonObjs,this.baseTransform)}else t=v(e);return t},setStrokeColorN:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)},setFillColorN:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0},setStrokeRGBColor:function(e,t,i){var o=J.makeCssRgb(e,t,i);this.ctx.strokeStyle=o,this.current.strokeColor=o},setFillRGBColor:function(e,t,i){var o=J.makeCssRgb(e,t,i);this.ctx.fillStyle=o,this.current.fillColor=o,this.current.patternFill=!1},shadingFill:function(e){var t=this.ctx;this.save();var i=v(e);t.fillStyle=i.getPattern(t,this,!0);var o=t.mozCurrentTransformInverse;if(o){var r=t.canvas,n=r.width,a=r.height,l=J.applyTransform([0,0],o),s=J.applyTransform([0,a],o),d=J.applyTransform([n,0],o),c=J.applyTransform([n,a],o),p=Math.min(l[0],s[0],d[0],c[0]),u=Math.min(l[1],s[1],d[1],c[1]),f=Math.max(l[0],s[0],d[0],c[0]),g=Math.max(l[1],s[1],d[1],c[1]);this.ctx.fillRect(p,u,f-p,g-u)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()},beginInlineImage:function(){i("Should not call beginInlineImage")},beginImageData:function(){i("Should not call beginImageData")},paintFormXObjectBegin:function(e,t){if(this.save(),this.baseTransformStack.push(this.baseTransform),g(e)&&6===e.length&&this.transform.apply(this,e),this.baseTransform=this.ctx.mozCurrentTransform,g(t)&&4===t.length){var i=t[2]-t[0],o=t[3]-t[1];this.ctx.rect(t[0],t[1],i,o),this.clip(),this.endPath()}},paintFormXObjectEnd:function(){this.restore(),this.baseTransform=this.baseTransformStack.pop()},beginGroup:function(i){this.save();var o=this.ctx;i.isolated||e("TODO: Support non-isolated groups."),i.knockout&&t("Knockout groups not supported.");var n=o.mozCurrentTransform;i.matrix&&o.transform.apply(o,i.matrix),r(i.bbox,"Bounding box is required.");var a=J.getAxialAlignedBoundingBox(i.bbox,o.mozCurrentTransform),l=[0,0,o.canvas.width,o.canvas.height];a=J.intersect(a,l)||[0,0,0,0];var d=Math.floor(a[0]),c=Math.floor(a[1]),p=Math.max(Math.ceil(a[2])-d,1),u=Math.max(Math.ceil(a[3])-c,1),f=1,g=1;p>q&&(f=p/q,p=q),u>q&&(g=u/q,u=q);var m="groupAt"+this.groupLevel;i.smask&&(m+="_smask_"+this.smaskCounter++%2);var h=oe.getCanvas(m,p,u,!0),T=h.context;T.scale(1/f,1/g),T.translate(-d,-c),T.transform.apply(T,n),i.smask?this.smaskStack.push({canvas:h.canvas,context:T,offsetX:d,offsetY:c,scaleX:f,scaleY:g,subtype:i.smask.subtype,backdrop:i.smask.backdrop}):(o.setTransform(1,0,0,1,0,0),o.translate(d,c),o.scale(f,g)),s(o,T),this.ctx=T,this.setGState([["BM","Normal"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++},endGroup:function(e){this.groupLevel--;var t=this.ctx;this.ctx=this.groupStack.pop(),void 0!==this.ctx.imageSmoothingEnabled?this.ctx.imageSmoothingEnabled=!1:this.ctx.mozImageSmoothingEnabled=!1,e.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(t.canvas,0,0),this.restore()},beginAnnotations:function(){this.save(),this.current=new re},endAnnotations:function(){this.restore()},beginAnnotation:function(e,t,i){if(this.save(),g(e)&&4===e.length){var o=e[2]-e[0],r=e[3]-e[1];this.ctx.rect(e[0],e[1],o,r),this.clip(),this.endPath()}this.transform.apply(this,t),this.transform.apply(this,i)},endAnnotation:function(){this.restore()},paintJpegXObject:function(e,i,o){var r=this.objs.get(e);if(!r)return void t("Dependent image isn't ready yet");this.save();var n=this.ctx;if(n.scale(1/i,-1/o),n.drawImage(r,0,0,r.width,r.height,0,-o,i,o),this.imageLayer){var a=n.mozCurrentTransformInverse,l=this.getCanvasPosition(0,0);this.imageLayer.appendImage({objId:e,left:l[0],top:l[1],width:i/a[0],height:o/a[3]})}this.restore()},paintImageMaskXObject:function(e){var t=this.ctx,i=e.width,o=e.height,r=this.current.fillColor,n=this.current.patternFill,l=this.processingType3;if(ee&&l&&void 0===l.compiled&&(i<=te&&o<=te?l.compiled=O({data:e.data,width:i,height:o}):l.compiled=null),l&&l.compiled)return void l.compiled(t);var s=oe.getCanvas("maskCanvas",i,o),d=s.context;d.save(),a(d,e),d.globalCompositeOperation="source-in",d.fillStyle=n?r.getPattern(d,this):r,d.fillRect(0,0,i,o),d.restore(),this.paintInlineImageXObject(s.canvas)},paintImageMaskXObjectRepeat:function(e,t,i,o){var r=e.width,n=e.height,l=this.current.fillColor,s=this.current.patternFill,d=oe.getCanvas("maskCanvas",r,n),c=d.context;c.save(),a(c,e),c.globalCompositeOperation="source-in",c.fillStyle=s?l.getPattern(c,this):l,c.fillRect(0,0,r,n),c.restore();for(var p=this.ctx,u=0,f=o.length;u<f;u+=2)p.save(),p.transform(t,0,0,i,o[u],o[u+1]),p.scale(1,-1),p.drawImage(d.canvas,0,0,r,n,0,-1,1,1),p.restore()},paintImageMaskXObjectGroup:function(e){for(var t=this.ctx,i=this.current.fillColor,o=this.current.patternFill,r=0,n=e.length;r<n;r++){var l=e[r],s=l.width,d=l.height,c=oe.getCanvas("maskCanvas",s,d),p=c.context;p.save(),a(p,l),p.globalCompositeOperation="source-in",p.fillStyle=o?i.getPattern(p,this):i,p.fillRect(0,0,s,d),p.restore(),t.save(),t.transform.apply(t,l.transform),t.scale(1,-1),t.drawImage(c.canvas,0,0,s,d,0,-1,1,1),t.restore()}},paintImageXObject:function(e){var i=this.objs.get(e);return i?void this.paintInlineImageXObject(i):void t("Dependent image isn't ready yet")},paintImageXObjectRepeat:function(e,i,o,r){var n=this.objs.get(e);if(!n)return void t("Dependent image isn't ready yet");for(var a=n.width,l=n.height,s=[],d=0,c=r.length;d<c;d+=2)s.push({transform:[i,0,0,o,r[d],r[d+1]],x:0,y:0,w:a,h:l});this.paintInlineImageXObjectGroup(n,s)},paintInlineImageXObject:function(e){var t=e.width,i=e.height,o=this.ctx;this.save(),o.scale(1/t,-1/i);var r,a,l=o.mozCurrentTransformInverse,s=l[0],d=l[1],c=Math.max(Math.sqrt(s*s+d*d),1),p=l[2],u=l[3],f=Math.max(Math.sqrt(p*p+u*u),1);if(e instanceof HTMLElement||!e.data)r=e;else{a=oe.getCanvas("inlineImage",t,i);var g=a.context;n(g,e),r=a.canvas}for(var m=t,h=i,T="prescale1";c>2&&m>1||f>2&&h>1;){var E=m,R=h;c>2&&m>1&&(E=Math.ceil(m/2),c/=m/E),f>2&&h>1&&(R=Math.ceil(h/2),f/=h/R),a=oe.getCanvas(T,E,R),g=a.context,g.clearRect(0,0,E,R),g.drawImage(r,0,0,m,h,0,0,E,R),r=a.canvas,m=E,h=R,T="prescale1"===T?"prescale2":"prescale1"}if(o.drawImage(r,0,0,m,h,0,-i,t,i),this.imageLayer){var S=this.getCanvasPosition(0,-i);this.imageLayer.appendImage({imgData:e,left:S[0],top:S[1],width:t/l[0],height:i/l[3]})}this.restore()},paintInlineImageXObjectGroup:function(e,t){var i=this.ctx,o=e.width,r=e.height,a=oe.getCanvas("inlineImage",o,r),l=a.context;n(l,e);for(var s=0,d=t.length;s<d;s++){var c=t[s];if(i.save(),i.transform.apply(i,c.transform),i.scale(1,-1),i.drawImage(a.canvas,c.x,c.y,c.w,c.h,0,-1,1,1),this.imageLayer){var p=this.getCanvasPosition(c.x,c.y);this.imageLayer.appendImage({imgData:e,left:p[0],top:p[1],width:o,height:r})}i.restore()}},paintSolidColorImageMask:function(){this.ctx.fillRect(0,0,1,1)},markPoint:function(e){},markPointProps:function(e,t){},beginMarkedContent:function(e){},beginMarkedContentProps:function(e,t){},endMarkedContent:function(){},beginCompat:function(){},endCompat:function(){},consumePath:function(){var e=this.ctx;if(this.pendingClip){if(this.pendingClip===A)if(void 0!==e.mozFillRule)e.mozFillRule="evenodd",e.clip(),e.mozFillRule="nonzero";else try{e.clip("evenodd")}catch(t){e.clip()}else e.clip();this.pendingClip=null}e.beginPath()},getSinglePixelWidth:function(e){if(null===this.cachedGetSinglePixelWidth){var t=this.ctx.mozCurrentTransformInverse;this.cachedGetSinglePixelWidth=Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1],t[2]*t[2]+t[3]*t[3]))}return this.cachedGetSinglePixelWidth},getCanvasPosition:function(e,t){var i=this.ctx.mozCurrentTransform;return[i[0]*e+i[2]*t+i[4],i[1]*e+i[3]*t+i[5]]}};for(var I in P)o.prototype[P[I]]=o.prototype[I];return o}(),ae=function(){function e(e,t,i){var o=e.createShader(i);e.shaderSource(o,t),e.compileShader(o);var r=e.getShaderParameter(o,e.COMPILE_STATUS);if(!r){var n=e.getShaderInfoLog(o);throw new Error("Error during shader compilation: "+n)}return o}function t(t,i){return e(t,i,t.VERTEX_SHADER)}function i(t,i){return e(t,i,t.FRAGMENT_SHADER)}function o(e,t){for(var i=e.createProgram(),o=0,r=t.length;o<r;++o)e.attachShader(i,t[o]);e.linkProgram(i);var n=e.getProgramParameter(i,e.LINK_STATUS);if(!n){var a=e.getProgramInfoLog(i);throw new Error("Error during program linking: "+a);}return i}function r(e,t,i){e.activeTexture(i);var o=e.createTexture();return e.bindTexture(e.TEXTURE_2D,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),o}function n(){u||(f=document.createElement("canvas"),u=f.getContext("webgl",{premultipliedalpha:!1}))}function a(){var e,r;n(),e=f,f=null,r=u,u=null;var a=t(r,g),l=i(r,m),s=o(r,[a,l]);r.useProgram(s);var d={};d.gl=r,d.canvas=e,d.resolutionLocation=r.getUniformLocation(s,"u_resolution"),d.positionLocation=r.getAttribLocation(s,"a_position"),d.backdropLocation=r.getUniformLocation(s,"u_backdrop"),d.subtypeLocation=r.getUniformLocation(s,"u_subtype");var c=r.getAttribLocation(s,"a_texCoord"),p=r.getUniformLocation(s,"u_image"),T=r.getUniformLocation(s,"u_mask"),E=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,E),r.bufferData(r.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),r.STATIC_DRAW),r.enableVertexAttribArray(c),r.vertexAttribPointer(c,2,r.FLOAT,!1,0,0),r.uniform1i(p,0),r.uniform1i(T,1),h=d}function s(e,t,i){var o=e.width,n=e.height;h||a();var l=h,s=l.canvas,d=l.gl;s.width=o,s.height=n,d.viewport(0,0,d.drawingBufferWidth,d.drawingBufferHeight),d.uniform2f(l.resolutionLocation,o,n),i.backdrop?d.uniform4f(l.resolutionLocation,i.backdrop[0],i.backdrop[1],i.backdrop[2],1):d.uniform4f(l.resolutionLocation,0,0,0,0),d.uniform1i(l.subtypeLocation,"Luminosity"===i.subtype?1:0);var c=r(d,e,d.TEXTURE0),p=r(d,t,d.TEXTURE1),u=d.createBuffer();return d.bindBuffer(d.ARRAY_BUFFER,u),d.bufferData(d.ARRAY_BUFFER,new Float32Array([0,0,o,0,0,n,0,n,o,0,o,n]),d.STATIC_DRAW),d.enableVertexAttribArray(l.positionLocation),d.vertexAttribPointer(l.positionLocation,2,d.FLOAT,!1,0,0),d.clearColor(0,0,0,0),d.enable(d.BLEND),d.blendFunc(d.ONE,d.ONE_MINUS_SRC_ALPHA),d.clear(d.COLOR_BUFFER_BIT),d.drawArrays(d.TRIANGLES,0,6),d.flush(),d.deleteTexture(c),d.deleteTexture(p),d.deleteBuffer(u),s}function d(){var e,r;n(),e=f,f=null,r=u,u=null;var a=t(r,T),l=i(r,E),s=o(r,[a,l]);r.useProgram(s);var d={};d.gl=r,d.canvas=e,d.resolutionLocation=r.getUniformLocation(s,"u_resolution"),d.scaleLocation=r.getUniformLocation(s,"u_scale"),d.offsetLocation=r.getUniformLocation(s,"u_offset"),d.positionLocation=r.getAttribLocation(s,"a_position"),d.colorLocation=r.getAttribLocation(s,"a_color"),R=d}function c(e,t,i,o,r){R||d();var n=R,a=n.canvas,l=n.gl;a.width=e,a.height=t,l.viewport(0,0,l.drawingBufferWidth,l.drawingBufferHeight),l.uniform2f(n.resolutionLocation,e,t);var s,c,p,u=0;for(s=0,c=o.length;s<c;s++)switch(o[s].type){case"lattice":p=o[s].coords.length/o[s].verticesPerRow|0,u+=(p-1)*(o[s].verticesPerRow-1)*6;break;case"triangles":u+=o[s].coords.length}var f=new Float32Array(2*u),g=new Uint8Array(3*u),m=r.coords,h=r.colors,T=0,E=0;for(s=0,c=o.length;s<c;s++){var S=o[s],O=S.coords,v=S.colors;switch(S.type){case"lattice":var b=S.verticesPerRow;p=O.length/b|0;for(var A=1;A<p;A++)for(var y=A*b+1,D=1;D<b;D++,y++)f[T]=m[O[y-b-1]],f[T+1]=m[O[y-b-1]+1],f[T+2]=m[O[y-b]],f[T+3]=m[O[y-b]+1],f[T+4]=m[O[y-1]],f[T+5]=m[O[y-1]+1],g[E]=h[v[y-b-1]],g[E+1]=h[v[y-b-1]+1],g[E+2]=h[v[y-b-1]+2],g[E+3]=h[v[y-b]],g[E+4]=h[v[y-b]+1],g[E+5]=h[v[y-b]+2],g[E+6]=h[v[y-1]],g[E+7]=h[v[y-1]+1],g[E+8]=h[v[y-1]+2],f[T+6]=f[T+2],f[T+7]=f[T+3],f[T+8]=f[T+4],f[T+9]=f[T+5],f[T+10]=m[O[y]],f[T+11]=m[O[y]+1],g[E+9]=g[E+3],g[E+10]=g[E+4],g[E+11]=g[E+5],g[E+12]=g[E+6],g[E+13]=g[E+7],g[E+14]=g[E+8],g[E+15]=h[v[y]],g[E+16]=h[v[y]+1],g[E+17]=h[v[y]+2],T+=12,E+=18;break;case"triangles":for(var C=0,I=O.length;C<I;C++)f[T]=m[O[C]],f[T+1]=m[O[C]+1],g[E]=h[v[s]],g[E+1]=h[v[C]+1],g[E+2]=h[v[C]+2],T+=2,E+=3}}i?l.clearColor(i[0]/255,i[1]/255,i[2]/255,1):l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT);var P=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,P),l.bufferData(l.ARRAY_BUFFER,f,l.STATIC_DRAW),l.enableVertexAttribArray(n.positionLocation),l.vertexAttribPointer(n.positionLocation,2,l.FLOAT,!1,0,0);var _=l.createBuffer();return l.bindBuffer(l.ARRAY_BUFFER,_),l.bufferData(l.ARRAY_BUFFER,g,l.STATIC_DRAW),l.enableVertexAttribArray(n.colorLocation),l.vertexAttribPointer(n.colorLocation,3,l.UNSIGNED_BYTE,!1,0,0),l.uniform2f(n.scaleLocation,r.scaleX,r.scaleY),l.uniform2f(n.offsetLocation,r.offsetX,r.offsetY),l.drawArrays(l.TRIANGLES,0,u),l.flush(),l.deleteBuffer(P),l.deleteBuffer(_),a}function p(){h&&h.canvas&&(h.canvas.width=0,h.canvas.height=0),R&&R.canvas&&(R.canvas.width=0,R.canvas.height=0),h=null,R=null}var u,f,g="  attribute vec2 a_position;                                      attribute vec2 a_texCoord;                                                                                                      uniform vec2 u_resolution;                                                                                                      varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec2 clipSpace = (a_position / u_resolution) * 2.0 - 1.0;       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_texCoord = a_texCoord;                                      }                                                             ",m="  precision mediump float;                                                                                                        uniform vec4 u_backdrop;                                        uniform int u_subtype;                                          uniform sampler2D u_image;                                      uniform sampler2D u_mask;                                                                                                       varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec4 imageColor = texture2D(u_image, v_texCoord);               vec4 maskColor = texture2D(u_mask, v_texCoord);                 if (u_backdrop.a > 0.0) {                                         maskColor.rgb = maskColor.rgb * maskColor.a +                                   u_backdrop.rgb * (1.0 - maskColor.a);         }                                                               float lum;                                                      if (u_subtype == 0) {                                             lum = maskColor.a;                                            } else {                                                          lum = maskColor.r * 0.3 + maskColor.g * 0.59 +                        maskColor.b * 0.11;                                     }                                                               imageColor.a *= lum;                                            imageColor.rgb *= imageColor.a;                                 gl_FragColor = imageColor;                                    }                                                             ",h=null,T="  attribute vec2 a_position;                                      attribute vec3 a_color;                                                                                                         uniform vec2 u_resolution;                                      uniform vec2 u_scale;                                           uniform vec2 u_offset;                                                                                                          varying vec4 v_color;                                                                                                           void main() {                                                     vec2 position = (a_position + u_offset) * u_scale;              vec2 clipSpace = (position / u_resolution) * 2.0 - 1.0;         gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_color = vec4(a_color / 255.0, 1.0);                         }                                                             ",E="  precision mediump float;                                                                                                        varying vec4 v_color;                                                                                                           void main() {                                                     gl_FragColor = v_color;                                       }                                                             ",R=null;return{get isEnabled(){if(PDFJS.disableWebGL)return!1;var e=!1;try{n(),e=!!u}catch(e){}return l(this,"isEnabled",e)},composeSMask:s,drawFigures:c,clear:p}}(),le={};le.RadialAxial={fromIR:function(e){var t=e[1],i=e[2],o=e[3],r=e[4],n=e[5],a=e[6];return{type:"Pattern",getPattern:function(e){var l;"axial"===t?l=e.createLinearGradient(o[0],o[1],r[0],r[1]):"radial"===t&&(l=e.createRadialGradient(o[0],o[1],n,r[0],r[1],a));for(var s=0,d=i.length;s<d;++s){var c=i[s];l.addColorStop(c[0],c[1])}return l}}}};var se=function(){function e(e,t,i,o,r,n,a,l){var s,d=t.coords,c=t.colors,p=e.data,u=4*e.width;d[i+1]>d[o+1]&&(s=i,i=o,o=s,s=n,n=a,a=s),d[o+1]>d[r+1]&&(s=o,o=r,r=s,s=a,a=l,l=s),d[i+1]>d[o+1]&&(s=i,i=o,o=s,s=n,n=a,a=s);var f=(d[i]+t.offsetX)*t.scaleX,g=(d[i+1]+t.offsetY)*t.scaleY,m=(d[o]+t.offsetX)*t.scaleX,h=(d[o+1]+t.offsetY)*t.scaleY,T=(d[r]+t.offsetX)*t.scaleX,E=(d[r+1]+t.offsetY)*t.scaleY;if(!(g>=E))for(var R,S,O,v,b,A,y,D,C,I=c[n],P=c[n+1],_=c[n+2],N=c[a],L=c[a+1],w=c[a+2],M=c[l],U=c[l+1],x=c[l+2],F=Math.round(g),k=Math.round(E),B=F;B<=k;B++){B<h?(C=B<g?0:g===h?1:(g-B)/(g-h),R=f-(f-m)*C,S=I-(I-N)*C,O=P-(P-L)*C,v=_-(_-w)*C):(C=B>E?1:h===E?0:(h-B)/(h-E),R=m-(m-T)*C,S=N-(N-M)*C,O=L-(L-U)*C,v=w-(w-x)*C),C=B<g?0:B>E?1:(g-B)/(g-E),b=f-(f-T)*C,A=I-(I-M)*C,y=P-(P-U)*C,D=_-(_-x)*C;for(var J=Math.round(Math.min(R,b)),H=Math.round(Math.max(R,b)),G=u*B+4*J,z=J;z<=H;z++)C=(R-z)/(R-b),C=C<0?0:C>1?1:C,p[G++]=S-(S-A)*C|0,p[G++]=O-(O-y)*C|0,p[G++]=v-(v-D)*C|0,p[G++]=255}}function t(t,o,r){var n,a,l=o.coords,s=o.colors;switch(o.type){case"lattice":var d=o.verticesPerRow,c=Math.floor(l.length/d)-1,p=d-1;for(n=0;n<c;n++)for(var u=n*d,f=0;f<p;f++,u++)e(t,r,l[u],l[u+1],l[u+d],s[u],s[u+1],s[u+d]),e(t,r,l[u+d+1],l[u+1],l[u+d],s[u+d+1],s[u+1],s[u+d]);break;case"triangles":for(n=0,a=l.length;n<a;n+=3)e(t,r,l[n],l[n+1],l[n+2],s[n],s[n+1],s[n+2]);break;default:i("illigal figure")}}function o(e,i,o,r,n,a){var l,s,d,c,p=1.1,u=3e3,f=Math.floor(e[0]),g=Math.floor(e[1]),m=Math.ceil(e[2])-f,h=Math.ceil(e[3])-g,T=Math.min(Math.ceil(Math.abs(m*i[0]*p)),u),E=Math.min(Math.ceil(Math.abs(h*i[1]*p)),u),R=m/T,S=h/E,O={coords:o,colors:r,offsetX:-f,offsetY:-g,scaleX:1/R,scaleY:1/S};if(ae.isEnabled)l=ae.drawFigures(T,E,a,n,O),s=oe.getCanvas("mesh",T,E,!1),s.context.drawImage(l,0,0),l=s.canvas;else{s=oe.getCanvas("mesh",T,E,!1);var v=s.context,b=v.createImageData(T,E);if(a){var A=b.data;for(d=0,c=A.length;d<c;d+=4)A[d]=a[0],A[d+1]=a[1],A[d+2]=a[2],A[d+3]=255}for(d=0;d<n.length;d++)t(b,n[d],O);v.putImageData(b,0,0),l=s.canvas}return{canvas:l,offsetX:f,offsetY:g,scaleX:R,scaleY:S}}return o}();le.Mesh={fromIR:function(e){var t=e[2],i=e[3],o=e[4],r=e[5],n=e[6],a=e[8];return{type:"Pattern",getPattern:function(e,l,s){var d;if(s)d=J.singularValueDecompose2dScale(e.mozCurrentTransform);else if(d=J.singularValueDecompose2dScale(l.baseTransform),n){var c=J.singularValueDecompose2dScale(n);d=[d[0]*c[0],d[1]*c[1]]}var p=se(r,d,t,i,o,s?null:a);return s||(e.setTransform.apply(e,l.baseTransform),n&&e.transform.apply(e,n)),e.translate(p.offsetX,p.offsetY),e.scale(p.scaleX,p.scaleY),e.createPattern(p.canvas,"no-repeat")}}}},le.Dummy={fromIR:function(){return{type:"Pattern",getPattern:function(){return"hotpink"}}}};var de=function(){function t(e,t,i,o,r,n){this.operatorList=e[2],this.matrix=e[3]||[1,0,0,1,0,0],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.objs=o,this.commonObjs=r,this.baseTransform=n,this.type="Pattern",this.ctx=i}var o={COLORED:1,UNCOLORED:2},r=3e3;return t.prototype={createPatternCanvas:function(t){var i=this.operatorList,o=this.bbox,n=this.xstep,a=this.ystep,l=this.paintType,s=this.tilingType,d=this.color,c=this.objs,p=this.commonObjs;e("TilingType: "+s);var u=o[0],f=o[1],g=o[2],m=o[3],h=[u,f],T=[u+n,f+a],E=T[0]-h[0],R=T[1]-h[1],S=J.singularValueDecompose2dScale(this.matrix),O=J.singularValueDecompose2dScale(this.baseTransform),v=[S[0]*O[0],S[1]*O[1]];E=Math.min(Math.ceil(Math.abs(E*v[0])),r),R=Math.min(Math.ceil(Math.abs(R*v[1])),r);var b=oe.getCanvas("pattern",E,R,!0),A=b.context,y=new ne(A,p,c);y.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(A,l,d),this.setScale(E,R,n,a),this.transformToScale(y);var D=[1,0,0,1,-h[0],-h[1]];return y.transform.apply(y,D),this.clipBbox(y,o,u,f,g,m),y.executeOperatorList(i),b.canvas},setScale:function(e,t,i,o){this.scale=[e/i,t/o]},transformToScale:function(e){var t=this.scale,i=[t[0],0,0,t[1],0,0];e.transform.apply(e,i)},scaleToContext:function(){var e=this.scale;this.ctx.scale(1/e[0],1/e[1])},clipBbox:function(e,t,i,o,r,n){if(t&&g(t)&&4===t.length){var a=r-i,l=n-o;e.ctx.rect(i,o,a,l),e.clip(),e.endPath()}},setFillAndStrokeStyleToContext:function(e,t,r){switch(t){case o.COLORED:var n=this.ctx;e.fillStyle=n.fillStyle,e.strokeStyle=n.strokeStyle;break;case o.UNCOLORED:var a=J.makeCssRgb(r[0],r[1],r[2]);e.fillStyle=a,e.strokeStyle=a;break;default:i("Unsupported paint type: "+t)}},getPattern:function(e,t){var i=this.createPatternCanvas(t);return e=this.ctx,e.setTransform.apply(e,this.baseTransform),e.transform.apply(e,this.matrix),this.scaleToContext(),e.createPattern(i,"repeat")}},t}();PDFJS.disableFontFace=!1;var ce={insertRule:function(e){var t=document.getElementById("PDFJS_FONT_STYLE_TAG");t||(t=document.createElement("style"),t.id="PDFJS_FONT_STYLE_TAG",document.documentElement.getElementsByTagName("head")[0].appendChild(t));var i=t.sheet;i.insertRule(e,i.cssRules.length)},clear:function(){var e=document.getElementById("PDFJS_FONT_STYLE_TAG");e&&e.parentNode.removeChild(e),this.nativeFontFaces.forEach(function(e){document.fonts.delete(e)}),this.nativeFontFaces.length=0},get loadTestFont(){return l(this,"loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))},loadTestFontId:0,loadingContext:{requests:[],nextRequestId:0},isSyncFontLoadingSupported:function(){if(A)return!1;var e=window.navigator.userAgent,t=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(e);return!!(t&&t[1]>=14)||"node"===e}(),nativeFontFaces:[],isFontLoadingAPISupported:!A&&"undefined"!=typeof document&&!!document.fonts,addNativeFontFace:function(e){this.nativeFontFaces.push(e),document.fonts.add(e)},bind:function(e,t){r(!A,"bind() shall be called from main thread");for(var i=[],o=[],n=[],a=0,l=e.length;a<l;a++){var s=e[a];if(!s.attached&&s.loading!==!1)if(s.attached=!0,this.isFontLoadingAPISupported){var d=s.createNativeFontFace();d&&n.push(d.loaded)}else{var c=s.bindDOM();c&&(i.push(c),o.push(s))}}var p=ce.queueLoadingCallback(t);this.isFontLoadingAPISupported?Promise.all(o).then(function(){p.complete()}):i.length>0&&!this.isSyncFontLoadingSupported?ce.prepareFontLoadEvent(i,o,p):p.complete()},queueLoadingCallback:function(e){function t(){for(r(!n.end,"completeRequest() cannot be called twice"),n.end=Date.now();i.requests.length>0&&i.requests[0].end;){var e=i.requests.shift();setTimeout(e.callback,0)}}var i=ce.loadingContext,o="pdfjs-font-loading-"+i.nextRequestId++,n={id:o,complete:t,callback:e,started:Date.now()};return i.requests.push(n),n},prepareFontLoadEvent:function(e,i,o){function r(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function n(e,t,i,o){var r=e.substr(0,t),n=e.substr(t+i);return r+o+n}function a(e,i){if(u++,u>30)return t("Load test font never loaded."),void i();p.font="30px "+e,p.fillText(".",0,20);var o=p.getImageData(0,0,1,1);return o.data[3]>0?void i():void setTimeout(a.bind(null,e,i))}var l,s,d=document.createElement("canvas");d.width=1,d.height=1;var p=d.getContext("2d"),u=0,f="lt"+Date.now()+this.loadTestFontId++,g=this.loadTestFont,m=976;g=n(g,m,f.length,f);var h=16,T=1482184792,E=r(g,h);for(l=0,s=f.length-3;l<s;l+=4)E=E-T+r(f,l)|0;l<f.length&&(E=E-T+r(f+"XXX",l)|0),g=n(g,h,4,c(E));var R="url(data:font/opentype;base64,"+btoa(g)+");",S='@font-face { font-family:"'+f+'";src:'+R+"}";ce.insertRule(S);var O=[];for(l=0,s=i.length;l<s;l++)O.push(i[l].loadedName);O.push(f);var v=document.createElement("div");for(v.setAttribute("style","visibility: hidden;width: 10px; height: 10px;position: absolute; top: 0px; left: 0px;"),l=0,s=O.length;l<s;++l){var b=document.createElement("span");b.textContent="Hi",b.style.fontFamily=O[l],v.appendChild(b)}document.body.appendChild(v),a(f,function(){document.body.removeChild(v),o.complete()})}},pe=function(){function e(e,t,i){if(this.compiledGlyphs={},1!==arguments.length);else{var o=arguments[0];for(var r in o)this[r]=o[r]}}return e.prototype={createNativeFontFace:function(){if(!this.data)return null;if(PDFJS.disableFontFace)return this.disableFontFace=!0,null;var e=new FontFace(this.loadedName,this.data,{});return ce.addNativeFontFace(e),PDFJS.pdfBug&&"FontInspector"in b&&b.FontInspector.enabled&&b.FontInspector.fontAdded(this),e},bindDOM:function(){if(!this.data)return null;if(PDFJS.disableFontFace)return this.disableFontFace=!0,null;var e=s(new Uint8Array(this.data)),t=this.loadedName,i="url(data:"+this.mimetype+";base64,"+window.btoa(e)+");",o='@font-face { font-family:"'+t+'";src:'+i+"}";return ce.insertRule(o),PDFJS.pdfBug&&"FontInspector"in b&&b.FontInspector.enabled&&b.FontInspector.fontAdded(this,i),o},getPathGenerator:function(e,t){if(!(t in this.compiledGlyphs)){var i=e.get(this.loadedName+"_path_"+t);this.compiledGlyphs[t]=new Function("c","size",i)}return this.compiledGlyphs[t]}},e}(),ue=10,fe=function(){function e(e,t,i){var o=e.style;if(o.fontSize=t.fontSize+"px",o.direction=t.fontDirection<0?"rtl":"ltr",i){o.fontWeight=i.black?i.bold?"bolder":"bold":i.bold?"bold":"normal",o.fontStyle=i.italic?"italic":"normal";var r=i.loadedName,n=r?'"'+r+'", ':"",a=i.fallbackName||"Helvetica, sans-serif";o.fontFamily=n+a}}function t(e,t){var i=document.createElement("section"),o=i.style,r=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],a=e.borderWidth||0;if(a){r-=2*a,n-=2*a,o.borderWidth=a+"px";var l=e.color;t&&l&&(o.borderStyle="solid",o.borderColor=J.makeCssRgb(Math.round(255*l[0]),Math.round(255*l[1]),Math.round(255*l[2])))}return o.width=r+"px",o.height=n+"px",i}function i(t,i){var o=document.createElement("div"),r=t.rect[2]-t.rect[0],n=t.rect[3]-t.rect[1];o.style.width=r+"px",o.style.height=n+"px",o.style.display="table";var a=document.createElement("div");a.textContent=t.fieldValue;var l=t.textAlignment;a.style.textAlign=["left","center","right"][l],a.style.verticalAlign="middle",a.style.display="table-cell";var s=t.fontRefName?i.getData(t.fontRefName):null;return e(a,t,s),o.appendChild(a),o}function o(e){var i=e.rect;i[3]-i[1]<ue&&(i[3]=i[1]+ue),i[2]-i[0]<ue&&(i[2]=i[0]+(i[3]-i[1]));var o=t(e,!1);o.className="annotText";var r=document.createElement("img");r.style.height=o.style.height,r.style.width=o.style.width;var n=e.name;r.src=PDFJS.imageResourcesPath+"annotation-"+n.toLowerCase()+".svg",r.alt="[{{type}} Annotation]",r.dataset.l10nId="text_annotation_type",r.dataset.l10nArgs=JSON.stringify({type:n});var a=document.createElement("div");a.className="annotTextContentWrapper",a.style.left=Math.floor(i[2]-i[0]+5)+"px",a.style.top="-10px";var l=document.createElement("div");l.className="annotTextContent",l.setAttribute("hidden",!0);var s,d;if(e.hasBgColor){var c=e.color,p=.7,u=p*(1-c[0])+c[0],f=p*(1-c[1])+c[1],g=p*(1-c[2])+c[2];l.style.backgroundColor=J.makeCssRgb(255*u|0,255*f|0,255*g|0)}var m=document.createElement("h1"),h=document.createElement("p");if(m.textContent=e.title,e.content||e.title){var T=document.createElement("span"),E=e.content.split(/(?:\r\n?|\n)/);for(s=0,d=E.length;s<d;++s){var R=E[s];T.appendChild(document.createTextNode(R)),s<d-1&&T.appendChild(document.createElement("br"))}h.appendChild(T);var S=!1,O=function(e){e&&(S=!0),l.hasAttribute("hidden")&&(o.style.zIndex+=1,l.removeAttribute("hidden"))},v=function(e){e&&(S=!1),l.hasAttribute("hidden")||S||(o.style.zIndex-=1,l.setAttribute("hidden",!0))},b=function(){S?v(!0):O(!0)};r.addEventListener("click",function(){b()},!1),r.addEventListener("mouseover",function(){O()},!1),r.addEventListener("mouseout",function(){v()},!1),l.addEventListener("click",function(){v(!0)},!1)}else l.setAttribute("hidden",!0);return l.appendChild(m),l.appendChild(h),a.appendChild(l),o.appendChild(r),o.appendChild(a),o}function r(e){var i=t(e,!0);i.className="annotLink";var o=document.createElement("a");return o.href=o.title=e.url||"",e.url&&PDFJS.openExternalLinksInNewWindow&&(o.target="_blank"),i.appendChild(o),i}function n(e,t){switch(e.annotationType){case I.WIDGET:return i(e,t);case I.TEXT:return o(e);case I.LINK:return r(e);default:throw new Error("Unsupported annotationType: "+e.annotationType)}}return{getHtmlElement:n}}();PDFJS.AnnotationUtils=fe;var ge={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},me=function(){function e(e,t,i){for(var o=-1,r=t;r<i;r++){var n=255&(o^e[r]),l=a[n];o=o>>>8^l}return o^-1}function t(t,i,o,r){var n=r,a=i.length;o[n]=a>>24&255,o[n+1]=a>>16&255,o[n+2]=a>>8&255,o[n+3]=255&a,n+=4,o[n]=255&t.charCodeAt(0),o[n+1]=255&t.charCodeAt(1),o[n+2]=255&t.charCodeAt(2),o[n+3]=255&t.charCodeAt(3),n+=4,o.set(i,n),n+=i.length;var l=e(o,r+4,n);o[n]=l>>24&255,o[n+1]=l>>16&255,o[n+2]=l>>8&255,o[n+3]=255&l}function i(e,t,i){for(var o=1,r=0,n=t;n<i;++n)o=(o+(255&e[n]))%65521,r=(r+o)%65521;return r<<16|o}function o(e,o){var a,l,s,d=e.width,c=e.height,p=e.data;switch(o){case C.GRAYSCALE_1BPP:l=0,a=1,s=d+7>>3;break;case C.RGB_24BPP:l=2,a=8,s=3*d;break;case C.RGBA_32BPP:l=6,a=8,s=4*d;break;default:throw new Error("invalid format")}var u,f,g=new Uint8Array((1+s)*c),m=0,h=0;for(u=0;u<c;++u)g[m++]=0,g.set(p.subarray(h,h+s),m),h+=s,m+=s;if(o===C.GRAYSCALE_1BPP)for(m=0,u=0;u<c;u++)for(m++,f=0;f<s;f++)g[m++]^=255;var T=new Uint8Array([d>>24&255,d>>16&255,d>>8&255,255&d,c>>24&255,c>>16&255,c>>8&255,255&c,a,l,0,0,0]),E=g.length,R=65535,S=Math.ceil(E/R),O=new Uint8Array(2+E+5*S+4),v=0;O[v++]=120,O[v++]=156;for(var b=0;E>R;)O[v++]=0,O[v++]=255,O[v++]=255,O[v++]=0,O[v++]=0,O.set(g.subarray(b,b+R),v),v+=R,b+=R,E-=R;O[v++]=1,O[v++]=255&E,O[v++]=E>>8&255,O[v++]=65535&~E&255,O[v++]=(65535&~E)>>8&255,O.set(g.subarray(b),v),v+=g.length-b;var A=i(g,0,g.length);O[v++]=A>>24&255,O[v++]=A>>16&255,O[v++]=A>>8&255,O[v++]=255&A;var y=r.length+3*n+T.length+O.length,D=new Uint8Array(y),I=0;return D.set(r,I),I+=r.length,t("IHDR",T,D,I),I+=n+T.length,t("IDATA",O,D,I),I+=n+O.length,t("IEND",new Uint8Array(0),D,I),PDFJS.createObjectURL(D,"image/png")}for(var r=new Uint8Array([137,80,78,71,13,10,26,10]),n=12,a=new Int32Array(256),l=0;l<256;l++){for(var s=l,d=0;d<8;d++)s=1&s?3988292384^s>>1&2147483647:s>>1&2147483647;a[l]=s}return function(e){var t=void 0===e.kind?C.GRAYSCALE_1BPP:e.kind;return o(e,t)}}(),he=function(){function e(){this.fontSizeScale=1,this.fontWeight=ge.fontWeight,this.fontSize=0,this.textMatrix=B,this.fontMatrix=y,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=ge.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.clipId="",this.pendingClip=!1,this.maskId=""}return e.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(e,t){this.x=e,this.y=t}},e}(),Te=function(){function e(e,t){var i="http://www.w3.org/2000/svg",o=document.createElementNS(i,"svg:svg");return o.setAttributeNS(null,"version","1.1"),o.setAttributeNS(null,"width",e+"px"),o.setAttributeNS(null,"height",t+"px"),o.setAttributeNS(null,"viewBox","0 0 "+e+" "+t),o}function i(e){for(var t=[],i=[],o=e.length,r=0;r<o;r++)"save"!==e[r].fn?"restore"===e[r].fn?t=i.pop():t.push(e[r]):(t.push({fnId:92,fn:"group",items:[]}),i.push(t),t=t[t.length-1].items);return t}function o(e){if(e===(0|e))return e.toString();var t=e.toFixed(10),i=t.length-1;if("0"!==t[i])return t;do i--;while("0"===t[i]);return t.substr(0,"."===t[i]?i:i+1)}function r(e){if(0===e[4]&&0===e[5]){if(0===e[1]&&0===e[2])return 1===e[0]&&1===e[3]?"":"scale("+o(e[0])+" "+o(e[3])+")";if(e[0]===e[3]&&e[1]===-e[2]){var t=180*Math.acos(e[0])/Math.PI;return"rotate("+o(t)+")"}}else if(1===e[0]&&0===e[1]&&0===e[2]&&1===e[3])return"translate("+o(e[4])+" "+o(e[5])+")";return"matrix("+o(e[0])+" "+o(e[1])+" "+o(e[2])+" "+o(e[3])+" "+o(e[4])+" "+o(e[5])+")"}function n(e,t){this.current=new he,this.transformMatrix=B,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=t,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts={},this.cssStyle=null}var a="http://www.w3.org/2000/svg",l="http://www.w3.org/XML/1998/namespace",s="http://www.w3.org/1999/xlink",d=["butt","round","square"],c=["miter","round","bevel"],p=0,u=0;return n.prototype={save:function(){this.transformStack.push(this.transformMatrix);var e=this.current;this.extraStack.push(e),this.current=e.clone()},restore:function(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.tgrp=document.createElementNS(a,"svg:g"),this.tgrp.setAttributeNS(null,"transform",r(this.transformMatrix)),this.pgrp.appendChild(this.tgrp)},group:function(e){this.save(),this.executeOpTree(e),this.restore()},loadDependencies:function(e){for(var t=e.fnArray,i=t.length,o=e.argsArray,r=this,n=0;n<i;n++)if(P.dependency===t[n])for(var a=o[n],l=0,s=a.length;l<s;l++){var d,c=a[l],p="g_"===c.substring(0,2);d=p?new Promise(function(e){r.commonObjs.get(c,e)}):new Promise(function(e){r.objs.get(c,e)}),this.current.dependencies.push(d)}return Promise.all(this.current.dependencies)},transform:function(e,t,i,o,n,l){var s=[e,t,i,o,n,l];this.transformMatrix=PDFJS.Util.transform(this.transformMatrix,s),this.tgrp=document.createElementNS(a,"svg:g"),this.tgrp.setAttributeNS(null,"transform",r(this.transformMatrix))},getSVG:function(t,i){return this.svg=e(i.width,i.height),this.viewport=i,this.loadDependencies(t).then(function(){this.transformMatrix=B,this.pgrp=document.createElementNS(a,"svg:g"),this.pgrp.setAttributeNS(null,"transform",r(i.transform)),this.tgrp=document.createElementNS(a,"svg:g"),this.tgrp.setAttributeNS(null,"transform",r(this.transformMatrix)),this.defs=document.createElementNS(a,"svg:defs"),this.pgrp.appendChild(this.defs),this.pgrp.appendChild(this.tgrp),this.svg.appendChild(this.pgrp);var e=this.convertOpList(t);return this.executeOpTree(e),this.svg}.bind(this))},convertOpList:function(e){var t=e.argsArray,o=e.fnArray,r=o.length,n=[],a=[];for(var l in P)n[P[l]]=l;for(var s=0;s<r;s++){var d=o[s];a.push({fnId:d,fn:n[d],args:t[s]})}return i(a)},executeOpTree:function(e){for(var i=e.length,o=0;o<i;o++){var r=e[o].fn,n=e[o].fnId,a=e[o].args;switch(0|n){case P.beginText:this.beginText();break;case P.setLeading:this.setLeading(a);break;case P.setLeadingMoveText:this.setLeadingMoveText(a[0],a[1]);break;case P.setFont:this.setFont(a);break;case P.showText:this.showText(a[0]);break;case P.showSpacedText:this.showText(a[0]);break;case P.endText:this.endText();break;case P.moveText:this.moveText(a[0],a[1]);break;case P.setCharSpacing:this.setCharSpacing(a[0]);break;case P.setWordSpacing:this.setWordSpacing(a[0]);break;case P.setHScale:this.setHScale(a[0]);break;case P.setTextMatrix:this.setTextMatrix(a[0],a[1],a[2],a[3],a[4],a[5]);break;case P.setLineWidth:this.setLineWidth(a[0]);break;case P.setLineJoin:this.setLineJoin(a[0]);break;case P.setLineCap:this.setLineCap(a[0]);break;case P.setMiterLimit:this.setMiterLimit(a[0]);break;case P.setFillRGBColor:this.setFillRGBColor(a[0],a[1],a[2]);break;case P.setStrokeRGBColor:this.setStrokeRGBColor(a[0],a[1],a[2]);break;case P.setDash:this.setDash(a[0],a[1]);break;case P.setGState:this.setGState(a[0]);break;case P.fill:this.fill();break;case P.eoFill:this.eoFill();break;case P.stroke:this.stroke();break;case P.fillStroke:this.fillStroke();break;case P.eoFillStroke:this.eoFillStroke();break;case P.clip:this.clip("nonzero");break;case P.eoClip:this.clip("evenodd");break;case P.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case P.paintJpegXObject:this.paintJpegXObject(a[0],a[1],a[2]);break;case P.paintImageXObject:this.paintImageXObject(a[0]);break;case P.paintInlineImageXObject:this.paintInlineImageXObject(a[0]);break;case P.paintImageMaskXObject:this.paintImageMaskXObject(a[0]);break;case P.paintFormXObjectBegin:this.paintFormXObjectBegin(a[0],a[1]);break;case P.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case P.closePath:this.closePath();break;case P.closeStroke:this.closeStroke();break;case P.closeFillStroke:this.closeFillStroke();break;case P.nextLine:this.nextLine();break;case P.transform:this.transform(a[0],a[1],a[2],a[3],a[4],a[5]);break;case P.constructPath:this.constructPath(a[0],a[1]);break;case P.endPath:this.endPath();break;case 92:this.group(e[o].items);break;default:t("Unimplemented method "+r)}}},setWordSpacing:function(e){this.current.wordSpacing=e},setCharSpacing:function(e){this.current.charSpacing=e},nextLine:function(){this.moveText(0,this.current.leading)},setTextMatrix:function(e,t,i,r,n,l){var s=this.current;this.current.textMatrix=this.current.lineMatrix=[e,t,i,r,n,l],this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,s.xcoords=[],s.tspan=document.createElementNS(a,"svg:tspan"),s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size",o(s.fontSize)+"px"),s.tspan.setAttributeNS(null,"y",o(-s.y)),s.txtElement=document.createElementNS(a,"svg:text"),s.txtElement.appendChild(s.tspan)},beginText:function(){this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.current.textMatrix=B,this.current.lineMatrix=B,this.current.tspan=document.createElementNS(a,"svg:tspan"),this.current.txtElement=document.createElementNS(a,"svg:text"),this.current.txtgrp=document.createElementNS(a,"svg:g"),this.current.xcoords=[]},moveText:function(e,t){var i=this.current;this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t,i.xcoords=[],i.tspan=document.createElementNS(a,"svg:tspan"),i.tspan.setAttributeNS(null,"font-family",i.fontFamily),i.tspan.setAttributeNS(null,"font-size",o(i.fontSize)+"px"),i.tspan.setAttributeNS(null,"y",o(-i.y))},showText:function(e){var t=this.current,i=t.font,n=t.fontSize;if(0!==n){var a,s=t.charSpacing,d=t.wordSpacing,c=t.fontDirection,p=t.textHScale*c,u=e.length,g=i.vertical,m=n*t.fontMatrix[0],h=0;for(a=0;a<u;++a){var T=e[a];if(null!==T)if(f(T))h+=-T*n*.001;else{t.xcoords.push(t.x+h*p);var E=T.width,R=T.fontChar,S=E*m+s*c;h+=S,t.tspan.textContent+=R}else h+=c*d}g?t.y-=h*p:t.x+=h*p,t.tspan.setAttributeNS(null,"x",t.xcoords.map(o).join(" ")),t.tspan.setAttributeNS(null,"y",o(-t.y)),t.tspan.setAttributeNS(null,"font-family",t.fontFamily),t.tspan.setAttributeNS(null,"font-size",o(t.fontSize)+"px"),t.fontStyle!==ge.fontStyle&&t.tspan.setAttributeNS(null,"font-style",t.fontStyle),t.fontWeight!==ge.fontWeight&&t.tspan.setAttributeNS(null,"font-weight",t.fontWeight),t.fillColor!==ge.fillColor&&t.tspan.setAttributeNS(null,"fill",t.fillColor),t.txtElement.setAttributeNS(null,"transform",r(t.textMatrix)+" scale(1, -1)"),t.txtElement.setAttributeNS(l,"xml:space","preserve"),t.txtElement.appendChild(t.tspan),t.txtgrp.appendChild(t.txtElement),this.tgrp.appendChild(t.txtElement)}},setLeadingMoveText:function(e,t){this.setLeading(-t),this.moveText(e,t)},addFontStyle:function(e){this.cssStyle||(this.cssStyle=document.createElementNS(a,"svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));var t=PDFJS.createObjectURL(e.data,e.mimetype);this.cssStyle.textContent+='@font-face { font-family: "'+e.loadedName+'"; src: url('+t+"); }\n"},setFont:function(e){var t=this.current,i=this.commonObjs.get(e[0]),r=e[1];this.current.font=i,this.embedFonts&&i.data&&!this.embeddedFonts[i.loadedName]&&(this.addFontStyle(i),this.embeddedFonts[i.loadedName]=i),t.fontMatrix=i.fontMatrix?i.fontMatrix:y;var n=i.black?i.bold?"bolder":"bold":i.bold?"bold":"normal",l=i.italic?"italic":"normal";r<0?(r=-r,t.fontDirection=-1):t.fontDirection=1,t.fontSize=r,t.fontFamily=i.loadedName,t.fontWeight=n,t.fontStyle=l,t.tspan=document.createElementNS(a,"svg:tspan"),t.tspan.setAttributeNS(null,"y",o(-t.y)),t.xcoords=[]},endText:function(){this.current.pendingClip?(this.cgrp.appendChild(this.tgrp),this.pgrp.appendChild(this.cgrp)):this.pgrp.appendChild(this.tgrp),this.tgrp=document.createElementNS(a,"svg:g"),this.tgrp.setAttributeNS(null,"transform",r(this.transformMatrix))},setLineWidth:function(e){this.current.lineWidth=e},setLineCap:function(e){this.current.lineCap=d[e]},setLineJoin:function(e){this.current.lineJoin=c[e]},setMiterLimit:function(e){this.current.miterLimit=e},setStrokeRGBColor:function(e,t,i){var o=J.makeCssRgb(e,t,i);this.current.strokeColor=o},setFillRGBColor:function(e,t,i){var o=J.makeCssRgb(e,t,i);this.current.fillColor=o,this.current.tspan=document.createElementNS(a,"svg:tspan"),this.current.xcoords=[]},setDash:function(e,t){this.current.dashArray=e,this.current.dashPhase=t},constructPath:function(e,t){var i=this.current,r=i.x,n=i.y;i.path=document.createElementNS(a,"svg:path");for(var l=[],s=e.length,d=0,c=0;d<s;d++)switch(0|e[d]){case P.rectangle:r=t[c++],n=t[c++];var p=t[c++],u=t[c++],f=r+p,g=n+u;l.push("M",o(r),o(n),"L",o(f),o(n),"L",o(f),o(g),"L",o(r),o(g),"Z");break;case P.moveTo:r=t[c++],n=t[c++],l.push("M",o(r),o(n));break;case P.lineTo:r=t[c++],n=t[c++],l.push("L",o(r),o(n));break;case P.curveTo:r=t[c+4],n=t[c+5],l.push("C",o(t[c]),o(t[c+1]),o(t[c+2]),o(t[c+3]),o(r),o(n)),c+=6;break;case P.curveTo2:r=t[c+2],n=t[c+3],l.push("C",o(r),o(n),o(t[c]),o(t[c+1]),o(t[c+2]),o(t[c+3])),c+=4;break;case P.curveTo3:r=t[c+2],n=t[c+3],l.push("C",o(t[c]),o(t[c+1]),o(r),o(n),o(r),o(n)),c+=4;break;case P.closePath:l.push("Z")}i.path.setAttributeNS(null,"d",l.join(" ")),i.path.setAttributeNS(null,"stroke-miterlimit",o(i.miterLimit)),i.path.setAttributeNS(null,"stroke-linecap",i.lineCap),i.path.setAttributeNS(null,"stroke-linejoin",i.lineJoin),i.path.setAttributeNS(null,"stroke-width",o(i.lineWidth)+"px"),i.path.setAttributeNS(null,"stroke-dasharray",i.dashArray.map(o).join(" ")),i.path.setAttributeNS(null,"stroke-dashoffset",o(i.dashPhase)+"px"),i.path.setAttributeNS(null,"fill","none"),this.tgrp.appendChild(i.path),i.pendingClip?(this.cgrp.appendChild(this.tgrp),this.pgrp.appendChild(this.cgrp)):this.pgrp.appendChild(this.tgrp),i.element=i.path,i.setCurrentPoint(r,n)},endPath:function(){var e=this.current;e.pendingClip?(this.cgrp.appendChild(this.tgrp),this.pgrp.appendChild(this.cgrp)):this.pgrp.appendChild(this.tgrp),this.tgrp=document.createElementNS(a,"svg:g"),this.tgrp.setAttributeNS(null,"transform",r(this.transformMatrix))},clip:function(e){var t=this.current;t.clipId="clippath"+p,p++,this.clippath=document.createElementNS(a,"svg:clipPath"),this.clippath.setAttributeNS(null,"id",t.clipId);var i=t.element.cloneNode();"evenodd"===e?i.setAttributeNS(null,"clip-rule","evenodd"):i.setAttributeNS(null,"clip-rule","nonzero"),this.clippath.setAttributeNS(null,"transform",r(this.transformMatrix)),this.clippath.appendChild(i),this.defs.appendChild(this.clippath),t.pendingClip=!0,this.cgrp=document.createElementNS(a,"svg:g"),this.cgrp.setAttributeNS(null,"clip-path","url(#"+t.clipId+")"),this.pgrp.appendChild(this.cgrp)},closePath:function(){var e=this.current,t=e.path.getAttributeNS(null,"d");t+="Z",e.path.setAttributeNS(null,"d",t)},setLeading:function(e){this.current.leading=-e},setTextRise:function(e){this.current.textRise=e},setHScale:function(e){this.current.textHScale=e/100},setGState:function(e){for(var t=0,i=e.length;t<i;t++){var o=e[t],r=o[0],n=o[1];switch(r){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":break;case"FL":break;case"Font":this.setFont(n);break;case"CA":break;case"ca":break;case"BM":break;case"SMask":}}},fill:function(){var e=this.current;e.element.setAttributeNS(null,"fill",e.fillColor)},stroke:function(){var e=this.current;e.element.setAttributeNS(null,"stroke",e.strokeColor),e.element.setAttributeNS(null,"fill","none")},eoFill:function(){var e=this.current;e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-rule","evenodd")},fillStroke:function(){this.stroke(),this.fill()},eoFillStroke:function(){this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()},closeStroke:function(){this.closePath(),this.stroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},paintSolidColorImageMask:function(){var e=this.current,t=document.createElementNS(a,"svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",e.fillColor),this.tgrp.appendChild(t)},paintJpegXObject:function(e,t,i){var r=this.current,n=this.objs.get(e),l=document.createElementNS(a,"svg:image");l.setAttributeNS(s,"xlink:href",n.src),l.setAttributeNS(null,"width",n.width+"px"),l.setAttributeNS(null,"height",n.height+"px"),l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y",o(-i)),l.setAttributeNS(null,"transform","scale("+o(1/t)+" "+o(-1/i)+")"),this.tgrp.appendChild(l),r.pendingClip?(this.cgrp.appendChild(this.tgrp),this.pgrp.appendChild(this.cgrp)):this.pgrp.appendChild(this.tgrp)},paintImageXObject:function(e){var i=this.objs.get(e);return i?void this.paintInlineImageXObject(i):void t("Dependent image isn't ready yet")},paintInlineImageXObject:function(e,t){var i=this.current,r=e.width,n=e.height,l=me(e),d=document.createElementNS(a,"svg:rect");d.setAttributeNS(null,"x","0"),d.setAttributeNS(null,"y","0"),d.setAttributeNS(null,"width",o(r)),d.setAttributeNS(null,"height",o(n)),i.element=d,this.clip("nonzero");var c=document.createElementNS(a,"svg:image");c.setAttributeNS(s,"xlink:href",l),c.setAttributeNS(null,"x","0"),c.setAttributeNS(null,"y",o(-n)),c.setAttributeNS(null,"width",o(r)+"px"),c.setAttributeNS(null,"height",o(n)+"px"),c.setAttributeNS(null,"transform","scale("+o(1/r)+" "+o(-1/n)+")"),t?t.appendChild(c):this.tgrp.appendChild(c),i.pendingClip?(this.cgrp.appendChild(this.tgrp),this.pgrp.appendChild(this.cgrp)):this.pgrp.appendChild(this.tgrp)},paintImageMaskXObject:function(e){var t=this.current,i=e.width,r=e.height,n=t.fillColor;t.maskId="mask"+u++;var l=document.createElementNS(a,"svg:mask");l.setAttributeNS(null,"id",t.maskId);var s=document.createElementNS(a,"svg:rect");s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y","0"),s.setAttributeNS(null,"width",o(i)),s.setAttributeNS(null,"height",o(r)),s.setAttributeNS(null,"fill",n),s.setAttributeNS(null,"mask","url(#"+t.maskId+")"),this.defs.appendChild(l),this.tgrp.appendChild(s),this.paintInlineImageXObject(e,l)},paintFormXObjectBegin:function(e,t){if(this.save(),g(e)&&6===e.length&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),g(t)&&4===t.length){var i=t[2]-t[0],r=t[3]-t[1],n=document.createElementNS(a,"svg:rect");n.setAttributeNS(null,"x",t[0]),n.setAttributeNS(null,"y",t[1]),n.setAttributeNS(null,"width",o(i)),n.setAttributeNS(null,"height",o(r)),this.current.element=n,this.clip("nonzero"),this.endPath()}},paintFormXObjectEnd:function(){this.restore()}},n}();PDFJS.SVGGraphics=Te}.call("undefined"==typeof window?this:window),PDFJS.workerSrc||"undefined"==typeof document||(PDFJS.workerSrc=function(){"use strict";var e=document.body||document.getElementsByTagName("head")[0],t=e.lastChild.src;return t&&t.replace(/\.js$/i,".worker.js")}());